function FX(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const jX="modulepreload",BX=function(n){return"/"+n},rO={},iO=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");r=l(t.map(c=>{if(c=BX(c),c in rO)return;rO[c]=!0;const h=c.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":jX,h||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),h)return new Promise((v,x)=>{m.addEventListener("load",v),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};function yC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function yF(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function s(){var r=!1;try{r=this instanceof s}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var SE={exports:{}},ty={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aO;function zX(){if(aO)return ty;aO=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,r,i){var a=null;if(i!==void 0&&(a=""+i),r.key!==void 0&&(a=""+r.key),"key"in r){i={};for(var o in r)o!=="key"&&(i[o]=r[o])}else i=r;return r=i.ref,{$$typeof:n,type:s,key:a,ref:r!==void 0?r:null,props:i}}return ty.Fragment=e,ty.jsx=t,ty.jsxs=t,ty}var oO;function VX(){return oO||(oO=1,SE.exports=zX()),SE.exports}var y=VX(),EE={exports:{}},Ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lO;function UX(){if(lO)return Ft;lO=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function m(K){return K===null||typeof K!="object"?null:(K=p&&K[p]||K["@@iterator"],typeof K=="function"?K:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,w={};function T(K,ie,pe){this.props=K,this.context=ie,this.refs=w,this.updater=pe||v}T.prototype.isReactComponent={},T.prototype.setState=function(K,ie){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,ie,"setState")},T.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function E(){}E.prototype=T.prototype;function C(K,ie,pe){this.props=K,this.context=ie,this.refs=w,this.updater=pe||v}var $=C.prototype=new E;$.constructor=C,x($,T.prototype),$.isPureReactComponent=!0;var R=Array.isArray,P={H:null,A:null,T:null,S:null,V:null},U=Object.prototype.hasOwnProperty;function j(K,ie,pe,fe,Ne,Te){return pe=Te.ref,{$$typeof:n,type:K,key:ie,ref:pe!==void 0?pe:null,props:Te}}function O(K,ie){return j(K.type,ie,void 0,void 0,void 0,K.props)}function M(K){return typeof K=="object"&&K!==null&&K.$$typeof===n}function B(K){var ie={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(pe){return ie[pe]})}var D=/\/+/g;function W(K,ie){return typeof K=="object"&&K!==null&&K.key!=null?B(""+K.key):ie.toString(36)}function H(){}function ae(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(H,H):(K.status="pending",K.then(function(ie){K.status==="pending"&&(K.status="fulfilled",K.value=ie)},function(ie){K.status==="pending"&&(K.status="rejected",K.reason=ie)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function te(K,ie,pe,fe,Ne){var Te=typeof K;(Te==="undefined"||Te==="boolean")&&(K=null);var Se=!1;if(K===null)Se=!0;else switch(Te){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(K.$$typeof){case n:case e:Se=!0;break;case h:return Se=K._init,te(Se(K._payload),ie,pe,fe,Ne)}}if(Se)return Ne=Ne(K),Se=fe===""?"."+W(K,0):fe,R(Ne)?(pe="",Se!=null&&(pe=Se.replace(D,"$&/")+"/"),te(Ne,ie,pe,"",function(Qe){return Qe})):Ne!=null&&(M(Ne)&&(Ne=O(Ne,pe+(Ne.key==null||K&&K.key===Ne.key?"":(""+Ne.key).replace(D,"$&/")+"/")+Se)),ie.push(Ne)),1;Se=0;var He=fe===""?".":fe+":";if(R(K))for(var qe=0;qe<K.length;qe++)fe=K[qe],Te=He+W(fe,qe),Se+=te(fe,ie,pe,Te,Ne);else if(qe=m(K),typeof qe=="function")for(K=qe.call(K),qe=0;!(fe=K.next()).done;)fe=fe.value,Te=He+W(fe,qe++),Se+=te(fe,ie,pe,Te,Ne);else if(Te==="object"){if(typeof K.then=="function")return te(ae(K),ie,pe,fe,Ne);throw ie=String(K),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.")}return Se}function Z(K,ie,pe){if(K==null)return K;var fe=[],Ne=0;return te(K,fe,"","",function(Te){return ie.call(pe,Te,Ne++)}),fe}function re(K){if(K._status===-1){var ie=K._result;ie=ie(),ie.then(function(pe){(K._status===0||K._status===-1)&&(K._status=1,K._result=pe)},function(pe){(K._status===0||K._status===-1)&&(K._status=2,K._result=pe)}),K._status===-1&&(K._status=0,K._result=ie)}if(K._status===1)return K._result.default;throw K._result}var ne=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)};function he(){}return Ft.Children={map:Z,forEach:function(K,ie,pe){Z(K,function(){ie.apply(this,arguments)},pe)},count:function(K){var ie=0;return Z(K,function(){ie++}),ie},toArray:function(K){return Z(K,function(ie){return ie})||[]},only:function(K){if(!M(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},Ft.Component=T,Ft.Fragment=t,Ft.Profiler=r,Ft.PureComponent=C,Ft.StrictMode=s,Ft.Suspense=l,Ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,Ft.__COMPILER_RUNTIME={__proto__:null,c:function(K){return P.H.useMemoCache(K)}},Ft.cache=function(K){return function(){return K.apply(null,arguments)}},Ft.cloneElement=function(K,ie,pe){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var fe=x({},K.props),Ne=K.key,Te=void 0;if(ie!=null)for(Se in ie.ref!==void 0&&(Te=void 0),ie.key!==void 0&&(Ne=""+ie.key),ie)!U.call(ie,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&ie.ref===void 0||(fe[Se]=ie[Se]);var Se=arguments.length-2;if(Se===1)fe.children=pe;else if(1<Se){for(var He=Array(Se),qe=0;qe<Se;qe++)He[qe]=arguments[qe+2];fe.children=He}return j(K.type,Ne,void 0,void 0,Te,fe)},Ft.createContext=function(K){return K={$$typeof:a,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:i,_context:K},K},Ft.createElement=function(K,ie,pe){var fe,Ne={},Te=null;if(ie!=null)for(fe in ie.key!==void 0&&(Te=""+ie.key),ie)U.call(ie,fe)&&fe!=="key"&&fe!=="__self"&&fe!=="__source"&&(Ne[fe]=ie[fe]);var Se=arguments.length-2;if(Se===1)Ne.children=pe;else if(1<Se){for(var He=Array(Se),qe=0;qe<Se;qe++)He[qe]=arguments[qe+2];Ne.children=He}if(K&&K.defaultProps)for(fe in Se=K.defaultProps,Se)Ne[fe]===void 0&&(Ne[fe]=Se[fe]);return j(K,Te,void 0,void 0,null,Ne)},Ft.createRef=function(){return{current:null}},Ft.forwardRef=function(K){return{$$typeof:o,render:K}},Ft.isValidElement=M,Ft.lazy=function(K){return{$$typeof:h,_payload:{_status:-1,_result:K},_init:re}},Ft.memo=function(K,ie){return{$$typeof:c,type:K,compare:ie===void 0?null:ie}},Ft.startTransition=function(K){var ie=P.T,pe={};P.T=pe;try{var fe=K(),Ne=P.S;Ne!==null&&Ne(pe,fe),typeof fe=="object"&&fe!==null&&typeof fe.then=="function"&&fe.then(he,ne)}catch(Te){ne(Te)}finally{P.T=ie}},Ft.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},Ft.use=function(K){return P.H.use(K)},Ft.useActionState=function(K,ie,pe){return P.H.useActionState(K,ie,pe)},Ft.useCallback=function(K,ie){return P.H.useCallback(K,ie)},Ft.useContext=function(K){return P.H.useContext(K)},Ft.useDebugValue=function(){},Ft.useDeferredValue=function(K,ie){return P.H.useDeferredValue(K,ie)},Ft.useEffect=function(K,ie,pe){var fe=P.H;if(typeof pe=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return fe.useEffect(K,ie)},Ft.useId=function(){return P.H.useId()},Ft.useImperativeHandle=function(K,ie,pe){return P.H.useImperativeHandle(K,ie,pe)},Ft.useInsertionEffect=function(K,ie){return P.H.useInsertionEffect(K,ie)},Ft.useLayoutEffect=function(K,ie){return P.H.useLayoutEffect(K,ie)},Ft.useMemo=function(K,ie){return P.H.useMemo(K,ie)},Ft.useOptimistic=function(K,ie){return P.H.useOptimistic(K,ie)},Ft.useReducer=function(K,ie,pe){return P.H.useReducer(K,ie,pe)},Ft.useRef=function(K){return P.H.useRef(K)},Ft.useState=function(K){return P.H.useState(K)},Ft.useSyncExternalStore=function(K,ie,pe){return P.H.useSyncExternalStore(K,ie,pe)},Ft.useTransition=function(){return P.H.useTransition()},Ft.version="19.1.1",Ft}var cO;function vC(){return cO||(cO=1,EE.exports=UX()),EE.exports}var ve=vC(),NE={exports:{}},ny={},IE={exports:{}},CE={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uO;function GX(){return uO||(uO=1,(function(n){function e(Z,re){var ne=Z.length;Z.push(re);e:for(;0<ne;){var he=ne-1>>>1,K=Z[he];if(0<r(K,re))Z[he]=re,Z[ne]=K,ne=he;else break e}}function t(Z){return Z.length===0?null:Z[0]}function s(Z){if(Z.length===0)return null;var re=Z[0],ne=Z.pop();if(ne!==re){Z[0]=ne;e:for(var he=0,K=Z.length,ie=K>>>1;he<ie;){var pe=2*(he+1)-1,fe=Z[pe],Ne=pe+1,Te=Z[Ne];if(0>r(fe,ne))Ne<K&&0>r(Te,fe)?(Z[he]=Te,Z[Ne]=ne,he=Ne):(Z[he]=fe,Z[pe]=ne,he=pe);else if(Ne<K&&0>r(Te,ne))Z[he]=Te,Z[Ne]=ne,he=Ne;else break e}}return re}function r(Z,re){var ne=Z.sortIndex-re.sortIndex;return ne!==0?ne:Z.id-re.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,p=null,m=3,v=!1,x=!1,w=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function R(Z){for(var re=t(c);re!==null;){if(re.callback===null)s(c);else if(re.startTime<=Z)s(c),re.sortIndex=re.expirationTime,e(l,re);else break;re=t(c)}}function P(Z){if(w=!1,R(Z),!x)if(t(l)!==null)x=!0,U||(U=!0,W());else{var re=t(c);re!==null&&te(P,re.startTime-Z)}}var U=!1,j=-1,O=5,M=-1;function B(){return T?!0:!(n.unstable_now()-M<O)}function D(){if(T=!1,U){var Z=n.unstable_now();M=Z;var re=!0;try{e:{x=!1,w&&(w=!1,C(j),j=-1),v=!0;var ne=m;try{t:{for(R(Z),p=t(l);p!==null&&!(p.expirationTime>Z&&B());){var he=p.callback;if(typeof he=="function"){p.callback=null,m=p.priorityLevel;var K=he(p.expirationTime<=Z);if(Z=n.unstable_now(),typeof K=="function"){p.callback=K,R(Z),re=!0;break t}p===t(l)&&s(l),R(Z)}else s(l);p=t(l)}if(p!==null)re=!0;else{var ie=t(c);ie!==null&&te(P,ie.startTime-Z),re=!1}}break e}finally{p=null,m=ne,v=!1}re=void 0}}finally{re?W():U=!1}}}var W;if(typeof $=="function")W=function(){$(D)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,ae=H.port2;H.port1.onmessage=D,W=function(){ae.postMessage(null)}}else W=function(){E(D,0)};function te(Z,re){j=E(function(){Z(n.unstable_now())},re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Z){Z.callback=null},n.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<Z?Math.floor(1e3/Z):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var re=3;break;default:re=m}var ne=m;m=re;try{return Z()}finally{m=ne}},n.unstable_requestPaint=function(){T=!0},n.unstable_runWithPriority=function(Z,re){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ne=m;m=Z;try{return re()}finally{m=ne}},n.unstable_scheduleCallback=function(Z,re,ne){var he=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?he+ne:he):ne=he,Z){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ne+K,Z={id:h++,callback:re,priorityLevel:Z,startTime:ne,expirationTime:K,sortIndex:-1},ne>he?(Z.sortIndex=ne,e(c,Z),t(l)===null&&Z===t(c)&&(w?(C(j),j=-1):w=!0,te(P,ne-he))):(Z.sortIndex=K,e(l,Z),x||v||(x=!0,U||(U=!0,W()))),Z},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(Z){var re=m;return function(){var ne=m;m=re;try{return Z.apply(this,arguments)}finally{m=ne}}}})(CE)),CE}var hO;function WX(){return hO||(hO=1,IE.exports=GX()),IE.exports}var kE={exports:{}},Jr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dO;function HX(){if(dO)return Jr;dO=1;var n=vC();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function i(l,c,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:l,containerInfo:c,implementation:h}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Jr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Jr.createPortal=function(l,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return i(l,c,null,h)},Jr.flushSync=function(l){var c=a.T,h=s.p;try{if(a.T=null,s.p=2,l)return l()}finally{a.T=c,s.p=h,s.d.f()}},Jr.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,s.d.C(l,c))},Jr.prefetchDNS=function(l){typeof l=="string"&&s.d.D(l)},Jr.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var h=c.as,p=o(h,c.crossOrigin),m=typeof c.integrity=="string"?c.integrity:void 0,v=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;h==="style"?s.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:v}):h==="script"&&s.d.X(l,{crossOrigin:p,integrity:m,fetchPriority:v,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Jr.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var h=o(c.as,c.crossOrigin);s.d.M(l,{crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&s.d.M(l)},Jr.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var h=c.as,p=o(h,c.crossOrigin);s.d.L(l,h,{crossOrigin:p,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Jr.preloadModule=function(l,c){if(typeof l=="string")if(c){var h=o(c.as,c.crossOrigin);s.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else s.d.m(l)},Jr.requestFormReset=function(l){s.d.r(l)},Jr.unstable_batchedUpdates=function(l,c){return l(c)},Jr.useFormState=function(l,c,h){return a.H.useFormState(l,c,h)},Jr.useFormStatus=function(){return a.H.useHostTransitionStatus()},Jr.version="19.1.1",Jr}var fO;function qX(){if(fO)return kE.exports;fO=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),kE.exports=HX(),kE.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pO;function KX(){if(pO)return ny;pO=1;var n=WX(),e=vC(),t=qX();function s(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function i(u){var d=u,g=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,(d.flags&4098)!==0&&(g=d.return),u=d.return;while(u)}return d.tag===3?g:null}function a(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function o(u){if(i(u)!==u)throw Error(s(188))}function l(u){var d=u.alternate;if(!d){if(d=i(u),d===null)throw Error(s(188));return d!==u?null:u}for(var g=u,_=d;;){var I=g.return;if(I===null)break;var k=I.alternate;if(k===null){if(_=I.return,_!==null){g=_;continue}break}if(I.child===k.child){for(k=I.child;k;){if(k===g)return o(I),u;if(k===_)return o(I),d;k=k.sibling}throw Error(s(188))}if(g.return!==_.return)g=I,_=k;else{for(var q=!1,Y=I.child;Y;){if(Y===g){q=!0,g=I,_=k;break}if(Y===_){q=!0,_=I,g=k;break}Y=Y.sibling}if(!q){for(Y=k.child;Y;){if(Y===g){q=!0,g=k,_=I;break}if(Y===_){q=!0,_=k,g=I;break}Y=Y.sibling}if(!q)throw Error(s(189))}}if(g.alternate!==_)throw Error(s(190))}if(g.tag!==3)throw Error(s(188));return g.stateNode.current===g?u:d}function c(u){var d=u.tag;if(d===5||d===26||d===27||d===6)return u;for(u=u.child;u!==null;){if(d=c(u),d!==null)return d;u=u.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),$=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function W(u){return u===null||typeof u!="object"?null:(u=D&&u[D]||u["@@iterator"],typeof u=="function"?u:null)}var H=Symbol.for("react.client.reference");function ae(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===H?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case x:return"Fragment";case T:return"Profiler";case w:return"StrictMode";case P:return"Suspense";case U:return"SuspenseList";case M:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case v:return"Portal";case $:return(u.displayName||"Context")+".Provider";case C:return(u._context.displayName||"Context")+".Consumer";case R:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case j:return d=u.displayName||null,d!==null?d:ae(u.type)||"Memo";case O:d=u._payload,u=u._init;try{return ae(u(d))}catch{}}return null}var te=Array.isArray,Z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},he=[],K=-1;function ie(u){return{current:u}}function pe(u){0>K||(u.current=he[K],he[K]=null,K--)}function fe(u,d){K++,he[K]=u.current,u.current=d}var Ne=ie(null),Te=ie(null),Se=ie(null),He=ie(null);function qe(u,d){switch(fe(Se,d),fe(Te,u),fe(Ne,null),d.nodeType){case 9:case 11:u=(u=d.documentElement)&&(u=u.namespaceURI)?RL(u):0;break;default:if(u=d.tagName,d=d.namespaceURI)d=RL(d),u=DL(d,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}pe(Ne),fe(Ne,u)}function Qe(){pe(Ne),pe(Te),pe(Se)}function pt(u){u.memoizedState!==null&&fe(He,u);var d=Ne.current,g=DL(d,u.type);d!==g&&(fe(Te,u),fe(Ne,g))}function vt(u){Te.current===u&&(pe(Ne),pe(Te)),He.current===u&&(pe(He),Zg._currentValue=ne)}var Lt=Object.prototype.hasOwnProperty,Gt=n.unstable_scheduleCallback,gn=n.unstable_cancelCallback,un=n.unstable_shouldYield,qt=n.unstable_requestPaint,Ot=n.unstable_now,sn=n.unstable_getCurrentPriorityLevel,wn=n.unstable_ImmediatePriority,jt=n.unstable_UserBlockingPriority,bs=n.unstable_NormalPriority,Bs=n.unstable_LowPriority,qr=n.unstable_IdlePriority,kr=n.log,Js=n.unstable_setDisableYieldValue,$s=null,An=null;function ns(u){if(typeof kr=="function"&&Js(u),An&&typeof An.setStrictMode=="function")try{An.setStrictMode($s,u)}catch{}}var hs=Math.clz32?Math.clz32:hu,el=Math.log,mo=Math.LN2;function hu(u){return u>>>=0,u===0?32:31-(el(u)/mo|0)|0}var hr=256,Mi=4194304;function Kr(u){var d=u&42;if(d!==0)return d;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function Fi(u,d,g){var _=u.pendingLanes;if(_===0)return 0;var I=0,k=u.suspendedLanes,q=u.pingedLanes;u=u.warmLanes;var Y=_&134217727;return Y!==0?(_=Y&~k,_!==0?I=Kr(_):(q&=Y,q!==0?I=Kr(q):g||(g=Y&~u,g!==0&&(I=Kr(g))))):(Y=_&~k,Y!==0?I=Kr(Y):q!==0?I=Kr(q):g||(g=_&~u,g!==0&&(I=Kr(g)))),I===0?0:d!==0&&d!==I&&(d&k)===0&&(k=I&-I,g=d&-d,k>=g||k===32&&(g&4194048)!==0)?d:I}function ji(u,d){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&d)===0}function du(u,d){switch(u){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ud(){var u=hr;return hr<<=1,(hr&4194048)===0&&(hr=256),u}function go(){var u=Mi;return Mi<<=1,(Mi&62914560)===0&&(Mi=4194304),u}function ac(u){for(var d=[],g=0;31>g;g++)d.push(u);return d}function ss(u,d){u.pendingLanes|=d,d!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function Jf(u,d,g,_,I,k){var q=u.pendingLanes;u.pendingLanes=g,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=g,u.entangledLanes&=g,u.errorRecoveryDisabledLanes&=g,u.shellSuspendCounter=0;var Y=u.entanglements,ce=u.expirationTimes,$e=u.hiddenUpdates;for(g=q&~g;0<g;){var Fe=31-hs(g),Ve=1<<Fe;Y[Fe]=0,ce[Fe]=-1;var Ae=$e[Fe];if(Ae!==null)for($e[Fe]=null,Fe=0;Fe<Ae.length;Fe++){var Le=Ae[Fe];Le!==null&&(Le.lane&=-536870913)}g&=~Ve}_!==0&&tl(u,_,0),k!==0&&I===0&&u.tag!==0&&(u.suspendedLanes|=k&~(q&~d))}function tl(u,d,g){u.pendingLanes|=d,u.suspendedLanes&=~d;var _=31-hs(d);u.entangledLanes|=d,u.entanglements[_]=u.entanglements[_]|1073741824|g&4194090}function nl(u,d){var g=u.entangledLanes|=d;for(u=u.entanglements;g;){var _=31-hs(g),I=1<<_;I&d|u[_]&d&&(u[_]|=d),g&=~I}}function hd(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function dd(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function yo(){var u=re.p;return u!==0?u:(u=window.event,u===void 0?32:QL(u.type))}function fd(u,d){var g=re.p;try{return re.p=u,d()}finally{re.p=g}}var Oa=Math.random().toString(36).slice(2),ds="__reactFiber$"+Oa,er="__reactProps$"+Oa,vo="__reactContainer$"+Oa,dr="__reactEvents$"+Oa,ot="__reactListeners$"+Oa,ep="__reactHandles$"+Oa,Bi="__reactResources$"+Oa,bo="__reactMarker$"+Oa;function oc(u){delete u[ds],delete u[er],delete u[dr],delete u[ot],delete u[ep]}function zi(u){var d=u[ds];if(d)return d;for(var g=u.parentNode;g;){if(d=g[vo]||g[ds]){if(g=d.alternate,d.child!==null||g!==null&&g.child!==null)for(u=ML(u);u!==null;){if(g=u[ds])return g;u=ML(u)}return d}u=g,g=u.parentNode}return null}function oa(u){if(u=u[ds]||u[vo]){var d=u.tag;if(d===5||d===6||d===13||d===26||d===27||d===3)return u}return null}function mi(u){var d=u.tag;if(d===5||d===26||d===27||d===6)return u.stateNode;throw Error(s(33))}function _o(u){var d=u[Bi];return d||(d=u[Bi]={hoistableStyles:new Map,hoistableScripts:new Map}),d}function fs(u){u[bo]=!0}var tp=new Set,lc={};function Pa(u,d){la(u,d),la(u+"Capture",d)}function la(u,d){for(lc[u]=d,u=0;u<d.length;u++)tp.add(d[u])}var cc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gi={},fu={};function pg(u){return Lt.call(fu,u)?!0:Lt.call(gi,u)?!1:cc.test(u)?fu[u]=!0:(gi[u]=!0,!1)}function uc(u,d,g){if(pg(d))if(g===null)u.removeAttribute(d);else{switch(typeof g){case"undefined":case"function":case"symbol":u.removeAttribute(d);return;case"boolean":var _=d.toLowerCase().slice(0,5);if(_!=="data-"&&_!=="aria-"){u.removeAttribute(d);return}}u.setAttribute(d,""+g)}}function hc(u,d,g){if(g===null)u.removeAttribute(d);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(d);return}u.setAttribute(d,""+g)}}function Vi(u,d,g,_){if(_===null)u.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(g);return}u.setAttributeNS(d,g,""+_)}}var xo,Ma;function Fa(u){if(xo===void 0)try{throw Error()}catch(g){var d=g.stack.trim().match(/\n( *(at )?)/);xo=d&&d[1]||"",Ma=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xo+u+Ma}var dc=!1;function ja(u,d){if(!u||dc)return"";dc=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var _={DetermineComponentFrameRoot:function(){try{if(d){var Ve=function(){throw Error()};if(Object.defineProperty(Ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ve,[])}catch(Le){var Ae=Le}Reflect.construct(u,[],Ve)}else{try{Ve.call()}catch(Le){Ae=Le}u.call(Ve.prototype)}}else{try{throw Error()}catch(Le){Ae=Le}(Ve=u())&&typeof Ve.catch=="function"&&Ve.catch(function(){})}}catch(Le){if(Le&&Ae&&typeof Le.stack=="string")return[Le.stack,Ae.stack]}return[null,null]}};_.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(_.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(_.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=_.DetermineComponentFrameRoot(),q=k[0],Y=k[1];if(q&&Y){var ce=q.split(`
`),$e=Y.split(`
`);for(I=_=0;_<ce.length&&!ce[_].includes("DetermineComponentFrameRoot");)_++;for(;I<$e.length&&!$e[I].includes("DetermineComponentFrameRoot");)I++;if(_===ce.length||I===$e.length)for(_=ce.length-1,I=$e.length-1;1<=_&&0<=I&&ce[_]!==$e[I];)I--;for(;1<=_&&0<=I;_--,I--)if(ce[_]!==$e[I]){if(_!==1||I!==1)do if(_--,I--,0>I||ce[_]!==$e[I]){var Fe=`
`+ce[_].replace(" at new "," at ");return u.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",u.displayName)),Fe}while(1<=_&&0<=I);break}}}finally{dc=!1,Error.prepareStackTrace=g}return(g=u?u.displayName||u.name:"")?Fa(g):""}function Jt(u){switch(u.tag){case 26:case 27:case 5:return Fa(u.type);case 16:return Fa("Lazy");case 13:return Fa("Suspense");case 19:return Fa("SuspenseList");case 0:case 15:return ja(u.type,!1);case 11:return ja(u.type.render,!1);case 1:return ja(u.type,!0);case 31:return Fa("Activity");default:return""}}function rn(u){try{var d="";do d+=Jt(u),u=u.return;while(u);return d}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function Rn(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function yi(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Ui(u){var d=yi(u)?"checked":"value",g=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),_=""+u[d];if(!u.hasOwnProperty(d)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var I=g.get,k=g.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return I.call(this)},set:function(q){_=""+q,k.call(this,q)}}),Object.defineProperty(u,d,{enumerable:g.enumerable}),{getValue:function(){return _},setValue:function(q){_=""+q},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function Ba(u){u._valueTracker||(u._valueTracker=Ui(u))}function st(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var g=d.getValue(),_="";return u&&(_=yi(u)?u.checked?"true":"false":u.value),u=_,u!==g?(d.setValue(u),!0):!1}function Tn(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var wo=/[\n"\\]/g;function ps(u){return u.replace(wo,function(d){return"\\"+d.charCodeAt(0).toString(16)+" "})}function fr(u,d,g,_,I,k,q,Y){u.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?u.type=q:u.removeAttribute("type"),d!=null?q==="number"?(d===0&&u.value===""||u.value!=d)&&(u.value=""+Rn(d)):u.value!==""+Rn(d)&&(u.value=""+Rn(d)):q!=="submit"&&q!=="reset"||u.removeAttribute("value"),d!=null?sl(u,q,Rn(d)):g!=null?sl(u,q,Rn(g)):_!=null&&u.removeAttribute("value"),I==null&&k!=null&&(u.defaultChecked=!!k),I!=null&&(u.checked=I&&typeof I!="function"&&typeof I!="symbol"),Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?u.name=""+Rn(Y):u.removeAttribute("name")}function pd(u,d,g,_,I,k,q,Y){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(u.type=k),d!=null||g!=null){if(!(k!=="submit"&&k!=="reset"||d!=null))return;g=g!=null?""+Rn(g):"",d=d!=null?""+Rn(d):g,Y||d===u.value||(u.value=d),u.defaultValue=d}_=_??I,_=typeof _!="function"&&typeof _!="symbol"&&!!_,u.checked=Y?u.checked:!!_,u.defaultChecked=!!_,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(u.name=q)}function sl(u,d,g){d==="number"&&Tn(u.ownerDocument)===u||u.defaultValue===""+g||(u.defaultValue=""+g)}function Xr(u,d,g,_){if(u=u.options,d){d={};for(var I=0;I<g.length;I++)d["$"+g[I]]=!0;for(g=0;g<u.length;g++)I=d.hasOwnProperty("$"+u[g].value),u[g].selected!==I&&(u[g].selected=I),I&&_&&(u[g].defaultSelected=!0)}else{for(g=""+Rn(g),d=null,I=0;I<u.length;I++){if(u[I].value===g){u[I].selected=!0,_&&(u[I].defaultSelected=!0);return}d!==null||u[I].disabled||(d=u[I])}d!==null&&(d.selected=!0)}}function Zn(u,d,g){if(d!=null&&(d=""+Rn(d),d!==u.value&&(u.value=d),g==null)){u.defaultValue!==d&&(u.defaultValue=d);return}u.defaultValue=g!=null?""+Rn(g):""}function za(u,d,g,_){if(d==null){if(_!=null){if(g!=null)throw Error(s(92));if(te(_)){if(1<_.length)throw Error(s(93));_=_[0]}g=_}g==null&&(g=""),d=g}g=Rn(d),u.defaultValue=g,_=u.textContent,_===g&&_!==""&&_!==null&&(u.value=_)}function pr(u,d){if(d){var g=u.firstChild;if(g&&g===u.lastChild&&g.nodeType===3){g.nodeValue=d;return}}u.textContent=d}var vi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fc(u,d,g){var _=d.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?_?u.setProperty(d,""):d==="float"?u.cssFloat="":u[d]="":_?u.setProperty(d,g):typeof g!="number"||g===0||vi.has(d)?d==="float"?u.cssFloat=g:u[d]=(""+g).trim():u[d]=g+"px"}function To(u,d,g){if(d!=null&&typeof d!="object")throw Error(s(62));if(u=u.style,g!=null){for(var _ in g)!g.hasOwnProperty(_)||d!=null&&d.hasOwnProperty(_)||(_.indexOf("--")===0?u.setProperty(_,""):_==="float"?u.cssFloat="":u[_]="");for(var I in d)_=d[I],d.hasOwnProperty(I)&&g[I]!==_&&fc(u,I,_)}else for(var k in d)d.hasOwnProperty(k)&&fc(u,k,d[k])}function rl(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),pc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bi(u){return pc.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}var mc=null;function il(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var So=null,tr=null;function np(u){var d=oa(u);if(d&&(u=d.stateNode)){var g=u[er]||null;e:switch(u=d.stateNode,d.type){case"input":if(fr(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),d=g.name,g.type==="radio"&&d!=null){for(g=u;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+ps(""+d)+'"][type="radio"]'),d=0;d<g.length;d++){var _=g[d];if(_!==u&&_.form===u.form){var I=_[er]||null;if(!I)throw Error(s(90));fr(_,I.value,I.defaultValue,I.defaultValue,I.checked,I.defaultChecked,I.type,I.name)}}for(d=0;d<g.length;d++)_=g[d],_.form===u.form&&st(_)}break e;case"textarea":Zn(u,g.value,g.defaultValue);break e;case"select":d=g.value,d!=null&&Xr(u,!!g.multiple,d,!1)}}}var xt=!1;function mr(u,d,g){if(xt)return u(d,g);xt=!0;try{var _=u(d);return _}finally{if(xt=!1,(So!==null||tr!==null)&&(K_(),So&&(d=So,u=tr,tr=So=null,np(d),u)))for(d=0;d<u.length;d++)np(u[d])}}function an(u,d){var g=u.stateNode;if(g===null)return null;var _=g[er]||null;if(_===null)return null;g=_[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(u=u.type,_=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!_;break e;default:u=!1}if(u)return null;if(g&&typeof g!="function")throw Error(s(231,d,typeof g));return g}var gr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ca=!1;if(gr)try{var Va={};Object.defineProperty(Va,"passive",{get:function(){ca=!0}}),window.addEventListener("test",Va,Va),window.removeEventListener("test",Va,Va)}catch{ca=!1}var Zr=null,hn=null,al=null;function ol(){if(al)return al;var u,d=hn,g=d.length,_,I="value"in Zr?Zr.value:Zr.textContent,k=I.length;for(u=0;u<g&&d[u]===I[u];u++);var q=g-u;for(_=1;_<=q&&d[g-_]===I[k-_];_++);return al=I.slice(u,1<_?1-_:void 0)}function Yn(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function _i(){return!0}function mu(){return!1}function _s(u){function d(g,_,I,k,q){this._reactName=g,this._targetInst=I,this.type=_,this.nativeEvent=k,this.target=q,this.currentTarget=null;for(var Y in u)u.hasOwnProperty(Y)&&(g=u[Y],this[Y]=g?g(k):k[Y]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?_i:mu,this.isPropagationStopped=mu,this}return h(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=_i)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=_i)},persist:function(){},isPersistent:_i}),d}var yr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ll=_s(yr),Eo=h({},yr,{view:0,detail:0}),gc=_s(Eo),yc,Pt,Ua,nr=h({},Eo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vc,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Ua&&(Ua&&u.type==="mousemove"?(yc=u.screenX-Ua.screenX,Pt=u.screenY-Ua.screenY):Pt=yc=0,Ua=u),yc)},movementY:function(u){return"movementY"in u?u.movementY:Pt}}),ua=_s(nr),sp=h({},nr,{dataTransfer:0}),rp=_s(sp),No=h({},Eo,{relatedTarget:0}),gu=_s(No),md=h({},yr,{animationName:0,elapsedTime:0,pseudoElement:0}),gd=_s(md),yd=h({},yr,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),yu=_s(yd),vu=h({},yr,{data:0}),Yr=_s(vu),ip={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ga={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ha={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vd(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=ha[u])?!!d[u]:!1}function vc(){return vd}var bu=h({},Eo,{key:function(u){if(u.key){var d=ip[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=Yn(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?Ga[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vc,charCode:function(u){return u.type==="keypress"?Yn(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Yn(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),_u=_s(bu),vr=h({},nr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xu=_s(vr),ap=h({},Eo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vc}),cl=_s(ap),S=h({},yr,{propertyName:0,elapsedTime:0,pseudoElement:0}),F=_s(S),G=h({},nr,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),ee=_s(G),Ie=h({},yr,{newState:0,oldState:0}),Re=_s(Ie),Xe=[9,13,27,32],wt=gr&&"CompositionEvent"in window,Kt=null;gr&&"documentMode"in document&&(Kt=document.documentMode);var yn=gr&&"TextEvent"in window&&!Kt,rs=gr&&(!wt||Kt&&8<Kt&&11>=Kt),xi=" ",Gi=!1;function wi(u,d){switch(u){case"keyup":return Xe.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function da(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var fa=!1;function wu(u,d){switch(u){case"compositionend":return da(d);case"keypress":return d.which!==32?null:(Gi=!0,xi);case"textInput":return u=d.data,u===xi&&Gi?null:u;default:return null}}function qT(u,d){if(fa)return u==="compositionend"||!wt&&wi(u,d)?(u=ol(),al=hn=Zr=null,fa=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return rs&&d.locale!=="ko"?null:d.data;default:return null}}var pa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bc(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!pa[u.type]:d==="textarea"}function d_(u,d,g,_){So?tr?tr.push(_):tr=[_]:So=_,d=ex(d,"onChange"),0<d.length&&(g=new ll("onChange","change",null,g,_),u.push({event:g,listeners:d}))}var Ti=null,bd=null;function Tu(u){IL(u,0)}function op(u){var d=mi(u);if(st(d))return u}function Su(u,d){if(u==="change")return d}var mg=!1;if(gr){var Eu;if(gr){var gg="oninput"in document;if(!gg){var Io=document.createElement("div");Io.setAttribute("oninput","return;"),gg=typeof Io.oninput=="function"}Eu=gg}else Eu=!1;mg=Eu&&(!document.documentMode||9<document.documentMode)}function _d(){Ti&&(Ti.detachEvent("onpropertychange",f_),bd=Ti=null)}function f_(u){if(u.propertyName==="value"&&op(bd)){var d=[];d_(d,bd,u,il(u)),mr(Tu,d)}}function yg(u,d,g){u==="focusin"?(_d(),Ti=d,bd=g,Ti.attachEvent("onpropertychange",f_)):u==="focusout"&&_d()}function KT(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return op(bd)}function Co(u,d){if(u==="click")return op(d)}function XT(u,d){if(u==="input"||u==="change")return op(d)}function Nu(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var Si=typeof Object.is=="function"?Object.is:Nu;function Ei(u,d){if(Si(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var g=Object.keys(u),_=Object.keys(d);if(g.length!==_.length)return!1;for(_=0;_<g.length;_++){var I=g[_];if(!Lt.call(d,I)||!Si(u[I],d[I]))return!1}return!0}function xd(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function vg(u,d){var g=xd(u);u=0;for(var _;g;){if(g.nodeType===3){if(_=u+g.textContent.length,u<=d&&_>=d)return{node:g,offset:d-u};u=_}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=xd(g)}}function lp(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?lp(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function wd(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var d=Tn(u.document);d instanceof u.HTMLIFrameElement;){try{var g=typeof d.contentWindow.location.href=="string"}catch{g=!1}if(g)u=d.contentWindow;else break;d=Tn(u.document)}return d}function Td(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}var cp=gr&&"documentMode"in document&&11>=document.documentMode,ma=null,Iu=null,_c=null,up=!1;function p_(u,d,g){var _=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;up||ma==null||ma!==Tn(_)||(_=ma,"selectionStart"in _&&Td(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),_c&&Ei(_c,_)||(_c=_,_=ex(Iu,"onSelect"),0<_.length&&(d=new ll("onSelect","select",null,d,g),u.push({event:d,listeners:_}),d.target=ma)))}function Wa(u,d){var g={};return g[u.toLowerCase()]=d.toLowerCase(),g["Webkit"+u]="webkit"+d,g["Moz"+u]="moz"+d,g}var Cu={animationend:Wa("Animation","AnimationEnd"),animationiteration:Wa("Animation","AnimationIteration"),animationstart:Wa("Animation","AnimationStart"),transitionrun:Wa("Transition","TransitionRun"),transitionstart:Wa("Transition","TransitionStart"),transitioncancel:Wa("Transition","TransitionCancel"),transitionend:Wa("Transition","TransitionEnd")},hp={},m_={};gr&&(m_=document.createElement("div").style,"AnimationEvent"in window||(delete Cu.animationend.animation,delete Cu.animationiteration.animation,delete Cu.animationstart.animation),"TransitionEvent"in window||delete Cu.transitionend.transition);function ul(u){if(hp[u])return hp[u];if(!Cu[u])return u;var d=Cu[u],g;for(g in d)if(d.hasOwnProperty(g)&&g in m_)return hp[u]=d[g];return u}var g_=ul("animationend"),ga=ul("animationiteration"),Sd=ul("animationstart"),ZT=ul("transitionrun"),dp=ul("transitionstart"),YT=ul("transitioncancel"),bg=ul("transitionend"),y_=new Map,xc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xc.push("scrollEnd");function ya(u,d){y_.set(u,d),Pa(d,[u])}var wc=new WeakMap;function Ni(u,d){if(typeof u=="object"&&u!==null){var g=wc.get(u);return g!==void 0?g:(d={value:u,source:d,stack:rn(d)},wc.set(u,d),d)}return{value:u,source:d,stack:rn(d)}}var Ii=[],ku=0,va=0;function Ed(){for(var u=ku,d=va=ku=0;d<u;){var g=Ii[d];Ii[d++]=null;var _=Ii[d];Ii[d++]=null;var I=Ii[d];Ii[d++]=null;var k=Ii[d];if(Ii[d++]=null,_!==null&&I!==null){var q=_.pending;q===null?I.next=I:(I.next=q.next,q.next=I),_.pending=I}k!==0&&Id(g,I,k)}}function Nd(u,d,g,_){Ii[ku++]=u,Ii[ku++]=d,Ii[ku++]=g,Ii[ku++]=_,va|=_,u.lanes|=_,u=u.alternate,u!==null&&(u.lanes|=_)}function Tc(u,d,g,_){return Nd(u,d,g,_),hl(u)}function $u(u,d){return Nd(u,null,null,d),hl(u)}function Id(u,d,g){u.lanes|=g;var _=u.alternate;_!==null&&(_.lanes|=g);for(var I=!1,k=u.return;k!==null;)k.childLanes|=g,_=k.alternate,_!==null&&(_.childLanes|=g),k.tag===22&&(u=k.stateNode,u===null||u._visibility&1||(I=!0)),u=k,k=k.return;return u.tag===3?(k=u.stateNode,I&&d!==null&&(I=31-hs(g),u=k.hiddenUpdates,_=u[I],_===null?u[I]=[d]:_.push(d),d.lane=g|536870912),k):null}function hl(u){if(50<Vg)throw Vg=0,KS=null,Error(s(185));for(var d=u.return;d!==null;)u=d,d=u.return;return u.tag===3?u.stateNode:null}var Sc={};function v_(u,d,g,_){this.tag=u,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ci(u,d,g,_){return new v_(u,d,g,_)}function fp(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Ha(u,d){var g=u.alternate;return g===null?(g=Ci(u.tag,d,u.key,u.mode),g.elementType=u.elementType,g.type=u.type,g.stateNode=u.stateNode,g.alternate=u,u.alternate=g):(g.pendingProps=d,g.type=u.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=u.flags&65011712,g.childLanes=u.childLanes,g.lanes=u.lanes,g.child=u.child,g.memoizedProps=u.memoizedProps,g.memoizedState=u.memoizedState,g.updateQueue=u.updateQueue,d=u.dependencies,g.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},g.sibling=u.sibling,g.index=u.index,g.ref=u.ref,g.refCleanup=u.refCleanup,g}function _g(u,d){u.flags&=65011714;var g=u.alternate;return g===null?(u.childLanes=0,u.lanes=d,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=g.childLanes,u.lanes=g.lanes,u.child=g.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=g.memoizedProps,u.memoizedState=g.memoizedState,u.updateQueue=g.updateQueue,u.type=g.type,d=g.dependencies,u.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),u}function Cd(u,d,g,_,I,k){var q=0;if(_=u,typeof u=="function")fp(u)&&(q=1);else if(typeof u=="string")q=EX(u,g,Ne.current)?26:u==="html"||u==="head"||u==="body"?27:5;else e:switch(u){case M:return u=Ci(31,g,d,I),u.elementType=M,u.lanes=k,u;case x:return dl(g.children,I,k,d);case w:q=8,I|=24;break;case T:return u=Ci(12,g,d,I|2),u.elementType=T,u.lanes=k,u;case P:return u=Ci(13,g,d,I),u.elementType=P,u.lanes=k,u;case U:return u=Ci(19,g,d,I),u.elementType=U,u.lanes=k,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case E:case $:q=10;break e;case C:q=9;break e;case R:q=11;break e;case j:q=14;break e;case O:q=16,_=null;break e}q=29,g=Error(s(130,u===null?"null":typeof u,"")),_=null}return d=Ci(q,g,d,I),d.elementType=u,d.type=_,d.lanes=k,d}function dl(u,d,g,_){return u=Ci(7,u,_,d),u.lanes=g,u}function xg(u,d,g){return u=Ci(6,u,null,d),u.lanes=g,u}function pp(u,d,g){return d=Ci(4,u.children!==null?u.children:[],u.key,d),d.lanes=g,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}var Ec=[],Au=0,f=null,b=0,N=[],A=0,z=null,X=1,le="";function Ee(u,d){Ec[Au++]=b,Ec[Au++]=f,f=u,b=d}function Oe(u,d,g){N[A++]=X,N[A++]=le,N[A++]=z,z=u;var _=X;u=le;var I=32-hs(_)-1;_&=~(1<<I),g+=1;var k=32-hs(d)+I;if(30<k){var q=I-I%5;k=(_&(1<<q)-1).toString(32),_>>=q,I-=q,X=1<<32-hs(d)+I|g<<I|_,le=k+u}else X=1<<k|g<<I|_,le=u}function Ge(u){u.return!==null&&(Ee(u,1),Oe(u,1,0))}function Je(u){for(;u===f;)f=Ec[--Au],Ec[Au]=null,b=Ec[--Au],Ec[Au]=null;for(;u===z;)z=N[--A],N[A]=null,le=N[--A],N[A]=null,X=N[--A],N[A]=null}var it=null,ut=null,kt=!1,Wn=null,ms=!1,br=Error(s(519));function Wi(u){var d=Error(s(418,""));throw Du(Ni(d,u)),br}function b_(u){var d=u.stateNode,g=u.type,_=u.memoizedProps;switch(d[ds]=u,d[er]=_,g){case"dialog":Qt("cancel",d),Qt("close",d);break;case"iframe":case"object":case"embed":Qt("load",d);break;case"video":case"audio":for(g=0;g<Gg.length;g++)Qt(Gg[g],d);break;case"source":Qt("error",d);break;case"img":case"image":case"link":Qt("error",d),Qt("load",d);break;case"details":Qt("toggle",d);break;case"input":Qt("invalid",d),pd(d,_.value,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name,!0),Ba(d);break;case"select":Qt("invalid",d);break;case"textarea":Qt("invalid",d),za(d,_.value,_.defaultValue,_.children),Ba(d)}g=_.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||d.textContent===""+g||_.suppressHydrationWarning===!0||AL(d.textContent,g)?(_.popover!=null&&(Qt("beforetoggle",d),Qt("toggle",d)),_.onScroll!=null&&Qt("scroll",d),_.onScrollEnd!=null&&Qt("scrollend",d),_.onClick!=null&&(d.onclick=tx),d=!0):d=!1,d||Wi(u)}function __(u){for(it=u.return;it;)switch(it.tag){case 5:case 13:ms=!1;return;case 27:case 3:ms=!0;return;default:it=it.return}}function kd(u){if(u!==it)return!1;if(!kt)return __(u),kt=!0,!1;var d=u.tag,g;if((g=d!==3&&d!==27)&&((g=d===5)&&(g=u.type,g=!(g!=="form"&&g!=="button")||uE(u.type,u.memoizedProps)),g=!g),g&&ut&&Wi(u),__(u),d===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8)if(g=u.data,g==="/$"){if(d===0){ut=Ro(u.nextSibling);break e}d--}else g!=="$"&&g!=="$!"&&g!=="$?"||d++;u=u.nextSibling}ut=null}}else d===27?(d=ut,Ku(u.type)?(u=pE,pE=null,ut=u):ut=d):ut=it?Ro(u.stateNode.nextSibling):null;return!0}function Ru(){ut=it=null,kt=!1}function x_(){var u=Wn;return u!==null&&(Ki===null?Ki=u:Ki.push.apply(Ki,u),Wn=null),u}function Du(u){Wn===null?Wn=[u]:Wn.push(u)}var is=ie(null),qa=null,ko=null;function fl(u,d,g){fe(is,d._currentValue),d._currentValue=g}function $o(u){u._currentValue=is.current,pe(is)}function $d(u,d,g){for(;u!==null;){var _=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,_!==null&&(_.childLanes|=d)):_!==null&&(_.childLanes&d)!==d&&(_.childLanes|=d),u===g)break;u=u.return}}function mp(u,d,g,_){var I=u.child;for(I!==null&&(I.return=u);I!==null;){var k=I.dependencies;if(k!==null){var q=I.child;k=k.firstContext;e:for(;k!==null;){var Y=k;k=I;for(var ce=0;ce<d.length;ce++)if(Y.context===d[ce]){k.lanes|=g,Y=k.alternate,Y!==null&&(Y.lanes|=g),$d(k.return,g,u),_||(q=null);break e}k=Y.next}}else if(I.tag===18){if(q=I.return,q===null)throw Error(s(341));q.lanes|=g,k=q.alternate,k!==null&&(k.lanes|=g),$d(q,g,u),q=null}else q=I.child;if(q!==null)q.return=I;else for(q=I;q!==null;){if(q===u){q=null;break}if(I=q.sibling,I!==null){I.return=q.return,q=I;break}q=q.return}I=q}}function Ad(u,d,g,_){u=null;for(var I=d,k=!1;I!==null;){if(!k){if((I.flags&524288)!==0)k=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var q=I.alternate;if(q===null)throw Error(s(387));if(q=q.memoizedProps,q!==null){var Y=I.type;Si(I.pendingProps.value,q.value)||(u!==null?u.push(Y):u=[Y])}}else if(I===He.current){if(q=I.alternate,q===null)throw Error(s(387));q.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(u!==null?u.push(Zg):u=[Zg])}I=I.return}u!==null&&mp(d,u,g,_),d.flags|=262144}function w_(u){for(u=u.firstContext;u!==null;){if(!Si(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function Rd(u){qa=u,ko=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function Qr(u){return yR(qa,u)}function T_(u,d){return qa===null&&Rd(u),yR(u,d)}function yR(u,d){var g=d._currentValue;if(d={context:d,memoizedValue:g,next:null},ko===null){if(u===null)throw Error(s(308));ko=d,u.dependencies={lanes:0,firstContext:d},u.flags|=524288}else ko=ko.next=d;return g}var S7=typeof AbortController<"u"?AbortController:function(){var u=[],d=this.signal={aborted:!1,addEventListener:function(g,_){u.push(_)}};this.abort=function(){d.aborted=!0,u.forEach(function(g){return g()})}},E7=n.unstable_scheduleCallback,N7=n.unstable_NormalPriority,sr={$$typeof:$,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function QT(){return{controller:new S7,data:new Map,refCount:0}}function wg(u){u.refCount--,u.refCount===0&&E7(N7,function(){u.controller.abort()})}var Tg=null,JT=0,gp=0,yp=null;function I7(u,d){if(Tg===null){var g=Tg=[];JT=0,gp=tE(),yp={status:"pending",value:void 0,then:function(_){g.push(_)}}}return JT++,d.then(vR,vR),d}function vR(){if(--JT===0&&Tg!==null){yp!==null&&(yp.status="fulfilled");var u=Tg;Tg=null,gp=0,yp=null;for(var d=0;d<u.length;d++)(0,u[d])()}}function C7(u,d){var g=[],_={status:"pending",value:null,reason:null,then:function(I){g.push(I)}};return u.then(function(){_.status="fulfilled",_.value=d;for(var I=0;I<g.length;I++)(0,g[I])(d)},function(I){for(_.status="rejected",_.reason=I,I=0;I<g.length;I++)(0,g[I])(void 0)}),_}var bR=Z.S;Z.S=function(u,d){typeof d=="object"&&d!==null&&typeof d.then=="function"&&I7(u,d),bR!==null&&bR(u,d)};var Dd=ie(null);function eS(){var u=Dd.current;return u!==null?u:Hn.pooledCache}function S_(u,d){d===null?fe(Dd,Dd.current):fe(Dd,d.pool)}function _R(){var u=eS();return u===null?null:{parent:sr._currentValue,pool:u}}var Sg=Error(s(460)),xR=Error(s(474)),E_=Error(s(542)),tS={then:function(){}};function wR(u){return u=u.status,u==="fulfilled"||u==="rejected"}function N_(){}function TR(u,d,g){switch(g=u[g],g===void 0?u.push(d):g!==d&&(d.then(N_,N_),d=g),d.status){case"fulfilled":return d.value;case"rejected":throw u=d.reason,ER(u),u;default:if(typeof d.status=="string")d.then(N_,N_);else{if(u=Hn,u!==null&&100<u.shellSuspendCounter)throw Error(s(482));u=d,u.status="pending",u.then(function(_){if(d.status==="pending"){var I=d;I.status="fulfilled",I.value=_}},function(_){if(d.status==="pending"){var I=d;I.status="rejected",I.reason=_}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw u=d.reason,ER(u),u}throw Eg=d,Sg}}var Eg=null;function SR(){if(Eg===null)throw Error(s(459));var u=Eg;return Eg=null,u}function ER(u){if(u===Sg||u===E_)throw Error(s(483))}var Lu=!1;function nS(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sS(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Ou(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function Pu(u,d,g){var _=u.updateQueue;if(_===null)return null;if(_=_.shared,(Cn&2)!==0){var I=_.pending;return I===null?d.next=d:(d.next=I.next,I.next=d),_.pending=d,d=hl(u),Id(u,null,g),d}return Nd(u,_,d,g),hl(u)}function Ng(u,d,g){if(d=d.updateQueue,d!==null&&(d=d.shared,(g&4194048)!==0)){var _=d.lanes;_&=u.pendingLanes,g|=_,d.lanes=g,nl(u,g)}}function rS(u,d){var g=u.updateQueue,_=u.alternate;if(_!==null&&(_=_.updateQueue,g===_)){var I=null,k=null;if(g=g.firstBaseUpdate,g!==null){do{var q={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};k===null?I=k=q:k=k.next=q,g=g.next}while(g!==null);k===null?I=k=d:k=k.next=d}else I=k=d;g={baseState:_.baseState,firstBaseUpdate:I,lastBaseUpdate:k,shared:_.shared,callbacks:_.callbacks},u.updateQueue=g;return}u=g.lastBaseUpdate,u===null?g.firstBaseUpdate=d:u.next=d,g.lastBaseUpdate=d}var iS=!1;function Ig(){if(iS){var u=yp;if(u!==null)throw u}}function Cg(u,d,g,_){iS=!1;var I=u.updateQueue;Lu=!1;var k=I.firstBaseUpdate,q=I.lastBaseUpdate,Y=I.shared.pending;if(Y!==null){I.shared.pending=null;var ce=Y,$e=ce.next;ce.next=null,q===null?k=$e:q.next=$e,q=ce;var Fe=u.alternate;Fe!==null&&(Fe=Fe.updateQueue,Y=Fe.lastBaseUpdate,Y!==q&&(Y===null?Fe.firstBaseUpdate=$e:Y.next=$e,Fe.lastBaseUpdate=ce))}if(k!==null){var Ve=I.baseState;q=0,Fe=$e=ce=null,Y=k;do{var Ae=Y.lane&-536870913,Le=Ae!==Y.lane;if(Le?(dn&Ae)===Ae:(_&Ae)===Ae){Ae!==0&&Ae===gp&&(iS=!0),Fe!==null&&(Fe=Fe.next={lane:0,tag:Y.tag,payload:Y.payload,callback:null,next:null});e:{var Ct=u,bt=Y;Ae=d;var On=g;switch(bt.tag){case 1:if(Ct=bt.payload,typeof Ct=="function"){Ve=Ct.call(On,Ve,Ae);break e}Ve=Ct;break e;case 3:Ct.flags=Ct.flags&-65537|128;case 0:if(Ct=bt.payload,Ae=typeof Ct=="function"?Ct.call(On,Ve,Ae):Ct,Ae==null)break e;Ve=h({},Ve,Ae);break e;case 2:Lu=!0}}Ae=Y.callback,Ae!==null&&(u.flags|=64,Le&&(u.flags|=8192),Le=I.callbacks,Le===null?I.callbacks=[Ae]:Le.push(Ae))}else Le={lane:Ae,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},Fe===null?($e=Fe=Le,ce=Ve):Fe=Fe.next=Le,q|=Ae;if(Y=Y.next,Y===null){if(Y=I.shared.pending,Y===null)break;Le=Y,Y=Le.next,Le.next=null,I.lastBaseUpdate=Le,I.shared.pending=null}}while(!0);Fe===null&&(ce=Ve),I.baseState=ce,I.firstBaseUpdate=$e,I.lastBaseUpdate=Fe,k===null&&(I.shared.lanes=0),Gu|=q,u.lanes=q,u.memoizedState=Ve}}function NR(u,d){if(typeof u!="function")throw Error(s(191,u));u.call(d)}function IR(u,d){var g=u.callbacks;if(g!==null)for(u.callbacks=null,u=0;u<g.length;u++)NR(g[u],d)}var vp=ie(null),I_=ie(0);function CR(u,d){u=Rc,fe(I_,u),fe(vp,d),Rc=u|d.baseLanes}function aS(){fe(I_,Rc),fe(vp,vp.current)}function oS(){Rc=I_.current,pe(vp),pe(I_)}var Mu=0,Wt=null,Dn=null,zs=null,C_=!1,bp=!1,Ld=!1,k_=0,kg=0,_p=null,k7=0;function As(){throw Error(s(321))}function lS(u,d){if(d===null)return!1;for(var g=0;g<d.length&&g<u.length;g++)if(!Si(u[g],d[g]))return!1;return!0}function cS(u,d,g,_,I,k){return Mu=k,Wt=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,Z.H=u===null||u.memoizedState===null?hD:dD,Ld=!1,k=g(_,I),Ld=!1,bp&&(k=$R(d,g,_,I)),kR(u),k}function kR(u){Z.H=O_;var d=Dn!==null&&Dn.next!==null;if(Mu=0,zs=Dn=Wt=null,C_=!1,kg=0,_p=null,d)throw Error(s(300));u===null||_r||(u=u.dependencies,u!==null&&w_(u)&&(_r=!0))}function $R(u,d,g,_){Wt=u;var I=0;do{if(bp&&(_p=null),kg=0,bp=!1,25<=I)throw Error(s(301));if(I+=1,zs=Dn=null,u.updateQueue!=null){var k=u.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}Z.H=P7,k=d(g,_)}while(bp);return k}function $7(){var u=Z.H,d=u.useState()[0];return d=typeof d.then=="function"?$g(d):d,u=u.useState()[0],(Dn!==null?Dn.memoizedState:null)!==u&&(Wt.flags|=1024),d}function uS(){var u=k_!==0;return k_=0,u}function hS(u,d,g){d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~g}function dS(u){if(C_){for(u=u.memoizedState;u!==null;){var d=u.queue;d!==null&&(d.pending=null),u=u.next}C_=!1}Mu=0,zs=Dn=Wt=null,bp=!1,kg=k_=0,_p=null}function Hi(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zs===null?Wt.memoizedState=zs=u:zs=zs.next=u,zs}function Vs(){if(Dn===null){var u=Wt.alternate;u=u!==null?u.memoizedState:null}else u=Dn.next;var d=zs===null?Wt.memoizedState:zs.next;if(d!==null)zs=d,Dn=u;else{if(u===null)throw Wt.alternate===null?Error(s(467)):Error(s(310));Dn=u,u={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},zs===null?Wt.memoizedState=zs=u:zs=zs.next=u}return zs}function fS(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $g(u){var d=kg;return kg+=1,_p===null&&(_p=[]),u=TR(_p,u,d),d=Wt,(zs===null?d.memoizedState:zs.next)===null&&(d=d.alternate,Z.H=d===null||d.memoizedState===null?hD:dD),u}function $_(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return $g(u);if(u.$$typeof===$)return Qr(u)}throw Error(s(438,String(u)))}function pS(u){var d=null,g=Wt.updateQueue;if(g!==null&&(d=g.memoCache),d==null){var _=Wt.alternate;_!==null&&(_=_.updateQueue,_!==null&&(_=_.memoCache,_!=null&&(d={data:_.data.map(function(I){return I.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),g===null&&(g=fS(),Wt.updateQueue=g),g.memoCache=d,g=d.data[d.index],g===void 0)for(g=d.data[d.index]=Array(u),_=0;_<u;_++)g[_]=B;return d.index++,g}function Nc(u,d){return typeof d=="function"?d(u):d}function A_(u){var d=Vs();return mS(d,Dn,u)}function mS(u,d,g){var _=u.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=g;var I=u.baseQueue,k=_.pending;if(k!==null){if(I!==null){var q=I.next;I.next=k.next,k.next=q}d.baseQueue=I=k,_.pending=null}if(k=u.baseState,I===null)u.memoizedState=k;else{d=I.next;var Y=q=null,ce=null,$e=d,Fe=!1;do{var Ve=$e.lane&-536870913;if(Ve!==$e.lane?(dn&Ve)===Ve:(Mu&Ve)===Ve){var Ae=$e.revertLane;if(Ae===0)ce!==null&&(ce=ce.next={lane:0,revertLane:0,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null}),Ve===gp&&(Fe=!0);else if((Mu&Ae)===Ae){$e=$e.next,Ae===gp&&(Fe=!0);continue}else Ve={lane:0,revertLane:$e.revertLane,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},ce===null?(Y=ce=Ve,q=k):ce=ce.next=Ve,Wt.lanes|=Ae,Gu|=Ae;Ve=$e.action,Ld&&g(k,Ve),k=$e.hasEagerState?$e.eagerState:g(k,Ve)}else Ae={lane:Ve,revertLane:$e.revertLane,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},ce===null?(Y=ce=Ae,q=k):ce=ce.next=Ae,Wt.lanes|=Ve,Gu|=Ve;$e=$e.next}while($e!==null&&$e!==d);if(ce===null?q=k:ce.next=Y,!Si(k,u.memoizedState)&&(_r=!0,Fe&&(g=yp,g!==null)))throw g;u.memoizedState=k,u.baseState=q,u.baseQueue=ce,_.lastRenderedState=k}return I===null&&(_.lanes=0),[u.memoizedState,_.dispatch]}function gS(u){var d=Vs(),g=d.queue;if(g===null)throw Error(s(311));g.lastRenderedReducer=u;var _=g.dispatch,I=g.pending,k=d.memoizedState;if(I!==null){g.pending=null;var q=I=I.next;do k=u(k,q.action),q=q.next;while(q!==I);Si(k,d.memoizedState)||(_r=!0),d.memoizedState=k,d.baseQueue===null&&(d.baseState=k),g.lastRenderedState=k}return[k,_]}function AR(u,d,g){var _=Wt,I=Vs(),k=kt;if(k){if(g===void 0)throw Error(s(407));g=g()}else g=d();var q=!Si((Dn||I).memoizedState,g);q&&(I.memoizedState=g,_r=!0),I=I.queue;var Y=LR.bind(null,_,I,u);if(Ag(2048,8,Y,[u]),I.getSnapshot!==d||q||zs!==null&&zs.memoizedState.tag&1){if(_.flags|=2048,xp(9,R_(),DR.bind(null,_,I,g,d),null),Hn===null)throw Error(s(349));k||(Mu&124)!==0||RR(_,d,g)}return g}function RR(u,d,g){u.flags|=16384,u={getSnapshot:d,value:g},d=Wt.updateQueue,d===null?(d=fS(),Wt.updateQueue=d,d.stores=[u]):(g=d.stores,g===null?d.stores=[u]:g.push(u))}function DR(u,d,g,_){d.value=g,d.getSnapshot=_,OR(d)&&PR(u)}function LR(u,d,g){return g(function(){OR(d)&&PR(u)})}function OR(u){var d=u.getSnapshot;u=u.value;try{var g=d();return!Si(u,g)}catch{return!0}}function PR(u){var d=$u(u,2);d!==null&&Ta(d,u,2)}function yS(u){var d=Hi();if(typeof u=="function"){var g=u;if(u=g(),Ld){ns(!0);try{g()}finally{ns(!1)}}}return d.memoizedState=d.baseState=u,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nc,lastRenderedState:u},d}function MR(u,d,g,_){return u.baseState=g,mS(u,Dn,typeof _=="function"?_:Nc)}function A7(u,d,g,_,I){if(L_(u))throw Error(s(485));if(u=d.action,u!==null){var k={payload:I,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){k.listeners.push(q)}};Z.T!==null?g(!0):k.isTransition=!1,_(k),g=d.pending,g===null?(k.next=d.pending=k,FR(d,k)):(k.next=g.next,d.pending=g.next=k)}}function FR(u,d){var g=d.action,_=d.payload,I=u.state;if(d.isTransition){var k=Z.T,q={};Z.T=q;try{var Y=g(I,_),ce=Z.S;ce!==null&&ce(q,Y),jR(u,d,Y)}catch($e){vS(u,d,$e)}finally{Z.T=k}}else try{k=g(I,_),jR(u,d,k)}catch($e){vS(u,d,$e)}}function jR(u,d,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(_){BR(u,d,_)},function(_){return vS(u,d,_)}):BR(u,d,g)}function BR(u,d,g){d.status="fulfilled",d.value=g,zR(d),u.state=g,d=u.pending,d!==null&&(g=d.next,g===d?u.pending=null:(g=g.next,d.next=g,FR(u,g)))}function vS(u,d,g){var _=u.pending;if(u.pending=null,_!==null){_=_.next;do d.status="rejected",d.reason=g,zR(d),d=d.next;while(d!==_)}u.action=null}function zR(u){u=u.listeners;for(var d=0;d<u.length;d++)(0,u[d])()}function VR(u,d){return d}function UR(u,d){if(kt){var g=Hn.formState;if(g!==null){e:{var _=Wt;if(kt){if(ut){t:{for(var I=ut,k=ms;I.nodeType!==8;){if(!k){I=null;break t}if(I=Ro(I.nextSibling),I===null){I=null;break t}}k=I.data,I=k==="F!"||k==="F"?I:null}if(I){ut=Ro(I.nextSibling),_=I.data==="F!";break e}}Wi(_)}_=!1}_&&(d=g[0])}}return g=Hi(),g.memoizedState=g.baseState=d,_={pending:null,lanes:0,dispatch:null,lastRenderedReducer:VR,lastRenderedState:d},g.queue=_,g=lD.bind(null,Wt,_),_.dispatch=g,_=yS(!1),k=TS.bind(null,Wt,!1,_.queue),_=Hi(),I={state:d,dispatch:null,action:u,pending:null},_.queue=I,g=A7.bind(null,Wt,I,k,g),I.dispatch=g,_.memoizedState=u,[d,g,!1]}function GR(u){var d=Vs();return WR(d,Dn,u)}function WR(u,d,g){if(d=mS(u,d,VR)[0],u=A_(Nc)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var _=$g(d)}catch(q){throw q===Sg?E_:q}else _=d;d=Vs();var I=d.queue,k=I.dispatch;return g!==d.memoizedState&&(Wt.flags|=2048,xp(9,R_(),R7.bind(null,I,g),null)),[_,k,u]}function R7(u,d){u.action=d}function HR(u){var d=Vs(),g=Dn;if(g!==null)return WR(d,g,u);Vs(),d=d.memoizedState,g=Vs();var _=g.queue.dispatch;return g.memoizedState=u,[d,_,!1]}function xp(u,d,g,_){return u={tag:u,create:g,deps:_,inst:d,next:null},d=Wt.updateQueue,d===null&&(d=fS(),Wt.updateQueue=d),g=d.lastEffect,g===null?d.lastEffect=u.next=u:(_=g.next,g.next=u,u.next=_,d.lastEffect=u),u}function R_(){return{destroy:void 0,resource:void 0}}function qR(){return Vs().memoizedState}function D_(u,d,g,_){var I=Hi();_=_===void 0?null:_,Wt.flags|=u,I.memoizedState=xp(1|d,R_(),g,_)}function Ag(u,d,g,_){var I=Vs();_=_===void 0?null:_;var k=I.memoizedState.inst;Dn!==null&&_!==null&&lS(_,Dn.memoizedState.deps)?I.memoizedState=xp(d,k,g,_):(Wt.flags|=u,I.memoizedState=xp(1|d,k,g,_))}function KR(u,d){D_(8390656,8,u,d)}function XR(u,d){Ag(2048,8,u,d)}function ZR(u,d){return Ag(4,2,u,d)}function YR(u,d){return Ag(4,4,u,d)}function QR(u,d){if(typeof d=="function"){u=u();var g=d(u);return function(){typeof g=="function"?g():d(null)}}if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function JR(u,d,g){g=g!=null?g.concat([u]):null,Ag(4,4,QR.bind(null,d,u),g)}function bS(){}function eD(u,d){var g=Vs();d=d===void 0?null:d;var _=g.memoizedState;return d!==null&&lS(d,_[1])?_[0]:(g.memoizedState=[u,d],u)}function tD(u,d){var g=Vs();d=d===void 0?null:d;var _=g.memoizedState;if(d!==null&&lS(d,_[1]))return _[0];if(_=u(),Ld){ns(!0);try{u()}finally{ns(!1)}}return g.memoizedState=[_,d],_}function _S(u,d,g){return g===void 0||(Mu&1073741824)!==0?u.memoizedState=d:(u.memoizedState=g,u=rL(),Wt.lanes|=u,Gu|=u,g)}function nD(u,d,g,_){return Si(g,d)?g:vp.current!==null?(u=_S(u,g,_),Si(u,d)||(_r=!0),u):(Mu&42)===0?(_r=!0,u.memoizedState=g):(u=rL(),Wt.lanes|=u,Gu|=u,d)}function sD(u,d,g,_,I){var k=re.p;re.p=k!==0&&8>k?k:8;var q=Z.T,Y={};Z.T=Y,TS(u,!1,d,g);try{var ce=I(),$e=Z.S;if($e!==null&&$e(Y,ce),ce!==null&&typeof ce=="object"&&typeof ce.then=="function"){var Fe=C7(ce,_);Rg(u,d,Fe,wa(u))}else Rg(u,d,_,wa(u))}catch(Ve){Rg(u,d,{then:function(){},status:"rejected",reason:Ve},wa())}finally{re.p=k,Z.T=q}}function D7(){}function xS(u,d,g,_){if(u.tag!==5)throw Error(s(476));var I=rD(u).queue;sD(u,I,d,ne,g===null?D7:function(){return iD(u),g(_)})}function rD(u){var d=u.memoizedState;if(d!==null)return d;d={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nc,lastRenderedState:ne},next:null};var g={};return d.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nc,lastRenderedState:g},next:null},u.memoizedState=d,u=u.alternate,u!==null&&(u.memoizedState=d),d}function iD(u){var d=rD(u).next.queue;Rg(u,d,{},wa())}function wS(){return Qr(Zg)}function aD(){return Vs().memoizedState}function oD(){return Vs().memoizedState}function L7(u){for(var d=u.return;d!==null;){switch(d.tag){case 24:case 3:var g=wa();u=Ou(g);var _=Pu(d,u,g);_!==null&&(Ta(_,d,g),Ng(_,d,g)),d={cache:QT()},u.payload=d;return}d=d.return}}function O7(u,d,g){var _=wa();g={lane:_,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null},L_(u)?cD(d,g):(g=Tc(u,d,g,_),g!==null&&(Ta(g,u,_),uD(g,d,_)))}function lD(u,d,g){var _=wa();Rg(u,d,g,_)}function Rg(u,d,g,_){var I={lane:_,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null};if(L_(u))cD(d,I);else{var k=u.alternate;if(u.lanes===0&&(k===null||k.lanes===0)&&(k=d.lastRenderedReducer,k!==null))try{var q=d.lastRenderedState,Y=k(q,g);if(I.hasEagerState=!0,I.eagerState=Y,Si(Y,q))return Nd(u,d,I,0),Hn===null&&Ed(),!1}catch{}finally{}if(g=Tc(u,d,I,_),g!==null)return Ta(g,u,_),uD(g,d,_),!0}return!1}function TS(u,d,g,_){if(_={lane:2,revertLane:tE(),action:_,hasEagerState:!1,eagerState:null,next:null},L_(u)){if(d)throw Error(s(479))}else d=Tc(u,g,_,2),d!==null&&Ta(d,u,2)}function L_(u){var d=u.alternate;return u===Wt||d!==null&&d===Wt}function cD(u,d){bp=C_=!0;var g=u.pending;g===null?d.next=d:(d.next=g.next,g.next=d),u.pending=d}function uD(u,d,g){if((g&4194048)!==0){var _=d.lanes;_&=u.pendingLanes,g|=_,d.lanes=g,nl(u,g)}}var O_={readContext:Qr,use:$_,useCallback:As,useContext:As,useEffect:As,useImperativeHandle:As,useLayoutEffect:As,useInsertionEffect:As,useMemo:As,useReducer:As,useRef:As,useState:As,useDebugValue:As,useDeferredValue:As,useTransition:As,useSyncExternalStore:As,useId:As,useHostTransitionStatus:As,useFormState:As,useActionState:As,useOptimistic:As,useMemoCache:As,useCacheRefresh:As},hD={readContext:Qr,use:$_,useCallback:function(u,d){return Hi().memoizedState=[u,d===void 0?null:d],u},useContext:Qr,useEffect:KR,useImperativeHandle:function(u,d,g){g=g!=null?g.concat([u]):null,D_(4194308,4,QR.bind(null,d,u),g)},useLayoutEffect:function(u,d){return D_(4194308,4,u,d)},useInsertionEffect:function(u,d){D_(4,2,u,d)},useMemo:function(u,d){var g=Hi();d=d===void 0?null:d;var _=u();if(Ld){ns(!0);try{u()}finally{ns(!1)}}return g.memoizedState=[_,d],_},useReducer:function(u,d,g){var _=Hi();if(g!==void 0){var I=g(d);if(Ld){ns(!0);try{g(d)}finally{ns(!1)}}}else I=d;return _.memoizedState=_.baseState=I,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:I},_.queue=u,u=u.dispatch=O7.bind(null,Wt,u),[_.memoizedState,u]},useRef:function(u){var d=Hi();return u={current:u},d.memoizedState=u},useState:function(u){u=yS(u);var d=u.queue,g=lD.bind(null,Wt,d);return d.dispatch=g,[u.memoizedState,g]},useDebugValue:bS,useDeferredValue:function(u,d){var g=Hi();return _S(g,u,d)},useTransition:function(){var u=yS(!1);return u=sD.bind(null,Wt,u.queue,!0,!1),Hi().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,d,g){var _=Wt,I=Hi();if(kt){if(g===void 0)throw Error(s(407));g=g()}else{if(g=d(),Hn===null)throw Error(s(349));(dn&124)!==0||RR(_,d,g)}I.memoizedState=g;var k={value:g,getSnapshot:d};return I.queue=k,KR(LR.bind(null,_,k,u),[u]),_.flags|=2048,xp(9,R_(),DR.bind(null,_,k,g,d),null),g},useId:function(){var u=Hi(),d=Hn.identifierPrefix;if(kt){var g=le,_=X;g=(_&~(1<<32-hs(_)-1)).toString(32)+g,d=""+d+"R"+g,g=k_++,0<g&&(d+="H"+g.toString(32)),d+=""}else g=k7++,d=""+d+"r"+g.toString(32)+"";return u.memoizedState=d},useHostTransitionStatus:wS,useFormState:UR,useActionState:UR,useOptimistic:function(u){var d=Hi();d.memoizedState=d.baseState=u;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=g,d=TS.bind(null,Wt,!0,g),g.dispatch=d,[u,d]},useMemoCache:pS,useCacheRefresh:function(){return Hi().memoizedState=L7.bind(null,Wt)}},dD={readContext:Qr,use:$_,useCallback:eD,useContext:Qr,useEffect:XR,useImperativeHandle:JR,useInsertionEffect:ZR,useLayoutEffect:YR,useMemo:tD,useReducer:A_,useRef:qR,useState:function(){return A_(Nc)},useDebugValue:bS,useDeferredValue:function(u,d){var g=Vs();return nD(g,Dn.memoizedState,u,d)},useTransition:function(){var u=A_(Nc)[0],d=Vs().memoizedState;return[typeof u=="boolean"?u:$g(u),d]},useSyncExternalStore:AR,useId:aD,useHostTransitionStatus:wS,useFormState:GR,useActionState:GR,useOptimistic:function(u,d){var g=Vs();return MR(g,Dn,u,d)},useMemoCache:pS,useCacheRefresh:oD},P7={readContext:Qr,use:$_,useCallback:eD,useContext:Qr,useEffect:XR,useImperativeHandle:JR,useInsertionEffect:ZR,useLayoutEffect:YR,useMemo:tD,useReducer:gS,useRef:qR,useState:function(){return gS(Nc)},useDebugValue:bS,useDeferredValue:function(u,d){var g=Vs();return Dn===null?_S(g,u,d):nD(g,Dn.memoizedState,u,d)},useTransition:function(){var u=gS(Nc)[0],d=Vs().memoizedState;return[typeof u=="boolean"?u:$g(u),d]},useSyncExternalStore:AR,useId:aD,useHostTransitionStatus:wS,useFormState:HR,useActionState:HR,useOptimistic:function(u,d){var g=Vs();return Dn!==null?MR(g,Dn,u,d):(g.baseState=u,[u,g.queue.dispatch])},useMemoCache:pS,useCacheRefresh:oD},wp=null,Dg=0;function P_(u){var d=Dg;return Dg+=1,wp===null&&(wp=[]),TR(wp,u,d)}function Lg(u,d){d=d.props.ref,u.ref=d!==void 0?d:null}function M_(u,d){throw d.$$typeof===p?Error(s(525)):(u=Object.prototype.toString.call(d),Error(s(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u)))}function fD(u){var d=u._init;return d(u._payload)}function pD(u){function d(we,ge){if(u){var Ce=we.deletions;Ce===null?(we.deletions=[ge],we.flags|=16):Ce.push(ge)}}function g(we,ge){if(!u)return null;for(;ge!==null;)d(we,ge),ge=ge.sibling;return null}function _(we){for(var ge=new Map;we!==null;)we.key!==null?ge.set(we.key,we):ge.set(we.index,we),we=we.sibling;return ge}function I(we,ge){return we=Ha(we,ge),we.index=0,we.sibling=null,we}function k(we,ge,Ce){return we.index=Ce,u?(Ce=we.alternate,Ce!==null?(Ce=Ce.index,Ce<ge?(we.flags|=67108866,ge):Ce):(we.flags|=67108866,ge)):(we.flags|=1048576,ge)}function q(we){return u&&we.alternate===null&&(we.flags|=67108866),we}function Y(we,ge,Ce,je){return ge===null||ge.tag!==6?(ge=xg(Ce,we.mode,je),ge.return=we,ge):(ge=I(ge,Ce),ge.return=we,ge)}function ce(we,ge,Ce,je){var lt=Ce.type;return lt===x?Fe(we,ge,Ce.props.children,je,Ce.key):ge!==null&&(ge.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===O&&fD(lt)===ge.type)?(ge=I(ge,Ce.props),Lg(ge,Ce),ge.return=we,ge):(ge=Cd(Ce.type,Ce.key,Ce.props,null,we.mode,je),Lg(ge,Ce),ge.return=we,ge)}function $e(we,ge,Ce,je){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Ce.containerInfo||ge.stateNode.implementation!==Ce.implementation?(ge=pp(Ce,we.mode,je),ge.return=we,ge):(ge=I(ge,Ce.children||[]),ge.return=we,ge)}function Fe(we,ge,Ce,je,lt){return ge===null||ge.tag!==7?(ge=dl(Ce,we.mode,je,lt),ge.return=we,ge):(ge=I(ge,Ce),ge.return=we,ge)}function Ve(we,ge,Ce){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return ge=xg(""+ge,we.mode,Ce),ge.return=we,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case m:return Ce=Cd(ge.type,ge.key,ge.props,null,we.mode,Ce),Lg(Ce,ge),Ce.return=we,Ce;case v:return ge=pp(ge,we.mode,Ce),ge.return=we,ge;case O:var je=ge._init;return ge=je(ge._payload),Ve(we,ge,Ce)}if(te(ge)||W(ge))return ge=dl(ge,we.mode,Ce,null),ge.return=we,ge;if(typeof ge.then=="function")return Ve(we,P_(ge),Ce);if(ge.$$typeof===$)return Ve(we,T_(we,ge),Ce);M_(we,ge)}return null}function Ae(we,ge,Ce,je){var lt=ge!==null?ge.key:null;if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return lt!==null?null:Y(we,ge,""+Ce,je);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case m:return Ce.key===lt?ce(we,ge,Ce,je):null;case v:return Ce.key===lt?$e(we,ge,Ce,je):null;case O:return lt=Ce._init,Ce=lt(Ce._payload),Ae(we,ge,Ce,je)}if(te(Ce)||W(Ce))return lt!==null?null:Fe(we,ge,Ce,je,null);if(typeof Ce.then=="function")return Ae(we,ge,P_(Ce),je);if(Ce.$$typeof===$)return Ae(we,ge,T_(we,Ce),je);M_(we,Ce)}return null}function Le(we,ge,Ce,je,lt){if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return we=we.get(Ce)||null,Y(ge,we,""+je,lt);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case m:return we=we.get(je.key===null?Ce:je.key)||null,ce(ge,we,je,lt);case v:return we=we.get(je.key===null?Ce:je.key)||null,$e(ge,we,je,lt);case O:var Xt=je._init;return je=Xt(je._payload),Le(we,ge,Ce,je,lt)}if(te(je)||W(je))return we=we.get(Ce)||null,Fe(ge,we,je,lt,null);if(typeof je.then=="function")return Le(we,ge,Ce,P_(je),lt);if(je.$$typeof===$)return Le(we,ge,Ce,T_(ge,je),lt);M_(ge,je)}return null}function Ct(we,ge,Ce,je){for(var lt=null,Xt=null,dt=ge,Tt=ge=0,wr=null;dt!==null&&Tt<Ce.length;Tt++){dt.index>Tt?(wr=dt,dt=null):wr=dt.sibling;var vn=Ae(we,dt,Ce[Tt],je);if(vn===null){dt===null&&(dt=wr);break}u&&dt&&vn.alternate===null&&d(we,dt),ge=k(vn,ge,Tt),Xt===null?lt=vn:Xt.sibling=vn,Xt=vn,dt=wr}if(Tt===Ce.length)return g(we,dt),kt&&Ee(we,Tt),lt;if(dt===null){for(;Tt<Ce.length;Tt++)dt=Ve(we,Ce[Tt],je),dt!==null&&(ge=k(dt,ge,Tt),Xt===null?lt=dt:Xt.sibling=dt,Xt=dt);return kt&&Ee(we,Tt),lt}for(dt=_(dt);Tt<Ce.length;Tt++)wr=Le(dt,we,Tt,Ce[Tt],je),wr!==null&&(u&&wr.alternate!==null&&dt.delete(wr.key===null?Tt:wr.key),ge=k(wr,ge,Tt),Xt===null?lt=wr:Xt.sibling=wr,Xt=wr);return u&&dt.forEach(function(Ju){return d(we,Ju)}),kt&&Ee(we,Tt),lt}function bt(we,ge,Ce,je){if(Ce==null)throw Error(s(151));for(var lt=null,Xt=null,dt=ge,Tt=ge=0,wr=null,vn=Ce.next();dt!==null&&!vn.done;Tt++,vn=Ce.next()){dt.index>Tt?(wr=dt,dt=null):wr=dt.sibling;var Ju=Ae(we,dt,vn.value,je);if(Ju===null){dt===null&&(dt=wr);break}u&&dt&&Ju.alternate===null&&d(we,dt),ge=k(Ju,ge,Tt),Xt===null?lt=Ju:Xt.sibling=Ju,Xt=Ju,dt=wr}if(vn.done)return g(we,dt),kt&&Ee(we,Tt),lt;if(dt===null){for(;!vn.done;Tt++,vn=Ce.next())vn=Ve(we,vn.value,je),vn!==null&&(ge=k(vn,ge,Tt),Xt===null?lt=vn:Xt.sibling=vn,Xt=vn);return kt&&Ee(we,Tt),lt}for(dt=_(dt);!vn.done;Tt++,vn=Ce.next())vn=Le(dt,we,Tt,vn.value,je),vn!==null&&(u&&vn.alternate!==null&&dt.delete(vn.key===null?Tt:vn.key),ge=k(vn,ge,Tt),Xt===null?lt=vn:Xt.sibling=vn,Xt=vn);return u&&dt.forEach(function(MX){return d(we,MX)}),kt&&Ee(we,Tt),lt}function On(we,ge,Ce,je){if(typeof Ce=="object"&&Ce!==null&&Ce.type===x&&Ce.key===null&&(Ce=Ce.props.children),typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case m:e:{for(var lt=Ce.key;ge!==null;){if(ge.key===lt){if(lt=Ce.type,lt===x){if(ge.tag===7){g(we,ge.sibling),je=I(ge,Ce.props.children),je.return=we,we=je;break e}}else if(ge.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===O&&fD(lt)===ge.type){g(we,ge.sibling),je=I(ge,Ce.props),Lg(je,Ce),je.return=we,we=je;break e}g(we,ge);break}else d(we,ge);ge=ge.sibling}Ce.type===x?(je=dl(Ce.props.children,we.mode,je,Ce.key),je.return=we,we=je):(je=Cd(Ce.type,Ce.key,Ce.props,null,we.mode,je),Lg(je,Ce),je.return=we,we=je)}return q(we);case v:e:{for(lt=Ce.key;ge!==null;){if(ge.key===lt)if(ge.tag===4&&ge.stateNode.containerInfo===Ce.containerInfo&&ge.stateNode.implementation===Ce.implementation){g(we,ge.sibling),je=I(ge,Ce.children||[]),je.return=we,we=je;break e}else{g(we,ge);break}else d(we,ge);ge=ge.sibling}je=pp(Ce,we.mode,je),je.return=we,we=je}return q(we);case O:return lt=Ce._init,Ce=lt(Ce._payload),On(we,ge,Ce,je)}if(te(Ce))return Ct(we,ge,Ce,je);if(W(Ce)){if(lt=W(Ce),typeof lt!="function")throw Error(s(150));return Ce=lt.call(Ce),bt(we,ge,Ce,je)}if(typeof Ce.then=="function")return On(we,ge,P_(Ce),je);if(Ce.$$typeof===$)return On(we,ge,T_(we,Ce),je);M_(we,Ce)}return typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint"?(Ce=""+Ce,ge!==null&&ge.tag===6?(g(we,ge.sibling),je=I(ge,Ce),je.return=we,we=je):(g(we,ge),je=xg(Ce,we.mode,je),je.return=we,we=je),q(we)):g(we,ge)}return function(we,ge,Ce,je){try{Dg=0;var lt=On(we,ge,Ce,je);return wp=null,lt}catch(dt){if(dt===Sg||dt===E_)throw dt;var Xt=Ci(29,dt,null,we.mode);return Xt.lanes=je,Xt.return=we,Xt}finally{}}}var Tp=pD(!0),mD=pD(!1),Ka=ie(null),pl=null;function Fu(u){var d=u.alternate;fe(rr,rr.current&1),fe(Ka,u),pl===null&&(d===null||vp.current!==null||d.memoizedState!==null)&&(pl=u)}function gD(u){if(u.tag===22){if(fe(rr,rr.current),fe(Ka,u),pl===null){var d=u.alternate;d!==null&&d.memoizedState!==null&&(pl=u)}}else ju()}function ju(){fe(rr,rr.current),fe(Ka,Ka.current)}function Ic(u){pe(Ka),pl===u&&(pl=null),pe(rr)}var rr=ie(0);function F_(u){for(var d=u;d!==null;){if(d.tag===13){var g=d.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||fE(g)))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}function SS(u,d,g,_){d=u.memoizedState,g=g(_,d),g=g==null?d:h({},d,g),u.memoizedState=g,u.lanes===0&&(u.updateQueue.baseState=g)}var ES={enqueueSetState:function(u,d,g){u=u._reactInternals;var _=wa(),I=Ou(_);I.payload=d,g!=null&&(I.callback=g),d=Pu(u,I,_),d!==null&&(Ta(d,u,_),Ng(d,u,_))},enqueueReplaceState:function(u,d,g){u=u._reactInternals;var _=wa(),I=Ou(_);I.tag=1,I.payload=d,g!=null&&(I.callback=g),d=Pu(u,I,_),d!==null&&(Ta(d,u,_),Ng(d,u,_))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var g=wa(),_=Ou(g);_.tag=2,d!=null&&(_.callback=d),d=Pu(u,_,g),d!==null&&(Ta(d,u,g),Ng(d,u,g))}};function yD(u,d,g,_,I,k,q){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(_,k,q):d.prototype&&d.prototype.isPureReactComponent?!Ei(g,_)||!Ei(I,k):!0}function vD(u,d,g,_){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(g,_),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(g,_),d.state!==u&&ES.enqueueReplaceState(d,d.state,null)}function Od(u,d){var g=d;if("ref"in d){g={};for(var _ in d)_!=="ref"&&(g[_]=d[_])}if(u=u.defaultProps){g===d&&(g=h({},g));for(var I in u)g[I]===void 0&&(g[I]=u[I])}return g}var j_=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)};function bD(u){j_(u)}function _D(u){console.error(u)}function xD(u){j_(u)}function B_(u,d){try{var g=u.onUncaughtError;g(d.value,{componentStack:d.stack})}catch(_){setTimeout(function(){throw _})}}function wD(u,d,g){try{var _=u.onCaughtError;_(g.value,{componentStack:g.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function NS(u,d,g){return g=Ou(g),g.tag=3,g.payload={element:null},g.callback=function(){B_(u,d)},g}function TD(u){return u=Ou(u),u.tag=3,u}function SD(u,d,g,_){var I=g.type.getDerivedStateFromError;if(typeof I=="function"){var k=_.value;u.payload=function(){return I(k)},u.callback=function(){wD(d,g,_)}}var q=g.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(u.callback=function(){wD(d,g,_),typeof I!="function"&&(Wu===null?Wu=new Set([this]):Wu.add(this));var Y=_.stack;this.componentDidCatch(_.value,{componentStack:Y!==null?Y:""})})}function M7(u,d,g,_,I){if(g.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){if(d=g.alternate,d!==null&&Ad(d,g,I,!0),g=Ka.current,g!==null){switch(g.tag){case 13:return pl===null?ZS():g.alternate===null&&xs===0&&(xs=3),g.flags&=-257,g.flags|=65536,g.lanes=I,_===tS?g.flags|=16384:(d=g.updateQueue,d===null?g.updateQueue=new Set([_]):d.add(_),QS(u,_,I)),!1;case 22:return g.flags|=65536,_===tS?g.flags|=16384:(d=g.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([_])},g.updateQueue=d):(g=d.retryQueue,g===null?d.retryQueue=new Set([_]):g.add(_)),QS(u,_,I)),!1}throw Error(s(435,g.tag))}return QS(u,_,I),ZS(),!1}if(kt)return d=Ka.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=I,_!==br&&(u=Error(s(422),{cause:_}),Du(Ni(u,g)))):(_!==br&&(d=Error(s(423),{cause:_}),Du(Ni(d,g))),u=u.current.alternate,u.flags|=65536,I&=-I,u.lanes|=I,_=Ni(_,g),I=NS(u.stateNode,_,I),rS(u,I),xs!==4&&(xs=2)),!1;var k=Error(s(520),{cause:_});if(k=Ni(k,g),zg===null?zg=[k]:zg.push(k),xs!==4&&(xs=2),d===null)return!0;_=Ni(_,g),g=d;do{switch(g.tag){case 3:return g.flags|=65536,u=I&-I,g.lanes|=u,u=NS(g.stateNode,_,u),rS(g,u),!1;case 1:if(d=g.type,k=g.stateNode,(g.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Wu===null||!Wu.has(k))))return g.flags|=65536,I&=-I,g.lanes|=I,I=TD(I),SD(I,u,g,_),rS(g,I),!1}g=g.return}while(g!==null);return!1}var ED=Error(s(461)),_r=!1;function $r(u,d,g,_){d.child=u===null?mD(d,null,g,_):Tp(d,u.child,g,_)}function ND(u,d,g,_,I){g=g.render;var k=d.ref;if("ref"in _){var q={};for(var Y in _)Y!=="ref"&&(q[Y]=_[Y])}else q=_;return Rd(d),_=cS(u,d,g,q,k,I),Y=uS(),u!==null&&!_r?(hS(u,d,I),Cc(u,d,I)):(kt&&Y&&Ge(d),d.flags|=1,$r(u,d,_,I),d.child)}function ID(u,d,g,_,I){if(u===null){var k=g.type;return typeof k=="function"&&!fp(k)&&k.defaultProps===void 0&&g.compare===null?(d.tag=15,d.type=k,CD(u,d,k,_,I)):(u=Cd(g.type,null,_,d,d.mode,I),u.ref=d.ref,u.return=d,d.child=u)}if(k=u.child,!LS(u,I)){var q=k.memoizedProps;if(g=g.compare,g=g!==null?g:Ei,g(q,_)&&u.ref===d.ref)return Cc(u,d,I)}return d.flags|=1,u=Ha(k,_),u.ref=d.ref,u.return=d,d.child=u}function CD(u,d,g,_,I){if(u!==null){var k=u.memoizedProps;if(Ei(k,_)&&u.ref===d.ref)if(_r=!1,d.pendingProps=_=k,LS(u,I))(u.flags&131072)!==0&&(_r=!0);else return d.lanes=u.lanes,Cc(u,d,I)}return IS(u,d,g,_,I)}function kD(u,d,g){var _=d.pendingProps,I=_.children,k=u!==null?u.memoizedState:null;if(_.mode==="hidden"){if((d.flags&128)!==0){if(_=k!==null?k.baseLanes|g:g,u!==null){for(I=d.child=u.child,k=0;I!==null;)k=k|I.lanes|I.childLanes,I=I.sibling;d.childLanes=k&~_}else d.childLanes=0,d.child=null;return $D(u,d,_,g)}if((g&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},u!==null&&S_(d,k!==null?k.cachePool:null),k!==null?CR(d,k):aS(),gD(d);else return d.lanes=d.childLanes=536870912,$D(u,d,k!==null?k.baseLanes|g:g,g)}else k!==null?(S_(d,k.cachePool),CR(d,k),ju(),d.memoizedState=null):(u!==null&&S_(d,null),aS(),ju());return $r(u,d,I,g),d.child}function $D(u,d,g,_){var I=eS();return I=I===null?null:{parent:sr._currentValue,pool:I},d.memoizedState={baseLanes:g,cachePool:I},u!==null&&S_(d,null),aS(),gD(d),u!==null&&Ad(u,d,_,!0),null}function z_(u,d){var g=d.ref;if(g===null)u!==null&&u.ref!==null&&(d.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(s(284));(u===null||u.ref!==g)&&(d.flags|=4194816)}}function IS(u,d,g,_,I){return Rd(d),g=cS(u,d,g,_,void 0,I),_=uS(),u!==null&&!_r?(hS(u,d,I),Cc(u,d,I)):(kt&&_&&Ge(d),d.flags|=1,$r(u,d,g,I),d.child)}function AD(u,d,g,_,I,k){return Rd(d),d.updateQueue=null,g=$R(d,_,g,I),kR(u),_=uS(),u!==null&&!_r?(hS(u,d,k),Cc(u,d,k)):(kt&&_&&Ge(d),d.flags|=1,$r(u,d,g,k),d.child)}function RD(u,d,g,_,I){if(Rd(d),d.stateNode===null){var k=Sc,q=g.contextType;typeof q=="object"&&q!==null&&(k=Qr(q)),k=new g(_,k),d.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=ES,d.stateNode=k,k._reactInternals=d,k=d.stateNode,k.props=_,k.state=d.memoizedState,k.refs={},nS(d),q=g.contextType,k.context=typeof q=="object"&&q!==null?Qr(q):Sc,k.state=d.memoizedState,q=g.getDerivedStateFromProps,typeof q=="function"&&(SS(d,g,q,_),k.state=d.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(q=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),q!==k.state&&ES.enqueueReplaceState(k,k.state,null),Cg(d,_,k,I),Ig(),k.state=d.memoizedState),typeof k.componentDidMount=="function"&&(d.flags|=4194308),_=!0}else if(u===null){k=d.stateNode;var Y=d.memoizedProps,ce=Od(g,Y);k.props=ce;var $e=k.context,Fe=g.contextType;q=Sc,typeof Fe=="object"&&Fe!==null&&(q=Qr(Fe));var Ve=g.getDerivedStateFromProps;Fe=typeof Ve=="function"||typeof k.getSnapshotBeforeUpdate=="function",Y=d.pendingProps!==Y,Fe||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(Y||$e!==q)&&vD(d,k,_,q),Lu=!1;var Ae=d.memoizedState;k.state=Ae,Cg(d,_,k,I),Ig(),$e=d.memoizedState,Y||Ae!==$e||Lu?(typeof Ve=="function"&&(SS(d,g,Ve,_),$e=d.memoizedState),(ce=Lu||yD(d,g,ce,_,Ae,$e,q))?(Fe||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(d.flags|=4194308)):(typeof k.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=_,d.memoizedState=$e),k.props=_,k.state=$e,k.context=q,_=ce):(typeof k.componentDidMount=="function"&&(d.flags|=4194308),_=!1)}else{k=d.stateNode,sS(u,d),q=d.memoizedProps,Fe=Od(g,q),k.props=Fe,Ve=d.pendingProps,Ae=k.context,$e=g.contextType,ce=Sc,typeof $e=="object"&&$e!==null&&(ce=Qr($e)),Y=g.getDerivedStateFromProps,($e=typeof Y=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(q!==Ve||Ae!==ce)&&vD(d,k,_,ce),Lu=!1,Ae=d.memoizedState,k.state=Ae,Cg(d,_,k,I),Ig();var Le=d.memoizedState;q!==Ve||Ae!==Le||Lu||u!==null&&u.dependencies!==null&&w_(u.dependencies)?(typeof Y=="function"&&(SS(d,g,Y,_),Le=d.memoizedState),(Fe=Lu||yD(d,g,Fe,_,Ae,Le,ce)||u!==null&&u.dependencies!==null&&w_(u.dependencies))?($e||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(_,Le,ce),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(_,Le,ce)),typeof k.componentDidUpdate=="function"&&(d.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof k.componentDidUpdate!="function"||q===u.memoizedProps&&Ae===u.memoizedState||(d.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||q===u.memoizedProps&&Ae===u.memoizedState||(d.flags|=1024),d.memoizedProps=_,d.memoizedState=Le),k.props=_,k.state=Le,k.context=ce,_=Fe):(typeof k.componentDidUpdate!="function"||q===u.memoizedProps&&Ae===u.memoizedState||(d.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||q===u.memoizedProps&&Ae===u.memoizedState||(d.flags|=1024),_=!1)}return k=_,z_(u,d),_=(d.flags&128)!==0,k||_?(k=d.stateNode,g=_&&typeof g.getDerivedStateFromError!="function"?null:k.render(),d.flags|=1,u!==null&&_?(d.child=Tp(d,u.child,null,I),d.child=Tp(d,null,g,I)):$r(u,d,g,I),d.memoizedState=k.state,u=d.child):u=Cc(u,d,I),u}function DD(u,d,g,_){return Ru(),d.flags|=256,$r(u,d,g,_),d.child}var CS={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kS(u){return{baseLanes:u,cachePool:_R()}}function $S(u,d,g){return u=u!==null?u.childLanes&~g:0,d&&(u|=Xa),u}function LD(u,d,g){var _=d.pendingProps,I=!1,k=(d.flags&128)!==0,q;if((q=k)||(q=u!==null&&u.memoizedState===null?!1:(rr.current&2)!==0),q&&(I=!0,d.flags&=-129),q=(d.flags&32)!==0,d.flags&=-33,u===null){if(kt){if(I?Fu(d):ju(),kt){var Y=ut,ce;if(ce=Y){e:{for(ce=Y,Y=ms;ce.nodeType!==8;){if(!Y){Y=null;break e}if(ce=Ro(ce.nextSibling),ce===null){Y=null;break e}}Y=ce}Y!==null?(d.memoizedState={dehydrated:Y,treeContext:z!==null?{id:X,overflow:le}:null,retryLane:536870912,hydrationErrors:null},ce=Ci(18,null,null,0),ce.stateNode=Y,ce.return=d,d.child=ce,it=d,ut=null,ce=!0):ce=!1}ce||Wi(d)}if(Y=d.memoizedState,Y!==null&&(Y=Y.dehydrated,Y!==null))return fE(Y)?d.lanes=32:d.lanes=536870912,null;Ic(d)}return Y=_.children,_=_.fallback,I?(ju(),I=d.mode,Y=V_({mode:"hidden",children:Y},I),_=dl(_,I,g,null),Y.return=d,_.return=d,Y.sibling=_,d.child=Y,I=d.child,I.memoizedState=kS(g),I.childLanes=$S(u,q,g),d.memoizedState=CS,_):(Fu(d),AS(d,Y))}if(ce=u.memoizedState,ce!==null&&(Y=ce.dehydrated,Y!==null)){if(k)d.flags&256?(Fu(d),d.flags&=-257,d=RS(u,d,g)):d.memoizedState!==null?(ju(),d.child=u.child,d.flags|=128,d=null):(ju(),I=_.fallback,Y=d.mode,_=V_({mode:"visible",children:_.children},Y),I=dl(I,Y,g,null),I.flags|=2,_.return=d,I.return=d,_.sibling=I,d.child=_,Tp(d,u.child,null,g),_=d.child,_.memoizedState=kS(g),_.childLanes=$S(u,q,g),d.memoizedState=CS,d=I);else if(Fu(d),fE(Y)){if(q=Y.nextSibling&&Y.nextSibling.dataset,q)var $e=q.dgst;q=$e,_=Error(s(419)),_.stack="",_.digest=q,Du({value:_,source:null,stack:null}),d=RS(u,d,g)}else if(_r||Ad(u,d,g,!1),q=(g&u.childLanes)!==0,_r||q){if(q=Hn,q!==null&&(_=g&-g,_=(_&42)!==0?1:hd(_),_=(_&(q.suspendedLanes|g))!==0?0:_,_!==0&&_!==ce.retryLane))throw ce.retryLane=_,$u(u,_),Ta(q,u,_),ED;Y.data==="$?"||ZS(),d=RS(u,d,g)}else Y.data==="$?"?(d.flags|=192,d.child=u.child,d=null):(u=ce.treeContext,ut=Ro(Y.nextSibling),it=d,kt=!0,Wn=null,ms=!1,u!==null&&(N[A++]=X,N[A++]=le,N[A++]=z,X=u.id,le=u.overflow,z=d),d=AS(d,_.children),d.flags|=4096);return d}return I?(ju(),I=_.fallback,Y=d.mode,ce=u.child,$e=ce.sibling,_=Ha(ce,{mode:"hidden",children:_.children}),_.subtreeFlags=ce.subtreeFlags&65011712,$e!==null?I=Ha($e,I):(I=dl(I,Y,g,null),I.flags|=2),I.return=d,_.return=d,_.sibling=I,d.child=_,_=I,I=d.child,Y=u.child.memoizedState,Y===null?Y=kS(g):(ce=Y.cachePool,ce!==null?($e=sr._currentValue,ce=ce.parent!==$e?{parent:$e,pool:$e}:ce):ce=_R(),Y={baseLanes:Y.baseLanes|g,cachePool:ce}),I.memoizedState=Y,I.childLanes=$S(u,q,g),d.memoizedState=CS,_):(Fu(d),g=u.child,u=g.sibling,g=Ha(g,{mode:"visible",children:_.children}),g.return=d,g.sibling=null,u!==null&&(q=d.deletions,q===null?(d.deletions=[u],d.flags|=16):q.push(u)),d.child=g,d.memoizedState=null,g)}function AS(u,d){return d=V_({mode:"visible",children:d},u.mode),d.return=u,u.child=d}function V_(u,d){return u=Ci(22,u,null,d),u.lanes=0,u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},u}function RS(u,d,g){return Tp(d,u.child,null,g),u=AS(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function OD(u,d,g){u.lanes|=d;var _=u.alternate;_!==null&&(_.lanes|=d),$d(u.return,d,g)}function DS(u,d,g,_,I){var k=u.memoizedState;k===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:_,tail:g,tailMode:I}:(k.isBackwards=d,k.rendering=null,k.renderingStartTime=0,k.last=_,k.tail=g,k.tailMode=I)}function PD(u,d,g){var _=d.pendingProps,I=_.revealOrder,k=_.tail;if($r(u,d,_.children,g),_=rr.current,(_&2)!==0)_=_&1|2,d.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&OD(u,g,d);else if(u.tag===19)OD(u,g,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}_&=1}switch(fe(rr,_),I){case"forwards":for(g=d.child,I=null;g!==null;)u=g.alternate,u!==null&&F_(u)===null&&(I=g),g=g.sibling;g=I,g===null?(I=d.child,d.child=null):(I=g.sibling,g.sibling=null),DS(d,!1,I,g,k);break;case"backwards":for(g=null,I=d.child,d.child=null;I!==null;){if(u=I.alternate,u!==null&&F_(u)===null){d.child=I;break}u=I.sibling,I.sibling=g,g=I,I=u}DS(d,!0,g,null,k);break;case"together":DS(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function Cc(u,d,g){if(u!==null&&(d.dependencies=u.dependencies),Gu|=d.lanes,(g&d.childLanes)===0)if(u!==null){if(Ad(u,d,g,!1),(g&d.childLanes)===0)return null}else return null;if(u!==null&&d.child!==u.child)throw Error(s(153));if(d.child!==null){for(u=d.child,g=Ha(u,u.pendingProps),d.child=g,g.return=d;u.sibling!==null;)u=u.sibling,g=g.sibling=Ha(u,u.pendingProps),g.return=d;g.sibling=null}return d.child}function LS(u,d){return(u.lanes&d)!==0?!0:(u=u.dependencies,!!(u!==null&&w_(u)))}function F7(u,d,g){switch(d.tag){case 3:qe(d,d.stateNode.containerInfo),fl(d,sr,u.memoizedState.cache),Ru();break;case 27:case 5:pt(d);break;case 4:qe(d,d.stateNode.containerInfo);break;case 10:fl(d,d.type,d.memoizedProps.value);break;case 13:var _=d.memoizedState;if(_!==null)return _.dehydrated!==null?(Fu(d),d.flags|=128,null):(g&d.child.childLanes)!==0?LD(u,d,g):(Fu(d),u=Cc(u,d,g),u!==null?u.sibling:null);Fu(d);break;case 19:var I=(u.flags&128)!==0;if(_=(g&d.childLanes)!==0,_||(Ad(u,d,g,!1),_=(g&d.childLanes)!==0),I){if(_)return PD(u,d,g);d.flags|=128}if(I=d.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),fe(rr,rr.current),_)break;return null;case 22:case 23:return d.lanes=0,kD(u,d,g);case 24:fl(d,sr,u.memoizedState.cache)}return Cc(u,d,g)}function MD(u,d,g){if(u!==null)if(u.memoizedProps!==d.pendingProps)_r=!0;else{if(!LS(u,g)&&(d.flags&128)===0)return _r=!1,F7(u,d,g);_r=(u.flags&131072)!==0}else _r=!1,kt&&(d.flags&1048576)!==0&&Oe(d,b,d.index);switch(d.lanes=0,d.tag){case 16:e:{u=d.pendingProps;var _=d.elementType,I=_._init;if(_=I(_._payload),d.type=_,typeof _=="function")fp(_)?(u=Od(_,u),d.tag=1,d=RD(null,d,_,u,g)):(d.tag=0,d=IS(null,d,_,u,g));else{if(_!=null){if(I=_.$$typeof,I===R){d.tag=11,d=ND(null,d,_,u,g);break e}else if(I===j){d.tag=14,d=ID(null,d,_,u,g);break e}}throw d=ae(_)||_,Error(s(306,d,""))}}return d;case 0:return IS(u,d,d.type,d.pendingProps,g);case 1:return _=d.type,I=Od(_,d.pendingProps),RD(u,d,_,I,g);case 3:e:{if(qe(d,d.stateNode.containerInfo),u===null)throw Error(s(387));_=d.pendingProps;var k=d.memoizedState;I=k.element,sS(u,d),Cg(d,_,null,g);var q=d.memoizedState;if(_=q.cache,fl(d,sr,_),_!==k.cache&&mp(d,[sr],g,!0),Ig(),_=q.element,k.isDehydrated)if(k={element:_,isDehydrated:!1,cache:q.cache},d.updateQueue.baseState=k,d.memoizedState=k,d.flags&256){d=DD(u,d,_,g);break e}else if(_!==I){I=Ni(Error(s(424)),d),Du(I),d=DD(u,d,_,g);break e}else{switch(u=d.stateNode.containerInfo,u.nodeType){case 9:u=u.body;break;default:u=u.nodeName==="HTML"?u.ownerDocument.body:u}for(ut=Ro(u.firstChild),it=d,kt=!0,Wn=null,ms=!0,g=mD(d,null,_,g),d.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(Ru(),_===I){d=Cc(u,d,g);break e}$r(u,d,_,g)}d=d.child}return d;case 26:return z_(u,d),u===null?(g=zL(d.type,null,d.pendingProps,null))?d.memoizedState=g:kt||(g=d.type,u=d.pendingProps,_=nx(Se.current).createElement(g),_[ds]=d,_[er]=u,Rr(_,g,u),fs(_),d.stateNode=_):d.memoizedState=zL(d.type,u.memoizedProps,d.pendingProps,u.memoizedState),null;case 27:return pt(d),u===null&&kt&&(_=d.stateNode=FL(d.type,d.pendingProps,Se.current),it=d,ms=!0,I=ut,Ku(d.type)?(pE=I,ut=Ro(_.firstChild)):ut=I),$r(u,d,d.pendingProps.children,g),z_(u,d),u===null&&(d.flags|=4194304),d.child;case 5:return u===null&&kt&&((I=_=ut)&&(_=dX(_,d.type,d.pendingProps,ms),_!==null?(d.stateNode=_,it=d,ut=Ro(_.firstChild),ms=!1,I=!0):I=!1),I||Wi(d)),pt(d),I=d.type,k=d.pendingProps,q=u!==null?u.memoizedProps:null,_=k.children,uE(I,k)?_=null:q!==null&&uE(I,q)&&(d.flags|=32),d.memoizedState!==null&&(I=cS(u,d,$7,null,null,g),Zg._currentValue=I),z_(u,d),$r(u,d,_,g),d.child;case 6:return u===null&&kt&&((u=g=ut)&&(g=fX(g,d.pendingProps,ms),g!==null?(d.stateNode=g,it=d,ut=null,u=!0):u=!1),u||Wi(d)),null;case 13:return LD(u,d,g);case 4:return qe(d,d.stateNode.containerInfo),_=d.pendingProps,u===null?d.child=Tp(d,null,_,g):$r(u,d,_,g),d.child;case 11:return ND(u,d,d.type,d.pendingProps,g);case 7:return $r(u,d,d.pendingProps,g),d.child;case 8:return $r(u,d,d.pendingProps.children,g),d.child;case 12:return $r(u,d,d.pendingProps.children,g),d.child;case 10:return _=d.pendingProps,fl(d,d.type,_.value),$r(u,d,_.children,g),d.child;case 9:return I=d.type._context,_=d.pendingProps.children,Rd(d),I=Qr(I),_=_(I),d.flags|=1,$r(u,d,_,g),d.child;case 14:return ID(u,d,d.type,d.pendingProps,g);case 15:return CD(u,d,d.type,d.pendingProps,g);case 19:return PD(u,d,g);case 31:return _=d.pendingProps,g=d.mode,_={mode:_.mode,children:_.children},u===null?(g=V_(_,g),g.ref=d.ref,d.child=g,g.return=d,d=g):(g=Ha(u.child,_),g.ref=d.ref,d.child=g,g.return=d,d=g),d;case 22:return kD(u,d,g);case 24:return Rd(d),_=Qr(sr),u===null?(I=eS(),I===null&&(I=Hn,k=QT(),I.pooledCache=k,k.refCount++,k!==null&&(I.pooledCacheLanes|=g),I=k),d.memoizedState={parent:_,cache:I},nS(d),fl(d,sr,I)):((u.lanes&g)!==0&&(sS(u,d),Cg(d,null,null,g),Ig()),I=u.memoizedState,k=d.memoizedState,I.parent!==_?(I={parent:_,cache:_},d.memoizedState=I,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=I),fl(d,sr,_)):(_=k.cache,fl(d,sr,_),_!==I.cache&&mp(d,[sr],g,!0))),$r(u,d,d.pendingProps.children,g),d.child;case 29:throw d.pendingProps}throw Error(s(156,d.tag))}function kc(u){u.flags|=4}function FD(u,d){if(d.type!=="stylesheet"||(d.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!HL(d)){if(d=Ka.current,d!==null&&((dn&4194048)===dn?pl!==null:(dn&62914560)!==dn&&(dn&536870912)===0||d!==pl))throw Eg=tS,xR;u.flags|=8192}}function U_(u,d){d!==null&&(u.flags|=4),u.flags&16384&&(d=u.tag!==22?go():536870912,u.lanes|=d,Ip|=d)}function Og(u,d){if(!kt)switch(u.tailMode){case"hidden":d=u.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?u.tail=null:g.sibling=null;break;case"collapsed":g=u.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:_.sibling=null}}function gs(u){var d=u.alternate!==null&&u.alternate.child===u.child,g=0,_=0;if(d)for(var I=u.child;I!==null;)g|=I.lanes|I.childLanes,_|=I.subtreeFlags&65011712,_|=I.flags&65011712,I.return=u,I=I.sibling;else for(I=u.child;I!==null;)g|=I.lanes|I.childLanes,_|=I.subtreeFlags,_|=I.flags,I.return=u,I=I.sibling;return u.subtreeFlags|=_,u.childLanes=g,d}function j7(u,d,g){var _=d.pendingProps;switch(Je(d),d.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gs(d),null;case 1:return gs(d),null;case 3:return g=d.stateNode,_=null,u!==null&&(_=u.memoizedState.cache),d.memoizedState.cache!==_&&(d.flags|=2048),$o(sr),Qe(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(u===null||u.child===null)&&(kd(d)?kc(d):u===null||u.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,x_())),gs(d),null;case 26:return g=d.memoizedState,u===null?(kc(d),g!==null?(gs(d),FD(d,g)):(gs(d),d.flags&=-16777217)):g?g!==u.memoizedState?(kc(d),gs(d),FD(d,g)):(gs(d),d.flags&=-16777217):(u.memoizedProps!==_&&kc(d),gs(d),d.flags&=-16777217),null;case 27:vt(d),g=Se.current;var I=d.type;if(u!==null&&d.stateNode!=null)u.memoizedProps!==_&&kc(d);else{if(!_){if(d.stateNode===null)throw Error(s(166));return gs(d),null}u=Ne.current,kd(d)?b_(d):(u=FL(I,_,g),d.stateNode=u,kc(d))}return gs(d),null;case 5:if(vt(d),g=d.type,u!==null&&d.stateNode!=null)u.memoizedProps!==_&&kc(d);else{if(!_){if(d.stateNode===null)throw Error(s(166));return gs(d),null}if(u=Ne.current,kd(d))b_(d);else{switch(I=nx(Se.current),u){case 1:u=I.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:u=I.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":u=I.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":u=I.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":u=I.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof _.is=="string"?I.createElement("select",{is:_.is}):I.createElement("select"),_.multiple?u.multiple=!0:_.size&&(u.size=_.size);break;default:u=typeof _.is=="string"?I.createElement(g,{is:_.is}):I.createElement(g)}}u[ds]=d,u[er]=_;e:for(I=d.child;I!==null;){if(I.tag===5||I.tag===6)u.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===d)break e;for(;I.sibling===null;){if(I.return===null||I.return===d)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}d.stateNode=u;e:switch(Rr(u,g,_),g){case"button":case"input":case"select":case"textarea":u=!!_.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&kc(d)}}return gs(d),d.flags&=-16777217,null;case 6:if(u&&d.stateNode!=null)u.memoizedProps!==_&&kc(d);else{if(typeof _!="string"&&d.stateNode===null)throw Error(s(166));if(u=Se.current,kd(d)){if(u=d.stateNode,g=d.memoizedProps,_=null,I=it,I!==null)switch(I.tag){case 27:case 5:_=I.memoizedProps}u[ds]=d,u=!!(u.nodeValue===g||_!==null&&_.suppressHydrationWarning===!0||AL(u.nodeValue,g)),u||Wi(d)}else u=nx(u).createTextNode(_),u[ds]=d,d.stateNode=u}return gs(d),null;case 13:if(_=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(I=kd(d),_!==null&&_.dehydrated!==null){if(u===null){if(!I)throw Error(s(318));if(I=d.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(s(317));I[ds]=d}else Ru(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;gs(d),I=!1}else I=x_(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=I),I=!0;if(!I)return d.flags&256?(Ic(d),d):(Ic(d),null)}if(Ic(d),(d.flags&128)!==0)return d.lanes=g,d;if(g=_!==null,u=u!==null&&u.memoizedState!==null,g){_=d.child,I=null,_.alternate!==null&&_.alternate.memoizedState!==null&&_.alternate.memoizedState.cachePool!==null&&(I=_.alternate.memoizedState.cachePool.pool);var k=null;_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(k=_.memoizedState.cachePool.pool),k!==I&&(_.flags|=2048)}return g!==u&&g&&(d.child.flags|=8192),U_(d,d.updateQueue),gs(d),null;case 4:return Qe(),u===null&&iE(d.stateNode.containerInfo),gs(d),null;case 10:return $o(d.type),gs(d),null;case 19:if(pe(rr),I=d.memoizedState,I===null)return gs(d),null;if(_=(d.flags&128)!==0,k=I.rendering,k===null)if(_)Og(I,!1);else{if(xs!==0||u!==null&&(u.flags&128)!==0)for(u=d.child;u!==null;){if(k=F_(u),k!==null){for(d.flags|=128,Og(I,!1),u=k.updateQueue,d.updateQueue=u,U_(d,u),d.subtreeFlags=0,u=g,g=d.child;g!==null;)_g(g,u),g=g.sibling;return fe(rr,rr.current&1|2),d.child}u=u.sibling}I.tail!==null&&Ot()>H_&&(d.flags|=128,_=!0,Og(I,!1),d.lanes=4194304)}else{if(!_)if(u=F_(k),u!==null){if(d.flags|=128,_=!0,u=u.updateQueue,d.updateQueue=u,U_(d,u),Og(I,!0),I.tail===null&&I.tailMode==="hidden"&&!k.alternate&&!kt)return gs(d),null}else 2*Ot()-I.renderingStartTime>H_&&g!==536870912&&(d.flags|=128,_=!0,Og(I,!1),d.lanes=4194304);I.isBackwards?(k.sibling=d.child,d.child=k):(u=I.last,u!==null?u.sibling=k:d.child=k,I.last=k)}return I.tail!==null?(d=I.tail,I.rendering=d,I.tail=d.sibling,I.renderingStartTime=Ot(),d.sibling=null,u=rr.current,fe(rr,_?u&1|2:u&1),d):(gs(d),null);case 22:case 23:return Ic(d),oS(),_=d.memoizedState!==null,u!==null?u.memoizedState!==null!==_&&(d.flags|=8192):_&&(d.flags|=8192),_?(g&536870912)!==0&&(d.flags&128)===0&&(gs(d),d.subtreeFlags&6&&(d.flags|=8192)):gs(d),g=d.updateQueue,g!==null&&U_(d,g.retryQueue),g=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),_=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),_!==g&&(d.flags|=2048),u!==null&&pe(Dd),null;case 24:return g=null,u!==null&&(g=u.memoizedState.cache),d.memoizedState.cache!==g&&(d.flags|=2048),$o(sr),gs(d),null;case 25:return null;case 30:return null}throw Error(s(156,d.tag))}function B7(u,d){switch(Je(d),d.tag){case 1:return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return $o(sr),Qe(),u=d.flags,(u&65536)!==0&&(u&128)===0?(d.flags=u&-65537|128,d):null;case 26:case 27:case 5:return vt(d),null;case 13:if(Ic(d),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(s(340));Ru()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return pe(rr),null;case 4:return Qe(),null;case 10:return $o(d.type),null;case 22:case 23:return Ic(d),oS(),u!==null&&pe(Dd),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 24:return $o(sr),null;case 25:return null;default:return null}}function jD(u,d){switch(Je(d),d.tag){case 3:$o(sr),Qe();break;case 26:case 27:case 5:vt(d);break;case 4:Qe();break;case 13:Ic(d);break;case 19:pe(rr);break;case 10:$o(d.type);break;case 22:case 23:Ic(d),oS(),u!==null&&pe(Dd);break;case 24:$o(sr)}}function Pg(u,d){try{var g=d.updateQueue,_=g!==null?g.lastEffect:null;if(_!==null){var I=_.next;g=I;do{if((g.tag&u)===u){_=void 0;var k=g.create,q=g.inst;_=k(),q.destroy=_}g=g.next}while(g!==I)}}catch(Y){Fn(d,d.return,Y)}}function Bu(u,d,g){try{var _=d.updateQueue,I=_!==null?_.lastEffect:null;if(I!==null){var k=I.next;_=k;do{if((_.tag&u)===u){var q=_.inst,Y=q.destroy;if(Y!==void 0){q.destroy=void 0,I=d;var ce=g,$e=Y;try{$e()}catch(Fe){Fn(I,ce,Fe)}}}_=_.next}while(_!==k)}}catch(Fe){Fn(d,d.return,Fe)}}function BD(u){var d=u.updateQueue;if(d!==null){var g=u.stateNode;try{IR(d,g)}catch(_){Fn(u,u.return,_)}}}function zD(u,d,g){g.props=Od(u.type,u.memoizedProps),g.state=u.memoizedState;try{g.componentWillUnmount()}catch(_){Fn(u,d,_)}}function Mg(u,d){try{var g=u.ref;if(g!==null){switch(u.tag){case 26:case 27:case 5:var _=u.stateNode;break;case 30:_=u.stateNode;break;default:_=u.stateNode}typeof g=="function"?u.refCleanup=g(_):g.current=_}}catch(I){Fn(u,d,I)}}function ml(u,d){var g=u.ref,_=u.refCleanup;if(g!==null)if(typeof _=="function")try{_()}catch(I){Fn(u,d,I)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(I){Fn(u,d,I)}else g.current=null}function VD(u){var d=u.type,g=u.memoizedProps,_=u.stateNode;try{e:switch(d){case"button":case"input":case"select":case"textarea":g.autoFocus&&_.focus();break e;case"img":g.src?_.src=g.src:g.srcSet&&(_.srcset=g.srcSet)}}catch(I){Fn(u,u.return,I)}}function OS(u,d,g){try{var _=u.stateNode;oX(_,u.type,g,d),_[er]=d}catch(I){Fn(u,u.return,I)}}function UD(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27&&Ku(u.type)||u.tag===4}function PS(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||UD(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.tag===27&&Ku(u.type)||u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function MS(u,d,g){var _=u.tag;if(_===5||_===6)u=u.stateNode,d?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(u,d):(d=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,d.appendChild(u),g=g._reactRootContainer,g!=null||d.onclick!==null||(d.onclick=tx));else if(_!==4&&(_===27&&Ku(u.type)&&(g=u.stateNode,d=null),u=u.child,u!==null))for(MS(u,d,g),u=u.sibling;u!==null;)MS(u,d,g),u=u.sibling}function G_(u,d,g){var _=u.tag;if(_===5||_===6)u=u.stateNode,d?g.insertBefore(u,d):g.appendChild(u);else if(_!==4&&(_===27&&Ku(u.type)&&(g=u.stateNode),u=u.child,u!==null))for(G_(u,d,g),u=u.sibling;u!==null;)G_(u,d,g),u=u.sibling}function GD(u){var d=u.stateNode,g=u.memoizedProps;try{for(var _=u.type,I=d.attributes;I.length;)d.removeAttributeNode(I[0]);Rr(d,_,g),d[ds]=u,d[er]=g}catch(k){Fn(u,u.return,k)}}var $c=!1,Rs=!1,FS=!1,WD=typeof WeakSet=="function"?WeakSet:Set,xr=null;function z7(u,d){if(u=u.containerInfo,lE=lx,u=wd(u),Td(u)){if("selectionStart"in u)var g={start:u.selectionStart,end:u.selectionEnd};else e:{g=(g=u.ownerDocument)&&g.defaultView||window;var _=g.getSelection&&g.getSelection();if(_&&_.rangeCount!==0){g=_.anchorNode;var I=_.anchorOffset,k=_.focusNode;_=_.focusOffset;try{g.nodeType,k.nodeType}catch{g=null;break e}var q=0,Y=-1,ce=-1,$e=0,Fe=0,Ve=u,Ae=null;t:for(;;){for(var Le;Ve!==g||I!==0&&Ve.nodeType!==3||(Y=q+I),Ve!==k||_!==0&&Ve.nodeType!==3||(ce=q+_),Ve.nodeType===3&&(q+=Ve.nodeValue.length),(Le=Ve.firstChild)!==null;)Ae=Ve,Ve=Le;for(;;){if(Ve===u)break t;if(Ae===g&&++$e===I&&(Y=q),Ae===k&&++Fe===_&&(ce=q),(Le=Ve.nextSibling)!==null)break;Ve=Ae,Ae=Ve.parentNode}Ve=Le}g=Y===-1||ce===-1?null:{start:Y,end:ce}}else g=null}g=g||{start:0,end:0}}else g=null;for(cE={focusedElem:u,selectionRange:g},lx=!1,xr=d;xr!==null;)if(d=xr,u=d.child,(d.subtreeFlags&1024)!==0&&u!==null)u.return=d,xr=u;else for(;xr!==null;){switch(d=xr,k=d.alternate,u=d.flags,d.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&k!==null){u=void 0,g=d,I=k.memoizedProps,k=k.memoizedState,_=g.stateNode;try{var Ct=Od(g.type,I,g.elementType===g.type);u=_.getSnapshotBeforeUpdate(Ct,k),_.__reactInternalSnapshotBeforeUpdate=u}catch(bt){Fn(g,g.return,bt)}}break;case 3:if((u&1024)!==0){if(u=d.stateNode.containerInfo,g=u.nodeType,g===9)dE(u);else if(g===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":dE(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(s(163))}if(u=d.sibling,u!==null){u.return=d.return,xr=u;break}xr=d.return}}function HD(u,d,g){var _=g.flags;switch(g.tag){case 0:case 11:case 15:zu(u,g),_&4&&Pg(5,g);break;case 1:if(zu(u,g),_&4)if(u=g.stateNode,d===null)try{u.componentDidMount()}catch(q){Fn(g,g.return,q)}else{var I=Od(g.type,d.memoizedProps);d=d.memoizedState;try{u.componentDidUpdate(I,d,u.__reactInternalSnapshotBeforeUpdate)}catch(q){Fn(g,g.return,q)}}_&64&&BD(g),_&512&&Mg(g,g.return);break;case 3:if(zu(u,g),_&64&&(u=g.updateQueue,u!==null)){if(d=null,g.child!==null)switch(g.child.tag){case 27:case 5:d=g.child.stateNode;break;case 1:d=g.child.stateNode}try{IR(u,d)}catch(q){Fn(g,g.return,q)}}break;case 27:d===null&&_&4&&GD(g);case 26:case 5:zu(u,g),d===null&&_&4&&VD(g),_&512&&Mg(g,g.return);break;case 12:zu(u,g);break;case 13:zu(u,g),_&4&&XD(u,g),_&64&&(u=g.memoizedState,u!==null&&(u=u.dehydrated,u!==null&&(g=Z7.bind(null,g),pX(u,g))));break;case 22:if(_=g.memoizedState!==null||$c,!_){d=d!==null&&d.memoizedState!==null||Rs,I=$c;var k=Rs;$c=_,(Rs=d)&&!k?Vu(u,g,(g.subtreeFlags&8772)!==0):zu(u,g),$c=I,Rs=k}break;case 30:break;default:zu(u,g)}}function qD(u){var d=u.alternate;d!==null&&(u.alternate=null,qD(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&oc(d)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var as=null,qi=!1;function Ac(u,d,g){for(g=g.child;g!==null;)KD(u,d,g),g=g.sibling}function KD(u,d,g){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount($s,g)}catch{}switch(g.tag){case 26:Rs||ml(g,d),Ac(u,d,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:Rs||ml(g,d);var _=as,I=qi;Ku(g.type)&&(as=g.stateNode,qi=!1),Ac(u,d,g),Hg(g.stateNode),as=_,qi=I;break;case 5:Rs||ml(g,d);case 6:if(_=as,I=qi,as=null,Ac(u,d,g),as=_,qi=I,as!==null)if(qi)try{(as.nodeType===9?as.body:as.nodeName==="HTML"?as.ownerDocument.body:as).removeChild(g.stateNode)}catch(k){Fn(g,d,k)}else try{as.removeChild(g.stateNode)}catch(k){Fn(g,d,k)}break;case 18:as!==null&&(qi?(u=as,PL(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,g.stateNode),ey(u)):PL(as,g.stateNode));break;case 4:_=as,I=qi,as=g.stateNode.containerInfo,qi=!0,Ac(u,d,g),as=_,qi=I;break;case 0:case 11:case 14:case 15:Rs||Bu(2,g,d),Rs||Bu(4,g,d),Ac(u,d,g);break;case 1:Rs||(ml(g,d),_=g.stateNode,typeof _.componentWillUnmount=="function"&&zD(g,d,_)),Ac(u,d,g);break;case 21:Ac(u,d,g);break;case 22:Rs=(_=Rs)||g.memoizedState!==null,Ac(u,d,g),Rs=_;break;default:Ac(u,d,g)}}function XD(u,d){if(d.memoizedState===null&&(u=d.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{ey(u)}catch(g){Fn(d,d.return,g)}}function V7(u){switch(u.tag){case 13:case 19:var d=u.stateNode;return d===null&&(d=u.stateNode=new WD),d;case 22:return u=u.stateNode,d=u._retryCache,d===null&&(d=u._retryCache=new WD),d;default:throw Error(s(435,u.tag))}}function jS(u,d){var g=V7(u);d.forEach(function(_){var I=Y7.bind(null,u,_);g.has(_)||(g.add(_),_.then(I,I))})}function ba(u,d){var g=d.deletions;if(g!==null)for(var _=0;_<g.length;_++){var I=g[_],k=u,q=d,Y=q;e:for(;Y!==null;){switch(Y.tag){case 27:if(Ku(Y.type)){as=Y.stateNode,qi=!1;break e}break;case 5:as=Y.stateNode,qi=!1;break e;case 3:case 4:as=Y.stateNode.containerInfo,qi=!0;break e}Y=Y.return}if(as===null)throw Error(s(160));KD(k,q,I),as=null,qi=!1,k=I.alternate,k!==null&&(k.return=null),I.return=null}if(d.subtreeFlags&13878)for(d=d.child;d!==null;)ZD(d,u),d=d.sibling}var Ao=null;function ZD(u,d){var g=u.alternate,_=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:ba(d,u),_a(u),_&4&&(Bu(3,u,u.return),Pg(3,u),Bu(5,u,u.return));break;case 1:ba(d,u),_a(u),_&512&&(Rs||g===null||ml(g,g.return)),_&64&&$c&&(u=u.updateQueue,u!==null&&(_=u.callbacks,_!==null&&(g=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=g===null?_:g.concat(_))));break;case 26:var I=Ao;if(ba(d,u),_a(u),_&512&&(Rs||g===null||ml(g,g.return)),_&4){var k=g!==null?g.memoizedState:null;if(_=u.memoizedState,g===null)if(_===null)if(u.stateNode===null){e:{_=u.type,g=u.memoizedProps,I=I.ownerDocument||I;t:switch(_){case"title":k=I.getElementsByTagName("title")[0],(!k||k[bo]||k[ds]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=I.createElement(_),I.head.insertBefore(k,I.querySelector("head > title"))),Rr(k,_,g),k[ds]=u,fs(k),_=k;break e;case"link":var q=GL("link","href",I).get(_+(g.href||""));if(q){for(var Y=0;Y<q.length;Y++)if(k=q[Y],k.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&k.getAttribute("rel")===(g.rel==null?null:g.rel)&&k.getAttribute("title")===(g.title==null?null:g.title)&&k.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){q.splice(Y,1);break t}}k=I.createElement(_),Rr(k,_,g),I.head.appendChild(k);break;case"meta":if(q=GL("meta","content",I).get(_+(g.content||""))){for(Y=0;Y<q.length;Y++)if(k=q[Y],k.getAttribute("content")===(g.content==null?null:""+g.content)&&k.getAttribute("name")===(g.name==null?null:g.name)&&k.getAttribute("property")===(g.property==null?null:g.property)&&k.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&k.getAttribute("charset")===(g.charSet==null?null:g.charSet)){q.splice(Y,1);break t}}k=I.createElement(_),Rr(k,_,g),I.head.appendChild(k);break;default:throw Error(s(468,_))}k[ds]=u,fs(k),_=k}u.stateNode=_}else WL(I,u.type,u.stateNode);else u.stateNode=UL(I,_,u.memoizedProps);else k!==_?(k===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):k.count--,_===null?WL(I,u.type,u.stateNode):UL(I,_,u.memoizedProps)):_===null&&u.stateNode!==null&&OS(u,u.memoizedProps,g.memoizedProps)}break;case 27:ba(d,u),_a(u),_&512&&(Rs||g===null||ml(g,g.return)),g!==null&&_&4&&OS(u,u.memoizedProps,g.memoizedProps);break;case 5:if(ba(d,u),_a(u),_&512&&(Rs||g===null||ml(g,g.return)),u.flags&32){I=u.stateNode;try{pr(I,"")}catch(Le){Fn(u,u.return,Le)}}_&4&&u.stateNode!=null&&(I=u.memoizedProps,OS(u,I,g!==null?g.memoizedProps:I)),_&1024&&(FS=!0);break;case 6:if(ba(d,u),_a(u),_&4){if(u.stateNode===null)throw Error(s(162));_=u.memoizedProps,g=u.stateNode;try{g.nodeValue=_}catch(Le){Fn(u,u.return,Le)}}break;case 3:if(ix=null,I=Ao,Ao=sx(d.containerInfo),ba(d,u),Ao=I,_a(u),_&4&&g!==null&&g.memoizedState.isDehydrated)try{ey(d.containerInfo)}catch(Le){Fn(u,u.return,Le)}FS&&(FS=!1,YD(u));break;case 4:_=Ao,Ao=sx(u.stateNode.containerInfo),ba(d,u),_a(u),Ao=_;break;case 12:ba(d,u),_a(u);break;case 13:ba(d,u),_a(u),u.child.flags&8192&&u.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(WS=Ot()),_&4&&(_=u.updateQueue,_!==null&&(u.updateQueue=null,jS(u,_)));break;case 22:I=u.memoizedState!==null;var ce=g!==null&&g.memoizedState!==null,$e=$c,Fe=Rs;if($c=$e||I,Rs=Fe||ce,ba(d,u),Rs=Fe,$c=$e,_a(u),_&8192)e:for(d=u.stateNode,d._visibility=I?d._visibility&-2:d._visibility|1,I&&(g===null||ce||$c||Rs||Pd(u)),g=null,d=u;;){if(d.tag===5||d.tag===26){if(g===null){ce=g=d;try{if(k=ce.stateNode,I)q=k.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{Y=ce.stateNode;var Ve=ce.memoizedProps.style,Ae=Ve!=null&&Ve.hasOwnProperty("display")?Ve.display:null;Y.style.display=Ae==null||typeof Ae=="boolean"?"":(""+Ae).trim()}}catch(Le){Fn(ce,ce.return,Le)}}}else if(d.tag===6){if(g===null){ce=d;try{ce.stateNode.nodeValue=I?"":ce.memoizedProps}catch(Le){Fn(ce,ce.return,Le)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===u)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break e;for(;d.sibling===null;){if(d.return===null||d.return===u)break e;g===d&&(g=null),d=d.return}g===d&&(g=null),d.sibling.return=d.return,d=d.sibling}_&4&&(_=u.updateQueue,_!==null&&(g=_.retryQueue,g!==null&&(_.retryQueue=null,jS(u,g))));break;case 19:ba(d,u),_a(u),_&4&&(_=u.updateQueue,_!==null&&(u.updateQueue=null,jS(u,_)));break;case 30:break;case 21:break;default:ba(d,u),_a(u)}}function _a(u){var d=u.flags;if(d&2){try{for(var g,_=u.return;_!==null;){if(UD(_)){g=_;break}_=_.return}if(g==null)throw Error(s(160));switch(g.tag){case 27:var I=g.stateNode,k=PS(u);G_(u,k,I);break;case 5:var q=g.stateNode;g.flags&32&&(pr(q,""),g.flags&=-33);var Y=PS(u);G_(u,Y,q);break;case 3:case 4:var ce=g.stateNode.containerInfo,$e=PS(u);MS(u,$e,ce);break;default:throw Error(s(161))}}catch(Fe){Fn(u,u.return,Fe)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function YD(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var d=u;YD(d),d.tag===5&&d.flags&1024&&d.stateNode.reset(),u=u.sibling}}function zu(u,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)HD(u,d.alternate,d),d=d.sibling}function Pd(u){for(u=u.child;u!==null;){var d=u;switch(d.tag){case 0:case 11:case 14:case 15:Bu(4,d,d.return),Pd(d);break;case 1:ml(d,d.return);var g=d.stateNode;typeof g.componentWillUnmount=="function"&&zD(d,d.return,g),Pd(d);break;case 27:Hg(d.stateNode);case 26:case 5:ml(d,d.return),Pd(d);break;case 22:d.memoizedState===null&&Pd(d);break;case 30:Pd(d);break;default:Pd(d)}u=u.sibling}}function Vu(u,d,g){for(g=g&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var _=d.alternate,I=u,k=d,q=k.flags;switch(k.tag){case 0:case 11:case 15:Vu(I,k,g),Pg(4,k);break;case 1:if(Vu(I,k,g),_=k,I=_.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch($e){Fn(_,_.return,$e)}if(_=k,I=_.updateQueue,I!==null){var Y=_.stateNode;try{var ce=I.shared.hiddenCallbacks;if(ce!==null)for(I.shared.hiddenCallbacks=null,I=0;I<ce.length;I++)NR(ce[I],Y)}catch($e){Fn(_,_.return,$e)}}g&&q&64&&BD(k),Mg(k,k.return);break;case 27:GD(k);case 26:case 5:Vu(I,k,g),g&&_===null&&q&4&&VD(k),Mg(k,k.return);break;case 12:Vu(I,k,g);break;case 13:Vu(I,k,g),g&&q&4&&XD(I,k);break;case 22:k.memoizedState===null&&Vu(I,k,g),Mg(k,k.return);break;case 30:break;default:Vu(I,k,g)}d=d.sibling}}function BS(u,d){var g=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),u=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(u=d.memoizedState.cachePool.pool),u!==g&&(u!=null&&u.refCount++,g!=null&&wg(g))}function zS(u,d){u=null,d.alternate!==null&&(u=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==u&&(d.refCount++,u!=null&&wg(u))}function gl(u,d,g,_){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)QD(u,d,g,_),d=d.sibling}function QD(u,d,g,_){var I=d.flags;switch(d.tag){case 0:case 11:case 15:gl(u,d,g,_),I&2048&&Pg(9,d);break;case 1:gl(u,d,g,_);break;case 3:gl(u,d,g,_),I&2048&&(u=null,d.alternate!==null&&(u=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==u&&(d.refCount++,u!=null&&wg(u)));break;case 12:if(I&2048){gl(u,d,g,_),u=d.stateNode;try{var k=d.memoizedProps,q=k.id,Y=k.onPostCommit;typeof Y=="function"&&Y(q,d.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(ce){Fn(d,d.return,ce)}}else gl(u,d,g,_);break;case 13:gl(u,d,g,_);break;case 23:break;case 22:k=d.stateNode,q=d.alternate,d.memoizedState!==null?k._visibility&2?gl(u,d,g,_):Fg(u,d):k._visibility&2?gl(u,d,g,_):(k._visibility|=2,Sp(u,d,g,_,(d.subtreeFlags&10256)!==0)),I&2048&&BS(q,d);break;case 24:gl(u,d,g,_),I&2048&&zS(d.alternate,d);break;default:gl(u,d,g,_)}}function Sp(u,d,g,_,I){for(I=I&&(d.subtreeFlags&10256)!==0,d=d.child;d!==null;){var k=u,q=d,Y=g,ce=_,$e=q.flags;switch(q.tag){case 0:case 11:case 15:Sp(k,q,Y,ce,I),Pg(8,q);break;case 23:break;case 22:var Fe=q.stateNode;q.memoizedState!==null?Fe._visibility&2?Sp(k,q,Y,ce,I):Fg(k,q):(Fe._visibility|=2,Sp(k,q,Y,ce,I)),I&&$e&2048&&BS(q.alternate,q);break;case 24:Sp(k,q,Y,ce,I),I&&$e&2048&&zS(q.alternate,q);break;default:Sp(k,q,Y,ce,I)}d=d.sibling}}function Fg(u,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var g=u,_=d,I=_.flags;switch(_.tag){case 22:Fg(g,_),I&2048&&BS(_.alternate,_);break;case 24:Fg(g,_),I&2048&&zS(_.alternate,_);break;default:Fg(g,_)}d=d.sibling}}var jg=8192;function Ep(u){if(u.subtreeFlags&jg)for(u=u.child;u!==null;)JD(u),u=u.sibling}function JD(u){switch(u.tag){case 26:Ep(u),u.flags&jg&&u.memoizedState!==null&&IX(Ao,u.memoizedState,u.memoizedProps);break;case 5:Ep(u);break;case 3:case 4:var d=Ao;Ao=sx(u.stateNode.containerInfo),Ep(u),Ao=d;break;case 22:u.memoizedState===null&&(d=u.alternate,d!==null&&d.memoizedState!==null?(d=jg,jg=16777216,Ep(u),jg=d):Ep(u));break;default:Ep(u)}}function eL(u){var d=u.alternate;if(d!==null&&(u=d.child,u!==null)){d.child=null;do d=u.sibling,u.sibling=null,u=d;while(u!==null)}}function Bg(u){var d=u.deletions;if((u.flags&16)!==0){if(d!==null)for(var g=0;g<d.length;g++){var _=d[g];xr=_,nL(_,u)}eL(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)tL(u),u=u.sibling}function tL(u){switch(u.tag){case 0:case 11:case 15:Bg(u),u.flags&2048&&Bu(9,u,u.return);break;case 3:Bg(u);break;case 12:Bg(u);break;case 22:var d=u.stateNode;u.memoizedState!==null&&d._visibility&2&&(u.return===null||u.return.tag!==13)?(d._visibility&=-3,W_(u)):Bg(u);break;default:Bg(u)}}function W_(u){var d=u.deletions;if((u.flags&16)!==0){if(d!==null)for(var g=0;g<d.length;g++){var _=d[g];xr=_,nL(_,u)}eL(u)}for(u=u.child;u!==null;){switch(d=u,d.tag){case 0:case 11:case 15:Bu(8,d,d.return),W_(d);break;case 22:g=d.stateNode,g._visibility&2&&(g._visibility&=-3,W_(d));break;default:W_(d)}u=u.sibling}}function nL(u,d){for(;xr!==null;){var g=xr;switch(g.tag){case 0:case 11:case 15:Bu(8,g,d);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var _=g.memoizedState.cachePool.pool;_!=null&&_.refCount++}break;case 24:wg(g.memoizedState.cache)}if(_=g.child,_!==null)_.return=g,xr=_;else e:for(g=u;xr!==null;){_=xr;var I=_.sibling,k=_.return;if(qD(_),_===g){xr=null;break e}if(I!==null){I.return=k,xr=I;break e}xr=k}}}var U7={getCacheForType:function(u){var d=Qr(sr),g=d.data.get(u);return g===void 0&&(g=u(),d.data.set(u,g)),g}},G7=typeof WeakMap=="function"?WeakMap:Map,Cn=0,Hn=null,Yt=null,dn=0,kn=0,xa=null,Uu=!1,Np=!1,VS=!1,Rc=0,xs=0,Gu=0,Md=0,US=0,Xa=0,Ip=0,zg=null,Ki=null,GS=!1,WS=0,H_=1/0,q_=null,Wu=null,Ar=0,Hu=null,Cp=null,kp=0,HS=0,qS=null,sL=null,Vg=0,KS=null;function wa(){if((Cn&2)!==0&&dn!==0)return dn&-dn;if(Z.T!==null){var u=gp;return u!==0?u:tE()}return yo()}function rL(){Xa===0&&(Xa=(dn&536870912)===0||kt?ud():536870912);var u=Ka.current;return u!==null&&(u.flags|=32),Xa}function Ta(u,d,g){(u===Hn&&(kn===2||kn===9)||u.cancelPendingCommit!==null)&&($p(u,0),qu(u,dn,Xa,!1)),ss(u,g),((Cn&2)===0||u!==Hn)&&(u===Hn&&((Cn&2)===0&&(Md|=g),xs===4&&qu(u,dn,Xa,!1)),yl(u))}function iL(u,d,g){if((Cn&6)!==0)throw Error(s(327));var _=!g&&(d&124)===0&&(d&u.expiredLanes)===0||ji(u,d),I=_?q7(u,d):YS(u,d,!0),k=_;do{if(I===0){Np&&!_&&qu(u,d,0,!1);break}else{if(g=u.current.alternate,k&&!W7(g)){I=YS(u,d,!1),k=!1;continue}if(I===2){if(k=d,u.errorRecoveryDisabledLanes&k)var q=0;else q=u.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){d=q;e:{var Y=u;I=zg;var ce=Y.current.memoizedState.isDehydrated;if(ce&&($p(Y,q).flags|=256),q=YS(Y,q,!1),q!==2){if(VS&&!ce){Y.errorRecoveryDisabledLanes|=k,Md|=k,I=4;break e}k=Ki,Ki=I,k!==null&&(Ki===null?Ki=k:Ki.push.apply(Ki,k))}I=q}if(k=!1,I!==2)continue}}if(I===1){$p(u,0),qu(u,d,0,!0);break}e:{switch(_=u,k=I,k){case 0:case 1:throw Error(s(345));case 4:if((d&4194048)!==d)break;case 6:qu(_,d,Xa,!Uu);break e;case 2:Ki=null;break;case 3:case 5:break;default:throw Error(s(329))}if((d&62914560)===d&&(I=WS+300-Ot(),10<I)){if(qu(_,d,Xa,!Uu),Fi(_,0,!0)!==0)break e;_.timeoutHandle=LL(aL.bind(null,_,g,Ki,q_,GS,d,Xa,Md,Ip,Uu,k,2,-0,0),I);break e}aL(_,g,Ki,q_,GS,d,Xa,Md,Ip,Uu,k,0,-0,0)}}break}while(!0);yl(u)}function aL(u,d,g,_,I,k,q,Y,ce,$e,Fe,Ve,Ae,Le){if(u.timeoutHandle=-1,Ve=d.subtreeFlags,(Ve&8192||(Ve&16785408)===16785408)&&(Xg={stylesheets:null,count:0,unsuspend:NX},JD(d),Ve=CX(),Ve!==null)){u.cancelPendingCommit=Ve(fL.bind(null,u,d,k,g,_,I,q,Y,ce,Fe,1,Ae,Le)),qu(u,k,q,!$e);return}fL(u,d,k,g,_,I,q,Y,ce)}function W7(u){for(var d=u;;){var g=d.tag;if((g===0||g===11||g===15)&&d.flags&16384&&(g=d.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var _=0;_<g.length;_++){var I=g[_],k=I.getSnapshot;I=I.value;try{if(!Si(k(),I))return!1}catch{return!1}}if(g=d.child,d.subtreeFlags&16384&&g!==null)g.return=d,d=g;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function qu(u,d,g,_){d&=~US,d&=~Md,u.suspendedLanes|=d,u.pingedLanes&=~d,_&&(u.warmLanes|=d),_=u.expirationTimes;for(var I=d;0<I;){var k=31-hs(I),q=1<<k;_[k]=-1,I&=~q}g!==0&&tl(u,g,d)}function K_(){return(Cn&6)===0?(Ug(0),!1):!0}function XS(){if(Yt!==null){if(kn===0)var u=Yt.return;else u=Yt,ko=qa=null,dS(u),wp=null,Dg=0,u=Yt;for(;u!==null;)jD(u.alternate,u),u=u.return;Yt=null}}function $p(u,d){var g=u.timeoutHandle;g!==-1&&(u.timeoutHandle=-1,cX(g)),g=u.cancelPendingCommit,g!==null&&(u.cancelPendingCommit=null,g()),XS(),Hn=u,Yt=g=Ha(u.current,null),dn=d,kn=0,xa=null,Uu=!1,Np=ji(u,d),VS=!1,Ip=Xa=US=Md=Gu=xs=0,Ki=zg=null,GS=!1,(d&8)!==0&&(d|=d&32);var _=u.entangledLanes;if(_!==0)for(u=u.entanglements,_&=d;0<_;){var I=31-hs(_),k=1<<I;d|=u[I],_&=~k}return Rc=d,Ed(),g}function oL(u,d){Wt=null,Z.H=O_,d===Sg||d===E_?(d=SR(),kn=3):d===xR?(d=SR(),kn=4):kn=d===ED?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,xa=d,Yt===null&&(xs=1,B_(u,Ni(d,u.current)))}function lL(){var u=Z.H;return Z.H=O_,u===null?O_:u}function cL(){var u=Z.A;return Z.A=U7,u}function ZS(){xs=4,Uu||(dn&4194048)!==dn&&Ka.current!==null||(Np=!0),(Gu&134217727)===0&&(Md&134217727)===0||Hn===null||qu(Hn,dn,Xa,!1)}function YS(u,d,g){var _=Cn;Cn|=2;var I=lL(),k=cL();(Hn!==u||dn!==d)&&(q_=null,$p(u,d)),d=!1;var q=xs;e:do try{if(kn!==0&&Yt!==null){var Y=Yt,ce=xa;switch(kn){case 8:XS(),q=6;break e;case 3:case 2:case 9:case 6:Ka.current===null&&(d=!0);var $e=kn;if(kn=0,xa=null,Ap(u,Y,ce,$e),g&&Np){q=0;break e}break;default:$e=kn,kn=0,xa=null,Ap(u,Y,ce,$e)}}H7(),q=xs;break}catch(Fe){oL(u,Fe)}while(!0);return d&&u.shellSuspendCounter++,ko=qa=null,Cn=_,Z.H=I,Z.A=k,Yt===null&&(Hn=null,dn=0,Ed()),q}function H7(){for(;Yt!==null;)uL(Yt)}function q7(u,d){var g=Cn;Cn|=2;var _=lL(),I=cL();Hn!==u||dn!==d?(q_=null,H_=Ot()+500,$p(u,d)):Np=ji(u,d);e:do try{if(kn!==0&&Yt!==null){d=Yt;var k=xa;t:switch(kn){case 1:kn=0,xa=null,Ap(u,d,k,1);break;case 2:case 9:if(wR(k)){kn=0,xa=null,hL(d);break}d=function(){kn!==2&&kn!==9||Hn!==u||(kn=7),yl(u)},k.then(d,d);break e;case 3:kn=7;break e;case 4:kn=5;break e;case 7:wR(k)?(kn=0,xa=null,hL(d)):(kn=0,xa=null,Ap(u,d,k,7));break;case 5:var q=null;switch(Yt.tag){case 26:q=Yt.memoizedState;case 5:case 27:var Y=Yt;if(!q||HL(q)){kn=0,xa=null;var ce=Y.sibling;if(ce!==null)Yt=ce;else{var $e=Y.return;$e!==null?(Yt=$e,X_($e)):Yt=null}break t}}kn=0,xa=null,Ap(u,d,k,5);break;case 6:kn=0,xa=null,Ap(u,d,k,6);break;case 8:XS(),xs=6;break e;default:throw Error(s(462))}}K7();break}catch(Fe){oL(u,Fe)}while(!0);return ko=qa=null,Z.H=_,Z.A=I,Cn=g,Yt!==null?0:(Hn=null,dn=0,Ed(),xs)}function K7(){for(;Yt!==null&&!un();)uL(Yt)}function uL(u){var d=MD(u.alternate,u,Rc);u.memoizedProps=u.pendingProps,d===null?X_(u):Yt=d}function hL(u){var d=u,g=d.alternate;switch(d.tag){case 15:case 0:d=AD(g,d,d.pendingProps,d.type,void 0,dn);break;case 11:d=AD(g,d,d.pendingProps,d.type.render,d.ref,dn);break;case 5:dS(d);default:jD(g,d),d=Yt=_g(d,Rc),d=MD(g,d,Rc)}u.memoizedProps=u.pendingProps,d===null?X_(u):Yt=d}function Ap(u,d,g,_){ko=qa=null,dS(d),wp=null,Dg=0;var I=d.return;try{if(M7(u,I,d,g,dn)){xs=1,B_(u,Ni(g,u.current)),Yt=null;return}}catch(k){if(I!==null)throw Yt=I,k;xs=1,B_(u,Ni(g,u.current)),Yt=null;return}d.flags&32768?(kt||_===1?u=!0:Np||(dn&536870912)!==0?u=!1:(Uu=u=!0,(_===2||_===9||_===3||_===6)&&(_=Ka.current,_!==null&&_.tag===13&&(_.flags|=16384))),dL(d,u)):X_(d)}function X_(u){var d=u;do{if((d.flags&32768)!==0){dL(d,Uu);return}u=d.return;var g=j7(d.alternate,d,Rc);if(g!==null){Yt=g;return}if(d=d.sibling,d!==null){Yt=d;return}Yt=d=u}while(d!==null);xs===0&&(xs=5)}function dL(u,d){do{var g=B7(u.alternate,u);if(g!==null){g.flags&=32767,Yt=g;return}if(g=u.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!d&&(u=u.sibling,u!==null)){Yt=u;return}Yt=u=g}while(u!==null);xs=6,Yt=null}function fL(u,d,g,_,I,k,q,Y,ce){u.cancelPendingCommit=null;do Z_();while(Ar!==0);if((Cn&6)!==0)throw Error(s(327));if(d!==null){if(d===u.current)throw Error(s(177));if(k=d.lanes|d.childLanes,k|=va,Jf(u,g,k,q,Y,ce),u===Hn&&(Yt=Hn=null,dn=0),Cp=d,Hu=u,kp=g,HS=k,qS=I,sL=_,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,Q7(bs,function(){return vL(),null})):(u.callbackNode=null,u.callbackPriority=0),_=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||_){_=Z.T,Z.T=null,I=re.p,re.p=2,q=Cn,Cn|=4;try{z7(u,d,g)}finally{Cn=q,re.p=I,Z.T=_}}Ar=1,pL(),mL(),gL()}}function pL(){if(Ar===1){Ar=0;var u=Hu,d=Cp,g=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||g){g=Z.T,Z.T=null;var _=re.p;re.p=2;var I=Cn;Cn|=4;try{ZD(d,u);var k=cE,q=wd(u.containerInfo),Y=k.focusedElem,ce=k.selectionRange;if(q!==Y&&Y&&Y.ownerDocument&&lp(Y.ownerDocument.documentElement,Y)){if(ce!==null&&Td(Y)){var $e=ce.start,Fe=ce.end;if(Fe===void 0&&(Fe=$e),"selectionStart"in Y)Y.selectionStart=$e,Y.selectionEnd=Math.min(Fe,Y.value.length);else{var Ve=Y.ownerDocument||document,Ae=Ve&&Ve.defaultView||window;if(Ae.getSelection){var Le=Ae.getSelection(),Ct=Y.textContent.length,bt=Math.min(ce.start,Ct),On=ce.end===void 0?bt:Math.min(ce.end,Ct);!Le.extend&&bt>On&&(q=On,On=bt,bt=q);var we=vg(Y,bt),ge=vg(Y,On);if(we&&ge&&(Le.rangeCount!==1||Le.anchorNode!==we.node||Le.anchorOffset!==we.offset||Le.focusNode!==ge.node||Le.focusOffset!==ge.offset)){var Ce=Ve.createRange();Ce.setStart(we.node,we.offset),Le.removeAllRanges(),bt>On?(Le.addRange(Ce),Le.extend(ge.node,ge.offset)):(Ce.setEnd(ge.node,ge.offset),Le.addRange(Ce))}}}}for(Ve=[],Le=Y;Le=Le.parentNode;)Le.nodeType===1&&Ve.push({element:Le,left:Le.scrollLeft,top:Le.scrollTop});for(typeof Y.focus=="function"&&Y.focus(),Y=0;Y<Ve.length;Y++){var je=Ve[Y];je.element.scrollLeft=je.left,je.element.scrollTop=je.top}}lx=!!lE,cE=lE=null}finally{Cn=I,re.p=_,Z.T=g}}u.current=d,Ar=2}}function mL(){if(Ar===2){Ar=0;var u=Hu,d=Cp,g=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||g){g=Z.T,Z.T=null;var _=re.p;re.p=2;var I=Cn;Cn|=4;try{HD(u,d.alternate,d)}finally{Cn=I,re.p=_,Z.T=g}}Ar=3}}function gL(){if(Ar===4||Ar===3){Ar=0,qt();var u=Hu,d=Cp,g=kp,_=sL;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?Ar=5:(Ar=0,Cp=Hu=null,yL(u,u.pendingLanes));var I=u.pendingLanes;if(I===0&&(Wu=null),dd(g),d=d.stateNode,An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot($s,d,void 0,(d.current.flags&128)===128)}catch{}if(_!==null){d=Z.T,I=re.p,re.p=2,Z.T=null;try{for(var k=u.onRecoverableError,q=0;q<_.length;q++){var Y=_[q];k(Y.value,{componentStack:Y.stack})}}finally{Z.T=d,re.p=I}}(kp&3)!==0&&Z_(),yl(u),I=u.pendingLanes,(g&4194090)!==0&&(I&42)!==0?u===KS?Vg++:(Vg=0,KS=u):Vg=0,Ug(0)}}function yL(u,d){(u.pooledCacheLanes&=d)===0&&(d=u.pooledCache,d!=null&&(u.pooledCache=null,wg(d)))}function Z_(u){return pL(),mL(),gL(),vL()}function vL(){if(Ar!==5)return!1;var u=Hu,d=HS;HS=0;var g=dd(kp),_=Z.T,I=re.p;try{re.p=32>g?32:g,Z.T=null,g=qS,qS=null;var k=Hu,q=kp;if(Ar=0,Cp=Hu=null,kp=0,(Cn&6)!==0)throw Error(s(331));var Y=Cn;if(Cn|=4,tL(k.current),QD(k,k.current,q,g),Cn=Y,Ug(0,!1),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot($s,k)}catch{}return!0}finally{re.p=I,Z.T=_,yL(u,d)}}function bL(u,d,g){d=Ni(g,d),d=NS(u.stateNode,d,2),u=Pu(u,d,2),u!==null&&(ss(u,2),yl(u))}function Fn(u,d,g){if(u.tag===3)bL(u,u,g);else for(;d!==null;){if(d.tag===3){bL(d,u,g);break}else if(d.tag===1){var _=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Wu===null||!Wu.has(_))){u=Ni(g,u),g=TD(2),_=Pu(d,g,2),_!==null&&(SD(g,_,d,u),ss(_,2),yl(_));break}}d=d.return}}function QS(u,d,g){var _=u.pingCache;if(_===null){_=u.pingCache=new G7;var I=new Set;_.set(d,I)}else I=_.get(d),I===void 0&&(I=new Set,_.set(d,I));I.has(g)||(VS=!0,I.add(g),u=X7.bind(null,u,d,g),d.then(u,u))}function X7(u,d,g){var _=u.pingCache;_!==null&&_.delete(d),u.pingedLanes|=u.suspendedLanes&g,u.warmLanes&=~g,Hn===u&&(dn&g)===g&&(xs===4||xs===3&&(dn&62914560)===dn&&300>Ot()-WS?(Cn&2)===0&&$p(u,0):US|=g,Ip===dn&&(Ip=0)),yl(u)}function _L(u,d){d===0&&(d=go()),u=$u(u,d),u!==null&&(ss(u,d),yl(u))}function Z7(u){var d=u.memoizedState,g=0;d!==null&&(g=d.retryLane),_L(u,g)}function Y7(u,d){var g=0;switch(u.tag){case 13:var _=u.stateNode,I=u.memoizedState;I!==null&&(g=I.retryLane);break;case 19:_=u.stateNode;break;case 22:_=u.stateNode._retryCache;break;default:throw Error(s(314))}_!==null&&_.delete(d),_L(u,g)}function Q7(u,d){return Gt(u,d)}var Y_=null,Rp=null,JS=!1,Q_=!1,eE=!1,Fd=0;function yl(u){u!==Rp&&u.next===null&&(Rp===null?Y_=Rp=u:Rp=Rp.next=u),Q_=!0,JS||(JS=!0,eX())}function Ug(u,d){if(!eE&&Q_){eE=!0;do for(var g=!1,_=Y_;_!==null;){if(u!==0){var I=_.pendingLanes;if(I===0)var k=0;else{var q=_.suspendedLanes,Y=_.pingedLanes;k=(1<<31-hs(42|u)+1)-1,k&=I&~(q&~Y),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(g=!0,SL(_,k))}else k=dn,k=Fi(_,_===Hn?k:0,_.cancelPendingCommit!==null||_.timeoutHandle!==-1),(k&3)===0||ji(_,k)||(g=!0,SL(_,k));_=_.next}while(g);eE=!1}}function J7(){xL()}function xL(){Q_=JS=!1;var u=0;Fd!==0&&(lX()&&(u=Fd),Fd=0);for(var d=Ot(),g=null,_=Y_;_!==null;){var I=_.next,k=wL(_,d);k===0?(_.next=null,g===null?Y_=I:g.next=I,I===null&&(Rp=g)):(g=_,(u!==0||(k&3)!==0)&&(Q_=!0)),_=I}Ug(u)}function wL(u,d){for(var g=u.suspendedLanes,_=u.pingedLanes,I=u.expirationTimes,k=u.pendingLanes&-62914561;0<k;){var q=31-hs(k),Y=1<<q,ce=I[q];ce===-1?((Y&g)===0||(Y&_)!==0)&&(I[q]=du(Y,d)):ce<=d&&(u.expiredLanes|=Y),k&=~Y}if(d=Hn,g=dn,g=Fi(u,u===d?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),_=u.callbackNode,g===0||u===d&&(kn===2||kn===9)||u.cancelPendingCommit!==null)return _!==null&&_!==null&&gn(_),u.callbackNode=null,u.callbackPriority=0;if((g&3)===0||ji(u,g)){if(d=g&-g,d===u.callbackPriority)return d;switch(_!==null&&gn(_),dd(g)){case 2:case 8:g=jt;break;case 32:g=bs;break;case 268435456:g=qr;break;default:g=bs}return _=TL.bind(null,u),g=Gt(g,_),u.callbackPriority=d,u.callbackNode=g,d}return _!==null&&_!==null&&gn(_),u.callbackPriority=2,u.callbackNode=null,2}function TL(u,d){if(Ar!==0&&Ar!==5)return u.callbackNode=null,u.callbackPriority=0,null;var g=u.callbackNode;if(Z_()&&u.callbackNode!==g)return null;var _=dn;return _=Fi(u,u===Hn?_:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),_===0?null:(iL(u,_,d),wL(u,Ot()),u.callbackNode!=null&&u.callbackNode===g?TL.bind(null,u):null)}function SL(u,d){if(Z_())return null;iL(u,d,!0)}function eX(){uX(function(){(Cn&6)!==0?Gt(wn,J7):xL()})}function tE(){return Fd===0&&(Fd=ud()),Fd}function EL(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:bi(""+u)}function NL(u,d){var g=d.ownerDocument.createElement("input");return g.name=d.name,g.value=d.value,u.id&&g.setAttribute("form",u.id),d.parentNode.insertBefore(g,d),u=new FormData(u),g.parentNode.removeChild(g),u}function tX(u,d,g,_,I){if(d==="submit"&&g&&g.stateNode===I){var k=EL((I[er]||null).action),q=_.submitter;q&&(d=(d=q[er]||null)?EL(d.formAction):q.getAttribute("formAction"),d!==null&&(k=d,q=null));var Y=new ll("action","action",null,_,I);u.push({event:Y,listeners:[{instance:null,listener:function(){if(_.defaultPrevented){if(Fd!==0){var ce=q?NL(I,q):new FormData(I);xS(g,{pending:!0,data:ce,method:I.method,action:k},null,ce)}}else typeof k=="function"&&(Y.preventDefault(),ce=q?NL(I,q):new FormData(I),xS(g,{pending:!0,data:ce,method:I.method,action:k},k,ce))},currentTarget:I}]})}}for(var nE=0;nE<xc.length;nE++){var sE=xc[nE],nX=sE.toLowerCase(),sX=sE[0].toUpperCase()+sE.slice(1);ya(nX,"on"+sX)}ya(g_,"onAnimationEnd"),ya(ga,"onAnimationIteration"),ya(Sd,"onAnimationStart"),ya("dblclick","onDoubleClick"),ya("focusin","onFocus"),ya("focusout","onBlur"),ya(ZT,"onTransitionRun"),ya(dp,"onTransitionStart"),ya(YT,"onTransitionCancel"),ya(bg,"onTransitionEnd"),la("onMouseEnter",["mouseout","mouseover"]),la("onMouseLeave",["mouseout","mouseover"]),la("onPointerEnter",["pointerout","pointerover"]),la("onPointerLeave",["pointerout","pointerover"]),Pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rX=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gg));function IL(u,d){d=(d&4)!==0;for(var g=0;g<u.length;g++){var _=u[g],I=_.event;_=_.listeners;e:{var k=void 0;if(d)for(var q=_.length-1;0<=q;q--){var Y=_[q],ce=Y.instance,$e=Y.currentTarget;if(Y=Y.listener,ce!==k&&I.isPropagationStopped())break e;k=Y,I.currentTarget=$e;try{k(I)}catch(Fe){j_(Fe)}I.currentTarget=null,k=ce}else for(q=0;q<_.length;q++){if(Y=_[q],ce=Y.instance,$e=Y.currentTarget,Y=Y.listener,ce!==k&&I.isPropagationStopped())break e;k=Y,I.currentTarget=$e;try{k(I)}catch(Fe){j_(Fe)}I.currentTarget=null,k=ce}}}}function Qt(u,d){var g=d[dr];g===void 0&&(g=d[dr]=new Set);var _=u+"__bubble";g.has(_)||(CL(d,u,2,!1),g.add(_))}function rE(u,d,g){var _=0;d&&(_|=4),CL(g,u,_,d)}var J_="_reactListening"+Math.random().toString(36).slice(2);function iE(u){if(!u[J_]){u[J_]=!0,tp.forEach(function(g){g!=="selectionchange"&&(rX.has(g)||rE(g,!1,u),rE(g,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[J_]||(d[J_]=!0,rE("selectionchange",!1,d))}}function CL(u,d,g,_){switch(QL(d)){case 2:var I=AX;break;case 8:I=RX;break;default:I=bE}g=I.bind(null,d,g,u),I=void 0,!ca||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(I=!0),_?I!==void 0?u.addEventListener(d,g,{capture:!0,passive:I}):u.addEventListener(d,g,!0):I!==void 0?u.addEventListener(d,g,{passive:I}):u.addEventListener(d,g,!1)}function aE(u,d,g,_,I){var k=_;if((d&1)===0&&(d&2)===0&&_!==null)e:for(;;){if(_===null)return;var q=_.tag;if(q===3||q===4){var Y=_.stateNode.containerInfo;if(Y===I)break;if(q===4)for(q=_.return;q!==null;){var ce=q.tag;if((ce===3||ce===4)&&q.stateNode.containerInfo===I)return;q=q.return}for(;Y!==null;){if(q=zi(Y),q===null)return;if(ce=q.tag,ce===5||ce===6||ce===26||ce===27){_=k=q;continue e}Y=Y.parentNode}}_=_.return}mr(function(){var $e=k,Fe=il(g),Ve=[];e:{var Ae=y_.get(u);if(Ae!==void 0){var Le=ll,Ct=u;switch(u){case"keypress":if(Yn(g)===0)break e;case"keydown":case"keyup":Le=_u;break;case"focusin":Ct="focus",Le=gu;break;case"focusout":Ct="blur",Le=gu;break;case"beforeblur":case"afterblur":Le=gu;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=ua;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=rp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=cl;break;case g_:case ga:case Sd:Le=gd;break;case bg:Le=F;break;case"scroll":case"scrollend":Le=gc;break;case"wheel":Le=ee;break;case"copy":case"cut":case"paste":Le=yu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=xu;break;case"toggle":case"beforetoggle":Le=Re}var bt=(d&4)!==0,On=!bt&&(u==="scroll"||u==="scrollend"),we=bt?Ae!==null?Ae+"Capture":null:Ae;bt=[];for(var ge=$e,Ce;ge!==null;){var je=ge;if(Ce=je.stateNode,je=je.tag,je!==5&&je!==26&&je!==27||Ce===null||we===null||(je=an(ge,we),je!=null&&bt.push(Wg(ge,je,Ce))),On)break;ge=ge.return}0<bt.length&&(Ae=new Le(Ae,Ct,null,g,Fe),Ve.push({event:Ae,listeners:bt}))}}if((d&7)===0){e:{if(Ae=u==="mouseover"||u==="pointerover",Le=u==="mouseout"||u==="pointerout",Ae&&g!==mc&&(Ct=g.relatedTarget||g.fromElement)&&(zi(Ct)||Ct[vo]))break e;if((Le||Ae)&&(Ae=Fe.window===Fe?Fe:(Ae=Fe.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,Le?(Ct=g.relatedTarget||g.toElement,Le=$e,Ct=Ct?zi(Ct):null,Ct!==null&&(On=i(Ct),bt=Ct.tag,Ct!==On||bt!==5&&bt!==27&&bt!==6)&&(Ct=null)):(Le=null,Ct=$e),Le!==Ct)){if(bt=ua,je="onMouseLeave",we="onMouseEnter",ge="mouse",(u==="pointerout"||u==="pointerover")&&(bt=xu,je="onPointerLeave",we="onPointerEnter",ge="pointer"),On=Le==null?Ae:mi(Le),Ce=Ct==null?Ae:mi(Ct),Ae=new bt(je,ge+"leave",Le,g,Fe),Ae.target=On,Ae.relatedTarget=Ce,je=null,zi(Fe)===$e&&(bt=new bt(we,ge+"enter",Ct,g,Fe),bt.target=Ce,bt.relatedTarget=On,je=bt),On=je,Le&&Ct)t:{for(bt=Le,we=Ct,ge=0,Ce=bt;Ce;Ce=Dp(Ce))ge++;for(Ce=0,je=we;je;je=Dp(je))Ce++;for(;0<ge-Ce;)bt=Dp(bt),ge--;for(;0<Ce-ge;)we=Dp(we),Ce--;for(;ge--;){if(bt===we||we!==null&&bt===we.alternate)break t;bt=Dp(bt),we=Dp(we)}bt=null}else bt=null;Le!==null&&kL(Ve,Ae,Le,bt,!1),Ct!==null&&On!==null&&kL(Ve,On,Ct,bt,!0)}}e:{if(Ae=$e?mi($e):window,Le=Ae.nodeName&&Ae.nodeName.toLowerCase(),Le==="select"||Le==="input"&&Ae.type==="file")var lt=Su;else if(bc(Ae))if(mg)lt=XT;else{lt=KT;var Xt=yg}else Le=Ae.nodeName,!Le||Le.toLowerCase()!=="input"||Ae.type!=="checkbox"&&Ae.type!=="radio"?$e&&rl($e.elementType)&&(lt=Su):lt=Co;if(lt&&(lt=lt(u,$e))){d_(Ve,lt,g,Fe);break e}Xt&&Xt(u,Ae,$e),u==="focusout"&&$e&&Ae.type==="number"&&$e.memoizedProps.value!=null&&sl(Ae,"number",Ae.value)}switch(Xt=$e?mi($e):window,u){case"focusin":(bc(Xt)||Xt.contentEditable==="true")&&(ma=Xt,Iu=$e,_c=null);break;case"focusout":_c=Iu=ma=null;break;case"mousedown":up=!0;break;case"contextmenu":case"mouseup":case"dragend":up=!1,p_(Ve,g,Fe);break;case"selectionchange":if(cp)break;case"keydown":case"keyup":p_(Ve,g,Fe)}var dt;if(wt)e:{switch(u){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else fa?wi(u,g)&&(Tt="onCompositionEnd"):u==="keydown"&&g.keyCode===229&&(Tt="onCompositionStart");Tt&&(rs&&g.locale!=="ko"&&(fa||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&fa&&(dt=ol()):(Zr=Fe,hn="value"in Zr?Zr.value:Zr.textContent,fa=!0)),Xt=ex($e,Tt),0<Xt.length&&(Tt=new Yr(Tt,u,null,g,Fe),Ve.push({event:Tt,listeners:Xt}),dt?Tt.data=dt:(dt=da(g),dt!==null&&(Tt.data=dt)))),(dt=yn?wu(u,g):qT(u,g))&&(Tt=ex($e,"onBeforeInput"),0<Tt.length&&(Xt=new Yr("onBeforeInput","beforeinput",null,g,Fe),Ve.push({event:Xt,listeners:Tt}),Xt.data=dt)),tX(Ve,u,$e,g,Fe)}IL(Ve,d)})}function Wg(u,d,g){return{instance:u,listener:d,currentTarget:g}}function ex(u,d){for(var g=d+"Capture",_=[];u!==null;){var I=u,k=I.stateNode;if(I=I.tag,I!==5&&I!==26&&I!==27||k===null||(I=an(u,g),I!=null&&_.unshift(Wg(u,I,k)),I=an(u,d),I!=null&&_.push(Wg(u,I,k))),u.tag===3)return _;u=u.return}return[]}function Dp(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function kL(u,d,g,_,I){for(var k=d._reactName,q=[];g!==null&&g!==_;){var Y=g,ce=Y.alternate,$e=Y.stateNode;if(Y=Y.tag,ce!==null&&ce===_)break;Y!==5&&Y!==26&&Y!==27||$e===null||(ce=$e,I?($e=an(g,k),$e!=null&&q.unshift(Wg(g,$e,ce))):I||($e=an(g,k),$e!=null&&q.push(Wg(g,$e,ce)))),g=g.return}q.length!==0&&u.push({event:d,listeners:q})}var iX=/\r\n?/g,aX=/\u0000|\uFFFD/g;function $L(u){return(typeof u=="string"?u:""+u).replace(iX,`
`).replace(aX,"")}function AL(u,d){return d=$L(d),$L(u)===d}function tx(){}function Ln(u,d,g,_,I,k){switch(g){case"children":typeof _=="string"?d==="body"||d==="textarea"&&_===""||pr(u,_):(typeof _=="number"||typeof _=="bigint")&&d!=="body"&&pr(u,""+_);break;case"className":hc(u,"class",_);break;case"tabIndex":hc(u,"tabindex",_);break;case"dir":case"role":case"viewBox":case"width":case"height":hc(u,g,_);break;case"style":To(u,_,k);break;case"data":if(d!=="object"){hc(u,"data",_);break}case"src":case"href":if(_===""&&(d!=="a"||g!=="href")){u.removeAttribute(g);break}if(_==null||typeof _=="function"||typeof _=="symbol"||typeof _=="boolean"){u.removeAttribute(g);break}_=bi(""+_),u.setAttribute(g,_);break;case"action":case"formAction":if(typeof _=="function"){u.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(g==="formAction"?(d!=="input"&&Ln(u,d,"name",I.name,I,null),Ln(u,d,"formEncType",I.formEncType,I,null),Ln(u,d,"formMethod",I.formMethod,I,null),Ln(u,d,"formTarget",I.formTarget,I,null)):(Ln(u,d,"encType",I.encType,I,null),Ln(u,d,"method",I.method,I,null),Ln(u,d,"target",I.target,I,null)));if(_==null||typeof _=="symbol"||typeof _=="boolean"){u.removeAttribute(g);break}_=bi(""+_),u.setAttribute(g,_);break;case"onClick":_!=null&&(u.onclick=tx);break;case"onScroll":_!=null&&Qt("scroll",u);break;case"onScrollEnd":_!=null&&Qt("scrollend",u);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(s(61));if(g=_.__html,g!=null){if(I.children!=null)throw Error(s(60));u.innerHTML=g}}break;case"multiple":u.multiple=_&&typeof _!="function"&&typeof _!="symbol";break;case"muted":u.muted=_&&typeof _!="function"&&typeof _!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(_==null||typeof _=="function"||typeof _=="boolean"||typeof _=="symbol"){u.removeAttribute("xlink:href");break}g=bi(""+_),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":_!=null&&typeof _!="function"&&typeof _!="symbol"?u.setAttribute(g,""+_):u.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":_&&typeof _!="function"&&typeof _!="symbol"?u.setAttribute(g,""):u.removeAttribute(g);break;case"capture":case"download":_===!0?u.setAttribute(g,""):_!==!1&&_!=null&&typeof _!="function"&&typeof _!="symbol"?u.setAttribute(g,_):u.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":_!=null&&typeof _!="function"&&typeof _!="symbol"&&!isNaN(_)&&1<=_?u.setAttribute(g,_):u.removeAttribute(g);break;case"rowSpan":case"start":_==null||typeof _=="function"||typeof _=="symbol"||isNaN(_)?u.removeAttribute(g):u.setAttribute(g,_);break;case"popover":Qt("beforetoggle",u),Qt("toggle",u),uc(u,"popover",_);break;case"xlinkActuate":Vi(u,"http://www.w3.org/1999/xlink","xlink:actuate",_);break;case"xlinkArcrole":Vi(u,"http://www.w3.org/1999/xlink","xlink:arcrole",_);break;case"xlinkRole":Vi(u,"http://www.w3.org/1999/xlink","xlink:role",_);break;case"xlinkShow":Vi(u,"http://www.w3.org/1999/xlink","xlink:show",_);break;case"xlinkTitle":Vi(u,"http://www.w3.org/1999/xlink","xlink:title",_);break;case"xlinkType":Vi(u,"http://www.w3.org/1999/xlink","xlink:type",_);break;case"xmlBase":Vi(u,"http://www.w3.org/XML/1998/namespace","xml:base",_);break;case"xmlLang":Vi(u,"http://www.w3.org/XML/1998/namespace","xml:lang",_);break;case"xmlSpace":Vi(u,"http://www.w3.org/XML/1998/namespace","xml:space",_);break;case"is":uc(u,"is",_);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=pu.get(g)||g,uc(u,g,_))}}function oE(u,d,g,_,I,k){switch(g){case"style":To(u,_,k);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(s(61));if(g=_.__html,g!=null){if(I.children!=null)throw Error(s(60));u.innerHTML=g}}break;case"children":typeof _=="string"?pr(u,_):(typeof _=="number"||typeof _=="bigint")&&pr(u,""+_);break;case"onScroll":_!=null&&Qt("scroll",u);break;case"onScrollEnd":_!=null&&Qt("scrollend",u);break;case"onClick":_!=null&&(u.onclick=tx);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!lc.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(I=g.endsWith("Capture"),d=g.slice(2,I?g.length-7:void 0),k=u[er]||null,k=k!=null?k[g]:null,typeof k=="function"&&u.removeEventListener(d,k,I),typeof _=="function")){typeof k!="function"&&k!==null&&(g in u?u[g]=null:u.hasAttribute(g)&&u.removeAttribute(g)),u.addEventListener(d,_,I);break e}g in u?u[g]=_:_===!0?u.setAttribute(g,""):uc(u,g,_)}}}function Rr(u,d,g){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qt("error",u),Qt("load",u);var _=!1,I=!1,k;for(k in g)if(g.hasOwnProperty(k)){var q=g[k];if(q!=null)switch(k){case"src":_=!0;break;case"srcSet":I=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,d));default:Ln(u,d,k,q,g,null)}}I&&Ln(u,d,"srcSet",g.srcSet,g,null),_&&Ln(u,d,"src",g.src,g,null);return;case"input":Qt("invalid",u);var Y=k=q=I=null,ce=null,$e=null;for(_ in g)if(g.hasOwnProperty(_)){var Fe=g[_];if(Fe!=null)switch(_){case"name":I=Fe;break;case"type":q=Fe;break;case"checked":ce=Fe;break;case"defaultChecked":$e=Fe;break;case"value":k=Fe;break;case"defaultValue":Y=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(s(137,d));break;default:Ln(u,d,_,Fe,g,null)}}pd(u,k,Y,ce,$e,q,I,!1),Ba(u);return;case"select":Qt("invalid",u),_=q=k=null;for(I in g)if(g.hasOwnProperty(I)&&(Y=g[I],Y!=null))switch(I){case"value":k=Y;break;case"defaultValue":q=Y;break;case"multiple":_=Y;default:Ln(u,d,I,Y,g,null)}d=k,g=q,u.multiple=!!_,d!=null?Xr(u,!!_,d,!1):g!=null&&Xr(u,!!_,g,!0);return;case"textarea":Qt("invalid",u),k=I=_=null;for(q in g)if(g.hasOwnProperty(q)&&(Y=g[q],Y!=null))switch(q){case"value":_=Y;break;case"defaultValue":I=Y;break;case"children":k=Y;break;case"dangerouslySetInnerHTML":if(Y!=null)throw Error(s(91));break;default:Ln(u,d,q,Y,g,null)}za(u,_,I,k),Ba(u);return;case"option":for(ce in g)if(g.hasOwnProperty(ce)&&(_=g[ce],_!=null))switch(ce){case"selected":u.selected=_&&typeof _!="function"&&typeof _!="symbol";break;default:Ln(u,d,ce,_,g,null)}return;case"dialog":Qt("beforetoggle",u),Qt("toggle",u),Qt("cancel",u),Qt("close",u);break;case"iframe":case"object":Qt("load",u);break;case"video":case"audio":for(_=0;_<Gg.length;_++)Qt(Gg[_],u);break;case"image":Qt("error",u),Qt("load",u);break;case"details":Qt("toggle",u);break;case"embed":case"source":case"link":Qt("error",u),Qt("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($e in g)if(g.hasOwnProperty($e)&&(_=g[$e],_!=null))switch($e){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,d));default:Ln(u,d,$e,_,g,null)}return;default:if(rl(d)){for(Fe in g)g.hasOwnProperty(Fe)&&(_=g[Fe],_!==void 0&&oE(u,d,Fe,_,g,void 0));return}}for(Y in g)g.hasOwnProperty(Y)&&(_=g[Y],_!=null&&Ln(u,d,Y,_,g,null))}function oX(u,d,g,_){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var I=null,k=null,q=null,Y=null,ce=null,$e=null,Fe=null;for(Le in g){var Ve=g[Le];if(g.hasOwnProperty(Le)&&Ve!=null)switch(Le){case"checked":break;case"value":break;case"defaultValue":ce=Ve;default:_.hasOwnProperty(Le)||Ln(u,d,Le,null,_,Ve)}}for(var Ae in _){var Le=_[Ae];if(Ve=g[Ae],_.hasOwnProperty(Ae)&&(Le!=null||Ve!=null))switch(Ae){case"type":k=Le;break;case"name":I=Le;break;case"checked":$e=Le;break;case"defaultChecked":Fe=Le;break;case"value":q=Le;break;case"defaultValue":Y=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(s(137,d));break;default:Le!==Ve&&Ln(u,d,Ae,Le,_,Ve)}}fr(u,q,Y,ce,$e,Fe,k,I);return;case"select":Le=q=Y=Ae=null;for(k in g)if(ce=g[k],g.hasOwnProperty(k)&&ce!=null)switch(k){case"value":break;case"multiple":Le=ce;default:_.hasOwnProperty(k)||Ln(u,d,k,null,_,ce)}for(I in _)if(k=_[I],ce=g[I],_.hasOwnProperty(I)&&(k!=null||ce!=null))switch(I){case"value":Ae=k;break;case"defaultValue":Y=k;break;case"multiple":q=k;default:k!==ce&&Ln(u,d,I,k,_,ce)}d=Y,g=q,_=Le,Ae!=null?Xr(u,!!g,Ae,!1):!!_!=!!g&&(d!=null?Xr(u,!!g,d,!0):Xr(u,!!g,g?[]:"",!1));return;case"textarea":Le=Ae=null;for(Y in g)if(I=g[Y],g.hasOwnProperty(Y)&&I!=null&&!_.hasOwnProperty(Y))switch(Y){case"value":break;case"children":break;default:Ln(u,d,Y,null,_,I)}for(q in _)if(I=_[q],k=g[q],_.hasOwnProperty(q)&&(I!=null||k!=null))switch(q){case"value":Ae=I;break;case"defaultValue":Le=I;break;case"children":break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(s(91));break;default:I!==k&&Ln(u,d,q,I,_,k)}Zn(u,Ae,Le);return;case"option":for(var Ct in g)if(Ae=g[Ct],g.hasOwnProperty(Ct)&&Ae!=null&&!_.hasOwnProperty(Ct))switch(Ct){case"selected":u.selected=!1;break;default:Ln(u,d,Ct,null,_,Ae)}for(ce in _)if(Ae=_[ce],Le=g[ce],_.hasOwnProperty(ce)&&Ae!==Le&&(Ae!=null||Le!=null))switch(ce){case"selected":u.selected=Ae&&typeof Ae!="function"&&typeof Ae!="symbol";break;default:Ln(u,d,ce,Ae,_,Le)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bt in g)Ae=g[bt],g.hasOwnProperty(bt)&&Ae!=null&&!_.hasOwnProperty(bt)&&Ln(u,d,bt,null,_,Ae);for($e in _)if(Ae=_[$e],Le=g[$e],_.hasOwnProperty($e)&&Ae!==Le&&(Ae!=null||Le!=null))switch($e){case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(s(137,d));break;default:Ln(u,d,$e,Ae,_,Le)}return;default:if(rl(d)){for(var On in g)Ae=g[On],g.hasOwnProperty(On)&&Ae!==void 0&&!_.hasOwnProperty(On)&&oE(u,d,On,void 0,_,Ae);for(Fe in _)Ae=_[Fe],Le=g[Fe],!_.hasOwnProperty(Fe)||Ae===Le||Ae===void 0&&Le===void 0||oE(u,d,Fe,Ae,_,Le);return}}for(var we in g)Ae=g[we],g.hasOwnProperty(we)&&Ae!=null&&!_.hasOwnProperty(we)&&Ln(u,d,we,null,_,Ae);for(Ve in _)Ae=_[Ve],Le=g[Ve],!_.hasOwnProperty(Ve)||Ae===Le||Ae==null&&Le==null||Ln(u,d,Ve,Ae,_,Le)}var lE=null,cE=null;function nx(u){return u.nodeType===9?u:u.ownerDocument}function RL(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function DL(u,d){if(u===0)switch(d){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&d==="foreignObject"?0:u}function uE(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.children=="bigint"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var hE=null;function lX(){var u=window.event;return u&&u.type==="popstate"?u===hE?!1:(hE=u,!0):(hE=null,!1)}var LL=typeof setTimeout=="function"?setTimeout:void 0,cX=typeof clearTimeout=="function"?clearTimeout:void 0,OL=typeof Promise=="function"?Promise:void 0,uX=typeof queueMicrotask=="function"?queueMicrotask:typeof OL<"u"?function(u){return OL.resolve(null).then(u).catch(hX)}:LL;function hX(u){setTimeout(function(){throw u})}function Ku(u){return u==="head"}function PL(u,d){var g=d,_=0,I=0;do{var k=g.nextSibling;if(u.removeChild(g),k&&k.nodeType===8)if(g=k.data,g==="/$"){if(0<_&&8>_){g=_;var q=u.ownerDocument;if(g&1&&Hg(q.documentElement),g&2&&Hg(q.body),g&4)for(g=q.head,Hg(g),q=g.firstChild;q;){var Y=q.nextSibling,ce=q.nodeName;q[bo]||ce==="SCRIPT"||ce==="STYLE"||ce==="LINK"&&q.rel.toLowerCase()==="stylesheet"||g.removeChild(q),q=Y}}if(I===0){u.removeChild(k),ey(d);return}I--}else g==="$"||g==="$?"||g==="$!"?I++:_=g.charCodeAt(0)-48;else _=0;g=k}while(g);ey(d)}function dE(u){var d=u.firstChild;for(d&&d.nodeType===10&&(d=d.nextSibling);d;){var g=d;switch(d=d.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":dE(g),oc(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}u.removeChild(g)}}function dX(u,d,g,_){for(;u.nodeType===1;){var I=g;if(u.nodeName.toLowerCase()!==d.toLowerCase()){if(!_&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(_){if(!u[bo])switch(d){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(k=u.getAttribute("rel"),k==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(k!==I.rel||u.getAttribute("href")!==(I.href==null||I.href===""?null:I.href)||u.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin)||u.getAttribute("title")!==(I.title==null?null:I.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(k=u.getAttribute("src"),(k!==(I.src==null?null:I.src)||u.getAttribute("type")!==(I.type==null?null:I.type)||u.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin))&&k&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(d==="input"&&u.type==="hidden"){var k=I.name==null?null:""+I.name;if(I.type==="hidden"&&u.getAttribute("name")===k)return u}else return u;if(u=Ro(u.nextSibling),u===null)break}return null}function fX(u,d,g){if(d==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!g||(u=Ro(u.nextSibling),u===null))return null;return u}function fE(u){return u.data==="$!"||u.data==="$?"&&u.ownerDocument.readyState==="complete"}function pX(u,d){var g=u.ownerDocument;if(u.data!=="$?"||g.readyState==="complete")d();else{var _=function(){d(),g.removeEventListener("DOMContentLoaded",_)};g.addEventListener("DOMContentLoaded",_),u._reactRetry=_}}function Ro(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?"||d==="F!"||d==="F")break;if(d==="/$")return null}}return u}var pE=null;function ML(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var g=u.data;if(g==="$"||g==="$!"||g==="$?"){if(d===0)return u;d--}else g==="/$"&&d++}u=u.previousSibling}return null}function FL(u,d,g){switch(d=nx(g),u){case"html":if(u=d.documentElement,!u)throw Error(s(452));return u;case"head":if(u=d.head,!u)throw Error(s(453));return u;case"body":if(u=d.body,!u)throw Error(s(454));return u;default:throw Error(s(451))}}function Hg(u){for(var d=u.attributes;d.length;)u.removeAttributeNode(d[0]);oc(u)}var Za=new Map,jL=new Set;function sx(u){return typeof u.getRootNode=="function"?u.getRootNode():u.nodeType===9?u:u.ownerDocument}var Dc=re.d;re.d={f:mX,r:gX,D:yX,C:vX,L:bX,m:_X,X:wX,S:xX,M:TX};function mX(){var u=Dc.f(),d=K_();return u||d}function gX(u){var d=oa(u);d!==null&&d.tag===5&&d.type==="form"?iD(d):Dc.r(u)}var Lp=typeof document>"u"?null:document;function BL(u,d,g){var _=Lp;if(_&&typeof d=="string"&&d){var I=ps(d);I='link[rel="'+u+'"][href="'+I+'"]',typeof g=="string"&&(I+='[crossorigin="'+g+'"]'),jL.has(I)||(jL.add(I),u={rel:u,crossOrigin:g,href:d},_.querySelector(I)===null&&(d=_.createElement("link"),Rr(d,"link",u),fs(d),_.head.appendChild(d)))}}function yX(u){Dc.D(u),BL("dns-prefetch",u,null)}function vX(u,d){Dc.C(u,d),BL("preconnect",u,d)}function bX(u,d,g){Dc.L(u,d,g);var _=Lp;if(_&&u&&d){var I='link[rel="preload"][as="'+ps(d)+'"]';d==="image"&&g&&g.imageSrcSet?(I+='[imagesrcset="'+ps(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(I+='[imagesizes="'+ps(g.imageSizes)+'"]')):I+='[href="'+ps(u)+'"]';var k=I;switch(d){case"style":k=Op(u);break;case"script":k=Pp(u)}Za.has(k)||(u=h({rel:"preload",href:d==="image"&&g&&g.imageSrcSet?void 0:u,as:d},g),Za.set(k,u),_.querySelector(I)!==null||d==="style"&&_.querySelector(qg(k))||d==="script"&&_.querySelector(Kg(k))||(d=_.createElement("link"),Rr(d,"link",u),fs(d),_.head.appendChild(d)))}}function _X(u,d){Dc.m(u,d);var g=Lp;if(g&&u){var _=d&&typeof d.as=="string"?d.as:"script",I='link[rel="modulepreload"][as="'+ps(_)+'"][href="'+ps(u)+'"]',k=I;switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=Pp(u)}if(!Za.has(k)&&(u=h({rel:"modulepreload",href:u},d),Za.set(k,u),g.querySelector(I)===null)){switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Kg(k)))return}_=g.createElement("link"),Rr(_,"link",u),fs(_),g.head.appendChild(_)}}}function xX(u,d,g){Dc.S(u,d,g);var _=Lp;if(_&&u){var I=_o(_).hoistableStyles,k=Op(u);d=d||"default";var q=I.get(k);if(!q){var Y={loading:0,preload:null};if(q=_.querySelector(qg(k)))Y.loading=5;else{u=h({rel:"stylesheet",href:u,"data-precedence":d},g),(g=Za.get(k))&&mE(u,g);var ce=q=_.createElement("link");fs(ce),Rr(ce,"link",u),ce._p=new Promise(function($e,Fe){ce.onload=$e,ce.onerror=Fe}),ce.addEventListener("load",function(){Y.loading|=1}),ce.addEventListener("error",function(){Y.loading|=2}),Y.loading|=4,rx(q,d,_)}q={type:"stylesheet",instance:q,count:1,state:Y},I.set(k,q)}}}function wX(u,d){Dc.X(u,d);var g=Lp;if(g&&u){var _=_o(g).hoistableScripts,I=Pp(u),k=_.get(I);k||(k=g.querySelector(Kg(I)),k||(u=h({src:u,async:!0},d),(d=Za.get(I))&&gE(u,d),k=g.createElement("script"),fs(k),Rr(k,"link",u),g.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},_.set(I,k))}}function TX(u,d){Dc.M(u,d);var g=Lp;if(g&&u){var _=_o(g).hoistableScripts,I=Pp(u),k=_.get(I);k||(k=g.querySelector(Kg(I)),k||(u=h({src:u,async:!0,type:"module"},d),(d=Za.get(I))&&gE(u,d),k=g.createElement("script"),fs(k),Rr(k,"link",u),g.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},_.set(I,k))}}function zL(u,d,g,_){var I=(I=Se.current)?sx(I):null;if(!I)throw Error(s(446));switch(u){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(d=Op(g.href),g=_o(I).hoistableStyles,_=g.get(d),_||(_={type:"style",instance:null,count:0,state:null},g.set(d,_)),_):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){u=Op(g.href);var k=_o(I).hoistableStyles,q=k.get(u);if(q||(I=I.ownerDocument||I,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(u,q),(k=I.querySelector(qg(u)))&&!k._p&&(q.instance=k,q.state.loading=5),Za.has(u)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Za.set(u,g),k||SX(I,u,g,q.state))),d&&_===null)throw Error(s(528,""));return q}if(d&&_!==null)throw Error(s(529,""));return null;case"script":return d=g.async,g=g.src,typeof g=="string"&&d&&typeof d!="function"&&typeof d!="symbol"?(d=Pp(g),g=_o(I).hoistableScripts,_=g.get(d),_||(_={type:"script",instance:null,count:0,state:null},g.set(d,_)),_):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,u))}}function Op(u){return'href="'+ps(u)+'"'}function qg(u){return'link[rel="stylesheet"]['+u+"]"}function VL(u){return h({},u,{"data-precedence":u.precedence,precedence:null})}function SX(u,d,g,_){u.querySelector('link[rel="preload"][as="style"]['+d+"]")?_.loading=1:(d=u.createElement("link"),_.preload=d,d.addEventListener("load",function(){return _.loading|=1}),d.addEventListener("error",function(){return _.loading|=2}),Rr(d,"link",g),fs(d),u.head.appendChild(d))}function Pp(u){return'[src="'+ps(u)+'"]'}function Kg(u){return"script[async]"+u}function UL(u,d,g){if(d.count++,d.instance===null)switch(d.type){case"style":var _=u.querySelector('style[data-href~="'+ps(g.href)+'"]');if(_)return d.instance=_,fs(_),_;var I=h({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return _=(u.ownerDocument||u).createElement("style"),fs(_),Rr(_,"style",I),rx(_,g.precedence,u),d.instance=_;case"stylesheet":I=Op(g.href);var k=u.querySelector(qg(I));if(k)return d.state.loading|=4,d.instance=k,fs(k),k;_=VL(g),(I=Za.get(I))&&mE(_,I),k=(u.ownerDocument||u).createElement("link"),fs(k);var q=k;return q._p=new Promise(function(Y,ce){q.onload=Y,q.onerror=ce}),Rr(k,"link",_),d.state.loading|=4,rx(k,g.precedence,u),d.instance=k;case"script":return k=Pp(g.src),(I=u.querySelector(Kg(k)))?(d.instance=I,fs(I),I):(_=g,(I=Za.get(k))&&(_=h({},g),gE(_,I)),u=u.ownerDocument||u,I=u.createElement("script"),fs(I),Rr(I,"link",_),u.head.appendChild(I),d.instance=I);case"void":return null;default:throw Error(s(443,d.type))}else d.type==="stylesheet"&&(d.state.loading&4)===0&&(_=d.instance,d.state.loading|=4,rx(_,g.precedence,u));return d.instance}function rx(u,d,g){for(var _=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),I=_.length?_[_.length-1]:null,k=I,q=0;q<_.length;q++){var Y=_[q];if(Y.dataset.precedence===d)k=Y;else if(k!==I)break}k?k.parentNode.insertBefore(u,k.nextSibling):(d=g.nodeType===9?g.head:g,d.insertBefore(u,d.firstChild))}function mE(u,d){u.crossOrigin==null&&(u.crossOrigin=d.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=d.referrerPolicy),u.title==null&&(u.title=d.title)}function gE(u,d){u.crossOrigin==null&&(u.crossOrigin=d.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=d.referrerPolicy),u.integrity==null&&(u.integrity=d.integrity)}var ix=null;function GL(u,d,g){if(ix===null){var _=new Map,I=ix=new Map;I.set(g,_)}else I=ix,_=I.get(g),_||(_=new Map,I.set(g,_));if(_.has(u))return _;for(_.set(u,null),g=g.getElementsByTagName(u),I=0;I<g.length;I++){var k=g[I];if(!(k[bo]||k[ds]||u==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var q=k.getAttribute(d)||"";q=u+q;var Y=_.get(q);Y?Y.push(k):_.set(q,[k])}}return _}function WL(u,d,g){u=u.ownerDocument||u,u.head.insertBefore(g,d==="title"?u.querySelector("head > title"):null)}function EX(u,d,g){if(g===1||d.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof d.precedence!="string"||typeof d.href!="string"||d.href==="")break;return!0;case"link":if(typeof d.rel!="string"||typeof d.href!="string"||d.href===""||d.onLoad||d.onError)break;switch(d.rel){case"stylesheet":return u=d.disabled,typeof d.precedence=="string"&&u==null;default:return!0}case"script":if(d.async&&typeof d.async!="function"&&typeof d.async!="symbol"&&!d.onLoad&&!d.onError&&d.src&&typeof d.src=="string")return!0}return!1}function HL(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}var Xg=null;function NX(){}function IX(u,d,g){if(Xg===null)throw Error(s(475));var _=Xg;if(d.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var I=Op(g.href),k=u.querySelector(qg(I));if(k){u=k._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(_.count++,_=ax.bind(_),u.then(_,_)),d.state.loading|=4,d.instance=k,fs(k);return}k=u.ownerDocument||u,g=VL(g),(I=Za.get(I))&&mE(g,I),k=k.createElement("link"),fs(k);var q=k;q._p=new Promise(function(Y,ce){q.onload=Y,q.onerror=ce}),Rr(k,"link",g),d.instance=k}_.stylesheets===null&&(_.stylesheets=new Map),_.stylesheets.set(d,u),(u=d.state.preload)&&(d.state.loading&3)===0&&(_.count++,d=ax.bind(_),u.addEventListener("load",d),u.addEventListener("error",d))}}function CX(){if(Xg===null)throw Error(s(475));var u=Xg;return u.stylesheets&&u.count===0&&yE(u,u.stylesheets),0<u.count?function(d){var g=setTimeout(function(){if(u.stylesheets&&yE(u,u.stylesheets),u.unsuspend){var _=u.unsuspend;u.unsuspend=null,_()}},6e4);return u.unsuspend=d,function(){u.unsuspend=null,clearTimeout(g)}}:null}function ax(){if(this.count--,this.count===0){if(this.stylesheets)yE(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var ox=null;function yE(u,d){u.stylesheets=null,u.unsuspend!==null&&(u.count++,ox=new Map,d.forEach(kX,u),ox=null,ax.call(u))}function kX(u,d){if(!(d.state.loading&4)){var g=ox.get(u);if(g)var _=g.get(null);else{g=new Map,ox.set(u,g);for(var I=u.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<I.length;k++){var q=I[k];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(g.set(q.dataset.precedence,q),_=q)}_&&g.set(null,_)}I=d.instance,q=I.getAttribute("data-precedence"),k=g.get(q)||_,k===_&&g.set(null,I),g.set(q,I),this.count++,_=ax.bind(this),I.addEventListener("load",_),I.addEventListener("error",_),k?k.parentNode.insertBefore(I,k.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(I,u.firstChild)),d.state.loading|=4}}var Zg={$$typeof:$,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function $X(u,d,g,_,I,k,q,Y){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ac(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ac(0),this.hiddenUpdates=ac(null),this.identifierPrefix=_,this.onUncaughtError=I,this.onCaughtError=k,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Y,this.incompleteTransitions=new Map}function qL(u,d,g,_,I,k,q,Y,ce,$e,Fe,Ve){return u=new $X(u,d,g,q,Y,ce,$e,Ve),d=1,k===!0&&(d|=24),k=Ci(3,null,null,d),u.current=k,k.stateNode=u,d=QT(),d.refCount++,u.pooledCache=d,d.refCount++,k.memoizedState={element:_,isDehydrated:g,cache:d},nS(k),u}function KL(u){return u?(u=Sc,u):Sc}function XL(u,d,g,_,I,k){I=KL(I),_.context===null?_.context=I:_.pendingContext=I,_=Ou(d),_.payload={element:g},k=k===void 0?null:k,k!==null&&(_.callback=k),g=Pu(u,_,d),g!==null&&(Ta(g,u,d),Ng(g,u,d))}function ZL(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var g=u.retryLane;u.retryLane=g!==0&&g<d?g:d}}function vE(u,d){ZL(u,d),(u=u.alternate)&&ZL(u,d)}function YL(u){if(u.tag===13){var d=$u(u,67108864);d!==null&&Ta(d,u,67108864),vE(u,67108864)}}var lx=!0;function AX(u,d,g,_){var I=Z.T;Z.T=null;var k=re.p;try{re.p=2,bE(u,d,g,_)}finally{re.p=k,Z.T=I}}function RX(u,d,g,_){var I=Z.T;Z.T=null;var k=re.p;try{re.p=8,bE(u,d,g,_)}finally{re.p=k,Z.T=I}}function bE(u,d,g,_){if(lx){var I=_E(_);if(I===null)aE(u,d,_,cx,g),JL(u,_);else if(LX(I,u,d,g,_))_.stopPropagation();else if(JL(u,_),d&4&&-1<DX.indexOf(u)){for(;I!==null;){var k=oa(I);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var q=Kr(k.pendingLanes);if(q!==0){var Y=k;for(Y.pendingLanes|=2,Y.entangledLanes|=2;q;){var ce=1<<31-hs(q);Y.entanglements[1]|=ce,q&=~ce}yl(k),(Cn&6)===0&&(H_=Ot()+500,Ug(0))}}break;case 13:Y=$u(k,2),Y!==null&&Ta(Y,k,2),K_(),vE(k,2)}if(k=_E(_),k===null&&aE(u,d,_,cx,g),k===I)break;I=k}I!==null&&_.stopPropagation()}else aE(u,d,_,null,g)}}function _E(u){return u=il(u),xE(u)}var cx=null;function xE(u){if(cx=null,u=zi(u),u!==null){var d=i(u);if(d===null)u=null;else{var g=d.tag;if(g===13){if(u=a(d),u!==null)return u;u=null}else if(g===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null)}}return cx=u,null}function QL(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sn()){case wn:return 2;case jt:return 8;case bs:case Bs:return 32;case qr:return 268435456;default:return 32}default:return 32}}var wE=!1,Xu=null,Zu=null,Yu=null,Yg=new Map,Qg=new Map,Qu=[],DX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function JL(u,d){switch(u){case"focusin":case"focusout":Xu=null;break;case"dragenter":case"dragleave":Zu=null;break;case"mouseover":case"mouseout":Yu=null;break;case"pointerover":case"pointerout":Yg.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qg.delete(d.pointerId)}}function Jg(u,d,g,_,I,k){return u===null||u.nativeEvent!==k?(u={blockedOn:d,domEventName:g,eventSystemFlags:_,nativeEvent:k,targetContainers:[I]},d!==null&&(d=oa(d),d!==null&&YL(d)),u):(u.eventSystemFlags|=_,d=u.targetContainers,I!==null&&d.indexOf(I)===-1&&d.push(I),u)}function LX(u,d,g,_,I){switch(d){case"focusin":return Xu=Jg(Xu,u,d,g,_,I),!0;case"dragenter":return Zu=Jg(Zu,u,d,g,_,I),!0;case"mouseover":return Yu=Jg(Yu,u,d,g,_,I),!0;case"pointerover":var k=I.pointerId;return Yg.set(k,Jg(Yg.get(k)||null,u,d,g,_,I)),!0;case"gotpointercapture":return k=I.pointerId,Qg.set(k,Jg(Qg.get(k)||null,u,d,g,_,I)),!0}return!1}function eO(u){var d=zi(u.target);if(d!==null){var g=i(d);if(g!==null){if(d=g.tag,d===13){if(d=a(g),d!==null){u.blockedOn=d,fd(u.priority,function(){if(g.tag===13){var _=wa();_=hd(_);var I=$u(g,_);I!==null&&Ta(I,g,_),vE(g,_)}});return}}else if(d===3&&g.stateNode.current.memoizedState.isDehydrated){u.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}u.blockedOn=null}function ux(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var g=_E(u.nativeEvent);if(g===null){g=u.nativeEvent;var _=new g.constructor(g.type,g);mc=_,g.target.dispatchEvent(_),mc=null}else return d=oa(g),d!==null&&YL(d),u.blockedOn=g,!1;d.shift()}return!0}function tO(u,d,g){ux(u)&&g.delete(d)}function OX(){wE=!1,Xu!==null&&ux(Xu)&&(Xu=null),Zu!==null&&ux(Zu)&&(Zu=null),Yu!==null&&ux(Yu)&&(Yu=null),Yg.forEach(tO),Qg.forEach(tO)}function hx(u,d){u.blockedOn===d&&(u.blockedOn=null,wE||(wE=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,OX)))}var dx=null;function nO(u){dx!==u&&(dx=u,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){dx===u&&(dx=null);for(var d=0;d<u.length;d+=3){var g=u[d],_=u[d+1],I=u[d+2];if(typeof _!="function"){if(xE(_||g)===null)continue;break}var k=oa(g);k!==null&&(u.splice(d,3),d-=3,xS(k,{pending:!0,data:I,method:g.method,action:_},_,I))}}))}function ey(u){function d(ce){return hx(ce,u)}Xu!==null&&hx(Xu,u),Zu!==null&&hx(Zu,u),Yu!==null&&hx(Yu,u),Yg.forEach(d),Qg.forEach(d);for(var g=0;g<Qu.length;g++){var _=Qu[g];_.blockedOn===u&&(_.blockedOn=null)}for(;0<Qu.length&&(g=Qu[0],g.blockedOn===null);)eO(g),g.blockedOn===null&&Qu.shift();if(g=(u.ownerDocument||u).$$reactFormReplay,g!=null)for(_=0;_<g.length;_+=3){var I=g[_],k=g[_+1],q=I[er]||null;if(typeof k=="function")q||nO(g);else if(q){var Y=null;if(k&&k.hasAttribute("formAction")){if(I=k,q=k[er]||null)Y=q.formAction;else if(xE(I)!==null)continue}else Y=q.action;typeof Y=="function"?g[_+1]=Y:(g.splice(_,3),_-=3),nO(g)}}}function TE(u){this._internalRoot=u}fx.prototype.render=TE.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(s(409));var g=d.current,_=wa();XL(g,_,u,d,null,null)},fx.prototype.unmount=TE.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;XL(u.current,2,null,u,null,null),K_(),d[vo]=null}};function fx(u){this._internalRoot=u}fx.prototype.unstable_scheduleHydration=function(u){if(u){var d=yo();u={blockedOn:null,target:u,priority:d};for(var g=0;g<Qu.length&&d!==0&&d<Qu[g].priority;g++);Qu.splice(g,0,u),g===0&&eO(u)}};var sO=e.version;if(sO!=="19.1.1")throw Error(s(527,sO,"19.1.1"));re.findDOMNode=function(u){var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(s(188)):(u=Object.keys(u).join(","),Error(s(268,u)));return u=l(d),u=u!==null?c(u):null,u=u===null?null:u.stateNode,u};var PX={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var px=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!px.isDisabled&&px.supportsFiber)try{$s=px.inject(PX),An=px}catch{}}return ny.createRoot=function(u,d){if(!r(u))throw Error(s(299));var g=!1,_="",I=bD,k=_D,q=xD,Y=null;return d!=null&&(d.unstable_strictMode===!0&&(g=!0),d.identifierPrefix!==void 0&&(_=d.identifierPrefix),d.onUncaughtError!==void 0&&(I=d.onUncaughtError),d.onCaughtError!==void 0&&(k=d.onCaughtError),d.onRecoverableError!==void 0&&(q=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(Y=d.unstable_transitionCallbacks)),d=qL(u,1,!1,null,null,g,_,I,k,q,Y,null),u[vo]=d.current,iE(u),new TE(d)},ny.hydrateRoot=function(u,d,g){if(!r(u))throw Error(s(299));var _=!1,I="",k=bD,q=_D,Y=xD,ce=null,$e=null;return g!=null&&(g.unstable_strictMode===!0&&(_=!0),g.identifierPrefix!==void 0&&(I=g.identifierPrefix),g.onUncaughtError!==void 0&&(k=g.onUncaughtError),g.onCaughtError!==void 0&&(q=g.onCaughtError),g.onRecoverableError!==void 0&&(Y=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(ce=g.unstable_transitionCallbacks),g.formState!==void 0&&($e=g.formState)),d=qL(u,1,!0,d,g??null,_,I,k,q,Y,ce,$e),d.context=KL(null),g=d.current,_=wa(),_=hd(_),I=Ou(_),I.callback=null,Pu(g,I,_),g=_,d.current.lanes=g,ss(d,g),yl(d),u[vo]=d.current,iE(u),new fx(d)},ny.version="19.1.1",ny}var mO;function XX(){if(mO)return NE.exports;mO=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),NE.exports=KX(),NE.exports}var ZX=XX();/**
 * react-router v7.9.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var gO="popstate";function YX(n={}){function e(s,r){let{pathname:i,search:a,hash:o}=s.location;return SN("",{pathname:i,search:a,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(s,r){return typeof r=="string"?r:My(r)}return JX(e,t,null,n)}function ys(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Ul(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function QX(){return Math.random().toString(36).substring(2,10)}function yO(n,e){return{usr:n.state,key:n.key,idx:e}}function SN(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Mm(e):e,state:t,key:e&&e.key||s||QX()}}function My({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Mm(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function JX(n,e,t,s={}){let{window:r=document.defaultView,v5Compat:i=!1}=s,a=r.history,o="POP",l=null,c=h();c==null&&(c=0,a.replaceState({...a.state,idx:c},""));function h(){return(a.state||{idx:null}).idx}function p(){o="POP";let T=h(),E=T==null?null:T-c;c=T,l&&l({action:o,location:w.location,delta:E})}function m(T,E){o="PUSH";let C=SN(w.location,T,E);c=h()+1;let $=yO(C,c),R=w.createHref(C);try{a.pushState($,"",R)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;r.location.assign(R)}i&&l&&l({action:o,location:w.location,delta:1})}function v(T,E){o="REPLACE";let C=SN(w.location,T,E);c=h();let $=yO(C,c),R=w.createHref(C);a.replaceState($,"",R),i&&l&&l({action:o,location:w.location,delta:0})}function x(T){return eZ(T)}let w={get action(){return o},get location(){return n(r,a)},listen(T){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(gO,p),l=T,()=>{r.removeEventListener(gO,p),l=null}},createHref(T){return e(r,T)},createURL:x,encodeLocation(T){let E=x(T);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:m,replace:v,go(T){return a.go(T)}};return w}function eZ(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ys(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:My(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function vF(n,e,t="/"){return tZ(n,e,t,!1)}function tZ(n,e,t,s){let r=typeof e=="string"?Mm(e):e,i=Kc(r.pathname||"/",t);if(i==null)return null;let a=bF(n);nZ(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=fZ(i);o=hZ(a[l],c,s)}return o}function bF(n,e=[],t=[],s="",r=!1){let i=(a,o,l=r,c)=>{let h={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(s)&&l)return;ys(h.relativePath.startsWith(s),`Absolute route path "${h.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(s.length)}let p=Uc([s,h.relativePath]),m=t.concat(h);a.children&&a.children.length>0&&(ys(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),bF(a.children,e,m,p,l)),!(a.path==null&&!a.index)&&e.push({path:p,score:cZ(p,a.index),routesMeta:m})};return n.forEach((a,o)=>{if(a.path===""||!a.path?.includes("?"))i(a,o);else for(let l of _F(a.path))i(a,o,!0,l)}),e}function _F(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,r=t.endsWith("?"),i=t.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let a=_F(s.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),r&&o.push(...a),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function nZ(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:uZ(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var sZ=/^:[\w-]+$/,rZ=3,iZ=2,aZ=1,oZ=10,lZ=-2,vO=n=>n==="*";function cZ(n,e){let t=n.split("/"),s=t.length;return t.some(vO)&&(s+=lZ),e&&(s+=iZ),t.filter(r=>!vO(r)).reduce((r,i)=>r+(sZ.test(i)?rZ:i===""?aZ:oZ),s)}function uZ(n,e){return n.length===e.length&&n.slice(0,-1).every((s,r)=>s===e[r])?n[n.length-1]-e[e.length-1]:0}function hZ(n,e,t=!1){let{routesMeta:s}=n,r={},i="/",a=[];for(let o=0;o<s.length;++o){let l=s[o],c=o===s.length-1,h=i==="/"?e:e.slice(i.length)||"/",p=f0({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),m=l.route;if(!p&&c&&t&&!s[s.length-1].route.index&&(p=f0({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!p)return null;Object.assign(r,p.params),a.push({params:r,pathname:Uc([i,p.pathname]),pathnameBase:yZ(Uc([i,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(i=Uc([i,p.pathnameBase]))}return a}function f0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=dZ(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let i=r[0],a=i.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:s.reduce((c,{paramName:h,isOptional:p},m)=>{if(h==="*"){let x=o[m]||"";a=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const v=o[m];return p&&!v?c[h]=void 0:c[h]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:a,pattern:n}}function dZ(n,e=!1,t=!0){Ul(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function fZ(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ul(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Kc(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}function pZ(n,e="/"){let{pathname:t,search:s="",hash:r=""}=typeof n=="string"?Mm(n):n;return{pathname:t?t.startsWith("/")?t:mZ(t,e):e,search:vZ(s),hash:bZ(r)}}function mZ(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function $E(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function gZ(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function xF(n){let e=gZ(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function wF(n,e,t,s=!1){let r;typeof n=="string"?r=Mm(n):(r={...n},ys(!r.pathname||!r.pathname.includes("?"),$E("?","pathname","search",r)),ys(!r.pathname||!r.pathname.includes("#"),$E("#","pathname","hash",r)),ys(!r.search||!r.search.includes("#"),$E("#","search","hash",r)));let i=n===""||r.pathname==="",a=i?"/":r.pathname,o;if(a==null)o=t;else{let p=e.length-1;if(!s&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),p-=1;r.pathname=m.join("/")}o=p>=0?e[p]:"/"}let l=pZ(r,o),c=a&&a!=="/"&&a.endsWith("/"),h=(i||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}var Uc=n=>n.join("/").replace(/\/\/+/g,"/"),yZ=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),vZ=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,bZ=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function _Z(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var TF=["POST","PUT","PATCH","DELETE"];new Set(TF);var xZ=["GET",...TF];new Set(xZ);var Fm=ve.createContext(null);Fm.displayName="DataRouter";var S1=ve.createContext(null);S1.displayName="DataRouterState";ve.createContext(!1);var SF=ve.createContext({isTransitioning:!1});SF.displayName="ViewTransition";var wZ=ve.createContext(new Map);wZ.displayName="Fetchers";var TZ=ve.createContext(null);TZ.displayName="Await";var sc=ve.createContext(null);sc.displayName="Navigation";var yv=ve.createContext(null);yv.displayName="Location";var ru=ve.createContext({outlet:null,matches:[],isDataRoute:!1});ru.displayName="Route";var bC=ve.createContext(null);bC.displayName="RouteError";function SZ(n,{relative:e}={}){ys(vv(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=ve.useContext(sc),{hash:r,pathname:i,search:a}=_v(n,{relative:e}),o=i;return t!=="/"&&(o=i==="/"?t:Uc([t,i])),s.createHref({pathname:o,search:a,hash:r})}function vv(){return ve.useContext(yv)!=null}function Qo(){return ys(vv(),"useLocation() may be used only in the context of a <Router> component."),ve.useContext(yv).location}var EF="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function NF(n){ve.useContext(sc).static||ve.useLayoutEffect(n)}function bv(){let{isDataRoute:n}=ve.useContext(ru);return n?MZ():EZ()}function EZ(){ys(vv(),"useNavigate() may be used only in the context of a <Router> component.");let n=ve.useContext(Fm),{basename:e,navigator:t}=ve.useContext(sc),{matches:s}=ve.useContext(ru),{pathname:r}=Qo(),i=JSON.stringify(xF(s)),a=ve.useRef(!1);return NF(()=>{a.current=!0}),ve.useCallback((l,c={})=>{if(Ul(a.current,EF),!a.current)return;if(typeof l=="number"){t.go(l);return}let h=wF(l,JSON.parse(i),r,c.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Uc([e,h.pathname])),(c.replace?t.replace:t.push)(h,c.state,c)},[e,t,i,r,n])}ve.createContext(null);function _v(n,{relative:e}={}){let{matches:t}=ve.useContext(ru),{pathname:s}=Qo(),r=JSON.stringify(xF(t));return ve.useMemo(()=>wF(n,JSON.parse(r),s,e==="path"),[n,r,s,e])}function NZ(n,e){return IF(n,e)}function IF(n,e,t,s,r){ys(vv(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=ve.useContext(sc),{matches:a}=ve.useContext(ru),o=a[a.length-1],l=o?o.params:{},c=o?o.pathname:"/",h=o?o.pathnameBase:"/",p=o&&o.route;{let C=p&&p.path||"";CF(c,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=Qo(),v;if(e){let C=typeof e=="string"?Mm(e):e;ys(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),v=C}else v=m;let x=v.pathname||"/",w=x;if(h!=="/"){let C=h.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(C.length).join("/")}let T=vF(n,{pathname:w});Ul(p||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Ul(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=AZ(T&&T.map(C=>Object.assign({},C,{params:Object.assign({},l,C.params),pathname:Uc([h,i.encodeLocation?i.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:Uc([h,i.encodeLocation?i.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),a,t,s,r);return e&&E?ve.createElement(yv.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function IZ(){let n=PZ(),e=_Z(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},i={padding:"2px 4px",backgroundColor:s},a=null;return console.error("Error handled by React Router default ErrorBoundary:",n),a=ve.createElement(ve.Fragment,null,ve.createElement("p",null," Hey developer "),ve.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ve.createElement("code",{style:i},"ErrorBoundary")," or"," ",ve.createElement("code",{style:i},"errorElement")," prop on your route.")),ve.createElement(ve.Fragment,null,ve.createElement("h2",null,"Unexpected Application Error!"),ve.createElement("h3",{style:{fontStyle:"italic"}},e),t?ve.createElement("pre",{style:r},t):null,a)}var CZ=ve.createElement(IZ,null),kZ=class extends ve.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.unstable_onError?this.props.unstable_onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?ve.createElement(ru.Provider,{value:this.props.routeContext},ve.createElement(bC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function $Z({routeContext:n,match:e,children:t}){let s=ve.useContext(Fm);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),ve.createElement(ru.Provider,{value:n},t)}function AZ(n,e=[],t=null,s=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,a=t?.errors;if(a!=null){let c=i.findIndex(h=>h.route.id&&a?.[h.route.id]!==void 0);ys(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,c+1))}let o=!1,l=-1;if(t)for(let c=0;c<i.length;c++){let h=i[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(l=c),h.route.id){let{loaderData:p,errors:m}=t,v=h.route.loader&&!p.hasOwnProperty(h.route.id)&&(!m||m[h.route.id]===void 0);if(h.route.lazy||v){o=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}return i.reduceRight((c,h,p)=>{let m,v=!1,x=null,w=null;t&&(m=a&&h.route.id?a[h.route.id]:void 0,x=h.route.errorElement||CZ,o&&(l<0&&p===0?(CF("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,w=null):l===p&&(v=!0,w=h.route.hydrateFallbackElement||null)));let T=e.concat(i.slice(0,p+1)),E=()=>{let C;return m?C=x:v?C=w:h.route.Component?C=ve.createElement(h.route.Component,null):h.route.element?C=h.route.element:C=c,ve.createElement($Z,{match:h,routeContext:{outlet:c,matches:T,isDataRoute:t!=null},children:C})};return t&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?ve.createElement(kZ,{location:t.location,revalidation:t.revalidation,component:x,error:m,children:E(),routeContext:{outlet:null,matches:T,isDataRoute:!0},unstable_onError:s}):E()},null)}function _C(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function RZ(n){let e=ve.useContext(Fm);return ys(e,_C(n)),e}function DZ(n){let e=ve.useContext(S1);return ys(e,_C(n)),e}function LZ(n){let e=ve.useContext(ru);return ys(e,_C(n)),e}function xC(n){let e=LZ(n),t=e.matches[e.matches.length-1];return ys(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function OZ(){return xC("useRouteId")}function PZ(){let n=ve.useContext(bC),e=DZ("useRouteError"),t=xC("useRouteError");return n!==void 0?n:e.errors?.[t]}function MZ(){let{router:n}=RZ("useNavigate"),e=xC("useNavigate"),t=ve.useRef(!1);return NF(()=>{t.current=!0}),ve.useCallback(async(r,i={})=>{Ul(t.current,EF),t.current&&(typeof r=="number"?n.navigate(r):await n.navigate(r,{fromRouteId:e,...i}))},[n,e])}var bO={};function CF(n,e,t){!e&&!bO[n]&&(bO[n]=!0,Ul(!1,t))}ve.memo(FZ);function FZ({routes:n,future:e,state:t,unstable_onError:s}){return IF(n,void 0,t,s,e)}function Ds(n){ys(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function jZ({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:r,static:i=!1}){ys(!vv(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=n.replace(/^\/*/,"/"),o=ve.useMemo(()=>({basename:a,navigator:r,static:i,future:{}}),[a,r,i]);typeof t=="string"&&(t=Mm(t));let{pathname:l="/",search:c="",hash:h="",state:p=null,key:m="default"}=t,v=ve.useMemo(()=>{let x=Kc(l,a);return x==null?null:{location:{pathname:x,search:c,hash:h,state:p,key:m},navigationType:s}},[a,l,c,h,p,m,s]);return Ul(v!=null,`<Router basename="${a}"> is not able to match the URL "${l}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:ve.createElement(sc.Provider,{value:o},ve.createElement(yv.Provider,{children:e,value:v}))}function BZ({children:n,location:e}){return NZ(EN(n),e)}function EN(n,e=[]){let t=[];return ve.Children.forEach(n,(s,r)=>{if(!ve.isValidElement(s))return;let i=[...e,r];if(s.type===ve.Fragment){t.push.apply(t,EN(s.props.children,i));return}ys(s.type===Ds,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ys(!s.props.index||!s.props.children,"An index route cannot have child routes.");let a={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=EN(s.props.children,i)),t.push(a)}),t}var jx="get",Bx="application/x-www-form-urlencoded";function E1(n){return n!=null&&typeof n.tagName=="string"}function zZ(n){return E1(n)&&n.tagName.toLowerCase()==="button"}function VZ(n){return E1(n)&&n.tagName.toLowerCase()==="form"}function UZ(n){return E1(n)&&n.tagName.toLowerCase()==="input"}function GZ(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function WZ(n,e){return n.button===0&&(!e||e==="_self")&&!GZ(n)}var mx=null;function HZ(){if(mx===null)try{new FormData(document.createElement("form"),0),mx=!1}catch{mx=!0}return mx}var qZ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function AE(n){return n!=null&&!qZ.has(n)?(Ul(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bx}"`),null):n}function KZ(n,e){let t,s,r,i,a;if(VZ(n)){let o=n.getAttribute("action");s=o?Kc(o,e):null,t=n.getAttribute("method")||jx,r=AE(n.getAttribute("enctype"))||Bx,i=new FormData(n)}else if(zZ(n)||UZ(n)&&(n.type==="submit"||n.type==="image")){let o=n.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||o.getAttribute("action");if(s=l?Kc(l,e):null,t=n.getAttribute("formmethod")||o.getAttribute("method")||jx,r=AE(n.getAttribute("formenctype"))||AE(o.getAttribute("enctype"))||Bx,i=new FormData(o,n),!HZ()){let{name:c,type:h,value:p}=n;if(h==="image"){let m=c?`${c}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else c&&i.append(c,p)}}else{if(E1(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=jx,s=null,r=Bx,a=n}return i&&r==="text/plain"&&(a=i,i=void 0),{action:s,method:t.toLowerCase(),encType:r,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function wC(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function XZ(n,e,t){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return s.pathname==="/"?s.pathname=`_root.${t}`:e&&Kc(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function ZZ(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function YZ(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function QZ(n,e,t){let s=await Promise.all(n.map(async r=>{let i=e.routes[r.route.id];if(i){let a=await ZZ(i,t);return a.links?a.links():[]}return[]}));return nY(s.flat(1).filter(YZ).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function _O(n,e,t,s,r,i){let a=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,o=(l,c)=>t[c].pathname!==l.pathname||t[c].route.path?.endsWith("*")&&t[c].params["*"]!==l.params["*"];return i==="assets"?e.filter((l,c)=>a(l,c)||o(l,c)):i==="data"?e.filter((l,c)=>{let h=s.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(a(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let p=l.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function JZ(n,e,{includeHydrateFallback:t}={}){return eY(n.map(s=>{let r=e.routes[s.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function eY(n){return[...new Set(n)]}function tY(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function nY(n,e){let t=new Set;return new Set(e),n.reduce((s,r)=>{let i=JSON.stringify(tY(r));return t.has(i)||(t.add(i),s.push({key:i,link:r})),s},[])}function kF(){let n=ve.useContext(Fm);return wC(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function sY(){let n=ve.useContext(S1);return wC(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var TC=ve.createContext(void 0);TC.displayName="FrameworkContext";function $F(){let n=ve.useContext(TC);return wC(n,"You must render this element inside a <HydratedRouter> element"),n}function rY(n,e){let t=ve.useContext(TC),[s,r]=ve.useState(!1),[i,a]=ve.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:h,onTouchStart:p}=e,m=ve.useRef(null);ve.useEffect(()=>{if(n==="render"&&a(!0),n==="viewport"){let w=E=>{E.forEach(C=>{a(C.isIntersecting)})},T=new IntersectionObserver(w,{threshold:.5});return m.current&&T.observe(m.current),()=>{T.disconnect()}}},[n]),ve.useEffect(()=>{if(s){let w=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(w)}}},[s]);let v=()=>{r(!0)},x=()=>{r(!1),a(!1)};return t?n!=="intent"?[i,m,{}]:[i,m,{onFocus:sy(o,v),onBlur:sy(l,x),onMouseEnter:sy(c,v),onMouseLeave:sy(h,x),onTouchStart:sy(p,v)}]:[!1,m,{}]}function sy(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function iY({page:n,...e}){let{router:t}=kF(),s=ve.useMemo(()=>vF(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?ve.createElement(oY,{page:n,matches:s,...e}):null}function aY(n){let{manifest:e,routeModules:t}=$F(),[s,r]=ve.useState([]);return ve.useEffect(()=>{let i=!1;return QZ(n,e,t).then(a=>{i||r(a)}),()=>{i=!0}},[n,e,t]),s}function oY({page:n,matches:e,...t}){let s=Qo(),{manifest:r,routeModules:i}=$F(),{basename:a}=kF(),{loaderData:o,matches:l}=sY(),c=ve.useMemo(()=>_O(n,e,l,r,s,"data"),[n,e,l,r,s]),h=ve.useMemo(()=>_O(n,e,l,r,s,"assets"),[n,e,l,r,s]),p=ve.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let x=new Set,w=!1;if(e.forEach(E=>{let C=r.routes[E.route.id];!C||!C.hasLoader||(!c.some($=>$.route.id===E.route.id)&&E.route.id in o&&i[E.route.id]?.shouldRevalidate||C.hasClientLoader?w=!0:x.add(E.route.id))}),x.size===0)return[];let T=XZ(n,a,"data");return w&&x.size>0&&T.searchParams.set("_routes",e.filter(E=>x.has(E.route.id)).map(E=>E.route.id).join(",")),[T.pathname+T.search]},[a,o,s,r,c,e,n,i]),m=ve.useMemo(()=>JZ(h,r),[h,r]),v=aY(h);return ve.createElement(ve.Fragment,null,p.map(x=>ve.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),m.map(x=>ve.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),v.map(({key:x,link:w})=>ve.createElement("link",{key:x,nonce:t.nonce,...w})))}function lY(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var AF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{AF&&(window.__reactRouterVersion="7.9.3")}catch{}function cY({basename:n,children:e,window:t}){let s=ve.useRef();s.current==null&&(s.current=YX({window:t,v5Compat:!0}));let r=s.current,[i,a]=ve.useState({action:r.action,location:r.location}),o=ve.useCallback(l=>{ve.startTransition(()=>a(l))},[a]);return ve.useLayoutEffect(()=>r.listen(o),[r,o]),ve.createElement(jZ,{basename:n,children:e,location:i.location,navigationType:i.action,navigator:r})}var RF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ft=ve.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:r,reloadDocument:i,replace:a,state:o,target:l,to:c,preventScrollReset:h,viewTransition:p,...m},v){let{basename:x}=ve.useContext(sc),w=typeof c=="string"&&RF.test(c),T,E=!1;if(typeof c=="string"&&w&&(T=c,AF))try{let M=new URL(window.location.href),B=c.startsWith("//")?new URL(M.protocol+c):new URL(c),D=Kc(B.pathname,x);B.origin===M.origin&&D!=null?c=D+B.search+B.hash:E=!0}catch{Ul(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=SZ(c,{relative:r}),[$,R,P]=rY(s,m),U=fY(c,{replace:a,state:o,target:l,preventScrollReset:h,relative:r,viewTransition:p});function j(M){e&&e(M),M.defaultPrevented||U(M)}let O=ve.createElement("a",{...m,...P,href:T||C,onClick:E||i?e:j,ref:lY(v,R),target:l,"data-discover":!w&&t==="render"?"true":void 0});return $&&!w?ve.createElement(ve.Fragment,null,O,ve.createElement(iY,{page:C})):O});ft.displayName="Link";var uY=ve.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:r=!1,style:i,to:a,viewTransition:o,children:l,...c},h){let p=_v(a,{relative:c.relative}),m=Qo(),v=ve.useContext(S1),{navigator:x,basename:w}=ve.useContext(sc),T=v!=null&&vY(p)&&o===!0,E=x.encodeLocation?x.encodeLocation(p).pathname:p.pathname,C=m.pathname,$=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(C=C.toLowerCase(),$=$?$.toLowerCase():null,E=E.toLowerCase()),$&&w&&($=Kc($,w)||$);const R=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let P=C===E||!r&&C.startsWith(E)&&C.charAt(R)==="/",U=$!=null&&($===E||!r&&$.startsWith(E)&&$.charAt(E.length)==="/"),j={isActive:P,isPending:U,isTransitioning:T},O=P?e:void 0,M;typeof s=="function"?M=s(j):M=[s,P?"active":null,U?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let B=typeof i=="function"?i(j):i;return ve.createElement(ft,{...c,"aria-current":O,className:M,ref:h,style:B,to:a,viewTransition:o},typeof l=="function"?l(j):l)});uY.displayName="NavLink";var hY=ve.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:r,state:i,method:a=jx,action:o,onSubmit:l,relative:c,preventScrollReset:h,viewTransition:p,...m},v)=>{let x=gY(),w=yY(o,{relative:c}),T=a.toLowerCase()==="get"?"get":"post",E=typeof o=="string"&&RF.test(o),C=$=>{if(l&&l($),$.defaultPrevented)return;$.preventDefault();let R=$.nativeEvent.submitter,P=R?.getAttribute("formmethod")||a;x(R||$.currentTarget,{fetcherKey:e,method:P,navigate:t,replace:r,state:i,relative:c,preventScrollReset:h,viewTransition:p})};return ve.createElement("form",{ref:v,method:T,action:w,onSubmit:s?l:C,...m,"data-discover":!E&&n==="render"?"true":void 0})});hY.displayName="Form";function dY(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DF(n){let e=ve.useContext(Fm);return ys(e,dY(n)),e}function fY(n,{target:e,replace:t,state:s,preventScrollReset:r,relative:i,viewTransition:a}={}){let o=bv(),l=Qo(),c=_v(n,{relative:i});return ve.useCallback(h=>{if(WZ(h,e)){h.preventDefault();let p=t!==void 0?t:My(l)===My(c);o(n,{replace:p,state:s,preventScrollReset:r,relative:i,viewTransition:a})}},[l,o,c,t,s,e,n,r,i,a])}var pY=0,mY=()=>`__${String(++pY)}__`;function gY(){let{router:n}=DF("useSubmit"),{basename:e}=ve.useContext(sc),t=OZ();return ve.useCallback(async(s,r={})=>{let{action:i,method:a,encType:o,formData:l,body:c}=KZ(s,e);if(r.navigate===!1){let h=r.fetcherKey||mY();await n.fetch(h,t,r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||a,formEncType:r.encType||o,flushSync:r.flushSync})}else await n.navigate(r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||a,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[n,e,t])}function yY(n,{relative:e}={}){let{basename:t}=ve.useContext(sc),s=ve.useContext(ru);ys(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),i={..._v(n||".",{relative:e})},a=Qo();if(n==null){i.search=a.search;let o=new URLSearchParams(i.search),l=o.getAll("index");if(l.some(h=>h==="")){o.delete("index"),l.filter(p=>p).forEach(p=>o.append("index",p));let h=o.toString();i.search=h?`?${h}`:""}}return(!n||n===".")&&r.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Uc([t,i.pathname])),My(i)}function vY(n,{relative:e}={}){let t=ve.useContext(SF);ys(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=DF("useViewTransitionState"),r=_v(n,{relative:e});if(!t.isTransitioning)return!1;let i=Kc(t.currentLocation.pathname,s)||t.currentLocation.pathname,a=Kc(t.nextLocation.pathname,s)||t.nextLocation.pathname;return f0(r.pathname,a)!=null||f0(r.pathname,i)!=null}function xO(){Qo();const n=localStorage.getItem("userRole")!==null,e=()=>{const s=localStorage.getItem("userRole");return s==="farmer"?"/farmer":s==="buyer"?"/buyer":s==="admin"?"/admin":"/login"},t=()=>{localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),window.location.href="/login"};return y.jsx("nav",{className:"navbar-container navbar-farmer",children:y.jsxs("div",{className:"navbar-content",children:[y.jsx("div",{className:"navbar-logo-button",children:y.jsx("button",{children:y.jsxs("a",{href:"./farmer",children:[" ",y.jsx("div",{className:"navbar-logo"})]})})}),y.jsxs("div",{className:"navbar-right",children:[y.jsxs("div",{className:"navbar-nav",children:[y.jsxs(ft,{to:e(),className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Home"]}),y.jsxs(ft,{to:"/mrv-dashboard-farmer",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"MRV Dashboard"]}),y.jsxs(ft,{to:"/marketplace",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Market Place"]}),y.jsxs(ft,{to:"/add-project",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Add Project"]}),y.jsxs(ft,{to:"/profile",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Profile"]})]}),y.jsx("div",{className:"navbar-buttons",children:n?y.jsx("a",{href:"./login",children:y.jsx("button",{onClick:t,className:"btn-logout",children:"Logout"})}):y.jsxs(y.Fragment,{children:[y.jsx(ft,{to:"/login",className:"btn-signin",children:"Sign In"}),y.jsx(ft,{to:"/signup",className:"btn-signup",children:"Sign Up"})]})})]})]})})}function bY(){return y.jsxs("div",{className:"home-container",children:[y.jsxs("div",{className:"hero-section hero-buyer",children:[y.jsx("div",{className:"hero-background"}),y.jsxs("div",{className:"hero-content",children:[y.jsx("div",{className:"hero-badge",children:" Buyer Portal"}),y.jsx("h1",{className:"hero-title",children:"Invest in Nature. Own Verified Carbon Credits."}),y.jsx("p",{className:"hero-subtitle",children:"Support Blue Carbon projects in India and track your real climate impact with transparency."}),y.jsxs("div",{className:"hero-actions",children:[y.jsx(ft,{to:"/marketplace",className:"btn-hero-primary",children:"Browse Credits"}),y.jsx(ft,{to:"/mrv-dashboard-buyer",className:"btn-hero-secondary",children:"View Portfolio"})]})]})]}),y.jsxs("div",{className:"dashboard-grid",children:[y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"Browse Marketplace"}),y.jsx("p",{children:"Explore available carbon credits from verified projects"}),y.jsx(ft,{to:"/marketplace",className:"card-button",children:"Browse Credits"})]}),y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"MRV Dashboard"}),y.jsx("p",{children:"Monitor carbon credit marketplace and your portfolio"}),y.jsx(ft,{to:"/mrv-dashboard-buyer",className:"card-button",children:"View Dashboard"})]}),y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"Project Verification"}),y.jsx("p",{children:"Research project details and verification status"}),y.jsx(ft,{to:"/verification",className:"card-button",children:"Verify Projects"})]}),y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"Impact Reports"}),y.jsx("p",{children:"Track your carbon offset contributions"}),y.jsx(ft,{to:"/impact-reports",className:"card-button",children:"View Impact"})]})]}),y.jsxs("div",{className:"featured-projects",children:[y.jsx("h2",{children:"Featured Projects"}),y.jsxs("div",{className:"project-grid",children:[y.jsxs("div",{className:"project-card",children:[y.jsx("div",{className:"project-image",children:""}),y.jsx("h4",{children:"Coastal Mangrove Restoration"}),y.jsx("p",{children:"1,250 credits available"}),y.jsx("span",{className:"project-price",children:"$25/credit"})]}),y.jsxs("div",{className:"project-card",children:[y.jsx("div",{className:"project-image",children:""}),y.jsx("h4",{children:"Seagrass Conservation"}),y.jsx("p",{children:"800 credits available"}),y.jsx("span",{className:"project-price",children:"$30/credit"})]}),y.jsxs("div",{className:"project-card",children:[y.jsx("div",{className:"project-image",children:""}),y.jsx("h4",{children:"Oyster Reef Restoration"}),y.jsx("p",{children:"600 credits available"}),y.jsx("span",{className:"project-price",children:"$35/credit"})]})]})]})]})}function _Y(){Qo();const n=localStorage.getItem("userRole")!==null,e=()=>{const s=localStorage.getItem("userRole");return s==="farmer"?"/farmer":s==="buyer"?"/buyer":s==="admin"?"/admin":"/login"},t=()=>{localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),window.location.href="/login"};return y.jsx("nav",{className:"navbar-container navbar-buyer",children:y.jsxs("div",{className:"navbar-content",children:[y.jsx("div",{className:"navbar-logo-button",children:y.jsx("button",{children:y.jsxs("a",{href:"./Buyer",children:[" ",y.jsx("div",{className:"navbar-logo"})]})})}),y.jsxs("div",{className:"navbar-right",children:[y.jsxs("div",{className:"navbar-nav",children:[y.jsxs(ft,{to:e(),className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Home"]}),y.jsxs(ft,{to:"/mrv-dashboard-buyer",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"MRV Dashboard"]}),y.jsxs(ft,{to:"/marketplace",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Market Place"]}),y.jsxs(ft,{to:"/my-purchases",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"My Purchases"]}),y.jsxs(ft,{to:"/profile",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Profile"]})]}),y.jsx("div",{className:"navbar-buttons",children:n?y.jsx("a",{href:"./login",children:y.jsx("button",{onClick:t,className:"btn-logout",children:"Logout"})}):y.jsxs(y.Fragment,{children:[y.jsx(ft,{to:"/login",className:"btn-signin",children:"Sign In"}),y.jsx(ft,{to:"/signup",className:"btn-signup",children:"Sign Up"})]})})]})]})})}function xY(){Qo();const n=localStorage.getItem("userRole")!==null,e=()=>{const s=localStorage.getItem("userRole");return s==="farmer"?"/farmer":s==="buyer"?"/buyer":s==="admin"?"/admin":"/login"},t=()=>{localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),window.location.href="/login"};return y.jsx("nav",{className:"navbar-container navbar-admin",children:y.jsxs("div",{className:"navbar-content",children:[y.jsx("div",{className:"navbar-logo-button",children:y.jsx("button",{children:y.jsxs("a",{href:"./admin",children:[" ",y.jsx("div",{className:"navbar-logo"})]})})}),y.jsxs("div",{className:"navbar-right",children:[y.jsxs("div",{className:"navbar-nav",children:[y.jsxs(ft,{to:e(),className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Home"]}),y.jsxs(ft,{to:"/project-verification",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Project Verification"]}),y.jsxs(ft,{to:"/user-management",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"User Management"]}),y.jsxs(ft,{to:"/transactions",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Transactions"]}),y.jsxs(ft,{to:"/reports",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Reports"]}),y.jsxs(ft,{to:"/profile",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Profile"]})]}),y.jsx("div",{className:"navbar-buttons",children:n?y.jsx("a",{href:"./login",children:y.jsx("button",{onClick:t,className:"btn-logout",children:"Logout"})}):y.jsxs(y.Fragment,{children:[y.jsx(ft,{to:"/login",className:"btn-signin",children:"Sign In"}),y.jsx(ft,{to:"/signup",className:"btn-signup",children:"Sign Up"})]})})]})]})})}function wY(){const[n,e]=ve.useState(null);switch(ve.useEffect(()=>{const t=localStorage.getItem("userRole");e(t);const s=()=>{const r=localStorage.getItem("userRole");e(r)};return window.addEventListener("storage",s),window.addEventListener("userRoleChanged",s),()=>{window.removeEventListener("storage",s),window.removeEventListener("userRoleChanged",s)}},[]),n){case"farmer":return y.jsx(xO,{});case"buyer":return y.jsx(_Y,{});case"admin":return y.jsx(xY,{});default:return y.jsx(xO,{})}}function N1(){return y.jsx("nav",{className:"navbar-container navbar-default",children:y.jsxs("div",{className:"navbar-content",children:[y.jsx("div",{className:"navbar-logo-button",children:y.jsx("button",{children:y.jsxs("a",{href:"./",children:[" ",y.jsx("div",{className:"navbar-logo"})]})})}),y.jsxs("div",{className:"navbar-right",children:[y.jsxs("div",{className:"navbar-nav",children:[y.jsxs(ft,{to:"/",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Home"]}),y.jsxs(ft,{to:"/dashboard",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Dashboard"]}),y.jsxs(ft,{to:"/about",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"About Us"]}),y.jsxs(ft,{to:"/contact",className:"nav-link",children:[y.jsx("span",{className:"nav-icon",children:""}),"Contact Us"]})]}),y.jsxs("div",{className:"navbar-buttons",children:[y.jsx(ft,{to:"/login",className:"btn-signin",children:"Sign In"}),y.jsx(ft,{to:"/signup",className:"btn-signup",children:"Sign Up"})]})]})]})})}function TY(){return y.jsxs("div",{className:"default-landing",children:[y.jsx(N1,{}),y.jsx("section",{className:"default-hero",children:y.jsxs("div",{className:"default-hero-content",children:[y.jsxs("div",{className:"default-hero-text",children:[y.jsx("h1",{className:"default-hero-title",children:"Welcome to CarbonLens"}),y.jsx("p",{className:"default-hero-subtitle",children:"Revolutionizing carbon credit trading through blockchain technology and sustainable agriculture"}),y.jsxs("div",{className:"default-hero-actions",children:[y.jsx("a",{href:"/login",className:"default-btn-primary",children:"Get Started"}),y.jsx("a",{href:"/about",className:"default-btn-secondary",children:"Learn More"})]})]}),y.jsx("div",{className:"right-side",children:y.jsxs("div",{className:"floating-emojis",children:[y.jsx("span",{className:"emoji e1",children:""}),y.jsx("span",{className:"emoji e2",children:""}),y.jsx("span",{className:"emoji e3",children:""}),y.jsx("span",{className:"emoji e4",children:""}),y.jsx("span",{className:"emoji e5",children:""})]})})]})}),y.jsx("section",{className:"default-features",children:y.jsxs("div",{className:"default-container",children:[y.jsx("h2",{className:"default-section-title",children:"Why Choose CarbonLens?"}),y.jsxs("div",{className:"default-features-grid",children:[y.jsxs("div",{className:"default-feature-card",children:[y.jsx("div",{className:"default-feature-icon",children:""}),y.jsx("h3",{children:"For Farmers"}),y.jsx("p",{children:"Monetize your sustainable farming practices and earn carbon credits"})]}),y.jsxs("div",{className:"default-feature-card",children:[y.jsx("div",{className:"default-feature-icon",children:""}),y.jsx("h3",{children:"For Buyers"}),y.jsx("p",{children:"Invest in verified carbon credits and support environmental sustainability"})]}),y.jsxs("div",{className:"default-feature-card",children:[y.jsx("div",{className:"default-feature-icon",children:""}),y.jsx("h3",{children:"Secure & Transparent"}),y.jsx("p",{children:"Blockchain-powered verification ensures trust and transparency"})]})]})]})}),y.jsx("section",{className:"default-cta",children:y.jsxs("div",{className:"default-container",children:[y.jsx("h2",{children:"Ready to Make a Difference?"}),y.jsx("p",{children:"Join thousands of farmers and buyers creating a sustainable future"}),y.jsxs("div",{className:"default-cta-buttons",children:[y.jsx("a",{href:"/signup",className:"default-btn-primary",children:"Sign Up Now"}),y.jsx("a",{href:"/contact",className:"default-btn-secondary",children:"Contact Us"})]})]})}),y.jsx("footer",{className:"default-footer",children:y.jsxs("div",{className:"default-container",children:[y.jsxs("div",{className:"default-footer-content",children:[y.jsxs("div",{className:"default-footer-section",children:[y.jsx("h4",{children:"BlueCarbon"}),y.jsx("p",{children:"Sustainable carbon credit trading platform"})]}),y.jsxs("div",{className:"default-footer-section",children:[y.jsx("h4",{children:"Quick Links"}),y.jsxs("ul",{children:[y.jsx("li",{children:y.jsx("a",{href:"/about",children:"About Us"})}),y.jsx("li",{children:y.jsx("a",{href:"/contact",children:"Contact"})}),y.jsx("li",{children:y.jsx("a",{href:"/dashboard",children:"Dashboard"})})]})]}),y.jsxs("div",{className:"default-footer-section",children:[y.jsx("h4",{children:"Get Started"}),y.jsxs("ul",{children:[y.jsx("li",{children:y.jsx("a",{href:"/login",children:"Sign In"})}),y.jsx("li",{children:y.jsx("a",{href:"/signup",children:"Sign Up"})})]})]})]}),y.jsx("div",{className:"default-footer-bottom",children:y.jsx("p",{children:" 2025 CarbonLens- team Cryptocoral. All rights reserved."})})]})})]})}function SY(){return y.jsxs("div",{className:"default-dashboard",children:[y.jsx(N1,{}),y.jsx("section",{className:"dashboard-header",children:y.jsxs("div",{className:"dashboard-container",children:[y.jsx("h1",{className:"dashboard-title",children:"BlueCarbon Platform Overview"}),y.jsx("p",{className:"dashboard-subtitle",children:"Explore carbon credit trading opportunities and environmental impact data"})]})}),y.jsx("section",{className:"dashboard-stats",children:y.jsx("div",{className:"dashboard-container",children:y.jsxs("div",{className:"stats-grid",children:[y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("h3",{className:"stat-number",children:"5"}),y.jsx("p",{className:"stat-label",children:"Active Projects"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("h3",{className:"stat-number",children:"Rs 120000"}),y.jsx("p",{className:"stat-label",children:"Credits Traded"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("h3",{className:"stat-number",children:"85 T"}),y.jsx("p",{className:"stat-label",children:"CO2 Tons Offset"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("h3",{className:"stat-number",children:"20"}),y.jsx("p",{className:"stat-label",children:"Registered Users"})]})]})]})})}),y.jsx("section",{className:"market-overview",children:y.jsxs("div",{className:"dashboard-container",children:[y.jsx("h2",{className:"section-title",children:"Market Overview"}),y.jsxs("div",{className:"market-grid",children:[y.jsxs("div",{className:"market-card",children:[y.jsx("h3",{children:"Recent Projects"}),y.jsxs("div",{className:"project-list",children:[y.jsxs("div",{className:"project-item",children:[y.jsx("span",{className:"project-name",children:"Sustainable Rice Farming"}),y.jsx("span",{className:"project-credits",children:"5 Credits"})]}),y.jsxs("div",{className:"project-item",children:[y.jsx("span",{className:"project-name",children:"Forest Conservation"}),y.jsx("span",{className:"project-credits",children:"18 Credits"})]}),y.jsxs("div",{className:"project-item",children:[y.jsx("span",{className:"project-name",children:"Solar Energy Initiative"}),y.jsx("span",{className:"project-credits",children:"6 Credits"})]})]})]}),y.jsxs("div",{className:"market-card",children:[y.jsx("h3",{children:"Price Trends"}),y.jsxs("div",{className:"price-info",children:[y.jsxs("div",{className:"price-item",children:[y.jsx("span",{className:"price-label",children:"Current Price"}),y.jsx("span",{className:"price-value",children:" 15.50/Credit"})]}),y.jsxs("div",{className:"price-item",children:[y.jsx("span",{className:"price-label",children:"24h Change"}),y.jsx("span",{className:"price-value positive",children:"0%"})]}),y.jsxs("div",{className:"price-item",children:[y.jsx("span",{className:"price-label",children:"Volume"}),y.jsx("span",{className:"price-value",children:"1,250 Credits"})]})]})]})]})]})}),y.jsx("section",{className:"dashboard-cta",children:y.jsx("div",{className:"dashboard-container",children:y.jsxs("div",{className:"cta-content",children:[y.jsx("h2",{children:"Ready to Get Started?"}),y.jsx("p",{children:"Join our platform to start trading carbon credits or list your sustainable projects"}),y.jsxs("div",{className:"cta-buttons",children:[y.jsx("a",{href:"/signup",className:"cta-btn primary",children:"Sign Up Now"}),y.jsx("a",{href:"/login",className:"cta-btn secondary",children:"Sign In"})]})]})})})]})}const EY=()=>{};var wO={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LF=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},NY=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],a=n[t++],o=n[t++],l=((r&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|a&63)}}return e.join("")},OF={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],a=r+1<n.length,o=a?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,h=i>>2,p=(i&3)<<4|o>>4;let m=(o&15)<<2|c>>6,v=c&63;l||(v=64,a||(m=64)),s.push(t[h],t[p],t[m],t[v])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(LF(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):NY(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],o=r<n.length?t[n.charAt(r)]:0;++r;const c=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||o==null||c==null||p==null)throw new IY;const m=i<<2|o>>4;if(s.push(m),c!==64){const v=o<<4&240|c>>2;if(s.push(v),p!==64){const x=c<<6&192|p;s.push(x)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class IY extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const CY=function(n){const e=LF(n);return OF.encodeByteArray(e,!0)},p0=function(n){return CY(n).replace(/\./g,"")},PF=function(n){try{return OF.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kY(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $Y=()=>kY().__FIREBASE_DEFAULTS__,AY=()=>{if(typeof process>"u"||typeof wO>"u")return;const n=wO.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},RY=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&PF(n[1]);return e&&JSON.parse(e)},I1=()=>{try{return EY()||$Y()||AY()||RY()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},MF=n=>I1()?.emulatorHosts?.[n],FF=n=>{const e=MF(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},jF=()=>I1()?.config,BF=n=>I1()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wh(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function SC(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zF(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[p0(JSON.stringify(t)),p0(JSON.stringify(a)),""].join(".")}const Ny={};function LY(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ny))Ny[e]?n.emulator.push(e):n.prod.push(e);return n}function OY(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let TO=!1;function EC(n,e){if(typeof window>"u"||typeof document>"u"||!Wh(window.location.host)||Ny[n]===e||Ny[n]||TO)return;Ny[n]=e;function t(m){return`__firebase__banner__${m}`}const s="__firebase__banner",i=LY().prod.length>0;function a(){const m=document.getElementById(s);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{TO=!0,a()},m}function h(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=OY(s),v=t("text"),x=document.getElementById(v)||document.createElement("span"),w=t("learnmore"),T=document.getElementById(w)||document.createElement("a"),E=t("preprendIcon"),C=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const $=m.element;o($),h(T,w);const R=c();l(C,E),$.append(C,x,T,R),document.body.appendChild($)}i?(x.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PY(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(hi())}function MY(){const n=I1()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function FY(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function jY(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function BY(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zY(){const n=hi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function VY(){return!MY()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UY(){try{return typeof indexedDB=="object"}catch{return!1}}function GY(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WY="FirebaseError";class rc extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=WY,Object.setPrototypeOf(this,rc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xv.prototype.create)}}class xv{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?HY(i,s):"Error",o=`${this.serviceName}: ${a} (${r}).`;return new rc(r,o,s)}}function HY(n,e){return n.replace(qY,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const qY=/\{\$([^}]+)}/g;function KY(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function cf(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],a=e[r];if(SO(i)&&SO(a)){if(!cf(i,a))return!1}else if(i!==a)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function SO(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function hy(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function dy(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function XY(n,e){const t=new ZY(n,e);return t.subscribe.bind(t)}class ZY{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let r;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");YY(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:s},r.next===void 0&&(r.next=RE),r.error===void 0&&(r.error=RE),r.complete===void 0&&(r.complete=RE);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function YY(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function RE(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(n){return n&&n._delegate?n._delegate:n}class Nh{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QY{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new DY;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(eQ(e))try{this.getOrInitializeService({instanceIdentifier:Vd})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Vd){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vd){return this.instances.has(e)}getOptions(e=Vd){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);s===o&&a.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:JY(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Vd){return this.component?this.component.multipleInstances?e:Vd:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JY(n){return n===Vd?void 0:n}function eQ(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tQ{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new QY(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var en;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(en||(en={}));const nQ={debug:en.DEBUG,verbose:en.VERBOSE,info:en.INFO,warn:en.WARN,error:en.ERROR,silent:en.SILENT},sQ=en.INFO,rQ={[en.DEBUG]:"log",[en.VERBOSE]:"log",[en.INFO]:"info",[en.WARN]:"warn",[en.ERROR]:"error"},iQ=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=rQ[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let NC=class{constructor(e){this.name=e,this._logLevel=sQ,this._logHandler=iQ,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in en))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nQ[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,en.DEBUG,...e),this._logHandler(this,en.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,en.VERBOSE,...e),this._logHandler(this,en.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,en.INFO,...e),this._logHandler(this,en.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,en.WARN,...e),this._logHandler(this,en.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,en.ERROR,...e),this._logHandler(this,en.ERROR,...e)}};const aQ=(n,e)=>e.some(t=>n instanceof t);let EO,NO;function oQ(){return EO||(EO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function lQ(){return NO||(NO=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const VF=new WeakMap,NN=new WeakMap,UF=new WeakMap,DE=new WeakMap,IC=new WeakMap;function cQ(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(yh(n.result)),r()},a=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&VF.set(t,n)}).catch(()=>{}),IC.set(e,n),e}function uQ(n){if(NN.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),r()},a=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});NN.set(n,e)}let IN={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return NN.get(n);if(e==="objectStoreNames")return n.objectStoreNames||UF.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return yh(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function hQ(n){IN=n(IN)}function dQ(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(LE(this),e,...t);return UF.set(s,e.sort?e.sort():[e]),yh(s)}:lQ().includes(n)?function(...e){return n.apply(LE(this),e),yh(VF.get(this))}:function(...e){return yh(n.apply(LE(this),e))}}function fQ(n){return typeof n=="function"?dQ(n):(n instanceof IDBTransaction&&uQ(n),aQ(n,oQ())?new Proxy(n,IN):n)}function yh(n){if(n instanceof IDBRequest)return cQ(n);if(DE.has(n))return DE.get(n);const e=fQ(n);return e!==n&&(DE.set(n,e),IC.set(e,n)),e}const LE=n=>IC.get(n);function pQ(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const a=indexedDB.open(n,e),o=yh(a);return s&&a.addEventListener("upgradeneeded",l=>{s(yh(a.result),l.oldVersion,l.newVersion,yh(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const mQ=["get","getKey","getAll","getAllKeys","count"],gQ=["put","add","delete","clear"],OE=new Map;function IO(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(OE.get(e))return OE.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=gQ.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||mQ.includes(t)))return;const i=async function(a,...o){const l=this.transaction(a,r?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),r&&l.done]))[0]};return OE.set(e,i),i}hQ(n=>({...n,get:(e,t,s)=>IO(e,t)||n.get(e,t,s),has:(e,t)=>!!IO(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yQ{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(vQ(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function vQ(n){return n.getComponent()?.type==="VERSION"}const CN="@firebase/app",CO="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=new NC("@firebase/app"),bQ="@firebase/app-compat",_Q="@firebase/analytics-compat",xQ="@firebase/analytics",wQ="@firebase/app-check-compat",TQ="@firebase/app-check",SQ="@firebase/auth",EQ="@firebase/auth-compat",NQ="@firebase/database",IQ="@firebase/data-connect",CQ="@firebase/database-compat",kQ="@firebase/functions",$Q="@firebase/functions-compat",AQ="@firebase/installations",RQ="@firebase/installations-compat",DQ="@firebase/messaging",LQ="@firebase/messaging-compat",OQ="@firebase/performance",PQ="@firebase/performance-compat",MQ="@firebase/remote-config",FQ="@firebase/remote-config-compat",jQ="@firebase/storage",BQ="@firebase/storage-compat",zQ="@firebase/firestore",VQ="@firebase/ai",UQ="@firebase/firestore-compat",GQ="firebase",WQ="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN="[DEFAULT]",HQ={[CN]:"fire-core",[bQ]:"fire-core-compat",[xQ]:"fire-analytics",[_Q]:"fire-analytics-compat",[TQ]:"fire-app-check",[wQ]:"fire-app-check-compat",[SQ]:"fire-auth",[EQ]:"fire-auth-compat",[NQ]:"fire-rtdb",[IQ]:"fire-data-connect",[CQ]:"fire-rtdb-compat",[kQ]:"fire-fn",[$Q]:"fire-fn-compat",[AQ]:"fire-iid",[RQ]:"fire-iid-compat",[DQ]:"fire-fcm",[LQ]:"fire-fcm-compat",[OQ]:"fire-perf",[PQ]:"fire-perf-compat",[MQ]:"fire-rc",[FQ]:"fire-rc-compat",[jQ]:"fire-gcs",[BQ]:"fire-gcs-compat",[zQ]:"fire-fst",[UQ]:"fire-fst-compat",[VQ]:"fire-vertex","fire-js":"fire-js",[GQ]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0=new Map,qQ=new Map,$N=new Map;function kO(n,e){try{n.container.addComponent(e)}catch(t){Xc.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function uf(n){const e=n.name;if($N.has(e))return Xc.debug(`There were multiple attempts to register component ${e}.`),!1;$N.set(e,n);for(const t of m0.values())kO(t,n);for(const t of qQ.values())kO(t,n);return!0}function C1(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ea(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KQ={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},vh=new xv("app","Firebase",KQ);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XQ{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Nh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vh.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ff=WQ;function GF(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:kN,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw vh.create("bad-app-name",{appName:String(r)});if(t||(t=jF()),!t)throw vh.create("no-options");const i=m0.get(r);if(i){if(cf(t,i.options)&&cf(s,i.config))return i;throw vh.create("duplicate-app",{appName:r})}const a=new tQ(r);for(const l of $N.values())a.addComponent(l);const o=new XQ(t,s,a);return m0.set(r,o),o}function CC(n=kN){const e=m0.get(n);if(!e&&n===kN&&jF())return GF();if(!e)throw vh.create("no-app",{appName:n});return e}function $l(n,e,t){let s=HQ[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const a=[`Unable to register library "${s}" with version "${e}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xc.warn(a.join(" "));return}uf(new Nh(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZQ="firebase-heartbeat-database",YQ=1,Fy="firebase-heartbeat-store";let PE=null;function WF(){return PE||(PE=pQ(ZQ,YQ,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Fy)}catch(t){console.warn(t)}}}}).catch(n=>{throw vh.create("idb-open",{originalErrorMessage:n.message})})),PE}async function QQ(n){try{const t=(await WF()).transaction(Fy),s=await t.objectStore(Fy).get(HF(n));return await t.done,s}catch(e){if(e instanceof rc)Xc.warn(e.message);else{const t=vh.create("idb-get",{originalErrorMessage:e?.message});Xc.warn(t.message)}}}async function $O(n,e){try{const s=(await WF()).transaction(Fy,"readwrite");await s.objectStore(Fy).put(e,HF(n)),await s.done}catch(t){if(t instanceof rc)Xc.warn(t.message);else{const s=vh.create("idb-set",{originalErrorMessage:t?.message});Xc.warn(s.message)}}}function HF(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JQ=1024,eJ=30;class tJ{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new sJ(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=AO();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>eJ){const r=rJ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=AO(),{heartbeatsToSend:t,unsentEntries:s}=nJ(this._heartbeatsCache.heartbeats),r=p0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Xc.warn(e),""}}}function AO(){return new Date().toISOString().substring(0,10)}function nJ(n,e=JQ){const t=[];let s=n.slice();for(const r of n){const i=t.find(a=>a.agent===r.agent);if(i){if(i.dates.push(r.date),RO(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),RO(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class sJ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UY()?GY().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await QQ(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return $O(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return $O(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function RO(n){return p0(JSON.stringify({version:2,heartbeats:n})).length}function rJ(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iJ(n){uf(new Nh("platform-logger",e=>new yQ(e),"PRIVATE")),uf(new Nh("heartbeat",e=>new tJ(e),"PRIVATE")),$l(CN,CO,n),$l(CN,CO,"esm2020"),$l("fire-js","")}iJ("");var aJ="firebase",oJ="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$l(aJ,oJ,"app");function qF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lJ=qF,KF=new xv("auth","Firebase",qF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0=new NC("@firebase/auth");function cJ(n,...e){g0.logLevel<=en.WARN&&g0.warn(`Auth (${Ff}): ${n}`,...e)}function zx(n,...e){g0.logLevel<=en.ERROR&&g0.error(`Auth (${Ff}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ho(n,...e){throw kC(n,...e)}function Al(n,...e){return kC(n,...e)}function XF(n,e,t){const s={...lJ(),[e]:t};return new xv("auth","Firebase",s).create(e,{appName:n.name})}function Gc(n){return XF(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kC(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return KF.create(n,...e)}function Et(n,e,...t){if(!n)throw kC(e,...t)}function Bc(n){const e="INTERNAL ASSERTION FAILED: "+n;throw zx(e),new Error(e)}function Zc(n,e){n||Bc(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(){return typeof self<"u"&&self.location?.href||""}function uJ(){return DO()==="http:"||DO()==="https:"}function DO(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hJ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(uJ()||jY()||"connection"in navigator)?navigator.onLine:!0}function dJ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zc(t>e,"Short delay should be less than long delay!"),this.isMobile=PY()||BY()}get(){return hJ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(n,e){Zc(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fJ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pJ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],mJ=new Tv(3e4,6e4);function Hh(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function qh(n,e,t,s,r={}){return YF(n,r,async()=>{let i={},a={};s&&(e==="GET"?a=s:i={body:JSON.stringify(s)});const o=wv({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...i};return FY()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Wh(n.emulatorConfig.host)&&(c.credentials="include"),ZF.fetch()(await QF(n,n.config.apiHost,t,o),c)})}async function YF(n,e,t){n._canInitEmulator=!1;const s={...fJ,...e};try{const r=new yJ(n),i=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw gx(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw gx(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw gx(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw gx(n,"user-disabled",a);const h=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw XF(n,h,c);Ho(n,h)}}catch(r){if(r instanceof rc)throw r;Ho(n,"network-request-failed",{message:String(r)})}}async function Sv(n,e,t,s,r={}){const i=await qh(n,e,t,s,r);return"mfaPendingCredential"in i&&Ho(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function QF(n,e,t,s){const r=`${e}${t}?${s}`,i=n,a=i.config.emulator?$C(n.config,r):`${n.config.apiScheme}://${r}`;return pJ.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function gJ(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class yJ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Al(this.auth,"network-request-failed")),mJ.get())})}}function gx(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const r=Al(n,e,s);return r.customData._tokenResponse=t,r}function LO(n){return n!==void 0&&n.enterprise!==void 0}class vJ{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return gJ(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function bJ(n,e){return qh(n,"GET","/v2/recaptchaConfig",Hh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _J(n,e){return qh(n,"POST","/v1/accounts:delete",e)}async function y0(n,e){return qh(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function xJ(n,e=!1){const t=Ms(n),s=await t.getIdToken(e),r=AC(s);Et(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,a=i?.sign_in_provider;return{claims:r,token:s,authTime:Iy(ME(r.auth_time)),issuedAtTime:Iy(ME(r.iat)),expirationTime:Iy(ME(r.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function ME(n){return Number(n)*1e3}function AC(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return zx("JWT malformed, contained fewer than 3 sections"),null;try{const r=PF(t);return r?JSON.parse(r):(zx("Failed to decode base64 JWT payload"),null)}catch(r){return zx("Caught error parsing JWT payload as JSON",r?.toString()),null}}function OO(n){const e=AC(n);return Et(e,"internal-error"),Et(typeof e.exp<"u","internal-error"),Et(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jy(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof rc&&wJ(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function wJ({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TJ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Iy(this.lastLoginAt),this.creationTime=Iy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v0(n){const e=n.auth,t=await n.getIdToken(),s=await jy(n,y0(e,{idToken:t}));Et(s?.users.length,e,"internal-error");const r=s.users[0];n._notifyReloadListener(r);const i=r.providerUserInfo?.length?JF(r.providerUserInfo):[],a=EJ(n.providerData,i),o=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!a?.length,c=o?l:!1,h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new RN(r.createdAt,r.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function SJ(n){const e=Ms(n);await v0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function EJ(n,e){return[...n.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function JF(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NJ(n,e){const t=await YF(n,{},async()=>{const s=wv({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=n.config,a=await QF(n,r,"/v1/token",`key=${i}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:s};return n.emulatorConfig&&Wh(n.emulatorConfig.host)&&(l.credentials="include"),ZF.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function IJ(n,e){return qh(n,"POST","/v2/accounts:revokeToken",Hh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Et(e.idToken,"internal-error"),Et(typeof e.idToken<"u","internal-error"),Et(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):OO(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Et(e.length!==0,"internal-error");const t=OO(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Et(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:r,expiresIn:i}=await NJ(e,t);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:r,expirationTime:i}=t,a=new Jp;return s&&(Et(typeof s=="string","internal-error",{appName:e}),a.refreshToken=s),r&&(Et(typeof r=="string","internal-error",{appName:e}),a.accessToken=r),i&&(Et(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Jp,this.toJSON())}_performRefresh(){return Bc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(n,e){Et(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class jo{constructor({uid:e,auth:t,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new TJ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new RN(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await jy(this,this.stsTokenManager.getToken(this.auth,e));return Et(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return xJ(this,e)}reload(){return SJ(this)}_assign(e){this!==e&&(Et(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new jo({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Et(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await v0(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ea(this.auth.app))return Promise.reject(Gc(this.auth));const e=await this.getIdToken();return await jy(this,_J(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,r=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:v,providerData:x,stsTokenManager:w}=t;Et(p&&w,e,"internal-error");const T=Jp.fromJSON(this.name,w);Et(typeof p=="string",e,"internal-error"),eh(s,e.name),eh(r,e.name),Et(typeof m=="boolean",e,"internal-error"),Et(typeof v=="boolean",e,"internal-error"),eh(i,e.name),eh(a,e.name),eh(o,e.name),eh(l,e.name),eh(c,e.name),eh(h,e.name);const E=new jo({uid:p,auth:e,email:r,emailVerified:m,displayName:s,isAnonymous:v,photoURL:a,phoneNumber:i,tenantId:o,stsTokenManager:T,createdAt:c,lastLoginAt:h});return x&&Array.isArray(x)&&(E.providerData=x.map(C=>({...C}))),l&&(E._redirectEventId=l),E}static async _fromIdTokenResponse(e,t,s=!1){const r=new Jp;r.updateFromServerResponse(t);const i=new jo({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await v0(i),i}static async _fromGetAccountInfoResponse(e,t,s){const r=t.users[0];Et(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?JF(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!i?.length,o=new Jp;o.updateFromIdToken(s);const l=new jo({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new RN(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!i?.length};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO=new Map;function zc(n){Zc(n instanceof Function,"Expected a class definition");let e=PO.get(n);return e?(Zc(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,PO.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ej.type="NONE";const MO=ej;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vx(n,e,t){return`firebase:${n}:${e}:${t}`}class em{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=Vx(this.userKey,r.apiKey,i),this.fullPersistenceKey=Vx("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await y0(this.auth,{idToken:e}).catch(()=>{});return t?jo._fromGetAccountInfoResponse(this.auth,t,e):null}return jo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new em(zc(MO),e,s);const r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=r[0]||zc(MO);const a=Vx(s,e.config.apiKey,e.name);let o=null;for(const c of t)try{const h=await c._get(a);if(h){let p;if(typeof h=="string"){const m=await y0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await jo._fromGetAccountInfoResponse(e,m,h)}else p=jo._fromJSON(e,h);c!==i&&(o=p),i=c;break}}catch{}const l=r.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new em(i,e,s):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new em(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rj(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tj(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(aj(e))return"Blackberry";if(oj(e))return"Webos";if(nj(e))return"Safari";if((e.includes("chrome/")||sj(e))&&!e.includes("edge/"))return"Chrome";if(ij(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function tj(n=hi()){return/firefox\//i.test(n)}function nj(n=hi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function sj(n=hi()){return/crios\//i.test(n)}function rj(n=hi()){return/iemobile/i.test(n)}function ij(n=hi()){return/android/i.test(n)}function aj(n=hi()){return/blackberry/i.test(n)}function oj(n=hi()){return/webos/i.test(n)}function RC(n=hi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function CJ(n=hi()){return RC(n)&&!!window.navigator?.standalone}function kJ(){return zY()&&document.documentMode===10}function lj(n=hi()){return RC(n)||ij(n)||oj(n)||aj(n)||/windows phone/i.test(n)||rj(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(n,e=[]){let t;switch(n){case"Browser":t=FO(hi());break;case"Worker":t=`${FO(hi())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ff}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $J{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});s.onAbort=t,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AJ(n,e={}){return qh(n,"GET","/v2/passwordPolicy",Hh(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RJ=6;class DJ{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??RJ,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LJ{constructor(e,t,s,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jO(this),this.idTokenSubscription=new jO(this),this.beforeStateQueue=new $J(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=KF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zc(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await em.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await y0(this,{idToken:e}),s=await jo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ea(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=s?._redirectEventId,o=await this.tryRedirectSignIn(e);(!i||i===a)&&o?.user&&(s=o.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Et(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await v0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=dJ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ea(this.app))return Promise.reject(Gc(this));const t=e?Ms(e):null;return t&&Et(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Et(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ea(this.app)?Promise.reject(Gc(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ea(this.app)?Promise.reject(Gc(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zc(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await AJ(this),t=new DJ(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xv("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await IJ(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&zc(e)||this._popupRedirectResolver;Et(t,this,"argument-error"),this.redirectPersistenceManager=await em.create(this,[zc(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,r){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Et(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,s,r);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Et(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=cj(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Ea(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&cJ(`Error while retrieving App Check token: ${e.error}`),e?.token}}function jf(n){return Ms(n)}class jO{constructor(e){this.auth=e,this.observer=null,this.addObserver=XY(t=>this.observer=t)}get next(){return Et(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let k1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function OJ(n){k1=n}function uj(n){return k1.loadJS(n)}function PJ(){return k1.recaptchaEnterpriseScript}function MJ(){return k1.gapiScript}function FJ(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class jJ{constructor(){this.enterprise=new BJ}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class BJ{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const zJ="recaptcha-enterprise",hj="NO_RECAPTCHA";class VJ{constructor(e){this.type=zJ,this.auth=jf(e)}async verify(e="verify",t=!1){async function s(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{bJ(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new vJ(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function r(i,a,o){const l=window.grecaptcha;LO(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{a(c)}).catch(()=>{a(hj)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jJ().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{s(this.auth).then(o=>{if(!t&&LO(window.grecaptcha))r(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=PJ();l.length!==0&&(l+=o),uj(l).then(()=>{r(o,i,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function BO(n,e,t,s=!1,r=!1){const i=new VJ(n);let a;if(r)a=hj;else try{a=await i.verify(t)}catch{a=await i.verify(t,!0)}const o={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,c=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return s?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function DN(n,e,t,s,r){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await BO(n,e,t,t==="getOobCode");return s(n,i)}else return s(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await BO(n,e,t,t==="getOobCode");return s(n,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UJ(n,e){const t=C1(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),i=t.getOptions();if(cf(i,e??{}))return r;Ho(r,"already-initialized")}return t.initialize({options:e})}function GJ(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(zc);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function WJ(n,e,t){const s=jf(n);Et(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=dj(e),{host:a,port:o}=HJ(e),l=o===null?"":`:${o}`,c={url:`${i}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){Et(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Et(cf(c,s.config.emulator)&&cf(h,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=c,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,Wh(a)?(SC(`${i}//${a}${l}`),EC("Auth",!0)):qJ()}function dj(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function HJ(n){const e=dj(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:zO(s.substr(i.length+1))}}else{const[i,a]=s.split(":");return{host:i,port:zO(a)}}}function zO(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function qJ(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Bc("not implemented")}_getIdTokenResponse(e){return Bc("not implemented")}_linkToIdToken(e,t){return Bc("not implemented")}_getReauthenticationResolver(e){return Bc("not implemented")}}async function KJ(n,e){return qh(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XJ(n,e){return Sv(n,"POST","/v1/accounts:signInWithPassword",Hh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZJ(n,e){return Sv(n,"POST","/v1/accounts:signInWithEmailLink",Hh(n,e))}async function YJ(n,e){return Sv(n,"POST","/v1/accounts:signInWithEmailLink",Hh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By extends DC{constructor(e,t,s,r=null){super("password",s),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new By(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new By(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return DN(e,t,"signInWithPassword",XJ);case"emailLink":return ZJ(e,{email:this._email,oobCode:this._password});default:Ho(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return DN(e,s,"signUpPassword",KJ);case"emailLink":return YJ(e,{idToken:t,email:this._email,oobCode:this._password});default:Ho(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tm(n,e){return Sv(n,"POST","/v1/accounts:signInWithIdp",Hh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QJ="http://localhost";class hf extends DC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ho("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...i}=t;if(!s||!r)return null;const a=new hf(s,r);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return tm(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,tm(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,tm(e,t)}buildRequest(){const e={requestUri:QJ,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=wv(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JJ(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function eee(n){const e=hy(dy(n)).link,t=e?hy(dy(e)).deep_link_id:null,s=hy(dy(n)).deep_link_id;return(s?hy(dy(s)).link:null)||s||t||e||n}class LC{constructor(e){const t=hy(dy(e)),s=t.apiKey??null,r=t.oobCode??null,i=JJ(t.mode??null);Et(s&&r&&i,"argument-error"),this.apiKey=s,this.operation=i,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=eee(e);try{return new LC(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(){this.providerId=jm.PROVIDER_ID}static credential(e,t){return By._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=LC.parseLink(t);return Et(s,"argument-error"),By._fromEmailAndCode(e,s.code,s.tenantId)}}jm.PROVIDER_ID="password";jm.EMAIL_PASSWORD_SIGN_IN_METHOD="password";jm.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev extends fj{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh extends Ev{constructor(){super("facebook.com")}static credential(e){return hf._fromParams({providerId:rh.PROVIDER_ID,signInMethod:rh.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rh.credentialFromTaggedObject(e)}static credentialFromError(e){return rh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return rh.credential(e.oauthAccessToken)}catch{return null}}}rh.FACEBOOK_SIGN_IN_METHOD="facebook.com";rh.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih extends Ev{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hf._fromParams({providerId:ih.PROVIDER_ID,signInMethod:ih.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ih.credentialFromTaggedObject(e)}static credentialFromError(e){return ih.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return ih.credential(t,s)}catch{return null}}}ih.GOOGLE_SIGN_IN_METHOD="google.com";ih.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah extends Ev{constructor(){super("github.com")}static credential(e){return hf._fromParams({providerId:ah.PROVIDER_ID,signInMethod:ah.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ah.credentialFromTaggedObject(e)}static credentialFromError(e){return ah.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ah.credential(e.oauthAccessToken)}catch{return null}}}ah.GITHUB_SIGN_IN_METHOD="github.com";ah.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh extends Ev{constructor(){super("twitter.com")}static credential(e,t){return hf._fromParams({providerId:oh.PROVIDER_ID,signInMethod:oh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return oh.credentialFromTaggedObject(e)}static credentialFromError(e){return oh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return oh.credential(t,s)}catch{return null}}}oh.TWITTER_SIGN_IN_METHOD="twitter.com";oh.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tee(n,e){return Sv(n,"POST","/v1/accounts:signUp",Hh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,r=!1){const i=await jo._fromIdTokenResponse(e,s,r),a=VO(s);return new df({user:i,providerId:a,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const r=VO(s);return new df({user:e,providerId:r,_tokenResponse:s,operationType:t})}}function VO(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0 extends rc{constructor(e,t,s,r){super(t.code,t.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,b0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,r){return new b0(e,t,s,r)}}function pj(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?b0._fromErrorAndOperation(n,i,e,s):i})}async function nee(n,e,t=!1){const s=await jy(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return df._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function see(n,e,t=!1){const{auth:s}=n;if(Ea(s.app))return Promise.reject(Gc(s));const r="reauthenticate";try{const i=await jy(n,pj(s,r,e,n),t);Et(i.idToken,s,"internal-error");const a=AC(i.idToken);Et(a,s,"internal-error");const{sub:o}=a;return Et(n.uid===o,s,"user-mismatch"),df._forOperation(n,r,i)}catch(i){throw i?.code==="auth/user-not-found"&&Ho(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mj(n,e,t=!1){if(Ea(n.app))return Promise.reject(Gc(n));const s="signIn",r=await pj(n,s,e),i=await df._fromIdTokenResponse(n,s,r);return t||await n._updateCurrentUser(i.user),i}async function ree(n,e){return mj(jf(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gj(n){const e=jf(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function iee(n,e,t){if(Ea(n.app))return Promise.reject(Gc(n));const s=jf(n),a=await DN(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tee).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&gj(n),l}),o=await df._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(o.user),o}function aee(n,e,t){return Ea(n.app)?Promise.reject(Gc(n)):ree(Ms(n),jm.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&gj(n),s})}function oee(n,e,t,s){return Ms(n).onIdTokenChanged(e,t,s)}function lee(n,e,t){return Ms(n).beforeAuthStateChanged(e,t)}function OC(n,e,t,s){return Ms(n).onAuthStateChanged(e,t,s)}const _0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(_0,"1"),this.storage.removeItem(_0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cee=1e3,uee=10;class vj extends yj{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=lj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),r=this.localCache[t];s!==r&&e(t,r,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const s=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const a=this.storage.getItem(s);!t&&this.localCache[s]===a||this.notifyListeners(s,a)},i=this.storage.getItem(s);kJ()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,uee):r()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},cee)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}vj.type="LOCAL";const hee=vj;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj extends yj{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}bj.type="SESSION";const _j=bj;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dee(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const s=new $1(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:r,data:i}=t.data,a=this.handlersMap[r];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const o=Array.from(a).map(async c=>c(t.origin,i)),l=await dee(o);t.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$1.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PC(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fee{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=PC("",20);r.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},s);a={messageChannel:r,onMessage(p){const m=p;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(){return window}function pee(n){Rl().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(){return typeof Rl().WorkerGlobalScope<"u"&&typeof Rl().importScripts=="function"}async function mee(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function gee(){return navigator?.serviceWorker?.controller||null}function yee(){return xj()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj="firebaseLocalStorageDb",vee=1,x0="firebaseLocalStorage",Tj="fbase_key";class Nv{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function A1(n,e){return n.transaction([x0],e?"readwrite":"readonly").objectStore(x0)}function bee(){const n=indexedDB.deleteDatabase(wj);return new Nv(n).toPromise()}function LN(){const n=indexedDB.open(wj,vee);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(x0,{keyPath:Tj})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(x0)?e(s):(s.close(),await bee(),e(await LN()))})})}async function UO(n,e,t){const s=A1(n,!0).put({[Tj]:e,value:t});return new Nv(s).toPromise()}async function _ee(n,e){const t=A1(n,!1).get(e),s=await new Nv(t).toPromise();return s===void 0?null:s.value}function GO(n,e){const t=A1(n,!0).delete(e);return new Nv(t).toPromise()}const xee=800,wee=3;class Sj{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await LN(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>wee)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xj()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$1._getInstance(yee()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await mee(),!this.activeServiceWorker)return;this.sender=new fee(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||gee()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await LN();return await UO(e,_0,"1"),await GO(e,_0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>UO(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>_ee(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>GO(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=A1(r,!1).getAll();return new Nv(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),xee)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Sj.type="LOCAL";const Tee=Sj;new Tv(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function See(n,e){return e?zc(e):(Et(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC extends DC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return tm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return tm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Eee(n){return mj(n.auth,new MC(n),n.bypassAuthState)}function Nee(n){const{auth:e,user:t}=n;return Et(t,e,"internal-error"),see(t,new MC(n),n.bypassAuthState)}async function Iee(n){const{auth:e,user:t}=n;return Et(t,e,"internal-error"),nee(t,new MC(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e,t,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:r,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Eee;case"linkViaPopup":case"linkViaRedirect":return Iee;case"reauthViaPopup":case"reauthViaRedirect":return Nee;default:Ho(this.auth,"internal-error")}}resolve(e){Zc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cee=new Tv(2e3,1e4);class Zp extends Ej{constructor(e,t,s,r,i){super(e,t,r,i),this.provider=s,this.authWindow=null,this.pollId=null,Zp.currentPopupAction&&Zp.currentPopupAction.cancel(),Zp.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Et(e,this.auth,"internal-error"),e}async onExecution(){Zc(this.filter.length===1,"Popup operations only handle one event");const e=PC();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Al(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Al(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zp.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Al(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Cee.get())};e()}}Zp.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kee="pendingRedirect",Ux=new Map;class $ee extends Ej{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Ux.get(this.auth._key());if(!e){try{const s=await Aee(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Ux.set(this.auth._key(),e)}return this.bypassAuthState||Ux.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Aee(n,e){const t=Lee(e),s=Dee(n);if(!await s._isAvailable())return!1;const r=await s._get(t)==="true";return await s._remove(t),r}function Ree(n,e){Ux.set(n._key(),e)}function Dee(n){return zc(n._redirectPersistence)}function Lee(n){return Vx(kee,n.config.apiKey,n.name)}async function Oee(n,e,t=!1){if(Ea(n.app))return Promise.reject(Gc(n));const s=jf(n),r=See(s,e),a=await new $ee(s,r,t).execute();return a&&!t&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pee=600*1e3;class Mee{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Fee(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Nj(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Al(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Pee&&this.cachedEventUids.clear(),this.cachedEventUids.has(WO(e))}saveEventToCache(e){this.cachedEventUids.add(WO(e)),this.lastProcessedEventTime=Date.now()}}function WO(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Nj({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Fee(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Nj(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jee(n,e={}){return qh(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bee=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zee=/^https?/;async function Vee(n){if(n.config.emulator)return;const{authorizedDomains:e}=await jee(n);for(const t of e)try{if(Uee(t))return}catch{}Ho(n,"unauthorized-domain")}function Uee(n){const e=AN(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===s}if(!zee.test(t))return!1;if(Bee.test(n))return s===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gee=new Tv(3e4,6e4);function HO(){const n=Rl().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Wee(n){return new Promise((e,t)=>{function s(){HO(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{HO(),t(Al(n,"network-request-failed"))},timeout:Gee.get()})}if(Rl().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Rl().gapi?.load)s();else{const r=FJ("iframefcb");return Rl()[r]=()=>{gapi.load?s():t(Al(n,"network-request-failed"))},uj(`${MJ()}?onload=${r}`).catch(i=>t(i))}}).catch(e=>{throw Gx=null,e})}let Gx=null;function Hee(n){return Gx=Gx||Wee(n),Gx}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qee=new Tv(5e3,15e3),Kee="__/auth/iframe",Xee="emulator/auth/iframe",Zee={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Yee=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Qee(n){const e=n.config;Et(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?$C(e,Xee):`https://${n.config.authDomain}/${Kee}`,s={apiKey:e.apiKey,appName:n.name,v:Ff},r=Yee.get(n.config.apiHost);r&&(s.eid=r);const i=n._getFrameworks();return i.length&&(s.fw=i.join(",")),`${t}?${wv(s).slice(1)}`}async function Jee(n){const e=await Hee(n),t=Rl().gapi;return Et(t,n,"internal-error"),e.open({where:document.body,url:Qee(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Zee,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const a=Al(n,"network-request-failed"),o=Rl().setTimeout(()=>{i(a)},qee.get());function l(){Rl().clearTimeout(o),r(s)}s.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ete={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},tte=500,nte=600,ste="_blank",rte="http://localhost";class qO{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ite(n,e,t,s=tte,r=nte){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let o="";const l={...ete,width:s.toString(),height:r.toString(),top:i,left:a},c=hi().toLowerCase();t&&(o=sj(c)?ste:t),tj(c)&&(e=e||rte,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[v,x])=>`${m}${v}=${x},`,"");if(CJ(c)&&o!=="_self")return ate(e||"",o),new qO(null);const p=window.open(e||"",o,h);Et(p,n,"popup-blocked");try{p.focus()}catch{}return new qO(p)}function ate(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ote="__/auth/handler",lte="emulator/auth/handler",cte=encodeURIComponent("fac");async function KO(n,e,t,s,r,i){Et(n.config.authDomain,n,"auth-domain-config-required"),Et(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Ff,eventId:r};if(e instanceof fj){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",KY(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))a[h]=p}if(e instanceof Ev){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),c=l?`#${cte}=${encodeURIComponent(l)}`:"";return`${ute(n)}?${wv(o).slice(1)}${c}`}function ute({config:n}){return n.emulator?$C(n,lte):`https://${n.authDomain}/${ote}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE="webStorageSupport";class hte{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_j,this._completeRedirectFn=Oee,this._overrideRedirectResult=Ree}async _openPopup(e,t,s,r){Zc(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await KO(e,t,s,AN(),r);return ite(e,i,PC())}async _openRedirect(e,t,s,r){await this._originValidation(e);const i=await KO(e,t,s,AN(),r);return pee(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:i}=this.eventManagers[t];return r?Promise.resolve(r):(Zc(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await Jee(e),s=new Mee(e);return t.register("authEvent",r=>(Et(r?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(FE,{type:FE},r=>{const i=r?.[0]?.[FE];i!==void 0&&t(!!i),Ho(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Vee(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return lj()||nj()||RC()}}const dte=hte;var XO="@firebase/auth",ZO="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fte{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Et(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pte(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mte(n){uf(new Nh("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=s.options;Et(a&&!a.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:cj(n)},c=new LJ(s,r,i,l);return GJ(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),uf(new Nh("auth-internal",e=>{const t=jf(e.getProvider("auth").getImmediate());return(s=>new fte(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),$l(XO,ZO,pte(n)),$l(XO,ZO,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gte=300,yte=BF("authIdTokenMaxAge")||gte;let YO=null;const vte=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>yte)return;const r=t?.token;YO!==r&&(YO=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function bte(n=CC()){const e=C1(n,"auth");if(e.isInitialized())return e.getImmediate();const t=UJ(n,{popupRedirectResolver:dte,persistence:[Tee,hee,_j]}),s=BF("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const a=vte(i.toString());lee(t,a,()=>a(t.currentUser)),oee(t,o=>a(o))}}const r=MF("auth");return r&&WJ(t,`http://${r}`),t}function _te(){return document.getElementsByTagName("head")?.[0]??document}OJ({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=r=>{const i=Al("internal-error");i.customData=r,t(i)},s.type="text/javascript",s.charset="UTF-8",_te().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mte("Browser");var QO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bh,Ij;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(j,O){function M(){}M.prototype=O.prototype,j.F=O.prototype,j.prototype=new M,j.prototype.constructor=j,j.D=function(B,D,W){for(var H=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)H[ae-2]=arguments[ae];return O.prototype[D].apply(B,H)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(j,O,M){M||(M=0);const B=Array(16);if(typeof O=="string")for(var D=0;D<16;++D)B[D]=O.charCodeAt(M++)|O.charCodeAt(M++)<<8|O.charCodeAt(M++)<<16|O.charCodeAt(M++)<<24;else for(D=0;D<16;++D)B[D]=O[M++]|O[M++]<<8|O[M++]<<16|O[M++]<<24;O=j.g[0],M=j.g[1],D=j.g[2];let W=j.g[3],H;H=O+(W^M&(D^W))+B[0]+3614090360&4294967295,O=M+(H<<7&4294967295|H>>>25),H=W+(D^O&(M^D))+B[1]+3905402710&4294967295,W=O+(H<<12&4294967295|H>>>20),H=D+(M^W&(O^M))+B[2]+606105819&4294967295,D=W+(H<<17&4294967295|H>>>15),H=M+(O^D&(W^O))+B[3]+3250441966&4294967295,M=D+(H<<22&4294967295|H>>>10),H=O+(W^M&(D^W))+B[4]+4118548399&4294967295,O=M+(H<<7&4294967295|H>>>25),H=W+(D^O&(M^D))+B[5]+1200080426&4294967295,W=O+(H<<12&4294967295|H>>>20),H=D+(M^W&(O^M))+B[6]+2821735955&4294967295,D=W+(H<<17&4294967295|H>>>15),H=M+(O^D&(W^O))+B[7]+4249261313&4294967295,M=D+(H<<22&4294967295|H>>>10),H=O+(W^M&(D^W))+B[8]+1770035416&4294967295,O=M+(H<<7&4294967295|H>>>25),H=W+(D^O&(M^D))+B[9]+2336552879&4294967295,W=O+(H<<12&4294967295|H>>>20),H=D+(M^W&(O^M))+B[10]+4294925233&4294967295,D=W+(H<<17&4294967295|H>>>15),H=M+(O^D&(W^O))+B[11]+2304563134&4294967295,M=D+(H<<22&4294967295|H>>>10),H=O+(W^M&(D^W))+B[12]+1804603682&4294967295,O=M+(H<<7&4294967295|H>>>25),H=W+(D^O&(M^D))+B[13]+4254626195&4294967295,W=O+(H<<12&4294967295|H>>>20),H=D+(M^W&(O^M))+B[14]+2792965006&4294967295,D=W+(H<<17&4294967295|H>>>15),H=M+(O^D&(W^O))+B[15]+1236535329&4294967295,M=D+(H<<22&4294967295|H>>>10),H=O+(D^W&(M^D))+B[1]+4129170786&4294967295,O=M+(H<<5&4294967295|H>>>27),H=W+(M^D&(O^M))+B[6]+3225465664&4294967295,W=O+(H<<9&4294967295|H>>>23),H=D+(O^M&(W^O))+B[11]+643717713&4294967295,D=W+(H<<14&4294967295|H>>>18),H=M+(W^O&(D^W))+B[0]+3921069994&4294967295,M=D+(H<<20&4294967295|H>>>12),H=O+(D^W&(M^D))+B[5]+3593408605&4294967295,O=M+(H<<5&4294967295|H>>>27),H=W+(M^D&(O^M))+B[10]+38016083&4294967295,W=O+(H<<9&4294967295|H>>>23),H=D+(O^M&(W^O))+B[15]+3634488961&4294967295,D=W+(H<<14&4294967295|H>>>18),H=M+(W^O&(D^W))+B[4]+3889429448&4294967295,M=D+(H<<20&4294967295|H>>>12),H=O+(D^W&(M^D))+B[9]+568446438&4294967295,O=M+(H<<5&4294967295|H>>>27),H=W+(M^D&(O^M))+B[14]+3275163606&4294967295,W=O+(H<<9&4294967295|H>>>23),H=D+(O^M&(W^O))+B[3]+4107603335&4294967295,D=W+(H<<14&4294967295|H>>>18),H=M+(W^O&(D^W))+B[8]+1163531501&4294967295,M=D+(H<<20&4294967295|H>>>12),H=O+(D^W&(M^D))+B[13]+2850285829&4294967295,O=M+(H<<5&4294967295|H>>>27),H=W+(M^D&(O^M))+B[2]+4243563512&4294967295,W=O+(H<<9&4294967295|H>>>23),H=D+(O^M&(W^O))+B[7]+1735328473&4294967295,D=W+(H<<14&4294967295|H>>>18),H=M+(W^O&(D^W))+B[12]+2368359562&4294967295,M=D+(H<<20&4294967295|H>>>12),H=O+(M^D^W)+B[5]+4294588738&4294967295,O=M+(H<<4&4294967295|H>>>28),H=W+(O^M^D)+B[8]+2272392833&4294967295,W=O+(H<<11&4294967295|H>>>21),H=D+(W^O^M)+B[11]+1839030562&4294967295,D=W+(H<<16&4294967295|H>>>16),H=M+(D^W^O)+B[14]+4259657740&4294967295,M=D+(H<<23&4294967295|H>>>9),H=O+(M^D^W)+B[1]+2763975236&4294967295,O=M+(H<<4&4294967295|H>>>28),H=W+(O^M^D)+B[4]+1272893353&4294967295,W=O+(H<<11&4294967295|H>>>21),H=D+(W^O^M)+B[7]+4139469664&4294967295,D=W+(H<<16&4294967295|H>>>16),H=M+(D^W^O)+B[10]+3200236656&4294967295,M=D+(H<<23&4294967295|H>>>9),H=O+(M^D^W)+B[13]+681279174&4294967295,O=M+(H<<4&4294967295|H>>>28),H=W+(O^M^D)+B[0]+3936430074&4294967295,W=O+(H<<11&4294967295|H>>>21),H=D+(W^O^M)+B[3]+3572445317&4294967295,D=W+(H<<16&4294967295|H>>>16),H=M+(D^W^O)+B[6]+76029189&4294967295,M=D+(H<<23&4294967295|H>>>9),H=O+(M^D^W)+B[9]+3654602809&4294967295,O=M+(H<<4&4294967295|H>>>28),H=W+(O^M^D)+B[12]+3873151461&4294967295,W=O+(H<<11&4294967295|H>>>21),H=D+(W^O^M)+B[15]+530742520&4294967295,D=W+(H<<16&4294967295|H>>>16),H=M+(D^W^O)+B[2]+3299628645&4294967295,M=D+(H<<23&4294967295|H>>>9),H=O+(D^(M|~W))+B[0]+4096336452&4294967295,O=M+(H<<6&4294967295|H>>>26),H=W+(M^(O|~D))+B[7]+1126891415&4294967295,W=O+(H<<10&4294967295|H>>>22),H=D+(O^(W|~M))+B[14]+2878612391&4294967295,D=W+(H<<15&4294967295|H>>>17),H=M+(W^(D|~O))+B[5]+4237533241&4294967295,M=D+(H<<21&4294967295|H>>>11),H=O+(D^(M|~W))+B[12]+1700485571&4294967295,O=M+(H<<6&4294967295|H>>>26),H=W+(M^(O|~D))+B[3]+2399980690&4294967295,W=O+(H<<10&4294967295|H>>>22),H=D+(O^(W|~M))+B[10]+4293915773&4294967295,D=W+(H<<15&4294967295|H>>>17),H=M+(W^(D|~O))+B[1]+2240044497&4294967295,M=D+(H<<21&4294967295|H>>>11),H=O+(D^(M|~W))+B[8]+1873313359&4294967295,O=M+(H<<6&4294967295|H>>>26),H=W+(M^(O|~D))+B[15]+4264355552&4294967295,W=O+(H<<10&4294967295|H>>>22),H=D+(O^(W|~M))+B[6]+2734768916&4294967295,D=W+(H<<15&4294967295|H>>>17),H=M+(W^(D|~O))+B[13]+1309151649&4294967295,M=D+(H<<21&4294967295|H>>>11),H=O+(D^(M|~W))+B[4]+4149444226&4294967295,O=M+(H<<6&4294967295|H>>>26),H=W+(M^(O|~D))+B[11]+3174756917&4294967295,W=O+(H<<10&4294967295|H>>>22),H=D+(O^(W|~M))+B[2]+718787259&4294967295,D=W+(H<<15&4294967295|H>>>17),H=M+(W^(D|~O))+B[9]+3951481745&4294967295,j.g[0]=j.g[0]+O&4294967295,j.g[1]=j.g[1]+(D+(H<<21&4294967295|H>>>11))&4294967295,j.g[2]=j.g[2]+D&4294967295,j.g[3]=j.g[3]+W&4294967295}s.prototype.v=function(j,O){O===void 0&&(O=j.length);const M=O-this.blockSize,B=this.C;let D=this.h,W=0;for(;W<O;){if(D==0)for(;W<=M;)r(this,j,W),W+=this.blockSize;if(typeof j=="string"){for(;W<O;)if(B[D++]=j.charCodeAt(W++),D==this.blockSize){r(this,B),D=0;break}}else for(;W<O;)if(B[D++]=j[W++],D==this.blockSize){r(this,B),D=0;break}}this.h=D,this.o+=O},s.prototype.A=function(){var j=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);j[0]=128;for(var O=1;O<j.length-8;++O)j[O]=0;O=this.o*8;for(var M=j.length-8;M<j.length;++M)j[M]=O&255,O/=256;for(this.v(j),j=Array(16),O=0,M=0;M<4;++M)for(let B=0;B<32;B+=8)j[O++]=this.g[M]>>>B&255;return j};function i(j,O){var M=o;return Object.prototype.hasOwnProperty.call(M,j)?M[j]:M[j]=O(j)}function a(j,O){this.h=O;const M=[];let B=!0;for(let D=j.length-1;D>=0;D--){const W=j[D]|0;B&&W==O||(M[D]=W,B=!1)}this.g=M}var o={};function l(j){return-128<=j&&j<128?i(j,function(O){return new a([O|0],O<0?-1:0)}):new a([j|0],j<0?-1:0)}function c(j){if(isNaN(j)||!isFinite(j))return p;if(j<0)return T(c(-j));const O=[];let M=1;for(let B=0;j>=M;B++)O[B]=j/M|0,M*=4294967296;return new a(O,0)}function h(j,O){if(j.length==0)throw Error("number format error: empty string");if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(j.charAt(0)=="-")return T(h(j.substring(1),O));if(j.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=c(Math.pow(O,8));let B=p;for(let W=0;W<j.length;W+=8){var D=Math.min(8,j.length-W);const H=parseInt(j.substring(W,W+D),O);D<8?(D=c(Math.pow(O,D)),B=B.j(D).add(c(H))):(B=B.j(M),B=B.add(c(H)))}return B}var p=l(0),m=l(1),v=l(16777216);n=a.prototype,n.m=function(){if(w(this))return-T(this).m();let j=0,O=1;for(let M=0;M<this.g.length;M++){const B=this.i(M);j+=(B>=0?B:4294967296+B)*O,O*=4294967296}return j},n.toString=function(j){if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(x(this))return"0";if(w(this))return"-"+T(this).toString(j);const O=c(Math.pow(j,6));var M=this;let B="";for(;;){const D=R(M,O).g;M=E(M,D.j(O));let W=((M.g.length>0?M.g[0]:M.h)>>>0).toString(j);if(M=D,x(M))return W+B;for(;W.length<6;)W="0"+W;B=W+B}},n.i=function(j){return j<0?0:j<this.g.length?this.g[j]:this.h};function x(j){if(j.h!=0)return!1;for(let O=0;O<j.g.length;O++)if(j.g[O]!=0)return!1;return!0}function w(j){return j.h==-1}n.l=function(j){return j=E(this,j),w(j)?-1:x(j)?0:1};function T(j){const O=j.g.length,M=[];for(let B=0;B<O;B++)M[B]=~j.g[B];return new a(M,~j.h).add(m)}n.abs=function(){return w(this)?T(this):this},n.add=function(j){const O=Math.max(this.g.length,j.g.length),M=[];let B=0;for(let D=0;D<=O;D++){let W=B+(this.i(D)&65535)+(j.i(D)&65535),H=(W>>>16)+(this.i(D)>>>16)+(j.i(D)>>>16);B=H>>>16,W&=65535,H&=65535,M[D]=H<<16|W}return new a(M,M[M.length-1]&-2147483648?-1:0)};function E(j,O){return j.add(T(O))}n.j=function(j){if(x(this)||x(j))return p;if(w(this))return w(j)?T(this).j(T(j)):T(T(this).j(j));if(w(j))return T(this.j(T(j)));if(this.l(v)<0&&j.l(v)<0)return c(this.m()*j.m());const O=this.g.length+j.g.length,M=[];for(var B=0;B<2*O;B++)M[B]=0;for(B=0;B<this.g.length;B++)for(let D=0;D<j.g.length;D++){const W=this.i(B)>>>16,H=this.i(B)&65535,ae=j.i(D)>>>16,te=j.i(D)&65535;M[2*B+2*D]+=H*te,C(M,2*B+2*D),M[2*B+2*D+1]+=W*te,C(M,2*B+2*D+1),M[2*B+2*D+1]+=H*ae,C(M,2*B+2*D+1),M[2*B+2*D+2]+=W*ae,C(M,2*B+2*D+2)}for(j=0;j<O;j++)M[j]=M[2*j+1]<<16|M[2*j];for(j=O;j<2*O;j++)M[j]=0;return new a(M,0)};function C(j,O){for(;(j[O]&65535)!=j[O];)j[O+1]+=j[O]>>>16,j[O]&=65535,O++}function $(j,O){this.g=j,this.h=O}function R(j,O){if(x(O))throw Error("division by zero");if(x(j))return new $(p,p);if(w(j))return O=R(T(j),O),new $(T(O.g),T(O.h));if(w(O))return O=R(j,T(O)),new $(T(O.g),O.h);if(j.g.length>30){if(w(j)||w(O))throw Error("slowDivide_ only works with positive integers.");for(var M=m,B=O;B.l(j)<=0;)M=P(M),B=P(B);var D=U(M,1),W=U(B,1);for(B=U(B,2),M=U(M,2);!x(B);){var H=W.add(B);H.l(j)<=0&&(D=D.add(M),W=H),B=U(B,1),M=U(M,1)}return O=E(j,D.j(O)),new $(D,O)}for(D=p;j.l(O)>=0;){for(M=Math.max(1,Math.floor(j.m()/O.m())),B=Math.ceil(Math.log(M)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),W=c(M),H=W.j(O);w(H)||H.l(j)>0;)M-=B,W=c(M),H=W.j(O);x(W)&&(W=m),D=D.add(W),j=E(j,H)}return new $(D,j)}n.B=function(j){return R(this,j).h},n.and=function(j){const O=Math.max(this.g.length,j.g.length),M=[];for(let B=0;B<O;B++)M[B]=this.i(B)&j.i(B);return new a(M,this.h&j.h)},n.or=function(j){const O=Math.max(this.g.length,j.g.length),M=[];for(let B=0;B<O;B++)M[B]=this.i(B)|j.i(B);return new a(M,this.h|j.h)},n.xor=function(j){const O=Math.max(this.g.length,j.g.length),M=[];for(let B=0;B<O;B++)M[B]=this.i(B)^j.i(B);return new a(M,this.h^j.h)};function P(j){const O=j.g.length+1,M=[];for(let B=0;B<O;B++)M[B]=j.i(B)<<1|j.i(B-1)>>>31;return new a(M,j.h)}function U(j,O){const M=O>>5;O%=32;const B=j.g.length-M,D=[];for(let W=0;W<B;W++)D[W]=O>0?j.i(W+M)>>>O|j.i(W+M+1)<<32-O:j.i(W+M);return new a(D,j.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,Ij=s,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=h,bh=a}).apply(typeof QO<"u"?QO:typeof self<"u"?self:typeof window<"u"?window:{});var yx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cj,fy,kj,Wx,ON,$j,Aj,Rj;(function(){var n,e=Object.defineProperty;function t(S){S=[typeof globalThis=="object"&&globalThis,S,typeof window=="object"&&window,typeof self=="object"&&self,typeof yx=="object"&&yx];for(var F=0;F<S.length;++F){var G=S[F];if(G&&G.Math==Math)return G}throw Error("Cannot find global object")}var s=t(this);function r(S,F){if(F)e:{var G=s;S=S.split(".");for(var ee=0;ee<S.length-1;ee++){var Ie=S[ee];if(!(Ie in G))break e;G=G[Ie]}S=S[S.length-1],ee=G[S],F=F(ee),F!=ee&&F!=null&&e(G,S,{configurable:!0,writable:!0,value:F})}}r("Symbol.dispose",function(S){return S||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(S){return S||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(S){return S||function(F){var G=[],ee;for(ee in F)Object.prototype.hasOwnProperty.call(F,ee)&&G.push([ee,F[ee]]);return G}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function o(S){var F=typeof S;return F=="object"&&S!=null||F=="function"}function l(S,F,G){return S.call.apply(S.bind,arguments)}function c(S,F,G){return c=l,c.apply(null,arguments)}function h(S,F){var G=Array.prototype.slice.call(arguments,1);return function(){var ee=G.slice();return ee.push.apply(ee,arguments),S.apply(this,ee)}}function p(S,F){function G(){}G.prototype=F.prototype,S.Z=F.prototype,S.prototype=new G,S.prototype.constructor=S,S.Ob=function(ee,Ie,Re){for(var Xe=Array(arguments.length-2),wt=2;wt<arguments.length;wt++)Xe[wt-2]=arguments[wt];return F.prototype[Ie].apply(ee,Xe)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?S=>S&&AsyncContext.Snapshot.wrap(S):S=>S;function v(S){const F=S.length;if(F>0){const G=Array(F);for(let ee=0;ee<F;ee++)G[ee]=S[ee];return G}return[]}function x(S,F){for(let ee=1;ee<arguments.length;ee++){const Ie=arguments[ee];var G=typeof Ie;if(G=G!="object"?G:Ie?Array.isArray(Ie)?"array":G:"null",G=="array"||G=="object"&&typeof Ie.length=="number"){G=S.length||0;const Re=Ie.length||0;S.length=G+Re;for(let Xe=0;Xe<Re;Xe++)S[G+Xe]=Ie[Xe]}else S.push(Ie)}}class w{constructor(F,G){this.i=F,this.j=G,this.h=0,this.g=null}get(){let F;return this.h>0?(this.h--,F=this.g,this.g=F.next,F.next=null):F=this.i(),F}}function T(S){a.setTimeout(()=>{throw S},0)}function E(){var S=j;let F=null;return S.g&&(F=S.g,S.g=S.g.next,S.g||(S.h=null),F.next=null),F}class C{constructor(){this.h=this.g=null}add(F,G){const ee=$.get();ee.set(F,G),this.h?this.h.next=ee:this.g=ee,this.h=ee}}var $=new w(()=>new R,S=>S.reset());class R{constructor(){this.next=this.g=this.h=null}set(F,G){this.h=F,this.g=G,this.next=null}reset(){this.next=this.g=this.h=null}}let P,U=!1,j=new C,O=()=>{const S=Promise.resolve(void 0);P=()=>{S.then(M)}};function M(){for(var S;S=E();){try{S.h.call(S.g)}catch(G){T(G)}var F=$;F.j(S),F.h<100&&(F.h++,S.next=F.g,F.g=S)}U=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(S,F){this.type=S,this.g=this.target=F,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var W=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var S=!1,F=Object.defineProperty({},"passive",{get:function(){S=!0}});try{const G=()=>{};a.addEventListener("test",G,F),a.removeEventListener("test",G,F)}catch{}return S})();function H(S){return/^[\s\xa0]*$/.test(S)}function ae(S,F){D.call(this,S?S.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,S&&this.init(S,F)}p(ae,D),ae.prototype.init=function(S,F){const G=this.type=S.type,ee=S.changedTouches&&S.changedTouches.length?S.changedTouches[0]:null;this.target=S.target||S.srcElement,this.g=F,F=S.relatedTarget,F||(G=="mouseover"?F=S.fromElement:G=="mouseout"&&(F=S.toElement)),this.relatedTarget=F,ee?(this.clientX=ee.clientX!==void 0?ee.clientX:ee.pageX,this.clientY=ee.clientY!==void 0?ee.clientY:ee.pageY,this.screenX=ee.screenX||0,this.screenY=ee.screenY||0):(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0),this.button=S.button,this.key=S.key||"",this.ctrlKey=S.ctrlKey,this.altKey=S.altKey,this.shiftKey=S.shiftKey,this.metaKey=S.metaKey,this.pointerId=S.pointerId||0,this.pointerType=S.pointerType,this.state=S.state,this.i=S,S.defaultPrevented&&ae.Z.h.call(this)},ae.prototype.h=function(){ae.Z.h.call(this);const S=this.i;S.preventDefault?S.preventDefault():S.returnValue=!1};var te="closure_listenable_"+(Math.random()*1e6|0),Z=0;function re(S,F,G,ee,Ie){this.listener=S,this.proxy=null,this.src=F,this.type=G,this.capture=!!ee,this.ha=Ie,this.key=++Z,this.da=this.fa=!1}function ne(S){S.da=!0,S.listener=null,S.proxy=null,S.src=null,S.ha=null}function he(S,F,G){for(const ee in S)F.call(G,S[ee],ee,S)}function K(S,F){for(const G in S)F.call(void 0,S[G],G,S)}function ie(S){const F={};for(const G in S)F[G]=S[G];return F}const pe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(S,F){let G,ee;for(let Ie=1;Ie<arguments.length;Ie++){ee=arguments[Ie];for(G in ee)S[G]=ee[G];for(let Re=0;Re<pe.length;Re++)G=pe[Re],Object.prototype.hasOwnProperty.call(ee,G)&&(S[G]=ee[G])}}function Ne(S){this.src=S,this.g={},this.h=0}Ne.prototype.add=function(S,F,G,ee,Ie){const Re=S.toString();S=this.g[Re],S||(S=this.g[Re]=[],this.h++);const Xe=Se(S,F,ee,Ie);return Xe>-1?(F=S[Xe],G||(F.fa=!1)):(F=new re(F,this.src,Re,!!ee,Ie),F.fa=G,S.push(F)),F};function Te(S,F){const G=F.type;if(G in S.g){var ee=S.g[G],Ie=Array.prototype.indexOf.call(ee,F,void 0),Re;(Re=Ie>=0)&&Array.prototype.splice.call(ee,Ie,1),Re&&(ne(F),S.g[G].length==0&&(delete S.g[G],S.h--))}}function Se(S,F,G,ee){for(let Ie=0;Ie<S.length;++Ie){const Re=S[Ie];if(!Re.da&&Re.listener==F&&Re.capture==!!G&&Re.ha==ee)return Ie}return-1}var He="closure_lm_"+(Math.random()*1e6|0),qe={};function Qe(S,F,G,ee,Ie){if(Array.isArray(F)){for(let Re=0;Re<F.length;Re++)Qe(S,F[Re],G,ee,Ie);return null}return G=sn(G),S&&S[te]?S.J(F,G,o(ee)?!!ee.capture:!1,Ie):pt(S,F,G,!1,ee,Ie)}function pt(S,F,G,ee,Ie,Re){if(!F)throw Error("Invalid event type");const Xe=o(Ie)?!!Ie.capture:!!Ie;let wt=qt(S);if(wt||(S[He]=wt=new Ne(S)),G=wt.add(F,G,ee,Xe,Re),G.proxy)return G;if(ee=vt(),G.proxy=ee,ee.src=S,ee.listener=G,S.addEventListener)W||(Ie=Xe),Ie===void 0&&(Ie=!1),S.addEventListener(F.toString(),ee,Ie);else if(S.attachEvent)S.attachEvent(gn(F.toString()),ee);else if(S.addListener&&S.removeListener)S.addListener(ee);else throw Error("addEventListener and attachEvent are unavailable.");return G}function vt(){function S(G){return F.call(S.src,S.listener,G)}const F=un;return S}function Lt(S,F,G,ee,Ie){if(Array.isArray(F))for(var Re=0;Re<F.length;Re++)Lt(S,F[Re],G,ee,Ie);else ee=o(ee)?!!ee.capture:!!ee,G=sn(G),S&&S[te]?(S=S.i,Re=String(F).toString(),Re in S.g&&(F=S.g[Re],G=Se(F,G,ee,Ie),G>-1&&(ne(F[G]),Array.prototype.splice.call(F,G,1),F.length==0&&(delete S.g[Re],S.h--)))):S&&(S=qt(S))&&(F=S.g[F.toString()],S=-1,F&&(S=Se(F,G,ee,Ie)),(G=S>-1?F[S]:null)&&Gt(G))}function Gt(S){if(typeof S!="number"&&S&&!S.da){var F=S.src;if(F&&F[te])Te(F.i,S);else{var G=S.type,ee=S.proxy;F.removeEventListener?F.removeEventListener(G,ee,S.capture):F.detachEvent?F.detachEvent(gn(G),ee):F.addListener&&F.removeListener&&F.removeListener(ee),(G=qt(F))?(Te(G,S),G.h==0&&(G.src=null,F[He]=null)):ne(S)}}}function gn(S){return S in qe?qe[S]:qe[S]="on"+S}function un(S,F){if(S.da)S=!0;else{F=new ae(F,this);const G=S.listener,ee=S.ha||S.src;S.fa&&Gt(S),S=G.call(ee,F)}return S}function qt(S){return S=S[He],S instanceof Ne?S:null}var Ot="__closure_events_fn_"+(Math.random()*1e9>>>0);function sn(S){return typeof S=="function"?S:(S[Ot]||(S[Ot]=function(F){return S.handleEvent(F)}),S[Ot])}function wn(){B.call(this),this.i=new Ne(this),this.M=this,this.G=null}p(wn,B),wn.prototype[te]=!0,wn.prototype.removeEventListener=function(S,F,G,ee){Lt(this,S,F,G,ee)};function jt(S,F){var G,ee=S.G;if(ee)for(G=[];ee;ee=ee.G)G.push(ee);if(S=S.M,ee=F.type||F,typeof F=="string")F=new D(F,S);else if(F instanceof D)F.target=F.target||S;else{var Ie=F;F=new D(ee,S),fe(F,Ie)}Ie=!0;let Re,Xe;if(G)for(Xe=G.length-1;Xe>=0;Xe--)Re=F.g=G[Xe],Ie=bs(Re,ee,!0,F)&&Ie;if(Re=F.g=S,Ie=bs(Re,ee,!0,F)&&Ie,Ie=bs(Re,ee,!1,F)&&Ie,G)for(Xe=0;Xe<G.length;Xe++)Re=F.g=G[Xe],Ie=bs(Re,ee,!1,F)&&Ie}wn.prototype.N=function(){if(wn.Z.N.call(this),this.i){var S=this.i;for(const F in S.g){const G=S.g[F];for(let ee=0;ee<G.length;ee++)ne(G[ee]);delete S.g[F],S.h--}}this.G=null},wn.prototype.J=function(S,F,G,ee){return this.i.add(String(S),F,!1,G,ee)},wn.prototype.K=function(S,F,G,ee){return this.i.add(String(S),F,!0,G,ee)};function bs(S,F,G,ee){if(F=S.i.g[String(F)],!F)return!0;F=F.concat();let Ie=!0;for(let Re=0;Re<F.length;++Re){const Xe=F[Re];if(Xe&&!Xe.da&&Xe.capture==G){const wt=Xe.listener,Kt=Xe.ha||Xe.src;Xe.fa&&Te(S.i,Xe),Ie=wt.call(Kt,ee)!==!1&&Ie}}return Ie&&!ee.defaultPrevented}function Bs(S,F){if(typeof S!="function")if(S&&typeof S.handleEvent=="function")S=c(S.handleEvent,S);else throw Error("Invalid listener argument");return Number(F)>2147483647?-1:a.setTimeout(S,F||0)}function qr(S){S.g=Bs(()=>{S.g=null,S.i&&(S.i=!1,qr(S))},S.l);const F=S.h;S.h=null,S.m.apply(null,F)}class kr extends B{constructor(F,G){super(),this.m=F,this.l=G,this.h=null,this.i=!1,this.g=null}j(F){this.h=arguments,this.g?this.i=!0:qr(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Js(S){B.call(this),this.h=S,this.g={}}p(Js,B);var $s=[];function An(S){he(S.g,function(F,G){this.g.hasOwnProperty(G)&&Gt(F)},S),S.g={}}Js.prototype.N=function(){Js.Z.N.call(this),An(this)},Js.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ns=a.JSON.stringify,hs=a.JSON.parse,el=class{stringify(S){return a.JSON.stringify(S,void 0)}parse(S){return a.JSON.parse(S,void 0)}};function mo(){}function hu(){}var hr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Mi(){D.call(this,"d")}p(Mi,D);function Kr(){D.call(this,"c")}p(Kr,D);var Fi={},ji=null;function du(){return ji=ji||new wn}Fi.Ia="serverreachability";function ud(S){D.call(this,Fi.Ia,S)}p(ud,D);function go(S){const F=du();jt(F,new ud(F))}Fi.STAT_EVENT="statevent";function ac(S,F){D.call(this,Fi.STAT_EVENT,S),this.stat=F}p(ac,D);function ss(S){const F=du();jt(F,new ac(F,S))}Fi.Ja="timingevent";function Jf(S,F){D.call(this,Fi.Ja,S),this.size=F}p(Jf,D);function tl(S,F){if(typeof S!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){S()},F)}function nl(){this.g=!0}nl.prototype.ua=function(){this.g=!1};function hd(S,F,G,ee,Ie,Re){S.info(function(){if(S.g)if(Re){var Xe="",wt=Re.split("&");for(let yn=0;yn<wt.length;yn++){var Kt=wt[yn].split("=");if(Kt.length>1){const rs=Kt[0];Kt=Kt[1];const xi=rs.split("_");Xe=xi.length>=2&&xi[1]=="type"?Xe+(rs+"="+Kt+"&"):Xe+(rs+"=redacted&")}}}else Xe=null;else Xe=Re;return"XMLHTTP REQ ("+ee+") [attempt "+Ie+"]: "+F+`
`+G+`
`+Xe})}function dd(S,F,G,ee,Ie,Re,Xe){S.info(function(){return"XMLHTTP RESP ("+ee+") [ attempt "+Ie+"]: "+F+`
`+G+`
`+Re+" "+Xe})}function yo(S,F,G,ee){S.info(function(){return"XMLHTTP TEXT ("+F+"): "+Oa(S,G)+(ee?" "+ee:"")})}function fd(S,F){S.info(function(){return"TIMEOUT: "+F})}nl.prototype.info=function(){};function Oa(S,F){if(!S.g)return F;if(!F)return null;try{const Re=JSON.parse(F);if(Re){for(S=0;S<Re.length;S++)if(Array.isArray(Re[S])){var G=Re[S];if(!(G.length<2)){var ee=G[1];if(Array.isArray(ee)&&!(ee.length<1)){var Ie=ee[0];if(Ie!="noop"&&Ie!="stop"&&Ie!="close")for(let Xe=1;Xe<ee.length;Xe++)ee[Xe]=""}}}}return ns(Re)}catch{return F}}var ds={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},er={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},vo;function dr(){}p(dr,mo),dr.prototype.g=function(){return new XMLHttpRequest},vo=new dr;function ot(S){return encodeURIComponent(String(S))}function ep(S){var F=1;S=S.split(":");const G=[];for(;F>0&&S.length;)G.push(S.shift()),F--;return S.length&&G.push(S.join(":")),G}function Bi(S,F,G,ee){this.j=S,this.i=F,this.l=G,this.S=ee||1,this.V=new Js(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new bo}function bo(){this.i=null,this.g="",this.h=!1}var oc={},zi={};function oa(S,F,G){S.M=1,S.A=Tn(Rn(F)),S.u=G,S.R=!0,mi(S,null)}function mi(S,F){S.F=Date.now(),lc(S),S.B=Rn(S.A);var G=S.B,ee=S.S;Array.isArray(ee)||(ee=[String(ee)]),pu(G.i,"t",ee),S.C=0,G=S.j.L,S.h=new bo,S.g=vc(S.j,G?F:null,!S.u),S.P>0&&(S.O=new kr(c(S.Y,S,S.g),S.P)),F=S.V,G=S.g,ee=S.ba;var Ie="readystatechange";Array.isArray(Ie)||(Ie&&($s[0]=Ie.toString()),Ie=$s);for(let Re=0;Re<Ie.length;Re++){const Xe=Qe(G,Ie[Re],ee||F.handleEvent,!1,F.h||F);if(!Xe)break;F.g[Xe.key]=Xe}F=S.J?ie(S.J):{},S.u?(S.v||(S.v="POST"),F["Content-Type"]="application/x-www-form-urlencoded",S.g.ea(S.B,S.v,S.u,F)):(S.v="GET",S.g.ea(S.B,S.v,null,F)),go(),hd(S.i,S.v,S.B,S.l,S.S,S.u)}Bi.prototype.ba=function(S){S=S.target;const F=this.O;F&&yr(S)==3?F.j():this.Y(S)},Bi.prototype.Y=function(S){try{if(S==this.g)e:{const wt=yr(this.g),Kt=this.g.ya(),yn=this.g.ca();if(!(wt<3)&&(wt!=3||this.g&&(this.h.h||this.g.la()||ll(this.g)))){this.K||wt!=4||Kt==7||(Kt==8||yn<=0?go(3):go(2)),la(this);var F=this.g.ca();this.X=F;var G=_o(this);if(this.o=F==200,dd(this.i,this.v,this.B,this.l,this.S,wt,F),this.o){if(this.U&&!this.L){t:{if(this.g){var ee,Ie=this.g;if((ee=Ie.g?Ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(ee)){var Re=ee;break t}}Re=null}if(S=Re)yo(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,fu(this,S);else{this.o=!1,this.m=3,ss(12),gi(this),cc(this);break e}}if(this.R){S=!0;let rs;for(;!this.K&&this.C<G.length;)if(rs=tp(this,G),rs==zi){wt==4&&(this.m=4,ss(14),S=!1),yo(this.i,this.l,null,"[Incomplete Response]");break}else if(rs==oc){this.m=4,ss(15),yo(this.i,this.l,G,"[Invalid Chunk]"),S=!1;break}else yo(this.i,this.l,rs,null),fu(this,rs);if(fs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wt!=4||G.length!=0||this.h.h||(this.m=1,ss(16),S=!1),this.o=this.o&&S,!S)yo(this.i,this.l,G,"[Invalid Chunked Response]"),gi(this),cc(this);else if(G.length>0&&!this.W){this.W=!0;var Xe=this.j;Xe.g==this&&Xe.aa&&!Xe.P&&(Xe.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),yd(Xe),Xe.P=!0,ss(11))}}else yo(this.i,this.l,G,null),fu(this,G);wt==4&&gi(this),this.o&&!this.K&&(wt==4?Yr(this.j,this):(this.o=!1,lc(this)))}else Eo(this.g),F==400&&G.indexOf("Unknown SID")>0?(this.m=3,ss(12)):(this.m=0,ss(13)),gi(this),cc(this)}}}catch{}finally{}};function _o(S){if(!fs(S))return S.g.la();const F=ll(S.g);if(F==="")return"";let G="";const ee=F.length,Ie=yr(S.g)==4;if(!S.h.i){if(typeof TextDecoder>"u")return gi(S),cc(S),"";S.h.i=new a.TextDecoder}for(let Re=0;Re<ee;Re++)S.h.h=!0,G+=S.h.i.decode(F[Re],{stream:!(Ie&&Re==ee-1)});return F.length=0,S.h.g+=G,S.C=0,S.h.g}function fs(S){return S.g?S.v=="GET"&&S.M!=2&&S.j.Aa:!1}function tp(S,F){var G=S.C,ee=F.indexOf(`
`,G);return ee==-1?zi:(G=Number(F.substring(G,ee)),isNaN(G)?oc:(ee+=1,ee+G>F.length?zi:(F=F.slice(ee,ee+G),S.C=ee+G,F)))}Bi.prototype.cancel=function(){this.K=!0,gi(this)};function lc(S){S.T=Date.now()+S.H,Pa(S,S.H)}function Pa(S,F){if(S.D!=null)throw Error("WatchDog timer not null");S.D=tl(c(S.aa,S),F)}function la(S){S.D&&(a.clearTimeout(S.D),S.D=null)}Bi.prototype.aa=function(){this.D=null;const S=Date.now();S-this.T>=0?(fd(this.i,this.B),this.M!=2&&(go(),ss(17)),gi(this),this.m=2,cc(this)):Pa(this,this.T-S)};function cc(S){S.j.I==0||S.K||Yr(S.j,S)}function gi(S){la(S);var F=S.O;F&&typeof F.dispose=="function"&&F.dispose(),S.O=null,An(S.V),S.g&&(F=S.g,S.g=null,F.abort(),F.dispose())}function fu(S,F){try{var G=S.j;if(G.I!=0&&(G.g==S||xo(G.h,S))){if(!S.L&&xo(G.h,S)&&G.I==3){try{var ee=G.Ba.g.parse(F)}catch{ee=null}if(Array.isArray(ee)&&ee.length==3){var Ie=ee;if(Ie[0]==0){e:if(!G.v){if(G.g)if(G.g.F+3e3<S.F)vu(G),Ua(G);else break e;gd(G),ss(18)}}else G.xa=Ie[1],0<G.xa-G.K&&Ie[2]<37500&&G.F&&G.A==0&&!G.C&&(G.C=tl(c(G.Va,G),6e3));Vi(G.h)<=1&&G.ta&&(G.ta=void 0)}else Ga(G,11)}else if((S.L||G.g==S)&&vu(G),!H(F))for(Ie=G.Ba.g.parse(F),F=0;F<Ie.length;F++){let yn=Ie[F];const rs=yn[0];if(!(rs<=G.K))if(G.K=rs,yn=yn[1],G.I==2)if(yn[0]=="c"){G.M=yn[1],G.ba=yn[2];const xi=yn[3];xi!=null&&(G.ka=xi,G.j.info("VER="+G.ka));const Gi=yn[4];Gi!=null&&(G.za=Gi,G.j.info("SVER="+G.za));const wi=yn[5];wi!=null&&typeof wi=="number"&&wi>0&&(ee=1.5*wi,G.O=ee,G.j.info("backChannelRequestTimeoutMs_="+ee)),ee=G;const da=S.g;if(da){const fa=da.g?da.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fa){var Re=ee.h;Re.g||fa.indexOf("spdy")==-1&&fa.indexOf("quic")==-1&&fa.indexOf("h2")==-1||(Re.j=Re.l,Re.g=new Set,Re.h&&(Ma(Re,Re.h),Re.h=null))}if(ee.G){const wu=da.g?da.g.getResponseHeader("X-HTTP-Session-Id"):null;wu&&(ee.wa=wu,st(ee.J,ee.G,wu))}}G.I=3,G.l&&G.l.ra(),G.aa&&(G.T=Date.now()-S.F,G.j.info("Handshake RTT: "+G.T+"ms")),ee=G;var Xe=S;if(ee.na=vd(ee,ee.L?ee.ba:null,ee.W),Xe.L){Fa(ee.h,Xe);var wt=Xe,Kt=ee.O;Kt&&(wt.H=Kt),wt.D&&(la(wt),lc(wt)),ee.g=Xe}else md(ee);G.i.length>0&&ua(G)}else yn[0]!="stop"&&yn[0]!="close"||Ga(G,7);else G.I==3&&(yn[0]=="stop"||yn[0]=="close"?yn[0]=="stop"?Ga(G,7):Pt(G):yn[0]!="noop"&&G.l&&G.l.qa(yn),G.A=0)}}go(4)}catch{}}var pg=class{constructor(S,F){this.g=S,this.map=F}};function uc(S){this.l=S||10,a.PerformanceNavigationTiming?(S=a.performance.getEntriesByType("navigation"),S=S.length>0&&(S[0].nextHopProtocol=="hq"||S[0].nextHopProtocol=="h2")):S=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=S?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function hc(S){return S.h?!0:S.g?S.g.size>=S.j:!1}function Vi(S){return S.h?1:S.g?S.g.size:0}function xo(S,F){return S.h?S.h==F:S.g?S.g.has(F):!1}function Ma(S,F){S.g?S.g.add(F):S.h=F}function Fa(S,F){S.h&&S.h==F?S.h=null:S.g&&S.g.has(F)&&S.g.delete(F)}uc.prototype.cancel=function(){if(this.i=dc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const S of this.g.values())S.cancel();this.g.clear()}};function dc(S){if(S.h!=null)return S.i.concat(S.h.G);if(S.g!=null&&S.g.size!==0){let F=S.i;for(const G of S.g.values())F=F.concat(G.G);return F}return v(S.i)}var ja=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jt(S,F){if(S){S=S.split("&");for(let G=0;G<S.length;G++){const ee=S[G].indexOf("=");let Ie,Re=null;ee>=0?(Ie=S[G].substring(0,ee),Re=S[G].substring(ee+1)):Ie=S[G],F(Ie,Re?decodeURIComponent(Re.replace(/\+/g," ")):"")}}}function rn(S){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let F;S instanceof rn?(this.l=S.l,yi(this,S.j),this.o=S.o,this.g=S.g,Ui(this,S.u),this.h=S.h,Ba(this,pc(S.i)),this.m=S.m):S&&(F=String(S).match(ja))?(this.l=!1,yi(this,F[1]||"",!0),this.o=wo(F[2]||""),this.g=wo(F[3]||"",!0),Ui(this,F[4]),this.h=wo(F[5]||"",!0),Ba(this,F[6]||"",!0),this.m=wo(F[7]||"")):(this.l=!1,this.i=new pr(null,this.l))}rn.prototype.toString=function(){const S=[];var F=this.j;F&&S.push(ps(F,pd,!0),":");var G=this.g;return(G||F=="file")&&(S.push("//"),(F=this.o)&&S.push(ps(F,pd,!0),"@"),S.push(ot(G).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),G=this.u,G!=null&&S.push(":",String(G))),(G=this.h)&&(this.g&&G.charAt(0)!="/"&&S.push("/"),S.push(ps(G,G.charAt(0)=="/"?Xr:sl,!0))),(G=this.i.toString())&&S.push("?",G),(G=this.m)&&S.push("#",ps(G,za)),S.join("")},rn.prototype.resolve=function(S){const F=Rn(this);let G=!!S.j;G?yi(F,S.j):G=!!S.o,G?F.o=S.o:G=!!S.g,G?F.g=S.g:G=S.u!=null;var ee=S.h;if(G)Ui(F,S.u);else if(G=!!S.h){if(ee.charAt(0)!="/")if(this.g&&!this.h)ee="/"+ee;else{var Ie=F.h.lastIndexOf("/");Ie!=-1&&(ee=F.h.slice(0,Ie+1)+ee)}if(Ie=ee,Ie==".."||Ie==".")ee="";else if(Ie.indexOf("./")!=-1||Ie.indexOf("/.")!=-1){ee=Ie.lastIndexOf("/",0)==0,Ie=Ie.split("/");const Re=[];for(let Xe=0;Xe<Ie.length;){const wt=Ie[Xe++];wt=="."?ee&&Xe==Ie.length&&Re.push(""):wt==".."?((Re.length>1||Re.length==1&&Re[0]!="")&&Re.pop(),ee&&Xe==Ie.length&&Re.push("")):(Re.push(wt),ee=!0)}ee=Re.join("/")}else ee=Ie}return G?F.h=ee:G=S.i.toString()!=="",G?Ba(F,pc(S.i)):G=!!S.m,G&&(F.m=S.m),F};function Rn(S){return new rn(S)}function yi(S,F,G){S.j=G?wo(F,!0):F,S.j&&(S.j=S.j.replace(/:$/,""))}function Ui(S,F){if(F){if(F=Number(F),isNaN(F)||F<0)throw Error("Bad port number "+F);S.u=F}else S.u=null}function Ba(S,F,G){F instanceof pr?(S.i=F,mc(S.i,S.l)):(G||(F=ps(F,Zn)),S.i=new pr(F,S.l))}function st(S,F,G){S.i.set(F,G)}function Tn(S){return st(S,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),S}function wo(S,F){return S?F?decodeURI(S.replace(/%25/g,"%2525")):decodeURIComponent(S):""}function ps(S,F,G){return typeof S=="string"?(S=encodeURI(S).replace(F,fr),G&&(S=S.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S):null}function fr(S){return S=S.charCodeAt(0),"%"+(S>>4&15).toString(16)+(S&15).toString(16)}var pd=/[#\/\?@]/g,sl=/[#\?:]/g,Xr=/[#\?]/g,Zn=/[#\?@]/g,za=/#/g;function pr(S,F){this.h=this.g=null,this.i=S||null,this.j=!!F}function vi(S){S.g||(S.g=new Map,S.h=0,S.i&&Jt(S.i,function(F,G){S.add(decodeURIComponent(F.replace(/\+/g," ")),G)}))}n=pr.prototype,n.add=function(S,F){vi(this),this.i=null,S=bi(this,S);let G=this.g.get(S);return G||this.g.set(S,G=[]),G.push(F),this.h+=1,this};function fc(S,F){vi(S),F=bi(S,F),S.g.has(F)&&(S.i=null,S.h-=S.g.get(F).length,S.g.delete(F))}function To(S,F){return vi(S),F=bi(S,F),S.g.has(F)}n.forEach=function(S,F){vi(this),this.g.forEach(function(G,ee){G.forEach(function(Ie){S.call(F,Ie,ee,this)},this)},this)};function rl(S,F){vi(S);let G=[];if(typeof F=="string")To(S,F)&&(G=G.concat(S.g.get(bi(S,F))));else for(S=Array.from(S.g.values()),F=0;F<S.length;F++)G=G.concat(S[F]);return G}n.set=function(S,F){return vi(this),this.i=null,S=bi(this,S),To(this,S)&&(this.h-=this.g.get(S).length),this.g.set(S,[F]),this.h+=1,this},n.get=function(S,F){return S?(S=rl(this,S),S.length>0?String(S[0]):F):F};function pu(S,F,G){fc(S,F),G.length>0&&(S.i=null,S.g.set(bi(S,F),v(G)),S.h+=G.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const S=[],F=Array.from(this.g.keys());for(let ee=0;ee<F.length;ee++){var G=F[ee];const Ie=ot(G);G=rl(this,G);for(let Re=0;Re<G.length;Re++){let Xe=Ie;G[Re]!==""&&(Xe+="="+ot(G[Re])),S.push(Xe)}}return this.i=S.join("&")};function pc(S){const F=new pr;return F.i=S.i,S.g&&(F.g=new Map(S.g),F.h=S.h),F}function bi(S,F){return F=String(F),S.j&&(F=F.toLowerCase()),F}function mc(S,F){F&&!S.j&&(vi(S),S.i=null,S.g.forEach(function(G,ee){const Ie=ee.toLowerCase();ee!=Ie&&(fc(this,ee),pu(this,Ie,G))},S)),S.j=F}function il(S,F){const G=new nl;if(a.Image){const ee=new Image;ee.onload=h(tr,G,"TestLoadImage: loaded",!0,F,ee),ee.onerror=h(tr,G,"TestLoadImage: error",!1,F,ee),ee.onabort=h(tr,G,"TestLoadImage: abort",!1,F,ee),ee.ontimeout=h(tr,G,"TestLoadImage: timeout",!1,F,ee),a.setTimeout(function(){ee.ontimeout&&ee.ontimeout()},1e4),ee.src=S}else F(!1)}function So(S,F){const G=new nl,ee=new AbortController,Ie=setTimeout(()=>{ee.abort(),tr(G,"TestPingServer: timeout",!1,F)},1e4);fetch(S,{signal:ee.signal}).then(Re=>{clearTimeout(Ie),Re.ok?tr(G,"TestPingServer: ok",!0,F):tr(G,"TestPingServer: server error",!1,F)}).catch(()=>{clearTimeout(Ie),tr(G,"TestPingServer: error",!1,F)})}function tr(S,F,G,ee,Ie){try{Ie&&(Ie.onload=null,Ie.onerror=null,Ie.onabort=null,Ie.ontimeout=null),ee(G)}catch{}}function np(){this.g=new el}function xt(S){this.i=S.Sb||null,this.h=S.ab||!1}p(xt,mo),xt.prototype.g=function(){return new mr(this.i,this.h)};function mr(S,F){wn.call(this),this.H=S,this.o=F,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(mr,wn),n=mr.prototype,n.open=function(S,F){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=S,this.D=F,this.readyState=1,ca(this)},n.send=function(S){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const F={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};S&&(F.body=S),(this.H||a).fetch(new Request(this.D,F)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,gr(this)),this.readyState=0},n.Pa=function(S){if(this.g&&(this.l=S,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=S.headers,this.readyState=2,ca(this)),this.g&&(this.readyState=3,ca(this),this.g)))if(this.responseType==="arraybuffer")S.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in S){if(this.j=S.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;an(this)}else S.text().then(this.Oa.bind(this),this.ga.bind(this))};function an(S){S.j.read().then(S.Ma.bind(S)).catch(S.ga.bind(S))}n.Ma=function(S){if(this.g){if(this.o&&S.value)this.response.push(S.value);else if(!this.o){var F=S.value?S.value:new Uint8Array(0);(F=this.B.decode(F,{stream:!S.done}))&&(this.response=this.responseText+=F)}S.done?gr(this):ca(this),this.readyState==3&&an(this)}},n.Oa=function(S){this.g&&(this.response=this.responseText=S,gr(this))},n.Na=function(S){this.g&&(this.response=S,gr(this))},n.ga=function(){this.g&&gr(this)};function gr(S){S.readyState=4,S.l=null,S.j=null,S.B=null,ca(S)}n.setRequestHeader=function(S,F){this.A.append(S,F)},n.getResponseHeader=function(S){return this.h&&this.h.get(S.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const S=[],F=this.h.entries();for(var G=F.next();!G.done;)G=G.value,S.push(G[0]+": "+G[1]),G=F.next();return S.join(`\r
`)};function ca(S){S.onreadystatechange&&S.onreadystatechange.call(S)}Object.defineProperty(mr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(S){this.m=S?"include":"same-origin"}});function Va(S){let F="";return he(S,function(G,ee){F+=ee,F+=":",F+=G,F+=`\r
`}),F}function Zr(S,F,G){e:{for(ee in G){var ee=!1;break e}ee=!0}ee||(G=Va(G),typeof S=="string"?G!=null&&ot(G):st(S,F,G))}function hn(S){wn.call(this),this.headers=new Map,this.L=S||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(hn,wn);var al=/^https?$/i,ol=["POST","PUT"];n=hn.prototype,n.Fa=function(S){this.H=S},n.ea=function(S,F,G,ee){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+S);F=F?F.toUpperCase():"GET",this.D=S,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():vo.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(F,String(S),!0),this.B=!1}catch(Re){Yn(this,Re);return}if(S=G||"",G=new Map(this.headers),ee)if(Object.getPrototypeOf(ee)===Object.prototype)for(var Ie in ee)G.set(Ie,ee[Ie]);else if(typeof ee.keys=="function"&&typeof ee.get=="function")for(const Re of ee.keys())G.set(Re,ee.get(Re));else throw Error("Unknown input type for opt_headers: "+String(ee));ee=Array.from(G.keys()).find(Re=>Re.toLowerCase()=="content-type"),Ie=a.FormData&&S instanceof a.FormData,!(Array.prototype.indexOf.call(ol,F,void 0)>=0)||ee||Ie||G.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Re,Xe]of G)this.g.setRequestHeader(Re,Xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(S),this.v=!1}catch(Re){Yn(this,Re)}};function Yn(S,F){S.h=!1,S.g&&(S.j=!0,S.g.abort(),S.j=!1),S.l=F,S.o=5,_i(S),_s(S)}function _i(S){S.A||(S.A=!0,jt(S,"complete"),jt(S,"error"))}n.abort=function(S){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=S||7,jt(this,"complete"),jt(this,"abort"),_s(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_s(this,!0)),hn.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?mu(this):this.Xa())},n.Xa=function(){mu(this)};function mu(S){if(S.h&&typeof i<"u"){if(S.v&&yr(S)==4)setTimeout(S.Ca.bind(S),0);else if(jt(S,"readystatechange"),yr(S)==4){S.h=!1;try{const Re=S.ca();e:switch(Re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var F=!0;break e;default:F=!1}var G;if(!(G=F)){var ee;if(ee=Re===0){let Xe=String(S.D).match(ja)[1]||null;!Xe&&a.self&&a.self.location&&(Xe=a.self.location.protocol.slice(0,-1)),ee=!al.test(Xe?Xe.toLowerCase():"")}G=ee}if(G)jt(S,"complete"),jt(S,"success");else{S.o=6;try{var Ie=yr(S)>2?S.g.statusText:""}catch{Ie=""}S.l=Ie+" ["+S.ca()+"]",_i(S)}}finally{_s(S)}}}}function _s(S,F){if(S.g){S.m&&(clearTimeout(S.m),S.m=null);const G=S.g;S.g=null,F||jt(S,"ready");try{G.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function yr(S){return S.g?S.g.readyState:0}n.ca=function(){try{return yr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(S){if(this.g){var F=this.g.responseText;return S&&F.indexOf(S)==0&&(F=F.substring(S.length)),hs(F)}};function ll(S){try{if(!S.g)return null;if("response"in S.g)return S.g.response;switch(S.F){case"":case"text":return S.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in S.g)return S.g.mozResponseArrayBuffer}return null}catch{return null}}function Eo(S){const F={};S=(S.g&&yr(S)>=2&&S.g.getAllResponseHeaders()||"").split(`\r
`);for(let ee=0;ee<S.length;ee++){if(H(S[ee]))continue;var G=ep(S[ee]);const Ie=G[0];if(G=G[1],typeof G!="string")continue;G=G.trim();const Re=F[Ie]||[];F[Ie]=Re,Re.push(G)}K(F,function(ee){return ee.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function gc(S,F,G){return G&&G.internalChannelParams&&G.internalChannelParams[S]||F}function yc(S){this.za=0,this.i=[],this.j=new nl,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=gc("failFast",!1,S),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=gc("baseRetryDelayMs",5e3,S),this.Za=gc("retryDelaySeedMs",1e4,S),this.Ta=gc("forwardChannelMaxRetries",2,S),this.va=gc("forwardChannelRequestTimeoutMs",2e4,S),this.ma=S&&S.xmlHttpFactory||void 0,this.Ua=S&&S.Rb||void 0,this.Aa=S&&S.useFetchStreams||!1,this.O=void 0,this.L=S&&S.supportsCrossDomainXhr||!1,this.M="",this.h=new uc(S&&S.concurrentRequestLimit),this.Ba=new np,this.S=S&&S.fastHandshake||!1,this.R=S&&S.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=S&&S.Pb||!1,S&&S.ua&&this.j.ua(),S&&S.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&S&&S.detectBufferingProxy||!1,this.ia=void 0,S&&S.longPollingTimeout&&S.longPollingTimeout>0&&(this.ia=S.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=yc.prototype,n.ka=8,n.I=1,n.connect=function(S,F,G,ee){ss(0),this.W=S,this.H=F||{},G&&ee!==void 0&&(this.H.OSID=G,this.H.OAID=ee),this.F=this.X,this.J=vd(this,null,this.W),ua(this)};function Pt(S){if(nr(S),S.I==3){var F=S.V++,G=Rn(S.J);if(st(G,"SID",S.M),st(G,"RID",F),st(G,"TYPE","terminate"),No(S,G),F=new Bi(S,S.j,F),F.M=2,F.A=Tn(Rn(G)),G=!1,a.navigator&&a.navigator.sendBeacon)try{G=a.navigator.sendBeacon(F.A.toString(),"")}catch{}!G&&a.Image&&(new Image().src=F.A,G=!0),G||(F.g=vc(F.j,null),F.g.ea(F.A)),F.F=Date.now(),lc(F)}ha(S)}function Ua(S){S.g&&(yd(S),S.g.cancel(),S.g=null)}function nr(S){Ua(S),S.v&&(a.clearTimeout(S.v),S.v=null),vu(S),S.h.cancel(),S.m&&(typeof S.m=="number"&&a.clearTimeout(S.m),S.m=null)}function ua(S){if(!hc(S.h)&&!S.m){S.m=!0;var F=S.Ea;P||O(),U||(P(),U=!0),j.add(F,S),S.D=0}}function sp(S,F){return Vi(S.h)>=S.h.j-(S.m?1:0)?!1:S.m?(S.i=F.G.concat(S.i),!0):S.I==1||S.I==2||S.D>=(S.Sa?0:S.Ta)?!1:(S.m=tl(c(S.Ea,S,F),ip(S,S.D)),S.D++,!0)}n.Ea=function(S){if(this.m)if(this.m=null,this.I==1){if(!S){this.V=Math.floor(Math.random()*1e5),S=this.V++;const Ie=new Bi(this,this.j,S);let Re=this.o;if(this.U&&(Re?(Re=ie(Re),fe(Re,this.U)):Re=this.U),this.u!==null||this.R||(Ie.J=Re,Re=null),this.S)e:{for(var F=0,G=0;G<this.i.length;G++){t:{var ee=this.i[G];if("__data__"in ee.map&&(ee=ee.map.__data__,typeof ee=="string")){ee=ee.length;break t}ee=void 0}if(ee===void 0)break;if(F+=ee,F>4096){F=G;break e}if(F===4096||G===this.i.length-1){F=G+1;break e}}F=1e3}else F=1e3;F=gu(this,Ie,F),G=Rn(this.J),st(G,"RID",S),st(G,"CVER",22),this.G&&st(G,"X-HTTP-Session-Id",this.G),No(this,G),Re&&(this.R?F="headers="+ot(Va(Re))+"&"+F:this.u&&Zr(G,this.u,Re)),Ma(this.h,Ie),this.Ra&&st(G,"TYPE","init"),this.S?(st(G,"$req",F),st(G,"SID","null"),Ie.U=!0,oa(Ie,G,null)):oa(Ie,G,F),this.I=2}}else this.I==3&&(S?rp(this,S):this.i.length==0||hc(this.h)||rp(this))};function rp(S,F){var G;F?G=F.l:G=S.V++;const ee=Rn(S.J);st(ee,"SID",S.M),st(ee,"RID",G),st(ee,"AID",S.K),No(S,ee),S.u&&S.o&&Zr(ee,S.u,S.o),G=new Bi(S,S.j,G,S.D+1),S.u===null&&(G.J=S.o),F&&(S.i=F.G.concat(S.i)),F=gu(S,G,1e3),G.H=Math.round(S.va*.5)+Math.round(S.va*.5*Math.random()),Ma(S.h,G),oa(G,ee,F)}function No(S,F){S.H&&he(S.H,function(G,ee){st(F,ee,G)}),S.l&&he({},function(G,ee){st(F,ee,G)})}function gu(S,F,G){G=Math.min(S.i.length,G);const ee=S.l?c(S.l.Ka,S.l,S):null;e:{var Ie=S.i;let wt=-1;for(;;){const Kt=["count="+G];wt==-1?G>0?(wt=Ie[0].g,Kt.push("ofs="+wt)):wt=0:Kt.push("ofs="+wt);let yn=!0;for(let rs=0;rs<G;rs++){var Re=Ie[rs].g;const xi=Ie[rs].map;if(Re-=wt,Re<0)wt=Math.max(0,Ie[rs].g-100),yn=!1;else try{Re="req"+Re+"_"||"";try{var Xe=xi instanceof Map?xi:Object.entries(xi);for(const[Gi,wi]of Xe){let da=wi;o(wi)&&(da=ns(wi)),Kt.push(Re+Gi+"="+encodeURIComponent(da))}}catch(Gi){throw Kt.push(Re+"type="+encodeURIComponent("_badmap")),Gi}}catch{ee&&ee(xi)}}if(yn){Xe=Kt.join("&");break e}}Xe=void 0}return S=S.i.splice(0,G),F.G=S,Xe}function md(S){if(!S.g&&!S.v){S.Y=1;var F=S.Da;P||O(),U||(P(),U=!0),j.add(F,S),S.A=0}}function gd(S){return S.g||S.v||S.A>=3?!1:(S.Y++,S.v=tl(c(S.Da,S),ip(S,S.A)),S.A++,!0)}n.Da=function(){if(this.v=null,yu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var S=4*this.T;this.j.info("BP detection timer enabled: "+S),this.B=tl(c(this.Wa,this),S)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ss(10),Ua(this),yu(this))};function yd(S){S.B!=null&&(a.clearTimeout(S.B),S.B=null)}function yu(S){S.g=new Bi(S,S.j,"rpc",S.Y),S.u===null&&(S.g.J=S.o),S.g.P=0;var F=Rn(S.na);st(F,"RID","rpc"),st(F,"SID",S.M),st(F,"AID",S.K),st(F,"CI",S.F?"0":"1"),!S.F&&S.ia&&st(F,"TO",S.ia),st(F,"TYPE","xmlhttp"),No(S,F),S.u&&S.o&&Zr(F,S.u,S.o),S.O&&(S.g.H=S.O);var G=S.g;S=S.ba,G.M=1,G.A=Tn(Rn(F)),G.u=null,G.R=!0,mi(G,S)}n.Va=function(){this.C!=null&&(this.C=null,Ua(this),gd(this),ss(19))};function vu(S){S.C!=null&&(a.clearTimeout(S.C),S.C=null)}function Yr(S,F){var G=null;if(S.g==F){vu(S),yd(S),S.g=null;var ee=2}else if(xo(S.h,F))G=F.G,Fa(S.h,F),ee=1;else return;if(S.I!=0){if(F.o)if(ee==1){G=F.u?F.u.length:0,F=Date.now()-F.F;var Ie=S.D;ee=du(),jt(ee,new Jf(ee,G)),ua(S)}else md(S);else if(Ie=F.m,Ie==3||Ie==0&&F.X>0||!(ee==1&&sp(S,F)||ee==2&&gd(S)))switch(G&&G.length>0&&(F=S.h,F.i=F.i.concat(G)),Ie){case 1:Ga(S,5);break;case 4:Ga(S,10);break;case 3:Ga(S,6);break;default:Ga(S,2)}}}function ip(S,F){let G=S.Qa+Math.floor(Math.random()*S.Za);return S.isActive()||(G*=2),G*F}function Ga(S,F){if(S.j.info("Error code "+F),F==2){var G=c(S.bb,S),ee=S.Ua;const Ie=!ee;ee=new rn(ee||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||yi(ee,"https"),Tn(ee),Ie?il(ee.toString(),G):So(ee.toString(),G)}else ss(2);S.I=0,S.l&&S.l.pa(F),ha(S),nr(S)}n.bb=function(S){S?(this.j.info("Successfully pinged google.com"),ss(2)):(this.j.info("Failed to ping google.com"),ss(1))};function ha(S){if(S.I=0,S.ja=[],S.l){const F=dc(S.h);(F.length!=0||S.i.length!=0)&&(x(S.ja,F),x(S.ja,S.i),S.h.i.length=0,v(S.i),S.i.length=0),S.l.oa()}}function vd(S,F,G){var ee=G instanceof rn?Rn(G):new rn(G);if(ee.g!="")F&&(ee.g=F+"."+ee.g),Ui(ee,ee.u);else{var Ie=a.location;ee=Ie.protocol,F=F?F+"."+Ie.hostname:Ie.hostname,Ie=+Ie.port;const Re=new rn(null);ee&&yi(Re,ee),F&&(Re.g=F),Ie&&Ui(Re,Ie),G&&(Re.h=G),ee=Re}return G=S.G,F=S.wa,G&&F&&st(ee,G,F),st(ee,"VER",S.ka),No(S,ee),ee}function vc(S,F,G){if(F&&!S.L)throw Error("Can't create secondary domain capable XhrIo object.");return F=S.Aa&&!S.ma?new hn(new xt({ab:G})):new hn(S.ma),F.Fa(S.L),F}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function bu(){}n=bu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function _u(){}_u.prototype.g=function(S,F){return new vr(S,F)};function vr(S,F){wn.call(this),this.g=new yc(F),this.l=S,this.h=F&&F.messageUrlParams||null,S=F&&F.messageHeaders||null,F&&F.clientProtocolHeaderRequired&&(S?S["X-Client-Protocol"]="webchannel":S={"X-Client-Protocol":"webchannel"}),this.g.o=S,S=F&&F.initMessageHeaders||null,F&&F.messageContentType&&(S?S["X-WebChannel-Content-Type"]=F.messageContentType:S={"X-WebChannel-Content-Type":F.messageContentType}),F&&F.sa&&(S?S["X-WebChannel-Client-Profile"]=F.sa:S={"X-WebChannel-Client-Profile":F.sa}),this.g.U=S,(S=F&&F.Qb)&&!H(S)&&(this.g.u=S),this.A=F&&F.supportsCrossDomainXhr||!1,this.v=F&&F.sendRawJson||!1,(F=F&&F.httpSessionIdParam)&&!H(F)&&(this.g.G=F,S=this.h,S!==null&&F in S&&(S=this.h,F in S&&delete S[F])),this.j=new cl(this)}p(vr,wn),vr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vr.prototype.close=function(){Pt(this.g)},vr.prototype.o=function(S){var F=this.g;if(typeof S=="string"){var G={};G.__data__=S,S=G}else this.v&&(G={},G.__data__=ns(S),S=G);F.i.push(new pg(F.Ya++,S)),F.I==3&&ua(F)},vr.prototype.N=function(){this.g.l=null,delete this.j,Pt(this.g),delete this.g,vr.Z.N.call(this)};function xu(S){Mi.call(this),S.__headers__&&(this.headers=S.__headers__,this.statusCode=S.__status__,delete S.__headers__,delete S.__status__);var F=S.__sm__;if(F){e:{for(const G in F){S=G;break e}S=void 0}(this.i=S)&&(S=this.i,F=F!==null&&S in F?F[S]:void 0),this.data=F}else this.data=S}p(xu,Mi);function ap(){Kr.call(this),this.status=1}p(ap,Kr);function cl(S){this.g=S}p(cl,bu),cl.prototype.ra=function(){jt(this.g,"a")},cl.prototype.qa=function(S){jt(this.g,new xu(S))},cl.prototype.pa=function(S){jt(this.g,new ap)},cl.prototype.oa=function(){jt(this.g,"b")},_u.prototype.createWebChannel=_u.prototype.g,vr.prototype.send=vr.prototype.o,vr.prototype.open=vr.prototype.m,vr.prototype.close=vr.prototype.close,Rj=function(){return new _u},Aj=function(){return du()},$j=Fi,ON={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ds.NO_ERROR=0,ds.TIMEOUT=8,ds.HTTP_ERROR=6,Wx=ds,er.COMPLETE="complete",kj=er,hu.EventType=hr,hr.OPEN="a",hr.CLOSE="b",hr.ERROR="c",hr.MESSAGE="d",wn.prototype.listen=wn.prototype.J,fy=hu,hn.prototype.listenOnce=hn.prototype.K,hn.prototype.getLastError=hn.prototype.Ha,hn.prototype.getLastErrorCode=hn.prototype.ya,hn.prototype.getStatus=hn.prototype.ca,hn.prototype.getResponseJson=hn.prototype.La,hn.prototype.getResponseText=hn.prototype.la,hn.prototype.send=hn.prototype.ea,hn.prototype.setWithCredentials=hn.prototype.Fa,Cj=hn}).apply(typeof yx<"u"?yx:typeof self<"u"?self:typeof window<"u"?window:{});const JO="@firebase/firestore",eP="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ni.UNAUTHENTICATED=new ni(null),ni.GOOGLE_CREDENTIALS=new ni("google-credentials-uid"),ni.FIRST_PARTY=new ni("first-party-uid"),ni.MOCK_USER=new ni("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bm="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff=new NC("@firebase/firestore");function Bp(){return ff.logLevel}function rt(n,...e){if(ff.logLevel<=en.DEBUG){const t=e.map(FC);ff.debug(`Firestore (${Bm}): ${n}`,...t)}}function Yc(n,...e){if(ff.logLevel<=en.ERROR){const t=e.map(FC);ff.error(`Firestore (${Bm}): ${n}`,...t)}}function fm(n,...e){if(ff.logLevel<=en.WARN){const t=e.map(FC);ff.warn(`Firestore (${Bm}): ${n}`,...t)}}function FC(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,Dj(n,s,t)}function Dj(n,e,t){let s=`FIRESTORE (${Bm}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Yc(s),new Error(s)}function Nn(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||Dj(e,r,s)}function Dt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends rc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xte{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ni.UNAUTHENTICATED)))}shutdown(){}}class wte{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Tte{constructor(e){this.t=e,this.currentUser=ni.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Nn(this.o===void 0,42304);let s=this.i;const r=l=>this.i!==s?(s=this.i,t(l)):Promise.resolve();let i=new Wc;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Wc,e.enqueueRetryable((()=>r(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await r(this.currentUser)}))},o=l=>{rt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(rt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Wc)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(rt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Nn(typeof s.accessToken=="string",31837,{l:s}),new Lj(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Nn(e===null||typeof e=="string",2055,{h:e}),new ni(e)}}class Ste{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=ni.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Ete{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new Ste(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ni.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Nte{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ea(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Nn(this.o===void 0,3512);const s=i=>{i.error!=null&&rt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,rt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>s(i)))};const r=i=>{rt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>r(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):rt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tP(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Nn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new tP(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ite(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=Ite(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%62))}return s}}function tn(n,e){return n<e?-1:n>e?1:0}function PN(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),i=e.charAt(s);if(r!==i)return jE(r)===jE(i)?tn(r,i):jE(r)?1:-1}return tn(n.length,e.length)}const Cte=55296,kte=57343;function jE(n){const e=n.charCodeAt(0);return e>=Cte&&e<=kte}function pm(n,e,t){return n.length===e.length&&n.every(((s,r)=>t(s,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP="__name__";class _l{constructor(e,t,s){t===void 0?t=0:t>e.length&&It(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&It(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return _l.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _l?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=_l.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return tn(e.length,t.length)}static compareSegments(e,t){const s=_l.isNumericId(e),r=_l.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?_l.extractNumericId(e).compare(_l.extractNumericId(t)):PN(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bh.fromString(e.substring(4,e.length-2))}}class qn extends _l{construct(e,t,s){return new qn(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new nt(Be.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((r=>r.length>0)))}return new qn(t)}static emptyPath(){return new qn([])}}const $te=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Or extends _l{construct(e,t,s){return new Or(e,t,s)}static isValidIdentifier(e){return $te.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Or.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nP}static keyField(){return new Or([nP])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new nt(Be.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let a=!1;for(;r<e.length;){const o=e[r];if(o==="\\"){if(r+1===e.length)throw new nt(Be.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new nt(Be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,r+=2}else o==="`"?(a=!a,r++):o!=="."||a?(s+=o,r++):(i(),r++)}if(i(),a)throw new nt(Be.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Or(t)}static emptyPath(){return new Or([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.path=e}static fromPath(e){return new gt(qn.fromString(e))}static fromName(e){return new gt(qn.fromString(e).popFirst(5))}static empty(){return new gt(qn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return qn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new gt(new qn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(n,e,t){if(!t)throw new nt(Be.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Ate(n,e,t,s){if(e===!0&&s===!0)throw new nt(Be.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function sP(n){if(!gt.isDocumentKey(n))throw new nt(Be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rP(n){if(gt.isDocumentKey(n))throw new nt(Be.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Pj(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function R1(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":It(12329,{type:typeof n})}function Gl(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new nt(Be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=R1(n);throw new nt(Be.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hs(n,e){const t={typeString:n};return e&&(t.value=e),t}function Iv(n,e){if(!Pj(n))throw new nt(Be.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const a=n[s];if(r&&typeof a!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${s}' field to equal '${i.value}'`;break}}if(t)throw new nt(Be.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=-62135596800,aP=1e6;class Qn{static now(){return Qn.fromMillis(Date.now())}static fromDate(e){return Qn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*aP);return new Qn(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new nt(Be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new nt(Be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<iP)throw new nt(Be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(Be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/aP}_compareTo(e){return this.seconds===e.seconds?tn(this.nanoseconds,e.nanoseconds):tn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Qn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Iv(e,Qn._jsonSchema))return new Qn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-iP;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Qn._jsonSchemaVersion="firestore/timestamp/1.0",Qn._jsonSchema={type:Hs("string",Qn._jsonSchemaVersion),seconds:Hs("number"),nanoseconds:Hs("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{static fromTimestamp(e){return new $t(e)}static min(){return new $t(new Qn(0,0))}static max(){return new $t(new Qn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy=-1;function Rte(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=$t.fromTimestamp(s===1e9?new Qn(t+1,0):new Qn(t,s));return new Ih(r,gt.empty(),e)}function Dte(n){return new Ih(n.readTime,n.key,zy)}class Ih{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Ih($t.min(),gt.empty(),zy)}static max(){return new Ih($t.max(),gt.empty(),zy)}}function Lte(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=gt.comparator(n.documentKey,e.documentKey),t!==0?t:tn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ote="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Pte{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zm(n){if(n.code!==Be.FAILED_PRECONDITION||n.message!==Ote)throw n;rt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&It(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ue(((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ue?t:Ue.resolve(t)}catch(t){return Ue.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ue.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ue.reject(t)}static resolve(e){return new Ue(((t,s)=>{t(e)}))}static reject(e){return new Ue(((t,s)=>{s(e)}))}static waitFor(e){return new Ue(((t,s)=>{let r=0,i=0,a=!1;e.forEach((o=>{++r,o.next((()=>{++i,a&&i===r&&t()}),(l=>s(l)))})),a=!0,i===r&&t()}))}static or(e){let t=Ue.resolve(!1);for(const s of e)t=t.next((r=>r?Ue.resolve(r):s()));return t}static forEach(e,t){const s=[];return e.forEach(((r,i)=>{s.push(t.call(this,r,i))})),this.waitFor(s)}static mapArray(e,t){return new Ue(((s,r)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next((h=>{a[c]=h,++o,o===i&&s(a)}),(h=>r(h)))}}))}static doWhile(e,t){return new Ue(((s,r)=>{const i=()=>{e()===!0?t().next((()=>{i()}),r):s()};i()}))}}function Mte(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Vm(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}D1.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC=-1;function L1(n){return n==null}function w0(n){return n===0&&1/n==-1/0}function Fte(n){return typeof n=="number"&&Number.isInteger(n)&&!w0(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mj="";function jte(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=oP(e)),e=Bte(n.get(t),e);return oP(e)}function Bte(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="";break;case Mj:t+="";break;default:t+=i}}return t}function oP(n){return n+Mj+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lP(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Kh(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Fj(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,t){this.comparator=e,this.root=t||Dr.EMPTY}insert(e,t){return new vs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dr.BLACK,null,null))}remove(e){return new vs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vx(this.root,e,this.comparator,!1)}getReverseIterator(){return new vx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vx(this.root,e,this.comparator,!0)}}class vx{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dr{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??Dr.RED,this.left=r??Dr.EMPTY,this.right=i??Dr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new Dr(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Dr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Dr.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw It(43730,{key:this.key,value:this.value});if(this.right.isRed())throw It(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw It(27949);return e+(this.isRed()?0:1)}}Dr.EMPTY=null,Dr.RED=!0,Dr.BLACK=!1;Dr.EMPTY=new class{constructor(){this.size=0}get key(){throw It(57766)}get value(){throw It(16141)}get color(){throw It(16727)}get left(){throw It(29726)}get right(){throw It(36894)}copy(e,t,s,r,i){return this}insert(e,t,s){return new Dr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.comparator=e,this.data=new vs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cP(this.data.getIterator())}getIteratorFrom(e){return new cP(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof cr)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new cr(this.comparator);return t.data=e,t}}class cP{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e){this.fields=e,e.sort(Or.comparator)}static empty(){return new Ia([])}unionWith(e){let t=new cr(Or.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Ia(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pm(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new jj("Invalid base64 string: "+i):i}})(e);return new jr(t)}static fromUint8Array(e){const t=(function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i})(e);return new jr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jr.EMPTY_BYTE_STRING=new jr("");const zte=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ch(n){if(Nn(!!n,39018),typeof n=="string"){let e=0;const t=zte.exec(n);if(Nn(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Ls(n.seconds),nanos:Ls(n.nanos)}}function Ls(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function kh(n){return typeof n=="string"?jr.fromBase64String(n):jr.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj="server_timestamp",zj="__type__",Vj="__previous_value__",Uj="__local_write_time__";function zC(n){return(n?.mapValue?.fields||{})[zj]?.stringValue===Bj}function O1(n){const e=n.mapValue.fields[Vj];return zC(e)?O1(e):e}function Vy(n){const e=Ch(n.mapValue.fields[Uj].timestampValue);return new Qn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vte{constructor(e,t,s,r,i,a,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const T0="(default)";class Uy{constructor(e,t){this.projectId=e,this.database=t||T0}static empty(){return new Uy("","")}get isDefaultDatabase(){return this.database===T0}isEqual(e){return e instanceof Uy&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj="__type__",Ute="__max__",bx={mapValue:{}},Wj="__vector__",S0="value";function $h(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?zC(n)?4:Wte(n)?9007199254740991:Gte(n)?10:11:It(28295,{value:n})}function Wl(n,e){if(n===e)return!0;const t=$h(n);if(t!==$h(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Vy(n).isEqual(Vy(e));case 3:return(function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=Ch(r.timestampValue),o=Ch(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,i){return kh(r.bytesValue).isEqual(kh(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,i){return Ls(r.geoPointValue.latitude)===Ls(i.geoPointValue.latitude)&&Ls(r.geoPointValue.longitude)===Ls(i.geoPointValue.longitude)})(n,e);case 2:return(function(r,i){if("integerValue"in r&&"integerValue"in i)return Ls(r.integerValue)===Ls(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=Ls(r.doubleValue),o=Ls(i.doubleValue);return a===o?w0(a)===w0(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return pm(n.arrayValue.values||[],e.arrayValue.values||[],Wl);case 10:case 11:return(function(r,i){const a=r.mapValue.fields||{},o=i.mapValue.fields||{};if(lP(a)!==lP(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Wl(a[l],o[l])))return!1;return!0})(n,e);default:return It(52216,{left:n})}}function Gy(n,e){return(n.values||[]).find((t=>Wl(t,e)))!==void 0}function mm(n,e){if(n===e)return 0;const t=$h(n),s=$h(e);if(t!==s)return tn(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return tn(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const o=Ls(i.integerValue||i.doubleValue),l=Ls(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return uP(n.timestampValue,e.timestampValue);case 4:return uP(Vy(n),Vy(e));case 5:return PN(n.stringValue,e.stringValue);case 6:return(function(i,a){const o=kh(i),l=kh(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const h=tn(o[c],l[c]);if(h!==0)return h}return tn(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const o=tn(Ls(i.latitude),Ls(a.latitude));return o!==0?o:tn(Ls(i.longitude),Ls(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return hP(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const o=i.fields||{},l=a.fields||{},c=o[S0]?.arrayValue,h=l[S0]?.arrayValue,p=tn(c?.values?.length||0,h?.values?.length||0);return p!==0?p:hP(c,h)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===bx.mapValue&&a===bx.mapValue)return 0;if(i===bx.mapValue)return 1;if(a===bx.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let p=0;p<l.length&&p<h.length;++p){const m=PN(l[p],h[p]);if(m!==0)return m;const v=mm(o[l[p]],c[h[p]]);if(v!==0)return v}return tn(l.length,h.length)})(n.mapValue,e.mapValue);default:throw It(23264,{he:t})}}function uP(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return tn(n,e);const t=Ch(n),s=Ch(e),r=tn(t.seconds,s.seconds);return r!==0?r:tn(t.nanos,s.nanos)}function hP(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=mm(t[r],s[r]);if(i)return i}return tn(t.length,s.length)}function gm(n){return MN(n)}function MN(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Ch(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return kh(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return gt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=MN(i);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const a of s)i?i=!1:r+=",",r+=`${a}:${MN(t.fields[a])}`;return r+"}"})(n.mapValue):It(61005,{value:n})}function Hx(n){switch($h(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=O1(n);return e?16+Hx(e):16;case 5:return 2*n.stringValue.length;case 6:return kh(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((r,i)=>r+Hx(i)),0)})(n.arrayValue);case 10:case 11:return(function(s){let r=0;return Kh(s.fields,((i,a)=>{r+=i.length+Hx(a)})),r})(n.mapValue);default:throw It(13486,{value:n})}}function dP(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function FN(n){return!!n&&"integerValue"in n}function VC(n){return!!n&&"arrayValue"in n}function fP(n){return!!n&&"nullValue"in n}function pP(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function qx(n){return!!n&&"mapValue"in n}function Gte(n){return(n?.mapValue?.fields||{})[Gj]?.stringValue===Wj}function Cy(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Kh(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Cy(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Cy(n.arrayValue.values[t]);return e}return{...n}}function Wte(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Ute}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e){this.value=e}static empty(){return new Ji({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!qx(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cy(t)}setAll(e){let t=Or.emptyPath(),s={},r=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,s,r),s={},r=[],t=o.popLast()}a?s[o.lastSegment()]=Cy(a):r.push(o.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());qx(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];qx(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){Kh(t,((r,i)=>e[r]=i));for(const r of s)delete e[r]}clone(){return new Ji(Cy(this.value))}}function Hj(n){const e=[];return Kh(n.fields,((t,s)=>{const r=new Or([t]);if(qx(s)){const i=Hj(s.mapValue).fields;if(i.length===0)e.push(r);else for(const a of i)e.push(r.child(a))}else e.push(r)})),new Ia(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,t,s,r,i,a,o){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new ri(e,0,$t.min(),$t.min(),$t.min(),Ji.empty(),0)}static newFoundDocument(e,t,s,r){return new ri(e,1,t,$t.min(),s,r,0)}static newNoDocument(e,t){return new ri(e,2,t,$t.min(),$t.min(),Ji.empty(),0)}static newUnknownDocument(e,t){return new ri(e,3,t,$t.min(),$t.min(),Ji.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($t.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ji.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ji.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$t.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ri&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ri(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,t){this.position=e,this.inclusive=t}}function mP(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],a=n.position[r];if(i.field.isKeyField()?s=gt.comparator(gt.fromName(a.referenceValue),t.key):s=mm(a,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function gP(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Wl(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,t="asc"){this.field=e,this.dir=t}}function Hte(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{}class Ws extends qj{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new Kte(e,t,s):t==="array-contains"?new Yte(e,s):t==="in"?new Qte(e,s):t==="not-in"?new Jte(e,s):t==="array-contains-any"?new ene(e,s):new Ws(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new Xte(e,s):new Zte(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(mm(t,this.value)):t!==null&&$h(this.value)===$h(t)&&this.matchesComparison(mm(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return It(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qo extends qj{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new qo(e,t)}matches(e){return Kj(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Kj(n){return n.op==="and"}function Xj(n){return qte(n)&&Kj(n)}function qte(n){for(const e of n.filters)if(e instanceof qo)return!1;return!0}function jN(n){if(n instanceof Ws)return n.field.canonicalString()+n.op.toString()+gm(n.value);if(Xj(n))return n.filters.map((e=>jN(e))).join(",");{const e=n.filters.map((t=>jN(t))).join(",");return`${n.op}(${e})`}}function Zj(n,e){return n instanceof Ws?(function(s,r){return r instanceof Ws&&s.op===r.op&&s.field.isEqual(r.field)&&Wl(s.value,r.value)})(n,e):n instanceof qo?(function(s,r){return r instanceof qo&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce(((i,a,o)=>i&&Zj(a,r.filters[o])),!0):!1})(n,e):void It(19439)}function Yj(n){return n instanceof Ws?(function(t){return`${t.field.canonicalString()} ${t.op} ${gm(t.value)}`})(n):n instanceof qo?(function(t){return t.op.toString()+" {"+t.getFilters().map(Yj).join(" ,")+"}"})(n):"Filter"}class Kte extends Ws{constructor(e,t,s){super(e,t,s),this.key=gt.fromName(s.referenceValue)}matches(e){const t=gt.comparator(e.key,this.key);return this.matchesComparison(t)}}class Xte extends Ws{constructor(e,t){super(e,"in",t),this.keys=Qj("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Zte extends Ws{constructor(e,t){super(e,"not-in",t),this.keys=Qj("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Qj(n,e){return(e.arrayValue?.values||[]).map((t=>gt.fromName(t.referenceValue)))}class Yte extends Ws{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return VC(t)&&Gy(t.arrayValue,this.value)}}class Qte extends Ws{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Gy(this.value.arrayValue,t)}}class Jte extends Ws{constructor(e,t){super(e,"not-in",t)}matches(e){if(Gy(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Gy(this.value.arrayValue,t)}}class ene extends Ws{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!VC(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Gy(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tne{constructor(e,t=null,s=[],r=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}}function yP(n,e=null,t=[],s=[],r=null,i=null,a=null){return new tne(n,e,t,s,r,i,a)}function UC(n){const e=Dt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>jN(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(i){return i.field.canonicalString()+i.dir})(s))).join(","),L1(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>gm(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>gm(s))).join(",")),e.Te=t}return e.Te}function GC(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Hte(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Zj(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!gP(n.startAt,e.startAt)&&gP(n.endAt,e.endAt)}function BN(n){return gt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,t=null,s=[],r=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function nne(n,e,t,s,r,i,a,o){return new Cv(n,e,t,s,r,i,a,o)}function WC(n){return new Cv(n)}function vP(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Jj(n){return n.collectionGroup!==null}function ky(n){const e=Dt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new cr(Or.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(o=o.add(c.field))}))})),o})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new N0(i,s))})),t.has(Or.keyField().canonicalString())||e.Ie.push(new N0(Or.keyField(),s))}return e.Ie}function Dl(n){const e=Dt(n);return e.Ee||(e.Ee=sne(e,ky(n))),e.Ee}function sne(n,e){if(n.limitType==="F")return yP(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const i=r.dir==="desc"?"asc":"desc";return new N0(r.field,i)}));const t=n.endAt?new E0(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new E0(n.startAt.position,n.startAt.inclusive):null;return yP(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function zN(n,e){const t=n.filters.concat([e]);return new Cv(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function VN(n,e,t){return new Cv(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function P1(n,e){return GC(Dl(n),Dl(e))&&n.limitType===e.limitType}function e4(n){return`${UC(Dl(n))}|lt:${n.limitType}`}function zp(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((r=>Yj(r))).join(", ")}]`),L1(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((r=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(r))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((r=>gm(r))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((r=>gm(r))).join(",")),`Target(${s})`})(Dl(n))}; limitType=${n.limitType})`}function M1(n,e){return e.isFoundDocument()&&(function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):gt.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)})(n,e)&&(function(s,r){for(const i of ky(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0})(n,e)&&(function(s,r){return!(s.startAt&&!(function(a,o,l){const c=mP(a,o,l);return a.inclusive?c<=0:c<0})(s.startAt,ky(s),r)||s.endAt&&!(function(a,o,l){const c=mP(a,o,l);return a.inclusive?c>=0:c>0})(s.endAt,ky(s),r))})(n,e)}function rne(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function t4(n){return(e,t)=>{let s=!1;for(const r of ky(n)){const i=ine(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function ine(n,e,t){const s=n.field.isKeyField()?gt.comparator(e.key,t.key):(function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?mm(l,c):It(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return It(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Kh(this.inner,((t,s)=>{for(const[r,i]of s)e(r,i)}))}isEmpty(){return Fj(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ane=new vs(gt.comparator);function Qc(){return ane}const n4=new vs(gt.comparator);function py(...n){let e=n4;for(const t of n)e=e.insert(t.key,t);return e}function s4(n){let e=n4;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Xd(){return $y()}function r4(){return $y()}function $y(){return new Bf((n=>n.toString()),((n,e)=>n.isEqual(e)))}const one=new vs(gt.comparator),lne=new cr(gt.comparator);function nn(...n){let e=lne;for(const t of n)e=e.add(t);return e}const cne=new cr(tn);function une(){return cne}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HC(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:w0(e)?"-0":e}}function i4(n){return{integerValue:""+n}}function hne(n,e){return Fte(e)?i4(e):HC(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(){this._=void 0}}function dne(n,e,t){return n instanceof Wy?(function(r,i){const a={fields:{[zj]:{stringValue:Bj},[Uj]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&zC(i)&&(i=O1(i)),i&&(a.fields[Vj]=i),{mapValue:a}})(t,e):n instanceof Hy?o4(n,e):n instanceof qy?l4(n,e):(function(r,i){const a=a4(r,i),o=bP(a)+bP(r.Ae);return FN(a)&&FN(r.Ae)?i4(o):HC(r.serializer,o)})(n,e)}function fne(n,e,t){return n instanceof Hy?o4(n,e):n instanceof qy?l4(n,e):t}function a4(n,e){return n instanceof I0?(function(s){return FN(s)||(function(i){return!!i&&"doubleValue"in i})(s)})(e)?e:{integerValue:0}:null}class Wy extends F1{}class Hy extends F1{constructor(e){super(),this.elements=e}}function o4(n,e){const t=c4(e);for(const s of n.elements)t.some((r=>Wl(r,s)))||t.push(s);return{arrayValue:{values:t}}}class qy extends F1{constructor(e){super(),this.elements=e}}function l4(n,e){let t=c4(e);for(const s of n.elements)t=t.filter((r=>!Wl(r,s)));return{arrayValue:{values:t}}}class I0 extends F1{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function bP(n){return Ls(n.integerValue||n.doubleValue)}function c4(n){return VC(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pne{constructor(e,t){this.field=e,this.transform=t}}function mne(n,e){return n.field.isEqual(e.field)&&(function(s,r){return s instanceof Hy&&r instanceof Hy||s instanceof qy&&r instanceof qy?pm(s.elements,r.elements,Wl):s instanceof I0&&r instanceof I0?Wl(s.Ae,r.Ae):s instanceof Wy&&r instanceof Wy})(n.transform,e.transform)}class gne{constructor(e,t){this.version=e,this.transformResults=t}}class zo{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new zo}static exists(e){return new zo(void 0,e)}static updateTime(e){return new zo(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Kx(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class j1{}function u4(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new d4(n.key,zo.none()):new kv(n.key,n.data,zo.none());{const t=n.data,s=Ji.empty();let r=new cr(Or.comparator);for(let i of e.fields)if(!r.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?s.delete(i):s.set(i,a),r=r.add(i)}return new Xh(n.key,s,new Ia(r.toArray()),zo.none())}}function yne(n,e,t){n instanceof kv?(function(r,i,a){const o=r.value.clone(),l=xP(r.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof Xh?(function(r,i,a){if(!Kx(r.precondition,i))return void i.convertToUnknownDocument(a.version);const o=xP(r.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(h4(r)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(r,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Ay(n,e,t,s){return n instanceof kv?(function(i,a,o,l){if(!Kx(i.precondition,a))return o;const c=i.value.clone(),h=wP(i.fieldTransforms,l,a);return c.setAll(h),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null})(n,e,t,s):n instanceof Xh?(function(i,a,o,l){if(!Kx(i.precondition,a))return o;const c=wP(i.fieldTransforms,l,a),h=a.data;return h.setAll(h4(i)),h.setAll(c),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((p=>p.field)))})(n,e,t,s):(function(i,a,o){return Kx(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function vne(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=a4(s.transform,r||null);i!=null&&(t===null&&(t=Ji.empty()),t.set(s.field,i))}return t||null}function _P(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&pm(s,r,((i,a)=>mne(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class kv extends j1{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Xh extends j1{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function h4(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function xP(n,e,t){const s=new Map;Nn(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const i=n[r],a=i.transform,o=e.data.field(i.field);s.set(i.field,fne(a,o,t[r]))}return s}function wP(n,e,t){const s=new Map;for(const r of n){const i=r.transform,a=t.data.field(r.field);s.set(r.field,dne(i,a,e))}return s}class d4 extends j1{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bne extends j1{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ne{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&yne(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Ay(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Ay(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=r4();return this.mutations.forEach((r=>{const i=e.get(r.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=t.has(r.key)?null:o;const l=u4(a,o);l!==null&&s.set(r.key,l),a.isValidDocument()||a.convertToNoDocument($t.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),nn())}isEqual(e){return this.batchId===e.batchId&&pm(this.mutations,e.mutations,((t,s)=>_P(t,s)))&&pm(this.baseMutations,e.baseMutations,((t,s)=>_P(t,s)))}}class qC{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){Nn(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=(function(){return one})();const i=e.mutations;for(let a=0;a<i.length;a++)r=r.insert(i[a].key,s[a].version);return new qC(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xne{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wne{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Us,fn;function Tne(n){switch(n){case Be.OK:return It(64938);case Be.CANCELLED:case Be.UNKNOWN:case Be.DEADLINE_EXCEEDED:case Be.RESOURCE_EXHAUSTED:case Be.INTERNAL:case Be.UNAVAILABLE:case Be.UNAUTHENTICATED:return!1;case Be.INVALID_ARGUMENT:case Be.NOT_FOUND:case Be.ALREADY_EXISTS:case Be.PERMISSION_DENIED:case Be.FAILED_PRECONDITION:case Be.ABORTED:case Be.OUT_OF_RANGE:case Be.UNIMPLEMENTED:case Be.DATA_LOSS:return!0;default:return It(15467,{code:n})}}function f4(n){if(n===void 0)return Yc("GRPC error has no .code"),Be.UNKNOWN;switch(n){case Us.OK:return Be.OK;case Us.CANCELLED:return Be.CANCELLED;case Us.UNKNOWN:return Be.UNKNOWN;case Us.DEADLINE_EXCEEDED:return Be.DEADLINE_EXCEEDED;case Us.RESOURCE_EXHAUSTED:return Be.RESOURCE_EXHAUSTED;case Us.INTERNAL:return Be.INTERNAL;case Us.UNAVAILABLE:return Be.UNAVAILABLE;case Us.UNAUTHENTICATED:return Be.UNAUTHENTICATED;case Us.INVALID_ARGUMENT:return Be.INVALID_ARGUMENT;case Us.NOT_FOUND:return Be.NOT_FOUND;case Us.ALREADY_EXISTS:return Be.ALREADY_EXISTS;case Us.PERMISSION_DENIED:return Be.PERMISSION_DENIED;case Us.FAILED_PRECONDITION:return Be.FAILED_PRECONDITION;case Us.ABORTED:return Be.ABORTED;case Us.OUT_OF_RANGE:return Be.OUT_OF_RANGE;case Us.UNIMPLEMENTED:return Be.UNIMPLEMENTED;case Us.DATA_LOSS:return Be.DATA_LOSS;default:return It(39323,{code:n})}}(fn=Us||(Us={}))[fn.OK=0]="OK",fn[fn.CANCELLED=1]="CANCELLED",fn[fn.UNKNOWN=2]="UNKNOWN",fn[fn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fn[fn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fn[fn.NOT_FOUND=5]="NOT_FOUND",fn[fn.ALREADY_EXISTS=6]="ALREADY_EXISTS",fn[fn.PERMISSION_DENIED=7]="PERMISSION_DENIED",fn[fn.UNAUTHENTICATED=16]="UNAUTHENTICATED",fn[fn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fn[fn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fn[fn.ABORTED=10]="ABORTED",fn[fn.OUT_OF_RANGE=11]="OUT_OF_RANGE",fn[fn.UNIMPLEMENTED=12]="UNIMPLEMENTED",fn[fn.INTERNAL=13]="INTERNAL",fn[fn.UNAVAILABLE=14]="UNAVAILABLE",fn[fn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sne(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ene=new bh([4294967295,4294967295],0);function TP(n){const e=Sne().encode(n),t=new Ij;return t.update(e),new Uint8Array(t.digest())}function SP(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new bh([t,s],0),new bh([r,i],0)]}class KC{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new my(`Invalid padding: ${t}`);if(s<0)throw new my(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new my(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new my(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=bh.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply(bh.fromNumber(s)));return r.compare(Ene)===1&&(r=new bh([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=TP(e),[s,r]=SP(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(s,r,i);if(!this.we(a))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new KC(i,r,t);return s.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=TP(e),[s,r]=SP(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(s,r,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class my extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,$v.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new B1($t.min(),r,new vs(tn),Qc(),nn())}}class $v{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new $v(s,t,nn(),nn(),nn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class p4{constructor(e,t){this.targetId=e,this.Ce=t}}class m4{constructor(e,t,s=jr.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class EP{constructor(){this.ve=0,this.Fe=NP(),this.Me=jr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nn(),t=nn(),s=nn();return this.Fe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:It(38017,{changeType:i})}})),new $v(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=NP()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Nn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Nne{constructor(e){this.Ge=e,this.ze=new Map,this.je=Qc(),this.Je=_x(),this.He=_x(),this.Ye=new vs(tn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:It(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(BN(i))if(s===0){const a=new gt(i.path);this.et(t,a,ri.newNoDocument(a,$t.min()))}else Nn(s===1,20013,{expectedCount:s});else{const a=this._t(t);if(a!==s){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let a,o;try{a=kh(s).toUint8Array()}catch(l){if(l instanceof jj)return fm("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new KC(a,r,i)}catch(l){return fm(l instanceof my?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach((i=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.et(t,i,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const o=this.ot(a);if(o){if(i.current&&BN(o.target)){const l=new gt(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,ri.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let s=nn();this.He.forEach(((i,a)=>{let o=!0;a.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(s=s.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const r=new B1(e,t,this.Ye,this.je,s);return this.je=Qc(),this.Je=_x(),this.He=_x(),this.Ye=new vs(tn),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new EP,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new cr(tn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new cr(tn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||rt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new EP),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _x(){return new vs(gt.comparator)}function NP(){return new vs(gt.comparator)}const Ine={asc:"ASCENDING",desc:"DESCENDING"},Cne={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kne={and:"AND",or:"OR"};class $ne{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function UN(n,e){return n.useProto3Json||L1(e)?e:{value:e}}function C0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function g4(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Ane(n,e){return C0(n,e.toTimestamp())}function Ll(n){return Nn(!!n,49232),$t.fromTimestamp((function(t){const s=Ch(t);return new Qn(s.seconds,s.nanos)})(n))}function XC(n,e){return GN(n,e).canonicalString()}function GN(n,e){const t=(function(r){return new qn(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function y4(n){const e=qn.fromString(n);return Nn(w4(e),10190,{key:e.toString()}),e}function WN(n,e){return XC(n.databaseId,e.path)}function BE(n,e){const t=y4(e);if(t.get(1)!==n.databaseId.projectId)throw new nt(Be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new nt(Be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new gt(b4(t))}function v4(n,e){return XC(n.databaseId,e)}function Rne(n){const e=y4(n);return e.length===4?qn.emptyPath():b4(e)}function HN(n){return new qn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function b4(n){return Nn(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function IP(n,e,t){return{name:WN(n,e),fields:t.value.mapValue.fields}}function Dne(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:It(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=(function(c,h){return c.useProto3Json?(Nn(h===void 0||typeof h=="string",58123),jr.fromBase64String(h||"")):(Nn(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),jr.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(c){const h=c.code===void 0?Be.UNKNOWN:f4(c.code);return new nt(h,c.message||"")})(a);t=new m4(s,r,i,o||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=BE(n,s.document.name),i=Ll(s.document.updateTime),a=s.document.createTime?Ll(s.document.createTime):$t.min(),o=new Ji({mapValue:{fields:s.document.fields}}),l=ri.newFoundDocument(r,i,a,o),c=s.targetIds||[],h=s.removedTargetIds||[];t=new Xx(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=BE(n,s.document),i=s.readTime?Ll(s.readTime):$t.min(),a=ri.newNoDocument(r,i),o=s.removedTargetIds||[];t=new Xx([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=BE(n,s.document),i=s.removedTargetIds||[];t=new Xx([],i,r,null)}else{if(!("filter"in e))return It(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,a=new wne(r,i),o=s.targetId;t=new p4(o,a)}}return t}function Lne(n,e){let t;if(e instanceof kv)t={update:IP(n,e.key,e.value)};else if(e instanceof d4)t={delete:WN(n,e.key)};else if(e instanceof Xh)t={update:IP(n,e.key,e.data),updateMask:Une(e.fieldMask)};else{if(!(e instanceof bne))return It(16599,{Vt:e.type});t={verify:WN(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(i,a){const o=a.transform;if(o instanceof Wy)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Hy)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof qy)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof I0)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw It(20930,{transform:a.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(r,i){return i.updateTime!==void 0?{updateTime:Ane(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:It(27497)})(n,e.precondition)),t}function One(n,e){return n&&n.length>0?(Nn(e!==void 0,14353),n.map((t=>(function(r,i){let a=r.updateTime?Ll(r.updateTime):Ll(i);return a.isEqual($t.min())&&(a=Ll(i)),new gne(a,r.transformResults||[])})(t,e)))):[]}function Pne(n,e){return{documents:[v4(n,e.path)]}}function Mne(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=v4(n,r);const i=(function(c){if(c.length!==0)return x4(qo.create(c,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(c){if(c.length!==0)return c.map((h=>(function(m){return{field:Vp(m.field),direction:Bne(m.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=UN(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:r}}function Fne(n){let e=Rne(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){Nn(s===1,65062);const h=t.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let i=[];t.where&&(i=(function(p){const m=_4(p);return m instanceof qo&&Xj(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(p){return p.map((m=>(function(x){return new N0(Up(x.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(m)))})(t.orderBy));let o=null;t.limit&&(o=(function(p){let m;return m=typeof p=="object"?p.value:p,L1(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(p){const m=!!p.before,v=p.values||[];return new E0(v,m)})(t.startAt));let c=null;return t.endAt&&(c=(function(p){const m=!p.before,v=p.values||[];return new E0(v,m)})(t.endAt)),nne(e,r,a,i,o,"F",l,c)}function jne(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return It(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function _4(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Up(t.unaryFilter.field);return Ws.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=Up(t.unaryFilter.field);return Ws.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Up(t.unaryFilter.field);return Ws.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Up(t.unaryFilter.field);return Ws.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return It(61313);default:return It(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ws.create(Up(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return It(58110);default:return It(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return qo.create(t.compositeFilter.filters.map((s=>_4(s))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return It(1026)}})(t.compositeFilter.op))})(n):It(30097,{filter:n})}function Bne(n){return Ine[n]}function zne(n){return Cne[n]}function Vne(n){return kne[n]}function Vp(n){return{fieldPath:n.canonicalString()}}function Up(n){return Or.fromServerFormat(n.fieldPath)}function x4(n){return n instanceof Ws?(function(t){if(t.op==="=="){if(pP(t.value))return{unaryFilter:{field:Vp(t.field),op:"IS_NAN"}};if(fP(t.value))return{unaryFilter:{field:Vp(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(pP(t.value))return{unaryFilter:{field:Vp(t.field),op:"IS_NOT_NAN"}};if(fP(t.value))return{unaryFilter:{field:Vp(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vp(t.field),op:zne(t.op),value:t.value}}})(n):n instanceof qo?(function(t){const s=t.getFilters().map((r=>x4(r)));return s.length===1?s[0]:{compositeFilter:{op:Vne(t.op),filters:s}}})(n):It(54877,{filter:n})}function Une(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function w4(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh{constructor(e,t,s,r,i=$t.min(),a=$t.min(),o=jr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new uh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new uh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new uh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new uh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gne{constructor(e){this.yt=e}}function Wne(n){const e=Fne({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?VN(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hne{constructor(){this.Cn=new qne}addToCollectionParentIndex(e,t){return this.Cn.add(t),Ue.resolve()}getCollectionParents(e,t){return Ue.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Ue.resolve()}deleteFieldIndex(e,t){return Ue.resolve()}deleteAllFieldIndexes(e){return Ue.resolve()}createTargetIndexes(e,t){return Ue.resolve()}getDocumentsMatchingTarget(e,t){return Ue.resolve(null)}getIndexType(e,t){return Ue.resolve(0)}getFieldIndexes(e,t){return Ue.resolve([])}getNextCollectionGroupToUpdate(e){return Ue.resolve(null)}getMinOffset(e,t){return Ue.resolve(Ih.min())}getMinOffsetFromCollectionGroup(e,t){return Ue.resolve(Ih.min())}updateCollectionGroup(e,t,s){return Ue.resolve()}updateIndexEntries(e,t){return Ue.resolve()}}class qne{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new cr(qn.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new cr(qn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},T4=41943040;class Yi{static withCacheSize(e){return new Yi(e,Yi.DEFAULT_COLLECTION_PERCENTILE,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yi.DEFAULT_COLLECTION_PERCENTILE=10,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yi.DEFAULT=new Yi(T4,Yi.DEFAULT_COLLECTION_PERCENTILE,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yi.DISABLED=new Yi(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ym(0)}static cr(){return new ym(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kP="LruGarbageCollector",Kne=1048576;function $P([n,e],[t,s]){const r=tn(n,t);return r===0?tn(e,s):r}class Xne{constructor(e){this.Ir=e,this.buffer=new cr($P),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();$P(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Zne{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){rt(kP,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vm(t)?rt(kP,"Ignoring IndexedDB error during garbage collection: ",t):await zm(t)}await this.Vr(3e5)}))}}class Yne{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return Ue.resolve(D1.ce);const s=new Xne(t);return this.mr.forEachTarget(e,(r=>s.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>s.Ar(r))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(rt("LruGarbageCollector","Garbage collection skipped; disabled"),Ue.resolve(CP)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(rt("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),CP):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,i,a,o,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(rt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,a=Date.now(),this.nthSequenceNumber(e,r)))).next((p=>(s=p,o=Date.now(),this.removeTargets(e,s,t)))).next((p=>(i=p,l=Date.now(),this.removeOrphanedDocuments(e,s)))).next((p=>(c=Date.now(),Bp()<=en.DEBUG&&rt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${r} in `+(o-a)+`ms
	Removed ${i} targets in `+(l-o)+`ms
	Removed ${p} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),Ue.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:p}))))}}function Qne(n,e){return new Yne(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jne{constructor(){this.changes=new Bf((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ri.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?Ue.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ese{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tse{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(s=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(s!==null&&Ay(s.mutation,r,Ia.empty(),Qn.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,nn()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=nn()){const r=Xd();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,s).next((i=>{let a=py();return i.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const s=Xd();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,nn())))}populateOverlays(e,t,s){const r=[];return s.forEach((i=>{t.has(i)||r.push(i)})),this.documentOverlayCache.getOverlays(e,r).next((i=>{i.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,s,r){let i=Qc();const a=$y(),o=(function(){return $y()})();return t.forEach(((l,c)=>{const h=s.get(c.key);r.has(c.key)&&(h===void 0||h.mutation instanceof Xh)?i=i.insert(c.key,c):h!==void 0?(a.set(c.key,h.mutation.getFieldMask()),Ay(h.mutation,c,h.mutation.getFieldMask(),Qn.now())):a.set(c.key,Ia.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((c,h)=>a.set(c,h))),t.forEach(((c,h)=>o.set(c,new ese(h,a.get(c)??null)))),o)))}recalculateAndSaveOverlays(e,t){const s=$y();let r=new vs(((a,o)=>a-o)),i=nn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let h=s.get(l)||Ia.empty();h=o.applyToLocalView(c,h),s.set(l,h);const p=(r.get(o.batchId)||nn()).add(l);r=r.insert(o.batchId,p)}))})).next((()=>{const a=[],o=r.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,h=l.value,p=r4();h.forEach((m=>{if(!i.has(m)){const v=u4(t.get(m),s.get(m));v!==null&&p.set(m,v),i=i.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,c,p))}return Ue.waitFor(a)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,r){return(function(a){return gt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Jj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next((i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):Ue.resolve(Xd());let o=zy,l=i;return a.next((c=>Ue.forEach(c,((h,p)=>(o<p.largestBatchId&&(o=p.largestBatchId),i.get(h)?Ue.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{l=l.insert(h,m)}))))).next((()=>this.populateOverlays(e,c,i))).next((()=>this.computeViews(e,l,c,nn()))).next((h=>({batchId:o,changes:s4(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new gt(t)).next((s=>{let r=py();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let a=py();return this.indexManager.getCollectionParents(e,i).next((o=>Ue.forEach(o,(l=>{const c=(function(p,m){return new Cv(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,s,r).next((h=>{h.forEach(((p,m)=>{a=a.insert(p,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r)))).next((a=>{i.forEach(((l,c)=>{const h=c.getKey();a.get(h)===null&&(a=a.insert(h,ri.newInvalidDocument(h)))}));let o=py();return a.forEach(((l,c)=>{const h=i.get(l);h!==void 0&&Ay(h.mutation,c,Ia.empty(),Qn.now()),M1(t,c)&&(o=o.insert(l,c))})),o}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nse{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Ue.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Ll(r.createTime)}})(t)),Ue.resolve()}getNamedQuery(e,t){return Ue.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:Wne(r.bundledQuery),readTime:Ll(r.readTime)}})(t)),Ue.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sse{constructor(){this.overlays=new vs(gt.comparator),this.qr=new Map}getOverlay(e,t){return Ue.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Xd();return Ue.forEach(t,(r=>this.getOverlay(e,r).next((i=>{i!==null&&s.set(r,i)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((r,i)=>{this.St(e,t,i)})),Ue.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(s)),Ue.resolve()}getOverlaysForCollection(e,t,s){const r=Xd(),i=t.length+1,a=new gt(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>s&&r.set(l.getKey(),l)}return Ue.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new vs(((c,h)=>c-h));const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>s){let h=i.get(c.largestBatchId);h===null&&(h=Xd(),i=i.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const o=Xd(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,h)=>o.set(c,h))),!(o.size()>=r)););return Ue.resolve(o)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const a=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(s.key,new xne(t,s));let i=this.qr.get(t);i===void 0&&(i=nn(),this.qr.set(t,i)),this.qr.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rse{constructor(){this.sessionToken=jr.EMPTY_BYTE_STRING}getSessionToken(e){return Ue.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ue.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(){this.Qr=new cr(Tr.$r),this.Ur=new cr(Tr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new Tr(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new Tr(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new gt(new qn([])),s=new Tr(t,e),r=new Tr(t,e+1),i=[];return this.Ur.forEachInRange([s,r],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new gt(new qn([])),s=new Tr(t,e),r=new Tr(t,e+1);let i=nn();return this.Ur.forEachInRange([s,r],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Tr(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Tr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return gt.comparator(e.key,t.key)||tn(e.Yr,t.Yr)}static Kr(e,t){return tn(e.Yr,t.Yr)||gt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ise{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new cr(Tr.$r)}checkEmpty(e){return Ue.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new _ne(i,t,s,r);this.mutationQueue.push(a);for(const o of r)this.Zr=this.Zr.add(new Tr(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Ue.resolve(a)}lookupMutationBatch(e,t){return Ue.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),i=r<0?0:r;return Ue.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ue.resolve(this.mutationQueue.length===0?BC:this.tr-1)}getAllMutationBatches(e){return Ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Tr(t,0),r=new Tr(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],(a=>{const o=this.Xr(a.Yr);i.push(o)})),Ue.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new cr(tn);return t.forEach((r=>{const i=new Tr(r,0),a=new Tr(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(o=>{s=s.add(o.Yr)}))})),Ue.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;gt.isDocumentKey(i)||(i=i.child(""));const a=new Tr(new gt(i),0);let o=new cr(tn);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!s.isPrefixOf(c)&&(c.length===r&&(o=o.add(l.Yr)),!0)}),a),Ue.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((s=>{const r=this.Xr(s);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Nn(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return Ue.forEach(t.mutations,(r=>{const i=new Tr(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new Tr(t,0),r=this.Zr.firstAfterOrEqual(s);return Ue.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ue.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ase{constructor(e){this.ri=e,this.docs=(function(){return new vs(gt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,a=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return Ue.resolve(s?s.document.mutableCopy():ri.newInvalidDocument(t))}getEntries(e,t){let s=Qc();return t.forEach((r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():ri.newInvalidDocument(r))})),Ue.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=Qc();const a=t.path,o=new gt(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Lte(Dte(h),s)<=0||(r.has(h.key)||M1(t,h))&&(i=i.insert(h.key,h.mutableCopy()))}return Ue.resolve(i)}getAllFromCollectionGroup(e,t,s,r){It(9500)}ii(e,t){return Ue.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new ose(this)}getSize(e){return Ue.resolve(this.size)}}class ose extends Jne{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)})),Ue.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lse{constructor(e){this.persistence=e,this.si=new Bf((t=>UC(t)),GC),this.lastRemoteSnapshotVersion=$t.min(),this.highestTargetId=0,this.oi=0,this._i=new ZC,this.targetCount=0,this.ai=ym.ur()}forEachTarget(e,t){return this.si.forEach(((s,r)=>t(r))),Ue.resolve()}getLastRemoteSnapshotVersion(e){return Ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ue.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ue.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),Ue.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ym(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Ue.resolve()}updateTargetData(e,t){return this.Pr(t),Ue.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Ue.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&s.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Ue.waitFor(i).next((()=>r))}getTargetCount(e){return Ue.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return Ue.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),Ue.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((a=>{i.push(r.markPotentiallyOrphaned(e,a))})),Ue.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Ue.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return Ue.resolve(s)}containsKey(e,t){return Ue.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e,t){this.ui={},this.overlays={},this.ci=new D1(0),this.li=!1,this.li=!0,this.hi=new rse,this.referenceDelegate=e(this),this.Pi=new lse(this),this.indexManager=new Hne,this.remoteDocumentCache=(function(r){return new ase(r)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new Gne(t),this.Ii=new nse(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new sse,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new ise(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){rt("MemoryPersistence","Starting transaction:",e);const r=new cse(this.ci.next());return this.referenceDelegate.Ei(),s(r).next((i=>this.referenceDelegate.di(r).next((()=>i)))).toPromise().then((i=>(r.raiseOnCommittedEvent(),i)))}Ai(e,t){return Ue.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class cse extends Pte{constructor(e){super(),this.currentSequenceNumber=e}}class YC{constructor(e){this.persistence=e,this.Ri=new ZC,this.Vi=null}static mi(e){return new YC(e)}get fi(){if(this.Vi)return this.Vi;throw It(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),Ue.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),Ue.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Ue.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((i=>this.fi.add(i.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ue.forEach(this.fi,(s=>{const r=gt.fromPath(s);return this.gi(e,r).next((i=>{i||t.removeEntry(r,$t.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Ue.or([()=>Ue.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class k0{constructor(e,t){this.persistence=e,this.pi=new Bf((s=>jte(s.path)),((s,r)=>s.isEqual(r))),this.garbageCollector=Qne(this,t)}static mi(e,t){return new k0(e,t)}Ei(){}di(e){return Ue.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((r=>s+r))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return Ue.forEach(this.pi,((s,r)=>this.br(e,s,r).next((i=>i?Ue.resolve():t(r)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,(a=>this.br(e,a,t).next((o=>{o||(s++,i.removeEntry(a,$t.min()))})))).next((()=>i.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Ue.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),Ue.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),Ue.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Ue.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Hx(e.data.value)),t}br(e,t,s){return Ue.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return Ue.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=nn(),r=nn();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new QC(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class use{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hse{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return VY()?8:Mte(hi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,r,s).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new use;return this.Ss(e,t,a).next((o=>{if(i.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>i.result))}bs(e,t,s,r){return s.documentReadCount<this.fs?(Bp()<=en.DEBUG&&rt("QueryEngine","SDK will not create cache indexes for query:",zp(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ue.resolve()):(Bp()<=en.DEBUG&&rt("QueryEngine","Query:",zp(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Bp()<=en.DEBUG&&rt("QueryEngine","The SDK decides to create cache indexes for query:",zp(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Dl(t))):Ue.resolve())}ys(e,t){if(vP(t))return Ue.resolve(null);let s=Dl(t);return this.indexManager.getIndexType(e,s).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=VN(t,null,"F"),s=Dl(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((i=>{const a=nn(...i);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,s).next((l=>{const c=this.Ds(t,o);return this.Cs(t,c,a,l.readTime)?this.ys(e,VN(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,s,r){return vP(t)||r.isEqual($t.min())?Ue.resolve(null):this.ps.getDocuments(e,s).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,s,r)?Ue.resolve(null):(Bp()<=en.DEBUG&&rt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),zp(t)),this.vs(e,a,t,Rte(r,zy)).next((o=>o)))}))}Ds(e,t){let s=new cr(t4(e));return t.forEach(((r,i)=>{M1(e,i)&&(s=s.add(i))})),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,s){return Bp()<=en.DEBUG&&rt("QueryEngine","Using full collection scan to execute query:",zp(t)),this.ps.getDocumentsMatchingQuery(e,t,Ih.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC="LocalStore",dse=3e8;class fse{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new vs(tn),this.xs=new Bf((i=>UC(i)),GC),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tse(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function pse(n,e,t,s){return new fse(n,e,t,s)}async function E4(n,e){const t=Dt(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next((i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((i=>{const a=[],o=[];let l=nn();for(const c of r){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of i){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(s,l).next((c=>({Ls:c,removedBatchIds:a,addedBatchIds:o})))}))}))}function mse(n,e){const t=Dt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,c,h){const p=c.batch,m=p.keys();let v=Ue.resolve();return m.forEach((x=>{v=v.next((()=>h.getEntry(l,x))).next((w=>{const T=c.docVersions.get(x);Nn(T!==null,48541),w.version.compareTo(T)<0&&(p.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),h.addEntry(w)))}))})),v.next((()=>o.mutationQueue.removeMutationBatch(l,p)))})(t,s,e,i).next((()=>i.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(o){let l=nn();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(s,r)))}))}function N4(n){const e=Dt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function gse(n,e){const t=Dt(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const o=[];e.targetChanges.forEach(((h,p)=>{const m=r.get(p);if(!m)return;o.push(t.Pi.removeMatchingKeys(i,h.removedDocuments,p).next((()=>t.Pi.addMatchingKeys(i,h.addedDocuments,p))));let v=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(jr.EMPTY_BYTE_STRING,$t.min()).withLastLimboFreeSnapshotVersion($t.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,s)),r=r.insert(p,v),(function(w,T,E){return w.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=dse?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0})(m,v,h)&&o.push(t.Pi.updateTargetData(i,v))}));let l=Qc(),c=nn();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(i,h))})),o.push(yse(i,a,e.documentUpdates).next((h=>{l=h.ks,c=h.qs}))),!s.isEqual($t.min())){const h=t.Pi.getLastRemoteSnapshotVersion(i).next((p=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s)));o.push(h)}return Ue.waitFor(o).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,c))).next((()=>l))})).then((i=>(t.Ms=r,i)))}function yse(n,e,t){let s=nn(),r=nn();return t.forEach((i=>s=s.add(i))),e.getEntries(n,s).next((i=>{let a=Qc();return t.forEach(((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(o)),l.isNoDocument()&&l.version.isEqual($t.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):rt(JC,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)})),{ks:a,qs:r}}))}function vse(n,e){const t=Dt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=BC),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function bse(n,e){const t=Dt(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let r;return t.Pi.getTargetData(s,e).next((i=>i?(r=i,Ue.resolve(r)):t.Pi.allocateTargetId(s).next((a=>(r=new uh(e,a,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next((()=>r)))))))})).then((s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function qN(n,e,t){const s=Dt(n),r=s.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,(a=>s.persistence.referenceDelegate.removeTarget(a,r)))}catch(a){if(!Vm(a))throw a;rt(JC,`Failed to update sequence numbers for target ${e}: ${a}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function AP(n,e,t){const s=Dt(n);let r=$t.min(),i=nn();return s.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,c,h){const p=Dt(l),m=p.xs.get(h);return m!==void 0?Ue.resolve(p.Ms.get(m)):p.Pi.getTargetData(c,h)})(s,a,Dl(e)).next((o=>{if(o)return r=o.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{i=l}))})).next((()=>s.Fs.getDocumentsMatchingQuery(a,e,t?r:$t.min(),t?i:nn()))).next((o=>(_se(s,rne(e),o),{documents:o,Qs:i})))))}function _se(n,e,t){let s=n.Os.get(e)||$t.min();t.forEach(((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)})),n.Os.set(e,s)}class RP{constructor(){this.activeTargetIds=une()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xse{constructor(){this.Mo=new RP,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new RP,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wse{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP="ConnectivityMonitor";class LP{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){rt(DP,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){rt(DP,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xx=null;function KN(){return xx===null?xx=(function(){return 268435456+Math.round(2147483648*Math.random())})():xx++,"0x"+xx.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="RestConnection",Tse={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Sse{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===T0?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,i){const a=KN(),o=this.zo(e,t.toUriEncodedString());rt(zE,`Sending RPC '${e}' ${a}:`,o,s);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,r,i);const{host:c}=new URL(o),h=Wh(c);return this.Jo(e,o,l,s,h).then((p=>(rt(zE,`Received RPC '${e}' ${a}: `,p),p)),(p=>{throw fm(zE,`RPC '${e}' ${a} failed with error: `,p,"url: ",o,"request:",s),p}))}Ho(e,t,s,r,i,a){return this.Go(e,t,s,r,i)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Bm})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,i)=>e[i]=r)),s&&s.headers.forEach(((r,i)=>e[i]=r))}zo(e,t){const s=Tse[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ese{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei="WebChannelConnection";class Nse extends Sse{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,i){const a=KN();return new Promise(((o,l)=>{const c=new Cj;c.setWithCredentials(!0),c.listenOnce(kj.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case Wx.NO_ERROR:const p=c.getResponseJson();rt(ei,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(p)),o(p);break;case Wx.TIMEOUT:rt(ei,`RPC '${e}' ${a} timed out`),l(new nt(Be.DEADLINE_EXCEEDED,"Request time out"));break;case Wx.HTTP_ERROR:const m=c.getStatus();if(rt(ei,`RPC '${e}' ${a} failed with status:`,m,"response text:",c.getResponseText()),m>0){let v=c.getResponseJson();Array.isArray(v)&&(v=v[0]);const x=v?.error;if(x&&x.status&&x.message){const w=(function(E){const C=E.toLowerCase().replace(/_/g,"-");return Object.values(Be).indexOf(C)>=0?C:Be.UNKNOWN})(x.status);l(new nt(w,x.message))}else l(new nt(Be.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new nt(Be.UNAVAILABLE,"Connection failed."));break;default:It(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{rt(ei,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(r);rt(ei,`RPC '${e}' ${a} sending request:`,r),c.send(t,"POST",h,s,15)}))}T_(e,t,s){const r=KN(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Rj(),o=Aj(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,s),l.encodeInitMessageHeaders=!0;const h=i.join("");rt(ei,`Creating RPC '${e}' stream ${r}: ${h}`,l);const p=a.createWebChannel(h,l);this.I_(p);let m=!1,v=!1;const x=new Ese({Yo:T=>{v?rt(ei,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(m||(rt(ei,`Opening RPC '${e}' stream ${r} transport.`),p.open(),m=!0),rt(ei,`RPC '${e}' stream ${r} sending:`,T),p.send(T))},Zo:()=>p.close()}),w=(T,E,C)=>{T.listen(E,($=>{try{C($)}catch(R){setTimeout((()=>{throw R}),0)}}))};return w(p,fy.EventType.OPEN,(()=>{v||(rt(ei,`RPC '${e}' stream ${r} transport opened.`),x.o_())})),w(p,fy.EventType.CLOSE,(()=>{v||(v=!0,rt(ei,`RPC '${e}' stream ${r} transport closed`),x.a_(),this.E_(p))})),w(p,fy.EventType.ERROR,(T=>{v||(v=!0,fm(ei,`RPC '${e}' stream ${r} transport errored. Name:`,T.name,"Message:",T.message),x.a_(new nt(Be.UNAVAILABLE,"The operation could not be completed")))})),w(p,fy.EventType.MESSAGE,(T=>{if(!v){const E=T.data[0];Nn(!!E,16349);const C=E,$=C?.error||C[0]?.error;if($){rt(ei,`RPC '${e}' stream ${r} received error:`,$);const R=$.status;let P=(function(O){const M=Us[O];if(M!==void 0)return f4(M)})(R),U=$.message;P===void 0&&(P=Be.INTERNAL,U="Unknown error status: "+R+" with message "+$.message),v=!0,x.a_(new nt(P,U)),p.close()}else rt(ei,`RPC '${e}' stream ${r} received:`,E),x.u_(E)}})),w(o,$j.STAT_EVENT,(T=>{T.stat===ON.PROXY?rt(ei,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===ON.NOPROXY&&rt(ei,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{x.__()}),0),x}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function VE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(n){return new $ne(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e,t,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&rt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OP="PersistentStream";class C4{constructor(e,t,s,r,i,a,o,l){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new I4(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Be.RESOURCE_EXHAUSTED?(Yc(t.toString()),Yc("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Be.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,r])=>{this.D_===t&&this.G_(s,r)}),(s=>{e((()=>{const r=new nt(Be.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{s((()=>this.z_(r)))})),this.stream.onMessage((r=>{s((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return rt(OP,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(rt(OP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ise extends C4{constructor(e,t,s,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Dne(this.serializer,e),s=(function(i){if(!("targetChange"in i))return $t.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?$t.min():a.readTime?Ll(a.readTime):$t.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=HN(this.serializer),t.addTarget=(function(i,a){let o;const l=a.target;if(o=BN(l)?{documents:Pne(i,l)}:{query:Mne(i,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=g4(i,a.resumeToken);const c=UN(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo($t.min())>0){o.readTime=C0(i,a.snapshotVersion.toTimestamp());const c=UN(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o})(this.serializer,e);const s=jne(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=HN(this.serializer),t.removeTarget=e,this.q_(t)}}class Cse extends C4{constructor(e,t,s,r,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Nn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Nn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Nn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=One(e.writeResults,e.commitTime),s=Ll(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=HN(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>Lne(this.serializer,s)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kse{}class $se extends kse{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new nt(Be.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,GN(t,s),r,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===Be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new nt(Be.UNKNOWN,i.toString())}))}Ho(e,t,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,GN(t,s),r,a,o,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new nt(Be.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Ase{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Yc(t),this.aa=!1):rt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf="RemoteStore";class Rse{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{s.enqueueAndForget((async()=>{zf(this)&&(rt(pf,"Restarting streams for network reachability change."),await(async function(l){const c=Dt(l);c.Ea.add(4),await Av(c),c.Ra.set("Unknown"),c.Ea.delete(4),await V1(c)})(this))}))})),this.Ra=new Ase(s,r)}}async function V1(n){if(zf(n))for(const e of n.da)await e(!0)}async function Av(n){for(const e of n.da)await e(!1)}function k4(n,e){const t=Dt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),sk(t)?nk(t):Um(t).O_()&&tk(t,e))}function ek(n,e){const t=Dt(n),s=Um(t);t.Ia.delete(e),s.O_()&&$4(t,e),t.Ia.size===0&&(s.O_()?s.L_():zf(t)&&t.Ra.set("Unknown"))}function tk(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($t.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Um(n).Y_(e)}function $4(n,e){n.Va.Ue(e),Um(n).Z_(e)}function nk(n){n.Va=new Nne({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Um(n).start(),n.Ra.ua()}function sk(n){return zf(n)&&!Um(n).x_()&&n.Ia.size>0}function zf(n){return Dt(n).Ea.size===0}function A4(n){n.Va=void 0}async function Dse(n){n.Ra.set("Online")}async function Lse(n){n.Ia.forEach(((e,t)=>{tk(n,e)}))}async function Ose(n,e){A4(n),sk(n)?(n.Ra.ha(e),nk(n)):n.Ra.set("Unknown")}async function Pse(n,e,t){if(n.Ra.set("Online"),e instanceof m4&&e.state===2&&e.cause)try{await(async function(r,i){const a=i.cause;for(const o of i.targetIds)r.Ia.has(o)&&(await r.remoteSyncer.rejectListen(o,a),r.Ia.delete(o),r.Va.removeTarget(o))})(n,e)}catch(s){rt(pf,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await $0(n,s)}else if(e instanceof Xx?n.Va.Ze(e):e instanceof p4?n.Va.st(e):n.Va.tt(e),!t.isEqual($t.min()))try{const s=await N4(n.localStore);t.compareTo(s)>=0&&await(function(i,a){const o=i.Va.Tt(a);return o.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(c);h&&i.Ia.set(c,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,c)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(jr.EMPTY_BYTE_STRING,h.snapshotVersion)),$4(i,l);const p=new uh(h.target,l,c,h.sequenceNumber);tk(i,p)})),i.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(s){rt(pf,"Failed to raise snapshot:",s),await $0(n,s)}}async function $0(n,e,t){if(!Vm(e))throw e;n.Ea.add(1),await Av(n),n.Ra.set("Offline"),t||(t=()=>N4(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{rt(pf,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await V1(n)}))}function R4(n,e){return e().catch((t=>$0(n,t,e)))}async function U1(n){const e=Dt(n),t=Ah(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:BC;for(;Mse(e);)try{const r=await vse(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,Fse(e,r)}catch(r){await $0(e,r)}D4(e)&&L4(e)}function Mse(n){return zf(n)&&n.Ta.length<10}function Fse(n,e){n.Ta.push(e);const t=Ah(n);t.O_()&&t.X_&&t.ea(e.mutations)}function D4(n){return zf(n)&&!Ah(n).x_()&&n.Ta.length>0}function L4(n){Ah(n).start()}async function jse(n){Ah(n).ra()}async function Bse(n){const e=Ah(n);for(const t of n.Ta)e.ea(t.mutations)}async function zse(n,e,t){const s=n.Ta.shift(),r=qC.from(s,e,t);await R4(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await U1(n)}async function Vse(n,e){e&&Ah(n).X_&&await(async function(s,r){if((function(a){return Tne(a)&&a!==Be.ABORTED})(r.code)){const i=s.Ta.shift();Ah(s).B_(),await R4(s,(()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r))),await U1(s)}})(n,e),D4(n)&&L4(n)}async function PP(n,e){const t=Dt(n);t.asyncQueue.verifyOperationInProgress(),rt(pf,"RemoteStore received new credentials");const s=zf(t);t.Ea.add(3),await Av(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await V1(t)}async function Use(n,e){const t=Dt(n);e?(t.Ea.delete(2),await V1(t)):e||(t.Ea.add(2),await Av(t),t.Ra.set("Unknown"))}function Um(n){return n.ma||(n.ma=(function(t,s,r){const i=Dt(t);return i.sa(),new Ise(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(n.datastore,n.asyncQueue,{Xo:Dse.bind(null,n),t_:Lse.bind(null,n),r_:Ose.bind(null,n),H_:Pse.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),sk(n)?nk(n):n.Ra.set("Unknown")):(await n.ma.stop(),A4(n))}))),n.ma}function Ah(n){return n.fa||(n.fa=(function(t,s,r){const i=Dt(t);return i.sa(),new Cse(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:jse.bind(null,n),r_:Vse.bind(null,n),ta:Bse.bind(null,n),na:zse.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await U1(n)):(await n.fa.stop(),n.Ta.length>0&&(rt(pf,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Wc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const a=Date.now()+s,o=new rk(e,t,a,r,i);return o.start(s),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(Be.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ik(n,e){if(Yc("AsyncQueue",`${e}: ${n}`),Vm(n))return new nt(Be.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{static emptySet(e){return new nm(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||gt.comparator(t.key,s.key):(t,s)=>gt.comparator(t.key,s.key),this.keyedMap=py(),this.sortedSet=new vs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof nm)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new nm;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(){this.ga=new vs(gt.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):It(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class vm{constructor(e,t,s,r,i,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,s,r,i){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new vm(e,t,nm.emptySet(t),a,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&P1(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gse{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Wse{constructor(){this.queries=FP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=Dt(t),i=r.queries;r.queries=FP(),i.forEach(((a,o)=>{for(const l of o.Sa)l.onError(s)}))})(this,new nt(Be.ABORTED,"Firestore shutting down"))}}function FP(){return new Bf((n=>e4(n)),P1)}async function O4(n,e){const t=Dt(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new Gse,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(a){const o=ik(a,`Initialization of query '${zp(e.query)}' failed`);return void e.onError(o)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&ak(t)}async function P4(n,e){const t=Dt(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function Hse(n,e){const t=Dt(n);let s=!1;for(const r of e){const i=r.query,a=t.queries.get(i);if(a){for(const o of a.Sa)o.Fa(r)&&(s=!0);a.wa=r}}s&&ak(t)}function qse(n,e,t){const s=Dt(n),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);s.queries.delete(e)}function ak(n){n.Ca.forEach((e=>{e.next()}))}var XN,jP;(jP=XN||(XN={})).Ma="default",jP.Cache="cache";class M4{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new vm(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=vm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==XN.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e){this.key=e}}class j4{constructor(e){this.key=e}}class Kse{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=nn(),this.mutatedKeys=nn(),this.eu=t4(e),this.tu=new nm(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new MP,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=r,o=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((h,p)=>{const m=r.get(h),v=M1(this.query,p)?p:null,x=!!m&&this.mutatedKeys.has(m.key),w=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let T=!1;m&&v?m.data.isEqual(v.data)?x!==w&&(s.track({type:3,doc:v}),T=!0):this.su(m,v)||(s.track({type:2,doc:v}),T=!0,(l&&this.eu(v,l)>0||c&&this.eu(v,c)<0)&&(o=!0)):!m&&v?(s.track({type:0,doc:v}),T=!0):m&&!v&&(s.track({type:1,doc:m}),T=!0,(l||c)&&(o=!0)),T&&(v?(a=a.add(v),i=w?i.add(h):i.delete(h)):(a=a.delete(h),i=i.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),i=i.delete(h.key),s.track({type:1,doc:h})}return{tu:a,iu:s,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,p)=>(function(v,x){const w=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return It(20277,{Rt:T})}};return w(v)-w(x)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(s),r=r??!1;const o=t&&!r?this._u():[],l=this.Xa.size===0&&this.current&&!r?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new vm(this.query,e.tu,i,a,e.mutatedKeys,l===0,c,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new MP,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=nn(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new j4(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new F4(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=nn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return vm.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ok="SyncEngine";class Xse{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class Zse{constructor(e){this.key=e,this.hu=!1}}class Yse{constructor(e,t,s,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Bf((o=>e4(o)),P1),this.Iu=new Map,this.Eu=new Set,this.du=new vs(gt.comparator),this.Au=new Map,this.Ru=new ZC,this.Vu={},this.mu=new Map,this.fu=ym.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Qse(n,e,t=!0){const s=W4(n);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await B4(s,e,t,!0),r}async function Jse(n,e){const t=W4(n);await B4(t,e,!0,!1)}async function B4(n,e,t,s){const r=await bse(n.localStore,Dl(e)),i=r.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let o;return s&&(o=await ere(n,e,i,a==="current",r.resumeToken)),n.isPrimaryClient&&t&&k4(n.remoteStore,r),o}async function ere(n,e,t,s,r){n.pu=(p,m,v)=>(async function(w,T,E,C){let $=T.view.ru(E);$.Cs&&($=await AP(w.localStore,T.query,!1).then((({documents:j})=>T.view.ru(j,$))));const R=C&&C.targetChanges.get(T.targetId),P=C&&C.targetMismatches.get(T.targetId)!=null,U=T.view.applyChanges($,w.isPrimaryClient,R,P);return zP(w,T.targetId,U.au),U.snapshot})(n,p,m,v);const i=await AP(n.localStore,e,!0),a=new Kse(e,i.Qs),o=a.ru(i.documents),l=$v.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),c=a.applyChanges(o,n.isPrimaryClient,l);zP(n,t,c.au);const h=new Xse(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function tre(n,e,t){const s=Dt(n),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter((a=>!P1(a,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await qN(s.localStore,r.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(r.targetId),t&&ek(s.remoteStore,r.targetId),ZN(s,r.targetId)})).catch(zm)):(ZN(s,r.targetId),await qN(s.localStore,r.targetId,!0))}async function nre(n,e){const t=Dt(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),ek(t.remoteStore,s.targetId))}async function sre(n,e,t){const s=ure(n);try{const r=await(function(a,o){const l=Dt(a),c=Qn.now(),h=o.reduce(((v,x)=>v.add(x.key)),nn());let p,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let x=Qc(),w=nn();return l.Ns.getEntries(v,h).next((T=>{x=T,x.forEach(((E,C)=>{C.isValidDocument()||(w=w.add(E))}))})).next((()=>l.localDocuments.getOverlayedDocuments(v,x))).next((T=>{p=T;const E=[];for(const C of o){const $=vne(C,p.get(C.key).overlayedDocument);$!=null&&E.push(new Xh(C.key,$,Hj($.value.mapValue),zo.exists(!0)))}return l.mutationQueue.addMutationBatch(v,c,E,o)})).next((T=>{m=T;const E=T.applyToLocalDocumentSet(p,w);return l.documentOverlayCache.saveOverlays(v,T.batchId,E)}))})).then((()=>({batchId:m.batchId,changes:s4(p)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),(function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new vs(tn)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c})(s,r.batchId,t),await Rv(s,r.changes),await U1(s.remoteStore)}catch(r){const i=ik(r,"Failed to persist write");t.reject(i)}}async function z4(n,e){const t=Dt(n);try{const s=await gse(t.localStore,e);e.targetChanges.forEach(((r,i)=>{const a=t.Au.get(i);a&&(Nn(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?a.hu=!0:r.modifiedDocuments.size>0?Nn(a.hu,14607):r.removedDocuments.size>0&&(Nn(a.hu,42227),a.hu=!1))})),await Rv(t,s,e)}catch(s){await zm(s)}}function BP(n,e,t){const s=Dt(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach(((i,a)=>{const o=a.view.va(e);o.snapshot&&r.push(o.snapshot)})),(function(a,o){const l=Dt(a);l.onlineState=o;let c=!1;l.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(o)&&(c=!0)})),c&&ak(l)})(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function rre(n,e,t){const s=Dt(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),i=r&&r.key;if(i){let a=new vs(gt.comparator);a=a.insert(i,ri.newNoDocument(i,$t.min()));const o=nn().add(i),l=new B1($t.min(),new Map,new vs(tn),a,o);await z4(s,l),s.du=s.du.remove(i),s.Au.delete(e),lk(s)}else await qN(s.localStore,e,!1).then((()=>ZN(s,e,t))).catch(zm)}async function ire(n,e){const t=Dt(n),s=e.batch.batchId;try{const r=await mse(t.localStore,e);U4(t,s,null),V4(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Rv(t,r)}catch(r){await zm(r)}}async function are(n,e,t){const s=Dt(n);try{const r=await(function(a,o){const l=Dt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let h;return l.mutationQueue.lookupMutationBatch(c,o).next((p=>(Nn(p!==null,37113),h=p.keys(),l.mutationQueue.removeMutationBatch(c,p)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h))).next((()=>l.localDocuments.getDocuments(c,h)))}))})(s.localStore,e);U4(s,e,t),V4(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Rv(s,r)}catch(r){await zm(r)}}function V4(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function U4(n,e,t){const s=Dt(n);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function ZN(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||G4(n,s)}))}function G4(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(ek(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),lk(n))}function zP(n,e,t){for(const s of t)s instanceof F4?(n.Ru.addReference(s.key,e),ore(n,s)):s instanceof j4?(rt(ok,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||G4(n,s.key)):It(19791,{wu:s})}function ore(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(rt(ok,"New document in limbo: "+t),n.Eu.add(s),lk(n))}function lk(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new gt(qn.fromString(e)),s=n.fu.next();n.Au.set(s,new Zse(t)),n.du=n.du.insert(t,s),k4(n.remoteStore,new uh(Dl(WC(t.path)),s,"TargetPurposeLimboResolution",D1.ce))}}async function Rv(n,e,t){const s=Dt(n),r=[],i=[],a=[];s.Tu.isEmpty()||(s.Tu.forEach(((o,l)=>{a.push(s.pu(l,e,t).then((c=>{if((c||t)&&s.isPrimaryClient){const h=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;s.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){r.push(c);const h=QC.As(l.targetId,c);i.push(h)}})))})),await Promise.all(a),s.Pu.H_(r),await(async function(l,c){const h=Dt(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>Ue.forEach(c,(m=>Ue.forEach(m.Es,(v=>h.persistence.referenceDelegate.addReference(p,m.targetId,v))).next((()=>Ue.forEach(m.ds,(v=>h.persistence.referenceDelegate.removeReference(p,m.targetId,v)))))))))}catch(p){if(!Vm(p))throw p;rt(JC,"Failed to update sequence numbers: "+p)}for(const p of c){const m=p.targetId;if(!p.fromCache){const v=h.Ms.get(m),x=v.snapshotVersion,w=v.withLastLimboFreeSnapshotVersion(x);h.Ms=h.Ms.insert(m,w)}}})(s.localStore,i))}async function lre(n,e){const t=Dt(n);if(!t.currentUser.isEqual(e)){rt(ok,"User change. New user:",e.toKey());const s=await E4(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((o=>{o.forEach((l=>{l.reject(new nt(Be.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Rv(t,s.Ls)}}function cre(n,e){const t=Dt(n),s=t.Au.get(e);if(s&&s.hu)return nn().add(s.key);{let r=nn();const i=t.Iu.get(e);if(!i)return r;for(const a of i){const o=t.Tu.get(a);r=r.unionWith(o.view.nu)}return r}}function W4(n){const e=Dt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=z4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=cre.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rre.bind(null,e),e.Pu.H_=Hse.bind(null,e.eventManager),e.Pu.yu=qse.bind(null,e.eventManager),e}function ure(n){const e=Dt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ire.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=are.bind(null,e),e}class A0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=z1(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return pse(this.persistence,new hse,e.initialUser,this.serializer)}Cu(e){return new S4(YC.mi,this.serializer)}Du(e){return new xse}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}A0.provider={build:()=>new A0};class hre extends A0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Nn(this.persistence.referenceDelegate instanceof k0,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new Zne(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Yi.withCacheSize(this.cacheSizeBytes):Yi.DEFAULT;return new S4((s=>k0.mi(s,t)),this.serializer)}}class YN{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>BP(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=lre.bind(null,this.syncEngine),await Use(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Wse})()}createDatastore(e){const t=z1(e.databaseInfo.databaseId),s=(function(i){return new Nse(i)})(e.databaseInfo);return(function(i,a,o,l){return new $se(i,a,o,l)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,r,i,a,o){return new Rse(s,r,i,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>BP(this.syncEngine,t,0)),(function(){return LP.v()?new LP:new wse})())}createSyncEngine(e,t){return(function(r,i,a,o,l,c,h){const p=new Yse(r,i,a,o,l,c);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=Dt(t);rt(pf,"RemoteStore shutting down."),s.Ea.add(5),await Av(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}YN.provider={build:()=>new YN};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Yc("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rh="FirestoreClient";class dre{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=ni.UNAUTHENTICATED,this.clientId=jC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,(async a=>{rt(Rh,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(s,(a=>(rt(Rh,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=ik(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function UE(n,e){n.asyncQueue.verifyOperationInProgress(),rt(Rh,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async r=>{s.isEqual(r)||(await E4(e.localStore,r),s=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function VP(n,e){n.asyncQueue.verifyOperationInProgress();const t=await fre(n);rt(Rh,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>PP(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,r)=>PP(e.remoteStore,r))),n._onlineComponents=e}async function fre(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){rt(Rh,"Using user provided OfflineComponentProvider");try{await UE(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===Be.FAILED_PRECONDITION||r.code===Be.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;fm("Error using user provided cache. Falling back to memory cache: "+t),await UE(n,new A0)}}else rt(Rh,"Using default OfflineComponentProvider"),await UE(n,new hre(void 0));return n._offlineComponents}async function q4(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(rt(Rh,"Using user provided OnlineComponentProvider"),await VP(n,n._uninitializedComponentsProvider._online)):(rt(Rh,"Using default OnlineComponentProvider"),await VP(n,new YN))),n._onlineComponents}function pre(n){return q4(n).then((e=>e.syncEngine))}async function K4(n){const e=await q4(n),t=e.eventManager;return t.onListen=Qse.bind(null,e.syncEngine),t.onUnlisten=tre.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Jse.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=nre.bind(null,e.syncEngine),t}function mre(n,e,t={}){const s=new Wc;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,o,l,c){const h=new H4({next:m=>{h.Nu(),a.enqueueAndForget((()=>P4(i,p)));const v=m.docs.has(o);!v&&m.fromCache?c.reject(new nt(Be.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&l&&l.source==="server"?c.reject(new nt(Be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new M4(WC(o.path),h,{includeMetadataChanges:!0,qa:!0});return O4(i,p)})(await K4(n),n.asyncQueue,e,t,s))),s.promise}function gre(n,e,t={}){const s=new Wc;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,o,l,c){const h=new H4({next:m=>{h.Nu(),a.enqueueAndForget((()=>P4(i,p))),m.fromCache&&l.source==="server"?c.reject(new nt(Be.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new M4(o,h,{includeMetadataChanges:!0,qa:!0});return O4(i,p)})(await K4(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X4(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UP=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4="firestore.googleapis.com",GP=!0;class WP{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new nt(Be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Z4,this.ssl=GP}else this.host=e.host,this.ssl=e.ssl??GP;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=T4;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Kne)throw new nt(Be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ate("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=X4(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new nt(Be.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new nt(Be.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new nt(Be.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,r){return s.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class G1{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new WP({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(Be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(Be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new WP(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new xte;switch(s.type){case"firstParty":return new Ete(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new nt(Be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=UP.get(t);s&&(rt("ComponentProvider","Removing Datastore"),UP.delete(t),s.terminate())})(this),Promise.resolve()}}function yre(n,e,t,s={}){n=Gl(n,G1);const r=Wh(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;r&&(SC(`https://${o}`),EC("Firestore",!0)),i.host!==Z4&&i.host!==o&&fm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:o,ssl:r,emulatorOptions:s};if(!cf(l,a)&&(n._setSettings(l),s.mockUserToken)){let c,h;if(typeof s.mockUserToken=="string")c=s.mockUserToken,h=ni.MOCK_USER;else{c=zF(s.mockUserToken,n._app?.options.projectId);const p=s.mockUserToken.sub||s.mockUserToken.user_id;if(!p)throw new nt(Be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ni(p)}n._authCredentials=new wte(new Lj(c,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Gm(this.firestore,e,this._query)}}class Ps{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _h(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ps(this.firestore,e,this._key)}toJSON(){return{type:Ps._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Iv(t,Ps._jsonSchema))return new Ps(e,s||null,new gt(qn.fromString(t.referencePath)))}}Ps._jsonSchemaVersion="firestore/documentReference/1.0",Ps._jsonSchema={type:Hs("string",Ps._jsonSchemaVersion),referencePath:Hs("string")};class _h extends Gm{constructor(e,t,s){super(e,t,WC(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ps(this.firestore,null,new gt(e))}withConverter(e){return new _h(this.firestore,e,this._path)}}function Dh(n,e,...t){if(n=Ms(n),Oj("collection","path",e),n instanceof G1){const s=qn.fromString(e,...t);return rP(s),new _h(n,null,s)}{if(!(n instanceof Ps||n instanceof _h))throw new nt(Be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(qn.fromString(e,...t));return rP(s),new _h(n.firestore,null,s)}}function Hl(n,e,...t){if(n=Ms(n),arguments.length===1&&(e=jC.newId()),Oj("doc","path",e),n instanceof G1){const s=qn.fromString(e,...t);return sP(s),new Ps(n,null,new gt(s))}{if(!(n instanceof Ps||n instanceof _h))throw new nt(Be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(qn.fromString(e,...t));return sP(s),new Ps(n.firestore,n instanceof _h?n.converter:null,new gt(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP="AsyncQueue";class qP{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new I4(this,"async_queue_retry"),this._c=()=>{const s=VE();s&&rt(HP,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=VE();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=VE();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Wc;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Vm(e))throw e;rt(HP,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Yc("INTERNAL UNHANDLED ERROR: ",KP(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=rk.createAndSchedule(this,e,t,s,(i=>this.hc(i)));return this.tc.push(r),r}uc(){this.nc&&It(47125,{Pc:KP(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function KP(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Wm extends G1{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new qP,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qP(e),this._firestoreClient=void 0,await e}}}function vre(n,e){const t=typeof n=="object"?n:CC(),s=typeof n=="string"?n:T0,r=C1(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=FF("firestore");i&&yre(r,...i)}return r}function ck(n){if(n._terminated)throw new nt(Be.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bre(n),n._firestoreClient}function bre(n){const e=n._freezeSettings(),t=(function(r,i,a,o){return new Vte(r,i,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,X4(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new dre(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const i=r?._online.build();return{_offline:r?._offline.build(i),_online:i}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e){this._byteString=e}static fromBase64String(e){try{return new no(jr.fromBase64String(e))}catch(t){throw new nt(Be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new no(jr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:no._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Iv(e,no._jsonSchema))return no.fromBase64String(e.bytes)}}no._jsonSchemaVersion="firestore/bytes/1.0",no._jsonSchema={type:Hs("string",no._jsonSchemaVersion),bytes:Hs("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new nt(Be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Or(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new nt(Be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new nt(Be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tn(this._lat,e._lat)||tn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ol._jsonSchemaVersion}}static fromJSON(e){if(Iv(e,Ol._jsonSchema))return new Ol(e.latitude,e.longitude)}}Ol._jsonSchemaVersion="firestore/geoPoint/1.0",Ol._jsonSchema={type:Hs("string",Ol._jsonSchemaVersion),latitude:Hs("number"),longitude:Hs("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Pl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Iv(e,Pl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Pl(e.vectorValues);throw new nt(Be.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Pl._jsonSchemaVersion="firestore/vectorValue/1.0",Pl._jsonSchema={type:Hs("string",Pl._jsonSchemaVersion),vectorValues:Hs("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _re=/^__.*__$/;class xre{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Xh(e,this.data,this.fieldMask,t,this.fieldTransforms):new kv(e,this.data,t,this.fieldTransforms)}}class Y4{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Xh(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Q4(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw It(40011,{Ac:n})}}class uk{constructor(e,t,s,r,i,a){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new uk({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return R0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Q4(this.Ac)&&_re.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class wre{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||z1(e)}Cc(e,t,s,r=!1){return new uk({Ac:e,methodName:t,Dc:s,path:Or.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function q1(n){const e=n._freezeSettings(),t=z1(n._databaseId);return new wre(n._databaseId,!!e.ignoreUndefinedProperties,t)}function J4(n,e,t,s,r,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,r);dk("Data must be an object, but it was:",a,s);const o=eB(s,a);let l,c;if(i.merge)l=new Ia(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const h=[];for(const p of i.mergeFields){const m=QN(e,p,t);if(!a.contains(m))throw new nt(Be.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);nB(h,m)||h.push(m)}l=new Ia(h),c=a.fieldTransforms.filter((p=>l.covers(p.field)))}else l=null,c=a.fieldTransforms;return new xre(new Ji(o),l,c)}class K1 extends H1{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof K1}}class hk extends H1{_toFieldTransform(e){return new pne(e.path,new Wy)}isEqual(e){return e instanceof hk}}function Tre(n,e,t,s){const r=n.Cc(1,e,t);dk("Data must be an object, but it was:",r,s);const i=[],a=Ji.empty();Kh(s,((l,c)=>{const h=fk(e,l,t);c=Ms(c);const p=r.yc(h);if(c instanceof K1)i.push(h);else{const m=Dv(c,p);m!=null&&(i.push(h),a.set(h,m))}}));const o=new Ia(i);return new Y4(a,o,r.fieldTransforms)}function Sre(n,e,t,s,r,i){const a=n.Cc(1,e,t),o=[QN(e,s,t)],l=[r];if(i.length%2!=0)throw new nt(Be.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)o.push(QN(e,i[m])),l.push(i[m+1]);const c=[],h=Ji.empty();for(let m=o.length-1;m>=0;--m)if(!nB(c,o[m])){const v=o[m];let x=l[m];x=Ms(x);const w=a.yc(v);if(x instanceof K1)c.push(v);else{const T=Dv(x,w);T!=null&&(c.push(v),h.set(v,T))}}const p=new Ia(c);return new Y4(h,p,a.fieldTransforms)}function Ere(n,e,t,s=!1){return Dv(t,n.Cc(s?4:3,e))}function Dv(n,e){if(tB(n=Ms(n)))return dk("Unsupported field value:",e,n),eB(n,e);if(n instanceof H1)return(function(s,r){if(!Q4(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,r){const i=[];let a=0;for(const o of s){let l=Dv(o,r.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(s,r){if((s=Ms(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return hne(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=Qn.fromDate(s);return{timestampValue:C0(r.serializer,i)}}if(s instanceof Qn){const i=new Qn(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:C0(r.serializer,i)}}if(s instanceof Ol)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof no)return{bytesValue:g4(r.serializer,s._byteString)};if(s instanceof Ps){const i=r.databaseId,a=s.firestore._databaseId;if(!a.isEqual(i))throw r.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:XC(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Pl)return(function(a,o){return{mapValue:{fields:{[Gj]:{stringValue:Wj},[S0]:{arrayValue:{values:a.toArray().map((c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return HC(o.serializer,c)}))}}}}}})(s,r);throw r.Sc(`Unsupported field value: ${R1(s)}`)})(n,e)}function eB(n,e){const t={};return Fj(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Kh(n,((s,r)=>{const i=Dv(r,e.mc(s));i!=null&&(t[s]=i)})),{mapValue:{fields:t}}}function tB(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Qn||n instanceof Ol||n instanceof no||n instanceof Ps||n instanceof H1||n instanceof Pl)}function dk(n,e,t){if(!tB(t)||!Pj(t)){const s=R1(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function QN(n,e,t){if((e=Ms(e))instanceof W1)return e._internalPath;if(typeof e=="string")return fk(n,e);throw R0("Field path arguments must be of type string or ",n,!1,void 0,t)}const Nre=new RegExp("[~\\*/\\[\\]]");function fk(n,e,t){if(e.search(Nre)>=0)throw R0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new W1(...e.split("."))._internalPath}catch{throw R0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function R0(n,e,t,s,r){const i=s&&!s.isEmpty(),a=r!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${s}`),a&&(l+=` in document ${r}`),l+=")"),new nt(Be.INVALID_ARGUMENT,o+n+l)}function nB(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ps(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Ire(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(pk("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Ire extends sB{data(){return super.data()}}function pk(n,e){return typeof e=="string"?fk(n,e):e instanceof W1?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cre(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new nt(Be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mk{}class kre extends mk{}function Yp(n,e,...t){let s=[];e instanceof mk&&s.push(e),s=s.concat(t),(function(i){const a=i.filter((l=>l instanceof gk)).length,o=i.filter((l=>l instanceof X1)).length;if(a>1||a>0&&o>0)throw new nt(Be.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const r of s)n=r._apply(n);return n}class X1 extends kre{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new X1(e,t,s)}_apply(e){const t=this._parse(e);return rB(e._query,t),new Gm(e.firestore,e.converter,zN(e._query,t))}_parse(e){const t=q1(e.firestore);return(function(i,a,o,l,c,h,p){let m;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new nt(Be.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ZP(p,h);const x=[];for(const w of p)x.push(XP(l,i,w));m={arrayValue:{values:x}}}else m=XP(l,i,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ZP(p,h),m=Ere(o,a,p,h==="in"||h==="not-in");return Ws.create(c,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Qp(n,e,t){const s=e,r=pk("where",n);return X1._create(r,s,t)}class gk extends mk{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new gk(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:qo.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,i){let a=r;const o=i.getFlattenedFilters();for(const l of o)rB(a,l),a=zN(a,l)})(e._query,t),new Gm(e.firestore,e.converter,zN(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function XP(n,e,t){if(typeof(t=Ms(t))=="string"){if(t==="")throw new nt(Be.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Jj(e)&&t.indexOf("/")!==-1)throw new nt(Be.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(qn.fromString(t));if(!gt.isDocumentKey(s))throw new nt(Be.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return dP(n,new gt(s))}if(t instanceof Ps)return dP(n,t._key);throw new nt(Be.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${R1(t)}.`)}function ZP(n,e){if(!Array.isArray(n)||n.length===0)throw new nt(Be.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function rB(n,e){const t=(function(r,i){for(const a of r)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new nt(Be.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(Be.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class $re{convertValue(e,t="none"){switch($h(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ls(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(kh(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw It(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Kh(e,((r,i)=>{s[r]=this.convertValue(i,t)})),s}convertVectorValue(e){const t=e.fields?.[S0].arrayValue?.values?.map((s=>Ls(s.doubleValue)));return new Pl(t)}convertGeoPoint(e){return new Ol(Ls(e.latitude),Ls(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=O1(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Vy(e));default:return null}}convertTimestamp(e){const t=Ch(e);return new Qn(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=qn.fromString(e);Nn(w4(s),9688,{name:e});const r=new Uy(s.get(1),s.get(3)),i=new gt(s.popFirst(5));return r.isEqual(t)||Yc(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iB(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class gy{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jd extends sB{constructor(e,t,s,r,i,a){super(e,t,s,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Zx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(pk("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Be.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Jd._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Jd._jsonSchemaVersion="firestore/documentSnapshot/1.0",Jd._jsonSchema={type:Hs("string",Jd._jsonSchemaVersion),bundleSource:Hs("string","DocumentSnapshot"),bundleName:Hs("string"),bundle:Hs("string")};class Zx extends Jd{data(e={}){return super.data(e)}}class sm{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new gy(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Zx(this._firestore,this._userDataWriter,s.key,s,new gy(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new nt(Be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map((o=>{const l=new Zx(r._firestore,r._userDataWriter,o.doc.key,o.doc,new gy(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((o=>i||o.type!==3)).map((o=>{const l=new Zx(r._firestore,r._userDataWriter,o.doc.key,o.doc,new gy(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,h=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:Are(o.type),doc:l,oldIndex:c,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Be.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=sm._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jC.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Are(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return It(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yk(n){n=Gl(n,Ps);const e=Gl(n.firestore,Wm);return mre(ck(e),n._key).then((t=>Rre(e,n,t)))}sm._jsonSchemaVersion="firestore/querySnapshot/1.0",sm._jsonSchema={type:Hs("string",sm._jsonSchemaVersion),bundleSource:Hs("string","QuerySnapshot"),bundleName:Hs("string"),bundle:Hs("string")};class aB extends $re{constructor(e){super(),this.firestore=e}convertBytes(e){return new no(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ps(this.firestore,null,t)}}function Mc(n){n=Gl(n,Gm);const e=Gl(n.firestore,Wm),t=ck(e),s=new aB(e);return Cre(n._query),gre(t,n._query).then((r=>new sm(e,s,n,r)))}function oB(n,e,t){n=Gl(n,Ps);const s=Gl(n.firestore,Wm),r=iB(n.converter,e,t);return vk(s,[J4(q1(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,zo.none())])}function D0(n,e,t,...s){n=Gl(n,Ps);const r=Gl(n.firestore,Wm),i=q1(r);let a;return a=typeof(e=Ms(e))=="string"||e instanceof W1?Sre(i,"updateDoc",n._key,e,t,s):Tre(i,"updateDoc",n._key,e),vk(r,[a.toMutation(n._key,zo.exists(!0))])}function lB(n,e){const t=Gl(n.firestore,Wm),s=Hl(n),r=iB(n.converter,e);return vk(t,[J4(q1(n.firestore),"addDoc",s._key,r,n.converter!==null,{}).toMutation(s._key,zo.exists(!1))]).then((()=>s))}function vk(n,e){return(function(s,r){const i=new Wc;return s.asyncQueue.enqueueAndForget((async()=>sre(await pre(s),r,i))),i.promise})(ck(n),e)}function Rre(n,e,t){const s=t.docs.get(e._key),r=new aB(n);return new Jd(n,r,e._key,s,new gy(t.hasPendingWrites,t.fromCache),e.converter)}function cB(){return new hk("serverTimestamp")}(function(e,t=!0){(function(r){Bm=r})(Ff),uf(new Nh("firestore",((s,{instanceIdentifier:r,options:i})=>{const a=s.getProvider("app").getImmediate(),o=new Wm(new Tte(s.getProvider("auth-internal")),new Nte(a,s.getProvider("app-check-internal")),(function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new nt(Be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Uy(c.options.projectId,h)})(a,r),a);return i={useFetchStreams:t,...i},o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),$l(JO,eP,e),$l(JO,eP,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uB="firebasestorage.googleapis.com",hB="storageBucket",Dre=120*1e3,Lre=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns extends rc{constructor(e,t,s=0){super(GE(e),`Firebase Storage: ${t} (${GE(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ns.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return GE(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ss;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ss||(Ss={}));function GE(n){return"storage/"+n}function bk(){const n="An unknown error occurred, please check the error payload for server response.";return new Ns(Ss.UNKNOWN,n)}function Ore(n){return new Ns(Ss.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Pre(n){return new Ns(Ss.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Mre(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ns(Ss.UNAUTHENTICATED,n)}function Fre(){return new Ns(Ss.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function jre(n){return new Ns(Ss.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Bre(){return new Ns(Ss.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zre(){return new Ns(Ss.CANCELED,"User canceled the upload/download.")}function Vre(n){return new Ns(Ss.INVALID_URL,"Invalid URL '"+n+"'.")}function Ure(n){return new Ns(Ss.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Gre(){return new Ns(Ss.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+hB+"' property when initializing the app?")}function Wre(){return new Ns(Ss.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Hre(){return new Ns(Ss.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function qre(n){return new Ns(Ss.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function JN(n){return new Ns(Ss.INVALID_ARGUMENT,n)}function dB(){return new Ns(Ss.APP_DELETED,"The Firebase app was deleted.")}function Kre(n){return new Ns(Ss.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ry(n,e){return new Ns(Ss.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function ry(n){throw new Ns(Ss.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Ca.makeFromUrl(e,t)}catch{return new Ca(e,"")}if(s.path==="")return s;throw Ure(e)}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+r+a,"i"),l={bucket:1,path:3};function c(R){R.path_=decodeURIComponent(R.path)}const h="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${p}/${h}/b/${r}/o${m}`,"i"),x={bucket:1,path:3},w=t===uB?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",E=new RegExp(`^https?://${w}/${r}/${T}`,"i"),$=[{regex:o,indices:l,postModify:i},{regex:v,indices:x,postModify:c},{regex:E,indices:{bucket:1,path:2},postModify:c}];for(let R=0;R<$.length;R++){const P=$[R],U=P.regex.exec(e);if(U){const j=U[P.indices.bucket];let O=U[P.indices.path];O||(O=""),s=new Ca(j,O),P.postModify(s);break}}if(s==null)throw Vre(e);return s}}class Xre{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zre(n,e,t){let s=1,r=null,i=null,a=!1,o=0;function l(){return o===2}let c=!1;function h(...T){c||(c=!0,e.apply(null,T))}function p(T){r=setTimeout(()=>{r=null,n(v,l())},T)}function m(){i&&clearTimeout(i)}function v(T,...E){if(c){m();return}if(T){m(),h.call(null,T,...E);return}if(l()||a){m(),h.call(null,T,...E);return}s<64&&(s*=2);let $;o===1?(o=2,$=0):$=(s+Math.random())*1e3,p($)}let x=!1;function w(T){x||(x=!0,m(),!c&&(r!==null?(T||(o=2),clearTimeout(r),p(0)):T||(o=1)))}return p(0),i=setTimeout(()=>{a=!0,w(!0)},t),w}function Yre(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qre(n){return n!==void 0}function Jre(n){return typeof n=="object"&&!Array.isArray(n)}function _k(n){return typeof n=="string"||n instanceof String}function YP(n){return xk()&&n instanceof Blob}function xk(){return typeof Blob<"u"}function QP(n,e,t,s){if(s<e)throw JN(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw JN(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function fB(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var ef;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(ef||(ef={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eie(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tie{constructor(e,t,s,r,i,a,o,l,c,h,p,m=!0,v=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=p,this.retry=m,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,w)=>{this.resolve_=x,this.reject_=w,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new wx(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===ef.NO_ERROR,l=i.getStatus();if(!o||eie(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===ef.ABORT;s(!1,new wx(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;s(!0,new wx(c,i))})},t=(s,r)=>{const i=this.resolve_,a=this.reject_,o=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Qre(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=bk();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(r.canceled){const l=this.appDelete_?dB():zre();a(l)}else{const l=Bre();a(l)}};this.canceled_?t(!1,new wx(!1,null,!0)):this.backoffId_=Zre(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Yre(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class wx{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function nie(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function sie(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function rie(n,e){e&&(n["X-Firebase-GMPID"]=e)}function iie(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function aie(n,e,t,s,r,i,a=!0,o=!1){const l=fB(n.urlParams),c=n.url+l,h=Object.assign({},n.headers);return rie(h,e),nie(h,t),sie(h,i),iie(h,s),new tie(c,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,a,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oie(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function lie(...n){const e=oie();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(xk())return new Blob(n);throw new Ns(Ss.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function cie(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uie(n){if(typeof atob>"u")throw qre("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class WE{constructor(e,t){this.data=e,this.contentType=t||null}}function hie(n,e){switch(n){case Il.RAW:return new WE(pB(e));case Il.BASE64:case Il.BASE64URL:return new WE(mB(n,e));case Il.DATA_URL:return new WE(fie(e),pie(e))}throw bk()}function pB(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=s,a=n.charCodeAt(++t);s=65536|(i&1023)<<10|a&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function die(n){let e;try{e=decodeURIComponent(n)}catch{throw Ry(Il.DATA_URL,"Malformed data URL.")}return pB(e)}function mB(n,e){switch(n){case Il.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Ry(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Il.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Ry(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=uie(e)}catch(r){throw r.message.includes("polyfill")?r:Ry(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}class gB{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Ry(Il.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=mie(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function fie(n){const e=new gB(n);return e.base64?mB(Il.BASE64,e.rest):die(e.rest)}function pie(n){return new gB(n).contentType}function mie(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,t){let s=0,r="";YP(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(YP(this.data_)){const s=this.data_,r=cie(s,e,t);return r===null?null:new lh(r)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new lh(s,!0)}}static getBlob(...e){if(xk()){const t=e.map(s=>s instanceof lh?s.data_:s);return new lh(lie.apply(null,t))}else{const t=e.map(a=>_k(a)?hie(Il.RAW,a).data:a.data_);let s=0;t.forEach(a=>{s+=a.byteLength});const r=new Uint8Array(s);let i=0;return t.forEach(a=>{for(let o=0;o<a.length;o++)r[i++]=a[o]}),new lh(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yB(n){let e;try{e=JSON.parse(n)}catch{return null}return Jre(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gie(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function yie(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function vB(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vie(n,e){return e}class ki{constructor(e,t,s,r){this.server=e,this.local=t||e,this.writable=!!s,this.xform=r||vie}}let Tx=null;function bie(n){return!_k(n)||n.length<2?n:vB(n)}function bB(){if(Tx)return Tx;const n=[];n.push(new ki("bucket")),n.push(new ki("generation")),n.push(new ki("metageneration")),n.push(new ki("name","fullPath",!0));function e(i,a){return bie(a)}const t=new ki("name");t.xform=e,n.push(t);function s(i,a){return a!==void 0?Number(a):a}const r=new ki("size");return r.xform=s,n.push(r),n.push(new ki("timeCreated")),n.push(new ki("updated")),n.push(new ki("md5Hash",null,!0)),n.push(new ki("cacheControl",null,!0)),n.push(new ki("contentDisposition",null,!0)),n.push(new ki("contentEncoding",null,!0)),n.push(new ki("contentLanguage",null,!0)),n.push(new ki("contentType",null,!0)),n.push(new ki("metadata","customMetadata",!0)),Tx=n,Tx}function _ie(n,e){function t(){const s=n.bucket,r=n.fullPath,i=new Ca(s,r);return e._makeStorageReference(i)}Object.defineProperty(n,"ref",{get:t})}function xie(n,e,t){const s={};s.type="file";const r=t.length;for(let i=0;i<r;i++){const a=t[i];s[a.local]=a.xform(s,e[a.server])}return _ie(s,n),s}function _B(n,e,t){const s=yB(e);return s===null?null:xie(n,s,t)}function wie(n,e,t,s){const r=yB(e);if(r===null||!_k(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(c=>{const h=n.bucket,p=n.fullPath,m="/b/"+a(h)+"/o/"+a(p),v=wk(m,t,s),x=fB({alt:"media",token:c});return v+x})[0]}function Tie(n,e){const t={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(t[i.server]=n[i.local])}return JSON.stringify(t)}class xB{constructor(e,t,s,r){this.url=e,this.method=t,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wB(n){if(!n)throw bk()}function Sie(n,e){function t(s,r){const i=_B(n,r,e);return wB(i!==null),i}return t}function Eie(n,e){function t(s,r){const i=_B(n,r,e);return wB(i!==null),wie(i,r,n.host,n._protocol)}return t}function TB(n){function e(t,s){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=Fre():r=Mre():t.getStatus()===402?r=Pre(n.bucket):t.getStatus()===403?r=jre(n.path):r=s,r.status=t.getStatus(),r.serverResponse=s.serverResponse,r}return e}function Nie(n){const e=TB(n);function t(s,r){let i=e(s,r);return s.getStatus()===404&&(i=Ore(n.path)),i.serverResponse=r.serverResponse,i}return t}function Iie(n,e,t){const s=e.fullServerUrl(),r=wk(s,n.host,n._protocol),i="GET",a=n.maxOperationRetryTime,o=new xB(r,i,Eie(n,t),a);return o.errorHandler=Nie(e),o}function Cie(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function kie(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=Cie(null,e)),s}function $ie(n,e,t,s,r){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let $="";for(let R=0;R<2;R++)$=$+Math.random().toString().slice(2);return $}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const c=kie(e,s,r),h=Tie(c,t),p="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,m=`\r
--`+l+"--",v=lh.getBlob(p,s,m);if(v===null)throw Wre();const x={name:c.fullPath},w=wk(i,n.host,n._protocol),T="POST",E=n.maxUploadRetryTime,C=new xB(w,T,Sie(n,t),E);return C.urlParams=x,C.headers=a,C.body=v.uploadData(),C.errorHandler=TB(e),C}class Aie{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ef.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ef.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ef.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,r,i){if(this.sent_)throw ry("cannot .send() more than once");if(Wh(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ry("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ry("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ry("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ry("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Rie extends Aie{initXhr(){this.xhr_.responseType="text"}}function SB(){return new Rie}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,t){this._service=e,t instanceof Ca?this._location=t:this._location=Ca.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new mf(e,t)}get root(){const e=new Ca(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vB(this._location.path)}get storage(){return this._service}get parent(){const e=gie(this._location.path);if(e===null)return null;const t=new Ca(this._location.bucket,e);return new mf(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Kre(e)}}function Die(n,e,t){n._throwIfRoot("uploadBytes");const s=$ie(n.storage,n._location,bB(),new lh(e,!0),t);return n.storage.makeRequestWithTokens(s,SB).then(r=>({metadata:r,ref:n}))}function Lie(n){n._throwIfRoot("getDownloadURL");const e=Iie(n.storage,n._location,bB());return n.storage.makeRequestWithTokens(e,SB).then(t=>{if(t===null)throw Hre();return t})}function Oie(n,e){const t=yie(n._location.path,e),s=new Ca(n._location.bucket,t);return new mf(n.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pie(n){return/^[A-Za-z]+:\/\//.test(n)}function Mie(n,e){return new mf(n,e)}function EB(n,e){if(n instanceof Tk){const t=n;if(t._bucket==null)throw Gre();const s=new mf(t,t._bucket);return e!=null?EB(s,e):s}else return e!==void 0?Oie(n,e):n}function Fie(n,e){if(e&&Pie(e)){if(n instanceof Tk)return Mie(n,e);throw JN("To use ref(service, url), the first argument must be a Storage instance.")}else return EB(n,e)}function JP(n,e){const t=e?.[hB];return t==null?null:Ca.makeFromBucketSpec(t,n)}function jie(n,e,t,s={}){n.host=`${e}:${t}`;const r=Wh(e);r&&(SC(`https://${n.host}/b`),EC("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(n._overrideAuthToken=typeof i=="string"?i:zF(i,n.app.options.projectId))}class Tk{constructor(e,t,s,r,i,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=a,this._bucket=null,this._host=uB,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Dre,this._maxUploadRetryTime=Lre,this._requests=new Set,r!=null?this._bucket=Ca.makeFromBucketSpec(r,this._host):this._bucket=JP(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ca.makeFromBucketSpec(this._url,e):this._bucket=JP(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){QP("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){QP("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ea(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new mf(this,e)}_makeRequest(e,t,s,r,i=!0){if(this._deleted)return new Xre(dB());{const a=aie(e,this._appId,s,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()}}const eM="@firebase/storage",tM="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NB="storage";function Yx(n,e,t){return n=Ms(n),Die(n,e,t)}function Qx(n){return n=Ms(n),Lie(n)}function Jx(n,e){return n=Ms(n),Fie(n,e)}function IB(n=CC(),e){n=Ms(n);const s=C1(n,NB).getImmediate({identifier:e}),r=FF("storage");return r&&Bie(s,...r),s}function Bie(n,e,t,s={}){jie(n,e,t,s)}function zie(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new Tk(t,s,r,e,Ff)}function Vie(){uf(new Nh(NB,zie,"PUBLIC").setMultipleInstances(!0)),$l(eM,tM,""),$l(eM,tM,"esm2020")}Vie();const Uie={apiKey:"AIzaSyDkc9f6Sr4Kq8s9MtwWK9k3i217Gjk9PBg",authDomain:"blue-3b61a.firebaseapp.com",projectId:"blue-3b61a",storageBucket:"blue-3b61a.firebasestorage.app",messagingSenderId:"55986917972",appId:"1:55986917972:web:70e7efc4452a1aab7393c1",measurementId:"G-22BEHR5BE0"},Sk=GF(Uie),Lh=bte(Sk),Pr=vre(Sk),HE=IB(Sk);function Gie(){const[n,e]=ve.useState(""),[t,s]=ve.useState(""),[r,i]=ve.useState(!1),a=bv(),o=async()=>{try{i(!0);const c=(await aee(Lh,n,t)).user.uid,h=await yk(Hl(Pr,"users",c));if(h.exists()){const{role:p}=h.data();localStorage.setItem("userRole",p),localStorage.setItem("userEmail",n),a(`/${p}`)}else alert("No role found for this user!")}catch(l){alert("Login failed: "+l.message)}finally{i(!1)}};return y.jsxs("div",{className:"login-container",children:[y.jsxs("div",{className:"login-card",children:[y.jsx("div",{className:"profile-icon",children:""}),y.jsx("h2",{className:"login-title",children:"Login"}),y.jsx("input",{type:"email",placeholder:"Email ID",className:"login-input",value:n,onChange:l=>e(l.target.value)}),y.jsx("input",{type:"password",placeholder:"Password",className:"login-input",value:t,onChange:l=>s(l.target.value)}),y.jsx("button",{onClick:o,className:"login-btn",disabled:r,children:r?"Logging in...":"LOGIN"}),r&&y.jsx("div",{className:"spinner"})," ",y.jsxs("div",{className:"auth-link",children:["Don't have an account? ",y.jsx(ft,{to:"/signup",children:"Sign Up"})]})]}),y.jsx("div",{className:"back",children:y.jsx("a",{href:"./",children:y.jsx("button",{children:" Back to Home"})})})]})}function Wie(){const[n,e]=ve.useState(""),[t,s]=ve.useState(""),[r,i]=ve.useState(""),[a,o]=ve.useState(""),[l,c]=ve.useState(""),[h,p]=ve.useState(!1),m=bv(),v=async()=>{if(!l){alert("Please select a role!");return}if(r!==a){alert("Passwords don't match!");return}if(!n||!t||!r){alert("Please fill all fields!");return}try{p(!0);const w=(await iee(Lh,t,r)).user.uid;await oB(Hl(Pr,"users",w),{name:n,email:t,role:l,createdAt:new Date}),alert("Account created successfully!"),m("/login")}catch(x){alert("Signup failed: "+x.message)}finally{p(!1)}};return y.jsxs("div",{className:"login-container",children:[y.jsxs("div",{className:"login-card",children:[y.jsx("div",{className:"profile-icon",children:""}),y.jsx("h2",{className:"login-title",children:"Create Account"}),y.jsx("input",{type:"text",placeholder:"Full Name",className:"login-input",value:n,onChange:x=>e(x.target.value)}),y.jsx("input",{type:"email",placeholder:"Email ID",className:"login-input",value:t,onChange:x=>s(x.target.value)}),y.jsx("input",{type:"password",placeholder:"Password",className:"login-input",value:r,onChange:x=>i(x.target.value)}),y.jsx("input",{type:"password",placeholder:"Confirm Password",className:"login-input",value:a,onChange:x=>o(x.target.value)}),y.jsxs("div",{className:"role-buttons",children:[y.jsx("button",{onClick:()=>c("farmer"),className:l==="farmer"?"active":"",children:" Farmer"}),y.jsx("button",{onClick:()=>c("buyer"),className:l==="buyer"?"active":"",children:" Buyer"}),y.jsx("button",{onClick:()=>c("admin"),className:l==="admin"?"active":"",children:" Admin"})]}),y.jsx("button",{onClick:v,className:"login-btn",disabled:h,children:h?"Creating Account...":"CREATE ACCOUNT"}),h&&y.jsx("div",{className:"spinner"})," ",y.jsxs("div",{className:"auth-link",children:["Already have an account? ",y.jsx(ft,{to:"/login",children:"Sign In"})]})]}),y.jsx("div",{className:"back",children:y.jsx("a",{href:"./",children:y.jsx("button",{children:"  Back to Home "})})})]})}const Hie="/assets/farmer-vBGYqOLb.jpg";function qie(){return y.jsxs("div",{className:"home-container",children:[y.jsxs("div",{className:"hero-section hero-farmer",children:[y.jsx("div",{className:"hero-background",children:y.jsx("img",{src:Hie,alt:"farmer.jpg"})}),y.jsxs("div",{className:"hero-content",children:[y.jsx("div",{className:"hero-badge",children:" Farmer Portal"}),y.jsx("h1",{className:"hero-title",children:"Protecting Blue Carbon Ecosystems"}),y.jsx("p",{className:"hero-subtitle",children:"Monitor, report, and verify  carbon projects with transparent blockchain technology and community-driven impacttracking."}),y.jsxs("div",{className:"hero-actions",children:[y.jsx(ft,{to:"/add-project",className:"btn-hero-primary",children:"Start New Project"}),y.jsx(ft,{to:"/mrv-dashboard",className:"btn-hero-secondary",children:"View Dashboard"})]})]})]}),y.jsxs("div",{className:"dashboard-grid",children:[y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"My Projects"}),y.jsx("p",{children:"View and manage your carbon sequestration projects"}),y.jsx(ft,{to:"/add-project",className:"card-button",children:"Add New Project"})]}),y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"MRV Dashboard"}),y.jsx("p",{children:"Monitor, Report, and Verify your carbon credits"}),y.jsx(ft,{to:"/mrv-dashboard",className:"card-button",children:"View Dashboard"})]}),y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"Marketplace"}),y.jsx("p",{children:"Sell your verified carbon credits"}),y.jsx(ft,{to:"/marketplace",className:"card-button",children:"Go to Market"})]}),y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"Analytics"}),y.jsx("p",{children:"Track your environmental and financial impact"}),y.jsx(ft,{to:"/analytics",className:"card-button",children:"View Analytics"})]})]}),y.jsxs("div",{className:"recent-activity",children:[y.jsx("h2",{children:"Recent Activity"}),y.jsxs("div",{className:"activity-list",children:[y.jsxs("div",{className:"activity-item",children:[y.jsx("span",{className:"activity-icon",children:""}),y.jsx("span",{children:'Project "Mangrove Restoration" verified'}),y.jsx("span",{className:"activity-time",children:"2 hours ago"})]}),y.jsxs("div",{className:"activity-item",children:[y.jsx("span",{className:"activity-icon",children:""}),y.jsx("span",{children:"Sold 150 carbon credits"}),y.jsx("span",{className:"activity-time",children:"1 day ago"})]}),y.jsxs("div",{className:"activity-item",children:[y.jsx("span",{className:"activity-icon",children:""}),y.jsx("span",{children:"Monthly MRV report submitted"}),y.jsx("span",{className:"activity-time",children:"3 days ago"})]})]})]}),y.jsxs("footer",{className:"footer",children:[y.jsxs("p",{children:[" ",new Date().getFullYear()," BlueCarbon Farmers. All rights reserved."]}),y.jsxs("div",{className:"footer-links",children:[y.jsx(ft,{to:"/about",children:"About"}),y.jsx(ft,{to:"/contact",children:"Contact"}),y.jsx(ft,{to:"/privacy",children:"Privacy Policy"})]})]})]})}const Kie="/assets/admin-DCDuZu97.png";function Xie(){const[n,e]=ve.useState({activeProjects:0,pendingProjects:0,totalCreditsGenerated:0,totalFarmers:0,totalBuyers:0});return ve.useEffect(()=>{(async()=>{try{const s=Dh(Pr,"projects"),r=Dh(Pr,"users"),i=await Mc(Yp(s,Qp("status","==","verified"))),a=await Mc(Yp(s,Qp("status","==","pending")));let o=0;(await Mc(s)).forEach(p=>{const m=p.data();o+=parseFloat(m.creditsGenerated||0)});const c=await Mc(Yp(r,Qp("role","==","farmer"))),h=await Mc(Yp(r,Qp("role","==","buyer")));e({activeProjects:i.size,pendingProjects:a.size,totalCreditsGenerated:o,totalFarmers:c.size,totalBuyers:h.size})}catch(s){console.error("Error fetching stats:",s)}})()},[]),y.jsxs("div",{className:"home-container",children:[y.jsxs("div",{className:"hero-section hero-admin",style:{height:"50vh",minHeight:"50vh",maxHeight:"50vh",backgroundImage:`url(${Kie})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[y.jsx("div",{className:"admin-admin",children:y.jsx("h1",{children:"Welcome to the Admin Site."})}),y.jsx("div",{className:"hero-content",children:y.jsx("div",{className:"hero-actions",children:y.jsx(ft,{to:"/project-verification",className:"btn-hero-primary",children:"Review Projects"})})})]}),y.jsxs("div",{className:"dashboard-grid",children:[y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"Project Verification"}),y.jsx("p",{children:"Review and approve carbon credit projects"}),y.jsx(ft,{to:"/project-verification",className:"card-button",children:"Review Projects"})]}),y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"Platform Analytics"}),y.jsx("p",{children:"Monitor platform performance and transactions"}),y.jsx(ft,{to:"/platform-analytics",className:"card-button",children:"View Analytics"})]}),y.jsxs("div",{className:"dashboard-card",children:[y.jsx("div",{className:"card-icon",children:""}),y.jsx("h3",{children:"System Settings"}),y.jsx("p",{children:"Configure platform settings and parameters"}),y.jsx(ft,{to:"/system-settings",className:"card-button",children:"Settings"})]})]}),y.jsxs("div",{className:"admin-stats",children:[y.jsx("h2",{children:"Platform Overview"}),y.jsxs("div",{className:"stats-grid",children:[y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:n.activeProjects}),y.jsx("div",{className:"stat-label",children:"Verified Projects"})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:n.totalFarmers}),y.jsx("div",{className:"stat-label",children:"Registered Farmers"})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:n.totalBuyers}),y.jsx("div",{className:"stat-label",children:"Active Buyers"})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:n.totalCreditsGenerated}),y.jsx("div",{className:"stat-label",children:"Credits Generated"})]})]})]}),y.jsxs("div",{className:"pending-actions",children:[y.jsx("h2",{children:"Pending Actions"}),y.jsx("div",{className:"action-list",children:y.jsxs("div",{className:`action-item ${n.pendingProjects>0?"urgent":""}`,children:[y.jsx("span",{className:"action-icon",children:""}),y.jsxs("span",{children:[n.pendingProjects," projects awaiting verification"]}),y.jsx(ft,{to:"/project-verification",className:"action-link",children:"Review"})]})})]})]})}function Zie(){const[n,e]=ve.useState({firstName:"",lastName:"",email:"",phone:"",organization:"",role:"",location:"",bio:"",profileImage:null}),[t,s]=ve.useState(!0),r=bv();ve.useEffect(()=>{const l=OC(Lh,async c=>{if(c){const h=Hl(Pr,"users",c.uid),p=await yk(h);p.exists()?e({...p.data(),profileImage:null}):e(m=>({...m,email:c.email}))}s(!1)});return()=>l()},[]);const i=l=>{const{name:c,value:h}=l.target;e(p=>({...p,[c]:h}))},a=l=>{const c=l.target.files[0];c&&e(h=>({...h,profileImage:c}))},o=async l=>{l.preventDefault();try{const c=Lh.currentUser;if(!c)return alert("You must be signed in to save profile.");let h=n.profileImageUrl||"";const p=n.profileImage;if(p instanceof File){const m=IB(),v=Jx(m,`profiles/${c.uid}_${Date.now()}`);await Yx(v,p),h=await Qx(v)}await oB(Hl(Pr,"users",c.uid),{...n,profileImageUrl:h,profileImage:null,updatedAt:cB(),email:c.email},{merge:!0}),alert("Profile saved successfully!"),r(`/${n.role||"dashboard"}`)}catch(c){console.error("Profile save error:",c),alert("Error saving profile: "+c.message)}};return t?y.jsx("p",{children:"Loading..."}):y.jsxs("div",{className:"profile-container",children:[y.jsxs("div",{className:"profile-header",children:[y.jsx("h1",{className:"profile-title",children:" Build Your Profile"}),y.jsx("p",{className:"profile-subtitle",children:"Complete your profile to get the most out of the platform"})]}),y.jsxs("form",{className:"profile-form",onSubmit:o,children:[y.jsxs("div",{className:"form-section",children:[y.jsx("h3",{children:"Personal Information"}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"firstName",children:"First Name *"}),y.jsx("input",{type:"text",id:"firstName",name:"firstName",value:n.firstName,onChange:i,required:!0,placeholder:"Enter your first name"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),y.jsx("input",{type:"text",id:"lastName",name:"lastName",value:n.lastName,onChange:i,required:!0,placeholder:"Enter your last name"})]})]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"email",children:"Email Address *"}),y.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:i,required:!0,placeholder:"Enter your email"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"phone",children:"Phone Number"}),y.jsx("input",{type:"tel",id:"phone",name:"phone",value:n.phone,onChange:i,placeholder:"Enter your phone number"})]})]})]}),y.jsxs("div",{className:"form-section",children:[y.jsx("h3",{children:"Professional Information"}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"organization",children:"Organization"}),y.jsx("input",{type:"text",id:"organization",name:"organization",value:n.organization,onChange:i,placeholder:"Company/Organization name"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"role",children:"Role *"}),y.jsxs("select",{id:"role",name:"role",value:n.role,onChange:i,required:!0,children:[y.jsx("option",{value:"",children:"Select your role"}),y.jsx("option",{value:"farmer",children:"Farmer"}),y.jsx("option",{value:"buyer",children:"Buyer"}),y.jsx("option",{value:"admin",children:"Admin"}),y.jsx("option",{value:"verifier",children:"Verifier"})]})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"location",children:"Location"}),y.jsx("input",{type:"text",id:"location",name:"location",value:n.location,onChange:i,placeholder:"City, Country"})]})]}),y.jsxs("div",{className:"form-section",children:[y.jsx("h3",{children:"Additional Information"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"profileImage",children:"Profile Image"}),y.jsx("input",{type:"file",id:"profileImage",name:"profileImage",accept:"image/*",onChange:a,className:"file-input"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"bio",children:"Bio"}),y.jsx("textarea",{id:"bio",name:"bio",value:n.bio,onChange:i,placeholder:"Tell us about yourself...",rows:"4"})]})]}),y.jsxs("div",{className:"form-actions",children:[y.jsx("button",{type:"submit",className:"btn-primary",children:"Save Profile"}),y.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>r(`/${n.role||"dashboard"}`),children:"Skip for Now"})]})]})]})}function nM(){const[n,e]=ve.useState(null),[t,s]=ve.useState(!0),r=bv();ve.useEffect(()=>{const a=OC(Lh,async o=>{if(o){const l=Hl(Pr,"users",o.uid),c=await yk(l);c.exists()&&e(c.data())}s(!1)});return()=>a()},[]);const i=()=>r("/profile-form");return t?y.jsx("p",{children:"Loading..."}):n?y.jsxs("div",{className:"profile-display-container",children:[y.jsxs("div",{className:"profile-header-section",children:[y.jsx("div",{className:"profile-cover",children:y.jsx("div",{className:"profile-avatar",children:n.profileImageUrl?y.jsx("img",{src:n.profileImageUrl,alt:"Profile"}):y.jsxs("div",{className:"avatar-placeholder",children:[n.firstName?.charAt(0),n.lastName?.charAt(0)]})})}),y.jsxs("div",{className:"profile-info",children:[y.jsxs("div",{className:"profile-name-section",children:[y.jsxs("h1",{children:[n.firstName," ",n.lastName]}),y.jsx("p",{children:n.role}),y.jsxs("p",{children:[" ",n.location]})]}),y.jsxs("div",{className:"profile-actions",children:[y.jsx("button",{onClick:i,className:"btn-edit",children:" Edit Profile"}),y.jsx("button",{className:"btn-connect",children:" Connect"}),y.jsx("button",{className:"btn-message",children:" Message"})]})]})]}),y.jsxs("div",{className:"profile-content",children:[y.jsxs("div",{className:"profile-card",children:[y.jsx("h3",{children:"About"}),y.jsx("p",{children:n.bio||"No bio available"})]}),y.jsxs("div",{className:"profile-card",children:[y.jsx("h3",{children:"Contact Information"}),y.jsxs("p",{children:[" ",n.email]}),n.phone&&y.jsxs("p",{children:[" ",n.phone]})]}),y.jsxs("div",{className:"profile-card",children:[y.jsx("h3",{children:"Professional Information"}),y.jsxs("p",{children:[" ",n.organization]}),y.jsxs("p",{children:["Role: ",n.role]})]})]})]}):y.jsx("div",{className:"profile-display-container",children:y.jsxs("div",{className:"no-profile",children:[y.jsx("h2",{children:"No Profile Found"}),y.jsx("p",{children:"Please complete your profile first."}),y.jsx("button",{onClick:()=>r("/profile-form"),className:"btn-primary",children:"Create Profile"})]})})}var yy={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var Yie=yy.exports,sM;function Qie(){return sM||(sM=1,(function(n,e){(function(t,s){s(e)})(Yie,(function(t){var s="1.9.4";function r(f){var b,N,A,z;for(N=1,A=arguments.length;N<A;N++){z=arguments[N];for(b in z)f[b]=z[b]}return f}var i=Object.create||(function(){function f(){}return function(b){return f.prototype=b,new f}})();function a(f,b){var N=Array.prototype.slice;if(f.bind)return f.bind.apply(f,N.call(arguments,1));var A=N.call(arguments,2);return function(){return f.apply(b,A.length?A.concat(N.call(arguments)):arguments)}}var o=0;function l(f){return"_leaflet_id"in f||(f._leaflet_id=++o),f._leaflet_id}function c(f,b,N){var A,z,X,le;return le=function(){A=!1,z&&(X.apply(N,z),z=!1)},X=function(){A?z=arguments:(f.apply(N,arguments),setTimeout(le,b),A=!0)},X}function h(f,b,N){var A=b[1],z=b[0],X=A-z;return f===A&&N?f:((f-z)%X+X)%X+z}function p(){return!1}function m(f,b){if(b===!1)return f;var N=Math.pow(10,b===void 0?6:b);return Math.round(f*N)/N}function v(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function x(f){return v(f).split(/\s+/)}function w(f,b){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?i(f.options):{});for(var N in b)f.options[N]=b[N];return f.options}function T(f,b,N){var A=[];for(var z in f)A.push(encodeURIComponent(N?z.toUpperCase():z)+"="+encodeURIComponent(f[z]));return(!b||b.indexOf("?")===-1?"?":"&")+A.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function C(f,b){return f.replace(E,function(N,A){var z=b[A];if(z===void 0)throw new Error("No value provided for variable "+N);return typeof z=="function"&&(z=z(b)),z})}var $=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function R(f,b){for(var N=0;N<f.length;N++)if(f[N]===b)return N;return-1}var P="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function U(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var j=0;function O(f){var b=+new Date,N=Math.max(0,16-(b-j));return j=b+N,window.setTimeout(f,N)}var M=window.requestAnimationFrame||U("RequestAnimationFrame")||O,B=window.cancelAnimationFrame||U("CancelAnimationFrame")||U("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function D(f,b,N){if(N&&M===O)f.call(b);else return M.call(window,a(f,b))}function W(f){f&&B.call(window,f)}var H={__proto__:null,extend:r,create:i,bind:a,get lastId(){return o},stamp:l,throttle:c,wrapNum:h,falseFn:p,formatNum:m,trim:v,splitWords:x,setOptions:w,getParamString:T,template:C,isArray:$,indexOf:R,emptyImageUrl:P,requestFn:M,cancelFn:B,requestAnimFrame:D,cancelAnimFrame:W};function ae(){}ae.extend=function(f){var b=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},N=b.__super__=this.prototype,A=i(N);A.constructor=b,b.prototype=A;for(var z in this)Object.prototype.hasOwnProperty.call(this,z)&&z!=="prototype"&&z!=="__super__"&&(b[z]=this[z]);return f.statics&&r(b,f.statics),f.includes&&(te(f.includes),r.apply(null,[A].concat(f.includes))),r(A,f),delete A.statics,delete A.includes,A.options&&(A.options=N.options?i(N.options):{},r(A.options,f.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){N.callInitHooks&&N.callInitHooks.call(this),this._initHooksCalled=!0;for(var X=0,le=A._initHooks.length;X<le;X++)A._initHooks[X].call(this)}},b},ae.include=function(f){var b=this.prototype.options;return r(this.prototype,f),f.options&&(this.prototype.options=b,this.mergeOptions(f.options)),this},ae.mergeOptions=function(f){return r(this.prototype.options,f),this},ae.addInitHook=function(f){var b=Array.prototype.slice.call(arguments,1),N=typeof f=="function"?f:function(){this[f].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(N),this};function te(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=$(f)?f:[f];for(var b=0;b<f.length;b++)f[b]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Z={on:function(f,b,N){if(typeof f=="object")for(var A in f)this._on(A,f[A],b);else{f=x(f);for(var z=0,X=f.length;z<X;z++)this._on(f[z],b,N)}return this},off:function(f,b,N){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var A in f)this._off(A,f[A],b);else{f=x(f);for(var z=arguments.length===1,X=0,le=f.length;X<le;X++)z?this._off(f[X]):this._off(f[X],b,N)}return this},_on:function(f,b,N,A){if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}if(this._listens(f,b,N)===!1){N===this&&(N=void 0);var z={fn:b,ctx:N};A&&(z.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(z)}},_off:function(f,b,N){var A,z,X;if(this._events&&(A=this._events[f],!!A)){if(arguments.length===1){if(this._firingCount)for(z=0,X=A.length;z<X;z++)A[z].fn=p;delete this._events[f];return}if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}var le=this._listens(f,b,N);if(le!==!1){var Ee=A[le];this._firingCount&&(Ee.fn=p,this._events[f]=A=A.slice()),A.splice(le,1)}}},fire:function(f,b,N){if(!this.listens(f,N))return this;var A=r({},b,{type:f,target:this,sourceTarget:b&&b.sourceTarget||this});if(this._events){var z=this._events[f];if(z){this._firingCount=this._firingCount+1||1;for(var X=0,le=z.length;X<le;X++){var Ee=z[X],Oe=Ee.fn;Ee.once&&this.off(f,Oe,Ee.ctx),Oe.call(Ee.ctx||this,A)}this._firingCount--}}return N&&this._propagateEvent(A),this},listens:function(f,b,N,A){typeof f!="string"&&console.warn('"string" type argument expected');var z=b;typeof b!="function"&&(A=!!b,z=void 0,N=void 0);var X=this._events&&this._events[f];if(X&&X.length&&this._listens(f,z,N)!==!1)return!0;if(A){for(var le in this._eventParents)if(this._eventParents[le].listens(f,b,N,A))return!0}return!1},_listens:function(f,b,N){if(!this._events)return!1;var A=this._events[f]||[];if(!b)return!!A.length;N===this&&(N=void 0);for(var z=0,X=A.length;z<X;z++)if(A[z].fn===b&&A[z].ctx===N)return z;return!1},once:function(f,b,N){if(typeof f=="object")for(var A in f)this._on(A,f[A],b,!0);else{f=x(f);for(var z=0,X=f.length;z<X;z++)this._on(f[z],b,N,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[l(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[l(f)],this},_propagateEvent:function(f){for(var b in this._eventParents)this._eventParents[b].fire(f.type,r({layer:f.target,propagatedFrom:f.target},f),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var re=ae.extend(Z);function ne(f,b,N){this.x=N?Math.round(f):f,this.y=N?Math.round(b):b}var he=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};ne.prototype={clone:function(){return new ne(this.x,this.y)},add:function(f){return this.clone()._add(K(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(K(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new ne(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new ne(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=he(this.x),this.y=he(this.y),this},distanceTo:function(f){f=K(f);var b=f.x-this.x,N=f.y-this.y;return Math.sqrt(b*b+N*N)},equals:function(f){return f=K(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=K(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+m(this.x)+", "+m(this.y)+")"}};function K(f,b,N){return f instanceof ne?f:$(f)?new ne(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new ne(f.x,f.y):new ne(f,b,N)}function ie(f,b){if(f)for(var N=b?[f,b]:f,A=0,z=N.length;A<z;A++)this.extend(N[A])}ie.prototype={extend:function(f){var b,N;if(!f)return this;if(f instanceof ne||typeof f[0]=="number"||"x"in f)b=N=K(f);else if(f=pe(f),b=f.min,N=f.max,!b||!N)return this;return!this.min&&!this.max?(this.min=b.clone(),this.max=N.clone()):(this.min.x=Math.min(b.x,this.min.x),this.max.x=Math.max(N.x,this.max.x),this.min.y=Math.min(b.y,this.min.y),this.max.y=Math.max(N.y,this.max.y)),this},getCenter:function(f){return K((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return K(this.min.x,this.max.y)},getTopRight:function(){return K(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var b,N;return typeof f[0]=="number"||f instanceof ne?f=K(f):f=pe(f),f instanceof ie?(b=f.min,N=f.max):b=N=f,b.x>=this.min.x&&N.x<=this.max.x&&b.y>=this.min.y&&N.y<=this.max.y},intersects:function(f){f=pe(f);var b=this.min,N=this.max,A=f.min,z=f.max,X=z.x>=b.x&&A.x<=N.x,le=z.y>=b.y&&A.y<=N.y;return X&&le},overlaps:function(f){f=pe(f);var b=this.min,N=this.max,A=f.min,z=f.max,X=z.x>b.x&&A.x<N.x,le=z.y>b.y&&A.y<N.y;return X&&le},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var b=this.min,N=this.max,A=Math.abs(b.x-N.x)*f,z=Math.abs(b.y-N.y)*f;return pe(K(b.x-A,b.y-z),K(N.x+A,N.y+z))},equals:function(f){return f?(f=pe(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function pe(f,b){return!f||f instanceof ie?f:new ie(f,b)}function fe(f,b){if(f)for(var N=b?[f,b]:f,A=0,z=N.length;A<z;A++)this.extend(N[A])}fe.prototype={extend:function(f){var b=this._southWest,N=this._northEast,A,z;if(f instanceof Te)A=f,z=f;else if(f instanceof fe){if(A=f._southWest,z=f._northEast,!A||!z)return this}else return f?this.extend(Se(f)||Ne(f)):this;return!b&&!N?(this._southWest=new Te(A.lat,A.lng),this._northEast=new Te(z.lat,z.lng)):(b.lat=Math.min(A.lat,b.lat),b.lng=Math.min(A.lng,b.lng),N.lat=Math.max(z.lat,N.lat),N.lng=Math.max(z.lng,N.lng)),this},pad:function(f){var b=this._southWest,N=this._northEast,A=Math.abs(b.lat-N.lat)*f,z=Math.abs(b.lng-N.lng)*f;return new fe(new Te(b.lat-A,b.lng-z),new Te(N.lat+A,N.lng+z))},getCenter:function(){return new Te((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Te(this.getNorth(),this.getWest())},getSouthEast:function(){return new Te(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof Te||"lat"in f?f=Se(f):f=Ne(f);var b=this._southWest,N=this._northEast,A,z;return f instanceof fe?(A=f.getSouthWest(),z=f.getNorthEast()):A=z=f,A.lat>=b.lat&&z.lat<=N.lat&&A.lng>=b.lng&&z.lng<=N.lng},intersects:function(f){f=Ne(f);var b=this._southWest,N=this._northEast,A=f.getSouthWest(),z=f.getNorthEast(),X=z.lat>=b.lat&&A.lat<=N.lat,le=z.lng>=b.lng&&A.lng<=N.lng;return X&&le},overlaps:function(f){f=Ne(f);var b=this._southWest,N=this._northEast,A=f.getSouthWest(),z=f.getNorthEast(),X=z.lat>b.lat&&A.lat<N.lat,le=z.lng>b.lng&&A.lng<N.lng;return X&&le},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,b){return f?(f=Ne(f),this._southWest.equals(f.getSouthWest(),b)&&this._northEast.equals(f.getNorthEast(),b)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ne(f,b){return f instanceof fe?f:new fe(f,b)}function Te(f,b,N){if(isNaN(f)||isNaN(b))throw new Error("Invalid LatLng object: ("+f+", "+b+")");this.lat=+f,this.lng=+b,N!==void 0&&(this.alt=+N)}Te.prototype={equals:function(f,b){if(!f)return!1;f=Se(f);var N=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return N<=(b===void 0?1e-9:b)},toString:function(f){return"LatLng("+m(this.lat,f)+", "+m(this.lng,f)+")"},distanceTo:function(f){return qe.distance(this,Se(f))},wrap:function(){return qe.wrapLatLng(this)},toBounds:function(f){var b=180*f/40075017,N=b/Math.cos(Math.PI/180*this.lat);return Ne([this.lat-b,this.lng-N],[this.lat+b,this.lng+N])},clone:function(){return new Te(this.lat,this.lng,this.alt)}};function Se(f,b,N){return f instanceof Te?f:$(f)&&typeof f[0]!="object"?f.length===3?new Te(f[0],f[1],f[2]):f.length===2?new Te(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new Te(f.lat,"lng"in f?f.lng:f.lon,f.alt):b===void 0?null:new Te(f,b,N)}var He={latLngToPoint:function(f,b){var N=this.projection.project(f),A=this.scale(b);return this.transformation._transform(N,A)},pointToLatLng:function(f,b){var N=this.scale(b),A=this.transformation.untransform(f,N);return this.projection.unproject(A)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var b=this.projection.bounds,N=this.scale(f),A=this.transformation.transform(b.min,N),z=this.transformation.transform(b.max,N);return new ie(A,z)},infinite:!1,wrapLatLng:function(f){var b=this.wrapLng?h(f.lng,this.wrapLng,!0):f.lng,N=this.wrapLat?h(f.lat,this.wrapLat,!0):f.lat,A=f.alt;return new Te(N,b,A)},wrapLatLngBounds:function(f){var b=f.getCenter(),N=this.wrapLatLng(b),A=b.lat-N.lat,z=b.lng-N.lng;if(A===0&&z===0)return f;var X=f.getSouthWest(),le=f.getNorthEast(),Ee=new Te(X.lat-A,X.lng-z),Oe=new Te(le.lat-A,le.lng-z);return new fe(Ee,Oe)}},qe=r({},He,{wrapLng:[-180,180],R:6371e3,distance:function(f,b){var N=Math.PI/180,A=f.lat*N,z=b.lat*N,X=Math.sin((b.lat-f.lat)*N/2),le=Math.sin((b.lng-f.lng)*N/2),Ee=X*X+Math.cos(A)*Math.cos(z)*le*le,Oe=2*Math.atan2(Math.sqrt(Ee),Math.sqrt(1-Ee));return this.R*Oe}}),Qe=6378137,pt={R:Qe,MAX_LATITUDE:85.0511287798,project:function(f){var b=Math.PI/180,N=this.MAX_LATITUDE,A=Math.max(Math.min(N,f.lat),-N),z=Math.sin(A*b);return new ne(this.R*f.lng*b,this.R*Math.log((1+z)/(1-z))/2)},unproject:function(f){var b=180/Math.PI;return new Te((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*b,f.x*b/this.R)},bounds:(function(){var f=Qe*Math.PI;return new ie([-f,-f],[f,f])})()};function vt(f,b,N,A){if($(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=b,this._c=N,this._d=A}vt.prototype={transform:function(f,b){return this._transform(f.clone(),b)},_transform:function(f,b){return b=b||1,f.x=b*(this._a*f.x+this._b),f.y=b*(this._c*f.y+this._d),f},untransform:function(f,b){return b=b||1,new ne((f.x/b-this._b)/this._a,(f.y/b-this._d)/this._c)}};function Lt(f,b,N,A){return new vt(f,b,N,A)}var Gt=r({},qe,{code:"EPSG:3857",projection:pt,transformation:(function(){var f=.5/(Math.PI*pt.R);return Lt(f,.5,-f,.5)})()}),gn=r({},Gt,{code:"EPSG:900913"});function un(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function qt(f,b){var N="",A,z,X,le,Ee,Oe;for(A=0,X=f.length;A<X;A++){for(Ee=f[A],z=0,le=Ee.length;z<le;z++)Oe=Ee[z],N+=(z?"L":"M")+Oe.x+" "+Oe.y;N+=b?ot.svg?"z":"x":""}return N||"M0 0"}var Ot=document.documentElement.style,sn="ActiveXObject"in window,wn=sn&&!document.addEventListener,jt="msLaunchUri"in navigator&&!("documentMode"in document),bs=dr("webkit"),Bs=dr("android"),qr=dr("android 2")||dr("android 3"),kr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Js=Bs&&dr("Google")&&kr<537&&!("AudioNode"in window),$s=!!window.opera,An=!jt&&dr("chrome"),ns=dr("gecko")&&!bs&&!$s&&!sn,hs=!An&&dr("safari"),el=dr("phantom"),mo="OTransition"in Ot,hu=navigator.platform.indexOf("Win")===0,hr=sn&&"transition"in Ot,Mi="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!qr,Kr="MozPerspective"in Ot,Fi=!window.L_DISABLE_3D&&(hr||Mi||Kr)&&!mo&&!el,ji=typeof orientation<"u"||dr("mobile"),du=ji&&bs,ud=ji&&Mi,go=!window.PointerEvent&&window.MSPointerEvent,ac=!!(window.PointerEvent||go),ss="ontouchstart"in window||!!window.TouchEvent,Jf=!window.L_NO_TOUCH&&(ss||ac),tl=ji&&$s,nl=ji&&ns,hd=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,dd=(function(){var f=!1;try{var b=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",p,b),window.removeEventListener("testPassiveEventSupport",p,b)}catch{}return f})(),yo=(function(){return!!document.createElement("canvas").getContext})(),fd=!!(document.createElementNS&&un("svg").createSVGRect),Oa=!!fd&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ds=!fd&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var b=f.firstChild;return b.style.behavior="url(#default#VML)",b&&typeof b.adj=="object"}catch{return!1}})(),er=navigator.platform.indexOf("Mac")===0,vo=navigator.platform.indexOf("Linux")===0;function dr(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var ot={ie:sn,ielt9:wn,edge:jt,webkit:bs,android:Bs,android23:qr,androidStock:Js,opera:$s,chrome:An,gecko:ns,safari:hs,phantom:el,opera12:mo,win:hu,ie3d:hr,webkit3d:Mi,gecko3d:Kr,any3d:Fi,mobile:ji,mobileWebkit:du,mobileWebkit3d:ud,msPointer:go,pointer:ac,touch:Jf,touchNative:ss,mobileOpera:tl,mobileGecko:nl,retina:hd,passiveEvents:dd,canvas:yo,svg:fd,vml:ds,inlineSvg:Oa,mac:er,linux:vo},ep=ot.msPointer?"MSPointerDown":"pointerdown",Bi=ot.msPointer?"MSPointerMove":"pointermove",bo=ot.msPointer?"MSPointerUp":"pointerup",oc=ot.msPointer?"MSPointerCancel":"pointercancel",zi={touchstart:ep,touchmove:Bi,touchend:bo,touchcancel:oc},oa={touchstart:fu,touchmove:gi,touchend:gi,touchcancel:gi},mi={},_o=!1;function fs(f,b,N){return b==="touchstart"&&cc(),oa[b]?(N=oa[b].bind(this,N),f.addEventListener(zi[b],N,!1),N):(console.warn("wrong event specified:",b),p)}function tp(f,b,N){if(!zi[b]){console.warn("wrong event specified:",b);return}f.removeEventListener(zi[b],N,!1)}function lc(f){mi[f.pointerId]=f}function Pa(f){mi[f.pointerId]&&(mi[f.pointerId]=f)}function la(f){delete mi[f.pointerId]}function cc(){_o||(document.addEventListener(ep,lc,!0),document.addEventListener(Bi,Pa,!0),document.addEventListener(bo,la,!0),document.addEventListener(oc,la,!0),_o=!0)}function gi(f,b){if(b.pointerType!==(b.MSPOINTER_TYPE_MOUSE||"mouse")){b.touches=[];for(var N in mi)b.touches.push(mi[N]);b.changedTouches=[b],f(b)}}function fu(f,b){b.MSPOINTER_TYPE_TOUCH&&b.pointerType===b.MSPOINTER_TYPE_TOUCH&&Yn(b),gi(f,b)}function pg(f){var b={},N,A;for(A in f)N=f[A],b[A]=N&&N.bind?N.bind(f):N;return f=b,b.type="dblclick",b.detail=2,b.isTrusted=!1,b._simulated=!0,b}var uc=200;function hc(f,b){f.addEventListener("dblclick",b);var N=0,A;function z(X){if(X.detail!==1){A=X.detail;return}if(!(X.pointerType==="mouse"||X.sourceCapabilities&&!X.sourceCapabilities.firesTouchEvents)){var le=mu(X);if(!(le.some(function(Oe){return Oe instanceof HTMLLabelElement&&Oe.attributes.for})&&!le.some(function(Oe){return Oe instanceof HTMLInputElement||Oe instanceof HTMLSelectElement}))){var Ee=Date.now();Ee-N<=uc?(A++,A===2&&b(pg(X))):A=1,N=Ee}}}return f.addEventListener("click",z),{dblclick:b,simDblclick:z}}function Vi(f,b){f.removeEventListener("dblclick",b.dblclick),f.removeEventListener("click",b.simDblclick)}var xo=sl(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ma=sl(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Fa=Ma==="webkitTransition"||Ma==="OTransition"?Ma+"End":"transitionend";function dc(f){return typeof f=="string"?document.getElementById(f):f}function ja(f,b){var N=f.style[b]||f.currentStyle&&f.currentStyle[b];if((!N||N==="auto")&&document.defaultView){var A=document.defaultView.getComputedStyle(f,null);N=A?A[b]:null}return N==="auto"?null:N}function Jt(f,b,N){var A=document.createElement(f);return A.className=b||"",N&&N.appendChild(A),A}function rn(f){var b=f.parentNode;b&&b.removeChild(f)}function Rn(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function yi(f){var b=f.parentNode;b&&b.lastChild!==f&&b.appendChild(f)}function Ui(f){var b=f.parentNode;b&&b.firstChild!==f&&b.insertBefore(f,b.firstChild)}function Ba(f,b){if(f.classList!==void 0)return f.classList.contains(b);var N=ps(f);return N.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(N)}function st(f,b){if(f.classList!==void 0)for(var N=x(b),A=0,z=N.length;A<z;A++)f.classList.add(N[A]);else if(!Ba(f,b)){var X=ps(f);wo(f,(X?X+" ":"")+b)}}function Tn(f,b){f.classList!==void 0?f.classList.remove(b):wo(f,v((" "+ps(f)+" ").replace(" "+b+" "," ")))}function wo(f,b){f.className.baseVal===void 0?f.className=b:f.className.baseVal=b}function ps(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function fr(f,b){"opacity"in f.style?f.style.opacity=b:"filter"in f.style&&pd(f,b)}function pd(f,b){var N=!1,A="DXImageTransform.Microsoft.Alpha";try{N=f.filters.item(A)}catch{if(b===1)return}b=Math.round(b*100),N?(N.Enabled=b!==100,N.Opacity=b):f.style.filter+=" progid:"+A+"(opacity="+b+")"}function sl(f){for(var b=document.documentElement.style,N=0;N<f.length;N++)if(f[N]in b)return f[N];return!1}function Xr(f,b,N){var A=b||new ne(0,0);f.style[xo]=(ot.ie3d?"translate("+A.x+"px,"+A.y+"px)":"translate3d("+A.x+"px,"+A.y+"px,0)")+(N?" scale("+N+")":"")}function Zn(f,b){f._leaflet_pos=b,ot.any3d?Xr(f,b):(f.style.left=b.x+"px",f.style.top=b.y+"px")}function za(f){return f._leaflet_pos||new ne(0,0)}var pr,vi,fc;if("onselectstart"in document)pr=function(){xt(window,"selectstart",Yn)},vi=function(){an(window,"selectstart",Yn)};else{var To=sl(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);pr=function(){if(To){var f=document.documentElement.style;fc=f[To],f[To]="none"}},vi=function(){To&&(document.documentElement.style[To]=fc,fc=void 0)}}function rl(){xt(window,"dragstart",Yn)}function pu(){an(window,"dragstart",Yn)}var pc,bi;function mc(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(il(),pc=f,bi=f.style.outlineStyle,f.style.outlineStyle="none",xt(window,"keydown",il))}function il(){pc&&(pc.style.outlineStyle=bi,pc=void 0,bi=void 0,an(window,"keydown",il))}function So(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function tr(f){var b=f.getBoundingClientRect();return{x:b.width/f.offsetWidth||1,y:b.height/f.offsetHeight||1,boundingClientRect:b}}var np={__proto__:null,TRANSFORM:xo,TRANSITION:Ma,TRANSITION_END:Fa,get:dc,getStyle:ja,create:Jt,remove:rn,empty:Rn,toFront:yi,toBack:Ui,hasClass:Ba,addClass:st,removeClass:Tn,setClass:wo,getClass:ps,setOpacity:fr,testProp:sl,setTransform:Xr,setPosition:Zn,getPosition:za,get disableTextSelection(){return pr},get enableTextSelection(){return vi},disableImageDrag:rl,enableImageDrag:pu,preventOutline:mc,restoreOutline:il,getSizedParentNode:So,getScale:tr};function xt(f,b,N,A){if(b&&typeof b=="object")for(var z in b)Va(f,z,b[z],N);else{b=x(b);for(var X=0,le=b.length;X<le;X++)Va(f,b[X],N,A)}return this}var mr="_leaflet_events";function an(f,b,N,A){if(arguments.length===1)gr(f),delete f[mr];else if(b&&typeof b=="object")for(var z in b)Zr(f,z,b[z],N);else if(b=x(b),arguments.length===2)gr(f,function(Ee){return R(b,Ee)!==-1});else for(var X=0,le=b.length;X<le;X++)Zr(f,b[X],N,A);return this}function gr(f,b){for(var N in f[mr]){var A=N.split(/\d/)[0];(!b||b(A))&&Zr(f,A,null,null,N)}}var ca={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Va(f,b,N,A){var z=b+l(N)+(A?"_"+l(A):"");if(f[mr]&&f[mr][z])return this;var X=function(Ee){return N.call(A||f,Ee||window.event)},le=X;!ot.touchNative&&ot.pointer&&b.indexOf("touch")===0?X=fs(f,b,X):ot.touch&&b==="dblclick"?X=hc(f,X):"addEventListener"in f?b==="touchstart"||b==="touchmove"||b==="wheel"||b==="mousewheel"?f.addEventListener(ca[b]||b,X,ot.passiveEvents?{passive:!1}:!1):b==="mouseenter"||b==="mouseleave"?(X=function(Ee){Ee=Ee||window.event,Eo(f,Ee)&&le(Ee)},f.addEventListener(ca[b],X,!1)):f.addEventListener(b,le,!1):f.attachEvent("on"+b,X),f[mr]=f[mr]||{},f[mr][z]=X}function Zr(f,b,N,A,z){z=z||b+l(N)+(A?"_"+l(A):"");var X=f[mr]&&f[mr][z];if(!X)return this;!ot.touchNative&&ot.pointer&&b.indexOf("touch")===0?tp(f,b,X):ot.touch&&b==="dblclick"?Vi(f,X):"removeEventListener"in f?f.removeEventListener(ca[b]||b,X,!1):f.detachEvent("on"+b,X),f[mr][z]=null}function hn(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function al(f){return Va(f,"wheel",hn),this}function ol(f){return xt(f,"mousedown touchstart dblclick contextmenu",hn),f._leaflet_disable_click=!0,this}function Yn(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function _i(f){return Yn(f),hn(f),this}function mu(f){if(f.composedPath)return f.composedPath();for(var b=[],N=f.target;N;)b.push(N),N=N.parentNode;return b}function _s(f,b){if(!b)return new ne(f.clientX,f.clientY);var N=tr(b),A=N.boundingClientRect;return new ne((f.clientX-A.left)/N.x-b.clientLeft,(f.clientY-A.top)/N.y-b.clientTop)}var yr=ot.linux&&ot.chrome?window.devicePixelRatio:ot.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ll(f){return ot.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/yr:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function Eo(f,b){var N=b.relatedTarget;if(!N)return!0;try{for(;N&&N!==f;)N=N.parentNode}catch{return!1}return N!==f}var gc={__proto__:null,on:xt,off:an,stopPropagation:hn,disableScrollPropagation:al,disableClickPropagation:ol,preventDefault:Yn,stop:_i,getPropagationPath:mu,getMousePosition:_s,getWheelDelta:ll,isExternalTarget:Eo,addListener:xt,removeListener:an},yc=re.extend({run:function(f,b,N,A){this.stop(),this._el=f,this._inProgress=!0,this._duration=N||.25,this._easeOutPower=1/Math.max(A||.5,.2),this._startPos=za(f),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=D(this._animate,this),this._step()},_step:function(f){var b=+new Date-this._startTime,N=this._duration*1e3;b<N?this._runFrame(this._easeOut(b/N),f):(this._runFrame(1),this._complete())},_runFrame:function(f,b){var N=this._startPos.add(this._offset.multiplyBy(f));b&&N._round(),Zn(this._el,N),this.fire("step")},_complete:function(){W(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),Pt=re.extend({options:{crs:Gt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,b){b=w(this,b),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),b.zoom!==void 0&&(this._zoom=this._limitZoom(b.zoom)),b.center&&b.zoom!==void 0&&this.setView(Se(b.center),b.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ma&&ot.any3d&&!ot.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),xt(this._proxy,Fa,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,b,N){if(b=b===void 0?this._zoom:this._limitZoom(b),f=this._limitCenter(Se(f),b,this.options.maxBounds),N=N||{},this._stop(),this._loaded&&!N.reset&&N!==!0){N.animate!==void 0&&(N.zoom=r({animate:N.animate},N.zoom),N.pan=r({animate:N.animate,duration:N.duration},N.pan));var A=this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,b,N.zoom):this._tryAnimatedPan(f,N.pan);if(A)return clearTimeout(this._sizeTimer),this}return this._resetView(f,b,N.pan&&N.pan.noMoveStart),this},setZoom:function(f,b){return this._loaded?this.setView(this.getCenter(),f,{zoom:b}):(this._zoom=f,this)},zoomIn:function(f,b){return f=f||(ot.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,b)},zoomOut:function(f,b){return f=f||(ot.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,b)},setZoomAround:function(f,b,N){var A=this.getZoomScale(b),z=this.getSize().divideBy(2),X=f instanceof ne?f:this.latLngToContainerPoint(f),le=X.subtract(z).multiplyBy(1-1/A),Ee=this.containerPointToLatLng(z.add(le));return this.setView(Ee,b,{zoom:N})},_getBoundsCenterZoom:function(f,b){b=b||{},f=f.getBounds?f.getBounds():Ne(f);var N=K(b.paddingTopLeft||b.padding||[0,0]),A=K(b.paddingBottomRight||b.padding||[0,0]),z=this.getBoundsZoom(f,!1,N.add(A));if(z=typeof b.maxZoom=="number"?Math.min(b.maxZoom,z):z,z===1/0)return{center:f.getCenter(),zoom:z};var X=A.subtract(N).divideBy(2),le=this.project(f.getSouthWest(),z),Ee=this.project(f.getNorthEast(),z),Oe=this.unproject(le.add(Ee).divideBy(2).add(X),z);return{center:Oe,zoom:z}},fitBounds:function(f,b){if(f=Ne(f),!f.isValid())throw new Error("Bounds are not valid.");var N=this._getBoundsCenterZoom(f,b);return this.setView(N.center,N.zoom,b)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,b){return this.setView(f,this._zoom,{pan:b})},panBy:function(f,b){if(f=K(f).round(),b=b||{},!f.x&&!f.y)return this.fire("moveend");if(b.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new yc,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),b.animate!==!1){st(this._mapPane,"leaflet-pan-anim");var N=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,N,b.duration||.25,b.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,b,N){if(N=N||{},N.animate===!1||!ot.any3d)return this.setView(f,b,N);this._stop();var A=this.project(this.getCenter()),z=this.project(f),X=this.getSize(),le=this._zoom;f=Se(f),b=b===void 0?le:b;var Ee=Math.max(X.x,X.y),Oe=Ee*this.getZoomScale(le,b),Ge=z.distanceTo(A)||1,Je=1.42,it=Je*Je;function ut(is){var qa=is?-1:1,ko=is?Oe:Ee,fl=Oe*Oe-Ee*Ee+qa*it*it*Ge*Ge,$o=2*ko*it*Ge,$d=fl/$o,mp=Math.sqrt($d*$d+1)-$d,Ad=mp<1e-9?-18:Math.log(mp);return Ad}function kt(is){return(Math.exp(is)-Math.exp(-is))/2}function Wn(is){return(Math.exp(is)+Math.exp(-is))/2}function ms(is){return kt(is)/Wn(is)}var br=ut(0);function Wi(is){return Ee*(Wn(br)/Wn(br+Je*is))}function b_(is){return Ee*(Wn(br)*ms(br+Je*is)-kt(br))/it}function __(is){return 1-Math.pow(1-is,1.5)}var kd=Date.now(),Ru=(ut(1)-br)/Je,x_=N.duration?1e3*N.duration:1e3*Ru*.8;function Du(){var is=(Date.now()-kd)/x_,qa=__(is)*Ru;is<=1?(this._flyToFrame=D(Du,this),this._move(this.unproject(A.add(z.subtract(A).multiplyBy(b_(qa)/Ge)),le),this.getScaleZoom(Ee/Wi(qa),le),{flyTo:!0})):this._move(f,b)._moveEnd(!0)}return this._moveStart(!0,N.noMoveStart),Du.call(this),this},flyToBounds:function(f,b){var N=this._getBoundsCenterZoom(f,b);return this.flyTo(N.center,N.zoom,b)},setMaxBounds:function(f){return f=Ne(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var b=this.options.minZoom;return this.options.minZoom=f,this._loaded&&b!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var b=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&b!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,b){this._enforcingBounds=!0;var N=this.getCenter(),A=this._limitCenter(N,this._zoom,Ne(f));return N.equals(A)||this.panTo(A,b),this._enforcingBounds=!1,this},panInside:function(f,b){b=b||{};var N=K(b.paddingTopLeft||b.padding||[0,0]),A=K(b.paddingBottomRight||b.padding||[0,0]),z=this.project(this.getCenter()),X=this.project(f),le=this.getPixelBounds(),Ee=pe([le.min.add(N),le.max.subtract(A)]),Oe=Ee.getSize();if(!Ee.contains(X)){this._enforcingBounds=!0;var Ge=X.subtract(Ee.getCenter()),Je=Ee.extend(X).getSize().subtract(Oe);z.x+=Ge.x<0?-Je.x:Je.x,z.y+=Ge.y<0?-Je.y:Je.y,this.panTo(this.unproject(z),b),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=r({animate:!1,pan:!0},f===!0?{animate:!0}:f);var b=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var N=this.getSize(),A=b.divideBy(2).round(),z=N.divideBy(2).round(),X=A.subtract(z);return!X.x&&!X.y?this:(f.animate&&f.pan?this.panBy(X):(f.pan&&this._rawPanBy(X),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:N}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=r({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=a(this._handleGeolocationResponse,this),N=a(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,N,f):navigator.geolocation.getCurrentPosition(b,N,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var b=f.code,N=f.message||(b===1?"permission denied":b===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+N+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var b=f.coords.latitude,N=f.coords.longitude,A=new Te(b,N),z=A.toBounds(f.coords.accuracy*2),X=this._locateOptions;if(X.setView){var le=this.getBoundsZoom(z);this.setView(A,X.maxZoom?Math.min(le,X.maxZoom):le)}var Ee={latlng:A,bounds:z,timestamp:f.timestamp};for(var Oe in f.coords)typeof f.coords[Oe]=="number"&&(Ee[Oe]=f.coords[Oe]);this.fire("locationfound",Ee)}},addHandler:function(f,b){if(!b)return this;var N=this[f]=new b(this);return this._handlers.push(N),this.options[f]&&N.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),rn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(W(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)rn(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,b){var N="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),A=Jt("div",N,b||this._mapPane);return f&&(this._panes[f]=A),A},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),b=this.unproject(f.getBottomLeft()),N=this.unproject(f.getTopRight());return new fe(b,N)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,b,N){f=Ne(f),N=K(N||[0,0]);var A=this.getZoom()||0,z=this.getMinZoom(),X=this.getMaxZoom(),le=f.getNorthWest(),Ee=f.getSouthEast(),Oe=this.getSize().subtract(N),Ge=pe(this.project(Ee,A),this.project(le,A)).getSize(),Je=ot.any3d?this.options.zoomSnap:1,it=Oe.x/Ge.x,ut=Oe.y/Ge.y,kt=b?Math.max(it,ut):Math.min(it,ut);return A=this.getScaleZoom(kt,A),Je&&(A=Math.round(A/(Je/100))*(Je/100),A=b?Math.ceil(A/Je)*Je:Math.floor(A/Je)*Je),Math.max(z,Math.min(X,A))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ne(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,b){var N=this._getTopLeftPoint(f,b);return new ie(N,N.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,b){var N=this.options.crs;return b=b===void 0?this._zoom:b,N.scale(f)/N.scale(b)},getScaleZoom:function(f,b){var N=this.options.crs;b=b===void 0?this._zoom:b;var A=N.zoom(f*N.scale(b));return isNaN(A)?1/0:A},project:function(f,b){return b=b===void 0?this._zoom:b,this.options.crs.latLngToPoint(Se(f),b)},unproject:function(f,b){return b=b===void 0?this._zoom:b,this.options.crs.pointToLatLng(K(f),b)},layerPointToLatLng:function(f){var b=K(f).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(f){var b=this.project(Se(f))._round();return b._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(Se(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(Ne(f))},distance:function(f,b){return this.options.crs.distance(Se(f),Se(b))},containerPointToLayerPoint:function(f){return K(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return K(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var b=this.containerPointToLayerPoint(K(f));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Se(f)))},mouseEventToContainerPoint:function(f){return _s(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var b=this._container=dc(f);if(b){if(b._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");xt(b,"scroll",this._onScroll,this),this._containerId=l(b)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&ot.any3d,st(f,"leaflet-container"+(ot.touch?" leaflet-touch":"")+(ot.retina?" leaflet-retina":"")+(ot.ielt9?" leaflet-oldie":"")+(ot.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=ja(f,"position");b!=="absolute"&&b!=="relative"&&b!=="fixed"&&b!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Zn(this._mapPane,new ne(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(st(f.markerPane,"leaflet-zoom-hide"),st(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,b,N){Zn(this._mapPane,new ne(0,0));var A=!this._loaded;this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var z=this._zoom!==b;this._moveStart(z,N)._move(f,b)._moveEnd(z),this.fire("viewreset"),A&&this.fire("load")},_moveStart:function(f,b){return f&&this.fire("zoomstart"),b||this.fire("movestart"),this},_move:function(f,b,N,A){b===void 0&&(b=this._zoom);var z=this._zoom!==b;return this._zoom=b,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),A?N&&N.pinch&&this.fire("zoom",N):((z||N&&N.pinch)&&this.fire("zoom",N),this.fire("move",N)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return W(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){Zn(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[l(this._container)]=this;var b=f?an:xt;b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&b(window,"resize",this._onResize,this),ot.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){W(this._resizeRequest),this._resizeRequest=D(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,b){for(var N=[],A,z=b==="mouseout"||b==="mouseover",X=f.target||f.srcElement,le=!1;X;){if(A=this._targets[l(X)],A&&(b==="click"||b==="preclick")&&this._draggableMoved(A)){le=!0;break}if(A&&A.listens(b,!0)&&(z&&!Eo(X,f)||(N.push(A),z))||X===this._container)break;X=X.parentNode}return!N.length&&!le&&!z&&this.listens(b,!0)&&(N=[this]),N},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var b=f.target||f.srcElement;if(!(!this._loaded||b._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(b))){var N=f.type;N==="mousedown"&&mc(b),this._fireDOMEvent(f,N)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,b,N){if(f.type==="click"){var A=r({},f);A.type="preclick",this._fireDOMEvent(A,A.type,N)}var z=this._findEventTargets(f,b);if(N){for(var X=[],le=0;le<N.length;le++)N[le].listens(b,!0)&&X.push(N[le]);z=X.concat(z)}if(z.length){b==="contextmenu"&&Yn(f);var Ee=z[0],Oe={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Ge=Ee.getLatLng&&(!Ee._radius||Ee._radius<=10);Oe.containerPoint=Ge?this.latLngToContainerPoint(Ee.getLatLng()):this.mouseEventToContainerPoint(f),Oe.layerPoint=this.containerPointToLayerPoint(Oe.containerPoint),Oe.latlng=Ge?Ee.getLatLng():this.layerPointToLatLng(Oe.layerPoint)}for(le=0;le<z.length;le++)if(z[le].fire(b,Oe,!0),Oe.originalEvent._stopped||z[le].options.bubblingMouseEvents===!1&&R(this._mouseEvents,b)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,b=this._handlers.length;f<b;f++)this._handlers[f].disable()},whenReady:function(f,b){return this._loaded?f.call(b||this,{target:this}):this.on("load",f,b),this},_getMapPanePos:function(){return za(this._mapPane)||new ne(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,b){var N=f&&b!==void 0?this._getNewPixelOrigin(f,b):this.getPixelOrigin();return N.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,b){var N=this.getSize()._divideBy(2);return this.project(f,b)._subtract(N)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,b,N){var A=this._getNewPixelOrigin(N,b);return this.project(f,b)._subtract(A)},_latLngBoundsToNewLayerBounds:function(f,b,N){var A=this._getNewPixelOrigin(N,b);return pe([this.project(f.getSouthWest(),b)._subtract(A),this.project(f.getNorthWest(),b)._subtract(A),this.project(f.getSouthEast(),b)._subtract(A),this.project(f.getNorthEast(),b)._subtract(A)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,b,N){if(!N)return f;var A=this.project(f,b),z=this.getSize().divideBy(2),X=new ie(A.subtract(z),A.add(z)),le=this._getBoundsOffset(X,N,b);return Math.abs(le.x)<=1&&Math.abs(le.y)<=1?f:this.unproject(A.add(le),b)},_limitOffset:function(f,b){if(!b)return f;var N=this.getPixelBounds(),A=new ie(N.min.add(f),N.max.add(f));return f.add(this._getBoundsOffset(A,b))},_getBoundsOffset:function(f,b,N){var A=pe(this.project(b.getNorthEast(),N),this.project(b.getSouthWest(),N)),z=A.min.subtract(f.min),X=A.max.subtract(f.max),le=this._rebound(z.x,-X.x),Ee=this._rebound(z.y,-X.y);return new ne(le,Ee)},_rebound:function(f,b){return f+b>0?Math.round(f-b)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(b))},_limitZoom:function(f){var b=this.getMinZoom(),N=this.getMaxZoom(),A=ot.any3d?this.options.zoomSnap:1;return A&&(f=Math.round(f/A)*A),Math.max(b,Math.min(N,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Tn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,b){var N=this._getCenterOffset(f)._trunc();return(b&&b.animate)!==!0&&!this.getSize().contains(N)?!1:(this.panBy(N,b),!0)},_createAnimProxy:function(){var f=this._proxy=Jt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(b){var N=xo,A=this._proxy.style[N];Xr(this._proxy,this.project(b.center,b.zoom),this.getZoomScale(b.zoom,1)),A===this._proxy.style[N]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){rn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),b=this.getZoom();Xr(this._proxy,this.project(f,b),this.getZoomScale(b,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,b,N){if(this._animatingZoom)return!0;if(N=N||{},!this._zoomAnimated||N.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var A=this.getZoomScale(b),z=this._getCenterOffset(f)._divideBy(1-1/A);return N.animate!==!0&&!this.getSize().contains(z)?!1:(D(function(){this._moveStart(!0,N.noMoveStart||!1)._animateZoom(f,b,!0)},this),!0)},_animateZoom:function(f,b,N,A){this._mapPane&&(N&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=b,st(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:b,noUpdate:A}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Tn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ua(f,b){return new Pt(f,b)}var nr=ae.extend({options:{position:"topright"},initialize:function(f){w(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var b=this._map;return b&&b.removeControl(this),this.options.position=f,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var b=this._container=this.onAdd(f),N=this.getPosition(),A=f._controlCorners[N];return st(b,"leaflet-control"),N.indexOf("bottom")!==-1?A.insertBefore(b,A.firstChild):A.appendChild(b),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(rn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),ua=function(f){return new nr(f)};Pt.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},b="leaflet-",N=this._controlContainer=Jt("div",b+"control-container",this._container);function A(z,X){var le=b+z+" "+b+X;f[z+X]=Jt("div",le,N)}A("top","left"),A("top","right"),A("bottom","left"),A("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)rn(this._controlCorners[f]);rn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var sp=nr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,b,N,A){return N<A?-1:A<N?1:0}},initialize:function(f,b,N){w(this,N),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var A in f)this._addLayer(f[A],A);for(A in b)this._addLayer(b[A],A,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var b=0;b<this._layers.length;b++)this._layers[b].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return nr.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,b){return this._addLayer(f,b),this._map?this._update():this},addOverlay:function(f,b){return this._addLayer(f,b,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var b=this._getLayer(l(f));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){st(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(st(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):Tn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Tn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",b=this._container=Jt("div",f),N=this.options.collapsed;b.setAttribute("aria-haspopup",!0),ol(b),al(b);var A=this._section=Jt("section",f+"-list");N&&(this._map.on("click",this.collapse,this),xt(b,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var z=this._layersLink=Jt("a",f+"-toggle",b);z.href="#",z.title="Layers",z.setAttribute("role","button"),xt(z,{keydown:function(X){X.keyCode===13&&this._expandSafely()},click:function(X){Yn(X),this._expandSafely()}},this),N||this.expand(),this._baseLayersList=Jt("div",f+"-base",A),this._separator=Jt("div",f+"-separator",A),this._overlaysList=Jt("div",f+"-overlays",A),b.appendChild(A)},_getLayer:function(f){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&l(this._layers[b].layer)===f)return this._layers[b]},_addLayer:function(f,b,N){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:b,overlay:N}),this.options.sortLayers&&this._layers.sort(a(function(A,z){return this.options.sortFunction(A.layer,z.layer,A.name,z.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Rn(this._baseLayersList),Rn(this._overlaysList),this._layerControlInputs=[];var f,b,N,A,z=0;for(N=0;N<this._layers.length;N++)A=this._layers[N],this._addItem(A),b=b||A.overlay,f=f||!A.overlay,z+=A.overlay?0:1;return this.options.hideSingleBase&&(f=f&&z>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=b&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var b=this._getLayer(l(f.target)),N=b.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;N&&this._map.fire(N,b)},_createRadioElement:function(f,b){var N='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(b?' checked="checked"':"")+"/>",A=document.createElement("div");return A.innerHTML=N,A.firstChild},_addItem:function(f){var b=document.createElement("label"),N=this._map.hasLayer(f.layer),A;f.overlay?(A=document.createElement("input"),A.type="checkbox",A.className="leaflet-control-layers-selector",A.defaultChecked=N):A=this._createRadioElement("leaflet-base-layers_"+l(this),N),this._layerControlInputs.push(A),A.layerId=l(f.layer),xt(A,"click",this._onInputClick,this);var z=document.createElement("span");z.innerHTML=" "+f.name;var X=document.createElement("span");b.appendChild(X),X.appendChild(A),X.appendChild(z);var le=f.overlay?this._overlaysList:this._baseLayersList;return le.appendChild(b),this._checkDisabledLayers(),b},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,b,N,A=[],z=[];this._handlingClick=!0;for(var X=f.length-1;X>=0;X--)b=f[X],N=this._getLayer(b.layerId).layer,b.checked?A.push(N):b.checked||z.push(N);for(X=0;X<z.length;X++)this._map.hasLayer(z[X])&&this._map.removeLayer(z[X]);for(X=0;X<A.length;X++)this._map.hasLayer(A[X])||this._map.addLayer(A[X]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,b,N,A=this._map.getZoom(),z=f.length-1;z>=0;z--)b=f[z],N=this._getLayer(b.layerId).layer,b.disabled=N.options.minZoom!==void 0&&A<N.options.minZoom||N.options.maxZoom!==void 0&&A>N.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,xt(f,"click",Yn),this.expand();var b=this;setTimeout(function(){an(f,"click",Yn),b._preventClick=!1})}}),rp=function(f,b,N){return new sp(f,b,N)},No=nr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var b="leaflet-control-zoom",N=Jt("div",b+" leaflet-bar"),A=this.options;return this._zoomInButton=this._createButton(A.zoomInText,A.zoomInTitle,b+"-in",N,this._zoomIn),this._zoomOutButton=this._createButton(A.zoomOutText,A.zoomOutTitle,b+"-out",N,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),N},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,b,N,A,z){var X=Jt("a",N,A);return X.innerHTML=f,X.href="#",X.title=b,X.setAttribute("role","button"),X.setAttribute("aria-label",b),ol(X),xt(X,"click",_i),xt(X,"click",z,this),xt(X,"click",this._refocusOnMap,this),X},_updateDisabled:function(){var f=this._map,b="leaflet-disabled";Tn(this._zoomInButton,b),Tn(this._zoomOutButton,b),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(st(this._zoomOutButton,b),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(st(this._zoomInButton,b),this._zoomInButton.setAttribute("aria-disabled","true"))}});Pt.mergeOptions({zoomControl:!0}),Pt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new No,this.addControl(this.zoomControl))});var gu=function(f){return new No(f)},md=nr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var b="leaflet-control-scale",N=Jt("div",b),A=this.options;return this._addScales(A,b+"-line",N),f.on(A.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),N},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,b,N){f.metric&&(this._mScale=Jt("div",b,N)),f.imperial&&(this._iScale=Jt("div",b,N))},_update:function(){var f=this._map,b=f.getSize().y/2,N=f.distance(f.containerPointToLatLng([0,b]),f.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(N)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var b=this._getRoundNum(f),N=b<1e3?b+" m":b/1e3+" km";this._updateScale(this._mScale,N,b/f)},_updateImperial:function(f){var b=f*3.2808399,N,A,z;b>5280?(N=b/5280,A=this._getRoundNum(N),this._updateScale(this._iScale,A+" mi",A/N)):(z=this._getRoundNum(b),this._updateScale(this._iScale,z+" ft",z/b))},_updateScale:function(f,b,N){f.style.width=Math.round(this.options.maxWidth*N)+"px",f.innerHTML=b},_getRoundNum:function(f){var b=Math.pow(10,(Math.floor(f)+"").length-1),N=f/b;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:1,b*N}}),gd=function(f){return new md(f)},yd='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',yu=nr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ot.inlineSvg?yd+" ":"")+"Leaflet</a>"},initialize:function(f){w(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Jt("div","leaflet-control-attribution"),ol(this._container);for(var b in f._layers)f._layers[b].getAttribution&&this.addAttribution(f._layers[b].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var b in this._attributions)this._attributions[b]&&f.push(b);var N=[];this.options.prefix&&N.push(this.options.prefix),f.length&&N.push(f.join(", ")),this._container.innerHTML=N.join(' <span aria-hidden="true">|</span> ')}}});Pt.mergeOptions({attributionControl:!0}),Pt.addInitHook(function(){this.options.attributionControl&&new yu().addTo(this)});var vu=function(f){return new yu(f)};nr.Layers=sp,nr.Zoom=No,nr.Scale=md,nr.Attribution=yu,ua.layers=rp,ua.zoom=gu,ua.scale=gd,ua.attribution=vu;var Yr=ae.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Yr.addTo=function(f,b){return f.addHandler(b,this),this};var ip={Events:Z},Ga=ot.touch?"touchstart mousedown":"mousedown",ha=re.extend({options:{clickTolerance:3},initialize:function(f,b,N,A){w(this,A),this._element=f,this._dragStartTarget=b||f,this._preventOutline=N},enable:function(){this._enabled||(xt(this._dragStartTarget,Ga,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ha._dragging===this&&this.finishDrag(!0),an(this._dragStartTarget,Ga,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!Ba(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){ha._dragging===this&&this.finishDrag();return}if(!(ha._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(ha._dragging=this,this._preventOutline&&mc(this._element),rl(),pr(),!this._moving)){this.fire("down");var b=f.touches?f.touches[0]:f,N=So(this._element);this._startPoint=new ne(b.clientX,b.clientY),this._startPos=za(this._element),this._parentScale=tr(N);var A=f.type==="mousedown";xt(document,A?"mousemove":"touchmove",this._onMove,this),xt(document,A?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var b=f.touches&&f.touches.length===1?f.touches[0]:f,N=new ne(b.clientX,b.clientY)._subtract(this._startPoint);!N.x&&!N.y||Math.abs(N.x)+Math.abs(N.y)<this.options.clickTolerance||(N.x/=this._parentScale.x,N.y/=this._parentScale.y,Yn(f),this._moved||(this.fire("dragstart"),this._moved=!0,st(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),st(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(N),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),Zn(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){Tn(document.body,"leaflet-dragging"),this._lastTarget&&(Tn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),an(document,"mousemove touchmove",this._onMove,this),an(document,"mouseup touchend touchcancel",this._onUp,this),pu(),vi();var b=this._moved&&this._moving;this._moving=!1,ha._dragging=!1,b&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function vd(f,b,N){var A,z=[1,4,2,8],X,le,Ee,Oe,Ge,Je,it,ut;for(X=0,Je=f.length;X<Je;X++)f[X]._code=Re(f[X],b);for(Ee=0;Ee<4;Ee++){for(it=z[Ee],A=[],X=0,Je=f.length,le=Je-1;X<Je;le=X++)Oe=f[X],Ge=f[le],Oe._code&it?Ge._code&it||(ut=Ie(Ge,Oe,it,b,N),ut._code=Re(ut,b),A.push(ut)):(Ge._code&it&&(ut=Ie(Ge,Oe,it,b,N),ut._code=Re(ut,b),A.push(ut)),A.push(Oe));f=A}return f}function vc(f,b){var N,A,z,X,le,Ee,Oe,Ge,Je;if(!f||f.length===0)throw new Error("latlngs not passed");Kt(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var it=Se([0,0]),ut=Ne(f),kt=ut.getNorthWest().distanceTo(ut.getSouthWest())*ut.getNorthEast().distanceTo(ut.getNorthWest());kt<1700&&(it=bu(f));var Wn=f.length,ms=[];for(N=0;N<Wn;N++){var br=Se(f[N]);ms.push(b.project(Se([br.lat-it.lat,br.lng-it.lng])))}for(Ee=Oe=Ge=0,N=0,A=Wn-1;N<Wn;A=N++)z=ms[N],X=ms[A],le=z.y*X.x-X.y*z.x,Oe+=(z.x+X.x)*le,Ge+=(z.y+X.y)*le,Ee+=le*3;Ee===0?Je=ms[0]:Je=[Oe/Ee,Ge/Ee];var Wi=b.unproject(K(Je));return Se([Wi.lat+it.lat,Wi.lng+it.lng])}function bu(f){for(var b=0,N=0,A=0,z=0;z<f.length;z++){var X=Se(f[z]);b+=X.lat,N+=X.lng,A++}return Se([b/A,N/A])}var _u={__proto__:null,clipPolygon:vd,polygonCenter:vc,centroid:bu};function vr(f,b){if(!b||!f.length)return f.slice();var N=b*b;return f=F(f,N),f=cl(f,N),f}function xu(f,b,N){return Math.sqrt(wt(f,b,N,!0))}function ap(f,b,N){return wt(f,b,N)}function cl(f,b){var N=f.length,A=typeof Uint8Array<"u"?Uint8Array:Array,z=new A(N);z[0]=z[N-1]=1,S(f,z,b,0,N-1);var X,le=[];for(X=0;X<N;X++)z[X]&&le.push(f[X]);return le}function S(f,b,N,A,z){var X=0,le,Ee,Oe;for(Ee=A+1;Ee<=z-1;Ee++)Oe=wt(f[Ee],f[A],f[z],!0),Oe>X&&(le=Ee,X=Oe);X>N&&(b[le]=1,S(f,b,N,A,le),S(f,b,N,le,z))}function F(f,b){for(var N=[f[0]],A=1,z=0,X=f.length;A<X;A++)Xe(f[A],f[z])>b&&(N.push(f[A]),z=A);return z<X-1&&N.push(f[X-1]),N}var G;function ee(f,b,N,A,z){var X=A?G:Re(f,N),le=Re(b,N),Ee,Oe,Ge;for(G=le;;){if(!(X|le))return[f,b];if(X&le)return!1;Ee=X||le,Oe=Ie(f,b,Ee,N,z),Ge=Re(Oe,N),Ee===X?(f=Oe,X=Ge):(b=Oe,le=Ge)}}function Ie(f,b,N,A,z){var X=b.x-f.x,le=b.y-f.y,Ee=A.min,Oe=A.max,Ge,Je;return N&8?(Ge=f.x+X*(Oe.y-f.y)/le,Je=Oe.y):N&4?(Ge=f.x+X*(Ee.y-f.y)/le,Je=Ee.y):N&2?(Ge=Oe.x,Je=f.y+le*(Oe.x-f.x)/X):N&1&&(Ge=Ee.x,Je=f.y+le*(Ee.x-f.x)/X),new ne(Ge,Je,z)}function Re(f,b){var N=0;return f.x<b.min.x?N|=1:f.x>b.max.x&&(N|=2),f.y<b.min.y?N|=4:f.y>b.max.y&&(N|=8),N}function Xe(f,b){var N=b.x-f.x,A=b.y-f.y;return N*N+A*A}function wt(f,b,N,A){var z=b.x,X=b.y,le=N.x-z,Ee=N.y-X,Oe=le*le+Ee*Ee,Ge;return Oe>0&&(Ge=((f.x-z)*le+(f.y-X)*Ee)/Oe,Ge>1?(z=N.x,X=N.y):Ge>0&&(z+=le*Ge,X+=Ee*Ge)),le=f.x-z,Ee=f.y-X,A?le*le+Ee*Ee:new ne(z,X)}function Kt(f){return!$(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function yn(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Kt(f)}function rs(f,b){var N,A,z,X,le,Ee,Oe,Ge;if(!f||f.length===0)throw new Error("latlngs not passed");Kt(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var Je=Se([0,0]),it=Ne(f),ut=it.getNorthWest().distanceTo(it.getSouthWest())*it.getNorthEast().distanceTo(it.getNorthWest());ut<1700&&(Je=bu(f));var kt=f.length,Wn=[];for(N=0;N<kt;N++){var ms=Se(f[N]);Wn.push(b.project(Se([ms.lat-Je.lat,ms.lng-Je.lng])))}for(N=0,A=0;N<kt-1;N++)A+=Wn[N].distanceTo(Wn[N+1])/2;if(A===0)Ge=Wn[0];else for(N=0,X=0;N<kt-1;N++)if(le=Wn[N],Ee=Wn[N+1],z=le.distanceTo(Ee),X+=z,X>A){Oe=(X-A)/z,Ge=[Ee.x-Oe*(Ee.x-le.x),Ee.y-Oe*(Ee.y-le.y)];break}var br=b.unproject(K(Ge));return Se([br.lat+Je.lat,br.lng+Je.lng])}var xi={__proto__:null,simplify:vr,pointToSegmentDistance:xu,closestPointOnSegment:ap,clipSegment:ee,_getEdgeIntersection:Ie,_getBitCode:Re,_sqClosestPointOnSegment:wt,isFlat:Kt,_flat:yn,polylineCenter:rs},Gi={project:function(f){return new ne(f.lng,f.lat)},unproject:function(f){return new Te(f.y,f.x)},bounds:new ie([-180,-90],[180,90])},wi={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ie([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var b=Math.PI/180,N=this.R,A=f.lat*b,z=this.R_MINOR/N,X=Math.sqrt(1-z*z),le=X*Math.sin(A),Ee=Math.tan(Math.PI/4-A/2)/Math.pow((1-le)/(1+le),X/2);return A=-N*Math.log(Math.max(Ee,1e-10)),new ne(f.lng*b*N,A)},unproject:function(f){for(var b=180/Math.PI,N=this.R,A=this.R_MINOR/N,z=Math.sqrt(1-A*A),X=Math.exp(-f.y/N),le=Math.PI/2-2*Math.atan(X),Ee=0,Oe=.1,Ge;Ee<15&&Math.abs(Oe)>1e-7;Ee++)Ge=z*Math.sin(le),Ge=Math.pow((1-Ge)/(1+Ge),z/2),Oe=Math.PI/2-2*Math.atan(X*Ge)-le,le+=Oe;return new Te(le*b,f.x*b/N)}},da={__proto__:null,LonLat:Gi,Mercator:wi,SphericalMercator:pt},fa=r({},qe,{code:"EPSG:3395",projection:wi,transformation:(function(){var f=.5/(Math.PI*wi.R);return Lt(f,.5,-f,.5)})()}),wu=r({},qe,{code:"EPSG:4326",projection:Gi,transformation:Lt(1/180,1,-1/180,.5)}),qT=r({},He,{projection:Gi,transformation:Lt(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,b){var N=b.lng-f.lng,A=b.lat-f.lat;return Math.sqrt(N*N+A*A)},infinite:!0});He.Earth=qe,He.EPSG3395=fa,He.EPSG3857=Gt,He.EPSG900913=gn,He.EPSG4326=wu,He.Simple=qT;var pa=re.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[l(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[l(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var b=f.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var N=this.getEvents();b.on(N,this),this.once("remove",function(){b.off(N,this)},this)}this.onAdd(b),this.fire("add"),b.fire("layeradd",{layer:this})}}});Pt.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var b=l(f);return this._layers[b]?this:(this._layers[b]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var b=l(f);return this._layers[b]?(this._loaded&&f.onRemove(this),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return l(f)in this._layers},eachLayer:function(f,b){for(var N in this._layers)f.call(b,this._layers[N]);return this},_addLayers:function(f){f=f?$(f)?f:[f]:[];for(var b=0,N=f.length;b<N;b++)this.addLayer(f[b])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[l(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var b=l(f);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,b=-1/0,N=this._getZoomSpan();for(var A in this._zoomBoundLayers){var z=this._zoomBoundLayers[A].options;f=z.minZoom===void 0?f:Math.min(f,z.minZoom),b=z.maxZoom===void 0?b:Math.max(b,z.maxZoom)}this._layersMaxZoom=b===-1/0?void 0:b,this._layersMinZoom=f===1/0?void 0:f,N!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var bc=pa.extend({initialize:function(f,b){w(this,b),this._layers={};var N,A;if(f)for(N=0,A=f.length;N<A;N++)this.addLayer(f[N])},addLayer:function(f){var b=this.getLayerId(f);return this._layers[b]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var b=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(f){var b=typeof f=="number"?f:this.getLayerId(f);return b in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var b=Array.prototype.slice.call(arguments,1),N,A;for(N in this._layers)A=this._layers[N],A[f]&&A[f].apply(A,b);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,b){for(var N in this._layers)f.call(b,this._layers[N]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return l(f)}}),d_=function(f,b){return new bc(f,b)},Ti=bc.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),bc.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),bc.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new fe;for(var b in this._layers){var N=this._layers[b];f.extend(N.getBounds?N.getBounds():N.getLatLng())}return f}}),bd=function(f,b){return new Ti(f,b)},Tu=ae.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){w(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,b){var N=this._getIconUrl(f);if(!N){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var A=this._createImg(N,b&&b.tagName==="IMG"?b:null);return this._setIconStyles(A,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),A},_setIconStyles:function(f,b){var N=this.options,A=N[b+"Size"];typeof A=="number"&&(A=[A,A]);var z=K(A),X=K(b==="shadow"&&N.shadowAnchor||N.iconAnchor||z&&z.divideBy(2,!0));f.className="leaflet-marker-"+b+" "+(N.className||""),X&&(f.style.marginLeft=-X.x+"px",f.style.marginTop=-X.y+"px"),z&&(f.style.width=z.x+"px",f.style.height=z.y+"px")},_createImg:function(f,b){return b=b||document.createElement("img"),b.src=f,b},_getIconUrl:function(f){return ot.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function op(f){return new Tu(f)}var Su=Tu.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Su.imagePath!="string"&&(Su.imagePath=this._detectIconPath()),(this.options.imagePath||Su.imagePath)+Tu.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var b=function(N,A,z){var X=A.exec(N);return X&&X[z]};return f=b(f,/^url\((['"])?(.+)\1\)$/,2),f&&b(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Jt("div","leaflet-default-icon-path",document.body),b=ja(f,"background-image")||ja(f,"backgroundImage");if(document.body.removeChild(f),b=this._stripUrl(b),b)return b;var N=document.querySelector('link[href$="leaflet.css"]');return N?N.href.substring(0,N.href.length-11-1):""}}),mg=Yr.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new ha(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),st(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Tn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var b=this._marker,N=b._map,A=this._marker.options.autoPanSpeed,z=this._marker.options.autoPanPadding,X=za(b._icon),le=N.getPixelBounds(),Ee=N.getPixelOrigin(),Oe=pe(le.min._subtract(Ee).add(z),le.max._subtract(Ee).subtract(z));if(!Oe.contains(X)){var Ge=K((Math.max(Oe.max.x,X.x)-Oe.max.x)/(le.max.x-Oe.max.x)-(Math.min(Oe.min.x,X.x)-Oe.min.x)/(le.min.x-Oe.min.x),(Math.max(Oe.max.y,X.y)-Oe.max.y)/(le.max.y-Oe.max.y)-(Math.min(Oe.min.y,X.y)-Oe.min.y)/(le.min.y-Oe.min.y)).multiplyBy(A);N.panBy(Ge,{animate:!1}),this._draggable._newPos._add(Ge),this._draggable._startPos._add(Ge),Zn(b._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=D(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(W(this._panRequest),this._panRequest=D(this._adjustPan.bind(this,f)))},_onDrag:function(f){var b=this._marker,N=b._shadow,A=za(b._icon),z=b._map.layerPointToLatLng(A);N&&Zn(N,A),b._latlng=z,f.latlng=z,f.oldLatLng=this._oldLatLng,b.fire("move",f).fire("drag",f)},_onDragEnd:function(f){W(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),Eu=pa.extend({options:{icon:new Su,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,b){w(this,b),this._latlng=Se(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var b=this._latlng;return this._latlng=Se(f),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),N=f.icon.createIcon(this._icon),A=!1;N!==this._icon&&(this._icon&&this._removeIcon(),A=!0,f.title&&(N.title=f.title),N.tagName==="IMG"&&(N.alt=f.alt||"")),st(N,b),f.keyboard&&(N.tabIndex="0",N.setAttribute("role","button")),this._icon=N,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&xt(N,"focus",this._panOnFocus,this);var z=f.icon.createShadow(this._shadow),X=!1;z!==this._shadow&&(this._removeShadow(),X=!0),z&&(st(z,b),z.alt=""),this._shadow=z,f.opacity<1&&this._updateOpacity(),A&&this.getPane().appendChild(this._icon),this._initInteraction(),z&&X&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&an(this._icon,"focus",this._panOnFocus,this),rn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&rn(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&Zn(this._icon,f),this._shadow&&Zn(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var b=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&(st(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),mg)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new mg(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&fr(this._icon,f),this._shadow&&fr(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var b=this.options.icon.options,N=b.iconSize?K(b.iconSize):K(0,0),A=b.iconAnchor?K(b.iconAnchor):K(0,0);f.panInside(this._latlng,{paddingTopLeft:A,paddingBottomRight:N.subtract(A)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function gg(f,b){return new Eu(f,b)}var Io=pa.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return w(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),_d=Io.extend({options:{fill:!0,radius:10},initialize:function(f,b){w(this,b),this._latlng=Se(f),this._radius=this.options.radius},setLatLng:function(f){var b=this._latlng;return this._latlng=Se(f),this.redraw(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var b=f&&f.radius||this._radius;return Io.prototype.setStyle.call(this,f),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,b=this._radiusY||f,N=this._clickTolerance(),A=[f+N,b+N];this._pxBounds=new ie(this._point.subtract(A),this._point.add(A))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function f_(f,b){return new _d(f,b)}var yg=_d.extend({initialize:function(f,b,N){if(typeof b=="number"&&(b=r({},N,{radius:b})),w(this,b),this._latlng=Se(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new fe(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Io.prototype.setStyle,_project:function(){var f=this._latlng.lng,b=this._latlng.lat,N=this._map,A=N.options.crs;if(A.distance===qe.distance){var z=Math.PI/180,X=this._mRadius/qe.R/z,le=N.project([b+X,f]),Ee=N.project([b-X,f]),Oe=le.add(Ee).divideBy(2),Ge=N.unproject(Oe).lat,Je=Math.acos((Math.cos(X*z)-Math.sin(b*z)*Math.sin(Ge*z))/(Math.cos(b*z)*Math.cos(Ge*z)))/z;(isNaN(Je)||Je===0)&&(Je=X/Math.cos(Math.PI/180*b)),this._point=Oe.subtract(N.getPixelOrigin()),this._radius=isNaN(Je)?0:Oe.x-N.project([Ge,f-Je]).x,this._radiusY=Oe.y-le.y}else{var it=A.unproject(A.project(this._latlng).subtract([this._mRadius,0]));this._point=N.latLngToLayerPoint(this._latlng),this._radius=this._point.x-N.latLngToLayerPoint(it).x}this._updateBounds()}});function KT(f,b,N){return new yg(f,b,N)}var Co=Io.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,b){w(this,b),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var b=1/0,N=null,A=wt,z,X,le=0,Ee=this._parts.length;le<Ee;le++)for(var Oe=this._parts[le],Ge=1,Je=Oe.length;Ge<Je;Ge++){z=Oe[Ge-1],X=Oe[Ge];var it=A(f,z,X,!0);it<b&&(b=it,N=A(f,z,X))}return N&&(N.distance=Math.sqrt(b)),N},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return rs(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,b){return b=b||this._defaultShape(),f=Se(f),b.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new fe,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return Kt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var b=[],N=Kt(f),A=0,z=f.length;A<z;A++)N?(b[A]=Se(f[A]),this._bounds.extend(b[A])):b[A]=this._convertLatLngs(f[A]);return b},_project:function(){var f=new ie;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),b=new ne(f,f);this._rawPxBounds&&(this._pxBounds=new ie([this._rawPxBounds.min.subtract(b),this._rawPxBounds.max.add(b)]))},_projectLatlngs:function(f,b,N){var A=f[0]instanceof Te,z=f.length,X,le;if(A){for(le=[],X=0;X<z;X++)le[X]=this._map.latLngToLayerPoint(f[X]),N.extend(le[X]);b.push(le)}else for(X=0;X<z;X++)this._projectLatlngs(f[X],b,N)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var b=this._parts,N,A,z,X,le,Ee,Oe;for(N=0,z=0,X=this._rings.length;N<X;N++)for(Oe=this._rings[N],A=0,le=Oe.length;A<le-1;A++)Ee=ee(Oe[A],Oe[A+1],f,A,!0),Ee&&(b[z]=b[z]||[],b[z].push(Ee[0]),(Ee[1]!==Oe[A+1]||A===le-2)&&(b[z].push(Ee[1]),z++))}},_simplifyPoints:function(){for(var f=this._parts,b=this.options.smoothFactor,N=0,A=f.length;N<A;N++)f[N]=vr(f[N],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,b){var N,A,z,X,le,Ee,Oe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(N=0,X=this._parts.length;N<X;N++)for(Ee=this._parts[N],A=0,le=Ee.length,z=le-1;A<le;z=A++)if(!(!b&&A===0)&&xu(f,Ee[z],Ee[A])<=Oe)return!0;return!1}});function XT(f,b){return new Co(f,b)}Co._flat=yn;var Nu=Co.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vc(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var b=Co.prototype._convertLatLngs.call(this,f),N=b.length;return N>=2&&b[0]instanceof Te&&b[0].equals(b[N-1])&&b.pop(),b},_setLatLngs:function(f){Co.prototype._setLatLngs.call(this,f),Kt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Kt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,b=this.options.weight,N=new ne(b,b);if(f=new ie(f.min.subtract(N),f.max.add(N)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var A=0,z=this._rings.length,X;A<z;A++)X=vd(this._rings[A],f,!0),X.length&&this._parts.push(X)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var b=!1,N,A,z,X,le,Ee,Oe,Ge;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(X=0,Oe=this._parts.length;X<Oe;X++)for(N=this._parts[X],le=0,Ge=N.length,Ee=Ge-1;le<Ge;Ee=le++)A=N[le],z=N[Ee],A.y>f.y!=z.y>f.y&&f.x<(z.x-A.x)*(f.y-A.y)/(z.y-A.y)+A.x&&(b=!b);return b||Co.prototype._containsPoint.call(this,f,!0)}});function Si(f,b){return new Nu(f,b)}var Ei=Ti.extend({initialize:function(f,b){w(this,b),this._layers={},f&&this.addData(f)},addData:function(f){var b=$(f)?f:f.features,N,A,z;if(b){for(N=0,A=b.length;N<A;N++)z=b[N],(z.geometries||z.geometry||z.features||z.coordinates)&&this.addData(z);return this}var X=this.options;if(X.filter&&!X.filter(f))return this;var le=xd(f,X);return le?(le.feature=Iu(f),le.defaultOptions=le.options,this.resetStyle(le),X.onEachFeature&&X.onEachFeature(f,le),this.addLayer(le)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=r({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(b){this._setLayerStyle(b,f)},this)},_setLayerStyle:function(f,b){f.setStyle&&(typeof b=="function"&&(b=b(f.feature)),f.setStyle(b))}});function xd(f,b){var N=f.type==="Feature"?f.geometry:f,A=N?N.coordinates:null,z=[],X=b&&b.pointToLayer,le=b&&b.coordsToLatLng||lp,Ee,Oe,Ge,Je;if(!A&&!N)return null;switch(N.type){case"Point":return Ee=le(A),vg(X,f,Ee,b);case"MultiPoint":for(Ge=0,Je=A.length;Ge<Je;Ge++)Ee=le(A[Ge]),z.push(vg(X,f,Ee,b));return new Ti(z);case"LineString":case"MultiLineString":return Oe=wd(A,N.type==="LineString"?0:1,le),new Co(Oe,b);case"Polygon":case"MultiPolygon":return Oe=wd(A,N.type==="Polygon"?1:2,le),new Nu(Oe,b);case"GeometryCollection":for(Ge=0,Je=N.geometries.length;Ge<Je;Ge++){var it=xd({geometry:N.geometries[Ge],type:"Feature",properties:f.properties},b);it&&z.push(it)}return new Ti(z);case"FeatureCollection":for(Ge=0,Je=N.features.length;Ge<Je;Ge++){var ut=xd(N.features[Ge],b);ut&&z.push(ut)}return new Ti(z);default:throw new Error("Invalid GeoJSON object.")}}function vg(f,b,N,A){return f?f(b,N):new Eu(N,A&&A.markersInheritOptions&&A)}function lp(f){return new Te(f[1],f[0],f[2])}function wd(f,b,N){for(var A=[],z=0,X=f.length,le;z<X;z++)le=b?wd(f[z],b-1,N):(N||lp)(f[z]),A.push(le);return A}function Td(f,b){return f=Se(f),f.alt!==void 0?[m(f.lng,b),m(f.lat,b),m(f.alt,b)]:[m(f.lng,b),m(f.lat,b)]}function cp(f,b,N,A){for(var z=[],X=0,le=f.length;X<le;X++)z.push(b?cp(f[X],Kt(f[X])?0:b-1,N,A):Td(f[X],A));return!b&&N&&z.length>0&&z.push(z[0].slice()),z}function ma(f,b){return f.feature?r({},f.feature,{geometry:b}):Iu(b)}function Iu(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var _c={toGeoJSON:function(f){return ma(this,{type:"Point",coordinates:Td(this.getLatLng(),f)})}};Eu.include(_c),yg.include(_c),_d.include(_c),Co.include({toGeoJSON:function(f){var b=!Kt(this._latlngs),N=cp(this._latlngs,b?1:0,!1,f);return ma(this,{type:(b?"Multi":"")+"LineString",coordinates:N})}}),Nu.include({toGeoJSON:function(f){var b=!Kt(this._latlngs),N=b&&!Kt(this._latlngs[0]),A=cp(this._latlngs,N?2:b?1:0,!0,f);return b||(A=[A]),ma(this,{type:(N?"Multi":"")+"Polygon",coordinates:A})}}),bc.include({toMultiPoint:function(f){var b=[];return this.eachLayer(function(N){b.push(N.toGeoJSON(f).geometry.coordinates)}),ma(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(f){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(b==="MultiPoint")return this.toMultiPoint(f);var N=b==="GeometryCollection",A=[];return this.eachLayer(function(z){if(z.toGeoJSON){var X=z.toGeoJSON(f);if(N)A.push(X.geometry);else{var le=Iu(X);le.type==="FeatureCollection"?A.push.apply(A,le.features):A.push(le)}}}),N?ma(this,{geometries:A,type:"GeometryCollection"}):{type:"FeatureCollection",features:A}}});function up(f,b){return new Ei(f,b)}var p_=up,Wa=pa.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,b,N){this._url=f,this._bounds=Ne(b),w(this,N)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(st(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){rn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&yi(this._image),this},bringToBack:function(){return this._map&&Ui(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=Ne(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",b=this._image=f?this._url:Jt("img");if(st(b,"leaflet-image-layer"),this._zoomAnimated&&st(b,"leaflet-zoom-animated"),this.options.className&&st(b,this.options.className),b.onselectstart=p,b.onmousemove=p,b.onload=a(this.fire,this,"load"),b.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=b.src;return}b.src=this._url,b.alt=this.options.alt},_animateZoom:function(f){var b=this._map.getZoomScale(f.zoom),N=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;Xr(this._image,N,b)},_reset:function(){var f=this._image,b=new ie(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),N=b.getSize();Zn(f,b.min),f.style.width=N.x+"px",f.style.height=N.y+"px"},_updateOpacity:function(){fr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),Cu=function(f,b,N){return new Wa(f,b,N)},hp=Wa.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",b=this._image=f?this._url:Jt("video");if(st(b,"leaflet-image-layer"),this._zoomAnimated&&st(b,"leaflet-zoom-animated"),this.options.className&&st(b,this.options.className),b.onselectstart=p,b.onmousemove=p,b.onloadeddata=a(this.fire,this,"load"),f){for(var N=b.getElementsByTagName("source"),A=[],z=0;z<N.length;z++)A.push(N[z].src);this._url=N.length>0?A:[b.src];return}$(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(b.style,"objectFit")&&(b.style.objectFit="fill"),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop,b.muted=!!this.options.muted,b.playsInline=!!this.options.playsInline;for(var X=0;X<this._url.length;X++){var le=Jt("source");le.src=this._url[X],b.appendChild(le)}}});function m_(f,b,N){return new hp(f,b,N)}var ul=Wa.extend({_initImage:function(){var f=this._image=this._url;st(f,"leaflet-image-layer"),this._zoomAnimated&&st(f,"leaflet-zoom-animated"),this.options.className&&st(f,this.options.className),f.onselectstart=p,f.onmousemove=p}});function g_(f,b,N){return new ul(f,b,N)}var ga=pa.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,b){f&&(f instanceof Te||$(f))?(this._latlng=Se(f),w(this,b)):(w(this,f),this._source=b),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&fr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&fr(this._container,1),this.bringToFront(),this.options.interactive&&(st(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(fr(this._container,0),this._removeTimeout=setTimeout(a(rn,void 0,this._container),200)):rn(this._container),this.options.interactive&&(Tn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=Se(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&yi(this._container),this},bringToBack:function(){return this._map&&Ui(this._container),this},_prepareOpen:function(f){var b=this._source;if(!b._map)return!1;if(b instanceof Ti){b=null;var N=this._source._layers;for(var A in N)if(N[A]._map){b=N[A];break}if(!b)return!1;this._source=b}if(!f)if(b.getCenter)f=b.getCenter();else if(b.getLatLng)f=b.getLatLng();else if(b.getBounds)f=b.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,b=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof b=="string")f.innerHTML=b;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),b=K(this.options.offset),N=this._getAnchor();this._zoomAnimated?Zn(this._container,f.add(N)):b=b.add(f).add(N);var A=this._containerBottom=-b.y,z=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=A+"px",this._container.style.left=z+"px"}},_getAnchor:function(){return[0,0]}});Pt.include({_initOverlay:function(f,b,N,A){var z=b;return z instanceof f||(z=new f(A).setContent(b)),N&&z.setLatLng(N),z}}),pa.include({_initOverlay:function(f,b,N,A){var z=N;return z instanceof f?(w(z,A),z._source=this):(z=b&&!A?b:new f(A,this),z.setContent(N)),z}});var Sd=ga.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,ga.prototype.openOn.call(this,f)},onAdd:function(f){ga.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Io||this._source.on("preclick",hn))},onRemove:function(f){ga.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Io||this._source.off("preclick",hn))},getEvents:function(){var f=ga.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",b=this._container=Jt("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),N=this._wrapper=Jt("div",f+"-content-wrapper",b);if(this._contentNode=Jt("div",f+"-content",N),ol(b),al(this._contentNode),xt(b,"contextmenu",hn),this._tipContainer=Jt("div",f+"-tip-container",b),this._tip=Jt("div",f+"-tip",this._tipContainer),this.options.closeButton){var A=this._closeButton=Jt("a",f+"-close-button",b);A.setAttribute("role","button"),A.setAttribute("aria-label","Close popup"),A.href="#close",A.innerHTML='<span aria-hidden="true">&#215;</span>',xt(A,"click",function(z){Yn(z),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,b=f.style;b.width="",b.whiteSpace="nowrap";var N=f.offsetWidth;N=Math.min(N,this.options.maxWidth),N=Math.max(N,this.options.minWidth),b.width=N+1+"px",b.whiteSpace="",b.height="";var A=f.offsetHeight,z=this.options.maxHeight,X="leaflet-popup-scrolled";z&&A>z?(b.height=z+"px",st(f,X)):Tn(f,X),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var b=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),N=this._getAnchor();Zn(this._container,b.add(N))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,b=parseInt(ja(this._container,"marginBottom"),10)||0,N=this._container.offsetHeight+b,A=this._containerWidth,z=new ne(this._containerLeft,-N-this._containerBottom);z._add(za(this._container));var X=f.layerPointToContainerPoint(z),le=K(this.options.autoPanPadding),Ee=K(this.options.autoPanPaddingTopLeft||le),Oe=K(this.options.autoPanPaddingBottomRight||le),Ge=f.getSize(),Je=0,it=0;X.x+A+Oe.x>Ge.x&&(Je=X.x+A-Ge.x+Oe.x),X.x-Je-Ee.x<0&&(Je=X.x-Ee.x),X.y+N+Oe.y>Ge.y&&(it=X.y+N-Ge.y+Oe.y),X.y-it-Ee.y<0&&(it=X.y-Ee.y),(Je||it)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([Je,it]))}},_getAnchor:function(){return K(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ZT=function(f,b){return new Sd(f,b)};Pt.mergeOptions({closePopupOnClick:!0}),Pt.include({openPopup:function(f,b,N){return this._initOverlay(Sd,f,b,N).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),pa.include({bindPopup:function(f,b){return this._popup=this._initOverlay(Sd,this._popup,f,b),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof Ti||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){_i(f);var b=f.layer||f.target;if(this._popup._source===b&&!(b instanceof Io)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=b,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var dp=ga.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){ga.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){ga.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=ga.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",b=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Jt("div",b),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var b,N,A=this._map,z=this._container,X=A.latLngToContainerPoint(A.getCenter()),le=A.layerPointToContainerPoint(f),Ee=this.options.direction,Oe=z.offsetWidth,Ge=z.offsetHeight,Je=K(this.options.offset),it=this._getAnchor();Ee==="top"?(b=Oe/2,N=Ge):Ee==="bottom"?(b=Oe/2,N=0):Ee==="center"?(b=Oe/2,N=Ge/2):Ee==="right"?(b=0,N=Ge/2):Ee==="left"?(b=Oe,N=Ge/2):le.x<X.x?(Ee="right",b=0,N=Ge/2):(Ee="left",b=Oe+(Je.x+it.x)*2,N=Ge/2),f=f.subtract(K(b,N,!0)).add(Je).add(it),Tn(z,"leaflet-tooltip-right"),Tn(z,"leaflet-tooltip-left"),Tn(z,"leaflet-tooltip-top"),Tn(z,"leaflet-tooltip-bottom"),st(z,"leaflet-tooltip-"+Ee),Zn(z,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&fr(this._container,f)},_animateZoom:function(f){var b=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(b)},_getAnchor:function(){return K(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),YT=function(f,b){return new dp(f,b)};Pt.include({openTooltip:function(f,b,N){return this._initOverlay(dp,f,b,N).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),pa.include({bindTooltip:function(f,b){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(dp,this._tooltip,f,b),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var b=f?"off":"on",N={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?N.add=this._openTooltip:(N.mouseover=this._openTooltip,N.mouseout=this.closeTooltip,N.click=this._openTooltip,this._map?this._addFocusListeners():N.add=this._addFocusListeners),this._tooltip.options.sticky&&(N.mousemove=this._moveTooltip),this[b](N),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof Ti||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var b=typeof f.getElement=="function"&&f.getElement();b&&(xt(b,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),xt(b,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var b=typeof f.getElement=="function"&&f.getElement();b&&b.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var b=this;this._map.once("moveend",function(){b._openOnceFlag=!1,b._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var b=f.latlng,N,A;this._tooltip.options.sticky&&f.originalEvent&&(N=this._map.mouseEventToContainerPoint(f.originalEvent),A=this._map.containerPointToLayerPoint(N),b=this._map.layerPointToLatLng(A)),this._tooltip.setLatLng(b)}});var bg=Tu.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var b=f&&f.tagName==="DIV"?f:document.createElement("div"),N=this.options;if(N.html instanceof Element?(Rn(b),b.appendChild(N.html)):b.innerHTML=N.html!==!1?N.html:"",N.bgPos){var A=K(N.bgPos);b.style.backgroundPosition=-A.x+"px "+-A.y+"px"}return this._setIconStyles(b,"icon"),b},createShadow:function(){return null}});function y_(f){return new bg(f)}Tu.Default=Su;var xc=pa.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ot.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){w(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),rn(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(yi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ui(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=c(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof ne?f:new ne(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var b=this.getPane().children,N=-f(-1/0,1/0),A=0,z=b.length,X;A<z;A++)X=b[A].style.zIndex,b[A]!==this._container&&X&&(N=f(N,+X));isFinite(N)&&(this.options.zIndex=N+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ot.ielt9){fr(this._container,this.options.opacity);var f=+new Date,b=!1,N=!1;for(var A in this._tiles){var z=this._tiles[A];if(!(!z.current||!z.loaded)){var X=Math.min(1,(f-z.loaded)/200);fr(z.el,X),X<1?b=!0:(z.active?N=!0:this._onOpaqueTile(z),z.active=!0)}}N&&!this._noPrune&&this._pruneTiles(),b&&(W(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=Jt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,b=this.options.maxZoom;if(f!==void 0){for(var N in this._levels)N=Number(N),this._levels[N].el.children.length||N===f?(this._levels[N].el.style.zIndex=b-Math.abs(f-N),this._onUpdateLevel(N)):(rn(this._levels[N].el),this._removeTilesAtZoom(N),this._onRemoveLevel(N),delete this._levels[N]);var A=this._levels[f],z=this._map;return A||(A=this._levels[f]={},A.el=Jt("div","leaflet-tile-container leaflet-zoom-animated",this._container),A.el.style.zIndex=b,A.origin=z.project(z.unproject(z.getPixelOrigin()),f).round(),A.zoom=f,this._setZoomTransform(A,z.getCenter(),z.getZoom()),p(A.el.offsetWidth),this._onCreateLevel(A)),this._level=A,A}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var f,b,N=this._map.getZoom();if(N>this.options.maxZoom||N<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)b=this._tiles[f],b.retain=b.current;for(f in this._tiles)if(b=this._tiles[f],b.current&&!b.active){var A=b.coords;this._retainParent(A.x,A.y,A.z,A.z-5)||this._retainChildren(A.x,A.y,A.z,A.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var b in this._tiles)this._tiles[b].coords.z===f&&this._removeTile(b)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)rn(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,b,N,A){var z=Math.floor(f/2),X=Math.floor(b/2),le=N-1,Ee=new ne(+z,+X);Ee.z=+le;var Oe=this._tileCoordsToKey(Ee),Ge=this._tiles[Oe];return Ge&&Ge.active?(Ge.retain=!0,!0):(Ge&&Ge.loaded&&(Ge.retain=!0),le>A?this._retainParent(z,X,le,A):!1)},_retainChildren:function(f,b,N,A){for(var z=2*f;z<2*f+2;z++)for(var X=2*b;X<2*b+2;X++){var le=new ne(z,X);le.z=N+1;var Ee=this._tileCoordsToKey(le),Oe=this._tiles[Ee];if(Oe&&Oe.active){Oe.retain=!0;continue}else Oe&&Oe.loaded&&(Oe.retain=!0);N+1<A&&this._retainChildren(z,X,N+1,A)}},_resetView:function(f){var b=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var b=this.options;return b.minNativeZoom!==void 0&&f<b.minNativeZoom?b.minNativeZoom:b.maxNativeZoom!==void 0&&b.maxNativeZoom<f?b.maxNativeZoom:f},_setView:function(f,b,N,A){var z=Math.round(b);this.options.maxZoom!==void 0&&z>this.options.maxZoom||this.options.minZoom!==void 0&&z<this.options.minZoom?z=void 0:z=this._clampZoom(z);var X=this.options.updateWhenZooming&&z!==this._tileZoom;(!A||X)&&(this._tileZoom=z,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),z!==void 0&&this._update(f),N||this._pruneTiles(),this._noPrune=!!N),this._setZoomTransforms(f,b)},_setZoomTransforms:function(f,b){for(var N in this._levels)this._setZoomTransform(this._levels[N],f,b)},_setZoomTransform:function(f,b,N){var A=this._map.getZoomScale(N,f.zoom),z=f.origin.multiplyBy(A).subtract(this._map._getNewPixelOrigin(b,N)).round();ot.any3d?Xr(f.el,z,A):Zn(f.el,z)},_resetGrid:function(){var f=this._map,b=f.options.crs,N=this._tileSize=this.getTileSize(),A=this._tileZoom,z=this._map.getPixelWorldBounds(this._tileZoom);z&&(this._globalTileRange=this._pxBoundsToTileRange(z)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,b.wrapLng[0]],A).x/N.x),Math.ceil(f.project([0,b.wrapLng[1]],A).x/N.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([b.wrapLat[0],0],A).y/N.x),Math.ceil(f.project([b.wrapLat[1],0],A).y/N.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var b=this._map,N=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),A=b.getZoomScale(N,this._tileZoom),z=b.project(f,this._tileZoom).floor(),X=b.getSize().divideBy(A*2);return new ie(z.subtract(X),z.add(X))},_update:function(f){var b=this._map;if(b){var N=this._clampZoom(b.getZoom());if(f===void 0&&(f=b.getCenter()),this._tileZoom!==void 0){var A=this._getTiledPixelBounds(f),z=this._pxBoundsToTileRange(A),X=z.getCenter(),le=[],Ee=this.options.keepBuffer,Oe=new ie(z.getBottomLeft().subtract([Ee,-Ee]),z.getTopRight().add([Ee,-Ee]));if(!(isFinite(z.min.x)&&isFinite(z.min.y)&&isFinite(z.max.x)&&isFinite(z.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ge in this._tiles){var Je=this._tiles[Ge].coords;(Je.z!==this._tileZoom||!Oe.contains(new ne(Je.x,Je.y)))&&(this._tiles[Ge].current=!1)}if(Math.abs(N-this._tileZoom)>1){this._setView(f,N);return}for(var it=z.min.y;it<=z.max.y;it++)for(var ut=z.min.x;ut<=z.max.x;ut++){var kt=new ne(ut,it);if(kt.z=this._tileZoom,!!this._isValidTile(kt)){var Wn=this._tiles[this._tileCoordsToKey(kt)];Wn?Wn.current=!0:le.push(kt)}}if(le.sort(function(br,Wi){return br.distanceTo(X)-Wi.distanceTo(X)}),le.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ms=document.createDocumentFragment();for(ut=0;ut<le.length;ut++)this._addTile(le[ut],ms);this._level.el.appendChild(ms)}}}},_isValidTile:function(f){var b=this._map.options.crs;if(!b.infinite){var N=this._globalTileRange;if(!b.wrapLng&&(f.x<N.min.x||f.x>N.max.x)||!b.wrapLat&&(f.y<N.min.y||f.y>N.max.y))return!1}if(!this.options.bounds)return!0;var A=this._tileCoordsToBounds(f);return Ne(this.options.bounds).overlaps(A)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var b=this._map,N=this.getTileSize(),A=f.scaleBy(N),z=A.add(N),X=b.unproject(A,f.z),le=b.unproject(z,f.z);return[X,le]},_tileCoordsToBounds:function(f){var b=this._tileCoordsToNwSe(f),N=new fe(b[0],b[1]);return this.options.noWrap||(N=this._map.wrapLatLngBounds(N)),N},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var b=f.split(":"),N=new ne(+b[0],+b[1]);return N.z=+b[2],N},_removeTile:function(f){var b=this._tiles[f];b&&(rn(b.el),delete this._tiles[f],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){st(f,"leaflet-tile");var b=this.getTileSize();f.style.width=b.x+"px",f.style.height=b.y+"px",f.onselectstart=p,f.onmousemove=p,ot.ielt9&&this.options.opacity<1&&fr(f,this.options.opacity)},_addTile:function(f,b){var N=this._getTilePos(f),A=this._tileCoordsToKey(f),z=this.createTile(this._wrapCoords(f),a(this._tileReady,this,f));this._initTile(z),this.createTile.length<2&&D(a(this._tileReady,this,f,null,z)),Zn(z,N),this._tiles[A]={el:z,coords:f,current:!0},b.appendChild(z),this.fire("tileloadstart",{tile:z,coords:f})},_tileReady:function(f,b,N){b&&this.fire("tileerror",{error:b,tile:N,coords:f});var A=this._tileCoordsToKey(f);N=this._tiles[A],N&&(N.loaded=+new Date,this._map._fadeAnimated?(fr(N.el,0),W(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this)):(N.active=!0,this._pruneTiles()),b||(st(N.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:N.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ot.ielt9||!this._map._fadeAnimated?D(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var b=new ne(this._wrapX?h(f.x,this._wrapX):f.x,this._wrapY?h(f.y,this._wrapY):f.y);return b.z=f.z,b},_pxBoundsToTileRange:function(f){var b=this.getTileSize();return new ie(f.min.unscaleBy(b).floor(),f.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function ya(f){return new xc(f)}var wc=xc.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,b){this._url=f,b=w(this,b),b.detectRetina&&ot.retina&&b.maxZoom>0?(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom=Math.min(b.maxZoom,b.minZoom+1)):(b.zoomOffset++,b.maxZoom=Math.max(b.minZoom,b.maxZoom-1)),b.minZoom=Math.max(0,b.minZoom)):b.zoomReverse?b.minZoom=Math.min(b.maxZoom,b.minZoom):b.maxZoom=Math.max(b.minZoom,b.maxZoom),typeof b.subdomains=="string"&&(b.subdomains=b.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,b){return this._url===f&&b===void 0&&(b=!0),this._url=f,b||this.redraw(),this},createTile:function(f,b){var N=document.createElement("img");return xt(N,"load",a(this._tileOnLoad,this,b,N)),xt(N,"error",a(this._tileOnError,this,b,N)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(N.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(N.referrerPolicy=this.options.referrerPolicy),N.alt="",N.src=this.getTileUrl(f),N},getTileUrl:function(f){var b={r:ot.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var N=this._globalTileRange.max.y-f.y;this.options.tms&&(b.y=N),b["-y"]=N}return C(this._url,r(b,this.options))},_tileOnLoad:function(f,b){ot.ielt9?setTimeout(a(f,this,null,b),0):f(null,b)},_tileOnError:function(f,b,N){var A=this.options.errorTileUrl;A&&b.getAttribute("src")!==A&&(b.src=A),f(N,b)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,b=this.options.maxZoom,N=this.options.zoomReverse,A=this.options.zoomOffset;return N&&(f=b-f),f+A},_getSubdomain:function(f){var b=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var f,b;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(b=this._tiles[f].el,b.onload=p,b.onerror=p,!b.complete)){b.src=P;var N=this._tiles[f].coords;rn(b),delete this._tiles[f],this.fire("tileabort",{tile:b,coords:N})}},_removeTile:function(f){var b=this._tiles[f];if(b)return b.el.setAttribute("src",P),xc.prototype._removeTile.call(this,f)},_tileReady:function(f,b,N){if(!(!this._map||N&&N.getAttribute("src")===P))return xc.prototype._tileReady.call(this,f,b,N)}});function Ni(f,b){return new wc(f,b)}var Ii=wc.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,b){this._url=f;var N=r({},this.defaultWmsParams);for(var A in b)A in this.options||(N[A]=b[A]);b=w(this,b);var z=b.detectRetina&&ot.retina?2:1,X=this.getTileSize();N.width=X.x*z,N.height=X.y*z,this.wmsParams=N},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,wc.prototype.onAdd.call(this,f)},getTileUrl:function(f){var b=this._tileCoordsToNwSe(f),N=this._crs,A=pe(N.project(b[0]),N.project(b[1])),z=A.min,X=A.max,le=(this._wmsVersion>=1.3&&this._crs===wu?[z.y,z.x,X.y,X.x]:[z.x,z.y,X.x,X.y]).join(","),Ee=wc.prototype.getTileUrl.call(this,f);return Ee+T(this.wmsParams,Ee,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+le},setParams:function(f,b){return r(this.wmsParams,f),b||this.redraw(),this}});function ku(f,b){return new Ii(f,b)}wc.WMS=Ii,Ni.wms=ku;var va=pa.extend({options:{padding:.1},initialize:function(f){w(this,f),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),st(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,b){var N=this._map.getZoomScale(b,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),z=this._map.project(this._center,b),X=A.multiplyBy(-N).add(z).subtract(this._map._getNewPixelOrigin(f,b));ot.any3d?Xr(this._container,X,N):Zn(this._container,X)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,b=this._map.getSize(),N=this._map.containerPointToLayerPoint(b.multiplyBy(-f)).round();this._bounds=new ie(N,N.add(b.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ed=va.extend({options:{tolerance:0},getEvents:function(){var f=va.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){va.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");xt(f,"mousemove",this._onMouseMove,this),xt(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),xt(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){W(this._redrawRequest),delete this._ctx,rn(this._container),an(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var b in this._layers)f=this._layers[b],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){va.prototype._update.call(this);var f=this._bounds,b=this._container,N=f.getSize(),A=ot.retina?2:1;Zn(b,f.min),b.width=A*N.x,b.height=A*N.y,b.style.width=N.x+"px",b.style.height=N.y+"px",ot.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){va.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[l(f)]=f;var b=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=b),this._drawLast=b,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var b=f._order,N=b.next,A=b.prev;N?N.prev=A:this._drawLast=A,A?A.next=N:this._drawFirst=N,delete f._order,delete this._layers[l(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var b=f.options.dashArray.split(/[, ]+/),N=[],A,z;for(z=0;z<b.length;z++){if(A=Number(b[z]),isNaN(A))return;N.push(A)}f.options._dashArray=N}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||D(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var b=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ie,this._redrawBounds.extend(f._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(f._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var b=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,b.x,b.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,b=this._redrawBounds;if(this._ctx.save(),b){var N=b.getSize();this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,N.x,N.y),this._ctx.clip()}this._drawing=!0;for(var A=this._drawFirst;A;A=A.next)f=A.layer,(!b||f._pxBounds&&f._pxBounds.intersects(b))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,b){if(this._drawing){var N,A,z,X,le=f._parts,Ee=le.length,Oe=this._ctx;if(Ee){for(Oe.beginPath(),N=0;N<Ee;N++){for(A=0,z=le[N].length;A<z;A++)X=le[N][A],Oe[A?"lineTo":"moveTo"](X.x,X.y);b&&Oe.closePath()}this._fillStroke(Oe,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var b=f._point,N=this._ctx,A=Math.max(Math.round(f._radius),1),z=(Math.max(Math.round(f._radiusY),1)||A)/A;z!==1&&(N.save(),N.scale(1,z)),N.beginPath(),N.arc(b.x,b.y/z,A,0,Math.PI*2,!1),z!==1&&N.restore(),this._fillStroke(N,f)}},_fillStroke:function(f,b){var N=b.options;N.fill&&(f.globalAlpha=N.fillOpacity,f.fillStyle=N.fillColor||N.color,f.fill(N.fillRule||"evenodd")),N.stroke&&N.weight!==0&&(f.setLineDash&&f.setLineDash(b.options&&b.options._dashArray||[]),f.globalAlpha=N.opacity,f.lineWidth=N.weight,f.strokeStyle=N.color,f.lineCap=N.lineCap,f.lineJoin=N.lineJoin,f.stroke())},_onClick:function(f){for(var b=this._map.mouseEventToLayerPoint(f),N,A,z=this._drawFirst;z;z=z.next)N=z.layer,N.options.interactive&&N._containsPoint(b)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(N))&&(A=N);this._fireEvent(A?[A]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var b=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,b)}},_handleMouseOut:function(f){var b=this._hoveredLayer;b&&(Tn(this._container,"leaflet-interactive"),this._fireEvent([b],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,b){if(!this._mouseHoverThrottled){for(var N,A,z=this._drawFirst;z;z=z.next)N=z.layer,N.options.interactive&&N._containsPoint(b)&&(A=N);A!==this._hoveredLayer&&(this._handleMouseOut(f),A&&(st(this._container,"leaflet-interactive"),this._fireEvent([A],f,"mouseover"),this._hoveredLayer=A)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,b,N){this._map._fireDOMEvent(b,N||b.type,f)},_bringToFront:function(f){var b=f._order;if(b){var N=b.next,A=b.prev;if(N)N.prev=A;else return;A?A.next=N:N&&(this._drawFirst=N),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(f)}},_bringToBack:function(f){var b=f._order;if(b){var N=b.next,A=b.prev;if(A)A.next=N;else return;N?N.prev=A:A&&(this._drawLast=A),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(f)}}});function Nd(f){return ot.canvas?new Ed(f):null}var Tc=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),$u={_initContainer:function(){this._container=Jt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(va.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var b=f._container=Tc("shape");st(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",f._path=Tc("path"),b.appendChild(f._path),this._updateStyle(f),this._layers[l(f)]=f},_addPath:function(f){var b=f._container;this._container.appendChild(b),f.options.interactive&&f.addInteractiveTarget(b)},_removePath:function(f){var b=f._container;rn(b),f.removeInteractiveTarget(b),delete this._layers[l(f)]},_updateStyle:function(f){var b=f._stroke,N=f._fill,A=f.options,z=f._container;z.stroked=!!A.stroke,z.filled=!!A.fill,A.stroke?(b||(b=f._stroke=Tc("stroke")),z.appendChild(b),b.weight=A.weight+"px",b.color=A.color,b.opacity=A.opacity,A.dashArray?b.dashStyle=$(A.dashArray)?A.dashArray.join(" "):A.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=A.lineCap.replace("butt","flat"),b.joinstyle=A.lineJoin):b&&(z.removeChild(b),f._stroke=null),A.fill?(N||(N=f._fill=Tc("fill")),z.appendChild(N),N.color=A.fillColor||A.color,N.opacity=A.fillOpacity):N&&(z.removeChild(N),f._fill=null)},_updateCircle:function(f){var b=f._point.round(),N=Math.round(f._radius),A=Math.round(f._radiusY||N);this._setPath(f,f._empty()?"M0 0":"AL "+b.x+","+b.y+" "+N+","+A+" 0,"+65535*360)},_setPath:function(f,b){f._path.v=b},_bringToFront:function(f){yi(f._container)},_bringToBack:function(f){Ui(f._container)}},Id=ot.vml?Tc:un,hl=va.extend({_initContainer:function(){this._container=Id("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Id("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){rn(this._container),an(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){va.prototype._update.call(this);var f=this._bounds,b=f.getSize(),N=this._container;(!this._svgSize||!this._svgSize.equals(b))&&(this._svgSize=b,N.setAttribute("width",b.x),N.setAttribute("height",b.y)),Zn(N,f.min),N.setAttribute("viewBox",[f.min.x,f.min.y,b.x,b.y].join(" ")),this.fire("update")}},_initPath:function(f){var b=f._path=Id("path");f.options.className&&st(b,f.options.className),f.options.interactive&&st(b,"leaflet-interactive"),this._updateStyle(f),this._layers[l(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){rn(f._path),f.removeInteractiveTarget(f._path),delete this._layers[l(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var b=f._path,N=f.options;b&&(N.stroke?(b.setAttribute("stroke",N.color),b.setAttribute("stroke-opacity",N.opacity),b.setAttribute("stroke-width",N.weight),b.setAttribute("stroke-linecap",N.lineCap),b.setAttribute("stroke-linejoin",N.lineJoin),N.dashArray?b.setAttribute("stroke-dasharray",N.dashArray):b.removeAttribute("stroke-dasharray"),N.dashOffset?b.setAttribute("stroke-dashoffset",N.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),N.fill?(b.setAttribute("fill",N.fillColor||N.color),b.setAttribute("fill-opacity",N.fillOpacity),b.setAttribute("fill-rule",N.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(f,b){this._setPath(f,qt(f._parts,b))},_updateCircle:function(f){var b=f._point,N=Math.max(Math.round(f._radius),1),A=Math.max(Math.round(f._radiusY),1)||N,z="a"+N+","+A+" 0 1,0 ",X=f._empty()?"M0 0":"M"+(b.x-N)+","+b.y+z+N*2+",0 "+z+-N*2+",0 ";this._setPath(f,X)},_setPath:function(f,b){f._path.setAttribute("d",b)},_bringToFront:function(f){yi(f._path)},_bringToBack:function(f){Ui(f._path)}});ot.vml&&hl.include($u);function Sc(f){return ot.svg||ot.vml?new hl(f):null}Pt.include({getRenderer:function(f){var b=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this._createRenderer()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var b=this._paneRenderers[f];return b===void 0&&(b=this._createRenderer({pane:f}),this._paneRenderers[f]=b),b},_createRenderer:function(f){return this.options.preferCanvas&&Nd(f)||Sc(f)}});var v_=Nu.extend({initialize:function(f,b){Nu.prototype.initialize.call(this,this._boundsToLatLngs(f),b)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=Ne(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function Ci(f,b){return new v_(f,b)}hl.create=Id,hl.pointsToPath=qt,Ei.geometryToLayer=xd,Ei.coordsToLatLng=lp,Ei.coordsToLatLngs=wd,Ei.latLngToCoords=Td,Ei.latLngsToCoords=cp,Ei.getFeature=ma,Ei.asFeature=Iu,Pt.mergeOptions({boxZoom:!0});var fp=Yr.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){xt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){an(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){rn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),pr(),rl(),this._startPoint=this._map.mouseEventToContainerPoint(f),xt(document,{contextmenu:_i,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Jt("div","leaflet-zoom-box",this._container),st(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var b=new ie(this._point,this._startPoint),N=b.getSize();Zn(this._box,b.min),this._box.style.width=N.x+"px",this._box.style.height=N.y+"px"},_finish:function(){this._moved&&(rn(this._box),Tn(this._container,"leaflet-crosshair")),vi(),pu(),an(document,{contextmenu:_i,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var b=new fe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Pt.addInitHook("addHandler","boxZoom",fp),Pt.mergeOptions({doubleClickZoom:!0});var Ha=Yr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var b=this._map,N=b.getZoom(),A=b.options.zoomDelta,z=f.originalEvent.shiftKey?N-A:N+A;b.options.doubleClickZoom==="center"?b.setZoom(z):b.setZoomAround(f.containerPoint,z)}});Pt.addInitHook("addHandler","doubleClickZoom",Ha),Pt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var _g=Yr.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new ha(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}st(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Tn(this._map._container,"leaflet-grab"),Tn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=Ne(this._map.options.maxBounds);this._offsetLimit=pe(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var b=this._lastTime=+new Date,N=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(N),this._times.push(b),this._prunePositions(b)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,b){return f-(f-b)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;f.x<b.min.x&&(f.x=this._viscousLimit(f.x,b.min.x)),f.y<b.min.y&&(f.y=this._viscousLimit(f.y,b.min.y)),f.x>b.max.x&&(f.x=this._viscousLimit(f.x,b.max.x)),f.y>b.max.y&&(f.y=this._viscousLimit(f.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,b=Math.round(f/2),N=this._initialWorldOffset,A=this._draggable._newPos.x,z=(A-b+N)%f+b-N,X=(A+b+N)%f-b-N,le=Math.abs(z+N)<Math.abs(X+N)?z:X;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=le},_onDragEnd:function(f){var b=this._map,N=b.options,A=!N.inertia||f.noInertia||this._times.length<2;if(b.fire("dragend",f),A)b.fire("moveend");else{this._prunePositions(+new Date);var z=this._lastPos.subtract(this._positions[0]),X=(this._lastTime-this._times[0])/1e3,le=N.easeLinearity,Ee=z.multiplyBy(le/X),Oe=Ee.distanceTo([0,0]),Ge=Math.min(N.inertiaMaxSpeed,Oe),Je=Ee.multiplyBy(Ge/Oe),it=Ge/(N.inertiaDeceleration*le),ut=Je.multiplyBy(-it/2).round();!ut.x&&!ut.y?b.fire("moveend"):(ut=b._limitOffset(ut,b.options.maxBounds),D(function(){b.panBy(ut,{duration:it,easeLinearity:le,noMoveStart:!0,animate:!0})}))}}});Pt.addInitHook("addHandler","dragging",_g),Pt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Cd=Yr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),xt(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),an(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,b=document.documentElement,N=f.scrollTop||b.scrollTop,A=f.scrollLeft||b.scrollLeft;this._map._container.focus(),window.scrollTo(A,N)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var b=this._panKeys={},N=this.keyCodes,A,z;for(A=0,z=N.left.length;A<z;A++)b[N.left[A]]=[-1*f,0];for(A=0,z=N.right.length;A<z;A++)b[N.right[A]]=[f,0];for(A=0,z=N.down.length;A<z;A++)b[N.down[A]]=[0,f];for(A=0,z=N.up.length;A<z;A++)b[N.up[A]]=[0,-1*f]},_setZoomDelta:function(f){var b=this._zoomKeys={},N=this.keyCodes,A,z;for(A=0,z=N.zoomIn.length;A<z;A++)b[N.zoomIn[A]]=f;for(A=0,z=N.zoomOut.length;A<z;A++)b[N.zoomOut[A]]=-f},_addHooks:function(){xt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){an(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var b=f.keyCode,N=this._map,A;if(b in this._panKeys){if(!N._panAnim||!N._panAnim._inProgress)if(A=this._panKeys[b],f.shiftKey&&(A=K(A).multiplyBy(3)),N.options.maxBounds&&(A=N._limitOffset(K(A),N.options.maxBounds)),N.options.worldCopyJump){var z=N.wrapLatLng(N.unproject(N.project(N.getCenter()).add(A)));N.panTo(z)}else N.panBy(A)}else if(b in this._zoomKeys)N.setZoom(N.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[b]);else if(b===27&&N._popup&&N._popup.options.closeOnEscapeKey)N.closePopup();else return;_i(f)}}});Pt.addInitHook("addHandler","keyboard",Cd),Pt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var dl=Yr.extend({addHooks:function(){xt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){an(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var b=ll(f),N=this._map.options.wheelDebounceTime;this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var A=Math.max(N-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),A),_i(f)},_performZoom:function(){var f=this._map,b=f.getZoom(),N=this._map.options.zoomSnap||0;f._stop();var A=this._delta/(this._map.options.wheelPxPerZoomLevel*4),z=4*Math.log(2/(1+Math.exp(-Math.abs(A))))/Math.LN2,X=N?Math.ceil(z/N)*N:z,le=f._limitZoom(b+(this._delta>0?X:-X))-b;this._delta=0,this._startTime=null,le&&(f.options.scrollWheelZoom==="center"?f.setZoom(b+le):f.setZoomAround(this._lastMousePos,b+le))}});Pt.addInitHook("addHandler","scrollWheelZoom",dl);var xg=600;Pt.mergeOptions({tapHold:ot.touchNative&&ot.safari&&ot.mobile,tapTolerance:15});var pp=Yr.extend({addHooks:function(){xt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){an(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var b=f.touches[0];this._startPos=this._newPos=new ne(b.clientX,b.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(xt(document,"touchend",Yn),xt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",b))},this),xg),xt(document,"touchend touchcancel contextmenu",this._cancel,this),xt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){an(document,"touchend",Yn),an(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),an(document,"touchend touchcancel contextmenu",this._cancel,this),an(document,"touchmove",this._onMove,this)},_onMove:function(f){var b=f.touches[0];this._newPos=new ne(b.clientX,b.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,b){var N=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY});N._simulated=!0,b.target.dispatchEvent(N)}});Pt.addInitHook("addHandler","tapHold",pp),Pt.mergeOptions({touchZoom:ot.touch,bounceAtZoomLimits:!0});var Ec=Yr.extend({addHooks:function(){st(this._map._container,"leaflet-touch-zoom"),xt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Tn(this._map._container,"leaflet-touch-zoom"),an(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var b=this._map;if(!(!f.touches||f.touches.length!==2||b._animatingZoom||this._zooming)){var N=b.mouseEventToContainerPoint(f.touches[0]),A=b.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),b.options.touchZoom!=="center"&&(this._pinchStartLatLng=b.containerPointToLatLng(N.add(A)._divideBy(2))),this._startDist=N.distanceTo(A),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),xt(document,"touchmove",this._onTouchMove,this),xt(document,"touchend touchcancel",this._onTouchEnd,this),Yn(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var b=this._map,N=b.mouseEventToContainerPoint(f.touches[0]),A=b.mouseEventToContainerPoint(f.touches[1]),z=N.distanceTo(A)/this._startDist;if(this._zoom=b.getScaleZoom(z,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&z<1||this._zoom>b.getMaxZoom()&&z>1)&&(this._zoom=b._limitZoom(this._zoom)),b.options.touchZoom==="center"){if(this._center=this._startLatLng,z===1)return}else{var X=N._add(A)._divideBy(2)._subtract(this._centerPoint);if(z===1&&X.x===0&&X.y===0)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(X),this._zoom)}this._moved||(b._moveStart(!0,!1),this._moved=!0),W(this._animRequest);var le=a(b._move,b,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=D(le,this,!0),Yn(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,W(this._animRequest),an(document,"touchmove",this._onTouchMove,this),an(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Pt.addInitHook("addHandler","touchZoom",Ec),Pt.BoxZoom=fp,Pt.DoubleClickZoom=Ha,Pt.Drag=_g,Pt.Keyboard=Cd,Pt.ScrollWheelZoom=dl,Pt.TapHold=pp,Pt.TouchZoom=Ec,t.Bounds=ie,t.Browser=ot,t.CRS=He,t.Canvas=Ed,t.Circle=yg,t.CircleMarker=_d,t.Class=ae,t.Control=nr,t.DivIcon=bg,t.DivOverlay=ga,t.DomEvent=gc,t.DomUtil=np,t.Draggable=ha,t.Evented=re,t.FeatureGroup=Ti,t.GeoJSON=Ei,t.GridLayer=xc,t.Handler=Yr,t.Icon=Tu,t.ImageOverlay=Wa,t.LatLng=Te,t.LatLngBounds=fe,t.Layer=pa,t.LayerGroup=bc,t.LineUtil=xi,t.Map=Pt,t.Marker=Eu,t.Mixin=ip,t.Path=Io,t.Point=ne,t.PolyUtil=_u,t.Polygon=Nu,t.Polyline=Co,t.Popup=Sd,t.PosAnimation=yc,t.Projection=da,t.Rectangle=v_,t.Renderer=va,t.SVG=hl,t.SVGOverlay=ul,t.TileLayer=wc,t.Tooltip=dp,t.Transformation=vt,t.Util=H,t.VideoOverlay=hp,t.bind=a,t.bounds=pe,t.canvas=Nd,t.circle=KT,t.circleMarker=f_,t.control=ua,t.divIcon=y_,t.extend=r,t.featureGroup=bd,t.geoJSON=up,t.geoJson=p_,t.gridLayer=ya,t.icon=op,t.imageOverlay=Cu,t.latLng=Se,t.latLngBounds=Ne,t.layerGroup=d_,t.map=Ua,t.marker=gg,t.point=K,t.polygon=Si,t.polyline=XT,t.popup=ZT,t.rectangle=Ci,t.setOptions=w,t.stamp=l,t.svg=Sc,t.svgOverlay=g_,t.tileLayer=Ni,t.tooltip=YT,t.transformation=Lt,t.version=s,t.videoOverlay=m_;var Au=window.L;t.noConflict=function(){return window.L=Au,this},window.L=t}))})(yy,yy.exports)),yy.exports}var Jie=Qie();const vl=yC(Jie);(function(n,e,t){function s(r,i){for(;(r=r.parentElement)&&!r.classList.contains(i););return r}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(r,i){this._map=r,this._container=r._container,this._overlayPane=r._panes.overlayPane,this._popupPane=r._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var r=this._map;r&&(L.DomUtil.disableTextSelection(),r.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(r){L.setOptions(this,r)},_fireCreatedEvent:function(r){this._map.fire(L.Draw.Event.CREATED,{layer:r,layerType:this.type})},_cancelDrawing:function(r){r.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(r,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,r,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var r=this._markers.pop(),i=this._poly,a=i.getLatLngs(),o=a.splice(-1,1)[0];this._poly.setLatLngs(a),this._markerGroup.removeLayer(r),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(o,!1)}},addVertex:function(r){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(r))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(r)),this._poly.addLatLng(r),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(r,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var r=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(r[r.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(r){var i=this._map.mouseEventToLayerPoint(r.originalEvent),a=this._map.layerPointToLatLng(i);this._currentLatLng=a,this._updateTooltip(a),this._updateGuide(i),this._mouseMarker.setLatLng(a),L.DomEvent.preventDefault(r.originalEvent)},_vertexChanged:function(r,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(r,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(r){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(r),this._clickHandled=!0,this._disableNewMarkers();var i=r.originalEvent,a=i.clientX,o=i.clientY;this._startPoint.call(this,a,o)}},_startPoint:function(r,i){this._mouseDownOrigin=L.point(r,i)},_onMouseUp:function(r){var i=r.originalEvent,a=i.clientX,o=i.clientY;this._endPoint.call(this,a,o,r),this._clickHandled=null},_endPoint:function(r,i,a){if(this._mouseDownOrigin){var o=L.point(r,i).distanceTo(this._mouseDownOrigin),l=this._calculateFinishDistance(a.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(a.latlng),this._finishShape()):l<10&&L.Browser.touch?this._finishShape():Math.abs(o)<9*(n.devicePixelRatio||1)&&this.addVertex(a.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(r){var i,a,o=r.originalEvent;!o.touches||!o.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=o.touches[0].clientX,a=o.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,a),this._endPoint.call(this,i,a,r),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(r){var i;if(this._markers.length>0){var a;if(this.type===L.Draw.Polyline.TYPE)a=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;a=this._markers[0]}var o=this._map.latLngToContainerPoint(a.getLatLng()),l=new L.Marker(r,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),c=this._map.latLngToContainerPoint(l.getLatLng());i=o.distanceTo(c)}else i=1/0;return i},_updateFinishHandler:function(){var r=this._markers.length;r>1&&this._markers[r-1].on("click",this._finishShape,this),r>2&&this._markers[r-2].off("click",this._finishShape,this)},_createMarker:function(r){var i=new L.Marker(r,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(r){var i=this._markers?this._markers.length:0;i>0&&(r=r||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),r))},_updateTooltip:function(r){var i=this._getTooltipText();r&&this._tooltip.updatePosition(r),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(r,i){var a,o,l,c=Math.floor(Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2))),h=this.options.guidelineDistance,p=this.options.maxGuideLineLength,m=c>p?c-p:h;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));m<c;m+=this.options.guidelineDistance)a=m/c,o={x:Math.floor(r.x*(1-a)+a*i.x),y:Math.floor(r.y*(1-a)+a*i.y)},l=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),l.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(l,o)},_updateGuideColor:function(r){if(this._guidesContainer)for(var i=0,a=this._guidesContainer.childNodes.length;i<a;i++)this._guidesContainer.childNodes[i].style.backgroundColor=r},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var r,i,a=this.options.showLength;return this._markers.length===0?r={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=a?this._getMeasurementString():"",r=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),r},_updateRunningMeasure:function(r,i){var a,o,l=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(a=l-(i?2:1),o=L.GeometryUtil.isVersion07x()?r.distanceTo(this._markers[a].getLatLng())*(this.options.factor||1):this._map.distance(r,this._markers[a].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=o*(i?1:-1))},_getMeasurementString:function(){var r,i=this._currentLatLng,a=this._markers[this._markers.length-1].getLatLng();return r=L.GeometryUtil.isVersion07x()?a&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(a)*(this.options.factor||1):this._measurementRunningTotal||0:a&&i?this._measurementRunningTotal+this._map.distance(i,a)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(r,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var r=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,r)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(r,i){L.Draw.Polyline.prototype.initialize.call(this,r,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var r=this._markers.length;r===1&&this._markers[0].on("click",this._finishShape,this),r>2&&(this._markers[r-1].on("dblclick",this._finishShape,this),r>3&&this._markers[r-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var r,i;return this._markers.length===0?r=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(r=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(r=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:r,subtext:i}},_getMeasurementString:function(){var r=this._area,i="";return r||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),r&&(i+="<br>"+L.GeometryUtil.readableArea(r,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(r,i){var a;!this.options.allowIntersection&&this.options.showArea&&(a=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(a)),L.Draw.Polyline.prototype._vertexChanged.call(this,r,i)},_cleanUpShape:function(){var r=this._markers.length;r>0&&(this._markers[0].off("click",this._finishShape,this),r>2&&this._markers[r-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(r,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,r,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),e.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),e.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(r){this._isDrawing=!0,this._startLatLng=r.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(r.originalEvent)},_onMouseMove:function(r){var i=r.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(r,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,r,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(r){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!s(r.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(r){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,r)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,r),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var r=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,r)},_getTooltipText:function(){var r,i,a,o=L.Draw.SimpleShape.prototype._getTooltipText.call(this),l=this._shape,c=this.options.showArea;return l&&(r=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(r),a=c?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:o.text,subtext:a}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(r,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,r,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(r){var i=r.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(r){return new L.Marker(r,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(r){this._onMouseMove(r),this._onClick()},_fireCreatedEvent:function(){var r=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,r)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(r,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,r,i)},_fireCreatedEvent:function(){var r=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,r)},_createMarker:function(r){return new L.CircleMarker(r,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(r,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,r,i)},_drawShape:function(r){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(r);else var i=this._map.distance(this._startLatLng,r);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var r=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,r)},_onMouseMove:function(r){var i,a=r.latlng,o=this.options.showRadius,l=this.options.metric;if(this._tooltip.updatePosition(a),this._isDrawing){this._drawShape(a),i=this._shape.getRadius().toFixed(1);var c="";o&&(c=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,l,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:c})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(r,i){this._marker=r,L.setOptions(this,i)},addHooks:function(){var r=this._marker;r.dragging.enable(),r.on("dragend",this._onDragEnd,r),this._toggleMarkerHighlight()},removeHooks:function(){var r=this._marker;r.dragging.disable(),r.off("dragend",this._onDragEnd,r),this._toggleMarkerHighlight()},_onDragEnd:function(r){var i=r.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var r=this._marker._icon;r&&(r.style.display="none",L.DomUtil.hasClass(r,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(r,"leaflet-edit-marker-selected"),this._offsetMarker(r,-4)):(L.DomUtil.addClass(r,"leaflet-edit-marker-selected"),this._offsetMarker(r,4)),r.style.display="")},_offsetMarker:function(r,i){var a=parseInt(r.style.marginTop,10)-i,o=parseInt(r.style.marginLeft,10)-i;r.style.marginTop=a+"px",r.style.marginLeft=o+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(r){this.latlngs=[r._latlngs],r._holes&&(this.latlngs=this.latlngs.concat(r._holes)),this._poly=r,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(r){for(var i=0;i<this._verticesHandlers.length;i++)r(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(r){r.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(r){r.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(r){r.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var r=0;r<this.latlngs.length;r++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[r],this._poly.options.poly))},_updateLatLngs:function(r){this.latlngs=[r.layer._latlngs],r.layer._holes&&(this.latlngs=this.latlngs.concat(r.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(r,i,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=r,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this._latlngs=i,L.setOptions(this,a)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var r=this._poly,i=r._path;r instanceof L.Polygon||(r.options.fill=!1,r.options.editing&&(r.options.editing.fill=!1)),i&&r.options.editing&&r.options.editing.className&&(r.options.original.className&&r.options.original.className.split(" ").forEach(function(a){L.DomUtil.removeClass(i,a)}),r.options.editing.className.split(" ").forEach(function(a){L.DomUtil.addClass(i,a)})),r.setStyle(r.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var r=this._poly,i=r._path;i&&r.options.editing&&r.options.editing.className&&(r.options.editing.className.split(" ").forEach(function(a){L.DomUtil.removeClass(i,a)}),r.options.original.className&&r.options.original.className.split(" ").forEach(function(a){L.DomUtil.addClass(i,a)})),r.setStyle(r.options.original),r._map&&(r._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var r,i,a,o,l=this._defaultShape();for(r=0,a=l.length;r<a;r++)o=this._createMarker(l[r],r),o.on("click",this._onMarkerClick,this),o.on("contextmenu",this._onContextMenu,this),this._markers.push(o);var c,h;for(r=0,i=a-1;r<a;i=r++)(r!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(c=this._markers[i],h=this._markers[r],this._createMiddleMarker(c,h),this._updatePrevNext(c,h))},_createMarker:function(r,i){var a=new L.Marker.Touch(r,{draggable:!0,icon:this.options.icon});return a._origLatLng=r,a._index=i,a.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(a),a},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var r=this._defaultShape(),i=[].splice.apply(r,arguments);return this._poly._convertLatLngs(r,!0),this._poly.redraw(),i},_removeMarker:function(r){var i=r._index;this._markerGroup.removeLayer(r),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),r.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(r){var i=r.target,a=this._poly,o=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),a.options.poly){var l=a._map._editTooltip;if(!a.options.poly.allowIntersection&&a.intersects()){L.extend(i._origLatLng,o),i.setLatLng(o);var c=a.options.color;a.setStyle({color:this.options.drawError.color}),l&&l.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){a.setStyle({color:c}),l&&l.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var h=this._poly.getLatLngs();this._poly._convertLatLngs(h,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(r){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,a=r.target;this._defaultShape().length<i||(this._removeMarker(a),this._updatePrevNext(a._prev,a._next),a._middleLeft&&this._markerGroup.removeLayer(a._middleLeft),a._middleRight&&this._markerGroup.removeLayer(a._middleRight),a._prev&&a._next?this._createMiddleMarker(a._prev,a._next):a._prev?a._next||(a._prev._middleRight=null):a._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(r){var i=r.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(r){var i=this._map.mouseEventToLayerPoint(r.originalEvent.touches[0]),a=this._map.layerPointToLatLng(i),o=r.target;L.extend(o._origLatLng,a),o._middleLeft&&o._middleLeft.setLatLng(this._getMiddleLatLng(o._prev,o)),o._middleRight&&o._middleRight.setLatLng(this._getMiddleLatLng(o,o._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(r,i){this._markerGroup.eachLayer(function(a){a._index>r&&(a._index+=i)})},_createMiddleMarker:function(r,i){var a,o,l,c=this._getMiddleLatLng(r,i),h=this._createMarker(c);h.setOpacity(.6),r._middleRight=i._middleLeft=h,o=function(){h.off("touchmove",o,this);var p=i._index;h._index=p,h.off("click",a,this).on("click",this._onMarkerClick,this),c.lat=h.getLatLng().lat,c.lng=h.getLatLng().lng,this._spliceLatLngs(p,0,c),this._markers.splice(p,0,h),h.setOpacity(1),this._updateIndexes(p,1),i._index++,this._updatePrevNext(r,h),this._updatePrevNext(h,i),this._poly.fire("editstart")},l=function(){h.off("dragstart",o,this),h.off("dragend",l,this),h.off("touchmove",o,this),this._createMiddleMarker(r,h),this._createMiddleMarker(h,i)},a=function(){o.call(this),l.call(this),this._fireEdit()},h.on("click",a,this).on("dragstart",o,this).on("dragend",l,this).on("touchmove",o,this),this._markerGroup.addLayer(h)},_updatePrevNext:function(r,i){r&&(r._next=i),i&&(i._prev=r)},_getMiddleLatLng:function(r,i){var a=this._poly._map,o=a.project(r.getLatLng()),l=a.project(i.getLatLng());return a.unproject(o._add(l)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(r,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=r,L.Util.setOptions(this,i)},addHooks:function(){var r=this._shape;this._shape._map&&(this._map=this._shape._map,r.setStyle(r.options.editing),r._map&&(this._map=r._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var r=this._shape;if(r.setStyle(r.options.original),r._map){this._unbindMarker(this._moveMarker);for(var i=0,a=this._resizeMarkers.length;i<a;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(r,i){var a=new L.Marker.Touch(r,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(a),this._markerGroup.addLayer(a),a},_bindMarker:function(r){r.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(r){r.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(r){r.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(r){var i=r.target,a=i.getLatLng();i===this._moveMarker?this._move(a):this._resize(a),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(r){r.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(r){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,r),typeof this._getCorners=="function"){var i=this._getCorners(),a=r.target,o=a._cornerIndex;a.setOpacity(0),this._oppositeCorner=i[(o+2)%4],this._toggleCornerMarkers(0,o)}this._shape.fire("editstart")},_onTouchMove:function(r){var i=this._map.mouseEventToLayerPoint(r.originalEvent.touches[0]),a=this._map.layerPointToLatLng(i);return r.target===this._moveMarker?this._move(a):this._resize(a),this._shape.redraw(),!1},_onTouchEnd:function(r){r.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var r=this._shape.getBounds(),i=r.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var r=this._getCorners();this._resizeMarkers=[];for(var i=0,a=r.length;i<a;i++)this._resizeMarkers.push(this._createMarker(r[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(r){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,r);var i=this._getCorners(),a=r.target,o=a._cornerIndex;this._oppositeCorner=i[(o+2)%4],this._toggleCornerMarkers(0,o)},_onMarkerDragEnd:function(r){var i,a,o=r.target;o===this._moveMarker&&(i=this._shape.getBounds(),a=i.getCenter(),o.setLatLng(a)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,r)},_move:function(r){for(var i,a=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),o=this._shape.getBounds(),l=o.getCenter(),c=[],h=0,p=a.length;h<p;h++)i=[a[h].lat-l.lat,a[h].lng-l.lng],c.push([r.lat+i[0],r.lng+i[1]]);this._shape.setLatLngs(c),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(r){var i;this._shape.setBounds(L.latLngBounds(r,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var r=this._shape.getBounds();return[r.getNorthWest(),r.getNorthEast(),r.getSouthEast(),r.getSouthWest()]},_toggleCornerMarkers:function(r){for(var i=0,a=this._resizeMarkers.length;i<a;i++)this._resizeMarkers[i].setOpacity(r)},_repositionCornerMarkers:function(){for(var r=this._getCorners(),i=0,a=this._resizeMarkers.length;i<a;i++)this._resizeMarkers[i].setLatLng(r[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var r=this._shape.getLatLng();this._moveMarker=this._createMarker(r,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(r){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(r);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(r),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var r=this._shape.getLatLng(),i=this._getResizeMarkerPoint(r);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(r){var i=this._shape._radius*Math.cos(Math.PI/4),a=this._map.project(r);return this._map.unproject([a.x+i,a.y-i])},_resize:function(r){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(r):radius=this._map.distance(i,r),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(r,i){var a={};if(r.touches!==void 0){if(!r.touches.length)return;a=r.touches[0]}else if(r.pointerType!=="touch"||(a=r,!this._filterClick(r)))return;var o=this._map.mouseEventToContainerPoint(a),l=this._map.mouseEventToLayerPoint(a),c=this._map.layerPointToLatLng(l);this._map.fire(i,{latlng:c,layerPoint:l,containerPoint:o,pageX:a.pageX,pageY:a.pageY,originalEvent:r})},_filterClick:function(r){var i=r.timeStamp||r.originalEvent.timeStamp,a=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return a&&a>100&&a<500||r.target._simulatedClick&&!r._simulated?(L.DomEvent.stop(r),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(r){this._map._loaded&&this._touchEvent(r,"touchstart")},_onTouchEnd:function(r){this._map._loaded&&this._touchEvent(r,"touchend")},_onTouchCancel:function(r){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(r,i)}},_onTouchLeave:function(r){this._map._loaded&&this._touchEvent(r,"touchleave")},_onTouchMove:function(r){this._map._loaded&&this._touchEvent(r,"touchmove")},_detectIE:function(){var r=n.navigator.userAgent,i=r.indexOf("MSIE ");if(i>0)return parseInt(r.substring(i+5,r.indexOf(".",i)),10);if(r.indexOf("Trident/")>0){var a=r.indexOf("rv:");return parseInt(r.substring(a+3,r.indexOf(".",a)),10)}var o=r.indexOf("Edge/");return o>0&&parseInt(r.substring(o+5,r.indexOf(".",o)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var r=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(r,"leaflet-clickable"),L.DomEvent.on(r,"click",this._onMouseClick,this),L.DomEvent.on(r,"keypress",this._onKeyPress,this);for(var a=0;a<i.length;a++)L.DomEvent.on(r,i[a],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var r=n.navigator.userAgent,i=r.indexOf("MSIE ");if(i>0)return parseInt(r.substring(i+5,r.indexOf(".",i)),10);if(r.indexOf("Trident/")>0){var a=r.indexOf("rv:");return parseInt(r.substring(a+3,r.indexOf(".",a)),10)}var o=r.indexOf("Edge/");return o>0&&parseInt(r.substring(o+5,r.indexOf(".",o)),10)}}),L.LatLngUtil={cloneLatLngs:function(r){for(var i=[],a=0,o=r.length;a<o;a++)Array.isArray(r[a])?i.push(L.LatLngUtil.cloneLatLngs(r[a])):i.push(this.cloneLatLng(r[a]));return i},cloneLatLng:function(r){return L.latLng(r.lat,r.lng)}},(function(){var r={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var a,o,l=i.length,c=0,h=Math.PI/180;if(l>2){for(var p=0;p<l;p++)a=i[p],o=i[(p+1)%l],c+=(o.lng-a.lng)*h*(2+Math.sin(a.lat*h)+Math.sin(o.lat*h));c=6378137*c*6378137/2}return Math.abs(c)},formattedNumber:function(i,a){var o=parseFloat(i).toFixed(a),l=L.drawLocal.format&&L.drawLocal.format.numeric,c=l&&l.delimiters,h=c&&c.thousands,p=c&&c.decimal;if(h||p){var m=o.split(".");o=h?m[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+h):m[0],p=p||".",m.length>1&&(o=o+p+m[1])}return o},readableArea:function(i,a,h){var l,c,h=L.Util.extend({},r,h);return a?(c=["ha","m"],type=typeof a,type==="string"?c=[a]:type!=="boolean"&&(c=a),l=i>=1e6&&c.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,h.km)+" km":i>=1e4&&c.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,h.ha)+" ha":L.GeometryUtil.formattedNumber(i,h.m)+" m"):(i/=.836127,l=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,h.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,h.ac)+" acres":L.GeometryUtil.formattedNumber(i,h.yd)+" yd"),l},readableDistance:function(i,a,o,l,p){var h,p=L.Util.extend({},r,p);switch(a?typeof a=="string"?a:"metric":o?"feet":l?"nauticalMile":"yards"){case"metric":h=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,p.km)+" km":L.GeometryUtil.formattedNumber(i,p.m)+" m";break;case"feet":i*=3.28083,h=L.GeometryUtil.formattedNumber(i,p.ft)+" ft";break;case"nauticalMile":i*=.53996,h=L.GeometryUtil.formattedNumber(i/1e3,p.nm)+" nm";break;case"yards":default:i*=1.09361,h=i>1760?L.GeometryUtil.formattedNumber(i/1760,p.mi)+" miles":L.GeometryUtil.formattedNumber(i,p.yd)+" yd"}return h},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(r,i,a,o){return this._checkCounterclockwise(r,a,o)!==this._checkCounterclockwise(i,a,o)&&this._checkCounterclockwise(r,i,a)!==this._checkCounterclockwise(r,i,o)},_checkCounterclockwise:function(r,i,a){return(a.y-r.y)*(i.x-r.x)>(i.y-r.y)*(a.x-r.x)}}),L.Polyline.include({intersects:function(){var r,i,a,o=this._getProjectedPoints(),l=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(r=l-1;r>=3;r--)if(i=o[r-1],a=o[r],this._lineSegmentsIntersectsRange(i,a,r-2))return!0;return!1},newLatLngIntersects:function(r,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(r),i)},newPointIntersects:function(r,i){var a=this._getProjectedPoints(),o=a?a.length:0,l=a?a[o-1]:null,c=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(l,r,c,i?1:0)},_tooFewPointsForIntersection:function(r){var i=this._getProjectedPoints(),a=i?i.length:0;return a+=r||0,!i||a<=3},_lineSegmentsIntersectsRange:function(r,i,a,o){var l,c,h=this._getProjectedPoints();o=o||0;for(var p=a;p>o;p--)if(l=h[p-1],c=h[p],L.LineUtil.segmentsIntersect(r,i,l,c))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var r=[],i=this._defaultShape(),a=0;a<i.length;a++)r.push(this._map.latLngToLayerPoint(i[a]));return r}}),L.Polygon.include({intersects:function(){var r,i,a,o,l=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(r=l.length,i=l[0],a=l[r-1],o=r-2,this._lineSegmentsIntersectsRange(a,i,o,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(r){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,r);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(r){var i,a=L.DomUtil.create("div","leaflet-draw"),o=!1;for(var l in this._toolbars)this._toolbars.hasOwnProperty(l)&&(i=this._toolbars[l].addToolbar(r))&&(o||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),o=!0),a.appendChild(i));return a},onRemove:function(){for(var r in this._toolbars)this._toolbars.hasOwnProperty(r)&&this._toolbars[r].removeToolbar()},setDrawingOptions:function(r){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(r)},_toolbarEnabled:function(r){var i=r.target;for(var a in this._toolbars)this._toolbars[a]!==i&&this._toolbars[a].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(r){L.setOptions(this,r),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(r){var i,a=L.DomUtil.create("div","leaflet-draw-section"),o=0,l=this._toolbarClass||"",c=this.getModeHandlers(r);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=r,i=0;i<c.length;i++)c[i].enabled&&this._initModeHandler(c[i].handler,this._toolbarContainer,o++,l,c[i].title);if(o)return this._lastButtonIndex=--o,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),a.appendChild(this._toolbarContainer),a.appendChild(this._actionsContainer),a},removeToolbar:function(){for(var r in this._modes)this._modes.hasOwnProperty(r)&&(this._disposeButton(this._modes[r].button,this._modes[r].handler.enable,this._modes[r].handler),this._modes[r].handler.disable(),this._modes[r].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,a=this._actionButtons.length;i<a;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(r,i,a,o,l){var c=r.type;this._modes[c]={},this._modes[c].handler=r,this._modes[c].button=this._createButton({type:c,title:l,className:o+"-"+c,container:i,callback:this._modes[c].handler.enable,context:this._modes[c].handler}),this._modes[c].buttonIndex=a,this._modes[c].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!n.MSStream},_createButton:function(r){var i=L.DomUtil.create("a",r.className||"",r.container),a=L.DomUtil.create("span","sr-only",r.container);i.href="#",i.appendChild(a),r.title&&(i.title=r.title,a.innerHTML=r.title),r.text&&(i.innerHTML=r.text,a.innerHTML=r.text);var o=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,o,r.callback,r.context),i},_disposeButton:function(r,i){var a=this._detectIOS()?"touchstart":"click";L.DomEvent.off(r,"click",L.DomEvent.stopPropagation).off(r,"mousedown",L.DomEvent.stopPropagation).off(r,"dblclick",L.DomEvent.stopPropagation).off(r,"touchstart",L.DomEvent.stopPropagation).off(r,"click",L.DomEvent.preventDefault).off(r,a,i)},_handlerActivated:function(r){this.disable(),this._activeMode=this._modes[r.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(r){var i,a,o,l,c=this._actionsContainer,h=this.getActions(r),p=h.length;for(a=0,o=this._actionButtons.length;a<o;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback);for(this._actionButtons=[];c.firstChild;)c.removeChild(c.firstChild);for(var m=0;m<p;m++)"enabled"in h[m]&&!h[m].enabled||(i=L.DomUtil.create("li","",c),l=this._createButton({title:h[m].title,text:h[m].text,container:i,callback:h[m].callback,context:h[m].context}),this._actionButtons.push({button:l,callback:h[m].callback}))},_showActionsToolbar:function(){var r=this._activeMode.buttonIndex,i=this._lastButtonIndex,a=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=a+"px",r===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),r===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(r){this._map=r,this._popupPane=r._panes.popupPane,this._visible=!1,this._container=r.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(r){return this._container?(r.subtext=r.subtext||"",r.subtext.length!==0||this._singleLineLabel?r.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(r.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+r.subtext+"</span><br />":"")+"<span>"+r.text+"</span>",r.text||r.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(r){var i=this._map.latLngToLayerPoint(r),a=this._container;return this._container&&(this._visible&&(a.style.visibility="inherit"),L.DomUtil.setPosition(a,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(r){for(var i in this.options)this.options.hasOwnProperty(i)&&r[i]&&(r[i]=L.extend({},this.options[i],r[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,r)},getModeHandlers:function(r){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(r,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(r,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(r,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(r,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(r,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(r,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(r){return[{enabled:r.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:r.completeShape,context:r},{enabled:r.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:r.deleteLastVertex,context:r},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(r){L.setOptions(this,r);for(var i in this._modes)this._modes.hasOwnProperty(i)&&r.hasOwnProperty(i)&&this._modes[i].handler.setOptions(r[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(r){r.edit&&(r.edit.selectedPathOptions===void 0&&(r.edit.selectedPathOptions=this.options.edit.selectedPathOptions),r.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,r.edit.selectedPathOptions)),r.remove&&(r.remove=L.extend({},this.options.remove,r.remove)),r.poly&&(r.poly=L.extend({},this.options.poly,r.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,r),this._selectedFeatureCount=0},getModeHandlers:function(r){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(r,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(r,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(r){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return r.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(r){var i=L.Toolbar.prototype.addToolbar.call(this,r);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var r,i=this.options.featureGroup,a=i.getLayers().length!==0;this.options.edit&&(r=this._modes[L.EditToolbar.Edit.TYPE].button,a?L.DomUtil.removeClass(r,"leaflet-disabled"):L.DomUtil.addClass(r,"leaflet-disabled"),r.setAttribute("title",a?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(r=this._modes[L.EditToolbar.Delete.TYPE].button,a?L.DomUtil.removeClass(r,"leaflet-disabled"):L.DomUtil.addClass(r,"leaflet-disabled"),r.setAttribute("title",a?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(r,i){if(L.Handler.prototype.initialize.call(this,r),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var r=this._map;r&&(r.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),r._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(r){this._revertLayer(r)},this)},save:function(){var r=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(r.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:r})},_backupLayer:function(r){var i=L.Util.stamp(r);this._uneditedLayerProps[i]||(r instanceof L.Polyline||r instanceof L.Polygon||r instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(r.getLatLngs())}:r instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(r.getLatLng()),radius:r.getRadius()}:(r instanceof L.Marker||r instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(r.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(r){var i=L.Util.stamp(r);r.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(r instanceof L.Polyline||r instanceof L.Polygon||r instanceof L.Rectangle?r.setLatLngs(this._uneditedLayerProps[i].latlngs):r instanceof L.Circle?(r.setLatLng(this._uneditedLayerProps[i].latlng),r.setRadius(this._uneditedLayerProps[i].radius)):(r instanceof L.Marker||r instanceof L.CircleMarker)&&r.setLatLng(this._uneditedLayerProps[i].latlng),r.fire("revert-edited",{layer:r}))},_enableLayerEdit:function(r){var i,a,o=r.layer||r.target||r;this._backupLayer(o),this.options.poly&&(a=L.Util.extend({},this.options.poly),o.options.poly=a),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=o.options.color,i.fillColor=o.options.fillColor),o.options.original=L.extend({},o.options),o.options.editing=i),o instanceof L.Marker?(o.editing&&o.editing.enable(),o.dragging.enable(),o.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):o.editing.enable()},_disableLayerEdit:function(r){var i=r.layer||r.target||r;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(r){this._tooltip.updatePosition(r.latlng)},_onMarkerDragEnd:function(r){var i=r.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(r){var i=r.originalEvent.changedTouches[0],a=this._map.mouseEventToLayerPoint(i),o=this._map.layerPointToLatLng(a);r.target.setLatLng(o)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(r,i){if(L.Handler.prototype.initialize.call(this,r),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var r=this._map;r&&(r.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(r){this._deletableLayers.addLayer(r),r.fire("revert-deleted",{layer:r})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(r){this._removeLayer({layer:r})},this),this.save()},_enableLayerDelete:function(r){(r.layer||r.target||r).on("click",this._removeLayer,this)},_disableLayerDelete:function(r){var i=r.layer||r.target||r;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(r){var i=r.layer||r.target||r;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(r){this._tooltip.updatePosition(r.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);var rM=63710088e-1;function eae(n,e){var t,s,r,i,a,o,l,c,h,p,m=0,v=n.type==="FeatureCollection",x=n.type==="Feature",w=v?n.features.length:1;for(t=0;t<w;t++){for(o=v?n.features[t].geometry:x?n.geometry:n,c=v?n.features[t].properties:x?n.properties:{},h=v?n.features[t].bbox:x?n.bbox:void 0,p=v?n.features[t].id:x?n.id:void 0,l=o?o.type==="GeometryCollection":!1,a=l?o.geometries.length:1,r=0;r<a;r++){if(i=l?o.geometries[r]:o,i===null){if(e(null,m,c,h,p)===!1)return!1;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(i,m,c,h,p)===!1)return!1;break}case"GeometryCollection":{for(s=0;s<i.geometries.length;s++)if(e(i.geometries[s],m,c,h,p)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}m++}}function tae(n,e,t){var s=t;return eae(n,function(r,i,a,o,l){i===0&&t===void 0?s=r:s=e(s,r,i,a,o,l)}),s}function nae(n){return tae(n,(e,t)=>e+sae(t),0)}function sae(n){let e=0,t;switch(n.type){case"Polygon":return iM(n.coordinates);case"MultiPolygon":for(t=0;t<n.coordinates.length;t++)e+=iM(n.coordinates[t]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function iM(n){let e=0;if(n&&n.length>0){e+=Math.abs(aM(n[0]));for(let t=1;t<n.length;t++)e-=Math.abs(aM(n[t]))}return e}var rae=rM*rM/2,qE=Math.PI/180;function aM(n){const e=n.length-1;if(e<=2)return 0;let t=0,s=0;for(;s<e;){const r=n[s],i=n[s+1===e?0:s+1],a=n[s+2>=e?(s+2)%e:s+2],o=r[0]*qE,l=i[1]*qE,c=a[0]*qE;t+=(c-o)*Math.sin(l),s++}return t*rae}var iae="2.0.3",aae=[].slice,oae={};function eI(n){if(!(n>=1))throw new Error;this._size=n,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}eI.prototype=kB.prototype={constructor:eI,defer:function(n){if(typeof n!="function"||this._call)throw new Error;if(this._error!=null)return this;var e=aae.call(arguments,1);return e.push(n),++this._waiting,this._tasks.push(e),CB(this),this},abort:function(){return this._error==null&&Ek(this,new Error("abort")),this},await:function(n){if(typeof n!="function"||this._call)throw new Error;return this._call=function(e,t){n.apply(null,[e].concat(t))},L0(this),this},awaitAll:function(n){if(typeof n!="function"||this._call)throw new Error;return this._call=n,L0(this),this}};function CB(n){if(!n._start)try{lae(n)}catch(e){n._tasks[n._ended+n._active-1]&&Ek(n,e)}}function lae(n){for(;n._start=n._waiting&&n._active<n._size;){var e=n._ended+n._active,t=n._tasks[e],s=t.length-1,r=t[s];t[s]=cae(n,e),--n._waiting,++n._active,t=r.apply(null,t),n._tasks[e]&&(n._tasks[e]=t||oae)}}function cae(n,e){return function(t,s){n._tasks[e]&&(--n._active,++n._ended,n._tasks[e]=null,n._error==null&&(t!=null?Ek(n,t):(n._data[e]=s,n._waiting?CB(n):L0(n))))}}function Ek(n,e){var t=n._tasks.length,s;for(n._error=e,n._data=void 0,n._waiting=NaN;--t>=0;)if((s=n._tasks[t])&&(n._tasks[t]=null,s.abort))try{s.abort()}catch{}n._active=NaN,L0(n)}function L0(n){!n._active&&n._call&&n._call(n._error,n._data)}function kB(n){return new eI(arguments.length?+n:1/0)}const uae=Object.freeze(Object.defineProperty({__proto__:null,queue:kB,version:iae},Symbol.toStringTag,{value:"Module"})),hae=yF(uae);var KE,oM;function dae(){if(oM)return KE;oM=1;var n=hae.queue,e=+new Date;return KE=function(s,r){var i=!!L.mapbox,a=s.getSize(),o=new n(1),l=document.createElement("canvas");l.width=a.x,l.height=a.y;var c=l.getContext("2d"),h=document.createElement("canvas");h.width=1,h.height=1;var p=h.getContext("2d");if(p.fillStyle="rgba(0,0,0,0)",p.fillRect(0,0,1,1),s.eachLayer(v),s.eachLayer(w),s._pathRoot)o.defer($,s._pathRoot);else if(s._panes){var m=s._panes.overlayPane.getElementsByTagName("canvas").item(0);m&&o.defer($,m)}s.eachLayer(x),o.awaitAll(E);function v(O){O instanceof L.TileLayer?o.defer(C,O):O._heat&&o.defer($,O._canvas)}function x(O){O instanceof L.Marker&&O.options.icon instanceof L.Icon&&o.defer(R,O)}function w(O){L.esri&&O instanceof L.esri.DynamicMapLayer&&o.defer(P,O)}function T(){r(null,l)}function E(O,M){if(O)throw O;M.forEach(function(B){B&&B.canvas&&c.drawImage(B.canvas,0,0)}),T()}function C(O,M){var B=L.TileLayer.Canvas&&O instanceof L.TileLayer.Canvas,D=document.createElement("canvas");D.width=a.x,D.height=a.y;var W=D.getContext("2d"),H=s.getPixelBounds(),ae=s.getZoom(),te=O.options.tileSize;if(ae>O.options.maxZoom||ae<O.options.minZoom||i&&O instanceof L.mapbox.tileLayer&&!O.options.tiles)return M();var Z=L.bounds(H.min.divideBy(te)._floor(),H.max.divideBy(te)._floor()),re=[],ne,he,K=new n(1);for(ne=Z.min.y;ne<=Z.max.y;ne++)for(he=Z.min.x;he<=Z.max.x;he++)re.push(new L.Point(he,ne));re.forEach(function(Te){var Se=Te.clone();O._adjustTilePoint&&O._adjustTilePoint(Te);var He=Se.scaleBy(new L.Point(te,te)).subtract(H.min);if(Te.y>=0)if(B){var qe=O._tiles[Te.x+":"+Te.y];K.defer(ie,qe,He,te)}else{var Qe=U(O.getTileUrl(Te));K.defer(pe,Qe,He,te)}}),K.awaitAll(fe);function ie(Te,Se,He,qe){qe(null,{img:Te,pos:Se,size:He})}function pe(Te,Se,He,qe){var Qe=new Image;Qe.crossOrigin="",Qe.onload=function(){qe(null,{img:this,pos:Se,size:He})},Qe.onerror=function(pt){O.options.errorTileUrl!=""&&pt.target.errorCheck===void 0?(pt.target.errorCheck=!0,pt.target.src=O.options.errorTileUrl):qe(null,{img:h,pos:Se,size:He})},Qe.src=Te}function fe(Te,Se){Se.forEach(Ne),M(null,{canvas:D})}function Ne(Te){W.drawImage(Te.img,Math.floor(Te.pos.x),Math.floor(Te.pos.y),Te.size,Te.size)}}function $(O,M){var B=s.getPixelBounds(),D=s.getPixelOrigin(),W=document.createElement("canvas");W.width=a.x,W.height=a.y;var H=W.getContext("2d"),ae=L.DomUtil.getPosition(O).subtract(B.min).add(D);try{H.drawImage(O,ae.x,ae.y,W.width-ae.x*2,W.height-ae.y*2),M(null,{canvas:W})}catch{console.error("Element could not be drawn on canvas",O)}}function R(O,M){var B=document.createElement("canvas"),D=B.getContext("2d"),W=s.getPixelBounds(),H=new L.Point(W.min.x,W.min.y),ae=s.project(O.getLatLng()),te=/^data\:/.test(O._icon.src),Z=te?O._icon.src:U(O._icon.src),re=new Image,ne=O.options.icon.options,he=ne.iconSize,K=ae.subtract(H),ie=L.point(ne.iconAnchor||he&&he.divideBy(2,!0));he instanceof L.Point&&(he=[he.x,he.y]);var pe=Math.round(K.x-he[0]+ie.x),fe=Math.round(K.y-ie.y);B.width=a.x,B.height=a.y,re.crossOrigin="",re.onload=function(){D.drawImage(this,pe,fe,he[0],he[1]),M(null,{canvas:B})},re.src=Z,te&&re.onload()}function P(O,M){var B=document.createElement("canvas");B.width=a.x,B.height=a.y;var D=B.getContext("2d"),W=new Image;W.crossOrigin="",W.src=U(O._currentImage._image.src),W.onload=function(){D.drawImage(W,0,0),M(null,{canvas:B})}}function U(O){return j(O)||O.indexOf("mapbox.com/styles/v1")!==-1?O:O+(O.match(/\?/)?"&":"?")+"cache="+e}function j(O){var M=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i;return!!O.match(M)}},KE}var fae=dae();const pae=yC(fae),mae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",gae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";vl.Icon.Default.mergeOptions({iconUrl:mae,shadowUrl:gae});function yae({onDataCapture:n}){const e=ve.useRef(null),t=ve.useRef(null),s=ve.useRef(null),r=ve.useRef(null),i=ve.useRef(null),a=ve.useRef(null),[o,l]=ve.useState(null),[c,h]=ve.useState(null),[p,m]=ve.useState(null),[v,x]=ve.useState(null),[w,T]=ve.useState(null);ve.useEffect(()=>{n&&n({gpsCoords:o,capturedImg:c,satImg:v,measuredArea:w})},[o,c,v,w]),ve.useEffect(()=>{if(e.current)return;const j="https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",O=vl.map(t.current,{zoomControl:!0}).setView([20,0],2);vl.tileLayer(j,{maxZoom:19,attribution:"Tiles  Esri"}).addTo(O);const M=new vl.FeatureGroup().addTo(O);s.current=M;const B=new vl.Control.Draw({edit:{featureGroup:M},draw:{polygon:!0,rectangle:!0,circle:!0,marker:!1,polyline:!1}});O.addControl(B),O.on(vl.Draw.Event.CREATED,D=>{const W=D.layer;M.addLayer(W),P(W)}),e.current={map:O}},[]);async function E(){try{const j=await navigator.mediaDevices.getUserMedia({video:!0});r.current.srcObject=j}catch(j){alert("Camera access denied: "+j.message)}}function C(){if(!r.current)return;const j=i.current,O=j.getContext("2d");j.width=r.current.videoWidth,j.height=r.current.videoHeight,O.drawImage(r.current,0,0),navigator.geolocation&&navigator.geolocation.getCurrentPosition(M=>{const B=M.coords.latitude,D=M.coords.longitude;l({lat:B,lon:D}),O.fillStyle="red",O.font="24px Arial",O.fillText(`Lat: ${B.toFixed(6)}, Lon: ${D.toFixed(6)}`,20,40),h(j.toDataURL("image/png"));const{map:W}=e.current;W.setView([B,D],18),vl.marker([B,D]).addTo(W).bindPopup("Photo GPS point").openPopup()},()=>h(j.toDataURL("image/png")))}function $(j){const O=j.target.files[0];if(!O)return;const M=new FileReader;M.onload=B=>m(B.target.result),M.readAsDataURL(O)}function R(){const{map:j}=e.current;pae(j,(O,M)=>{if(O)return alert("Map capture failed: "+O.message);const B=[];if(s.current.eachLayer(H=>{if(H instanceof vl.Polygon||H instanceof vl.Rectangle){const ae=H.getLatLngs()[0];B.push(ae.map(te=>j.latLngToContainerPoint(te)))}}),B.length===0)return x(M.toDataURL("image/png"));const D=document.createElement("canvas");D.width=M.width,D.height=M.height;const W=D.getContext("2d");W.drawImage(M,0,0),W.globalCompositeOperation="destination-in",W.beginPath(),B.forEach(H=>{W.moveTo(H[0].x,H[0].y),H.forEach(ae=>W.lineTo(ae.x,ae.y)),W.closePath()}),W.fill(),x(D.toDataURL("image/png"))})}function P(j){const O=j.toGeoJSON();let M=0;O.geometry.type==="Polygon"?M=nae(O):j instanceof vl.Circle&&(M=Math.PI*j.getRadius()**2),T(M)}function U(j){return j?j>=1e6?(j/1e6).toFixed(4)+" km":j>=1e4?(j/1e4).toFixed(2)+" ha":Math.round(j)+" m":"-"}return y.jsxs("div",{className:"verifier-root",children:[y.jsx("header",{children:y.jsx("h1",{children:" Map & Photo Capture"})}),y.jsxs("main",{className:"verifier-main",children:[y.jsxs("section",{className:"verifier-section",children:[y.jsx("h3",{children:"Camera Capture"}),y.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,className:"verifier-video"}),y.jsx("canvas",{ref:i,className:"hidden-canvas"}),y.jsxs("div",{className:"verifier-buttons",children:[y.jsx("button",{type:"button",onClick:E,children:"Start Camera"}),y.jsx("button",{type:"button",onClick:C,children:"Capture Photo"})]}),c&&y.jsxs("div",{children:[y.jsx("h4",{children:"Captured Image with Location:"}),y.jsx("img",{ref:a,src:c,alt:"Captured",className:"verifier-img"})]}),y.jsx("h3",{children:"Upload Image"}),y.jsx("input",{type:"file",accept:"image/*",onChange:$}),p&&y.jsx("img",{src:p,alt:"Uploaded",className:"verifier-img"}),y.jsx("h3",{children:"Satellite Map Capture"}),y.jsx("button",{type:"button",onClick:R,children:"Capture Map View"}),v&&y.jsx("img",{src:v,alt:"Satellite",className:"verifier-img"}),y.jsxs("h4",{children:["Measured Area: ",U(w)]})]}),y.jsxs("section",{className:"verifier-map-section",children:[y.jsx("h3",{children:"Map"}),y.jsx("div",{ref:t,className:"verifier-map"})]})]})]})}function vae(){const[n,e]=ve.useState({projectName:"",projectType:"",location:"",area:"",description:"",expectedCredits:"",timeline:"",methodology:"",coordinates:"",documents:null,capturedPhoto:null,satImage:null}),t=a=>{const{name:o,value:l}=a.target;e(c=>({...c,[o]:l}))},s=a=>{const o=a.target.files;e(l=>({...l,documents:o}))},r=a=>{e(o=>({...o,coordinates:a.gpsCoords?`${a.gpsCoords.lat}, ${a.gpsCoords.lon}`:o.coordinates,capturedPhoto:a.capturedImg||o.capturedPhoto,satImage:a.satImg||o.satImage,area:a.measuredArea?(a.measuredArea/1e4).toFixed(2):o.area}))},i=async a=>{a.preventDefault();try{const o=Lh.currentUser;if(!o){alert("You must be logged in to submit a project.");return}let l=[];if(n.documents)for(let p=0;p<n.documents.length;p++){const m=n.documents[p],v=Jx(HE,`projects/${o.uid}/${Date.now()}_${m.name}`);await Yx(v,m),l.push(await Qx(v))}let c=null;if(n.capturedPhoto){const p=await fetch(n.capturedPhoto).then(v=>v.blob()),m=Jx(HE,`projects/${o.uid}/photo_${Date.now()}.png`);await Yx(m,p),c=await Qx(m)}let h=null;if(n.satImage){const p=await fetch(n.satImage).then(v=>v.blob()),m=Jx(HE,`projects/${o.uid}/satellite_${Date.now()}.png`);await Yx(m,p),h=await Qx(m)}await lB(Dh(Pr,"projects"),{...n,documents:l,capturedPhoto:c,satImage:h,userId:o.uid,status:"pending",numericId:Date.now(),creditsGenerated:0,farmerWalletAddress:null,farmerWalletPrivateKey:null,createdAt:cB()}),alert("Project submitted successfully!"),e({projectName:"",projectType:"",location:"",area:"",description:"",expectedCredits:"",timeline:"",methodology:"",coordinates:"",documents:null,capturedPhoto:null,satImage:null})}catch(o){console.error("Error adding project: ",o),alert("Failed to submit project. Check console for details.")}};return y.jsxs("div",{className:"page-container",children:[y.jsxs("div",{className:"page-header",children:[y.jsx("h1",{className:"page-title",children:" Add New Project"}),y.jsx("p",{className:"page-subtitle",children:"Submit your blue carbon project for verification and credit generation"})]}),y.jsxs("form",{className:"project-form",onSubmit:i,children:[y.jsxs("div",{className:"form-section",children:[y.jsx("h3",{children:"Project Information"}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"projectName",children:"Project Name *"}),y.jsx("input",{type:"text",id:"projectName",name:"projectName",value:n.projectName,onChange:t,required:!0,placeholder:"Enter project name"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"projectType",children:"Project Type *"}),y.jsxs("select",{id:"projectType",name:"projectType",value:n.projectType,onChange:t,required:!0,children:[y.jsx("option",{value:"",children:"Select project type"}),y.jsx("option",{value:"mangrove",children:"Mangrove Restoration"}),y.jsx("option",{value:"seagrass",children:"Seagrass Conservation"}),y.jsx("option",{value:"saltmarsh",children:"Salt Marsh Restoration"}),y.jsx("option",{value:"oyster",children:"Oyster Reef Restoration"}),y.jsx("option",{value:"kelp",children:"Kelp Forest Conservation"})]})]})]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"location",children:"Location *"}),y.jsx("input",{type:"text",id:"location",name:"location",value:n.location,onChange:t,required:!0,placeholder:"City, State, Country"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"area",children:"Project Area (hectares) *"}),y.jsx("input",{type:"number",id:"area",name:"area",value:n.area,onChange:t,required:!0,placeholder:"Enter area in hectares"})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"coordinates",children:"GPS Coordinates"}),y.jsx("input",{type:"text",id:"coordinates",name:"coordinates",value:n.coordinates,onChange:t,placeholder:"Latitude, Longitude"})]})]}),y.jsxs("div",{className:"form-section",children:[y.jsx("h3",{children:"Project Details"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"description",children:"Project Description *"}),y.jsx("textarea",{id:"description",name:"description",value:n.description,onChange:t,required:!0,placeholder:"Describe your project objectives, methods, and expected environmental impact...",rows:"4"})]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"expectedCredits",children:"Expected Carbon Credits"}),y.jsx("input",{type:"number",id:"expectedCredits",name:"expectedCredits",value:n.expectedCredits,onChange:t,placeholder:"Estimated credits per year"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"timeline",children:"Project Timeline *"}),y.jsxs("select",{id:"timeline",name:"timeline",value:n.timeline,onChange:t,required:!0,children:[y.jsx("option",{value:"",children:"Select timeline"}),y.jsx("option",{value:"1-year",children:"1 Year"}),y.jsx("option",{value:"2-years",children:"2 Years"}),y.jsx("option",{value:"3-years",children:"3 Years"}),y.jsx("option",{value:"5-years",children:"5 Years"}),y.jsx("option",{value:"10-years",children:"10+ Years"})]})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"methodology",children:"Methodology *"}),y.jsxs("select",{id:"methodology",name:"methodology",value:n.methodology,onChange:t,required:!0,children:[y.jsx("option",{value:"",children:"Select methodology"}),y.jsx("option",{value:"vcs",children:"Verified Carbon Standard (VCS)"}),y.jsx("option",{value:"gold-standard",children:"Gold Standard"}),y.jsx("option",{value:"plan-vivo",children:"Plan Vivo"}),y.jsx("option",{value:"climate-action",children:"Climate Action Reserve"})]})]})]}),y.jsxs("div",{className:"form-section",children:[y.jsx("h3",{children:"Supporting Documents"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"documents",children:"Upload Documents"}),y.jsx("input",{type:"file",id:"documents",name:"documents",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.png",onChange:s,className:"file-input"}),y.jsx("small",{className:"form-help",children:"Upload project plans, environmental assessments, permits, etc."})]})]}),y.jsxs("div",{className:"form-section",children:[y.jsx("h3",{children:"Satellite & AI Verification"}),y.jsx(yae,{onDataCapture:r})]}),y.jsx("div",{className:"form-section",children:y.jsx("button",{type:"submit",className:"submit-button",children:"Submit Project"})})]})]})}function bae(){const[n,e]=ve.useState([]),[t,s]=ve.useState(null),[r,i]=ve.useState({carbonSequestered:"",biomassGrowth:"",areaMonitored:"",monitoringDate:"",methodology:"",verificationStatus:"pending",notes:""});ve.useEffect(()=>{(async()=>{try{const v=Lh.currentUser;if(!v)return;const x=Dh(Pr,"projects"),w=Yp(x,Qp("userId","==",v.uid)),E=(await Mc(w)).docs.map(C=>({id:C.id,...C.data()}));e(E)}catch(v){console.error("Error fetching projects:",v)}})()},[]);const a=m=>{const{name:v,value:x}=m.target;i(w=>({...w,[v]:x}))},o=m=>{if(m.preventDefault(),!t){alert("Please select a project first");return}const v=JSON.parse(localStorage.getItem("mrvReports")||"[]"),x={...r,id:Date.now(),projectId:t.id,projectName:t.projectName,submittedAt:new Date().toISOString()};v.push(x),localStorage.setItem("mrvReports",JSON.stringify(v)),alert("MRV Report submitted successfully!"),i({carbonSequestered:"",biomassGrowth:"",areaMonitored:"",monitoringDate:"",methodology:"",verificationStatus:"pending",notes:""}),s(null)},l=()=>JSON.parse(localStorage.getItem("mrvReports")||"[]"),c=()=>n.reduce((m,v)=>m+(v.creditsGenerated||0),0),h=()=>{const m={};return n.forEach(v=>{v.creditsGenerated&&(m[v.projectName]=v.creditsGenerated)}),m},p=()=>{const m=l();return n.map(v=>{const x=m.filter(T=>T.projectId===v.id),w=x[x.length-1];return{...v,totalCredits:v.creditsGenerated||0,reportsCount:x.length,lastReportDate:w?w.submittedAt:null,verificationStatus:w?w.verificationStatus:v.status||"no-reports"}})};return y.jsxs("div",{className:"page-container",children:[y.jsxs("div",{className:"page-header",children:[y.jsx("h1",{className:"page-title",children:" MRV Dashboard"}),y.jsx("p",{className:"page-subtitle",children:"Monitor, Report, and Verify your blue carbon projects"})]}),y.jsxs("div",{className:"mrv-content",children:[y.jsx("div",{className:"dashboard-overview",children:y.jsxs("div",{className:"mrv-section carbon-credits-section",children:[y.jsx("h3",{children:" Generated Carbon Credits"}),y.jsxs("div",{className:"credits-summary",children:[y.jsxs("div",{className:"total-credits",children:[y.jsx("h4",{children:"Total Credits Generated"}),y.jsxs("span",{className:"credits-number",children:[c().toFixed(2)," tCO2"]})]}),y.jsxs("div",{className:"credits-by-project",children:[y.jsx("h4",{children:"Credits by Project"}),Object.entries(h()).map(([m,v])=>y.jsxs("div",{className:"project-credits",children:[y.jsx("span",{className:"project-name",children:m}),y.jsxs("span",{className:"credits-amount",children:[v.toFixed(2)," tCO2"]})]},m)),Object.keys(h()).length===0&&y.jsx("p",{className:"no-credits",children:"No carbon credits generated yet. Submit MRV reports to track credits."})]})]})]})}),y.jsxs("div",{className:"mrv-section projects-status-section",children:[y.jsx("h3",{children:" My Projects Status"}),y.jsxs("div",{className:"projects-status-grid",children:[p().map(m=>y.jsxs("div",{className:"project-status-card",children:[y.jsxs("div",{className:"project-header",children:[y.jsx("h4",{children:m.projectName}),y.jsx("span",{className:`status-badge ${m.verificationStatus}`,children:m.verificationStatus==="no-reports"?"No Reports":m.verificationStatus})]}),y.jsxs("div",{className:"project-stats",children:[y.jsxs("div",{className:"stat",children:[y.jsx("span",{className:"stat-label",children:"Total Credits"}),y.jsxs("span",{className:"stat-value",children:[m.totalCredits.toFixed(2)," tCO2"]})]}),y.jsxs("div",{className:"stat",children:[y.jsx("span",{className:"stat-label",children:"Reports Submitted"}),y.jsx("span",{className:"stat-value",children:m.reportsCount})]}),y.jsxs("div",{className:"stat",children:[y.jsx("span",{className:"stat-label",children:"Last Report"}),y.jsx("span",{className:"stat-value",children:m.lastReportDate?new Date(m.lastReportDate).toLocaleDateString():"Never"})]}),y.jsxs("div",{className:"stat",children:[y.jsx("span",{className:"stat-label",children:"Project Area"}),y.jsxs("span",{className:"stat-value",children:[m.area," hectares"]})]}),m.creditsGenerated>0&&y.jsxs("div",{className:"stat",children:[y.jsx("span",{className:"stat-label",children:"Blockchain Tx"}),y.jsx("span",{className:"stat-value tx-id",children:m.blockchainTx?y.jsx("a",{href:`https://sepolia.etherscan.io/tx/${m.blockchainTx}`,target:"_blank",rel:"noopener noreferrer",className:"tx-link",children:m.blockchainTx}):"N/A"})]})]})]},m.id)),n.length===0&&y.jsx("div",{className:"no-projects-status",children:y.jsxs("p",{children:["No projects found. ",y.jsx(ft,{to:"/add-project",children:"Add your first project"})]})})]})]}),y.jsxs("div",{className:"mrv-section",children:[y.jsx("h3",{children:"Select Project for Monitoring"}),y.jsx("div",{className:"project-grid",children:n.length>0?n.map(m=>y.jsxs("div",{className:`project-card ${t?.id===m.id?"selected":""}`,onClick:()=>s(m),children:[y.jsx("h4",{children:m.projectName}),y.jsxs("p",{children:[y.jsx("strong",{children:"Type:"})," ",m.projectType]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Location:"})," ",m.location]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Area:"})," ",m.area," hectares"]}),y.jsx("span",{className:`status-badge ${m.status}`,children:m.status})]},m.id)):y.jsx("div",{className:"no-projects",children:y.jsxs("p",{children:["No projects found. ",y.jsx(ft,{to:"/add-project",children:"Add your first project"})]})})})]}),t&&y.jsxs("div",{className:"mrv-section",children:[y.jsxs("h3",{children:["Submit MRV Report for: ",t.projectName]}),y.jsxs("form",{className:"mrv-form",onSubmit:o,children:[y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"carbonSequestered",children:"Carbon Sequestered (tCO2) *"}),y.jsx("input",{type:"number",id:"carbonSequestered",name:"carbonSequestered",value:r.carbonSequestered,onChange:a,required:!0,placeholder:"Enter carbon sequestered"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"biomassGrowth",children:"Biomass Growth (%) *"}),y.jsx("input",{type:"number",id:"biomassGrowth",name:"biomassGrowth",value:r.biomassGrowth,onChange:a,required:!0,placeholder:"Enter biomass growth percentage"})]})]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"areaMonitored",children:"Area Monitored (hectares) *"}),y.jsx("input",{type:"number",id:"areaMonitored",name:"areaMonitored",value:r.areaMonitored,onChange:a,required:!0,placeholder:"Enter monitored area"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"monitoringDate",children:"Monitoring Date *"}),y.jsx("input",{type:"date",id:"monitoringDate",name:"monitoringDate",value:r.monitoringDate,onChange:a,required:!0})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"methodology",children:"Verification Methodology *"}),y.jsxs("select",{id:"methodology",name:"methodology",value:r.methodology,onChange:a,required:!0,children:[y.jsx("option",{value:"",children:"Select methodology"}),y.jsx("option",{value:"remote-sensing",children:"Remote Sensing"}),y.jsx("option",{value:"field-sampling",children:"Field Sampling"}),y.jsx("option",{value:"drone-survey",children:"Drone Survey"}),y.jsx("option",{value:"satellite-imagery",children:"Satellite Imagery"}),y.jsx("option",{value:"combined",children:"Combined Methods"})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"notes",children:"Additional Notes"}),y.jsx("textarea",{id:"notes",name:"notes",value:r.notes,onChange:a,placeholder:"Add any additional observations or notes...",rows:"3"})]}),y.jsx("button",{type:"submit",className:"btn-primary",children:"Submit MRV Report"})]})]}),y.jsxs("div",{className:"mrv-section",children:[y.jsx("h3",{children:"Recent MRV Reports"}),y.jsxs("div",{className:"reports-list",children:[l().slice(-5).map(m=>y.jsxs("div",{className:"report-item",children:[y.jsxs("div",{className:"report-header",children:[y.jsx("h4",{children:m.projectName}),y.jsx("span",{className:`status-badge ${m.verificationStatus}`,children:m.verificationStatus})]}),y.jsxs("div",{className:"report-details",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Carbon Sequestered:"})," ",m.carbonSequestered," tCO2"]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Monitoring Date:"})," ",new Date(m.monitoringDate).toLocaleDateString()]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Methodology:"})," ",m.methodology]})]})]},m.id)),l().length===0&&y.jsx("p",{className:"no-reports",children:"No MRV reports submitted yet."})]})]})]})]})}function _ae(){const[n,e]=ve.useState([]),[t,s]=ve.useState([]),[r,i]=ve.useState([]),[a,o]=ve.useState("");ve.useEffect(()=>{const x=OC(Lh,async w=>{if(w)try{const T=Dh(Pr,"projects"),E=Yp(T,Qp("userId","==",w.uid)),$=(await Mc(E)).docs.map(R=>({id:R.id,...R.data()}));setProjects($)}catch(T){console.error("Error fetching projects:",T)}else setProjects([])});return()=>x()},[]),ve.useEffect(()=>{l();const x=JSON.parse(localStorage.getItem("purchaseHistory")||"[]");s(x)},[]);const l=()=>{const x=JSON.parse(localStorage.getItem("mrvReports")||"[]"),w=JSON.parse(localStorage.getItem("userProjects")||"[]"),T={};x.forEach(C=>{if(C.verificationStatus==="verified"){if(!T[C.projectId]){const $=w.find(R=>R.id===C.projectId);T[C.projectId]={projectId:C.projectId,projectName:C.projectName,projectType:$?.projectType||"Unknown",location:$?.location||"Unknown",totalCredits:0,availableCredits:0,pricePerCredit:58,reports:[]}}T[C.projectId].totalCredits+=parseFloat(C.carbonSequestered||0),T[C.projectId].availableCredits+=parseFloat(C.carbonSequestered||0),T[C.projectId].reports.push(C)}}),JSON.parse(localStorage.getItem("purchaseHistory")||"[]").forEach(C=>{T[C.projectId]&&(T[C.projectId].availableCredits-=C.amount)}),e(Object.values(T).filter(C=>C.availableCredits>0))},c=(x,w)=>{const T=n.find($=>$.projectId===x);if(!T||w>T.availableCredits){alert("Insufficient credits available for purchase");return}const E={id:Date.now(),projectId:x,projectName:T.projectName,amount:parseFloat(w),pricePerCredit:T.pricePerCredit,totalCost:parseFloat(w)*T.pricePerCredit,purchaseDate:new Date().toISOString(),status:"completed"},C=JSON.parse(localStorage.getItem("purchaseHistory")||"[]");C.push(E),localStorage.setItem("purchaseHistory",JSON.stringify(C)),s(C),l(),alert(`Successfully purchased ${w} tCO2 credits for  ${E.totalCost.toFixed(2)}`)},h=()=>t.reduce((x,w)=>x+w.amount,0),p=()=>t.reduce((x,w)=>x+w.totalCost,0),m=()=>[{month:"Jan",price:45},{month:"Feb",price:48},{month:"Mar",price:52},{month:"Apr",price:49},{month:"May",price:55},{month:"Jun",price:58}],v=()=>{const x=n.reduce((T,E)=>T+E.availableCredits,0),w=n.length>0?n.reduce((T,E)=>T+E.pricePerCredit,0)/n.length:58;return{totalAvailableCredits:x,averagePrice:w,totalProjects:n.length,marketValue:x*w}};return y.jsxs("div",{className:"page-container",children:[y.jsxs("div",{className:"page-header",children:[y.jsx("h1",{className:"page-title",children:" Carbon Credit Holdings"}),y.jsx("p",{className:"page-subtitle",children:"Manage your verified carbon credits from blue carbon projects"})]}),y.jsxs("div",{className:"mrv-content",children:[y.jsxs("div",{className:"dashboard-overview",children:[y.jsxs("div",{className:"mrv-section carbon-credits-section",children:[y.jsx("h3",{children:" My Carbon Credit Portfolio"}),y.jsxs("div",{className:"credits-summary",children:[y.jsxs("div",{className:"total-credits",children:[y.jsx("h4",{children:"Total Credits Purchased"}),y.jsxs("span",{className:"credits-number",children:[h().toFixed(2)," tCO2"]})]}),y.jsxs("div",{className:"credits-by-project",children:[y.jsx("h4",{children:"Total Investment"}),y.jsxs("div",{className:"investment-summary",children:[y.jsxs("span",{className:"investment-amount",children:["$",p().toFixed(2)]}),y.jsx("span",{className:"investment-label",children:"Total Spent"})]}),y.jsxs("div",{className:"recent-purchases",children:[y.jsx("h5",{children:"Recent Purchases"}),t.slice(-3).map(x=>y.jsxs("div",{className:"project-credits",children:[y.jsx("span",{className:"project-name",children:x.projectName}),y.jsxs("span",{className:"credits-amount",children:[x.amount.toFixed(2)," tCO2"]})]},x.id)),t.length===0&&y.jsx("p",{className:"no-credits",children:"No purchases yet. Browse available credits below."})]})]})]})]}),y.jsxs("div",{className:"mrv-section price-graph-section",children:[y.jsx("h3",{children:" Carbon Credit Price Trends"}),y.jsxs("div",{className:"price-graph",children:[y.jsxs("div",{className:"current-price",children:[y.jsx("span",{className:"price-label",children:"Current Price"}),y.jsx("span",{className:"price-value",children:"58.00 per tCO2"}),y.jsx("span",{className:"price-change positive",children:"+5.5% "})]}),y.jsx("div",{className:"price-chart",children:m().map((x,w)=>y.jsxs("div",{className:"price-bar",children:[y.jsx("div",{className:"bar",style:{height:`${x.price/60*100}%`}}),y.jsx("span",{className:"month-label",children:x.month}),y.jsxs("span",{className:"price-label",children:["",x.price]})]},x.month))})]})]})]}),y.jsxs("div",{className:"mrv-section projects-status-section",children:[y.jsx("h3",{children:" Market Overview"}),y.jsxs("div",{className:"market-stats-grid",children:[y.jsxs("div",{className:"market-stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("span",{className:"stat-value",children:v().totalAvailableCredits.toFixed(0)}),y.jsx("span",{className:"stat-label",children:"Available Credits (tCO2)"})]})]}),y.jsxs("div",{className:"market-stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsxs("span",{className:"stat-value",children:["",v().averagePrice.toFixed(2)]}),y.jsx("span",{className:"stat-label",children:"Average Price per tCO2"})]})]}),y.jsxs("div",{className:"market-stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("span",{className:"stat-value",children:v().totalProjects}),y.jsx("span",{className:"stat-label",children:"Active Projects"})]})]}),y.jsxs("div",{className:"market-stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsxs("span",{className:"stat-value",children:["",v().marketValue.toFixed(0)]}),y.jsx("span",{className:"stat-label",children:"Total Market Value"})]})]})]})]}),y.jsxs("div",{className:"mrv-section",children:[y.jsx("h3",{children:" Available Carbon Credits"}),y.jsx("div",{className:"credits-marketplace",children:n.length>0?n.map(x=>y.jsxs("div",{className:"credit-card",children:[y.jsxs("div",{className:"credit-header",children:[y.jsx("h4",{children:x.projectName}),y.jsx("span",{className:"project-type",children:x.projectType})]}),y.jsxs("div",{className:"credit-details",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Location:"})," ",x.location]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Available Credits:"})," ",x.availableCredits.toFixed(2)," tCO2"]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Price per Credit:"})," ",x.pricePerCredit]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Total Value:"}),"",(x.availableCredits*x.pricePerCredit).toFixed(2)]})]}),y.jsxs("div",{className:"purchase-section",children:[y.jsx("input",{type:"number",placeholder:"Amount to purchase",max:x.availableCredits,min:"0.1",step:"0.1",className:"purchase-input",id:`purchase-${x.projectId}`}),y.jsx("button",{className:"btn-primary purchase-btn",onClick:()=>{const w=document.getElementById(`purchase-${x.projectId}`).value;w&&parseFloat(w)>0?(c(x.projectId,parseFloat(w)),document.getElementById(`purchase-${x.projectId}`).value=""):alert("Please enter a valid amount")},children:"Purchase Credits"})]})]},x.projectId)):y.jsxs("div",{className:"no-credits-available",children:[y.jsx("p",{children:"No verified carbon credits available for purchase at the moment."}),y.jsx("p",{children:"Credits become available once farmer projects are verified."})]})})]}),y.jsxs("div",{className:"mrv-section",children:[y.jsx("h3",{children:" Purchase History"}),y.jsx("div",{className:"purchase-history",children:t.length>0?y.jsxs("div",{className:"history-table",children:[y.jsxs("div",{className:"table-header",children:[y.jsx("span",{children:"Date"}),y.jsx("span",{children:"Project"}),y.jsx("span",{children:"Amount"}),y.jsx("span",{children:"Price"}),y.jsx("span",{children:"Total Cost"}),y.jsx("span",{children:"Status"})]}),t.slice().reverse().map(x=>y.jsxs("div",{className:"table-row",children:[y.jsx("span",{children:new Date(x.purchaseDate).toLocaleDateString()}),y.jsx("span",{children:x.projectName}),y.jsxs("span",{children:[x.amount.toFixed(2)," tCO2"]}),y.jsxs("span",{children:["$",x.pricePerCredit]}),y.jsxs("span",{children:["$",x.totalCost.toFixed(2)]}),y.jsx("span",{className:`status-badge ${x.status}`,children:x.status})]},x.id))]}):y.jsx("p",{className:"no-history",children:"No purchase history yet. Start buying carbon credits to see your transactions here."})})]})]})]})}function xae(){const[n,e]=ve.useState([]),[t,s]=ve.useState([]),[r,i]=ve.useState(null),[a,o]=ve.useState({creditsToSell:"",pricePerCredit:"",description:"",availableFrom:"",expiryDate:""});ve.useEffect(()=>{const m=JSON.parse(localStorage.getItem("userProjects")||"[]"),v=JSON.parse(localStorage.getItem("marketListings")||"[]");e(m.filter(x=>x.status==="verified")),s(v)},[]);const l=m=>{const{name:v,value:x}=m.target;o(w=>({...w,[v]:x}))},c=m=>{if(m.preventDefault(),!r){alert("Please select a project first");return}const v={...a,id:Date.now(),projectId:r.id,projectName:r.projectName,projectType:r.projectType,location:r.location,sellerId:localStorage.getItem("userEmail"),status:"active",createdAt:new Date().toISOString()},x=JSON.parse(localStorage.getItem("marketListings")||"[]");x.push(v),localStorage.setItem("marketListings",JSON.stringify(x)),s(x),alert("Listing created successfully!"),o({creditsToSell:"",pricePerCredit:"",description:"",availableFrom:"",expiryDate:""}),i(null)},h=()=>{const m=localStorage.getItem("userEmail");return t.filter(v=>v.sellerId===m)},p=()=>{const m=localStorage.getItem("userEmail");return t.filter(v=>v.sellerId!==m&&v.status==="active")};return y.jsxs("div",{className:"page-container",children:[y.jsxs("div",{className:"page-header",children:[y.jsx("h1",{className:"page-title",children:" Carbon Credit Marketplace"}),y.jsx("p",{className:"page-subtitle",children:"Sell your verified carbon credits and discover opportunities"})]}),y.jsxs("div",{className:"marketplace-content",children:[y.jsxs("div",{className:"marketplace-section",children:[y.jsx("h3",{children:" Create New Listing"}),y.jsxs("div",{className:"project-selection",children:[y.jsx("h4",{children:"Select Verified Project"}),y.jsx("div",{className:"project-grid",children:n.length>0?n.map(m=>y.jsxs("div",{className:`project-card ${r?.id===m.id?"selected":""}`,onClick:()=>i(m),children:[y.jsx("h5",{children:m.projectName}),y.jsxs("p",{children:[y.jsx("strong",{children:"Type:"})," ",m.projectType]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Location:"})," ",m.location]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Expected Credits:"})," ",m.expectedCredits]}),y.jsx("span",{className:"status-badge verified",children:"Verified"})]},m.id)):y.jsx("div",{className:"no-projects",children:y.jsxs("p",{children:["No verified projects available. ",y.jsx(ft,{to:"/add-project",children:"Add a project"})," and complete verification first."]})})})]}),r&&y.jsxs("form",{className:"listing-form",onSubmit:c,children:[y.jsxs("h4",{children:["Create Listing for: ",r.projectName]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"creditsToSell",children:"Credits to Sell *"}),y.jsx("input",{type:"number",id:"creditsToSell",name:"creditsToSell",value:a.creditsToSell,onChange:l,required:!0,placeholder:"Number of credits",max:r.expectedCredits})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"pricePerCredit",children:"Price per Credit ($) *"}),y.jsx("input",{type:"number",id:"pricePerCredit",name:"pricePerCredit",value:a.pricePerCredit,onChange:l,required:!0,placeholder:"Price in USD",step:"0.01"})]})]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"availableFrom",children:"Available From *"}),y.jsx("input",{type:"date",id:"availableFrom",name:"availableFrom",value:a.availableFrom,onChange:l,required:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"expiryDate",children:"Listing Expiry"}),y.jsx("input",{type:"date",id:"expiryDate",name:"expiryDate",value:a.expiryDate,onChange:l})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"description",children:"Description"}),y.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:l,placeholder:"Describe your carbon credits, project benefits, and any additional information...",rows:"3"})]}),y.jsx("button",{type:"submit",className:"btn-primary",children:"Create Listing"})]})]}),y.jsxs("div",{className:"marketplace-section",children:[y.jsx("h3",{children:" Your Active Listings"}),y.jsxs("div",{className:"listings-grid",children:[h().map(m=>y.jsxs("div",{className:"listing-card own-listing",children:[y.jsxs("div",{className:"listing-header",children:[y.jsx("h4",{children:m.projectName}),y.jsx("span",{className:`status-badge ${m.status}`,children:m.status})]}),y.jsxs("div",{className:"listing-details",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Credits:"})," ",m.creditsToSell]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Price:"})," $",m.pricePerCredit,"/credit"]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Total Value:"})," $",(m.creditsToSell*m.pricePerCredit).toFixed(2)]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Type:"})," ",m.projectType]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Location:"})," ",m.location]})]}),y.jsxs("div",{className:"listing-actions",children:[y.jsx("button",{className:"btn-secondary",children:"Edit"}),y.jsx("button",{className:"btn-danger",children:"Remove"})]})]},m.id)),h().length===0&&y.jsx("p",{className:"no-listings",children:"You haven't created any listings yet."})]})]}),y.jsxs("div",{className:"marketplace-section",children:[y.jsx("h3",{children:" Browse Available Credits"}),y.jsxs("div",{className:"listings-grid",children:[p().map(m=>y.jsxs("div",{className:"listing-card market-listing",children:[y.jsxs("div",{className:"listing-header",children:[y.jsx("h4",{children:m.projectName}),y.jsx("span",{className:"project-type",children:m.projectType})]}),y.jsxs("div",{className:"listing-details",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Credits Available:"})," ",m.creditsToSell]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Price:"})," $",m.pricePerCredit,"/credit"]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Location:"})," ",m.location]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Available From:"})," ",new Date(m.availableFrom).toLocaleDateString()]}),m.description&&y.jsxs("p",{children:[y.jsx("strong",{children:"Description:"})," ",m.description]})]}),y.jsxs("div",{className:"listing-actions",children:[y.jsx("button",{className:"btn-primary",children:"Contact Seller"}),y.jsx("button",{className:"btn-secondary",children:"View Details"})]})]},m.id)),p().length===0&&y.jsx("p",{className:"no-listings",children:"No credits available in the marketplace currently."})]})]}),y.jsxs("div",{className:"marketplace-section",children:[y.jsx("h3",{children:" Market Statistics"}),y.jsxs("div",{className:"stats-grid",children:[y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:t.length}),y.jsx("div",{className:"stat-label",children:"Total Listings"})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:t.reduce((m,v)=>m+parseInt(v.creditsToSell||0),0)}),y.jsx("div",{className:"stat-label",children:"Credits Available"})]}),y.jsxs("div",{className:"stat-card",children:[y.jsxs("div",{className:"stat-number",children:["",t.length>0?(t.reduce((m,v)=>m+parseFloat(v.pricePerCredit||0),0)/t.length).toFixed(2):"0.00"]}),y.jsx("div",{className:"stat-label",children:"Avg. Price/Credit"})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:h().length}),y.jsx("div",{className:"stat-label",children:"Your Listings"})]})]})]})]})]})}function wae(){const[n,e]=ve.useState({name:"",email:"",subject:"",message:"",category:""}),t=r=>{const{name:i,value:a}=r.target;e(o=>({...o,[i]:a}))},s=r=>{r.preventDefault();const i=JSON.parse(localStorage.getItem("contactSubmissions")||"[]"),a={...n,id:Date.now(),submittedAt:new Date().toISOString()};i.push(a),localStorage.setItem("contactSubmissions",JSON.stringify(i)),alert("Thank you for your message! We will get back to you soon."),e({name:"",email:"",subject:"",message:"",category:""})};return y.jsxs("div",{className:"contact-container",children:[y.jsx(N1,{}),y.jsxs("div",{className:"contact-header",children:[y.jsx("h1",{className:"contact-title",children:" Contact Us"}),y.jsx("p",{className:"contact-subtitle",children:"Get in touch with our team for support, partnerships, or general inquiries"})]}),y.jsxs("div",{className:"contact-content",children:[y.jsxs("div",{className:"contact-info-section",children:[y.jsx("h3",{children:"Get in Touch"}),y.jsxs("div",{className:"contact-methods",children:[y.jsxs("div",{className:"contact-method",children:[y.jsx("div",{className:"method-icon",children:""}),y.jsxs("div",{className:"method-details",children:[y.jsx("h4",{children:"Email"}),y.jsx("p",{children:"contact@carbonlens.com"}),y.jsx("p",{children:"partnerships@carbonlens.com"})]})]}),y.jsxs("div",{className:"contact-method",children:[y.jsx("div",{className:"method-icon",children:""}),y.jsxs("div",{className:"method-details",children:[y.jsx("h4",{children:"Phone"}),y.jsx("p",{children:"+91 9100899879"}),y.jsx("p",{children:"Mon-Sat, 9 AM - 6 PM EST"})]})]}),y.jsxs("div",{className:"contact-method",children:[y.jsx("div",{className:"method-icon",children:""}),y.jsxs("div",{className:"method-details",children:[y.jsx("h4",{children:"Address"}),y.jsx("p",{children:"TPC"}),y.jsx("p",{children:"JORHAT ENGINEERING COLLEGE"})]})]})]})]}),y.jsxs("div",{className:"contact-form-section",children:[y.jsx("h3",{children:"Send us a Message"}),y.jsxs("form",{className:"contact-form",onSubmit:s,children:[y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"name",children:"Full Name *"}),y.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:t,required:!0,placeholder:"Enter your full name"})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"email",children:"Email Address *"}),y.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:t,required:!0,placeholder:"Enter your email"})]})]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"category",children:"Category *"}),y.jsxs("select",{id:"category",name:"category",value:n.category,onChange:t,required:!0,children:[y.jsx("option",{value:"",children:"Select category"}),y.jsx("option",{value:"general",children:"General Inquiry"}),y.jsx("option",{value:"support",children:"Technical Support"}),y.jsx("option",{value:"partnership",children:"Partnership"}),y.jsx("option",{value:"verification",children:"Project Verification"}),y.jsx("option",{value:"billing",children:"Billing & Payments"}),y.jsx("option",{value:"feedback",children:"Feedback"})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"subject",children:"Subject *"}),y.jsx("input",{type:"text",id:"subject",name:"subject",value:n.subject,onChange:t,required:!0,placeholder:"Brief subject line"})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"message",children:"Message *"}),y.jsx("textarea",{id:"message",name:"message",value:n.message,onChange:t,required:!0,placeholder:"Tell us how we can help you...",rows:"6"})]}),y.jsx("button",{type:"submit",className:"btn-primary",children:"Send Message"})]})]})]}),y.jsxs("div",{className:"faq-section",children:[y.jsx("h3",{children:"Frequently Asked Questions"}),y.jsxs("div",{className:"faq-grid",children:[y.jsxs("div",{className:"faq-item",children:[y.jsx("h4",{children:"How do I get my project verified?"}),y.jsx("p",{children:'Submit your project through the "Add Project" page with all required documentation. Our verification team will review within 5-7 business days.'})]}),y.jsxs("div",{className:"faq-item",children:[y.jsx("h4",{children:"What types of blue carbon projects are accepted?"}),y.jsx("p",{children:"We accept mangrove restoration, seagrass conservation, salt marsh restoration, oyster reef restoration, and kelp forest conservation projects."})]}),y.jsxs("div",{className:"faq-item",children:[y.jsx("h4",{children:"How are carbon credits priced?"}),y.jsx("p",{children:"Credit prices are set by project owners based on market conditions, project quality, and verification standards. Typical range is $20-50 per credit."})]}),y.jsxs("div",{className:"faq-item",children:[y.jsx("h4",{children:"What payment methods do you accept?"}),y.jsx("p",{children:"We accept major credit cards, bank transfers, and cryptocurrency payments for carbon credit transactions."})]})]})]})]})}function Tae(){return y.jsxs("div",{className:"about-container",children:[y.jsx(N1,{}),y.jsxs("div",{className:"about-header",children:[y.jsx("h1",{className:"about-title",children:" About CarbonLens Platform"}),y.jsx("p",{className:"about-subtitle",children:"Protecting coastal ecosystems through transparent carbon credit trading"})]}),y.jsx("div",{className:"about-hero",children:y.jsxs("div",{className:"about-content",children:[y.jsx("h4",{children:"Revolutionizing Blue Carbon Conservation"}),y.jsx("p",{children:"Our platform connects coastal ecosystem protectors with carbon credit buyers, creating a transparent marketplace that drives real environmental impact while providing sustainable income for coastal communities."})]})}),y.jsxs("div",{className:"about-section",children:[y.jsx("h3",{children:"Our Mission"}),y.jsxs("div",{className:"mission-grid",children:[y.jsxs("div",{className:"mission-item",children:[y.jsx("div",{className:"mission-icon",children:""}),y.jsx("h4",{children:"Environmental Protection"}),y.jsx("p",{children:"Safeguard critical coastal ecosystems including mangroves, seagrass beds, and salt marshes that store vast amounts of carbon."})]}),y.jsxs("div",{className:"mission-item",children:[y.jsx("div",{className:"mission-icon",children:""}),y.jsx("h4",{children:"Community Empowerment"}),y.jsx("p",{children:"Provide sustainable income opportunities for coastal communities through verified carbon credit projects."})]}),y.jsxs("div",{className:"mission-item",children:[y.jsx("div",{className:"mission-icon",children:""}),y.jsx("h4",{children:"Transparent Trading"}),y.jsx("p",{children:"Create a trustworthy marketplace with blockchain-verified transactions and rigorous project monitoring."})]}),y.jsxs("div",{className:"mission-item",children:[y.jsx("div",{className:"mission-icon",children:""}),y.jsx("h4",{children:"Scientific Rigor"}),y.jsx("p",{children:"Ensure all projects meet international standards through our comprehensive MRV (Monitor, Report, Verify) system."})]})]})]}),y.jsxs("div",{className:"about-section blue-carbon-section",children:[y.jsx("h3",{children:"What is Blue Carbon?"}),y.jsxs("div",{className:"blue-carbon-content",children:[y.jsxs("div",{className:"blue-carbon-text",children:[y.jsx("p",{children:"Blue carbon refers to the carbon captured and stored by coastal and marine ecosystems. These environments are among the most carbon-rich ecosystems on Earth, storing up to 10 times more carbon per hectare than terrestrial forests."}),y.jsxs("div",{className:"ecosystem-types",children:[y.jsx("h4",{children:"Key Blue Carbon Ecosystems:"}),y.jsxs("ul",{children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Mangroves:"})," Tropical coastal forests that store carbon in both biomass and sediment"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Seagrass Beds:"})," Underwater meadows that sequester carbon in their roots and sediment"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Salt Marshes:"})," Coastal wetlands that capture carbon in plant matter and soil"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Kelp Forests:"})," Large marine algae that absorb CO2 from seawater"]})]})]})]}),y.jsxs("div",{className:"carbon-stats",children:[y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:"10x"}),y.jsx("div",{className:"stat-label",children:"More carbon storage than forests"})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:"50%"}),y.jsx("div",{className:"stat-label",children:"Of ocean carbon sequestration"})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-number",children:"2-4x"}),y.jsx("div",{className:"stat-label",children:"Faster carbon capture rate"})]})]})]})]}),y.jsxs("div",{className:"about-section",children:[y.jsx("h3",{children:"How Our Platform Works"}),y.jsxs("div",{className:"process-steps",children:[y.jsxs("div",{className:"step",children:[y.jsx("div",{className:"step-number",children:"1"}),y.jsxs("div",{className:"step-content",children:[y.jsx("h4",{children:"Project Registration"}),y.jsx("p",{children:"Coastal communities and organizations register their blue carbon conservation projects with detailed documentation."})]})]}),y.jsxs("div",{className:"step",children:[y.jsx("div",{className:"step-number",children:"2"}),y.jsxs("div",{className:"step-content",children:[y.jsx("h4",{children:"Verification Process"}),y.jsx("p",{children:"Our expert team verifies projects using international standards and satellite monitoring technology."})]})]}),y.jsxs("div",{className:"step",children:[y.jsx("div",{className:"step-number",children:"3"}),y.jsxs("div",{className:"step-content",children:[y.jsx("h4",{children:"MRV Monitoring"}),y.jsx("p",{children:"Continuous monitoring, reporting, and verification ensure project integrity and carbon sequestration accuracy."})]})]}),y.jsxs("div",{className:"step",children:[y.jsx("div",{className:"step-number",children:"4"}),y.jsxs("div",{className:"step-content",children:[y.jsx("h4",{children:"Credit Trading"}),y.jsx("p",{children:"Verified carbon credits are listed on our marketplace for transparent, secure trading with buyers worldwide."})]})]})]})]}),y.jsxs("div",{className:"about-section",children:[y.jsx("h3",{children:"Our Team"}),y.jsxs("div",{className:"team-grid",children:[y.jsxs("div",{className:"team-member",children:[y.jsx("div",{className:"member-avatar",children:""}),y.jsx("h4",{}),y.jsx("p",{className:"member-role"}),y.jsx("p",{})]}),y.jsxs("div",{className:"team-member",children:[y.jsx("div",{className:"member-avatar",children:""}),y.jsx("h4",{}),y.jsx("p",{className:"member-role"}),y.jsx("p",{})]}),y.jsxs("div",{className:"team-member",children:[y.jsx("div",{className:"member-avatar",children:""}),y.jsx("h4",{}),y.jsx("p",{className:"member-role"}),y.jsx("p",{children:"."})]}),y.jsxs("div",{className:"team-member",children:[y.jsx("div",{className:"member-avatar",children:""}),y.jsx("h4",{}),y.jsx("p",{className:"member-role"}),y.jsx("p",{children:"."})]})]})]}),y.jsxs("div",{className:"about-section impact-section",children:[y.jsx("h3",{children:"Our Impact"}),y.jsxs("div",{className:"impact-stats",children:[y.jsxs("div",{className:"impact-stat",children:[y.jsx("div",{className:"impact-number",children:"5"}),y.jsx("div",{className:"impact-label",children:"Active Projects"})]}),y.jsxs("div",{className:"impact-stat",children:[y.jsx("div",{className:"impact-number",children:"19"}),y.jsx("div",{className:"impact-label",children:"Carbon Credits Traded"})]}),y.jsxs("div",{className:"impact-stat",children:[y.jsx("div",{className:"impact-number",children:"50,0"}),y.jsx("div",{className:"impact-label",children:"Hectares Protected"})]}),y.jsxs("div",{className:"impact-stat",children:[y.jsx("div",{className:"impact-number",children:"3"}),y.jsx("div",{className:"impact-label",children:"Communities Supported"})]})]})]}),y.jsxs("div",{className:"about-cta",children:[y.jsx("h3",{children:"Join the Blue Carbon Revolution"}),y.jsx("p",{children:"Whether you're a coastal community looking to protect your ecosystem or a business seeking to offset your carbon footprint, we're here to help."}),y.jsxs("div",{className:"cta-buttons",children:[y.jsx(ft,{to:"/signup",className:"btn-primary",children:"Get Started"}),y.jsx(ft,{to:"/contact",className:"btn-secondary",children:"Contact Us"})]})]})]})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sae=1e-7,Eae=1e-4;let Nae=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},$B=class{refCount(e){return Sa("refCount")}incRef(e){return Sa("incRef")}timerAvailable(){return!0}time(e){return Sa("time")}read(e){return Sa("read")}readSync(e){return Sa("readSync")}readToGPU(e,t){return Sa("readToGPU")}numDataIds(){return Sa("numDataIds")}disposeData(e,t){return Sa("disposeData")}write(e,t,s){return Sa("write")}move(e,t,s,r,i){return Sa("move")}memory(){return Sa("memory")}floatPrecision(){return Sa("floatPrecision")}epsilon(){return this.floatPrecision()===32?Sae:Eae}dispose(){return Sa("dispose")}};function Sa(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AB(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,O0(n,e,t)}function Iae(n,e){if(n.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${n.length}Second array length was ${e.length}`);let t=n.length,s=0;for(;t>0;)s=Math.random()*t|0,t--,O0(n,t,s),O0(e,t,s)}function Ky(n,e,t){return Math.max(n,Math.min(e,t))}function Cae(n){return n%2===0?n:n+1}function O0(n,e,t){const s=n[e];n[e]=n[t],n[t]=s}function kae(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function $ae(n,e){const t=Math.random();return e*t+(1-t)*n}function Aae(n,e){let t=0;for(let s=0;s<n.length;s++){const r=Number(n[s])-Number(e[s]);t+=r*r}return t}function se(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function fi(n,e,t=""){se(ql(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function Vf(n){se(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function gf(n,e=[],t=!1){if(e==null&&(e=[]),Array.isArray(n)||Lr(n)&&!t)for(let s=0;s<n.length;++s)gf(n[s],e,t);else e.push(n);return e}function Xn(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function Rae(n){return n.length===0}function ql(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function bm(n){return n%1===0}function Dae(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{const e=Math.exp(2*n);return(e-1)/(e+1)}}function Lae(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function Oae(n){const e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return AB(e),e}function Dy(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function Pae(n,e=r=>0,t,s=setTimeout){return new Promise((r,i)=>{let a=0;const o=()=>{if(n()){r();return}a++;const l=e(a);if(t!=null&&a>=t){i();return}s(o,l)};o()})}function Mae(n,e){let t=1,s=-1;for(let i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(n[i]<0)throw Error(`Shapes can not be < 0. Found ${n[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const r=n.slice();return r[s]=e/t,r}function Lv(n,e){const t=e.length;return n=n==null?e.map((s,r)=>r):[].concat(n),se(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),se(n.every(s=>bm(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function RB(n,e){const t=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:Lv(e,n).sort();let a=0;for(let o=0;o<n.length;++o){if(i!=null){if(i[a]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(i[a]==null||i[a]>o)&&n[o]===1&&(t.push(n[o]),s.push(o)),i[a]<=o&&a++}n[o]!==1&&(t.push(n[o]),s.push(o))}return{newShape:t,keptDims:s}}function DB(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else throw new Error(`Unknown data type ${n}`);return t}function LB(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function OB(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function PB(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function Fae(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function Lr(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}function tI(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function MB(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function hh(n){return typeof n=="string"||n instanceof String}function FB(n){return typeof n=="boolean"}function jB(n){return typeof n=="number"}function Z1(n){return Array.isArray(n)?Z1(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":jB(n)?"float32":hh(n)?"string":FB(n)?"bool":"float32"}function Oh(n){return!!(n&&n.constructor&&n.call&&n.apply)}function P0(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Hm(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function BB(n,e,t,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let a=0;a<i;a++)r[a]=t[n+a]}else{const i=e[0],a=e.slice(1),o=a.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=BB(n+l*o,a,t,s)}return r}function tf(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((r,i)=>r*i)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return BB(0,n,e,t)}function Nk(n,e){const t=Y1(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function Y1(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function jae(n,e){const t=n.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return tf(n,new Float32Array(t));if(e==="int32")return tf(n,new Int32Array(t));if(e==="bool")return tf(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Ik(n){n.forEach(e=>{se(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function Bae(n,e,t){if(e===0)return 0;if(e===1)return n[0];let s=n[n.length-1];for(let r=0;r<n.length-1;++r)s+=t[r]*n[r];return s}function zae(n,e,t){if(e===0)return[];if(e===1)return[n];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(n/t[r]),n-=s[r]*t[r];return s[s.length-1]=n,s}function yf(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lM="tfjsflags";let zB=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Vae,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(At().getBool("IS_TEST")||At().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];At().getBool("IS_TEST")||At().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(yf(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);lM in e&&e[lM].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=Gae(r,i)})}};function Vae(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(Uae(e,s[0],s[1]),s.join("="))),e}function Uae(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Gae(n,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${n}.`)}function At(){return Ck}let Ck=null;function Wae(n){Ck=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let XE;function VB(){if(XE==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");XE=n}return XE}function Hae(){const n=VB();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function kk(n,e){const t=Hae();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const UB="Abs",GB="Acos",WB="Acosh",$k="Add",HB="AddN",qB="All",KB="Any",XB="ArgMax",ZB="ArgMin",YB="Asin",QB="Asinh",JB="Atan",ez="Atanh",tz="Atan2",nz="AvgPool",qae="AvgPoolGrad",sz="AvgPool3D",Kae="AvgPool3DGrad",rz="BatchMatMul",iz="BatchToSpaceND",az="Bincount",Xae="BroadcastTo",oz="BroadcastArgs",Ak="Cast",lz="Ceil",cz="ClipByValue",uz="Complex",hz="ComplexAbs",dz="Concat",fz="Conv2D",pz="Conv2DBackpropFilter",mz="Conv2DBackpropInput",gz="Conv3D",Zae="Conv3DBackpropFilterV2",yz="Conv3DBackpropInputV2",vz="Cos",bz="Cosh",_z="Cumprod",xz="Cumsum",wz="CropAndResize",Tz="DenseBincount",Sz="DepthToSpace",Ez="DepthwiseConv2dNative",Nz="DepthwiseConv2dNativeBackpropFilter",Iz="DepthwiseConv2dNativeBackpropInput",Cz="Diag",kz="Dilation2D",Yae="Dilation2DBackpropInput",Qae="Dilation2DBackpropFilter",$z="RealDiv",Az="Einsum",Rz="Elu",Jae="EluGrad",Dz="Erf",Lz="Equal",Oz="Exp",Pz="ExpandDims",Mz="Expm1",Fz="FFT",jz="Fill",Bz="FlipLeftRight",zz="Floor",Vz="FloorDiv",Uz="FusedBatchNorm",Gz="GatherV2",Wz="GatherNd",Hz="Greater",qz="GreaterEqual",Rk="Identity",Kz="IFFT",Xz="Imag",Zz="IsFinite",Yz="IsInf",Qz="IsNan",Jz="LeakyRelu",eV="Less",tV="LessEqual",nV="LinSpace",sV="Log",rV="Log1p",iV="LogicalAnd",aV="LogicalNot",oV="LogicalOr",eoe="LogicalXor",toe="LogSoftmax",noe="LowerBound",lV="LRN",soe="LRNGrad",cV="Max",uV="Maximum",hV="MaxPool",roe="MaxPoolGrad",dV="MaxPool3D",ioe="MaxPool3DGrad",fV="MaxPoolWithArgmax",pV="Mean",mV="Min",gV="Minimum",yV="MirrorPad",vV="Mod",bV="Multinomial",_V="Multiply",xV="Neg",wV="NotEqual",TV="NonMaxSuppressionV3",SV="NonMaxSuppressionV4",EV="NonMaxSuppressionV5",NV="OnesLike",IV="OneHot",CV="Pack",kV="PadV2",aoe="Pool",$V="Pow",AV="Prelu",RV="Prod",DV="RaggedGather",LV="RaggedTensorToTensor",OV="Range",PV="Real",MV="Reciprocal",FV="Relu",jV="Reshape",BV="ResizeNearestNeighbor",ooe="ResizeNearestNeighborGrad",zV="ResizeBilinear",loe="ResizeBilinearGrad",VV="Relu6",UV="Reverse",GV="Round",WV="Rsqrt",HV="ScatterNd",qV="SearchSorted",KV="Select",XV="Selu",ZV="Slice",YV="Sin",QV="Sinh",JV="Sign",eU="Sigmoid",tU="Softplus",nU="Sqrt",sU="Sum",rU="SpaceToBatchND",iU="SplitV",aU="Softmax",oU="SparseFillEmptyRows",lU="SparseReshape",cU="SparseSegmentMean",uU="SparseSegmentSum",hU="SparseToDense",dU="SquaredDifference",coe="Square",fU="StridedSlice",pU="StringNGrams",mU="StringSplit",gU="StringToHashBucketFast",yU="Sub",vU="Tan",bU="Tanh",Dk="Tile",_U="TopK",xU="Transform",e0="Transpose",wU="Unique",TU="Unpack",SU="UnsortedSegmentSum",uoe="UpperBound",EU="ZerosLike",NU="Step",nI="FromPixels",IU="RotateWithOffset",sI="_FusedMatMul",rI="FusedConv2D",iI="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ch(...n){At().getBool("IS_TEST")||At().getBool("PROD")||console.warn(...n)}function hoe(...n){At().getBool("IS_TEST")||At().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _m=kk("kernelRegistry",()=>new Map),Xy=kk("gradRegistry",()=>new Map);function M0(n,e){const t=Lk(n,e);return _m.get(t)}function aI(n){return Xy.get(n)}function F0(n){const e=_m.entries(),t=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,a]=r,[o]=i.split("_");o===n&&t.push(a)}return t}function CU(n){const{kernelName:e,backendName:t}=n,s=Lk(e,t);_m.has(s)&&ch(`The kernel '${e}' for backend '${t}' is already registered`),_m.set(s,n)}function doe(n){const{kernelName:e}=n;Xy.has(e)&&At().getBool("DEBUG")&&ch(`Overriding the gradient for '${e}'`),Xy.set(e,n)}function foe(n,e){const t=Lk(n,e);if(!_m.has(t))throw new Error(`The kernel '${n}' for backend '${e}' is not registered`);_m.delete(t)}function poe(n){if(!Xy.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);Xy.delete(n)}function moe(n,e){F0(n).forEach(s=>{const r=Object.assign({},s,{backendName:e});CU(r)})}function Lk(n,e){return`${e}_${n}`}var ZE,cM;function goe(){if(cM)return ZE;cM=1,ZE=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(B,D,W){this.low=B|0,this.high=D|0,this.unsigned=!!W}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(B){return(B&&B.__isLong__)===!0}e.isLong=t;var s={},r={};function i(B,D){var W,H,ae;return D?(B>>>=0,(ae=0<=B&&B<256)&&(H=r[B],H)?H:(W=o(B,(B|0)<0?-1:0,!0),ae&&(r[B]=W),W)):(B|=0,(ae=-128<=B&&B<128)&&(H=s[B],H)?H:(W=o(B,B<0?-1:0,!1),ae&&(s[B]=W),W))}e.fromInt=i;function a(B,D){if(isNaN(B))return D?C:E;if(D){if(B<0)return C;if(B>=x)return j}else{if(B<=-w)return O;if(B+1>=w)return U}return B<0?a(-B,D).neg():o(B%v|0,B/v|0,D)}e.fromNumber=a;function o(B,D,W){return new e(B,D,W)}e.fromBits=o;var l=Math.pow;function c(B,D,W){if(B.length===0)throw Error("empty string");if(B==="NaN"||B==="Infinity"||B==="+Infinity"||B==="-Infinity")return E;if(typeof D=="number"?(W=D,D=!1):D=!!D,W=W||10,W<2||36<W)throw RangeError("radix");var H;if((H=B.indexOf("-"))>0)throw Error("interior hyphen");if(H===0)return c(B.substring(1),D,W).neg();for(var ae=a(l(W,8)),te=E,Z=0;Z<B.length;Z+=8){var re=Math.min(8,B.length-Z),ne=parseInt(B.substring(Z,Z+re),W);if(re<8){var he=a(l(W,re));te=te.mul(he).add(a(ne))}else te=te.mul(ae),te=te.add(a(ne))}return te.unsigned=D,te}e.fromString=c;function h(B,D){return typeof B=="number"?a(B,D):typeof B=="string"?c(B,D):o(B.low,B.high,typeof D=="boolean"?D:B.unsigned)}e.fromValue=h;var p=65536,m=1<<24,v=p*p,x=v*v,w=x/2,T=i(m),E=i(0);e.ZERO=E;var C=i(0,!0);e.UZERO=C;var $=i(1);e.ONE=$;var R=i(1,!0);e.UONE=R;var P=i(-1);e.NEG_ONE=P;var U=o(-1,2147483647,!1);e.MAX_VALUE=U;var j=o(-1,-1,!0);e.MAX_UNSIGNED_VALUE=j;var O=o(0,-2147483648,!1);e.MIN_VALUE=O;var M=e.prototype;return M.toInt=function(){return this.unsigned?this.low>>>0:this.low},M.toNumber=function(){return this.unsigned?(this.high>>>0)*v+(this.low>>>0):this.high*v+(this.low>>>0)},M.toString=function(D){if(D=D||10,D<2||36<D)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(O)){var W=a(D),H=this.div(W),ae=H.mul(W).sub(this);return H.toString(D)+ae.toInt().toString(D)}else return"-"+this.neg().toString(D);for(var te=a(l(D,6),this.unsigned),Z=this,re="";;){var ne=Z.div(te),he=Z.sub(ne.mul(te)).toInt()>>>0,K=he.toString(D);if(Z=ne,Z.isZero())return K+re;for(;K.length<6;)K="0"+K;re=""+K+re}},M.getHighBits=function(){return this.high},M.getHighBitsUnsigned=function(){return this.high>>>0},M.getLowBits=function(){return this.low},M.getLowBitsUnsigned=function(){return this.low>>>0},M.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var D=this.high!=0?this.high:this.low,W=31;W>0&&(D&1<<W)==0;W--);return this.high!=0?W+33:W+1},M.isZero=function(){return this.high===0&&this.low===0},M.eqz=M.isZero,M.isNegative=function(){return!this.unsigned&&this.high<0},M.isPositive=function(){return this.unsigned||this.high>=0},M.isOdd=function(){return(this.low&1)===1},M.isEven=function(){return(this.low&1)===0},M.equals=function(D){return t(D)||(D=h(D)),this.unsigned!==D.unsigned&&this.high>>>31===1&&D.high>>>31===1?!1:this.high===D.high&&this.low===D.low},M.eq=M.equals,M.notEquals=function(D){return!this.eq(D)},M.neq=M.notEquals,M.ne=M.notEquals,M.lessThan=function(D){return this.comp(D)<0},M.lt=M.lessThan,M.lessThanOrEqual=function(D){return this.comp(D)<=0},M.lte=M.lessThanOrEqual,M.le=M.lessThanOrEqual,M.greaterThan=function(D){return this.comp(D)>0},M.gt=M.greaterThan,M.greaterThanOrEqual=function(D){return this.comp(D)>=0},M.gte=M.greaterThanOrEqual,M.ge=M.greaterThanOrEqual,M.compare=function(D){if(t(D)||(D=h(D)),this.eq(D))return 0;var W=this.isNegative(),H=D.isNegative();return W&&!H?-1:!W&&H?1:this.unsigned?D.high>>>0>this.high>>>0||D.high===this.high&&D.low>>>0>this.low>>>0?-1:1:this.sub(D).isNegative()?-1:1},M.comp=M.compare,M.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add($)},M.neg=M.negate,M.add=function(D){t(D)||(D=h(D));var W=this.high>>>16,H=this.high&65535,ae=this.low>>>16,te=this.low&65535,Z=D.high>>>16,re=D.high&65535,ne=D.low>>>16,he=D.low&65535,K=0,ie=0,pe=0,fe=0;return fe+=te+he,pe+=fe>>>16,fe&=65535,pe+=ae+ne,ie+=pe>>>16,pe&=65535,ie+=H+re,K+=ie>>>16,ie&=65535,K+=W+Z,K&=65535,o(pe<<16|fe,K<<16|ie,this.unsigned)},M.subtract=function(D){return t(D)||(D=h(D)),this.add(D.neg())},M.sub=M.subtract,M.multiply=function(D){if(this.isZero())return E;if(t(D)||(D=h(D)),n){var W=n.mul(this.low,this.high,D.low,D.high);return o(W,n.get_high(),this.unsigned)}if(D.isZero())return E;if(this.eq(O))return D.isOdd()?O:E;if(D.eq(O))return this.isOdd()?O:E;if(this.isNegative())return D.isNegative()?this.neg().mul(D.neg()):this.neg().mul(D).neg();if(D.isNegative())return this.mul(D.neg()).neg();if(this.lt(T)&&D.lt(T))return a(this.toNumber()*D.toNumber(),this.unsigned);var H=this.high>>>16,ae=this.high&65535,te=this.low>>>16,Z=this.low&65535,re=D.high>>>16,ne=D.high&65535,he=D.low>>>16,K=D.low&65535,ie=0,pe=0,fe=0,Ne=0;return Ne+=Z*K,fe+=Ne>>>16,Ne&=65535,fe+=te*K,pe+=fe>>>16,fe&=65535,fe+=Z*he,pe+=fe>>>16,fe&=65535,pe+=ae*K,ie+=pe>>>16,pe&=65535,pe+=te*he,ie+=pe>>>16,pe&=65535,pe+=Z*ne,ie+=pe>>>16,pe&=65535,ie+=H*K+ae*he+te*ne+Z*re,ie&=65535,o(fe<<16|Ne,ie<<16|pe,this.unsigned)},M.mul=M.multiply,M.divide=function(D){if(t(D)||(D=h(D)),D.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&D.low===-1&&D.high===-1)return this;var W=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,D.low,D.high);return o(W,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?C:E;var H,ae,te;if(this.unsigned){if(D.unsigned||(D=D.toUnsigned()),D.gt(this))return C;if(D.gt(this.shru(1)))return R;te=C}else{if(this.eq(O)){if(D.eq($)||D.eq(P))return O;if(D.eq(O))return $;var Z=this.shr(1);return H=Z.div(D).shl(1),H.eq(E)?D.isNegative()?$:P:(ae=this.sub(D.mul(H)),te=H.add(ae.div(D)),te)}else if(D.eq(O))return this.unsigned?C:E;if(this.isNegative())return D.isNegative()?this.neg().div(D.neg()):this.neg().div(D).neg();if(D.isNegative())return this.div(D.neg()).neg();te=E}for(ae=this;ae.gte(D);){H=Math.max(1,Math.floor(ae.toNumber()/D.toNumber()));for(var re=Math.ceil(Math.log(H)/Math.LN2),ne=re<=48?1:l(2,re-48),he=a(H),K=he.mul(D);K.isNegative()||K.gt(ae);)H-=ne,he=a(H,this.unsigned),K=he.mul(D);he.isZero()&&(he=$),te=te.add(he),ae=ae.sub(K)}return te},M.div=M.divide,M.modulo=function(D){if(t(D)||(D=h(D)),n){var W=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,D.low,D.high);return o(W,n.get_high(),this.unsigned)}return this.sub(this.div(D).mul(D))},M.mod=M.modulo,M.rem=M.modulo,M.not=function(){return o(~this.low,~this.high,this.unsigned)},M.and=function(D){return t(D)||(D=h(D)),o(this.low&D.low,this.high&D.high,this.unsigned)},M.or=function(D){return t(D)||(D=h(D)),o(this.low|D.low,this.high|D.high,this.unsigned)},M.xor=function(D){return t(D)||(D=h(D)),o(this.low^D.low,this.high^D.high,this.unsigned)},M.shiftLeft=function(D){return t(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?o(this.low<<D,this.high<<D|this.low>>>32-D,this.unsigned):o(0,this.low<<D-32,this.unsigned)},M.shl=M.shiftLeft,M.shiftRight=function(D){return t(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?o(this.low>>>D|this.high<<32-D,this.high>>D,this.unsigned):o(this.high>>D-32,this.high>=0?0:-1,this.unsigned)},M.shr=M.shiftRight,M.shiftRightUnsigned=function(D){if(t(D)&&(D=D.toInt()),D&=63,D===0)return this;var W=this.high;if(D<32){var H=this.low;return o(H>>>D|W<<32-D,W>>>D,this.unsigned)}else return D===32?o(W,0,this.unsigned):o(W>>>D-32,0,this.unsigned)},M.shru=M.shiftRightUnsigned,M.shr_u=M.shiftRightUnsigned,M.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},M.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},M.toBytes=function(D){return D?this.toBytesLE():this.toBytesBE()},M.toBytesLE=function(){var D=this.high,W=this.low;return[W&255,W>>>8&255,W>>>16&255,W>>>24,D&255,D>>>8&255,D>>>16&255,D>>>24]},M.toBytesBE=function(){var D=this.high,W=this.low;return[D>>>24,D>>>16&255,D>>>8&255,D&255,W>>>24,W>>>16&255,W>>>8&255,W&255]},e.fromBytes=function(D,W,H){return H?e.fromBytesLE(D,W):e.fromBytesBE(D,W)},e.fromBytesLE=function(D,W){return new e(D[0]|D[1]<<8|D[2]<<16|D[3]<<24,D[4]|D[5]<<8|D[6]<<16|D[7]<<24,W)},e.fromBytesBE=function(D,W){return new e(D[4]<<24|D[5]<<16|D[6]<<8|D[7],D[0]<<24|D[1]<<16|D[2]<<8|D[3],W)},ZE}var kU=goe();const Ok=yC(kU),$U=FX({__proto__:null,default:Ok},[kU]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wd=Ok||$U;function Ov(n){return Wd.fromString(n,!0,16)}const AU=Ov("c3a5c85c97cb3127"),Ud=Ov("b492b66fbe98f273"),ii=Ov("9ae16a3b2f90404f");function oI(n){return n.xor(n.shru(47))}function RU(n,e,t){const s=n.slice(e,e+t);return Wd.fromBytes(Array.from(s),!0,!0)}function jn(n,e){return RU(n,e,8)}function uM(n,e){return RU(n,e,4)}function ir(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function xh(n,e,t=Ov("9ddfea08eb382d69")){let s=n.xor(e).mul(t);s=s.xor(s.shru(47));let r=e.xor(s).mul(t);return r=r.xor(r.shru(47)),r=r.mul(t),r}function yoe(n,e,t,s,r,i){r=r.add(n),i=ir(i.add(r).add(s),21);const a=r;return r=r.add(e),r=r.add(t),i=i.add(ir(r,44)),[r.add(s),i.add(a)]}function Sx(n,e,t,s){return yoe(jn(n,e),jn(n,e+8),jn(n,e+16),jn(n,e+24),t,s)}function voe(n,e=n.length){if(e>=8){const t=ii.add(e*2),s=jn(n,0).add(ii),r=jn(n,e-8),i=ir(r,37).mul(t).add(s),a=ir(s,25).add(r).mul(t);return xh(i,a,t)}if(e>=4){const t=ii.add(e*2),s=uM(n,0);return xh(s.shl(3).add(e),uM(n,e-4),t)}if(e>0){const t=n[0],s=n[e>>1],r=n[e-1],i=t+(s<<8),a=e+(r<<2);return oI(ii.mul(i).xor(AU.mul(a))).mul(ii)}return ii}function boe(n,e=n.length){const t=ii.add(e*2),s=jn(n,0).mul(Ud),r=jn(n,8),i=jn(n,e-8).mul(t),a=jn(n,e-16).mul(ii);return xh(ir(s.add(r),43).add(ir(i,30)).add(a),s.add(ir(r.add(ii),18)).add(i),t)}function _oe(n,e=n.length){const t=ii.add(e*2),s=jn(n,0).mul(ii),r=jn(n,8),i=jn(n,e-8).mul(t),a=jn(n,e-16).mul(ii),o=ir(s.add(r),43).add(ir(i,30)).add(a),l=xh(o,s.add(ir(r.add(ii),18)).add(i),t),c=jn(n,16).mul(t),h=jn(n,24),p=o.add(jn(n,e-32)).mul(t),m=l.add(jn(n,e-24)).mul(t);return xh(ir(c.add(h),43).add(ir(p,30)).add(m),c.add(ir(h.add(s),18)).add(p),t)}function xoe(n,e=n.length){const t=Wd.fromNumber(81,!0);if(e<=32)return e<=16?voe(n,e):boe(n,e);if(e<=64)return _oe(n,e);let s=t,r=t.mul(Ud).add(113),i=oI(r.mul(ii).add(113)).mul(ii),a=[Wd.UZERO,Wd.UZERO],o=[Wd.UZERO,Wd.UZERO];s=s.mul(ii).add(jn(n,0));let l=0;const c=(e-1>>6)*64,h=c+(e-1&63)-63;do s=ir(s.add(r).add(a[0]).add(jn(n,l+8)),37).mul(Ud),r=ir(r.add(a[1]).add(jn(n,l+48)),42).mul(Ud),s=s.xor(o[1]),r=r.add(a[0]).add(jn(n,l+40)),i=ir(i.add(o[0]),33).mul(Ud),a=Sx(n,l,a[1].mul(Ud),s.add(o[0])),o=Sx(n,l+32,i.add(o[1]),r.add(jn(n,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const p=Ud.add(i.and(255).shl(1));return l=h,o[0]=o[0].add(e-1&63),a[0]=a[0].add(o[0]),o[0]=o[0].add(a[0]),s=ir(s.add(r).add(a[0]).add(jn(n,l+8)),37).mul(p),r=ir(r.add(a[1]).add(jn(n,l+48)),42).mul(p),s=s.xor(o[1].mul(9)),r=r.add(a[0].mul(9).add(jn(n,l+40))),i=ir(i.add(o[0]),33).mul(p),a=Sx(n,l,a[1].mul(p),s.add(o[0])),o=Sx(n,l+32,i.add(o[1]),r.add(jn(n,l+16))),[i,s]=[s,i],xh(xh(a[0],o[0],p).add(oI(r).mul(AU)).add(i),xh(a[1],o[1],p).add(s),p)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(n,e){return e==="string"?Pv(n):Q1([n],e)}function Toe(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function Q1(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=gf(n)),At().getBool("DEBUG")&&OB(n,e),Toe(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Zy(){return At().platform.now()}function Soe(n,e){return At().platform.fetch(n,e)}function Pv(n,e="utf-8"){return e=e||"utf-8",At().platform.encode(n,e)}function j0(n,e="utf-8"){return e=e||"utf-8",At().platform.decode(n,e)}const Eoe=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:ql,assert:se,assertNonNegativeIntegerDimensions:Ik,assertNonNull:Vf,assertShapesMatch:fi,bytesFromStringArray:MB,bytesPerElement:tI,checkConversionForErrors:OB,clamp:Ky,computeStrides:Hm,createScalarValue:woe,createShuffledIndices:Oae,decodeString:j0,distSquared:Aae,encodeString:Pv,fetch:Soe,fingerPrint64:xoe,flatten:gf,getArrayFromDType:LB,getTypedArrayFromDType:DB,hasEncodingLoss:Fae,hexToLong:Ov,indexToLoc:zae,inferDtype:Z1,inferFromImplicitShape:Mae,isBoolean:FB,isFunction:Oh,isInt:bm,isNumber:jB,isPromise:yf,isScalarShape:Rae,isString:hh,isTypedArray:Lr,isValidDtype:PB,locToIndex:Bae,makeOnesTypedArray:Nk,makeZerosNestedTypedArray:jae,makeZerosTypedArray:Y1,nearestDivisor:P0,nearestLargerEven:Cae,now:Zy,parseAxisParam:Lv,randUniform:$ae,repeatedTry:Pae,rightPad:Dy,shuffle:AB,shuffleCombo:Iae,sizeFromShape:Xn,sizeToSquarishShape:Lae,squeezeShape:RB,sum:kae,swap:O0,tanh:Dae,toNestedArray:tf,toTypedArray:Q1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Noe=class{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new Coe)}profileKernel(e,t,s){let r;const i=()=>{r=s()};let a;const o=Zy();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();a=Promise.resolve({kernelMs:Zy()-o})}if(At().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const h=r[c];h.data().then(p=>{Ioe(p,h.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then(c=>c.kernelMs),extraInfo:a.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:r,inputs:i,extraInfo:a}=e;s.forEach(o=>{Promise.all([o.data(),r,a]).then(l=>{this.logger.logKernelProfile(t,o,l[0],l[1],i,l[2])})})}};function Ioe(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${t}'`),!0}return!1}let Coe=class{logKernelProfile(e,t,s,r,i,a){const o=typeof r=="number"?Dy(`${r}ms`,9):r.error,l=Dy(e,25),c=t.rank,h=t.size,p=Dy(t.shape.toString(),14);let m="";for(const v in i){const x=i[v];if(x!=null){const w=x.shape||t.shape,T=w.length;m+=`${v}: ${T}D ${T>0?w:""} `}}console.log(`%c${l}	%c${o}	%c${c}D ${p}	%c${h}	%c${m}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(n,e,t){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<n.length;l++){const c=n[l],h=c.inputs;for(const p in h){const m=h[p];let v=!1;for(let x=0;x<e.length;x++)if(s[m.id]){c.outputs.forEach(w=>s[w.id]=!0),v=!0,r[c.id]=!0;break}if(v)break}}const i={};i[t.id]=!0;const a={};for(let l=n.length-1;l>=0;l--){const c=n[l],h=c.inputs;for(let p=0;p<c.outputs.length;p++)if(i[c.outputs[p].id]){for(const m in h)i[h[m].id]=!0,a[c.id]=!0;break}}const o=[];for(let l=0;l<n.length;l++){const c=n[l];if(r[c.id]&&a[c.id]){const h={};for(const m in c.inputs){const v=c.inputs[m];s[v.id]&&(h[m]=v)}const p=Object.assign({},c);p.inputs=h,p.outputs=c.outputs,o.push(p)}}return o}function $oe(n,e,t,s){for(let r=e.length-1;r>=0;r--){const i=e[r],a=[];if(i.outputs.forEach(l=>{const c=n[l.id];c!=null?a.push(c):a.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const o=i.gradient(a);for(const l in i.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const c=t(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const h=i.inputs[l];if(!ql(c.shape,h.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${h.shape}'`);if(n[h.id]==null)n[h.id]=c;else{const p=n[h.id];n[h.id]=s(p,c),p.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hM=20,iy=3,YE=7;function Aoe(n,e,t,s){const r=Hm(e),i=Roe(n,e,t,r),a=e.length,o=t0(n,e,t,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function Roe(n,e,t,s){const r=Xn(e),i=s[s.length-1],a=new Array(i).fill(0),o=e.length,l=t==="complex64"?by(n):n;if(o>1)for(let c=0;c<r/i;c++){const h=c*i;for(let p=0;p<i;p++)a[p]=Math.max(a[p],vy(l[h+p],0,t).length)}return a}function vy(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(YE))} + ${parseFloat(n[1].toFixed(YE))}j`:hh(n)?s=`'${n}'`:t==="bool"?s=DU(n):s=parseFloat(n.toFixed(YE)).toString(),Dy(s,e)}function DU(n){return n===0?"false":"true"}function t0(n,e,t,s,r,i=!0){const a=t==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(t==="complex64"){const w=by(n);return[vy(w[0],0,t)]}return t==="bool"?[DU(n[0])]:[n[0].toString()]}if(l===1){if(o>hM){const T=iy*a;let E=Array.from(n.slice(0,T)),C=Array.from(n.slice((o-iy)*a,o*a));return t==="complex64"&&(E=by(E),C=by(C)),["["+E.map(($,R)=>vy($,r[R],t)).join(", ")+", ..., "+C.map(($,R)=>vy($,r[o-iy+R],t)).join(", ")+"]"]}return["["+(t==="complex64"?by(n):Array.from(n)).map((T,E)=>vy(T,r[E],t)).join(", ")+"]"]}const c=e.slice(1),h=s.slice(1),p=s[0]*a,m=[];if(o>hM){for(let w=0;w<iy;w++){const T=w*p,E=T+p;m.push(...t0(n.slice(T,E),c,t,h,r,!1))}m.push("...");for(let w=o-iy;w<o;w++){const T=w*p,E=T+p;m.push(...t0(n.slice(T,E),c,t,h,r,w===o-1))}}else for(let w=0;w<o;w++){const T=w*p,E=T+p;m.push(...t0(n.slice(T,E),c,t,h,r,w===o-1))}const v=l===2?",":"";m[0]="["+m[0]+v;for(let w=1;w<m.length-1;w++)m[w]=" "+m[w]+v;let x=`,
`;for(let w=2;w<l;w++)x+=`
`;return m[m.length-1]=" "+m[m.length-1]+"]"+(i?"":x),m}function by(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let B0=class{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=Xn(e),s!=null){const r=s.length;se(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||LB(t,this.size),this.strides=Hm(e)}set(e,...t){t.length===0&&(t=[0]),se(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const r of e){if(r<0||r>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Po().makeTensor(this.values,this.shape,this.dtype)}},Po=null,Gp=null;function Doe(n){Po=n}function Loe(n){Gp=n}let os=class{constructor(e,t,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Xn(e),this.strides=Hm(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Gp.buffer(this.shape,this.dtype,e)}bufferSync(){return Gp.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return tf(this.shape,e,this.dtype==="complex64")}arraySync(){return tf(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Po().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>j0(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Po().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Po().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>j0(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Po().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(Po().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Gp.print(this,e)}clone(){return this.throwIfDisposed(),Gp.clone(this)}toString(e=!1){const t=this.dataSync();return Aoe(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Gp.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),Po().makeVariable(this,e,t,s)}};Object.defineProperty(os,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function Ooe(){return kk("Tensor",()=>os)}Ooe();let Yy=class extends os{constructor(e,t,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!ql(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Po().disposeTensor(this),this.dataId=e.dataId,Po().incRef(this,null)}dispose(){Po().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(Yy,Symbol.hasInstance,{value:n=>n instanceof os&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var lI;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(lI||(lI={}));var cI;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(cI||(cI={}));var uI;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(uI||(uI={}));var hI;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(hI||(hI={}));var dI;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(dI||(dI={}));const Poe={float32:hI,int32:cI,bool:uI,complex64:dI};function J1(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return Poe[n][e]}function Moe(n){return J1(n,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(n,e){if(n.dtype===e.dtype)return[n,e];const t=J1(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function LU(n,e){se(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function Foe(n,e){return e.some(t=>t.id===n.id)}function Pk(n){const e=[];return OU(n,e,new Set),e}function OU(n,e,t){if(n==null)return;if(n instanceof os){e.push(n);return}if(!joe(n))return;const s=n;for(const r in s){const i=s[r];t.has(i)||(t.add(i),OU(i,e,t))}}function joe(n){return Array.isArray(n)||typeof n=="object"}const Boe=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:LU,getTensorsInContainer:Pk,isTensorInList:Foe,makeTypesMatch:cs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QE(n){return n.kernelName!=null}let dM=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}},Mk=class fI{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new dM}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(ch(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Noe(this.backendInstance),!0}setupRegisteredKernels(){F0(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){F0(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof $B)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(a=>r<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,ch(`Initialization of backend ${e} failed`),ch(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return ch(`Initialization of backend ${e} failed`),ch(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),r=s.backend,i=this.readSync(t),a=r.refCount(t);r.disposeData(t,!0),s.backend=e,e.move(t,i,s.shape,s.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,s){e();try{const r=s();return t(),r}catch(r){throw t(),r}}nextTensorId(){return fI.nextTensorId++}nextVariableId(){return fI.nextVariableId++}clone(e){const t=de.runKernel(Rk,{x:e}),s={x:e},r=a=>({x:()=>{const o="float32",l={x:a},c={dtype:o};return de.runKernel(Ak,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[t],r,i,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(M0(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-i-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const r=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const c=QE(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(QE(e)){const{kernelName:x,inputs:w,attrs:T}=e;this.backendName==null&&this.backend;const E=M0(x,this.backendName);se(E!=null,()=>`Cannot find registered kernel '${x}' for backend '${this.backendName}'`),o=()=>{const C=this.backend.numDataIds();l=E.kernelFunc({inputs:w,attrs:T,backend:this.backend});const $=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(x,C,$);const R=$.map(P=>P.rank!=null?P:this.makeTensorFromTensorInfo(P));if(r){const P=this.getTensorsForGradient(x,w,R);s=this.saveTensorsForBackwardMode(P)}return R}}else{const{forwardFunc:x}=e,w=T=>{r&&(s=T.map(E=>this.keep(this.clone(E))))};o=()=>{const T=this.backend.numDataIds();l=this.tidy(()=>x(this.backend,w));const E=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,T,E),E}}const{inputs:h,attrs:p}=e,m=QE(e)?null:e.backwardsFunc;let v;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=o():(v=this.profiler.profileKernel(c,h,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(v),t=v.outputs)}),r&&this.addTapeNode(c,h,t,m,s,p),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(x=>h[x]!=null?h[x].shape:null),outputShapes:t.map(x=>x.shape),kernelTimeMs:v.timeMs,extraInfo:v.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const r=aI(e);if(r!=null){const i=r.inputsToSave||[],a=r.outputsToSave||[];let o;r.saveAllInputs?(se(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(c=>t[c])):o=i.map(c=>t[c]);const l=s.filter((c,h)=>a[h]);return o.concat(l)}return[]}makeTensor(e,t,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&hh(e[0])&&(i=e.map(l=>Pv(l)));const a=r.write(i,t,s),o=new os(t,s,a,this.nextTensorId());if(this.trackTensor(o,r),s==="string"){const l=this.state.tensorInfo.get(a),c=MB(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(e,t,s,r){s=s||"float32";const i={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:r,dtype:i}=e,a=new os(r,i,s,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new Yy(e,t,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*tI(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof Yy||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*tI(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,r,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:i},l=aI(e);l!=null&&(r=l.gradFunc),r!=null&&(o.gradient=c=>(c=c.map((h,p)=>{if(h==null){const m=s[p],v=Y1(m.size,m.dtype);return this.makeTensor(v,m.shape,m.dtype)}return h}),r(c.length>1?c:c[0],i,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=Pk(e),s=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const a=this.state.activeScope.track[i];!a.kept&&!s.has(a.id)&&a.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,t,s,r=!1){if(se(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));se(i instanceof os,()=>"The result y returned by f() must be a tensor.");const a=koe(this.state.activeTape,t,i);if(!r&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[i.id]=s??zoe(i.shape),$oe(o,a,c=>this.tidy(c),Voe);const l=t.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const h of c.saved)h.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return se(Oh(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{se(t.every(o=>o instanceof os),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};t.forEach((o,l)=>{r[l]=o});const i=(o,l)=>(s=e(...t,l),se(s.value instanceof os,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),se(Oh(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),a=(o,l)=>{const c=s.gradFunc(o,l),h=Array.isArray(c)?c:[c];se(h.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),se(h.every(m=>m instanceof os),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const p={};return h.forEach((m,v)=>{p[v]=()=>m}),p};return this.runKernelFunc({forwardFunc:i,backwardsFunc:a,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Zy(),s=await this.backend.time(e);return s.wallMs=Zy()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new dM;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};Mk.nextTensorId=0;Mk.nextVariableId=0;function zoe(n){const e=Nk(Xn(n),"float32");return de.makeTensor(e,n,"float32")}function PU(){const n=VB();if(n._tfengine==null){const e=new zB(n);n._tfengine=new Mk(e)}return Wae(n._tfengine.ENV),Doe(()=>n._tfengine),n._tfengine}const de=PU();function Voe(n,e){const t={a:n,b:e};return de.runKernel($k,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(){return typeof navigator<"u"&&navigator!=null}let pI;function Goe(n){pI=n}function Woe(n){if(pI!==void 0)return pI;if(n||Uoe()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function MU(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const Hoe=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:MU,isMobile:Woe,mockIsMobile:Goe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sa=At();sa.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});sa.registerFlag("IS_BROWSER",()=>MU());sa.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");sa.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));sa.registerFlag("PROD",()=>!1);sa.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>sa.getBool("DEBUG"));sa.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);sa.registerFlag("IS_TEST",()=>!1);sa.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);sa.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);sa.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);sa.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);sa.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kl(n,e){let t=n;if(Lr(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||Lr(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&At().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&FU(n,s,[]),s}function FU(n,e,t){if(t=t||[],!Array.isArray(n)&&!Lr(n)){se(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}se(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),se(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let r=0;r<n.length;++r)FU(n[r],s,t.concat(r))}function fM(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function Q(n,e,t,s="numeric"){if(n instanceof os)return fM(s,n.dtype,e,t),n;let r=Z1(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),fM(s,r,e,t),n==null||!Lr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Kl(n,r);!Lr(n)&&!Array.isArray(n)&&(n=[n]);const o=r!=="string"?Q1(n,r):gf(n,[],!0);return de.makeTensor(o,i,r)}function Qy(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,a)=>Q(i,`${e}[${a}]`,t,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fk="__op";function ue(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+Fk;const r=(...i)=>{de.startScope(t);try{const a=s(...i);return yf(a)&&console.error("Cannot return a Promise inside of tidy."),de.endScope(a),a}catch(a){throw de.endScope(null),a}};return Object.defineProperty(r,"name",{value:t,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qoe(n,e){const t=Q(n,"real","complex"),s=Q(e,"imag","complex");fi(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:t,imag:s};return de.runKernel(uz,r)}const Jc=ue({complex_:qoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zh(n,e,t,s){if(s==null&&(s=Z1(n)),s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Lr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Ik(e);const r=Xn(e),i=Xn(t);se(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let a=0;a<t.length;++a){const o=t[a],l=a===t.length-1?o!==Xn(e.slice(a)):!0;se(t[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!Lr(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?Q1(n,s):gf(n,[],!0),de.makeTensor(n,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vo(n,e,t){const s=Kl(n,t);return Zh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mI={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z0=4;async function Koe(n,e){const t=[],s=[],r=Array.isArray(n)?n.map(a=>a.name):Object.keys(n);for(let a=0;a<r.length;++a){const o=r[a],l=Array.isArray(n)?n[a].tensor:n[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const h=new Promise(async p=>{const m=await l.bytes(),v=m.reduce((T,E)=>T+E.length,0)+z0*m.length,x=new Uint8Array(v);let w=0;for(let T=0;T<m.length;T++){const E=m[T],C=new Uint8Array(new Uint32Array([E.length]).buffer);x.set(C,w),w+=z0,x.set(E,w),w+=E.length}p(x)});s.push(h)}else s.push(l.data());e!=null&&(c.group=e),t.push(c)}const i=await Promise.all(s);return{data:Xoe(i),specs:t}}function jU(n,e){const t={};let s,r=0;for(const i of e){const a=i.name,o=i.dtype,l=i.shape,c=Xn(l);let h;if("quantization"in i){const p=i.quantization;if(p.dtype==="uint8"||p.dtype==="uint16"){if(!("min"in p&&"scale"in p))throw new Error(`Weight ${i.name} with quantization ${p.dtype} doesn't have corresponding metadata min and scale.`)}else if(p.dtype==="float16"){if(o!=="float32")throw new Error(`Weight ${i.name} is quantized with ${p.dtype} which only supports weights of type float32 not ${o}.`)}else throw new Error(`Weight ${i.name} has unknown quantization dtype ${p.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const m=mI[p.dtype],v=n.slice(r,r+c*m),x=p.dtype==="uint8"?new Uint8Array(v):new Uint16Array(v);if(o==="float32")if(p.dtype==="uint8"||p.dtype==="uint16"){h=new Float32Array(x.length);for(let w=0;w<x.length;w++){const T=x[w];h[w]=T*p.scale+p.min}}else if(p.dtype==="float16")s===void 0&&(s=tle()),h=s(x);else throw new Error(`Unsupported quantization type ${p.dtype} for weight type float32.`);else if(o==="int32"){if(p.dtype!=="uint8"&&p.dtype!=="uint16")throw new Error(`Unsupported quantization type ${p.dtype} for weight type int32.`);h=new Int32Array(x.length);for(let w=0;w<x.length;w++){const T=x[w];h[w]=Math.round(T*p.scale+p.min)}}else throw new Error(`Unsupported dtype in weight '${a}': ${o}`);r+=c*m}else if(o==="string"){const p=Xn(i.shape);h=[];for(let m=0;m<p;m++){const v=new Uint32Array(n.slice(r,r+z0))[0];r+=z0;const x=new Uint8Array(n.slice(r,r+v));h.push(x),r+=v}}else{const p=mI[o],m=n.slice(r,r+c*p);if(o==="float32")h=new Float32Array(m);else if(o==="int32")h=new Int32Array(m);else if(o==="bool")h=new Uint8Array(m);else if(o==="complex64"){h=new Float32Array(m);const v=new Float32Array(h.length/2),x=new Float32Array(h.length/2);for(let E=0;E<v.length;E++)v[E]=h[E*2],x[E]=h[E*2+1];const w=Vo(v,l,"float32"),T=Vo(x,l,"float32");t[a]=Jc(w,T),w.dispose(),T.dispose()}else throw new Error(`Unsupported dtype in weight '${a}': ${o}`);r+=c*p}o!=="complex64"&&(t[a]=Vo(h,l,o))}return t}function Xoe(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return t.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const jk=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function pM(n){return jk?Buffer.byteLength(n):new Blob([n]).size}function Zoe(n){if(jk)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,r=e.length;s<r;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function Yoe(n){if(jk){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function Bk(n){if(n.length===1)return n[0];let e=0;n.forEach(r=>{e+=r.byteLength});const t=new Uint8Array(e);let s=0;return n.forEach(r=>{t.set(new Uint8Array(r),s),s+=r.byteLength}),t.buffer}function mM(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);const t=n.split("/");return t[t.length-1]}function BU(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function zU(n,e,t){const s={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(s.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=t}return n.signature!=null&&(s.signature=n.signature),n.userDefinedMetadata!=null&&(s.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(s.modelInitializer=n.modelInitializer),s}async function zk(n,e){let t,s;return n.weightsManifest!=null&&([t,s]=await e(n.weightsManifest)),zU(n,t,s)}function Mv(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:pM(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:pM(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}function VU(n){const e=[];for(const t of n)e.push(...t.weights);return e}function Qoe(){const n=t=>{let s=t<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function Joe(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function ele(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function tle(){const n=Qoe(),e=Joe(),t=ele();return s=>{const r=new ArrayBuffer(4*s.length),i=new Uint32Array(r);for(let a=0;a<s.length;a++){const o=s[a],l=n[t[o>>10]+(o&1023)]+e[o>>10];i[a]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Aa=class Lo{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Lo.instance==null&&(Lo.instance=new Lo),Lo.instance}static registerSaveRouter(e){Lo.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Lo.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Lo.getHandlers(e,"save")}static getLoadHandlers(e,t){return Lo.getHandlers(e,"load",t)}static getHandlers(e,t,s){const r=[];return(t==="load"?Lo.getInstance().loadRouters:Lo.getInstance().saveRouters).forEach(a=>{const o=a(e,s);o!==null&&r.push(o)}),r}};const nle=n=>Aa.registerSaveRouter(n),sle=n=>Aa.registerLoadRouter(n),rle=n=>Aa.getSaveHandlers(n),ile=(n,e)=>Aa.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gI="tensorflowjs",yI=1,Zd="models_store",dh="model_info_store";function UU(){if(!At().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function vI(n){const e=n.result;e.createObjectStore(Zd,{keyPath:"modelPath"}),e.createObjectStore(dh,{keyPath:"modelPath"})}let vf=class{constructor(e){if(this.indexedDB=UU(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,r)=>{const i=this.indexedDB.open(gI,yI);i.onupgradeneeded=()=>vI(i),i.onsuccess=()=>{const a=i.result;if(t==null){const o=a.transaction(Zd,"readonly"),c=o.objectStore(Zd).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return a.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=h=>(a.close(),r(c.error)),o.oncomplete=()=>a.close()}else{const o=Mv(t),l=a.transaction(dh,"readwrite");let c=l.objectStore(dh);const h=c.put({modelPath:this.modelPath,modelArtifactsInfo:o});let p;h.onsuccess=()=>{p=a.transaction(Zd,"readwrite");const v=p.objectStore(Zd).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o});v.onsuccess=()=>s({modelArtifactsInfo:o}),v.onerror=x=>{c=l.objectStore(dh);const w=c.delete(this.modelPath);w.onsuccess=()=>(a.close(),r(v.error)),w.onerror=T=>(a.close(),r(v.error))}},h.onerror=m=>(a.close(),r(h.error)),l.oncomplete=()=>{p==null?a.close():p.oncomplete=()=>a.close()}}},i.onerror=a=>r(i.error)})}};vf.URL_SCHEME="indexeddb://";const GU=n=>At().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(vf.URL_SCHEME)?ale(n.slice(vf.URL_SCHEME.length)):null;Aa.registerSaveRouter(GU);Aa.registerLoadRouter(GU);function ale(n){return new vf(n)}function ole(n){return n.startsWith(vf.URL_SCHEME)?n.slice(vf.URL_SCHEME.length):n}let lle=class{constructor(){this.indexedDB=UU()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(gI,yI);s.onupgradeneeded=()=>vI(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(dh,"readonly"),o=i.objectStore(dh).getAll();o.onsuccess=()=>{const l={};for(const c of o.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},o.onerror=l=>(r.close(),t(o.error)),i.oncomplete=()=>r.close()},s.onerror=r=>t(s.error)})}async removeModel(e){return e=ole(e),new Promise((t,s)=>{const r=this.indexedDB.open(gI,yI);r.onupgradeneeded=()=>vI(r),r.onsuccess=()=>{const i=r.result,a=i.transaction(dh,"readwrite"),o=a.objectStore(dh),l=o.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const h=o.delete(e),p=()=>{c=i.transaction(Zd,"readwrite");const v=c.objectStore(Zd).delete(e);v.onsuccess=()=>t(l.result.modelArtifactsInfo),v.onerror=x=>s(l.error)};h.onsuccess=p,h.onerror=m=>(p(),i.close(),s(l.error))}},l.onerror=h=>(i.close(),s(l.error)),a.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fc="/",Wp="tensorflowjs_models",WU="info",cle="model_topology",ule="weight_specs",hle="weight_data",dle="model_metadata";function HU(n){return{info:[Wp,n,WU].join(Fc),topology:[Wp,n,cle].join(Fc),weightSpecs:[Wp,n,ule].join(Fc),weightData:[Wp,n,hle].join(Fc),modelMetadata:[Wp,n,dle].join(Fc)}}function qU(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function fle(n){const e=n.split(Fc);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(Fc)}function ple(n){return n.startsWith(bf.URL_SCHEME)?n.slice(bf.URL_SCHEME.length):n}let bf=class{constructor(e){if(!At().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=HU(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=Mv(e);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,Zoe(e.weightData));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw qU(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const o=JSON.parse(i);t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,o.signature!=null&&(t.signature=o.signature),o.userDefinedMetadata!=null&&(t.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(t.modelInitializer=o.modelInitializer),o.trainingConfig!=null&&(t.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=Yoe(a),t}};bf.URL_SCHEME="localstorage://";const KU=n=>At().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(bf.URL_SCHEME)?mle(n.slice(bf.URL_SCHEME.length)):null;Aa.registerSaveRouter(KU);Aa.registerLoadRouter(KU);function mle(n){return new bf(n)}let gle=class{constructor(){se(At().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),se(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=Wp+Fc,s=Fc+WU;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(t)&&i.endsWith(s)){const a=fle(i);e[a]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=ple(e);const t=HU(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return qU(t),s}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rm="://";let Ph=class th{constructor(){this.managers={}}static getInstance(){return th.instance==null&&(th.instance=new th),th.instance}static registerManager(e,t){se(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(rm)&&(e=e.slice(0,e.indexOf(rm))),se(e.length>0,()=>"scheme must not be an empty string.");const s=th.getInstance();se(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=th.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(th.getInstance().managers)}};function n0(n){if(n.indexOf(rm)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Ph.getSchemes().join(",")}`);return{scheme:n.split(rm)[0],path:n.split(rm)[1]}}async function XU(n,e,t=!1){se(n!==e,()=>`Old path and new path are the same: '${n}'`);const s=Aa.getLoadHandlers(n);se(s.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),se(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${n}.`);const r=s[0],i=Aa.getSaveHandlers(e);se(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),se(i.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const a=i[0],o=n0(n).scheme,l=n0(n).path,c=o===n0(n).scheme,h=await r.load();t&&c&&await Ph.getManager(o).removeModel(l);const p=await a.save(h);return t&&!c&&await Ph.getManager(o).removeModel(l),p.modelArtifactsInfo}async function yle(){const n=Ph.getSchemes(),e={};for(const t of n){const s=await Ph.getManager(t).listModels();for(const r in s){const i=t+rm+r;e[i]=s[r]}}return e}async function vle(n){const e=n0(n);return Ph.getManager(e.scheme).removeModel(e.path)}async function ble(n,e){return XU(n,e,!1)}async function _le(n,e){return XU(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xle=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(!window||!At().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}};if(At().get("IS_BROWSER")){At().setPlatform("browser",new xle);try{Ph.registerManager(bf.URL_SCHEME,new gle)}catch{}try{Ph.registerManager(vf.URL_SCHEME,new lle)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wle={importFetch:()=>require("node-fetch")};let JE,Tle=class{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return At().global.fetch!=null?At().global.fetch(e,t):(JE==null&&(JE=wle.importFetch()),JE(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}};At().get("IS_NODE")&&!At().get("IS_BROWSER")&&At().setPlatform("node",new Tle);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ko(n,e="float32",t){return e=e||"float32",Ik(n),new B0(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sle(n,e){const t=Q(n,"x","cast");if(!PB(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},r={dtype:e};return de.runKernel(Ak,s,r)}const es=ue({cast_:Sle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ele(n){const t={x:Q(n,"x","clone","string_or_numeric")};return de.runKernel(Rk,t)}const Hc=ue({clone_:Ele});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vk(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */PU();const Nle={buffer:Ko,cast:es,clone:Hc,print:Vk};Loe(Nle);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile="model",Cle=".json",kle=".weights.bin";function gM(n){return new Promise(e=>setTimeout(e)).then(n)}class _f{constructor(e){if(!At().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(_f.URL_SCHEME)&&(e=e.slice(_f.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Ile),this.modelJsonFileName=e+Cle,this.weightDataFileName=e+kle}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r=BU(e,s),i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await gM(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const o=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;o.download=this.weightDataFileName,o.href=t,await gM(()=>o.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Mv(e)}}}}_f.URL_SCHEME="downloads://";class $le{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const s=new FileReader;s.onload=r=>{const i=JSON.parse(r.target.result),a=i.modelTopology;if(a==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:a});return}const l=zk(i,c=>this.loadWeights(c));e(l)},s.onerror=r=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const t=[],s=[];for(const a of e)t.push(...a.weights),s.push(...a.paths);const r=this.checkManifestAndWeightFiles(e),i=s.map(a=>this.loadWeightsFile(a,r[a]));return Promise.all(i).then(a=>[t,Bk(a)])}loadWeightsFile(e,t){return new Promise((s,r)=>{const i=new FileReader;i.onload=a=>{const o=a.target.result;s(o)},i.onerror=a=>r(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],s=this.weightsFiles.map(i=>mM(i.name)),r={};for(const i of e)i.paths.forEach(a=>{const o=mM(a);if(t.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(t.push(o),s.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);r[a]=this.weightsFiles[s.indexOf(o)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const Ale=n=>At().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(_f.URL_SCHEME)?Rle(n.slice(_f.URL_SCHEME.length)):null;Aa.registerSaveRouter(Ale);function Rle(n="model"){return new _f(n)}function Dle(n){return new $le(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yM(n,e,t,s){a(n),t=t??0,s=s??1,o(t,s);let r=0;const i=l=>(l.then(c=>{const h=t+ ++r/n.length*(s-t);return e(h),c}),l);function a(l){se(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,c){se(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),se(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),se(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(n.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ZU(n,e){e==null&&(e={});const t=e.fetchFunc==null?At().platform.fetch:e.fetchFunc,s=n.map(p=>t(p,e.requestInit,{isBinary:!0})),o=(e.onProgress==null?await Promise.all(s):await yM(s,e.onProgress,0,.5)).map(p=>p.arrayBuffer());return e.onProgress==null?await Promise.all(o):await yM(o,e.onProgress,.5,1)}async function Lle(n,e="",t,s){return YU(a=>ZU(a,{requestInit:s}))(n,e,t)}function YU(n){return async(e,t="",s)=>{const r=e.map(()=>!1),i={},a=s!=null?s.map(()=>!1):[],o=[];if(e.forEach((v,x)=>{let w=0;v.weights.forEach(T=>{const E="quantization"in T?T.quantization.dtype:T.dtype,C=mI[E]*Xn(T.shape),$=()=>{r[x]=!0,i[x]==null&&(i[x]=[]),i[x].push({manifestEntry:T,groupOffset:w,sizeBytes:C})};s!=null?s.forEach((R,P)=>{R===T.name&&($(),a[P]=!0)}):$(),o.push(T.name),w+=C})}),!a.every(v=>v)){const v=s.filter((x,w)=>!a[w]);throw new Error(`Could not find weights in manifest with names: ${v.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=r.reduce((v,x,w)=>(x&&v.push(w),v),[]),c=[];l.forEach(v=>{e[v].paths.forEach(x=>{const w=t+(t.endsWith("/")?"":"/")+x;c.push(w)})});const h=await n(c),p={};let m=0;return l.forEach(v=>{const x=e[v].paths.length;let w=0;for(let R=0;R<x;R++)w+=h[m+R].byteLength;const T=new ArrayBuffer(w),E=new Uint8Array(T);let C=0;for(let R=0;R<x;R++){const P=new Uint8Array(h[m+R]);E.set(P,C),C+=P.byteLength}i[v].forEach(R=>{const P=T.slice(R.groupOffset,R.groupOffset+R.sizeBytes),U=jU(P,[R.manifestEntry]);for(const j in U)p[j]=U[j]}),m+=x}),p}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole="application/octet-stream",Ple="application/json";class Uk{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(se(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=At().platform.fetch,se(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&se(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=BU(e,s);t.body.append("model.json",new Blob([JSON.stringify(r)],{type:Ple}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:Ole}),"model.weights.bin");const i=await this.fetch(this.path,t);if(i.ok)return{modelArtifactsInfo:Mv(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const s=t.modelTopology,r=t.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return zk(t,i=>this.loadWeights(i))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=Mle(t),i=this.weightPathPrefix||s,a=VU(e),o=[],l=[];for(const h of e)for(const p of h.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(p)):o.push(i+p+r);this.weightUrlConverter&&o.push(...await Promise.all(l));const c=await ZU(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,Bk(c)]}}Uk.URL_SCHEME_REGEX=/^https?:\/\//;function Mle(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),s=n.substring(0,e),r=t>e?n.substring(t):"";return[s+"/",r]}function bI(n){return n.match(Uk.URL_SCHEME_REGEX)!=null}const QU=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(s=>bI(s)):t=bI(n),t)return Gk(n,e)}return null};Aa.registerSaveRouter(QU);Aa.registerLoadRouter(QU);function Gk(n,e){return new Uk(n,e)}function Fle(n,e){return Gk(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eN{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class JU{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class jle{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function Ble(n,e,t,s){const r=arguments;return new jle(e6(...r))}function e6(n,e,t,s){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new eN(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new eN({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new eN({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:s}))}function zle(n){return new JU(n)}function Vle(n){return new JU(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wk=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:Dle,browserHTTPRequest:Fle,concatenateArrayBuffers:Bk,copyModel:ble,decodeWeights:jU,encodeWeights:Koe,fromMemory:Ble,fromMemorySync:e6,getLoadHandlers:ile,getModelArtifactsForJSON:zk,getModelArtifactsForJSONSync:zU,getModelArtifactsInfoForJSON:Mv,getSaveHandlers:rle,getWeightSpecs:VU,http:Gk,isHTTPScheme:bI,listModels:yle,loadWeights:Lle,moveModel:_le,registerLoadRouter:sle,registerSaveRouter:nle,removeModel:vle,weightsLoaderFactory:YU,withSaveHandler:zle,withSaveHandlerSync:Vle},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ule(n,e,t=!1,s=!1){let r=Q(n,"a","matMul"),i=Q(e,"b","matMul");[r,i]=cs(r,i);const a={a:r,b:i},o={transposeA:t,transposeB:s};return de.runKernel(rz,a,o)}const Sn=ue({matMul_:Ule});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gle(n,e,t=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:Q(n,"indices","oneHot","int32")},o={dtype:r,depth:e,onValue:t,offValue:s};return de.runKernel(IV,a,o)}const V0=ue({oneHot_:Gle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wle(){At().set("PROD",!0)}function Hle(){At().set("DEBUG",!0)}function qle(){At().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Kle(n){At().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Xle(){de.disposeVariables()}function Zle(){return de}function Yle(){return de.memory()}function Qle(n){return de.profile(n)}function pn(n,e){return de.tidy(n,e)}function Mr(n){Pk(n).forEach(t=>t.dispose())}function Cl(n){return de.keep(n)}function Jle(n){return de.time(n)}function ece(n){return de.setBackend(n)}function tce(){return de.ready()}function nce(){return de.backendName}function sce(n){de.removeBackend(n)}function rce(n){return de.findBackend(n)}function ice(n){return de.findBackendFactory(n)}function ace(n,e,t=1){return de.registerBackend(n,e,t)}function oce(){return de.backend}function lce(n,e){At().setPlatform(n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cce(n){const t={input:Q(n,"input","imag")};return de.runKernel(Xz,t)}const Fv=ue({imag_:cce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(n){const t={x:Q(n,"x","neg")};return de.runKernel(xV,t)}const Ml=ue({neg_:uce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(n){const t={input:Q(n,"input","real")};return de.runKernel(PV,t)}const xm=ue({real_:hce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(n,e,t){const s=Q(n,"x","transpose");if(e==null&&(e=s.shape.map((a,o)=>o).reverse()),se(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(a=>{se(a>=0&&a<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?pn(()=>{let a=xm(s),o=Fv(s);return a=de.runKernel(e0,{x:a},i),o=de.runKernel(e0,{x:o},i),t&&(o=Ml(o)),Jc(a,o)}):de.runKernel(e0,r,i)}const Jy=ue({transpose_:dce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(n,e,t){const s=Q(n,"labels","confusionMatrix"),r=Q(e,"predictions","confusionMatrix");se(t==null||t>0&&Number.isInteger(t),()=>`If provided, numClasses must be a positive integer, but got ${t}`),se(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),se(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),se(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),se(t>0&&Number.isInteger(t),()=>`numClasses is required to be a positive integer, but got ${t}`);const i=V0(es(s,"int32"),t),a=V0(es(r,"int32"),t),o=Jy(i),l=Sn(o,a);return es(l,"int32")}const pce=ue({confusionMatrix_:fce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mce=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:pce},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t6(n,e){const t=n.length,s=[];for(let r=0;r<t;r++){const i=t-1-r,a=n[i]||1;(e[e.length-1-r]||1)>1&&a===1&&s.unshift(i)}return s}function Hk(n,e){const t=[];for(let s=0;s<e.length;s++){const r=n[n.length-s-1],i=e.length-s-1,a=e[i];(r==null||r===1&&a>1)&&t.unshift(i)}return t}function Fs(n,e){const t=[],s=Math.max(n.length,e.length);for(let r=0;r<s;r++){let i=n[n.length-r-1];i==null&&(i=1);let a=e[e.length-r-1];if(a==null&&(a=1),i===1)t.unshift(a);else if(a===1)t.unshift(i);else if(i!==a){const o=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(o)}else t.unshift(i)}return t}const gce=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Fs,getBroadcastDims:t6,getReductionAxes:Hk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qk(n,e,t){if(Vf(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Kl(n,t);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Zh(n,e,s,t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let jd;function n6(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,s=!1,r=!1,i=!1,a=!1,o=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)i=!0;else if(n.getContext!=null)a=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(M0(nI,de.backendName)!=null){const x={pixels:n},w={numChannels:e};return de.runKernel(nI,x,w)}const[c,h]=r?[n.videoWidth,n.videoHeight]:[n.width,n.height];let p;if(a)p=n.getContext("2d").getImageData(0,0,c,h).data;else if(s||t)p=n.data;else if(i||r||o){if(jd==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")jd=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else jd=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});jd.canvas.width=c,jd.canvas.height=h,jd.drawImage(n,0,0,c,h),p=jd.getImageData(0,0,c,h).data}let m;if(e===4)m=new Int32Array(p);else{const x=c*h;m=new Int32Array(x*e);for(let w=0;w<x;w++)for(let T=0;T<e;++T)m[w*e+T]=p[w*4+T]}return qk(m,[h,c,e],"int32")}function yce(n){return n!=null&&n.data instanceof Uint8Array}function vce(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function bce(n){return n!=null&&n.width!==0&&n.height!==0}function _ce(n){return vce()&&!(n instanceof ImageBitmap)&&bce(n)&&!yce(n)}async function xce(n,e=3){let t=null;if(At().getBool("WRAP_TO_IMAGEBITMAP")&&_ce(n)){let s;try{s=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===n.width&&s.height===n.height?t=s:t=n}else t=n;return n6(t,e)}async function s6(n,e){let t=Q(n,"img","toPixels");if(!(n instanceof os)){const c=t;t=es(c,"int32"),c.dispose()}if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const[s,r]=t.shape.slice(0,2),i=t.rank===2?1:t.shape[2];if(i>4||i===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${i}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`);const a=await t.data(),o=t.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let c=0;c<s*r;++c){const h=[0,0,0,255];for(let m=0;m<i;m++){const v=a[c*i+m];if(t.dtype==="float32"){if(v<0||v>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${v}.`)}else if(t.dtype==="int32"&&(v<0||v>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${v}.`);i===1?(h[0]=v*o,h[1]=v*o,h[2]=v*o):h[m]=v*o}const p=c*4;l[p+0]=Math.round(h[0]),l[p+1]=Math.round(h[1]),l[p+2]=Math.round(h[2]),l[p+3]=Math.round(h[3])}if(e!=null){e.width=r,e.height=s;const c=e.getContext("2d"),h=new ImageData(l,r,s);c.putImageData(h,0,0)}return t!==n&&t.dispose(),l}const r6=ue({fromPixels_:n6}),wce=Object.freeze(Object.defineProperty({__proto__:null,fromPixels:r6,fromPixelsAsync:xce,toPixels:s6},Symbol.toStringTag,{value:"Module"}));function i6(n,e){const t=n.shape.length,s=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${t}`);if(Xn(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const r=e.shape,i=r[r.length-1];let a=1;for(let p=0;p<r.length-1;++p)a*=r[p];const o=n.shape,l=r.slice();l.pop();let c=1;for(let p=i;p<t;++p)c*=o[p],l.push(o[p]);const h=[...Hm(n.shape).map(p=>p/c),1].slice(0,i);return[l,a,c,h]}const Tce=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:i6},Symbol.toStringTag,{value:"Module"}));function Kk(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(t.rank<r)throw new Error(i+` update.rank < ${r}. `);if(n.length<s+(t.rank-r))throw new Error(i+` Output shape length < ${s+(t.rank-r)}`);if(t.rank!==r+n.length-s)throw new Error(i+` update.rank != ${r+n.length-s}`);for(let a=0;a<r;++a)if(t.shape[a]!==e.shape[a])throw new Error(i+` updates.shape[${a}] (${t.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<t.rank-r;++a)if(t.shape[a+r]!==n[a+s])throw new Error(i+` updates.shape[${a+r}] (${t.shape[a+r]}) != shape[${a+r}] (${n[a+r]})`)}function Xk(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}Kk(t,e,n)}function a6(n,e,t){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=t.length;let a=1;for(let p=r;p<i;++p)a*=t[p];const o=r<1?1:r,l=Xn(e.shape)/o,c=[...Hm(t.slice(0,r)),1],h=Xn(t);return{sliceRank:r,numUpdates:l,sliceSize:a,strides:c,outputSize:h}}const Sce=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:a6,validateInput:Xk,validateUpdateShape:Kk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _I=-2,Ece=-1;function Nce(n,e,t){const s=n.shape.length;se(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),se(s===t.length,()=>`Error in slice${s}D: Length of size ${t} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)se(e[r]+t[r]<=n.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+t[r]}) would overflow input.shape[${r}] (${n.shape[r]})`)}function Ice(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function Cce(n,e,t){const s=[];for(let r=0;r<n.length;r++)s[r]=Math.ceil((e[r]-n[r])/t[r]);return s}function o6(n,e,t,s){const r=[...n];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<t;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function l6(n,e,t){return t<=n?t:t-(e-1)}function c6(n,e){const t=[];for(let s=0;s<n;s++)t.push(e+s);return t}function kce(n,e,t,s,r,i,a,o,l){const c=n.length;let h=new Array(c),p=new Array(c),m=new Array(c);if(e.length&&t>0){const v=e[0],x=t+1;h=u6(a,v,x,s,n),p=h6(o,v,x,r,n),m=o6(i,v,x,n)}else for(let v=0;v<c;v++)h[v]=f6(a,s,i,n,v,l),p[v]=p6(o,r,i,n,v,l),m[v]=d6(i,v,l);return{begin:h,end:p,strides:m}}function u6(n,e,t,s,r){const i=[...r],a=c6(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=0;else{const l=l6(e,t,o);let c=s[l];n&1<<l&&(c=0),i[o]=c}return i}function h6(n,e,t,s,r){const i=[...r],a=c6(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{const l=l6(e,t,o);let c=s[l];n&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[o]=c}for(let o=0;o<i.length;o++){const l=r[o];i[o]<0&&(i[o]+=l),i[o]=Ky(0,i[o],r[o])}return i}function d6(n,e,t){let s=n[e];return(t&1<<e||s==null)&&(s=1),s}function f6(n,e,t,s,r,i){let a=e[r];const o=t[r]||1;(n&1<<r||i&1<<r||a==null)&&(o>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=s[r];return a<0&&(a+=l),a=Ky(0,a,l-1),a}function p6(n,e,t,s,r,i){let a=e[r];const o=t[r]||1;(n&1<<r||i&1<<r||a==null)&&(o>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=s[r];return a<0&&(a+=l),o>0?a=Ky(0,a,l):a=Ky(-1,a,l-1),a}function $ce(n,e,t){let s=t.length;for(let r=0;r<t.length;r++)if(t[r]>1){s=r;break}for(let r=s+1;r<t.length;r++)if(e[r]>0||t[r]!==n[r])return!1;return!0}function Ace(n,e){let t=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)t+=n[s]*e[s];return t}function Rce(n,e,t){let s;const r=n.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(a=>{se(a!==-1,()=>"slice() does not support negative begin indexing.")});let i;return t==null?i=new Array(r).fill(-1):typeof t=="number"?i=[t,...new Array(r-1).fill(-1)]:t.length<r?i=t.concat(new Array(r-t.length).fill(-1)):i=t,i=i.map((a,o)=>a>=0?a:(se(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${o}.`),n.shape[o]-s[o])),[s,i]}function Dce(n,e,t,s,r,i,a,o,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const p={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};for(let $=0;$<p.dims;$++)h&&(1<<$&o)!==0&&p.numAddAxisAfterEllipsis++,1<<$&a&&(h=!0);h||(p.ellipsisMask|=1<<p.dims,p.dims++);const m={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Lce(p,m);let v=!0,x=!0,w=!0;const T=[],E=[];for(let $=0;$<n.length;++$){if(m.strides[$]===0)throw Error(`strides[${$}] must be non-zero`);const R=!!(m.shrinkAxisMask&1<<$),P=n[$];if(P===-1){T.push(R?1:-1);continue}const U=[m.beginMask&1<<$,m.endMask&1<<$],j=[m.strides[$]>0?0:-1,m.strides[$]>0?P:P-1];if(R&&m.strides[$]<=0)throw Error("only stride 1 allowed on non-range indexing.");w=w&&m.strides[$]===1;const O=!!(m.beginMask&1<<$&&m.endMask&1<<$);if(m.beginValid&&m.endValid){if(R){const W=m.begin[$]<0?P+m.begin[$]:m.begin[$];if(m.begin[$]=W,m.end[$]=m.begin[$]+1,W<0||W>=P)throw Error(`slice index ${m.begin[$]} of dimension ${$} out of bounds.`)}else m.begin[$]=vM(m.begin[$],0,m.strides[$],P,U,j),m.end[$]=vM(m.end[$],1,m.strides[$],P,U,j);const D=m.strides[$]===1&&m.begin[$]===0&&m.end[$]===P;v=v&&D,x=x&&($===0&&m.strides[$]===1||D)}else v=v&&m.strides[$]===1&&O,x=x&&($===0&&m.strides[$]===1||O);let M,B=!1;if(m.beginValid&&m.endValid?(M=m.end[$]-m.begin[$],B=!0):R?(M=1,B=!0):O&&P>=0&&(m.strides[$]<0?M=-P:M=P,B=!0),B){let D;M===0||M<0!=m.strides[$]<0?D=0:D=Math.trunc(M/m.strides[$])+(M%m.strides[$]!==0?1:0),T.push(D)}else T.push(-1)}for(let $=0;$<m.finalShapeGatherIndices.length;++$){const R=m.finalShapeGatherIndices[$];R>=0?E.push(T[R]):R===_I&&E.push(1)}return{finalShapeSparse:E.filter(($,R)=>m.finalShapeGatherIndices[R]!==_I),finalShape:E,isIdentity:v,sliceDim0:x,isSimpleSlice:w,begin:m.begin,end:m.end,strides:m.strides}}function Lce(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const r=Math.min(e.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<r;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=s}else if(1<<s&n.newAxisMask)e.finalShapeGatherIndices.push(_I),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[s]),n.end!=null&&(e.end[t]=n.end[s]),e.strides[t]=n.strides[s],n.beginMask&1<<s&&(e.beginMask|=1<<t),n.endMask&1<<s&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(Ece),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[t]=s,t++}}function vM(n,e,t,s,r,i){if(r[e])return t>0?i[e]:i[e+1&1];{const a=n<0?s+n:n;return a<i[0]?i[0]:a>i[1]?i[1]:a}}const m6=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:Nce,computeFlatOffset:Ace,computeOutShape:Cce,getNormalizedAxes:kce,isSliceContinous:$ce,maskToAxes:Ice,parseSliceParams:Rce,sliceInfo:Dce,startForAxis:f6,startIndicesWithElidedDims:u6,stopForAxis:p6,stopIndicesWithElidedDims:h6,stridesForAxis:d6,stridesWithElidedDims:o6},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let g6=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},y6=class Hp{constructor(){this.classNameMap={}}static getMap(){return Hp.instance==null&&(Hp.instance=new Hp),Hp.instance}static register(e){Hp.getMap().classNameMap[e.className]=[e,e.fromConfig]}};function Yh(n){se(n.className!=null,()=>"Class being registered does not have the static className property defined."),se(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),se(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),y6.register(n)}const Oce=Object.freeze(Object.defineProperty({__proto__:null,Serializable:g6,SerializationMap:y6,registerClass:Yh},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pce=.001,v6=.1;function Mce(n,e,t){return t==null&&(t=Zk()),xI(n,e,(s,r)=>Yk(s,r,t))}function Zk(){return de.backend.floatPrecision()===32?Pce:v6}function xI(n,e,t){let s=!0;if((Lr(n)||Lr(e))&&(s=!1),Lr(n)&&Lr(e)&&(s=!0),s){const a=n.constructor.name,o=e.constructor.name;if(a!==o)throw new Error(`Arrays are of different type. Actual: ${a}. Expected: ${o}`)}if(Array.isArray(n)&&Array.isArray(e)){const a=Kl(n),o=Kl(e);if(!ql(a,o))throw new Error(`Arrays have different shapes. Actual: [${a}]. Expected: [${o}]`)}const r=Lr(n)?n:gf(n),i=Lr(e)?e:gf(e);if(r.length!==i.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${i.length}.
Actual:   ${r}.
Expected: ${i}.`);for(let a=0;a<i.length;++a){const o=r[a],l=i[a];if(!t(o,l))throw new Error(`Arrays differ: actual[${a}] = ${o}, expected[${a}] = ${l}.
Actual:   ${r}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function Fce(n,e){n().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function jce(n,e){const t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return hh(n)||hh(n[0])||hh(e)||hh(e[0])?xI(n,t,(s,r)=>s==r):xI(n,e,(s,r)=>Yk(s,r,0))}function Bce(n,e,t){if(t==null&&(t=Zk()),!Yk(n,e,t))throw new Error(`Numbers differ: actual === ${n}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function Yk(n,e,t){return!isFinite(n)&&!isFinite(e)?!0:!(isNaN(n)||isNaN(e)||Math.abs(n-e)>t)}function zce(n,e,t){for(let s=0;s<n.length;s++)if(n[s]<e||n[s]>t)throw new Error(`Value out of range:${n[s]} low: ${e}, high: ${t}`)}function Vce(n,e){const t=new Float32Array(n),s=new Float32Array(e);if(t.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${t.length}`);for(let r=0;r<s.length;r++)if(t[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${t[r]} instead`)}function b6(n){for(let e=0;e<n.length;e++){const t=n[e];Array.isArray(t)?b6(t):n[e]=Pv(t)}return n}function Uce(n){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(n),new Promise(t=>{e.addEventListener("loadeddata",s=>t(e)),e.load()})}async function Gce(n){await n.play(),"requestVideoFrameCallback"in n&&await new Promise(e=>{n.requestVideoFrameCallback(e)})}const Wce=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:v6,createVideoElement:Uce,encodeStrings:b6,expectArrayBuffersEqual:Vce,expectArraysClose:Mce,expectArraysEqual:jce,expectNumbersClose:Bce,expectPromiseToFail:Fce,expectValuesInRange:zce,play:Gce,testEpsilon:Zk},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const Hce="3.21.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qce(n,e){let t=Q(n,"a","add"),s=Q(e,"b","add");[t,s]=cs(t,s);const r={a:t,b:s};return de.runKernel($k,r)}const Nt=ue({add_:qce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kce(n,e){let t=Q(n,"a","floorDiv"),s=Q(e,"b","floorDiv");[t,s]=cs(t,s);const r={a:t,b:s};return de.runKernel(Vz,r)}const Qk=ue({floorDiv_:Kce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(n,e){let t=Q(n,"a","div"),s=Q(e,"b","div");if([t,s]=cs(t,s),t.dtype==="int32"&&s.dtype==="int32")return Qk(t,s);const r={a:t,b:s},i={};return de.runKernel($z,r,i)}const Un=ue({div_:Xce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zce(n,e){let t=Q(n,"a","mul"),s=Q(e,"b","mul");[t,s]=cs(t,s);const r={a:t,b:s};return de.runKernel(_V,r)}const Ye=ue({mul_:Zce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(n){const e=Q(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return de.runKernel(hz,t)}else{const t={x:e};return de.runKernel(UB,t)}}const Qi=ue({abs_:Yce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qce(n){const t={x:Q(n,"x","acos")};return de.runKernel(GB,t)}const _6=ue({acos_:Qce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(n){const t={x:Q(n,"x","acosh")};return de.runKernel(WB,t)}const x6=ue({acosh_:Jce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(n){se(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),se(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((r,i)=>Q(r,`tensors${i}`,"addN")),t=e[0];e.forEach(r=>{if(r.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!ql(r.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return de.runKernel(HB,s)}const w6=ue({addN_:eue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tue(n,e=null,t=!1){const r={x:Q(n,"x","all","bool")},i={axis:e,keepDims:t};return de.runKernel(qB,r,i)}const T6=ue({all_:tue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(n,e=null,t=!1){const r={x:Q(n,"x","any","bool")},i={axis:e,keepDims:t};return de.runKernel(KB,r,i)}const S6=ue({any_:nue});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sue(n,e=0){const s={x:Q(n,"x","argMax")},r={axis:e};return de.runKernel(XB,s,r)}const E6=ue({argMax_:sue});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(n,e=0){const s={x:Q(n,"x","argMin")},r={axis:e};return de.runKernel(ZB,s,r)}const N6=ue({argMin_:rue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iue(n){const t={x:Q(n,"x","asin")};return de.runKernel(YB,t)}const I6=ue({asin_:iue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aue(n){const t={x:Q(n,"x","asinh")};return de.runKernel(QB,t)}const C6=ue({asinh_:aue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oue(n){const t={x:Q(n,"x","atan")};return de.runKernel(JB,t)}const k6=ue({atan_:oue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(n,e){let t=Q(n,"a","atan2"),s=Q(e,"b","atan2");[t,s]=cs(t,s);const r={a:t,b:s};return de.runKernel(tz,r)}const $6=ue({atan2_:lue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(n){const t={x:Q(n,"x","atanh")};return de.runKernel(ez,t)}const A6=ue({atanh_:cue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uue(n,e,t,s,r="NHWC",i){const a=n[3],o=[...e,a],l=L6(r);return jv(n,o,t,i,s,null,null,l)}function R6(n,e,t,s,r,i,a="channelsLast"){const[o,l]=U0(e);let c;if(a==="channelsLast")c=[o,l,n[3],n[3]];else if(a==="channelsFirst")c=[o,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return jv(n,c,t,s,r,i,!1,a)}function hue(n,e,t,s,r,i,a="NDHWC"){const[o,l,c]=wI(e);let h,p;if(a==="NDHWC")p="channelsLast",h=[o,l,c,n[4],n[4]];else if(a==="NCDHW")p="channelsFirst",h=[o,l,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return D6(n,h,t,s,r,!1,p,i)}function jv(n,e,t,s,r,i,a=!1,o="channelsLast"){let[l,c,h,p]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,h,p]=n;else if(o==="channelsFirst")[l,p,c,h]=n;else throw new Error(`Unknown dataFormat ${o}`);const[m,v,,x]=e,[w,T]=U0(t),[E,C]=U0(s),$=im(m,E),R=im(v,C),{padInfo:P,outHeight:U,outWidth:j}=pue(r,c,h,w,T,$,R,i,o),O=a?x*p:x;let M;return o==="channelsFirst"?M=[l,O,U,j]:o==="channelsLast"&&(M=[l,U,j,O]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:h,inChannels:p,outHeight:U,outWidth:j,outChannels:O,padInfo:P,strideHeight:w,strideWidth:T,filterHeight:m,filterWidth:v,effectiveFilterHeight:$,effectiveFilterWidth:R,dilationHeight:E,dilationWidth:C,inShape:n,outShape:M,filterShape:e}}function D6(n,e,t,s,r,i=!1,a="channelsLast",o){let[l,c,h,p,m]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,c,h,p,m]=n;else if(a==="channelsFirst")[l,m,c,h,p]=n;else throw new Error(`Unknown dataFormat ${a}`);const[v,x,w,,T]=e,[E,C,$]=wI(t),[R,P,U]=wI(s),j=im(v,R),O=im(x,P),M=im(w,U),{padInfo:B,outDepth:D,outHeight:W,outWidth:H}=mue(r,c,h,p,E,C,$,j,O,M,o),ae=i?T*m:T;let te;return a==="channelsFirst"?te=[l,ae,D,W,H]:a==="channelsLast"&&(te=[l,D,W,H,ae]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:h,inWidth:p,inChannels:m,outDepth:D,outHeight:W,outWidth:H,outChannels:ae,padInfo:B,strideDepth:E,strideHeight:C,strideWidth:$,filterDepth:v,filterHeight:x,filterWidth:w,effectiveFilterDepth:j,effectiveFilterHeight:O,effectiveFilterWidth:M,dilationDepth:R,dilationHeight:P,dilationWidth:U,inShape:n,outShape:te,filterShape:e}}function due(n,e,t,s,r){s==null&&(s=Jk(n,e,t));const i=n[0],a=n[1],o=nf((i-e+2*s)/t+1,r),l=nf((a-e+2*s)/t+1,r);return[o,l]}function fue(n,e,t,s,r,i){r==null&&(r=Jk(n,e,s));const a=n[0],o=n[1],l=n[2],c=nf((a-e+2*r)/s+1,i),h=nf((o-e+2*r)/s+1,i),p=nf((l-e+2*r)/s+1,i);return[c,h,p,t]}function Jk(n,e,t,s=1){const r=im(e,s);return Math.floor((n[0]*(t-1)-t+r)/2)}function U0(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function wI(n){return typeof n=="number"?[n,n,n]:n}function im(n,e){return e<=1?n:n+(n-1)*(e-1)}function pue(n,e,t,s,r,i,a,o,l){let c,h,p;if(typeof n=="number"){c={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const v=due([e,t],i,s,n,o);h=v[0],p=v[1]}else if(n==="same"){h=Math.ceil(e/s),p=Math.ceil(t/r);const m=Math.max(0,(h-1)*s+i-e),v=Math.max(0,(p-1)*r+a-t),x=Math.floor(m/2),w=m-x,T=Math.floor(v/2),E=v-T;c={top:x,bottom:w,left:T,right:E,type:"SAME"}}else if(n==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-i+1)/s),p=Math.ceil((t-a+1)/r);else if(typeof n=="object"){const m=l==="channelsLast"?n[1][0]:n[2][0],v=l==="channelsLast"?n[1][1]:n[2][1],x=l==="channelsLast"?n[2][0]:n[3][0],w=l==="channelsLast"?n[2][1]:n[3][1];c={top:m,bottom:v,left:x,right:w,type:m===0&&v===0&&x===0&&w===0?"VALID":"EXPLICIT"},h=nf((e-i+m+v)/s+1,o),p=nf((t-a+x+w)/r+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:c,outHeight:h,outWidth:p}}function mue(n,e,t,s,r,i,a,o,l,c,h){let p,m,v,x;if(typeof n=="number"){p={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const T=fue([e,t,s,1],o,1,r,n,h);m=T[0],v=T[1],x=T[2]}else if(n==="same"){m=Math.ceil(e/r),v=Math.ceil(t/i),x=Math.ceil(s/a);const w=(m-1)*r+o-e,T=(v-1)*i+l-t,E=(x-1)*a+c-s,C=Math.floor(w/2),$=w-C,R=Math.floor(T/2),P=T-R,U=Math.floor(E/2),j=E-U;p={top:R,bottom:P,left:U,right:j,front:C,back:$,type:"SAME"}}else if(n==="valid")p={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},m=Math.ceil((e-o+1)/r),v=Math.ceil((t-l+1)/i),x=Math.ceil((s-c+1)/a);else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:p,outDepth:m,outHeight:v,outWidth:x}}function nf(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function ev(n){const[e,t,s]=U0(n);return e===1&&t===1&&s===1}function iu(n,e){return ev(n)||ev(e)}function L6(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function uo(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")se(bm(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{se(bm(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gue(n,e){const s={x:Q(n,"x","reshape","string_or_numeric")},r={shape:e};return de.runKernel(jV,s,r)}const ze=ue({reshape_:gue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(n,e,t,s,r){const i=Q(n,"x","avgPool","float32"),a=1;se(iu(t,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);let o=i,l=!1;i.rank===3&&(l=!0,o=ze(i,[1,i.shape[0],i.shape[1],i.shape[2]])),se(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),uo("avgPool",s,r);const c={x:o},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r};let p=de.runKernel(nz,c,h);return p=es(p,i.dtype),l?ze(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const e2=ue({avgPool_:yue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(n,e,t,s,r,i="NDHWC"){const a=Q(n,"x","avgPool3d","float32");let o=a,l=!1;a.rank===4&&(l=!0,o=ze(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),se(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),se(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),uo("avgPool3d",s,r);const c={x:o},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:i};let p=de.runKernel(sz,c,h);return p=es(p,o.dtype),l?ze(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const O6=ue({avgPool3d_:vue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bue(n,e=0){se(n.length>=1,()=>"Pass at least one tensor to concat");const t=Qy(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return Hc(t[0]);const s=t,r={axis:e};return de.runKernel(dz,s,r)}const Fr=ue({concat_:bue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(n){const t={x:Q(n,"x","sigmoid","float32")};return de.runKernel(eU,t)}const sf=ue({sigmoid_:_ue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xue(n,e,t){const s=Q(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:t};return de.runKernel(ZV,r,i)}const Pn=ue({slice_:xue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(n){const t={x:Q(n,"x","tanh","float32")};return de.runKernel(bU,t)}const G0=ue({tanh_:wue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tue(n,e,t,s,r,i){const a=Q(n,"forgetBias","basicLSTMCell"),o=Q(e,"lstmKernel","basicLSTMCell"),l=Q(t,"lstmBias","basicLSTMCell"),c=Q(s,"data","basicLSTMCell"),h=Q(r,"c","basicLSTMCell"),p=Q(i,"h","basicLSTMCell"),m=Fr([c,p],1),v=Sn(m,o),x=Nt(v,l),w=x.shape[0],T=x.shape[1]/4,E=[w,T],C=Pn(x,[0,0],E),$=Pn(x,[0,T],E),R=Pn(x,[0,T*2],E),P=Pn(x,[0,T*3],E),U=Nt(Ye(sf(C),G0($)),Ye(h,sf(Nt(a,R)))),j=Ye(G0(U),sf(P));return[U,j]}const P6=ue({basicLSTMCell_:Tue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sue(n,e,t){const s=Q(n,"x","batchToSpaceND"),r=e.reduce((o,l)=>o*l);se(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),se(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),se(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},a={blockShape:e,crops:t};return de.runKernel(iz,i,a)}const t2=ue({batchToSpaceND_:Sue});function Eue(n){let e;return n.rank===0||n.rank===1?e=ze(n,[1,1,1,n.size]):n.rank===2?e=ze(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=ze(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(n,e,t,s,r,i){i==null&&(i=.001);const a=Q(n,"x","batchNorm"),o=Q(e,"mean","batchNorm"),l=Q(t,"variance","batchNorm");let c;r!=null&&(c=Q(r,"scale","batchNorm"));let h;s!=null&&(h=Q(s,"offset","batchNorm")),se(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),se(h==null||o.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),se(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const m={x:Eue(a),scale:c,offset:h,mean:o,variance:l},v={varianceEpsilon:i},x=de.runKernel(Uz,m,v);return ze(x,a.shape)}const Bv=ue({batchNorm_:Nue});function Iue(n,e,t,s,r,i){const a=Q(n,"x","batchNorm"),o=Q(e,"mean","batchNorm"),l=Q(t,"variance","batchNorm");let c;r!=null&&(c=Q(r,"scale","batchNorm"));let h;return s!=null&&(h=Q(s,"offset","batchNorm")),se(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),se(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),se(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&se(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),h!=null&&se(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),Bv(a,o,l,h,c,i)}const M6=ue({batchNorm2d_:Iue});function Cue(n,e,t,s,r,i){const a=Q(n,"x","batchNorm"),o=Q(e,"mean","batchNorm"),l=Q(t,"variance","batchNorm");let c;r!=null&&(c=Q(r,"scale","batchNorm"));let h;return s!=null&&(h=Q(s,"offset","batchNorm")),se(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),se(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),se(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&se(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),h!=null&&se(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),Bv(a,o,l,h,c,i)}const F6=ue({batchNorm3d_:Cue});function kue(n,e,t,s,r,i){const a=Q(n,"x","batchNorm"),o=Q(e,"mean","batchNorm"),l=Q(t,"variance","batchNorm");let c;r!=null&&(c=Q(r,"scale","batchNorm"));let h;return s!=null&&(h=Q(s,"offset","batchNorm")),se(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),se(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),se(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&se(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),h!=null&&se(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),Bv(a,o,l,h,c,i)}const j6=ue({batchNorm4d_:kue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(n,e,t){const s=Q(n,"x","bincount"),r=Q(e,"weights","bincount");se(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),se(t>=0,()=>`size must be non-negative, but got ${t}.`),se(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},a={size:t};return de.runKernel(az,i,a)}const n2=ue({bincount_:$ue});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aue(n,e){const t=Q(n,"s0","broadcastArgs","int32"),s=Q(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:t,s1:s};return de.runKernel(oz,r)}const B6=ue({broadcastArgs_:Aue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(n,e){let t=Q(n,"broadcastTo","x");const s=t.shape;if(e.some(c=>!(c>0)||c%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const c=t.shape.slice();for(;c.length<e.length;)c.unshift(1);t=ze(t,c)}const r=t.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(t.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,h)=>c>1?h:-1).filter(c=>c>=0).length===0)return Hc(t);const o={x:t},l={reps:i};return de.runKernel(Dk,o,l)}const Ly=ue({broadcastTo_:Rue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Due(n){const t={x:Q(n,"x","ceil","float32")};return de.runKernel(lz,t)}const z6=ue({ceil_:Due});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qm(n,e,t){const s={shape:n,value:e,dtype:t};return de.runKernel(jz,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lue(n,e,t){const s=Q(n,"x","clipByValue");if(se(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return qm(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:t};return de.runKernel(cz,r,i)}const V6=ue({clipByValue_:Lue});function Oue(n){return Fr(n,0)}const U6=ue({concat1d_:Oue});function Pue(n,e){return Fr(n,e)}const G6=ue({concat2d_:Pue});function Mue(n,e){return Fr(n,e)}const W6=ue({concat3d_:Mue});function Fue(n,e){return Fr(n,e)}const H6=ue({concat4d_:Fue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jue(n,e,t,s,r="NHWC",i=[1,1],a){const o=Q(n,"x","conv2d","float32"),l=Q(e,"filter","conv2d","float32");let c=o,h=!1;o.rank===3&&(h=!0,c=ze(o,[1,o.shape[0],o.shape[1],o.shape[2]])),se(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),se(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),uo("conv2d",s,a);const p=r==="NHWC"?c.shape[3]:c.shape[1];se(p===l.shape[2],()=>`Error in conv2d: depth of input (${p}) must match input depth for filter ${l.shape[2]}.`),se(iu(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const m={x:c,filter:l},v={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a},x=de.runKernel(fz,m,v);return h?ze(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const zv=ue({conv2d_:jue});function Bue(n,e,t,s,r="NWC",i=1,a){const o=Q(n,"x","conv1d"),l=Q(e,"filter","conv1d");let c=o,h=!1;o.rank===2&&(h=!0,c=ze(o,[1,o.shape[0],o.shape[1]])),se(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),se(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),uo("conv1d",s,a),se(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),se(iu(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),se(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const p=ze(l,[1,l.shape[0],l.shape[1],l.shape[2]]),m=ze(c,[c.shape[0],1,c.shape[1],c.shape[2]]),T=zv(m,p,[1,t],s,"NHWC",[1,i],a);return h?ze(T,[T.shape[2],T.shape[3]]):ze(T,[T.shape[0],T.shape[2],T.shape[3]])}const q6=ue({conv1d_:Bue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zue(n,e,t,s,r,i="NHWC",a){se(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,l=e,c=!1;e.rank===3&&(c=!0,l=ze(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,n[0],n[1],n[2]]),se(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),se(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),se(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const h=i==="NHWC"?o[3]:o[1],p=i==="NHWC"?l.shape[3]:l.shape[1];se(h===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${t.shape[2]}.`),se(p===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${p}) must match output depth for filter ${t.shape[3]}.`),uo("conv2dDerInput",r,a);const m={dy:l,filter:t},v={strides:s,pad:r,dataFormat:i,dimRoundingMode:a,inputShape:o},x=de.runKernel(mz,m,v);return c?ze(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const K6=ue({conv2DBackpropInput_:zue});function Vue(n,e,t,s,r,i){const a=Q(n,"x","conv2dTranspose"),o=Q(e,"filter","conv2dTranspose");return K6(t,a,o,s,r,"NHWC",i)}const X6=ue({conv2dTranspose_:Vue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(n,e,t,s,r="NDHWC",i=[1,1,1]){const a=Q(n,"x","conv3d"),o=Q(e,"filter","conv3d");let l=a,c=!1;a.rank===4&&(c=!0,l=ze(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),se(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),se(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),se(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),se(iu(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),se(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`);const h={x:l,filter:o},p={strides:t,pad:s,dataFormat:r,dilations:i},m=de.runKernel(gz,h,p);return c?ze(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const Z6=ue({conv3d_:Uue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(n,e,t,s,r){se(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,a=e,o=!1;e.rank===4&&(o=!0,a=ze(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const l=i[4],c=a.shape[4];se(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),se(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),se(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),se(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),se(c===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${t.shape[4]}.`);const h={dy:a,filter:t},p={pad:r,strides:s,inputShape:i},m=de.runKernel(yz,h,p);return o?ze(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const Wue=ue({conv3DBackpropInput_:Gue});function Hue(n,e,t,s,r){const i=Q(n,"x","conv3dTranspose"),a=Q(e,"filter","conv3dTranspose");return Wue(t,i,a,s,r)}const Y6=ue({conv3dTranspose_:Hue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function que(n){const t={x:Q(n,"x","cos","float32")};return de.runKernel(vz,t)}const Q6=ue({cos_:que});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kue(n){const t={x:Q(n,"x","cosh","float32")};return de.runKernel(bz,t)}const J6=ue({cosh_:Kue});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(n,e=0,t=!1,s=!1){const i={x:Q(n,"x","cumprod")},a={axis:e,exclusive:t,reverse:s};return de.runKernel(_z,i,a)}const eG=ue({cumprod_:Xue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zue(n,e=0,t=!1,s=!1){const i={x:Q(n,"x","cumsum")},a={axis:e,exclusive:t,reverse:s};return de.runKernel(xz,i,a)}const tG=ue({cumsum_:Zue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yue(n,e,t,s=!1){const r=Q(n,"x","denseBincount"),i=Q(e,"weights","denseBincount");se(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),se(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),se(t>=0,()=>`size must be non-negative, but got ${t}.`),se(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const a={x:r,weights:i},o={size:t,binaryOutput:s};return de.runKernel(Tz,a,o)}const nG=ue({denseBincount_:Yue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Que(n,e,t="NHWC"){const s=Q(n,"x","depthToSpace","float32"),r=t==="NHWC"?s.shape[1]:s.shape[2],i=t==="NHWC"?s.shape[2]:s.shape[3],a=t==="NHWC"?s.shape[3]:s.shape[1];se(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),se(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),se(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),se(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${s.shape}`);const o={x:s},l={blockSize:e,dataFormat:t};return de.runKernel(Sz,o,l)}const sG=ue({depthToSpace_:Que});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jue(n,e,t,s,r="NHWC",i=[1,1],a){const o=Q(n,"x","depthwiseConv2d","float32"),l=Q(e,"filter","depthwiseConv2d","float32");let c=o,h=!1;o.rank===3&&(h=!0,c=ze(o,[1,o.shape[0],o.shape[1],o.shape[2]])),se(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),se(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const p=r==="NHWC"?c.shape[3]:c.shape[1];se(p===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${p}) must match the inChannels dimension in filter ${l.shape[2]}.`),uo("depthwiseConv2d",s,a);const m={x:c,filter:l},v={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a},x=de.runKernel(Ez,m,v);return h?ze(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const ew=ue({depthwiseConv2d_:Jue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ehe(n){const t={x:Q(n,"x","diag")};return de.runKernel(Cz,t)}const rG=ue({diag_:ehe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function the(n,e,t,s,r=[1,1],i="NHWC"){const a=Q(n,"x","dilation2d"),o=Q(e,"filter","dilation2d");se(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),se(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),se(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=a,c=!1;a.rank===3&&(l=ze(a,[1,a.shape[0],a.shape[1],a.shape[2]]),c=!0);const h={x:l,filter:o},p={strides:t,pad:s,dilations:r},m=de.runKernel(kz,h,p);return c?ze(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const iG=ue({dilation2d_:the});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(n,e){let t=Q(n,"a","equal","string_or_numeric"),s=Q(e,"b","equal","string_or_numeric");[t,s]=cs(t,s),Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(Lz,r)}const s2=ue({equal_:nhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function she(n,e,t){const s=Q(e,"a","where"),r=Q(t,"b","where"),i=Q(n,"condition","where","bool"),a=Fs(Fs(i.shape,s.shape),r.shape),o=Ly(i,a),l=Ly(s,a),c=Ly(r,a),h={condition:o,t:l,e:c};return de.runKernel(KV,h)}const xf=ue({where_:she});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rhe(n){const t={x:Q(n,"x","zerosLike")};return de.runKernel(EU,t)}const na=ue({zerosLike_:rhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ihe(n,e){let t=Q(n,"a","div"),s=Q(e,"b","div");[t,s]=cs(t,s);const r=Un(t,s),i=na(r),a=s2(s,i);return xf(a,i,r)}const aG=ue({divNoNan_:ihe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ahe(n,e){const t=Q(n,"t1","dot"),s=Q(e,"t2","dot");se((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const r=t.rank===1?t.size:t.shape[1],i=s.rank===1?s.size:s.shape[0];if(se(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),t.rank===1&&s.rank===1){const a=ze(t,[1,-1]),o=ze(s,[-1,1]),l=Sn(a,o);return ze(l,[])}else if(t.rank===1&&s.rank===2){const a=ze(t,[1,-1]),o=ze(s,[s.shape[0],s.shape[1]]),l=Sn(a,o);return ze(l,[l.size])}else if(t.rank===2&&s.rank===1){const a=ze(s,[-1,1]),o=Sn(t,a);return ze(o,[o.size])}else{const a=ze(s,[s.shape[0],s.shape[1]]);return Sn(t,a)}}const oG=ue({dot_:ahe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ohe(n,...e){const t=e.map((r,i)=>Q(r,`tensors${i}`,"einsum")),s={equation:n};return de.runKernel(Az,t,s)}const lG=ue({einsum_:ohe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lhe(n){const t={x:Q(n,"x","elu","float32")};return de.runKernel(Rz,t)}const r2=ue({elu_:lhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function che(n){let e=Q(n,"x","erf");se(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=es(e,"float32"));const t={x:e};return de.runKernel(Dz,t)}const cG=ue({erf_:che});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function uG(n,e,t){const s=n.length+e.length,r=[];let i=0,a=0;for(let o=0;o<s;o++)t.indexOf(o)===-1?r.push(n[i++]):r.push(e[a++]);return r}function uhe(n,e){const t=[],s=n.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&t.push(n[i]);const r=e.map(i=>n[i]);return[t,r]}function Vv(n,e){const t=e.map(s=>1);return uG(n,t,e)}function hhe(n,e,t){se(i2(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function dhe(n,e){if(i2(n,e))return null;const t=[];for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);return n.forEach(s=>t.push(s)),t}function fhe(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function phe(n,e){const t=[];for(let s=e-n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mhe(n,e=null,t=!1){const r={x:Q(n,"x","max")},i={reductionIndices:e,keepDims:t};return de.runKernel(cV,r,i)}const rf=ue({max_:mhe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ghe(n,e=null,t=!1){const r={x:Q(n,"x","min")},i={axis:e,keepDims:t};return de.runKernel(mV,r,i)}const W0=ue({min_:ghe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yhe(n,e){let t=Q(n,"base","pow"),s=Q(e,"exp","pow");[t,s]=cs(t,s);const r={a:t,b:s};return de.runKernel($V,r)}const wm=ue({pow_:yhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zt(n,e){if((Lr(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Lr(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Zh(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vhe(n){const t={x:Q(n,"x","sqrt","float32")};return de.runKernel(nU,t)}const Xl=ue({sqrt_:vhe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bhe(n){const e=Q(n,"x","square"),t={};return de.runKernel("Square",{x:e},t)}const oo=ue({square_:bhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _he(n,e=null,t=!1){let s=Q(n,"x","sum");s.dtype==="bool"&&(s=es(s,"int32"));const r={x:s},i={axis:e,keepDims:t};return de.runKernel(sU,r,i)}const Vn=ue({sum_:_he});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xhe(n,e="euclidean",t=null,s=!1){n=Q(n,"x","norm");const r=hG(n,e,t);let i=r.shape;if(s){const a=Lv(t,n.shape);i=Vv(r.shape,a)}return ze(r,i)}function hG(n,e,t=null){if(n.rank===0)return Qi(n);if(n.rank!==1&&t===null)return hG(ze(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Vn(Qi(n),t);if(e===1/0)return rf(Qi(n),t);if(e===-1/0)return W0(Qi(n),t);if(e==="euclidean"||e===2)return Xl(Vn(wm(Qi(n),Zt(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return rf(Vn(Qi(n),t[0]),t[1]-1);if(e===1/0)return rf(Vn(Qi(n),t[1]),t[0]);if(e===-1/0)return W0(Vn(Qi(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Xl(Vn(oo(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const Uv=ue({norm_:xhe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function whe(n,e=null,t=!1){return Uv(n,"euclidean",e,t)}const dG=ue({euclideanNorm_:whe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function The(n){const t={x:Q(n,"x","exp")};return de.runKernel(Oz,t)}const Mh=ue({exp_:The});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function She(n,e=0){const t=Q(n,"x","expandDims","string_or_numeric");se(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},r={dim:e};return de.runKernel(Pz,s,r)}const Lc=ue({expandDims_:She});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ehe(n){const t={x:Q(n,"x","expm1")};return de.runKernel(Mz,t)}const fG=ue({expm1_:Ehe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nhe(n,e){const t=Q(n,"x","tile","string_or_numeric");se(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},r={reps:e};return de.runKernel(Dk,s,r)}const am=ue({tile_:Nhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ihe(n,e,t,s="float32"){e==null&&(e=n);const r=Ko([n,e],s),i=n<=e?n:e;for(let o=0;o<i;++o)r.set(1,o,o);const a=ze(r.toTensor(),[n,e]);if(t==null)return a;if(t.length===1)return am(Lc(a,0),[t[0],1,1]);if(t.length===2)return am(Lc(Lc(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return am(Lc(Lc(Lc(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const a2=ue({eye_:Ihe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Che(n){const t={x:Q(n,"x","floor","float32")};return de.runKernel(zz,t)}const o2=ue({floor_:Che});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function khe(n,e,t=0,s=0){const r=Q(n,"x","gather"),i=Q(e,"indices","gather","int32"),a={x:r,indices:i},o={axis:t,batchDims:s};return de.runKernel(Gz,a,o)}const l2=ue({gather_:khe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $he(n,e){let t=Q(n,"a","greater","string_or_numeric"),s=Q(e,"b","greater","string_or_numeric");[t,s]=cs(t,s),Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(Hz,r)}const Gv=ue({greater_:$he});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ahe(n,e){let t=Q(n,"a","greaterEqual","string_or_numeric"),s=Q(e,"b","greaterEqual","string_or_numeric");[t,s]=cs(t,s),Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(qz,r)}const c2=ue({greaterEqual_:Ahe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rhe(n){const t={x:Q(n,"x","isFinite")};return de.runKernel(Zz,t)}const pG=ue({isFinite_:Rhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dhe(n){const t={x:Q(n,"x","isInf")};return de.runKernel(Yz,t)}const mG=ue({isInf_:Dhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lhe(n){const t={x:Q(n,"x","isNaN")};return de.runKernel(Qz,t)}const gG=ue({isNaN_:Lhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ohe(n,e=.2){const s={x:Q(n,"x","leakyRelu")},r={alpha:e};return de.runKernel(Jz,s,r)}const u2=ue({leakyRelu_:Ohe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Phe(n,e){let t=Q(n,"a","less","string_or_numeric"),s=Q(e,"b","less","string_or_numeric");[t,s]=cs(t,s),Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(eV,r)}const yG=ue({less_:Phe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mhe(n,e){let t=Q(n,"a","lessEqual","string_or_numeric"),s=Q(e,"b","lessEqual","string_or_numeric");[t,s]=cs(t,s),Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(tV,r)}const tw=ue({lessEqual_:Mhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const s={start:n,stop:e,num:t};return de.runKernel(nV,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fhe(n,e=5,t=1,s=1,r=.5){const i=Q(n,"x","localResponseNormalization");se(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),se(bm(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=i,o=!1;i.rank===3&&(o=!0,a=ze(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:a},c={depthRadius:e,bias:t,alpha:s,beta:r},h=de.runKernel(lV,l,c);return o?ze(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const bG=ue({localResponseNormalization_:Fhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jhe(n){const t={x:Q(n,"x","log","float32")};return de.runKernel(sV,t)}const Tm=ue({log_:jhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bhe(n){const t={x:Q(n,"x","log1p")};return de.runKernel(rV,t)}const h2=ue({log1p_:Bhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zhe(n){return se(Oh(n),()=>"The f passed in grad(f) must be a function"),(e,t)=>{const s=Q(e,"x","tf.grad","string_or_numeric"),r=t!=null?Q(t,"dy","tf.grad"):null;return de.tidy(()=>{const{value:i,grads:a}=de.gradients(()=>n(s),[s],r);return r!=null&&fi(i.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),nw(a),a[0]})}}function Vhe(n){return se(Oh(n),()=>"The f passed in grads(f) must be a function"),(e,t)=>{se(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=Qy(e,"args","tf.grads","string_or_numeric"),r=t!=null?Q(t,"dy","tf.grads"):null;return de.tidy(()=>{const{value:i,grads:a}=de.gradients(()=>n(...s),s,r);return r!=null&&fi(i.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),nw(a),a})}}function Uhe(n){return se(Oh(n),()=>"The f passed in valueAndGrad(f) must be a function"),(e,t)=>{se(e instanceof os,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),se(t==null||t instanceof os,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=de.gradients(()=>n(e),[e],t);return nw(s),{grad:s[0],value:r}}}function Ghe(n){return se(Oh(n),()=>"The f passed in valueAndGrads(f) must be a function"),(e,t)=>{se(Array.isArray(e)&&e.every(r=>r instanceof os),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),se(t==null||t instanceof os,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=de.gradients(()=>n(...e),e,t);return t!=null&&fi(s.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),nw(s.grads),s}}function _G(n,e){se(Oh(n),()=>"The f passed in variableGrads(f) must be a function"),se(e==null||Array.isArray(e)&&e.every(c=>c instanceof Yy),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const c in de.registeredVariables)e.push(de.registeredVariables[c])}const s=t?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),se(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:a,grads:o}=de.gradients(n,e,null,i);se(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),se(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return e.forEach((c,h)=>{o[h]!=null&&(l[c.name]=o[h])}),s?.forEach(c=>l[c.name]=null),{value:a,grads:l}}function Zl(n){return de.customGrad(n)}function nw(n){if(n.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Whe(n){const t={x:Q(n,"x","softplus")};return de.runKernel(tU,t)}const d2=ue({softplus_:Whe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(n){const e=Q(n,"x","logSigmoid");return Zl(s=>({value:Ml(d2(Ml(s))),gradFunc:a=>Ye(a,sf(Ml(s)))}))(e)}const xG=ue({logSigmoid_:Hhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(n,e){let t=Q(n,"a","sub"),s=Q(e,"b","sub");[t,s]=cs(t,s);const r={a:t,b:s};return de.runKernel(yU,r)}const Bt=ue({sub_:qhe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Khe(n,e=-1){const t=Q(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Zl((r,i)=>{const o=rf(r,e,!0),l=Bt(r,o),c=Bt(es(l,"float32"),Tm(Vn(Mh(l),e,!0)));return i([c]),{value:c,gradFunc:(p,m)=>{const[v]=m,x=!0,w=Mh(v);return Bt(p,Ye(Vn(p,e,x),w))}}})(t)}const wG=ue({logSoftmax_:Khe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xhe(n,e=null,t=!1){const s=Q(n,"x","logSumExp"),r=Lv(e,s.shape),i=rf(s,r,!0),a=Bt(s,i),o=Mh(a),l=Vn(o,r),c=Tm(l),h=Nt(ze(i,c.shape),c);if(t){const p=Vv(h.shape,r);return ze(h,p)}return h}const f2=ue({logSumExp_:Xhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zhe(n,e){const t=Q(n,"a","logicalAnd","bool"),s=Q(e,"b","logicalAnd","bool");Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(iV,r)}const tv=ue({logicalAnd_:Zhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yhe(n){const t={x:Q(n,"x","logicalNot","bool")};return de.runKernel(aV,t)}const p2=ue({logicalNot_:Yhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qhe(n,e){const t=Q(n,"a","logicalOr","bool"),s=Q(e,"b","logicalOr","bool");Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(oV,r)}const m2=ue({logicalOr_:Qhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jhe(n,e){const t=Q(n,"a","logicalXor","bool"),s=Q(e,"b","logicalXor","bool");return Fs(t.shape,s.shape),tv(m2(n,e),p2(tv(n,e)))}const TG=ue({logicalXor_:Jhe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ex=2147483648;function ede(n,e,t="left"){const s=Q(n,"sortedSequence","searchSorted"),r=Q(e,"values","searchSorted"),i=s.shape[s.shape.length-1],a=r.shape[r.shape.length-1],o=ze(s,[-1,i]),l=ze(r,[-1,a]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Xn(l.shape)>=Ex)throw new Error(`values tensor size must less than ${Ex}`);if(o.shape[1]>=Ex)throw new Error(`trailing dim_size must less than ${Ex} for int32 output type, was ${o.shape[1]}`);const c={sortedSequence:o,values:l},h={side:t};return de.runKernel(qV,c,h)}const sw=ue({searchSorted_:ede});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SG(n,e){return sw(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tde(n,e,t,s,r){const i=Q(n,"x","maxPool"),a=1;let o=i,l=!1;i.rank===3&&(l=!0,o=ze(i,[1,i.shape[0],i.shape[1],i.shape[2]])),se(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),se(iu(t,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),uo("maxPool",s,r);const c={x:o},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r},p=de.runKernel(hV,c,h);return l?ze(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const g2=ue({maxPool_:tde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nde(n,e=[1,1,1],t,s,r,i="NDHWC"){const a=Q(n,"x","maxPool3d");let o=a,l=!1;a.rank===4&&(l=!0,o=ze(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),se(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),se(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),uo("maxPool3d",s,r);const c={x:o},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:i},p=de.runKernel(dV,c,h);return l?ze(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const EG=ue({maxPool3d_:nde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sde(n,e,t,s,r=!1){const a={x:Q(n,"x","maxPoolWithArgmax")},o={filterSize:e,strides:t,pad:s,includeBatchInIndex:r},l=de.runKernel(fV,a,o);return{result:l[0],indexes:l[1]}}const NG=ue({maxPoolWithArgmax_:sde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rde(n,e){let t=Q(n,"a","maximum"),s=Q(e,"b","maximum");[t,s]=cs(t,s),t.dtype==="bool"&&(t=es(t,"int32"),s=es(s,"int32")),Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(uV,r)}const y2=ue({maximum_:rde});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(n,e=null,t=!1){const r={x:Q(n,"x","mean")},i={axis:e,keepDims:t};return de.runKernel(pV,r,i)}const nv=ue({mean_:ide});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wf(n,e="float32"){if(e==="complex64"){const s=wf(n,"float32"),r=wf(n,"float32");return Jc(s,r)}const t=Y1(Xn(n),e);return de.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fh(n,e="float32"){if(e==="complex64"){const s=fh(n,"float32"),r=wf(n,"float32");return Jc(s,r)}const t=Nk(Xn(n),e);return de.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IG(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let s=Q(n,"x","meshgrid",n instanceof os?n.dtype:"float32");if(e===void 0)return[s];let r=Q(e,"y","meshgrid",e instanceof os?e.dtype:"float32");const i=Xn(s.shape),a=Xn(r.shape);return t==="xy"?(s=ze(s,[1,-1]),r=ze(r,[-1,1]),[Sn(fh([a,1],s.dtype),s),Sn(r,fh([1,i],r.dtype))]):(s=ze(s,[-1,1]),r=ze(r,[1,-1]),[Sn(s,fh([1,a],s.dtype)),Sn(fh([i,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ade(n,e){let t=Q(n,"a","minimum"),s=Q(e,"b","minimum");[t,s]=cs(t,s),t.dtype==="bool"&&(t=es(t,"int32"),s=es(s,"int32")),Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(gV,r)}const v2=ue({minimum_:ade});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ode(n,e,t){se(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=Q(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");se(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=t==="reflect"?1:0;for(let o=0;o<s.rank;o++)se(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),se(e[o][0]>=0&&e[o][0]<=s.shape[o]-r&&e[o][1]>=0&&e[o][1]<=s.shape[o]-r,()=>`Padding in dimension ${o} cannot be greater than or equal to ${s.shape[o]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:t},a={x:s};return de.runKernel(yV,a,i)}const CG=ue({mirrorPad_:ode});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lde(n,e){let t=Q(n,"a","mod"),s=Q(e,"b","mod");[t,s]=cs(t,s);const r={a:t,b:s};return de.runKernel(vV,r)}const kG=ue({mod_:lde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cde(n,e=null,t=!1){n=Q(n,"x","moments");const s=Lv(e,n.shape),r=nv(n,s,t);let i=r.shape;t||(i=Vv(r.shape,s));const a=oo(Bt(es(n,"float32"),ze(r,i))),o=nv(a,s,t);return{mean:r,variance:o}}const $G=ue({moments_:cde});function ude(n,e,t,s){const r=Q(e,"data","multiRNNCell"),i=Qy(t,"c","multiRNNCell"),a=Qy(s,"h","multiRNNCell");let o=r;const l=[];for(let p=0;p<n.length;p++){const m=n[p](o,i[p],a[p]);l.push(m[0]),l.push(m[1]),o=m[1]}const c=[],h=[];for(let p=0;p<l.length;p+=2)c.push(l[p]),h.push(l[p+1]);return[c,h]}const AG=ue({multiRNNCell_:ude});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hde(n,e,t,s=!1){const r=Q(n,"logits","multinomial"),i=r.size,a=r.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);t=t||Math.random();const l={logits:a===1?ze(r,[1,-1]):r},c={numSamples:e,seed:t,normalized:s},h=de.runKernel(bV,l,c);return a===1?ze(h,[h.size]):h}const RG=ue({multinomial_:hde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(n,e){let t=Q(n,"a","notEqual","string_or_numeric"),s=Q(e,"b","notEqual","string_or_numeric");[t,s]=cs(t,s),Fs(t.shape,s.shape);const r={a:t,b:s};return de.runKernel(wV,r)}const b2=ue({notEqual_:dde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fde(n){const t={x:Q(n,"x","onesLike")};return de.runKernel(NV,t)}const DG=ue({onesLike_:fde});function pde(n,e){const t=Q(n,"v1","outerProduct"),s=Q(e,"v2","outerProduct");se(t.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${s.rank}.`);const r=ze(t,[-1,1]),i=ze(s,[1,-1]);return Sn(r,i)}const LG=ue({outerProduct_:pde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mde(n,e,t=0){const s=Q(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:t},i={x:s};return de.runKernel(kV,i,r)}const Km=ue({pad_:mde});function gde(n,e,t=0){return se(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Km(n,[e],t)}const OG=ue({pad1d_:gde});function yde(n,e,t=0){return se(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Km(n,e,t)}const PG=ue({pad2d_:yde});function vde(n,e,t=0){return se(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Km(n,e,t)}const MG=ue({pad3d_:vde});function bde(n,e,t=0){return se(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Km(n,e,t)}const FG=ue({pad4d_:bde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _de(n,e,t){const s=Q(n,"x","spaceToBatchND");se(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),se(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),se(s.shape.reduce((a,o,l)=>l>0&&l<=e.length?a&&(o+t[l-1][0]+t[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:t};return de.runKernel(rU,r,i)}const _2=ue({spaceToBatchND_:_de});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xde(n,e,t,s,r,i,a){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const o=Q(n,"x","maxPool");let l=o,c=!1;o.rank===3&&(c=!0,l=ze(o,[1,o.shape[0],o.shape[1],o.shape[2]])),se(iu(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const h=R6(l.shape,e,i,r,s),p=[h.dilationHeight,h.dilationWidth];let m;s==="same"?m=Tde([h.filterHeight,h.filterWidth],p):m=[[0,0],[0,0]];const v=p[0]===1&&p[1]===1,[x,w]=wde([h.inHeight,h.inWidth],p,m),T=v?s:"valid",E=v?l:_2(l,p,x),$=(t==="avg"?()=>e2(E,e,i,T,a):()=>g2(E,e,i,T,a))(),R=v?$:t2($,p,w);return c?ze(R,[R.shape[1],R.shape[2],R.shape[3]]):R}function wde(n,e,t){const s=t.map(h=>h[0]),r=t.map(h=>h[1]),i=n.concat(s,r),a=e.map((h,p)=>(h-i[p]%h)%h),o=r.map((h,p)=>h+a[p]),l=e.map((h,p)=>[s[p],o[p]]),c=e.map((h,p)=>[0,a[p]]);return[l,c]}function Tde(n,e){const s=n.map((a,o)=>a+(a-1)*(e[o]-1)).map(a=>a-1),r=s.map(a=>Math.floor(a/2)),i=s.map((a,o)=>a-r[o]);return s.map((a,o)=>[r[o],i[o]])}const jG=ue({pool_:xde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sde(n,e){const t=Q(n,"x","prelu"),s=Q(e,"alpha","prelu"),r={x:t,alpha:s};return de.runKernel(AV,r)}const x2=ue({prelu_:Sde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ede(n,e=null,t=!1){let s=Q(n,"x","prod");s.dtype==="bool"&&(s=es(s,"int32"));const r={x:s},i={axis:e,keepDims:t};return de.runKernel(RV,r,i)}const BG=ue({prod_:Ede});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(n,e,t,s){const r=n.map((h,p)=>Q(h,`tensors${p}`,"raggedGather","int32")),i=Q(e,"paramsDenseValues","raggedGather"),a=Q(t,"indices","raggedGather","int32"),o={paramsNestedSplits:r,paramsDenseValues:i,indices:a},l={outputRaggedRank:s},c=de.runKernel(DV,o,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const zG=ue({raggedGather_:Nde});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ide(n,e,t,s,r){const i=Q(n,"shape","raggedTensorToTensor","int32"),a=Q(e,"values","raggedTensorToTensor"),o=Q(t,"defaultValue","raggedTensorToTensor",a.dtype),l=s.map((p,m)=>Q(p,`tensors${m}`,"raggedTensorToTensor","int32")),c={shape:i,values:a,defaultValue:o,rowPartitionTensors:l},h={rowPartitionTypes:r};return de.runKernel(LV,c,h)}const VG=ue({raggedTensorToTensor_:Ide});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cde(n,e,t){const s=Xn(n);let r=null;if(t==null||t==="float32")r=new Float32Array(s);else if(t==="int32")r=new Int32Array(s);else if(t==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${t}`);for(let i=0;i<s;i++)r[i]=e();return de.makeTensor(r,n,t)}const UG=ue({rand_:Cde});var s0={exports:{}},kde=s0.exports,bM;function $de(){return bM||(bM=1,(function(n){(function(e,t,s){function r(l){var c=this,h=o();c.next=function(){var p=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=p-(c.c=p|0)},c.c=1,c.s0=h(" "),c.s1=h(" "),c.s2=h(" "),c.s0-=h(l),c.s0<0&&(c.s0+=1),c.s1-=h(l),c.s1<0&&(c.s1+=1),c.s2-=h(l),c.s2<0&&(c.s2+=1),h=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function a(l,c){var h=new r(l),p=c&&c.state,m=h.next;return m.int32=function(){return h.next()*4294967296|0},m.double=function(){return m()+(m()*2097152|0)*11102230246251565e-32},m.quick=m,p&&(typeof p=="object"&&i(p,h),m.state=function(){return i(h,{})}),m}function o(){var l=4022871197,c=function(h){h=String(h);for(var p=0;p<h.length;p++){l+=h.charCodeAt(p);var m=.02519603282416938*l;l=m>>>0,m-=l,m*=l,l=m>>>0,m-=l,l+=m*4294967296}return(l>>>0)*23283064365386963e-26};return c}t&&t.exports?t.exports=a:this.alea=a})(kde,n)})(s0)),s0.exports}var r0={exports:{}},Ade=r0.exports,_M;function Rde(){return _M||(_M=1,(function(n){(function(e,t,s){function r(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var p=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^p^p>>>8},o===(o|0)?l.x=o:c+=o;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,l.next()}function i(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var c=new r(o),h=l&&l.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var m=c.next()>>>11,v=(c.next()>>>0)/4294967296,x=(m+v)/(1<<21);while(x===0);return x},p.int32=c.next,p.quick=p,h&&(typeof h=="object"&&i(h,c),p.state=function(){return i(c,{})}),p}t&&t.exports?t.exports=a:this.xor128=a})(Ade,n)})(r0)),r0.exports}var i0={exports:{}},Dde=i0.exports,xM;function Lde(){return xM||(xM=1,(function(n){(function(e,t,s){function r(o){var l=this,c="";l.next=function(){var p=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(p^p<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,h==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var c=new r(o),h=l&&l.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var m=c.next()>>>11,v=(c.next()>>>0)/4294967296,x=(m+v)/(1<<21);while(x===0);return x},p.int32=c.next,p.quick=p,h&&(typeof h=="object"&&i(h,c),p.state=function(){return i(c,{})}),p}t&&t.exports?t.exports=a:this.xorwow=a})(Dde,n)})(i0)),i0.exports}var a0={exports:{}},Ode=a0.exports,wM;function Pde(){return wM||(wM=1,(function(n){(function(e,t,s){function r(o){var l=this;l.next=function(){var h=l.x,p=l.i,m,v;return m=h[p],m^=m>>>7,v=m^m<<24,m=h[p+1&7],v^=m^m>>>10,m=h[p+3&7],v^=m^m>>>3,m=h[p+4&7],v^=m^m<<7,m=h[p+7&7],m=m^m<<13,v^=m^m<<9,h[p]=v,l.i=p+1&7,v};function c(h,p){var m,v=[];if(p===(p|0))v[0]=p;else for(p=""+p,m=0;m<p.length;++m)v[m&7]=v[m&7]<<15^p.charCodeAt(m)+v[m+1&7]<<13;for(;v.length<8;)v.push(0);for(m=0;m<8&&v[m]===0;++m);for(m==8?v[7]=-1:v[m],h.x=v,h.i=0,m=256;m>0;--m)h.next()}c(l,o)}function i(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var c=new r(o),h=l&&l.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var m=c.next()>>>11,v=(c.next()>>>0)/4294967296,x=(m+v)/(1<<21);while(x===0);return x},p.int32=c.next,p.quick=p,h&&(h.x&&i(h,c),p.state=function(){return i(c,{})}),p}t&&t.exports?t.exports=a:this.xorshift7=a})(Ode,n)})(a0)),a0.exports}var o0={exports:{}},Mde=o0.exports,TM;function Fde(){return TM||(TM=1,(function(n){(function(e,t,s){function r(o){var l=this;l.next=function(){var h=l.w,p=l.X,m=l.i,v,x;return l.w=h=h+1640531527|0,x=p[m+34&127],v=p[m=m+1&127],x^=x<<13,v^=v<<17,x^=x>>>15,v^=v>>>12,x=p[m]=x^v,l.i=m,x+(h^h>>>16)|0};function c(h,p){var m,v,x,w,T,E=[],C=128;for(p===(p|0)?(v=p,p=null):(p=p+"\0",v=0,C=Math.max(C,p.length)),x=0,w=-32;w<C;++w)p&&(v^=p.charCodeAt((w+32)%p.length)),w===0&&(T=v),v^=v<<10,v^=v>>>15,v^=v<<4,v^=v>>>13,w>=0&&(T=T+1640531527|0,m=E[w&127]^=v+T,x=m==0?x+1:0);for(x>=128&&(E[(p&&p.length||0)&127]=-1),x=127,w=512;w>0;--w)v=E[x+34&127],m=E[x=x+1&127],v^=v<<13,m^=m<<17,v^=v>>>15,m^=m>>>12,E[x]=v^m;h.w=T,h.X=E,h.i=x}c(l,o)}function i(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var c=new r(o),h=l&&l.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var m=c.next()>>>11,v=(c.next()>>>0)/4294967296,x=(m+v)/(1<<21);while(x===0);return x},p.int32=c.next,p.quick=p,h&&(h.X&&i(h,c),p.state=function(){return i(c,{})}),p}t&&t.exports?t.exports=a:this.xor4096=a})(Mde,n)})(o0)),o0.exports}var l0={exports:{}},jde=l0.exports,SM;function Bde(){return SM||(SM=1,(function(n){(function(e,t,s){function r(o){var l=this,c="";l.next=function(){var p=l.b,m=l.c,v=l.d,x=l.a;return p=p<<25^p>>>7^m,m=m-v|0,v=v<<24^v>>>8^x,x=x-p|0,l.b=p=p<<20^p>>>12^m,l.c=m=m-v|0,l.d=v<<16^m>>>16^x,l.a=x-p|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var h=0;h<c.length+20;h++)l.b^=c.charCodeAt(h)|0,l.next()}function i(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var c=new r(o),h=l&&l.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var m=c.next()>>>11,v=(c.next()>>>0)/4294967296,x=(m+v)/(1<<21);while(x===0);return x},p.int32=c.next,p.quick=p,h&&(typeof h=="object"&&i(h,c),p.state=function(){return i(c,{})}),p}t&&t.exports?t.exports=a:this.tychei=a})(jde,n)})(l0)),l0.exports}var c0={exports:{}};const zde={},Vde=Object.freeze(Object.defineProperty({__proto__:null,default:zde},Symbol.toStringTag,{value:"Module"})),Ude=yF(Vde);var Gde=c0.exports,EM;function Wde(){return EM||(EM=1,(function(n){(function(e,t,s){var r=256,i=6,a=52,o="random",l=s.pow(r,i),c=s.pow(2,a),h=c*2,p=r-1,m;function v(R,P,U){var j=[];P=P==!0?{entropy:!0}:P||{};var O=E(T(P.entropy?[R,$(t)]:R??C(),3),j),M=new x(j),B=function(){for(var D=M.g(i),W=l,H=0;D<c;)D=(D+H)*r,W*=r,H=M.g(1);for(;D>=h;)D/=2,W/=2,H>>>=1;return(D+H)/W};return B.int32=function(){return M.g(4)|0},B.quick=function(){return M.g(4)/4294967296},B.double=B,E($(M.S),t),(P.pass||U||function(D,W,H,ae){return ae&&(ae.S&&w(ae,M),D.state=function(){return w(M,{})}),H?(s[o]=D,W):D})(B,O,"global"in P?P.global:this==s,P.state)}function x(R){var P,U=R.length,j=this,O=0,M=j.i=j.j=0,B=j.S=[];for(U||(R=[U++]);O<r;)B[O]=O++;for(O=0;O<r;O++)B[O]=B[M=p&M+R[O%U]+(P=B[O])],B[M]=P;(j.g=function(D){for(var W,H=0,ae=j.i,te=j.j,Z=j.S;D--;)W=Z[ae=p&ae+1],H=H*r+Z[p&(Z[ae]=Z[te=p&te+W])+(Z[te]=W)];return j.i=ae,j.j=te,H})(r)}function w(R,P){return P.i=R.i,P.j=R.j,P.S=R.S.slice(),P}function T(R,P){var U=[],j=typeof R,O;if(P&&j=="object")for(O in R)try{U.push(T(R[O],P-1))}catch{}return U.length?U:j=="string"?R:R+"\0"}function E(R,P){for(var U=R+"",j,O=0;O<U.length;)P[p&O]=p&(j^=P[p&O]*19)+U.charCodeAt(O++);return $(P)}function C(){try{var R;return m&&(R=m.randomBytes)?R=R(r):(R=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(R)),$(R)}catch{var P=e.navigator,U=P&&P.plugins;return[+new Date,e,U,e.screen,$(t)]}}function $(R){return String.fromCharCode.apply(0,R)}if(E(s.random(),t),n.exports){n.exports=v;try{m=Ude}catch{}}else s["seed"+o]=v})(typeof self<"u"?self:Gde,[],Math)})(c0)),c0.exports}var tN,NM;function Hde(){if(NM)return tN;NM=1;var n=$de(),e=Rde(),t=Lde(),s=Pde(),r=Fde(),i=Bde(),a=Wde();return a.alea=n,a.xor128=e,a.xorwow=t,a.xorshift7=s,a.xor4096=r,a.tychei=i,tN=a,tN}var Xm=Hde();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let w2=class{constructor(e,t,s,r,i){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=i||Math.random();this.random=Xm.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,t,s=!1;for(;!s;){let r,i,a;do r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}};class qde{constructor(e,t,s,r){this.alpha=e,this.beta=1/t,this.dtype=s;const i=r||Math.random();this.randu=Xm.alea(i.toString()),this.randn=new w2(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,s,r,i,a;for(;;){do r=this.randn.nextValue(),a=1+this.c*r;while(a<=0);if(a*=a*a,e=r*r,t=1-.331*e*e,s=.5*e+this.d*(1-a+Math.log(a)),i=this.randu(),i<t||Math.log(i)<s)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}let Kde=class{constructor(e=0,t=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=Xm.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xde(n,e,t=1,s="float32",r){if(t==null&&(t=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const i=new qde(e,t,s,r),a=Ko(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const GG=ue({randomGamma_:Xde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zde(n,e=0,t=1,s,r){if(s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new w2(e,t,s,!1,r),a=Ko(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const T2=ue({randomNormal_:Zde});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yde(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return T2(n,0,1,e,t)}const WG=ue({randomStandardNormal_:Yde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qde(n,e=0,t=1,s="float32",r){const i=Ko(n,s),a=new Kde(e,t,null,r);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const S2=ue({randomUniform_:Qde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sm(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:e,step:t,dtype:s};return de.runKernel(OV,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jde(n){const t={x:Q(n,"x","reciprocal")};return de.runKernel(MV,t)}const HG=ue({reciprocal_:Jde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function efe(n){const t={x:Q(n,"x","relu")};return de.runKernel(FV,t)}const Wv=ue({relu_:efe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tfe(n){const t={x:Q(n,"x","relu6")};return de.runKernel(VV,t)}const E2=ue({relu6_:tfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nfe(n,e){const s={x:Q(n,"x","reverse")},r={dims:e};return de.runKernel(UV,s,r)}const Fh=ue({reverse_:nfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sfe(n){const e=Q(n,"x","reverse");return se(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Fh(e,0)}const qG=ue({reverse1d_:sfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(n,e){const t=Q(n,"x","reverse");return se(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),Fh(t,e)}const KG=ue({reverse2d_:rfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(n,e){const t=Q(n,"x","reverse");return se(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),Fh(t,e)}const XG=ue({reverse3d_:ife});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function afe(n,e){const t=Q(n,"x","reverse");return se(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),Fh(t,e)}const ZG=ue({reverse4d_:afe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ofe(n){const t={x:Q(n,"x","round")};return de.runKernel(GV,t)}const N2=ue({round_:ofe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lfe(n){const t={x:Q(n,"x","rsqrt","float32")};return de.runKernel(WV,t)}const YG=ue({rsqrt_:lfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cfe(n){const t={x:Q(n,"x","selu")};return de.runKernel(XV,t)}const QG=ue({selu_:cfe});function ufe(n,e,t,s,r,i=[1,1],a="NHWC"){const o=Q(n,"x","separableConv2d"),l=Q(e,"depthwiseFilter","separableConv2d"),c=Q(t,"pointwiseFilter","separableConv2d");let h=o,p=!1;if(o.rank===3&&(p=!0,h=ze(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");se(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),se(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),se(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),se(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),se(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const m=l.shape[2],v=l.shape[3];se(c.shape[2]===m*v,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${m*v}, but got ${c.shape[2]}.`);const x=ew(h,l,s,r,a,i),T=zv(x,c,1,"valid",a);return p?ze(T,[T.shape[1],T.shape[2],T.shape[3]]):T}const JG=ue({separableConv2d_:ufe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hfe(n,e){const t=Q(n,"x","setdiff1d"),s=Q(e,"y","setdiff1d");se(t.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${s.dtype}).`),se(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),se(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await t.data(),i=await s.data(),a=new Set(i);let o=0;for(let h=0;h<r.length;h++)a.has(r[h])||o++;const l=new B0([o],t.dtype),c=new B0([o],"int32");for(let h=0,p=0;h<r.length;h++)a.has(r[h])||(l.values[p]=r[h],c.values[p]=h,p++);return[l.toTensor(),c.toTensor()]}const eW=hfe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dfe(n){const t={x:Q(n,"x","sign")};return de.runKernel(JV,t)}const tW=ue({sign_:dfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ffe(n){const t={x:Q(n,"x","sin","float32")};return de.runKernel(YV,t)}const nW=ue({sin_:ffe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pfe(n){const t={x:Q(n,"x","sinh")};return de.runKernel(QV,t)}const sW=ue({sinh_:pfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mfe(n,e,t){const s=Q(n,"x","slice1d");return se(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Pn(s,[e],[t])}const rW=ue({slice1d_:mfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gfe(n,e,t){const s=Q(n,"x","slice2d");return se(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Pn(s,e,t)}const iW=ue({slice2d_:gfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yfe(n,e,t){const s=Q(n,"x","slice3d");return se(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Pn(s,e,t)}const aW=ue({slice3d_:yfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vfe(n,e,t){const s=Q(n,"x","slice4d");return se(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Pn(s,e,t)}const oW=ue({slice4d_:vfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bfe(n,e=-1){const t=Q(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},r={dim:e};return de.runKernel(aU,s,r)}const lW=ue({softmax_:bfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _fe(n){se(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return de.runKernel(Fz,e)}const rw=ue({fft_:_fe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xfe(n){se(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return de.runKernel(Kz,e)}const sv=ue({ifft_:xfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wfe(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const r=ze(n,[t,e]);s=sv(r)}else{const r=[t,2*(e-1)],i=ze(xm(n),[t,e]),a=ze(Fv(n),[t,e]),o=Fh(Pn(i,[0,1],[t,e-2]),1),l=Ye(Fh(Pn(a,[0,1],[t,e-2]),1),Zt(-1)),c=Fr([i,o],1),h=Fr([a,l],1),p=ze(Jc(c,h),[r[0],r[1]]);s=sv(p)}if(s=xm(s),n.rank===3&&n.shape[0]!==0){const r=s,i=n.shape[0];s=ze(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const I2=ue({irfft_:wfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tfe(n,e,t=0){const r={x:Q(n,"x","split")},i={numOrSizeSplits:e,axis:t};return de.runKernel(iU,r,i)}const Em=ue({split_:Tfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sfe(n,e){se(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let r;if(e!=null&&e<t){const x=n.shape.map(T=>0),w=n.shape.map(T=>T);w[n.shape.length-1]=e,r=Pn(n,x,w),t=e}else if(e!=null&&e>t){const x=n.shape.map(w=>w);x[n.shape.length-1]=e-t,r=Fr([n,wf(x)],n.shape.length-1),t=e}else r=n;const i=na(r),a=ze(Jc(r,i),[s,t]),o=rw(a),l=Math.floor(t/2)+1,c=xm(o),h=Fv(o),p=Em(c,[l,t-l],c.shape.length-1),m=Em(h,[l,t-l],h.shape.length-1),v=r.shape.slice();return v[r.shape.length-1]=l,ze(Jc(p[0],m[0]),v)}const iw=ue({rfft_:Sfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Efe(n,e){let t=Q(n,"a","squaredDifference"),s=Q(e,"b","squaredDifference");[t,s]=cs(t,s),Fs(t.shape,s.shape);const r={a:t,b:s},i={};return de.runKernel(dU,r,i)}const C2=ue({squaredDifference_:Efe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nfe(n,e){const t=Q(n,"x","squeeze","string_or_numeric");return ze(t,RB(t.shape,e).newShape)}const Hv=ue({squeeze_:Nfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(n,e=0){const t=Qy(n,"tensors","stack","string_or_numeric");se(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&se(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,r={axis:e};return de.runKernel(CV,s,r)}const Yl=ue({stack_:Ife});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cfe(n,e=0){const s={x:Q(n,"x","step")},r={alpha:e};return de.runKernel(NU,s,r)}const k2=ue({step_:Cfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kfe(n,e,t,s,r=0,i=0,a=0,o=0,l=0){const h={x:Q(n,"x","stridedSlice","string_or_numeric")},p={begin:e,end:t,strides:s,beginMask:r,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};return de.runKernel(fU,h,p)}const cW=ue({stridedSlice_:kfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $fe(n){const t={x:Q(n,"x","tan","float32")};return de.runKernel(vU,t)}const uW=ue({tan_:$fe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ro(n,e){Vf(n);const t=Kl(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Zh(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function om(n,e,t){if(Vf(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Kl(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Zh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hW(n,e,t){if(Vf(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Kl(n,t);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Zh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dW(n,e,t){if(Vf(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Kl(n,t);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Zh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fW(n,e,t){if(Vf(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Kl(n,t);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,Zh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Afe(n,e=1,t=!0){const s=Q(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},a={k:e,sorted:t},[o,l]=de.runKernel(_U,i,a);return{values:o,indices:l}}const pW=ue({topk_:Afe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(n,e=0,t=1,s,r){if(s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new w2(e,t,s,!0,r),a=Ko(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const mW=ue({truncatedNormal_:Rfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dfe(n,e=0){const t=Q(n,"x","unique","string_or_numeric");se(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},r={axis:e},[i,a]=de.runKernel(wU,s,r);return{values:i,indices:a}}const gW=ue({unique_:Dfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lfe(n,e,t){const s=Q(n,"x","unsortedSegmentSum"),r=Q(e,"segmentIds","unsortedSegmentSum","int32");se(bm(t),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},a={numSegments:t};return de.runKernel(SU,i,a)}const yW=ue({unsortedSegmentSum_:Lfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ofe(n,e=0){const t=Q(n,"x","unstack","string_or_numeric");se(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},r={axis:e};return de.runKernel(TU,s,r)}const Qh=ue({unstack_:Ofe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(n,e){return sw(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(n,e=!0,t,s){return de.makeVariable(n,e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const s=Ko(n,"int32"),r=Ko([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const a=s.indexToLoc(t[i]),o=i*n.length;r.values.set(a,o)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Pfe(n){const e=Q(n,"condition","whereAsync","bool"),t=await e.data(),s=_W(e.shape,t);return n!==e&&e.dispose(),s}const $2=Pfe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Mfe(n,e,t){const s=Q(n,"tensor","boolMask"),r=Q(e,"mask","boolMask","bool"),i=t??0,a=r.rank,o=s.shape;se(a>0,()=>"mask cannot be scalar"),fi(o.slice(i,i+a),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let w=i;w<i+a;w++)l*=o[w];const c=o.slice(0,i).concat([l],o.slice(i+a)),h=ze(s,c),p=ze(r,[-1]),m=await $2(p),v=Hv(m,[1]),x=l2(h,v,i);return n!==s&&s.dispose(),e!==r&&r.dispose(),v.dispose(),h.dispose(),p.dispose(),m.dispose(),x}const xW=Mfe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ffe(n,e,t,s,r=!0){const i=Q(n,"v","movingAverage"),a=Q(e,"x","movingAverage"),o=Q(t,"decay","movingAverage");LU(i,a),se(ql(i.shape,a.shape),()=>"Shape mismatch in v and x");const l=Zt(1),c=Bt(l,o);let h=Ye(Bt(a,i),c);if(r){se(s!=null,()=>"When using zeroDebias: true, step is required.");const p=Q(s,"step","movingAverage");h=Un(h,Bt(l,wm(o,p)))}return Nt(i,h)}const wW=ue({movingAverage_:Ffe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jfe(n,e,t){const s=Q(n,"indices","scatterND","int32"),r=Q(e,"updates","scatterND");Xk(r,s,t);const i={indices:s,updates:r},a={shape:t};return de.runKernel(HV,i,a)}const TW=ue({scatterND_:jfe});function Bfe(n,e,t,s){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const r=n.rank>0?n.shape[0]:1,i=n.rank>1?n.shape[1]:1;if(t.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${i}.`);const a=e.size;if(!(e.rank===0||e.rank===1&&a===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zfe(n,e,t,s=0){const r=Q(n,"sparseIndices","sparseToDense","int32"),i=Q(e,"sparseValues","sparseToDense","string_or_numeric"),a=Q(s,"defaultValue","sparseToDense",i.dtype);Bfe(r,i,t,a);const o={sparseIndices:r,sparseValues:i,defaultValue:a},l={outputShape:t};return de.runKernel(hU,o,l)}const SW=ue({sparseToDense_:zfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vfe(n,e){const t=Q(e,"indices","gatherND","int32"),r={params:Q(n,"x","gatherND","string_or_numeric"),indices:t};return de.runKernel(Wz,r)}const EW=ue({gatherND_:Vfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ufe(n,e){if(e==null)return n.shape.slice();if(ql(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gfe(n,e,t,s){const r=Q(n,"x","dropout");if(se(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),se(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof os?r.clone():r;const i=Ufe(r,t),a=1-e,o=Un(o2(Nt(S2(i,0,1,"float32",s),a)),a);return Ye(r,o)}const NW=ue({dropout_:Gfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A2(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function aw(n,e,t){const s=1-n%2,r=new Float32Array(n);for(let i=0;i<n;++i){const a=2*Math.PI*i/(n+s-1);r[i]=e-t*Math.cos(a)}return ro(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Wfe(n,e,t=1){const s=Q(n,"predictions","inTopK"),r=Q(e,"targets","inTopK");se(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),se(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),fi(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=s.shape[s.shape.length-1];se(t>0&&t<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${t}`);const a=await s.data(),o=await r.data(),[l,c]=[a.length/i,i],h=DB("bool",l);for(let p=0;p<l;p++){const m=p*c,v=a.subarray(m,m+c),x=[];for(let w=0;w<v.length;w++)x.push({value:v[w],index:w});x.sort((w,T)=>T.value-w.value),h[p]=0;for(let w=0;w<t;w++)if(x[w].index===o[p]){h[p]=1;break}}return n!==s&&s.dispose(),e!==r&&r.dispose(),Vo(h,r.shape,"bool")}const IW=Wfe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hfe(n,e,t,s,r,i="NHWC",a){let o=n;n.rank===3&&(o=ze(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=ze(e,[1,e.shape[0],e.shape[1],e.shape[2]])),se(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),se(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),se(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const c=i==="NHWC"?o.shape[3]:o.shape[1],h=i==="NHWC"?l.shape[3]:l.shape[1];se(c===t[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${t[2]}.`),se(h===t[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${t[3]}).`),uo("conv2dDerFilter",r,a);const p={x:o,dy:l},m={strides:s,pad:r,dataFormat:i,dimRoundingMode:a,filterShape:t};return de.runKernel(pz,p,m)}const qfe=ue({conv2DBackpropFilter_:Hfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ow(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return Ye(n,k2(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function lw(n,e){let t=e;const s=Hk(n.shape,e.shape);return s.length>0&&(t=Vn(t,s)),ze(t,n.shape)}function cw(n,e,t,s){if(e==="linear")return n;if(e==="relu")return Wv(n);if(e==="elu")return r2(n);if(e==="relu6")return E2(n);if(e==="prelu")return x2(n,t);if(e==="leakyrelu")return u2(n,s);if(e==="sigmoid")return sf(n);throw new Error(`Unknown fused activation ${e}.`)}const uw=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kfe({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:h}){if(l=l||"linear",uw(de.state.gradientDepth,l)===!1){se(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let U=zv(n,e,t,s,r,i,a);return o!=null&&(U=Nt(U,o)),cw(U,l,c,h)}const p=Q(n,"x","conv2d","float32"),m=Q(e,"filter","conv2d","float32");let v=p,x=!1;p.rank===3&&(x=!0,v=ze(p,[1,p.shape[0],p.shape[1],p.shape[2]])),se(v.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${v.rank}.`),se(m.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${m.rank}.`),uo("fused conv2d",s,a);const w=r==="NHWC"?v.shape[3]:v.shape[1];se(m.shape[2]===w,()=>`Error in conv2d: depth of input (${w}) must match input depth for filter ${m.shape[2]}.`),se(iu(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const T=jv(v.shape,m.shape,t,i,s,a);let E;o!=null&&(E=Q(o,"bias","fused conv2d"),[E]=cs(E,p),r==="NHWC"?Fs(T.outShape,E.shape):(se(E.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${E.shape.length}.`),se(E.shape.length===0||E.shape[0]===T.outChannels||E.shape[0]===1,()=>`Error in fused conv2d: bias shape (${E.shape}) is not compatible with the number of output channels (${T.outChannels})`)));let C;if(c!=null){const U=c.shape;if(se(U.length<=1||U.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${U.length}.`),U.length===1)se(U[0]===1||U[0]===T.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${U}) is not compatible with the number of output channels (${T.outChannels}).`);else if(U.length===3)try{Fs(U,T.outShape)}catch{const O=`Error in fused conv2d: PReLU activation weights (${U}) is not compatible with the output shape of the conv2d (${T.outShape}).`;throw Error(O)}C=Q(c,"prelu weights","fused conv2d")}const $=(U,j)=>{se(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[O,M,B,D]=j,W=ow(U,B,l);se(ev(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const H=K6(M.shape,W,O,t,s),ae=qfe(M,W,O.shape,t,s),te=[H,ae];if(D!=null){const Z=lw(D,W);te.push(Z)}return te},R={x:v,filter:m,bias:E,preluActivationWeights:C},P={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:h};return o==null?Zl((j,O,M)=>{let B=de.runKernel(rI,R,P);return M([O,j,B]),x&&(B=ze(B,[B.shape[1],B.shape[2],B.shape[3]])),{value:B,gradFunc:$}})(v,m):Zl((j,O,M,B)=>{let D=de.runKernel(rI,R,P);return B([O,j,D,M]),x&&(D=ze(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:$}})(v,m,E)}const Xfe=ue({fusedConv2d_:Kfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zfe(n,e,t,s,r,i=[1,1],a){let o=n;n.rank===3&&(o=ze(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=ze(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:o,dy:l},h={strides:s,pad:r,dimRoundingMode:a,dilations:i,filterShape:t};return de.runKernel(Nz,c,h)}const Yfe=ue({depthwiseConv2dNativeBackpropFilter_:Zfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qfe(n,e,t,s,r,i=[1,1],a){let o=e,l=!1;e.rank===3&&(l=!0,o=ze(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:o,filter:t},h={strides:s,pad:r,dimRoundingMode:a,dilations:i,inputShape:n},p=de.runKernel(Iz,c,h);return l?ze(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Jfe=ue({depthwiseConv2dNativeBackpropInput_:Qfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function epe({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:h}){if(uw(de.state.gradientDepth,l)===!1){let P=ew(n,e,t,s,r,i,a);return o!=null&&(P=Nt(P,o)),cw(P,l,c,h)}const p=Q(n,"x","depthwiseConv2d","float32"),m=Q(e,"filter","depthwiseConv2d","float32");let v=p,x=!1;p.rank===3&&(x=!0,v=ze(p,[1,p.shape[0],p.shape[1],p.shape[2]])),se(v.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${v.rank}.`),se(m.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${m.rank}.`),se(v.shape[3]===m.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${v.shape[3]}) must match the inChannels dimension in filter ${m.shape[2]}.`),i==null&&(i=[1,1]),se(iu(t,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),uo("fused depthwiseConv2d",s,a);const w=jv(v.shape,m.shape,t,i,s,a,!0);let T;o!=null&&(T=Q(o,"bias","fused conv2d"),[T]=cs(T,p),Fs(w.outShape,T.shape));let E;c!=null&&(E=Q(c,"prelu weights","fused depthwiseConv2d"));const C=(P,U)=>{se(ev(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[j,O,M,B]=U,D=ow(P,M,l),W=Jfe(O.shape,D,j,t,s,i,a),H=Yfe(O,D,j.shape,t,s,i,a);if(B!=null){const ae=lw(T,D);return[W,H,ae]}return[W,H]},$={x:v,filter:m,bias:T,preluActivationWeights:E},R={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:h};return o==null?Zl((U,j,O)=>{let M=de.runKernel(iI,$,R);return O([j,U,M]),x&&(M=ze(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:C}})(v,m):Zl((U,j,O,M)=>{let B=de.runKernel(iI,$,R);return M([j,U,B,O]),x&&(B=ze(B,[B.shape[1],B.shape[2],B.shape[3]])),{value:B,gradFunc:C}})(v,m,T)}const tpe=ue({fusedDepthwiseConv2d_:epe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function npe({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(uw(de.state.gradientDepth,i)===!1){let D=Sn(n,e,t,s);return r!=null&&(D=Nt(D,r)),cw(D,i,a,o)}let l=Q(n,"a","fused matMul"),c=Q(e,"b","fused matMul");[l,c]=cs(l,c);const h=t?l.shape[l.rank-2]:l.shape[l.rank-1],p=s?c.shape[c.rank-1]:c.shape[c.rank-2],m=t?l.shape[l.rank-1]:l.shape[l.rank-2],v=s?c.shape[c.rank-2]:c.shape[c.rank-1],x=l.shape.slice(0,-2),w=c.shape.slice(0,-2),T=Xn(x),E=Xn(w);se(h===p,()=>`Error in fused matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${t} and transposeB=${s} must match.`);const $=Fs(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([m,v]),R=t?ze(l,[T,h,m]):ze(l,[T,m,h]),P=s?ze(c,[E,v,p]):ze(c,[E,p,v]);let U;r!=null&&(U=Q(r,"bias","fused matMul"),[U]=cs(U,l),Fs($,U.shape));let j;a!=null&&(j=Q(a,"prelu weights","fused matMul"));const O=(D,W)=>{const[H,ae,te,Z]=W,re=ow(ze(D,te.shape),te,i);let ne,he;if(!t&&!s?(ne=Sn(re,ae,!1,!0),he=Sn(H,re,!0,!1)):!t&&s?(ne=Sn(re,ae,!1,!1),he=Sn(re,H,!0,!1)):t&&!s?(ne=Sn(ae,re,!1,!0),he=Sn(H,re,!1,!1)):(ne=Sn(ae,re,!0,!0),he=Sn(re,H,!0,!0)),r!=null){const K=lw(Z,re);return[ne,he,K]}else return[ne,he]},M={a:R,b:P,bias:U,preluActivationWeights:j},B={transposeA:t,transposeB:s,activation:i,leakyreluAlpha:o};return r==null?Zl((W,H,ae)=>{const te=de.runKernel(sI,M,B);return ae([W,H,te]),{value:ze(te,$),gradFunc:O}})(R,P):Zl((W,H,ae,te)=>{const Z=de.runKernel(sI,M,B);return te([W,H,Z,ae]),{value:ze(Z,$),gradFunc:O}})(R,P,U)}const spe=ue({fusedMatMul_:npe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CW=Object.freeze(Object.defineProperty({__proto__:null,conv2d:Xfe,depthwiseConv2d:tpe,matMul:spe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rpe(n){return aw(n,.54,.46)}const ipe=ue({hammingWindow_:rpe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ape(n){return aw(n,.5,.5)}const kW=ue({hannWindow_:ape});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ope(n,e,t,s=!1,r=0){let i=0;const a=[];for(;i+e<=n.size;)a.push(Pn(n,i,e)),i+=t;if(s)for(;i<n.size;){const o=i+e-n.size,l=Fr([Pn(n,i,e-o),qm([o],r)]);a.push(l),i+=t}return a.length===0?om([],[0,e]):ze(Fr(a),[a.length,e])}const $W=ue({frame_:ope});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lpe(n,e,t,s,r=kW){s==null&&(s=A2(e));const i=$W(n,e,t),a=Ye(i,r(e));return iw(a,s)}const cpe=ue({stft_:lpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function upe(n,e,t,s,r="bilinear",i=0){const a=Q(n,"image","cropAndResize"),o=Q(e,"boxes","cropAndResize","float32"),l=Q(t,"boxInd","cropAndResize","int32"),c=o.shape[0];se(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),se(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),se(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),se(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),se(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),se(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const h={image:a,boxes:o,boxInd:l},p={method:r,extrapolationValue:i,cropSize:s};return de.runKernel(wz,h,p)}const hpe=ue({cropAndResize_:upe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(n){const e=Q(n,"image","flipLeftRight","float32");se(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return de.runKernel(Bz,t,{})}const fpe=ue({flipLeftRight_:dpe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ppe(n){const e=Q(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];se(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),se(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,t),r[t]=3,am(e,r)}const mpe=ue({grayscaleToRGB_:ppe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gpe(n,e,t=0,s=.5){const r=Q(n,"image","rotateWithOffset","float32");se(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},a={radians:e,fillValue:t,center:s};return de.runKernel(IU,i,a)}const ype=ue({rotateWithOffset_:gpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zm(n,e,t,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const a=n.shape[0];return t=Math.min(t,a),se(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),se(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),se(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),se(e.rank===1,()=>"scores must be a 1D tensor"),se(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),se(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vpe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const i=Q(n,"boxes","nonMaxSuppression","float32"),a=Q(e,"scores","nonMaxSuppression","float32"),o=Zm(i,a,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l={maxOutputSize:t,iouThreshold:s,scoreThreshold:r};return de.runKernel(TV,{boxes:i,scores:a},l)}const bpe=ue({nonMaxSuppression_:vpe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _pe(n,e,t){const s=xpe(n,e,t),r=s<0?-(s+1):s;n.splice(r,0,e)}function xpe(n,e,t){return Tpe(n,e,t||wpe)}function wpe(n,e){return n>e?1:n<e?-1:0}function Tpe(n,e,t){let s=0,r=n.length,i=0,a=!1;for(;s<r;){i=s+(r-s>>>1);const o=t(e,n[i]);o>0?s=i+1:(r=i,a=!o)}return a?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(n,e,t,s,r){return R2(n,e,t,s,r,0)}function RW(n,e,t,s,r,i){return R2(n,e,t,s,r,0,!1,i,!0)}function DW(n,e,t,s,r,i){return R2(n,e,t,s,r,i,!0)}function R2(n,e,t,s,r,i,a=!1,o=!1,l=!1){const c=[];for(let T=0;T<e.length;T++)e[T]>r&&c.push({score:e[T],boxIndex:T,suppressBeginIndex:0});c.sort(IM);const h=i>0?-.5/i:0,p=[],m=[];for(;p.length<t&&c.length>0;){const T=c.pop(),{score:E,boxIndex:C,suppressBeginIndex:$}=T;if(E<r)break;let R=!1;for(let P=p.length-1;P>=$;--P){const U=Spe(n,C,p[P]);if(U>=s){R=!0;break}if(T.score=T.score*Epe(s,h,U),T.score<=r)break}T.suppressBeginIndex=p.length,R||(T.score===E?(p.push(C),m.push(T.score)):T.score>r&&_pe(c,T,IM))}const v=p.length,x=t-v;o&&x>0&&(p.push(...new Array(x).fill(0)),m.push(...new Array(x).fill(0)));const w={selectedIndices:p};return a&&(w.selectedScores=m),l&&(w.validOutputs=v),w}function Spe(n,e,t){const s=n.subarray(e*4,e*4+4),r=n.subarray(t*4,t*4+4),i=Math.min(s[0],s[2]),a=Math.min(s[1],s[3]),o=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),h=Math.min(r[1],r[3]),p=Math.max(r[0],r[2]),m=Math.max(r[1],r[3]),v=(o-i)*(l-a),x=(p-c)*(m-h);if(v<=0||x<=0)return 0;const w=Math.max(i,c),T=Math.max(a,h),E=Math.min(o,p),C=Math.min(l,m),$=Math.max(E-w,0)*Math.max(C-T,0);return $/(v+x-$)}function Epe(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function IM(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Npe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const i=Q(n,"boxes","nonMaxSuppressionAsync"),a=Q(e,"scores","nonMaxSuppressionAsync"),o=Zm(i,a,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l=await Promise.all([i.data(),a.data()]),c=l[0],h=l[1],{selectedIndices:p}=AW(c,h,t,s,r);return i!==n&&i.dispose(),a!==e&&a.dispose(),ro(p,"int32")}const Ipe=Npe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cpe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const a=Q(n,"boxes","nonMaxSuppression"),o=Q(e,"scores","nonMaxSuppression"),l=Zm(a,o,t,s,r,i);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:a,scores:o},h={maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},p=de.runKernel(EV,c,h);return{selectedIndices:p[0],selectedScores:p[1]}}const kpe=ue({nonMaxSuppressionWithScore_:Cpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function $pe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const a=Q(n,"boxes","nonMaxSuppressionAsync"),o=Q(e,"scores","nonMaxSuppressionAsync"),l=Zm(a,o,t,s,r,i);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([a.data(),o.data()]),h=c[0],p=c[1],{selectedIndices:m,selectedScores:v}=DW(h,p,t,s,r,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:ro(m,"int32"),selectedScores:ro(v)}}const Ape=$pe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const a=Q(n,"boxes","nonMaxSuppression"),o=Q(e,"scores","nonMaxSuppression"),l=Zm(a,o,t,s,r,null),c=l.maxOutputSize,h=l.iouThreshold,p=l.scoreThreshold,m={boxes:a,scores:o},v={maxOutputSize:c,iouThreshold:h,scoreThreshold:p,padToMaxOutputSize:i},x=de.runKernel(SV,m,v);return{selectedIndices:x[0],validOutputs:x[1]}}const Dpe=ue({nonMaxSuppressionPadded_:Rpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Lpe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const a=Q(n,"boxes","nonMaxSuppressionAsync"),o=Q(e,"scores","nonMaxSuppressionAsync"),l=Zm(a,o,t,s,r,null),c=l.maxOutputSize,h=l.iouThreshold,p=l.scoreThreshold,[m,v]=await Promise.all([a.data(),o.data()]),{selectedIndices:x,validOutputs:w}=RW(m,v,c,h,p,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:ro(x,"int32"),validOutputs:Zt(w,"int32")}}const Ope=Lpe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppe(n,e,t=!1,s=!1){const r=Q(n,"images","resizeBilinear");se(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),se(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),se(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,a=!1;r.rank===3&&(a=!0,i=ze(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:s,size:e},c=de.runKernel(zV,o,l);return a?ze(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Mpe=ue({resizeBilinear_:Ppe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpe(n,e,t=!1,s=!1){const r=Q(n,"images","resizeNearestNeighbor");se(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),se(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),se(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),se(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,a=!1;r.rank===3&&(a=!0,i=ze(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:s,size:e},c=de.runKernel(BV,o,l);return a?ze(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const jpe=ue({resizeNearestNeighbor_:Fpe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bpe(n,e="binary",t=!1,s=.5){const r=Q(n,"image","threshold"),i=.2989,a=.587,o=.114,l=r.shape[0]*r.shape[1];let c=Ye(ro([s]),255),h,p,m,v;if(se(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),se(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),se(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),se(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[h,p,m]=Em(r,[1,1,1],-1);const T=Ye(h,i),E=Ye(p,a),C=Ye(m,o);v=Nt(Nt(T,E),C)}else v=n;if(e==="otsu"){const T=n2(es(N2(v),"int32"),Vo([]),256);c=zpe(T,l)}const x=t?tw(v,c):Gv(v,c);return es(Ye(x,255),"int32")}function zpe(n,e){let t=ro([-1]),s=ro([0]),r=ro([0]),i,a,o,l,c,h;for(let p=0;p<n.size-1;p++){i=Pn(n,0,p+1),a=Pn(n,p+1),c=Un(Vn(i),e),h=Un(Vn(a),e);const m=Vn(Ye(i,Sm(0,i.size)));o=Un(m,Vn(i));const v=qm(a.shape,i.size),x=Nt(Sm(0,a.size),v),w=Ye(a,x);l=Un(Vn(w),Vn(a));const T=Bt(o,l),E=Bt(o,l),C=Ye(c,h);r=Ye(Ye(C,T),E);const $=Gv(r,s);s=xf($,r,s),t=xf($,ro([p]),t)}return t}const Vpe=ue({threshold_:Bpe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Upe(n,e,t="nearest",s="constant",r=0,i){const a=Q(n,"image","transform","float32"),o=Q(e,"transforms","transform","float32");se(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),se(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),se(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:a,transforms:o},c={interpolation:t,fillMode:s,fillValue:r,outputShape:i};return de.runKernel(xU,l,c)}const Gpe=ue({transform_:Upe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wpe(n,e,t){se(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),se(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`);const s=Q(n,"a","bandPart");se(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,a]=s.shape.slice(-2);if(!(e<=i))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`);if(!(t<=a))throw new Error(`bandPart(): numUpper (${t}) must not be greater than the number of columns (${a}).`);e<0&&(e=i),t<0&&(t=a);const o=ze(Sm(0,i,1,"int32"),[-1,1]),l=Sm(0,a,1,"int32"),c=Bt(o,l),h=tv(tw(c,Zt(+e,"int32")),c2(c,Zt(-t,"int32"))),p=wf([i,a],s.dtype);return ze(Yl(Qh(ze(s,[-1,i,a])).map(m=>xf(h,m,p))),r)}const Hpe=ue({bandPart_:Wpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qpe(n){let e;if(Array.isArray(n)){e=!1,se(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let i=1;i<n.length;++i)se(n[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${r})`)}else e=!0,n=Em(n,n.shape[0],0).map(r=>Hv(r,[0]));se(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let r=0;r<n.length;++r)t.push(de.tidy(()=>{let i=s[r];if(r>0)for(let a=0;a<r;++a){const o=Ye(Vn(Ye(t[a],i)),t[a]);i=Bt(i,o)}return Un(i,Uv(i,"euclidean"))}));return e?Yl(t,0):t}const Kpe=ue({gramSchmidt_:qpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xpe(n,e=!1){if(se(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return CM(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,c)=>l*c),s=Qh(ze(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,h]=CM(l,e);r.push(c),i.push(h)});const a=ze(Yl(r,0),n.shape),o=ze(Yl(i,0),n.shape);return[a,o]}}function CM(n,e=!1){return de.tidy(()=>{se(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let r=a2(t),i=Hc(n);const a=om([[1]],[1,1]);let o=Hc(a);const l=t>=s?s:t;for(let c=0;c<l;++c){const h=i,p=o,m=r;[o,i,r]=de.tidy(()=>{const v=Pn(i,[c,c],[t-c,1]),x=Uv(v),w=Pn(i,[c,c],[1,1]),T=xf(Gv(w,0),om([[-1]]),om([[1]])),E=Bt(w,Ye(T,x)),C=Un(v,E);C.shape[0]===1?o=Hc(a):o=Fr([a,Pn(C,[1,0],[C.shape[0]-1,C.shape[1]])],0);const $=Ml(Un(Sn(T,E),x)),R=Pn(i,[c,0],[t-c,s]),P=Ye($,o),U=Jy(o);if(c===0)i=Bt(R,Sn(P,Sn(U,R)));else{const M=Bt(R,Sn(P,Sn(U,R)));i=Fr([Pn(i,[0,0],[c,s]),M],0)}const j=Jy(P),O=Pn(r,[0,c],[t,r.shape[1]-c]);if(c===0)r=Bt(O,Sn(Sn(O,o),j));else{const M=Bt(O,Sn(Sn(O,o),j));r=Fr([Pn(r,[0,0],[t,c]),M],1)}return[o,i,r]}),Mr([h,p,m])}return!e&&t>s&&(r=Pn(r,[0,0],[t,s]),i=Pn(i,[0,0],[s,s])),[r,i]})}const Zpe=ue({qr_:Xpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var oi;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(oi||(oi={}));function Ype(n,e,t=oi.SUM_BY_NONZERO_WEIGHTS){const s=Q(n,"losses","computeWeightedLoss");let r=null;e!=null&&(r=Q(e,"weights","computeWeightedLoss"));const i=r==null?s:Ye(s,r);if(t===oi.NONE)return i;if(t===oi.SUM)return Vn(i);if(t===oi.MEAN){if(r==null)return nv(i);{const a=s.size/r.size,o=Un(Vn(i),Vn(r));return a>1?Un(o,Zt(a)):o}}if(t===oi.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Un(Vn(i),Zt(s.size));{const a=Ye(r,fh(s.shape)),o=es(Vn(b2(a,Zt(0))),"float32");return Un(Vn(i),o)}}throw Error(`Unknown reduction: ${t}`)}const au=ue({computeWeightedLoss_:Ype});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qpe(n,e,t,s=oi.SUM_BY_NONZERO_WEIGHTS){const r=Q(n,"labels","absoluteDifference"),i=Q(e,"predictions","absoluteDifference");let a=null;t!=null&&(a=Q(t,"weights","absoluteDifference")),fi(r.shape,i.shape,"Error in absoluteDifference: ");const o=Qi(Bt(r,i));return au(o,a,s)}const Jpe=ue({absoluteDifference_:Qpe});function eme(n,e,t,s,r=oi.SUM_BY_NONZERO_WEIGHTS){const i=Q(n,"labels","cosineDistance"),a=Q(e,"predictions","cosineDistance");let o=null;s!=null&&(o=Q(s,"weights","cosineDistance")),fi(i.shape,a.shape,"Error in cosineDistance: ");const l=Zt(1),c=Bt(l,Vn(Ye(i,a),t,!0));return au(c,o,r)}const tme=ue({cosineDistance_:eme});function nme(n,e,t,s=oi.SUM_BY_NONZERO_WEIGHTS){let r=Q(n,"labels","hingeLoss");const i=Q(e,"predictions","hingeLoss");let a=null;t!=null&&(a=Q(t,"weights","hingeLoss")),fi(r.shape,i.shape,"Error in hingeLoss: ");const o=Zt(1);r=Bt(Ye(Zt(2),r),o);const l=Wv(Bt(o,Ye(r,i)));return au(l,a,s)}const sme=ue({hingeLoss_:nme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rme(n,e,t,s=1,r=oi.SUM_BY_NONZERO_WEIGHTS){const i=Q(n,"labels","huberLoss"),a=Q(e,"predictions","huberLoss");let o=null;t!=null&&(o=Q(t,"weights","huberLoss")),fi(i.shape,a.shape,"Error in huberLoss: ");const l=Zt(s),c=Qi(Bt(a,i)),h=v2(c,l),p=Bt(c,h),m=Nt(Ye(Zt(.5),oo(h)),Ye(l,p));return au(m,o,r)}const ime=ue({huberLoss_:rme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ame(n,e,t,s=1e-7,r=oi.SUM_BY_NONZERO_WEIGHTS){const i=Q(n,"labels","logLoss"),a=Q(e,"predictions","logLoss");let o=null;t!=null&&(o=Q(t,"weights","logLoss")),fi(i.shape,a.shape,"Error in logLoss: ");const l=Zt(1),c=Zt(s),h=Ml(Ye(i,Tm(Nt(a,c)))),p=Ye(Bt(l,i),Tm(Nt(Bt(l,a),c))),m=Bt(h,p);return au(m,o,r)}const ome=ue({logLoss_:ame});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lme(n,e,t,s=oi.SUM_BY_NONZERO_WEIGHTS){const r=Q(n,"labels","meanSquaredError"),i=Q(e,"predictions","meanSquaredError");let a=null;t!=null&&(a=Q(t,"weights","meanSquaredError")),fi(r.shape,i.shape,"Error in meanSquaredError: ");const o=C2(r,i);return au(o,a,s)}const cme=ue({meanSquaredError_:lme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ume(n,e){const t=Q(n,"labels","sigmoidCrossEntropyWithLogits"),s=Q(e,"logits","sigmoidCrossEntropyWithLogits");fi(t.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Wv(s),i=Ye(s,t),a=h2(Mh(Ml(Qi(s))));return Nt(Bt(r,i),a)}function hme(n,e,t,s=0,r=oi.SUM_BY_NONZERO_WEIGHTS){let i=Q(n,"multiClassLabels","sigmoidCrossEntropy");const a=Q(e,"logits","sigmoidCrossEntropy");let o=null;if(t!=null&&(o=Q(t,"weights","sigmoidCrossEntropy")),fi(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=Zt(s),h=Zt(1),p=Zt(.5);i=Nt(Ye(i,Bt(h,c)),Ye(p,c))}const l=ume(i,a);return au(l,o,r)}const dme=ue({sigmoidCrossEntropy_:hme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fme(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Zl((r,i,a)=>{const l=f2(i,[t],!0),c=Bt(es(i,"float32"),l);a([r,c]);const h=Ml(Ye(c,r));return{value:Vn(h,[t]),gradFunc:(v,x)=>{const[w,T]=x,E=Vv(v.shape,[t]);return[Ye(ze(v,E),Bt(es(w,"float32"),Mh(T))),Ye(ze(v,E),Bt(Mh(T),es(w,"float32")))]}}})(n,e)}function pme(n,e,t,s=0,r=oi.SUM_BY_NONZERO_WEIGHTS){let i=Q(n,"onehotLabels","softmaxCrossEntropy");const a=Q(e,"logits","softmaxCrossEntropy");let o=null;if(t!=null&&(o=Q(t,"weights","softmaxCrossEntropy")),fi(i.shape,a.shape,"Error in softmaxCrossEntropy: "),s>0){const c=Zt(s),h=Zt(1),p=Zt(i.shape[1]);i=Nt(Ye(i,Bt(h,c)),Un(c,p))}const l=fme(i,a);return au(l,o,r)}const mme=ue({softmaxCrossEntropy_:pme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gme(n,e,t,s){const r=Q(n,"indices","sparseFillEmptyRows","int32"),i=Q(e,"values","sparseFillEmptyRows"),a=Q(t,"denseShape","sparseFillEmptyRows","int32"),o=Q(s,"defaultValue","sparseFillEmptyRows",i.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:r,values:i,denseShape:a,defaultValue:o},c=de.runKernel(oU,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const yme=ue({sparseFillEmptyRows_:gme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vme(n,e,t){const s=Q(n,"inputIndices","sparseReshape","int32"),r=Q(e,"inputShape","sparseReshape","int32"),i=Q(t,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const a={inputIndices:s,inputShape:r,newShape:i},o=de.runKernel(lU,a);return{outputIndices:o[0],outputShape:o[1]}}const bme=ue({sparseReshape_:vme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _me(n,e,t){const s=Q(n,"data","sparseSegmentMean"),r=Q(e,"indices","sparseSegmentMean","int32"),i=Q(t,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const a={data:s,indices:r,segmentIds:i};return de.runKernel(cU,a)}const xme=ue({sparseSegmentMean_:_me});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wme(n,e,t){const s=Q(n,"data","sparseSegmentSum"),r=Q(e,"indices","sparseSegmentSum","int32"),i=Q(t,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const a={data:s,indices:r,segmentIds:i};return de.runKernel(uU,a)}const Tme=ue({sparseSegmentSum_:wme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sme(n,e,t,s,r,i,a,o){const l=Q(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=Q(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const h={separator:t,nGramWidths:s,leftPad:r,rightPad:i,padWidth:a,preserveShortSequences:o},p={data:l,dataSplits:c},m=de.runKernel(pU,p,h);return{nGrams:m[0],nGramsSplits:m[1]}}const Eme=ue({stringNGrams_:Sme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nme(n,e,t=!0){const s=Q(n,"input","stringSplit","string"),r=Q(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const i={skipEmpty:t},a={input:s,delimiter:r},o=de.runKernel(mU,a,i);return{indices:o[0],values:o[1],shape:o[2]}}const Ime=ue({stringSplit_:Nme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cme(n,e){const t=Q(n,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:t};return de.runKernel(gU,r,s)}const kme=ue({stringToHashBucketFast_:Cme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LW={fft:rw,ifft:sv,rfft:iw,irfft:I2},OW={hammingWindow:ipe,hannWindow:kW,frame:$W,stft:cpe},D2={flipLeftRight:fpe,grayscaleToRGB:mpe,resizeNearestNeighbor:jpe,resizeBilinear:Mpe,rotateWithOffset:ype,cropAndResize:hpe,nonMaxSuppression:bpe,nonMaxSuppressionAsync:Ipe,nonMaxSuppressionWithScore:kpe,nonMaxSuppressionWithScoreAsync:Ape,nonMaxSuppressionPadded:Dpe,nonMaxSuppressionPaddedAsync:Ope,threshold:Vpe,transform:Gpe},PW={bandPart:Hpe,gramSchmidt:Kpe,qr:Zpe},MW={absoluteDifference:Jpe,computeWeightedLoss:au,cosineDistance:tme,hingeLoss:sme,huberLoss:ime,logLoss:ome,meanSquaredError:cme,sigmoidCrossEntropy:dme,softmaxCrossEntropy:mme},FW={sparseFillEmptyRows:yme,sparseReshape:bme,sparseSegmentMean:xme,sparseSegmentSum:Tme},jW={stringNGrams:Eme,stringSplit:Ime,stringToHashBucketFast:kme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Jh=class extends g6{minimize(e,t=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const a=s.map(o=>({name:o.name,tensor:i[o.name]}));this.applyGradients(a)}else this.applyGradients(i);return Mr(i),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return _G(e,t)}dispose(){this.iterations_!=null&&Mr(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Zt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty(Jh,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let hw=class extends Jh{constructor(e,t,s=null){super(),this.learningRate=e,this.rho=t,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=de.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=de.registeredVariables[s],a=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:pn(()=>na(i).variable(a))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:pn(()=>na(i).variable(a))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;pn(()=>{const h=Nt(Ye(l,this.rho),Ye(oo(o),1-this.rho)),p=Ye(Un(Xl(Nt(c,this.epsilon)),Xl(Nt(l,this.epsilon))),o),m=Nt(Ye(c,this.rho),Ye(oo(p),1-this.rho));l.assign(h),c.assign(m);const v=Nt(Ye(p,-this.learningRate),i);i.assign(v)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Mr(this.accumulatedGrads.map(e=>e.variable)),Mr(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}};hw.className="Adadelta";Yh(hw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let dw=class extends Jh{constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=de.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:pn(()=>qm(i.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const o=this.accumulatedGrads[r].variable;pn(()=>{const l=Nt(o,oo(a));o.assign(l);const c=Nt(Ye(Un(a,Xl(Nt(l,de.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Mr(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}};dw.className="Adagrad";Yh(dw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fw=class extends Jh{constructor(e,t,s,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],pn(()=>{this.accBeta1=Zt(t).variable(),this.accBeta2=Zt(s).variable()}),r==null&&(this.epsilon=de.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);pn(()=>{const s=Bt(1,this.accBeta1),r=Bt(1,this.accBeta2);t.forEach((i,a)=>{const o=de.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:pn(()=>na(o).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${i}/v`,variable:pn(()=>na(o).variable(l))});const c=Array.isArray(e)?e[a].tensor:e[i];if(c==null)return;const h=this.accumulatedFirstMoment[a].variable,p=this.accumulatedSecondMoment[a].variable,m=Nt(Ye(h,this.beta1),Ye(c,1-this.beta1)),v=Nt(Ye(p,this.beta2),Ye(oo(c),1-this.beta2)),x=Un(m,s),w=Un(v,r);h.assign(m),p.assign(v);const T=Nt(Ye(Un(x,Nt(Xl(w),this.epsilon)),-this.learningRate),o);o.assign(T)}),this.accBeta1.assign(Ye(this.accBeta1,this.beta1)),this.accBeta2.assign(Ye(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Mr(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Mr(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),pn(()=>{this.accBeta1.assign(wm(this.beta1,this.iterations_+1)),this.accBeta2.assign(wm(this.beta2,this.iterations_+1))});const t=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}};fw.className="Adam";Yh(fw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let pw=class extends Jh{constructor(e,t,s,r=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],pn(()=>{this.iteration=Zt(0).variable(),this.accBeta1=Zt(t).variable()}),r==null&&(this.epsilon=de.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);pn(()=>{const s=Bt(1,this.accBeta1),r=Un(-this.learningRate,Nt(Ye(this.iteration,this.decay),1));t.forEach((i,a)=>{const o=de.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:na(o).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${i}/v`,variable:na(o).variable(l)});const c=Array.isArray(e)?e[a].tensor:e[i];if(c==null)return;const h=this.accumulatedFirstMoment[a].variable,p=this.accumulatedWeightedInfNorm[a].variable,m=Nt(Ye(h,this.beta1),Ye(c,1-this.beta1)),v=Ye(p,this.beta2),x=Qi(c),w=y2(v,x);h.assign(m),p.assign(w);const T=Nt(Ye(Un(r,s),Un(m,Nt(w,this.epsilon))),o);o.assign(T)}),this.iteration.assign(Nt(this.iteration,1)),this.accBeta1.assign(Ye(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Mr(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Mr(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}};pw.className="Adamax";Yh(pw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let qv=class extends Jh{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const a=de.registeredVariables[s];pn(()=>{const o=Nt(Ye(this.c,i),a);a.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Cl(Zt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}};qv.className="SGD";Yh(qv);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let mw=class extends qv{constructor(e,t,s=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=s,this.accumulations=[],this.m=Zt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=de.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:pn(()=>na(i).variable(!1))});const a=this.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[s];o!=null&&pn(()=>{let l;const c=Nt(Ye(this.m,a),o);this.useNesterov?l=Nt(Ye(this.c,Nt(o,Ye(c,this.m))),i):l=Nt(Ye(this.c,c),i),a.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Mr(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}};mw.className="Momentum";Yh(mw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let gw=class extends Jh{constructor(e,t=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=de.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=de.registeredVariables[s],a=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:pn(()=>na(i).variable(a))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:pn(()=>na(i).variable(a))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:pn(()=>na(i).variable(a))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;pn(()=>{const h=Nt(Ye(l,this.decay),Ye(oo(o),1-this.decay));if(this.centered){const p=this.accumulatedMeanGrads[r].variable,m=Nt(Ye(p,this.decay),Ye(o,1-this.decay)),v=Un(Ye(o,this.learningRate),Xl(Bt(h,Nt(oo(m),this.epsilon)))),x=Nt(Ye(c,this.momentum),v);l.assign(h),p.assign(m),c.assign(x);const w=Bt(i,x);i.assign(w)}else{const p=Nt(Ye(l,this.decay),Ye(oo(o),1-this.decay)),m=Nt(Ye(c,this.momentum),Un(Ye(o,this.learningRate),Xl(Nt(p,this.epsilon))));l.assign(p),c.assign(m);const v=Bt(i,m);i.assign(v)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Mr(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Mr(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Mr(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}};gw.className="RMSProp";Yh(gw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nh=class{static sgd(e){return new qv(e)}static momentum(e,t,s=!1){return new mw(e,t,s)}static rmsprop(e,t=.9,s=0,r=null,i=!1){return new gw(e,t,s,r,i)}static adam(e=.001,t=.9,s=.999,r=null){return new fw(e,t,s,r)}static adadelta(e=.001,t=.95,s=null){return new hw(e,t,s)}static adamax(e=.002,t=.9,s=.999,r=null,i=0){return new pw(e,t,s,r,i)}static adagrad(e,t=.1){return new dw(e,t)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $me={sgd:nh.sgd,momentum:nh.momentum,adadelta:nh.adadelta,adagrad:nh.adagrad,rmsprop:nh.rmsprop,adamax:nh.adamax,adam:nh.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ame=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function Rme(){return new Promise(n=>Ame(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dme(n,e){const t=n[0].length;n.forEach((r,i)=>{se(r.length===t,()=>`Error in concat${t}D: rank of tensors[${i}] must be the same as the rank of the rest (${t})`)}),se(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const s=n[0];n.forEach((r,i)=>{for(let a=0;a<t;a++)se(a===e||r[a]===s[a],()=>`Error in concat${t}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function Lme(n,e){const t=n[0].slice();for(let s=1;s<n.length;s++)t[e]+=n[s][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wl;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(wl||(wl={}));function Ome(n,e,t){let s=new Array;if(t==null&&e==null)return s;if(e==null)for(;s.length<n+t.length;)s.push(-1);else s=e.slice();if(t==null)return s;if(n+t.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${s.length}`);for(let r=1;r<t.length;++r){const i=t[r],a=s[s.length-t.length+r],o=s[a];if(i>=0)if(o>=0){if(o!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+n}] = ${i} but shape[${r+n}] = ${o}`)}else s[a]=i}return s}function Pme(n){const e={FIRST_DIM_SIZE:wl.FIRST_DIM_SIZE,VALUE_ROWIDS:wl.VALUE_ROWIDS,ROW_LENGTHS:wl.ROW_LENGTHS,ROW_SPLITS:wl.ROW_SPLITS,ROW_LIMITS:wl.ROW_LIMITS,ROW_STARTS:wl.ROW_STARTS},t=[];for(const s of n)if(s in e)t.push(e[s]);else break;return t}function Mme(n){return n.length===0?0:n[0]===wl.FIRST_DIM_SIZE?n.length-1:n.length}function Fme(n,e){if(n==null||e==null)return;const t=n.length,s=e.length;if(t>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(t,s-1);++r){const i=n[r],a=e[r+1];if(i>=0&&a>=0&&i!==1&&i!==a)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-n.length}] = ${i} but ragged tensor input.flatValues.shape[${r-n.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L2=30;function jme(n){return n<=L2?n:P0(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bme(n,e,t){const s=t*(typeof n=="number"?n:n[0]),r=e*(typeof n=="number"?n:n[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zme(n,e,t,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(n[0]/t),r=r.concat(n.slice(1));else{r=r.concat(n[0]);const i=e.length;for(let a=0;a<i;++a)r=r.concat([n[a+1]/e[a],e[a]]);r=r.concat(n.slice(i+1))}return r}function Vme(n,e,t=!0){const s=[];if(t){s.push(e);for(let r=e+1;r<n;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let a=1;a<n;++a)a>=e*2+1||a%2===1?i.push(a):r.push(a);s.push(...r),s.push(0),s.push(...i)}return s}function Ume(n,e,t,s=!0){const r=[];s?r.push(n[0]/t):r.push(n[0]*t);for(let i=1;i<n.length;++i)i<=e.length?s?r.push(e[i-1]*n[i]):r.push(n[i]/e[i-1]):r.push(n[i]);return r}function Gme(n,e){const t=[0];for(let s=0;s<e;++s)t.push(n[s][0]);return t}function Wme(n,e,t){const s=n.slice(0,1);for(let r=0;r<t;++r)s.push(n[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hme=1.7580993408473768,qme=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kme=.3275911,Xme=.254829592,Zme=-.284496736,Yme=1.421413741,Qme=-1.453152027,Jme=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ege(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let s=0;s<t.length;s+=2)t[s]=n[s/2],t[s+1]=e[s/2];return t}function tge(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)e[s/2]=n[s],t[s/2]=n[s+1];return{real:e,imag:t}}function nge(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function sge(n){const e=Math.floor(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function rge(n,e){const t=n[e*2],s=n[e*2+1];return{real:t,imag:s}}function ige(n,e,t,s){n[s*2]=e,n[s*2+1]=t}function age(n,e){const t=new Float32Array(n/2),s=new Float32Array(n/2);for(let r=0;r<Math.ceil(n/2);r++){const i=(e?2:-2)*Math.PI*(r/n);t[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:t,imag:s}}function oge(n,e,t){const s=(t?2:-2)*Math.PI*(n/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nN="->",lge=/->/g,kM=",",$M="...";function cge(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(lge,"").length)/nN.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${nN}").`);const[s,r]=n.split(nN);se(s.indexOf($M)===-1,()=>`The ellipsis notation ("${$M}") is not supported yet.`);const i=s.split(kM),a=i.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let m=0;m<r.length;++m){const v=r[m];if(!i.some(x=>x.indexOf(v)!==-1))throw new Error(`Output subscripts contain the label ${v} not present in the input subscripts.`);o.indexOf(v)===-1&&o.push(v)}for(let m=0;m<s.length;++m){const v=s[m];o.indexOf(v)===-1&&v!==kM&&o.push(v)}const l=new Array(i.length);for(let m=0;m<a;++m){if(new Set(i[m].split("")).size!==i[m].length)throw new Error(`Found duplicate axes in input component ${i[m]}. Support for duplicate axes in input is not implemented yet.`);l[m]=[];for(let v=0;v<i[m].length;++v)l[m].push(o.indexOf(i[m][v]))}const c=o.length,h=r.length,p=[];for(let m=h;m<c;++m)p.push(m);return{allDims:o,summedDims:p,idDims:l}}function uge(n,e){let t=new Array(n);t.fill(-1);for(let r=0;r<e.length;++r)t[e[r]]=r;const s=[];for(let r=0;r<n;++r)t[r]===-1&&s.push(r);return t=t.filter(r=>r!==-1),{permutationIndices:t,expandDims:s}}function hge(n,e,t){const s=new Array(n);for(let r=0;r<t.length;++r){const i=t[r].shape;for(let a=0;a<e[r].length;++a)s[e[r][a]]===void 0?s[e[r][a]]=i[a]:se(s[e[r][a]]===i[a],()=>`Expected dimension ${s[e[r][a]]} at axis ${a} of input shaped ${JSON.stringify(i)}, but got dimension ${i[a]}`)}}function dge(n,e){const t=n,s=[];let r=0;n.length===0&&t.push(-1),r=n.length+1;for(let a=0;a<r;++a)s.push([]);const i=[];for(let a=0;a<t.length;++a){const o=t[a],l=pge(e,o);for(const c of l)i.indexOf(c)===-1&&(s[a].push(c),i.push(c))}return{path:t,steps:s}}function fge(n){return n.every((e,t)=>e===t)}function pge(n,e){const t=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(e)!==-1||e===-1)&&t.push(s);return t}function mge(n,e,t=0){let s=[];if(typeof e=="number")se(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(n.shape[t]/e);else{const r=e.reduce((a,o)=>(o===-1&&(a+=1),a),0);se(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const a=e.reduce((o,l)=>l>0?o+l:o);e[i]=n.shape[t]-a}se(n.shape[t]===e.reduce((a,o)=>a+o),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gge(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function yge(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function vge(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bge(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function _ge(n,e){return`size ${n} must be non-negative, not ${e}`}function xge(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function wge(n,e){const t=Xn(n),s=Xn(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${e}`}function Tge(n,e){const t=Xn(n),s=Xn(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge(){return"segment ids must be >= 0"}function Ege(){return"segment ids are not increasing"}function Nge(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function Ige(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cge(n,e){let t=!1,s;for(n<=L2?(s=n,t=!0):s=P0(n,Math.floor(Math.sqrt(n)));!t;)s>e||s===n?t=!0:s=P0(n,s+1);return s}function kge(n,e,t){const s=[],r=n.length;for(let i=0;i<r;i++)i!==e?s.push(n[i]):s.push(t);return s}function $ge(n,e,t,s){const r=e.shape.length,i=n.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(t<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${t}).`);for(let p=0;p<s;++p)if(n.shape[p]!==e.shape[p])throw new Error(`x.shape[${p}]: ${n.shape[p]} should be equal to indices.shape[${p}]: ${e.shape[p]}.`);const a=n.shape[t],o=[];let l=1,c=1,h=1;for(let p=0;p<s;++p)o.push(n.shape[p]),l*=n.shape[p];for(let p=s;p<t;p++)o.push(n.shape[p]),c*=n.shape[p];for(let p=s;p<r;p++)o.push(e.shape[p]);for(let p=t+1;p<i;p++)o.push(n.shape[p]),h*=n.shape[p];return{batchSize:l,sliceSize:h,outerSize:c,dimSize:a,outputShape:o}}const Age=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:$ge,computeOutShape:kge,segOpComputeOptimalWindowSize:Cge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rge(n){try{return n.map(e=>j0(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Dge(n){return n.map(e=>Pv(e))}const Lge=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:Xme,ERF_A2:Zme,ERF_A3:Yme,ERF_A4:Qme,ERF_A5:Jme,ERF_P:Kme,PARALLELIZE_THRESHOLD:L2,get RowPartitionType(){return wl},SELU_SCALE:qme,SELU_SCALEALPHA:Hme,applyActivation:cw,assertAndGetBroadcastShape:Fs,assertAxesAreInnerMostDims:hhe,assertParamsConsistent:Dme,assignToTypedArray:ige,axesAreInnerMostDims:i2,calculateShapes:a6,checkEinsumDimSizes:hge,checkPadOnDimRoundingMode:uo,combineLocations:uG,combineRaggedTensorToTensorShapes:Ome,complexWithEvenIndex:nge,complexWithOddIndex:sge,computeConv2DInfo:jv,computeConv3DInfo:D6,computeDefaultPad:Jk,computeDilation2DInfo:uue,computeOptimalWindowSize:jme,computeOutAndReduceShapes:uhe,computeOutShape:Lme,computePool2DInfo:R6,computePool3DInfo:hue,convertConv2DDataFormat:L6,decodeEinsumEquation:cge,eitherStridesOrDilationsAreOne:iu,expandShapeToKeepDim:Vv,exponent:oge,exponents:age,fromStringArrayToUint8:Dge,fromUint8ToStringArray:Rge,getAxesPermutation:dhe,getBroadcastDims:t6,getComplexWithIndex:rge,getEinsumComputePath:dge,getEinsumPermutation:uge,getFusedBiasGradient:lw,getFusedDyActivation:ow,getImageCenter:Bme,getInnerMostAxes:phe,getPermuted:Vme,getRaggedRank:Mme,getReductionAxes:Hk,getReshaped:zme,getReshapedPermuted:Ume,getRowPartitionTypesHelper:Pme,getSliceBeginCoords:Gme,getSliceSize:Wme,getSparseFillEmptyRowsIndicesDenseShapeMismatch:gge,getSparseFillEmptyRowsNegativeIndexErrorMessage:yge,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:vge,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:xge,getSparseReshapeInputOutputMismatchErrorMessage:Tge,getSparseReshapeInputOutputMultipleErrorMessage:wge,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:bge,getSparseReshapeNegativeOutputDimErrorMessage:_ge,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:Ige,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Sge,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:Ege,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:Nge,getUndoAxesPermutation:fhe,isIdentityPermutation:fge,log:hoe,mergeRealAndImagArrays:ege,prepareAndValidate:i6,prepareSplitSize:mge,segment_util:Age,shouldFuse:uw,slice_util:m6,splitRealAndImagArrays:tge,tupleValuesAreOne:ev,upcastType:J1,validateDefaultValueShape:Fme,validateInput:Xk,validateUpdateShape:Kk,warn:ch},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:AW,nonMaxSuppressionV4Impl:RW,nonMaxSuppressionV5Impl:DW,whereImpl:_W},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pge=Object.freeze(Object.defineProperty({__proto__:null,Abs:UB,Acos:GB,Acosh:WB,AdadeltaOptimizer:hw,AdagradOptimizer:dw,AdamOptimizer:fw,AdamaxOptimizer:pw,Add:$k,AddN:HB,All:qB,Any:KB,ArgMax:XB,ArgMin:ZB,Asin:YB,Asinh:QB,Atan:JB,Atan2:tz,Atanh:ez,AvgPool:nz,AvgPool3D:sz,AvgPool3DGrad:Kae,AvgPoolGrad:qae,BatchMatMul:rz,BatchToSpaceND:iz,Bincount:az,BroadcastArgs:oz,BroadcastTo:Xae,Cast:Ak,Ceil:lz,ClipByValue:cz,Complex:uz,ComplexAbs:hz,Concat:dz,Conv2D:fz,Conv2DBackpropFilter:pz,Conv2DBackpropInput:mz,Conv3D:gz,Conv3DBackpropFilterV2:Zae,Conv3DBackpropInputV2:yz,Cos:vz,Cosh:bz,CropAndResize:wz,Cumprod:_z,Cumsum:xz,DataStorage:Nae,DenseBincount:Tz,DepthToSpace:Sz,DepthwiseConv2dNative:Ez,DepthwiseConv2dNativeBackpropFilter:Nz,DepthwiseConv2dNativeBackpropInput:Iz,Diag:Cz,Dilation2D:kz,Dilation2DBackpropFilter:Qae,Dilation2DBackpropInput:Yae,get ENV(){return Ck},Einsum:Az,Elu:Rz,EluGrad:Jae,Environment:zB,Equal:Lz,Erf:Dz,Exp:Oz,ExpandDims:Pz,Expm1:Mz,FFT:Fz,Fill:jz,FlipLeftRight:Bz,Floor:zz,FloorDiv:Vz,FromPixels:nI,FusedBatchNorm:Uz,FusedConv2D:rI,FusedDepthwiseConv2D:iI,GatherNd:Wz,GatherV2:Gz,Greater:Hz,GreaterEqual:qz,IFFT:Kz,Identity:Rk,Imag:Xz,IsFinite:Zz,IsInf:Yz,IsNan:Qz,KernelBackend:$B,LRN:lV,LRNGrad:soe,LeakyRelu:Jz,Less:eV,LessEqual:tV,LinSpace:nV,Log:sV,Log1p:rV,LogSoftmax:toe,LogicalAnd:iV,LogicalNot:aV,LogicalOr:oV,LogicalXor:eoe,LowerBound:noe,Max:cV,MaxPool:hV,MaxPool3D:dV,MaxPool3DGrad:ioe,MaxPoolGrad:roe,MaxPoolWithArgmax:fV,Maximum:uV,Mean:pV,Min:mV,Minimum:gV,MirrorPad:yV,Mod:vV,MomentumOptimizer:mw,Multinomial:bV,Multiply:_V,Neg:xV,NonMaxSuppressionV3:TV,NonMaxSuppressionV4:SV,NonMaxSuppressionV5:EV,NotEqual:wV,OP_SCOPE_SUFFIX:Fk,OneHot:IV,OnesLike:NV,Optimizer:Jh,OptimizerConstructors:nh,Pack:CV,PadV2:kV,Pool:aoe,Pow:$V,Prelu:AV,Prod:RV,RMSPropOptimizer:gw,RaggedGather:DV,RaggedTensorToTensor:LV,Range:OV,get Rank(){return lI},Real:PV,RealDiv:$z,Reciprocal:MV,get Reduction(){return oi},Relu:FV,Relu6:VV,Reshape:jV,ResizeBilinear:zV,ResizeBilinearGrad:loe,ResizeNearestNeighbor:BV,ResizeNearestNeighborGrad:ooe,Reverse:UV,RotateWithOffset:IU,Round:GV,Rsqrt:WV,SGDOptimizer:qv,ScatterNd:HV,SearchSorted:qV,Select:KV,Selu:XV,Sigmoid:eU,Sign:JV,Sin:YV,Sinh:QV,Slice:ZV,Softmax:aU,Softplus:tU,SpaceToBatchND:rU,SparseFillEmptyRows:oU,SparseReshape:lU,SparseSegmentMean:cU,SparseSegmentSum:uU,SparseToDense:hU,SplitV:iU,Sqrt:nU,Square:coe,SquaredDifference:dU,Step:NU,StridedSlice:fU,StringNGrams:pU,StringSplit:mU,StringToHashBucketFast:gU,Sub:yU,Sum:sU,Tan:vU,Tanh:bU,Tensor:os,TensorBuffer:B0,Tile:Dk,TopK:_U,Transform:xU,Transpose:e0,Unique:wU,Unpack:TU,UnsortedSegmentSum:SU,UpperBound:uoe,Variable:Yy,ZerosLike:EU,_FusedMatMul:sI,abs:Qi,acos:_6,acosh:x6,add:Nt,addN:w6,all:T6,any:S6,argMax:E6,argMin:N6,asin:I6,asinh:C6,atan:k6,atan2:$6,atanh:A6,avgPool:e2,avgPool3d:O6,backend:oce,backend_util:Lge,basicLSTMCell:P6,batchNorm:Bv,batchNorm2d:M6,batchNorm3d:F6,batchNorm4d:j6,batchToSpaceND:t2,bincount:n2,booleanMaskAsync:xW,broadcastArgs:B6,broadcastTo:Ly,broadcast_util:gce,browser:wce,buffer:Ko,cast:es,ceil:z6,clipByValue:V6,clone:Hc,complex:Jc,concat:Fr,concat1d:U6,concat2d:G6,concat3d:W6,concat4d:H6,conv1d:q6,conv2d:zv,conv2dTranspose:X6,conv3d:Z6,conv3dTranspose:Y6,copyRegisteredKernels:moe,cos:Q6,cosh:J6,cosineWindow:aw,cumprod:eG,cumsum:tG,customGrad:Zl,denseBincount:nG,deprecationWarn:Kle,depthToSpace:sG,depthwiseConv2d:ew,device_util:Hoe,diag:rG,dilation2d:iG,disableDeprecationWarnings:qle,dispose:Mr,disposeVariables:Xle,div:Un,divNoNan:aG,dot:oG,dropout:NW,einsum:lG,elu:r2,enableDebugMode:Hle,enableProdMode:Wle,enclosingPowerOfTwo:A2,engine:Zle,env:At,equal:s2,erf:cG,euclideanNorm:dG,exp:Mh,expandDims:Lc,expm1:fG,eye:a2,fft:rw,fill:qm,findBackend:rce,findBackendFactory:ice,floor:o2,floorDiv:Qk,fused:CW,gather:l2,gatherND:EW,gather_util:Tce,getBackend:nce,getGradient:aI,getKernel:M0,getKernelsForBackend:F0,grad:zhe,grads:Vhe,greater:Gv,greaterEqual:c2,ifft:sv,imag:Fv,image:D2,inTopKAsync:IW,io:Wk,irfft:I2,isFinite:pG,isInf:mG,isNaN:gG,keep:Cl,kernel_impls:Oge,leakyRelu:u2,less:yG,lessEqual:tw,linalg:PW,linspace:vG,localResponseNormalization:bG,log:Tm,log1p:h2,logSigmoid:xG,logSoftmax:wG,logSumExp:f2,logicalAnd:tv,logicalNot:p2,logicalOr:m2,logicalXor:TG,losses:MW,lowerBound:SG,matMul:Sn,math:mce,max:rf,maxPool:g2,maxPool3d:EG,maxPoolWithArgmax:NG,maximum:y2,mean:nv,memory:Yle,meshgrid:IG,min:W0,minimum:v2,mirrorPad:CG,mod:kG,moments:$G,movingAverage:wW,mul:Ye,multiRNNCell:AG,multinomial:RG,neg:Ml,nextFrame:Rme,norm:Uv,notEqual:b2,oneHot:V0,ones:fh,onesLike:DG,op:ue,outerProduct:LG,pad:Km,pad1d:OG,pad2d:PG,pad3d:MG,pad4d:FG,pool:jG,pow:wm,prelu:x2,print:Vk,prod:BG,profile:Qle,raggedGather:zG,raggedTensorToTensor:VG,rand:UG,randomGamma:GG,randomNormal:T2,randomStandardNormal:WG,randomUniform:S2,range:Sm,ready:tce,real:xm,reciprocal:HG,registerBackend:ace,registerGradient:doe,registerKernel:CU,relu:Wv,relu6:E2,removeBackend:sce,reshape:ze,reverse:Fh,reverse1d:qG,reverse2d:KG,reverse3d:XG,reverse4d:ZG,rfft:iw,round:N2,rsqrt:YG,scalar:Zt,scatterND:TW,scatter_util:Sce,searchSorted:sw,selu:QG,separableConv2d:JG,serialization:Oce,setBackend:ece,setPlatform:lce,setdiff1dAsync:eW,sigmoid:sf,sign:tW,signal:OW,sin:nW,sinh:sW,slice:Pn,slice1d:rW,slice2d:iW,slice3d:aW,slice4d:oW,slice_util:m6,softmax:lW,softplus:d2,spaceToBatchND:_2,sparse:FW,sparseToDense:SW,spectral:LW,split:Em,sqrt:Xl,square:oo,squaredDifference:C2,squeeze:Hv,stack:Yl,step:k2,stridedSlice:cW,string:jW,sub:Bt,sum:Vn,sumOutType:Moe,tan:uW,tanh:G0,tensor:Vo,tensor1d:ro,tensor2d:om,tensor3d:qk,tensor4d:hW,tensor5d:dW,tensor6d:fW,tensor_util:Boe,test_util:Wce,tidy:pn,tile:am,time:Jle,topk:pW,train:$me,transpose:Jy,truncatedNormal:mW,unique:gW,unregisterGradient:poe,unregisterKernel:foe,unsortedSegmentSum:yW,unstack:Qh,upcastType:J1,upperBound:vW,util:Eoe,valueAndGrad:Uhe,valueAndGrads:Ghe,variable:bW,variableGrads:_G,version_core:Hce,where:xf,whereAsync:$2,zeros:wf,zerosLike:na},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mge=At();Mge.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ja;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ja||(Ja={}));var AM;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(AM||(AM={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fge={};function BW(n){return Fge[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V(n,e,t,s,r){const i=e.inputParams[n];if(i&&i.inputIndexStart!==void 0){const o=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?o+1:i.inputIndexEnd;if(i.type==="tensor")return li(e.inputNames[i.inputIndexStart],t,s,r);if(i.type==="tensors")return e.inputNames.slice(o,l).map(m=>li(m,t,s,r));const c=li(e.inputNames.slice(o)[0],t,s,r),h=c.dataSync();return i.type==="number"?h[0]:tf(c.shape,h)}const a=e.attrParams[n];return a&&a.value}function li(n,e,t,s){const[r,i]=Zi(n);if(s!=null){const o=s.getHashTableHandleByName(r);if(o!=null)return o}const a=t.currentContextIds.find(o=>!!e[H0(r,o)]);return a!==void 0?e[H0(r,a)][i]:void 0}function jge(n,e,t){return e[H0(n,t.currentContextId)]}function Tl(n,e){const[t,s,r]=Zi(n);return[H0(t,e&&e.currentContextId),s,r]}function H0(n,e){return e?`${n}-${e}`:n}function Zi(n){const e=n.split(":");if(e.length===1)return[n,0,void 0];const t=e[0],s=e.length===3?e[1]:void 0,r=Number(e[e.length-1]);return[t,r,s]}function u0(n,e,t){let s=V("pad",n,e,t);if(s==="explicit"){s=V("explicitPaddings",n,e,t);const r=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)r[i][0]=s[i*2],r[i][1]=s[i*2+1];return r}return s}function Oc(n){return n.kept?n:Hc(n)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bge=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],zge=Object.freeze(Object.defineProperty({__proto__:null,json:Bge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vge=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Uge=Object.freeze(Object.defineProperty({__proto__:null,json:Vge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gge=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Wge=Object.freeze(Object.defineProperty({__proto__:null,json:Gge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hge=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],qge=Object.freeze(Object.defineProperty({__proto__:null,json:Hge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kge=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Xge=Object.freeze(Object.defineProperty({__proto__:null,json:Kge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zge=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Yge=Object.freeze(Object.defineProperty({__proto__:null,json:Zge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qge=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Jge=Object.freeze(Object.defineProperty({__proto__:null,json:Qge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eye=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],tye=Object.freeze(Object.defineProperty({__proto__:null,json:eye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nye=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],sye=Object.freeze(Object.defineProperty({__proto__:null,json:nye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rye=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],iye=Object.freeze(Object.defineProperty({__proto__:null,json:rye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aye=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],oye=Object.freeze(Object.defineProperty({__proto__:null,json:aye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lye=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],cye=Object.freeze(Object.defineProperty({__proto__:null,json:lye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uye=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],hye=Object.freeze(Object.defineProperty({__proto__:null,json:uye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dye=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],fye=Object.freeze(Object.defineProperty({__proto__:null,json:dye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pye=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],mye=Object.freeze(Object.defineProperty({__proto__:null,json:pye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gye=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],yye=Object.freeze(Object.defineProperty({__proto__:null,json:gye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vye=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],bye=Object.freeze(Object.defineProperty({__proto__:null,json:vye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ye=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],xye=Object.freeze(Object.defineProperty({__proto__:null,json:_ye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wye=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Tye=Object.freeze(Object.defineProperty({__proto__:null,json:wye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RM{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[zge,Uge,Wge,qge,Xge,Yge,Jge,tye,sye,iye,oye,cye,hye,fye,mye,yye,bye,xye,Tye],t=[].concat(...e.map(s=>s.json));this.opMappers=t.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,t={}){const s=e.node,r=[],i=[],a=[],o=s.reduce((w,T)=>(w[T.name]=this.mapNode(T),T.op.startsWith("Placeholder")?r.push(w[T.name]):T.op==="Const"?i.push(w[T.name]):(T.input==null||T.input.length===0)&&a.push(w[T.name]),w),{});let l=[];const c=[];let h={},p={};t!=null&&(h=this.mapSignatureEntries(t.inputs),p=this.mapSignatureEntries(t.outputs));const m=Object.keys(o);m.forEach(w=>{const T=o[w];T.inputNames.forEach((E,C)=>{const[$,,R]=Tl(E),P=o[$];if(P.outputs!=null){const U=P.outputs.indexOf(R);if(U!==-1){const j=`${$}:${U}`;T.inputNames[C]=j}}T.inputs.push(P),P.children.push(T)})}),Object.keys(p).length===0?m.forEach(w=>{const T=o[w];T.children.length===0&&c.push(T)}):Object.keys(p).forEach(w=>{const[T]=Tl(w),E=o[T];E!=null&&(E.signatureKey=p[w],c.push(E))}),Object.keys(h).length>0?Object.keys(h).forEach(w=>{const[T]=Tl(w),E=o[T];E&&(E.signatureKey=h[w],l.push(E))}):l=r;let v={};e.library!=null&&e.library.function!=null&&(v=e.library.function.reduce((w,T)=>(w[T.signature.name]=this.mapFunction(T),w),{}));const x={nodes:o,inputs:l,outputs:c,weights:i,placeholders:r,signature:t,functions:v};return a.length>0&&(x.initNodes=a),x}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,s)=>(t[e[s].name]=s,t),{})}mapNode(e){const t=BW(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(s.inputParams=t.inputs.reduce((r,i)=>(r[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},r),{})),t.attrs!=null&&(s.attrParams=t.attrs.reduce((r,i)=>{const a=i.type;let o;switch(i.type){case"string":o=TI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=TI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":o=$I(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=$I(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":o=EI(e.attr,i.tfName,i.defaultValue||0),o===void 0&&i.tfDeprecatedName&&(o=EI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":o=kI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=kI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":o=SI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=SI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":o=RI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=RI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":o=CI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=CI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":o=AI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=AI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":o=NI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=NI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":o=II(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=II(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":o=DM(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=DM(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return r[i.name]={value:o,type:a},r},{})),s}mapFunction(e){const t=e.nodeDef,s=[],r=[];let i={};t!=null&&(i=t.reduce((p,m)=>(p[m.name]=this.mapNode(m),m.op==="Const"&&r.push(p[m.name]),p),{}));const a=[],o=[];e.signature.inputArg.forEach(p=>{const[m]=Tl(p.name),v={name:m,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:O2(p.type),type:"dtype"}},children:[]};v.signatureKey=p.name,a.push(v),i[m]=v}),Object.keys(i).forEach(p=>{const m=i[p];m.inputNames.forEach((v,x)=>{const[w,,T]=Tl(v),E=i[w];if(E.outputs!=null){const C=E.outputs.indexOf(T);if(C!==-1){const $=`${w}:${C}`;m.inputNames[x]=$}}m.inputs.push(E),E.children.push(m)})});const c=e.ret;e.signature.outputArg.forEach(p=>{const[m,v]=Tl(c[p.name]),x=i[m];x!=null&&(x.defaultOutput=v,o.push(x))});const h=this.mapArgsToSignature(e);return{nodes:i,inputs:a,outputs:o,weights:r,placeholders:s,signature:h}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s),t),{}),outputs:e.signature.outputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s,e.ret),t),{})}}mapArgToTensorInfo(e,t){let s=e.name;return t!=null&&(s=t[s]),{name:s,dtype:e.type}}}function Sye(n){const e=At().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function zW(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):Sye(n);return e?t:t.toLowerCase()}function TI(n,e,t,s=!1){const r=n[e];return r!=null?zW(r.s,s):t}function SI(n,e,t){const s=n[e];return s?s.b:t}function EI(n,e,t){const s=n[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:t;return typeof r=="number"?r:parseInt(r,10)}function O2(n){switch(typeof n=="string"&&(n=Ja[n]),n){case Ja.DT_FLOAT:case Ja.DT_HALF:return"float32";case Ja.DT_INT32:case Ja.DT_INT64:case Ja.DT_INT8:case Ja.DT_UINT8:return"int32";case Ja.DT_BOOL:return"bool";case Ja.DT_DOUBLE:return"float32";case Ja.DT_STRING:return"string";default:return null}}function DM(n,e,t){const s=n[e];return s&&s.func?s.func.name:t}function NI(n,e,t){const s=n[e];return s&&s.type?O2(s.type):t}function II(n,e,t){const s=n[e];return s&&s.list&&s.list.type?s.list.type.map(r=>O2(r)):t}function VW(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function CI(n,e,t){const s=n[e];return s&&s.shape?VW(s.shape):t}function kI(n,e,t){const s=n[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):t}function $I(n,e,t,s=!1){const r=n[e];return r&&r.list&&r.list.s?r.list.s.map(i=>zW(i,s)):t}function AI(n,e,t){const s=n[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>VW(r)):t}function RI(n,e,t){const s=n[e];return s&&s.list&&s.list.b?s.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eye{constructor(e,t,s){this.node=e,this.tensorMap=t,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,i)=>(r[i]=this.getAttr(i),r),{}))}getInput(e){return li(e,this.tensorMap,this.context)}getAttr(e,t){const s=this.node.rawAttrs[e];if(s.tensor!=null)return li(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return EI(this.node.rawAttrs,e,t);if(s.s!=null)return TI(this.node.rawAttrs,e,t);if(s.b!=null)return SI(this.node.rawAttrs,e,t);if(s.shape!=null)return CI(this.node.rawAttrs,e,t);if(s.type!=null)return NI(this.node.rawAttrs,e,t);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return kI(this.node.rawAttrs,e,t);if(s.list.s!=null)return $I(this.node.rawAttrs,e,t);if(s.list.shape!=null)return AI(this.node.rawAttrs,e,t);if(s.list.b!=null)return RI(this.node.rawAttrs,e,t);if(s.list.type!=null)return II(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ur=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:Fk,abs:Qi,acos:_6,acosh:x6,add:Nt,addN:w6,all:T6,any:S6,argMax:E6,argMin:N6,asin:I6,asinh:C6,atan:k6,atan2:$6,atanh:A6,avgPool:e2,avgPool3d:O6,basicLSTMCell:P6,batchNorm:Bv,batchNorm2d:M6,batchNorm3d:F6,batchNorm4d:j6,batchToSpaceND:t2,bincount:n2,booleanMaskAsync:xW,broadcastArgs:B6,broadcastTo:Ly,buffer:Ko,cast:es,ceil:z6,clipByValue:V6,clone:Hc,complex:Jc,concat:Fr,concat1d:U6,concat2d:G6,concat3d:W6,concat4d:H6,conv1d:q6,conv2d:zv,conv2dTranspose:X6,conv3d:Z6,conv3dTranspose:Y6,cos:Q6,cosh:J6,cosineWindow:aw,cumprod:eG,cumsum:tG,denseBincount:nG,depthToSpace:sG,depthwiseConv2d:ew,diag:rG,dilation2d:iG,div:Un,divNoNan:aG,dot:oG,dropout:NW,einsum:lG,elu:r2,enclosingPowerOfTwo:A2,equal:s2,erf:cG,euclideanNorm:dG,exp:Mh,expandDims:Lc,expm1:fG,eye:a2,fft:rw,fill:qm,floor:o2,floorDiv:Qk,fused:CW,gather:l2,gatherND:EW,greater:Gv,greaterEqual:c2,ifft:sv,imag:Fv,image:D2,inTopKAsync:IW,irfft:I2,isFinite:pG,isInf:mG,isNaN:gG,leakyRelu:u2,less:yG,lessEqual:tw,linalg:PW,linspace:vG,localResponseNormalization:bG,log:Tm,log1p:h2,logSigmoid:xG,logSoftmax:wG,logSumExp:f2,logicalAnd:tv,logicalNot:p2,logicalOr:m2,logicalXor:TG,losses:MW,lowerBound:SG,matMul:Sn,max:rf,maxPool:g2,maxPool3d:EG,maxPoolWithArgmax:NG,maximum:y2,mean:nv,meshgrid:IG,min:W0,minimum:v2,mirrorPad:CG,mod:kG,moments:$G,movingAverage:wW,mul:Ye,multiRNNCell:AG,multinomial:RG,neg:Ml,norm:Uv,notEqual:b2,oneHot:V0,ones:fh,onesLike:DG,op:ue,outerProduct:LG,pad:Km,pad1d:OG,pad2d:PG,pad3d:MG,pad4d:FG,pool:jG,pow:wm,prelu:x2,print:Vk,prod:BG,raggedGather:zG,raggedTensorToTensor:VG,rand:UG,randomGamma:GG,randomNormal:T2,randomStandardNormal:WG,randomUniform:S2,range:Sm,real:xm,reciprocal:HG,relu:Wv,relu6:E2,reshape:ze,reverse:Fh,reverse1d:qG,reverse2d:KG,reverse3d:XG,reverse4d:ZG,rfft:iw,round:N2,rsqrt:YG,scalar:Zt,scatterND:TW,searchSorted:sw,selu:QG,separableConv2d:JG,setdiff1dAsync:eW,sigmoid:sf,sign:tW,signal:OW,sin:nW,sinh:sW,slice:Pn,slice1d:rW,slice2d:iW,slice3d:aW,slice4d:oW,softmax:lW,softplus:d2,spaceToBatchND:_2,sparse:FW,sparseToDense:SW,spectral:LW,split:Em,sqrt:Xl,square:oo,squaredDifference:C2,squeeze:Hv,stack:Yl,step:k2,stridedSlice:cW,string:jW,sub:Bt,sum:Vn,tan:uW,tanh:G0,tensor:Vo,tensor1d:ro,tensor2d:om,tensor3d:qk,tensor4d:hW,tensor5d:dW,tensor6d:fW,tile:am,topk:pW,transpose:Jy,truncatedNormal:mW,unique:gW,unsortedSegmentSum:yW,unstack:Qh,upperBound:vW,variable:bW,where:xf,whereAsync:$2,zeros:wf,zerosLike:na},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nye=(n,e,t,s=Ur)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(V("a",n,e,t),V("b",n,e,t))];case"AddN":return[s.addN(V("tensors",n,e,t))];case"FloorMod":case"Mod":return[s.mod(V("a",n,e,t),V("b",n,e,t))];case"Mul":return[s.mul(V("a",n,e,t),V("b",n,e,t))];case"RealDiv":case"Div":return[s.div(V("a",n,e,t),V("b",n,e,t))];case"DivNoNan":return[s.divNoNan(V("a",n,e,t),V("b",n,e,t))];case"FloorDiv":return[s.floorDiv(V("a",n,e,t),V("b",n,e,t))];case"Sub":return[s.sub(V("a",n,e,t),V("b",n,e,t))];case"Minimum":return[s.minimum(V("a",n,e,t),V("b",n,e,t))];case"Maximum":return[s.maximum(V("a",n,e,t),V("b",n,e,t))];case"Pow":return[s.pow(V("a",n,e,t),V("b",n,e,t))];case"SquaredDifference":return[s.squaredDifference(V("a",n,e,t),V("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iye=(n,e,t,s=Ur)=>{switch(n.op){case"Abs":case"ComplexAbs":return[s.abs(V("x",n,e,t))];case"Acos":return[s.acos(V("x",n,e,t))];case"Acosh":return[s.acosh(V("x",n,e,t))];case"Asin":return[s.asin(V("x",n,e,t))];case"Asinh":return[s.asinh(V("x",n,e,t))];case"Atan":return[s.atan(V("x",n,e,t))];case"Atan2":return[s.atan2(V("x",n,e,t),V("y",n,e,t))];case"Atanh":return[s.atanh(V("x",n,e,t))];case"Ceil":return[s.ceil(V("x",n,e,t))];case"Complex":return[s.complex(V("real",n,e,t),V("imag",n,e,t))];case"Cos":return[s.cos(V("x",n,e,t))];case"Cosh":return[s.cosh(V("x",n,e,t))];case"Elu":return[s.elu(V("x",n,e,t))];case"Erf":return[s.erf(V("x",n,e,t))];case"Exp":return[s.exp(V("x",n,e,t))];case"Expm1":return[s.expm1(V("x",n,e,t))];case"Floor":return[s.floor(V("x",n,e,t))];case"Log":return[s.log(V("x",n,e,t))];case"Log1p":return[s.log1p(V("x",n,e,t))];case"Imag":return[s.imag(V("x",n,e,t))];case"Neg":return[s.neg(V("x",n,e,t))];case"Reciprocal":return[s.reciprocal(V("x",n,e,t))];case"Real":return[s.real(V("x",n,e,t))];case"Relu":return[s.relu(V("x",n,e,t))];case"Round":return[s.round(V("x",n,e,t))];case"Selu":return[s.selu(V("x",n,e,t))];case"Sigmoid":return[s.sigmoid(V("x",n,e,t))];case"Sin":return[s.sin(V("x",n,e,t))];case"Sign":return[s.sign(V("x",n,e,t))];case"Sinh":return[s.sinh(V("x",n,e,t))];case"Softplus":return[s.softplus(V("x",n,e,t))];case"Sqrt":return[s.sqrt(V("x",n,e,t))];case"Square":return[s.square(V("x",n,e,t))];case"Tanh":return[s.tanh(V("x",n,e,t))];case"Tan":return[s.tan(V("x",n,e,t))];case"ClipByValue":return[s.clipByValue(V("x",n,e,t),V("clipValueMin",n,e,t),V("clipValueMax",n,e,t))];case"Relu6":return[s.relu6(V("x",n,e,t))];case"Rsqrt":return[s.rsqrt(li(n.inputNames[0],e,t))];case"Prod":return[s.prod(V("x",n,e,t),V("axes",n,e,t))];case"LeakyRelu":return[s.leakyRelu(V("x",n,e,t),V("alpha",n,e,t))];case"Prelu":return[s.prelu(V("x",n,e,t),V("alpha",n,e,t))];case"IsNan":return[s.isNaN(li(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function to(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){se(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let s=0;s<n.length;s++){const r=n[s],i=e[s];se(r<0||i<0||r===i,()=>t+` Shapes ${n} and ${e} must match`)}}}function LM(n){return!(typeof n=="number"||n.some(e=>e<0))}function ay(n,e,t){let s=DI(n,t);const r=!LM(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(i=>{s=DI(i.shape,s)}),!LM(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function DI(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let s=0;s<n.length;++s){const r=n[s],i=e[s];if(r>=0&&i>=0&&r!==i)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[s]=r>=0?r:i}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cye{constructor(e,t,s,r,i,a,o){this.name=e,this.dtype=t,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=a,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Zt(0),Cl(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),to(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=t,Cl(t),s.written=!0,this.tensors[e]=s}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((s,r)=>this.write(s,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return Vo([],[0].concat(this.elementShape));const s=this.readMany(e);return to(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),Yl(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Vo([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const s=this.readMany(t);return to(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Fr(s,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,Qh(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=s===0?0:t.size/s,a=[];pn(()=>{t=ze(t,[1,s,i]);for(let l=0;l<e.length;++l){const h=[0,l===0?0:r[l-1],0],p=[1,e[l],i];a[l]=ze(Pn(t,h,p),this.elementShape)}return a});const o=[];for(let l=0;l<e.length;l++)o[l]=l;this.writeMany(o,a)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tf{constructor(e,t,s,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=s,e?.forEach(i=>{if(s!==i.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${i.dtype}`);to(t,i.shape,"TensorList shape mismatch: "),Cl(i)}),this.idTensor=Zt(0),this.maxNumElements=r,Cl(this.idTensor)}get id(){return this.idTensor.id}copy(){return new Tf([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,s=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);to(e,this.elementShape,"TensorList shape mismatch: ");const r=ay(this.elementShape,this.tensors,e);return pn(()=>{const i=this.tensors.map(a=>ze(a,r));return Yl(i,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=ay(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,to(r.shape,e,"TensorList shape mismatch: "),ze(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(to(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Cl(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new Tf([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)t.tensors[s]=this.tensors[s];return t}getItem(e,t,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);to(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=ay(this.elementShape,this.tensors,t);return ze(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);to(this.elementShape,t.shape,"TensorList shape mismatch: "),Cl(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,s){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);to(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=ay(this.elementShape,this.tensors,s);return e.length===0?Vo([],[0].concat(r)):pn(()=>{const i=e.map(a=>ze(this.tensors[a],r));return Yl(i,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);to(this.elementShape,t,"TensorList shape mismatch: ");const s=ay(this.elementShape,this.tensors,t);return this.size()===0?Vo([],[0].concat(s)):pn(()=>{const r=this.tensors.map(i=>ze(i,s));return Fr(r,0)})}}function kye(n,e,t){const s=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const r=n.shape.slice(1);to(r,e,"TensorList shape mismatch: ");const i=Qh(n);return new Tf(i,e,s)}function $ye(n,e,t,s){return new Tf([],n,e,s)}function Aye(n,e,t,s){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const i=new Tf([],t,n.dtype,s),a=Qh(n,0);return e.forEach((o,l)=>{i.setItem(o,a[l])}),i}function Rye(n,e,t){let s=0;const r=e.map(h=>(s+=h,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);const i=n.shape.slice(1),a=DI(i,t),o=s===0?0:n.size/s,l=pn(()=>{const h=[];n=ze(n,[1,s,o]);for(let p=0;p<e.length;++p){const v=[0,p===0?0:r[p-1],0],x=[1,e[p],o];h[p]=ze(Pn(n,v,x),a)}return n.dispose(),h}),c=new Tf([],t,n.dtype,e.length);for(let h=0;h<l.length;h++)c.setItem(h,l[h]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dye=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const s=V("thenBranch",n,e,t),r=V("elseBranch",n,e,t),i=V("cond",n,e,t),a=V("args",n,e,t);return(await i.data())[0]?t.functionMap[s].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap):t.functionMap[r].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const s=V("body",n,e,t),r=V("cond",n,e,t),i=V("args",n,e,t),a=await t.functionMap[r].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap),o=i.map(h=>h.id);let l=await a[0].data();a.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&h.dispose()});let c=i;for(;l[0];){const h=c;c=await t.functionMap[s].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);const p=c.map(v=>v.id);h.forEach(v=>{!v.kept&&o.indexOf(v.id)===-1&&p.indexOf(v.id)===-1&&v.dispose()});const m=await t.functionMap[r].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);l=await m[0].data(),m.forEach(v=>{!v.kept&&o.indexOf(v.id)===-1&&p.indexOf(v.id)===-1&&v.dispose()})}return c}case"LoopCond":{const s=V("pred",n,e,t);return[Oc(s)]}case"Switch":{const s=V("pred",n,e,t);let r=V("data",n,e,t);return r.kept||(r=Oc(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=n.inputNames.find(r=>li(r,e,t)!==void 0);if(s){const r=li(s,e,t);return[Oc(r)]}return}case"Enter":{const s=V("frameName",n,e,t),r=V("tensor",n,e,t);return t.enterFrame(s),[Oc(r)]}case"Exit":{const s=V("tensor",n,e,t);return t.exitFrame(),[Oc(s)]}case"NextIteration":{const s=V("tensor",n,e,t);return t.nextIteration(),[Oc(s)]}case"TensorArrayV3":{const s=V("size",n,e,t),r=V("dtype",n,e,t),i=V("elementShape",n,e,t),a=V("dynamicSize",n,e,t),o=V("clearAfterRead",n,e,t),l=V("identicalElementShapes",n,e,t),c=V("name",n,e,t),h=new Cye(c,r,s,i,l,a,o);return t.addTensorArray(h),[h.idTensor,Zt(1)]}case"TensorArrayWriteV3":{const s=V("tensorArrayId",n,e,t),r=V("index",n,e,t),i=V("tensor",n,e,t),a=t.getTensorArray(s.id);return a.write(r,i),[a.idTensor]}case"TensorArrayReadV3":{const s=V("tensorArrayId",n,e,t),r=V("index",n,e,t);return[t.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=V("tensorArrayId",n,e,t),r=V("indices",n,e,t),i=V("dtype",n,e,t);return[t.getTensorArray(s.id).gather(r,i)]}case"TensorArrayScatterV3":{const s=V("tensorArrayId",n,e,t),r=V("indices",n,e,t),i=V("tensor",n,e,t),a=t.getTensorArray(s.id);return a.scatter(r,i),[a.idTensor]}case"TensorArrayConcatV3":{const s=V("tensorArrayId",n,e,t),r=t.getTensorArray(s.id),i=V("dtype",n,e,t);return[r.concat(i)]}case"TensorArraySplitV3":{const s=V("tensorArrayId",n,e,t),r=V("tensor",n,e,t),i=V("lengths",n,e,t),a=t.getTensorArray(s.id);return a.split(i,r),[a.idTensor]}case"TensorArraySizeV3":{const s=V("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return[Zt(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=V("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=V("tensorListId",n,e,t),r=V("index",n,e,t),i=V("tensor",n,e,t),a=t.getTensorList(s.id);return a.setItem(r,i),[a.idTensor]}case"TensorListGetItem":{const s=V("tensorListId",n,e,t),r=V("index",n,e,t),i=V("elementShape",n,e,t),a=V("elementDType",n,e,t);return[t.getTensorList(s.id).getItem(r,i,a)]}case"TensorListScatterV2":case"TensorListScatter":{const s=V("indices",n,e,t),r=V("tensor",n,e,t),i=V("elementShape",n,e,t),a=V("numElements",n,e,t),o=Aye(r,s,i,a);return t.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=V("elementShape",n,e,t),r=V("elementDType",n,e,t);let i;n.op==="TensorListReserve"?i="numElements":i="maxNumElements";const a=V(i,n,e,t),o=n.op==="TensorListReserve"?-1:a,l=$ye(s,r,a,o);return t.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=V("tensorListId",n,e,t),r=V("indices",n,e,t),i=V("elementShape",n,e,t),a=V("elementDType",n,e,t);return[t.getTensorList(s.id).gather(r,a,i)]}case"TensorListStack":{const s=V("tensorListId",n,e,t),r=V("elementShape",n,e,t),i=V("elementDType",n,e,t),a=V("numElements",n,e,t);return[t.getTensorList(s.id).stack(r,i,a)]}case"TensorListFromTensor":{const s=V("tensor",n,e,t),r=V("elementShape",n,e,t),i=V("elementDType",n,e,t),a=kye(s,r,i);return t.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=V("tensorListId",n,e,t),r=t.getTensorList(s.id),i=V("dtype",n,e,t),a=V("elementShape",n,e,t);return[r.concat(i,a)]}case"TensorListPushBack":{const s=V("tensorListId",n,e,t),r=V("tensor",n,e,t),i=t.getTensorList(s.id);return i.pushBack(r),[i.idTensor]}case"TensorListPopBack":{const s=V("tensorListId",n,e,t),r=V("elementShape",n,e,t),i=V("elementDType",n,e,t);return[t.getTensorList(s.id).popBack(r,i)]}case"TensorListSplit":{const s=V("tensor",n,e,t),r=V("elementShape",n,e,t),i=V("lengths",n,e,t),a=Rye(s,i,r);return t.addTensorList(a),[a.idTensor]}case"TensorListLength":{const s=V("tensorListId",n,e,t),r=t.getTensorList(s.id);return[Zt(r.size(),"int32")]}case"TensorListResize":{const s=V("tensorListId",n,e,t),r=V("size",n,e,t),a=t.getTensorList(s.id).resize(r);return t.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OM(n,e,t){const[s,r]=V("fusedOps",n,e,t),i=s==="biasadd",a=!i,o=r==="prelu",l=s==="fusedbatchnorm",c=V("numArgs",n,e,t);if(i){if(o&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const h=V("strides",n,e,t),p=u0(n,e,t),m=V("dataFormat",n,e,t).toUpperCase(),v=V("dilations",n,e,t);let[x,w]=V("args",n,e,t);a&&(w=x,x=void 0);const T=V("leakyreluAlpha",n,e,t);return{stride:h,pad:p,dataFormat:m,dilations:v,biasArg:x,preluArg:w,activationFunc:r,leakyreluAlpha:T}}const Lye=(n,e,t,s=Ur)=>{switch(n.op){case"Conv1D":{const r=V("stride",n,e,t),i=V("pad",n,e,t),a=V("dataFormat",n,e,t).toUpperCase(),o=V("dilation",n,e,t);return[s.conv1d(V("x",n,e,t),V("filter",n,e,t),r,i,a,o)]}case"Conv2D":{const r=V("strides",n,e,t),i=u0(n,e,t),a=V("dataFormat",n,e,t).toUpperCase(),o=V("dilations",n,e,t);return[s.conv2d(V("x",n,e,t),V("filter",n,e,t),[r[1],r[2]],i,a,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:a,dilations:o,biasArg:l,preluArg:c,activationFunc:h,leakyreluAlpha:p}=OM(n,e,t);return[s.fused.conv2d({x:V("x",n,e,t),filter:V("filter",n,e,t),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:l,activation:h,preluActivationWeights:c,leakyreluAlpha:p})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:a,dilations:o,biasArg:l,preluArg:c,activationFunc:h,leakyreluAlpha:p}=OM(n,e,t);return[s.fused.depthwiseConv2d({x:V("x",n,e,t),filter:V("filter",n,e,t),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:l,activation:h,preluActivationWeights:c,leakyreluAlpha:p})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=V("outputShape",n,e,t),i=V("strides",n,e,t),a=u0(n,e,t);return[s.conv2dTranspose(V("x",n,e,t),V("filter",n,e,t),r,[i[1],i[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=V("strides",n,e,t),i=u0(n,e,t),a=V("dilations",n,e,t),o=V("dataFormat",n,e,t).toUpperCase();return[s.depthwiseConv2d(V("input",n,e,t),V("filter",n,e,t),[r[1],r[2]],i,o,[a[1],a[2]])]}case"Conv3D":{const r=V("strides",n,e,t),i=V("pad",n,e,t),a=V("dataFormat",n,e,t).toUpperCase(),o=V("dilations",n,e,t);return[s.conv3d(V("x",n,e,t),V("filter",n,e,t),[r[1],r[2],r[3]],i,a,[o[1],o[2],o[3]])]}case"AvgPool":{const r=V("strides",n,e,t),i=V("pad",n,e,t),a=V("kernelSize",n,e,t);return[s.avgPool(V("x",n,e,t),[a[1],a[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=V("strides",n,e,t),i=V("pad",n,e,t),a=V("kernelSize",n,e,t);return[s.maxPool(V("x",n,e,t),[a[1],a[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=V("strides",n,e,t),i=V("pad",n,e,t),a=V("kernelSize",n,e,t),o=V("includeBatchInIndex",n,e,t),{result:l,indexes:c}=s.maxPoolWithArgmax(V("x",n,e,t),[a[1],a[2]],[r[1],r[2]],i,o);return[l,c]}case"AvgPool3D":{const r=V("strides",n,e,t),i=V("pad",n,e,t),a=V("kernelSize",n,e,t);return[s.avgPool3d(V("x",n,e,t),[a[1],a[2],a[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=V("strides",n,e,t),i=V("pad",n,e,t),a=V("kernelSize",n,e,t);return[s.maxPool3d(V("x",n,e,t),[a[1],a[2],a[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=V("strides",n,e,t),i=V("pad",n,e,t),a=V("dilations",n,e,t),o=r[1],l=r[2],c=a[1],h=a[2];return[s.dilation2d(V("x",n,e,t),V("filter",n,e,t),[o,l],i,[c,h],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oye=(n,e,t,s=Ur)=>{switch(n.op){case"Fill":{const r=V("shape",n,e,t),i=V("dtype",n,e,t),a=V("value",n,e,t);return[s.fill(r,a,i)]}case"LinSpace":{const r=V("start",n,e,t),i=V("stop",n,e,t),a=V("num",n,e,t);return[s.linspace(r,i,a)]}case"Multinomial":{const r=V("logits",n,e,t),i=V("numSamples",n,e,t),a=V("seed",n,e,t);return[s.multinomial(r,i,a)]}case"OneHot":{const r=V("indices",n,e,t),i=V("depth",n,e,t),a=V("onValue",n,e,t),o=V("offValue",n,e,t),l=V("dtype",n,e,t);return[s.oneHot(r,i,a,o,l)]}case"Ones":return[s.ones(V("shape",n,e,t),V("dtype",n,e,t))];case"OnesLike":return[s.onesLike(V("x",n,e,t))];case"RandomStandardNormal":return[s.randomStandardNormal(V("shape",n,e,t),V("dtype",n,e,t),V("seed",n,e,t))];case"RandomUniform":return[s.randomUniform(V("shape",n,e,t),V("minval",n,e,t),V("maxval",n,e,t),V("dtype",n,e,t))];case"Range":{const r=V("start",n,e,t),i=V("stop",n,e,t),a=V("step",n,e,t);return[s.range(r,i,a,V("dtype",n,e,t))]}case"TruncatedNormal":{const r=V("shape",n,e,t),i=V("mean",n,e,t),a=V("stdDev",n,e,t),o=V("seed",n,e,t);return[s.truncatedNormal(r,i,a,V("dtype",n,e,t),o)]}case"Zeros":return[s.zeros(V("shape",n,e,t),V("dtype",n,e,t))];case"ZerosLike":return[s.zerosLike(V("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sN(n,e,t){const s=V("boxes",n,e,t),r=V("scores",n,e,t),i=V("maxOutputSize",n,e,t),a=V("iouThreshold",n,e,t),o=V("scoreThreshold",n,e,t),l=V("softNmsSigma",n,e,t);return{boxes:s,scores:r,maxOutputSize:i,iouThreshold:a,scoreThreshold:o,softNmsSigma:l}}const Pye=async(n,e,t,s,r=Ur)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:h}=sN(n,e,t),p=await r.image.nonMaxSuppressionWithScoreAsync(i,a,o,l,c,h);return[p.selectedIndices,p.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=sN(n,e,t),h=V("padToMaxOutputSize",n,e,t),p=await r.image.nonMaxSuppressionPaddedAsync(i,a,o,l,c,h);return[p.selectedIndices,p.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=sN(n,e,t);return[await r.image.nonMaxSuppressionAsync(i,a,o,l,c)]}case"Where":{const i=r.cast(V("condition",n,e,t),"bool"),a=[await r.whereAsync(i)];return i.dispose(),a}case"ListDiff":return r.setdiff1dAsync(V("x",n,e,t),V("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mye=(n,e,t,s=Ur)=>{switch(n.op){case"LowerBound":{const r=V("sortedSequence",n,e,t),i=V("values",n,e,t);return[s.lowerBound(r,i)]}case"TopKV2":{const r=V("x",n,e,t),i=V("k",n,e,t),a=V("sorted",n,e,t),o=s.topk(r,i,a);return[o.values,o.indices]}case"UpperBound":{const r=V("sortedSequence",n,e,t),i=V("values",n,e,t);return[s.upperBound(r,i)]}case"Unique":{const r=V("x",n,e,t),i=s.unique(r);return[i.values,i.indices]}case"UniqueV2":{const r=V("x",n,e,t),i=V("axis",n,e,t),a=s.unique(r,i);return[a.values,a.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fye=(n,e,t,s=Ur)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const r=V("default",n,e,t);return[li(n.name,e,t)||r];case"Placeholder":return[li(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const h=V("x",n,e,t);return[Oc(h)]}case"IdentityN":return V("x",n,e,t).map(h=>Oc(h));case"Snapshot":const i=V("x",n,e,t);return[Oc(i)];case"Shape":return[s.tensor1d(V("x",n,e,t).shape,"int32")];case"ShapeN":return V("x",n,e,t).map(h=>s.tensor1d(h.shape));case"Size":return[s.scalar(V("x",n,e,t).size,"int32")];case"Rank":return[s.scalar(V("x",n,e,t).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const a=V("x",n,e,t),o=V("data",n,e,t),l=V("message",n,e,t),c=V("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let h=0;h<o.length;h++)console.log(Array.prototype.slice.call(o[h].dataSync()).slice(0,c));return[a];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jye{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Zt(0),this.tensorMap=new Map,Cl(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Zt(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),pn(()=>{const r=Qh(t),i=s.length,a=r.length;se(i===a,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${a} elements.`);for(let o=0;o<i;o++){const l=s[o],c=r[o];Cl(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return pn(()=>{const r=[];for(let i=0;i<s.length;i++){const a=s[i],o=this.findWithDefault(a,t);r.push(o)}return Yl(r)})}findWithDefault(e,t){const s=this.tensorMap.get(e);return s??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bye=async(n,e,t,s)=>{switch(n.op){case"HashTable":case"HashTableV2":{const r=V("keyDType",n,e,t),i=V("valueDType",n,e,t),a=new jye(r,i);return s.addHashTable(n.name,a),[a.handle]}case"LookupTableImport":case"LookupTableImportV2":{const r=V("tableHandle",n,e,t,s),i=V("keys",n,e,t),a=V("values",n,e,t);return[await s.getHashTableById(r.id).import(i,a)]}case"LookupTableFind":case"LookupTableFindV2":{const r=V("tableHandle",n,e,t,s),i=V("keys",n,e,t),a=V("defaultValue",n,e,t);return[await s.getHashTableById(r.id).find(i,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=V("tableHandle",n,e,t,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zye=(n,e,t,s=Ur)=>{switch(n.op){case"ResizeBilinear":{const r=V("images",n,e,t),i=V("size",n,e,t),a=V("alignCorners",n,e,t),o=V("halfPixelCenters",n,e,t);return[s.image.resizeBilinear(r,[i[0],i[1]],a,o)]}case"ResizeNearestNeighbor":{const r=V("images",n,e,t),i=V("size",n,e,t),a=V("alignCorners",n,e,t),o=V("halfPixelCenters",n,e,t);return[s.image.resizeNearestNeighbor(r,[i[0],i[1]],a,o)]}case"CropAndResize":{const r=V("image",n,e,t),i=V("boxes",n,e,t),a=V("boxInd",n,e,t),o=V("cropSize",n,e,t),l=V("method",n,e,t),c=V("extrapolationValue",n,e,t);return[s.image.cropAndResize(r,i,a,o,l,c)]}case"ImageProjectiveTransformV3":{const r=V("images",n,e,t),i=V("transforms",n,e,t),a=V("outputShape",n,e,t),o=V("fillValue",n,e,t),l=V("interpolation",n,e,t),c=V("fillMode",n,e,t);return[s.image.transform(r,i,l.toLowerCase(),c.toLowerCase(),o,a)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vye=(n,e,t,s=Ur)=>{switch(n.op){case"Equal":return[s.equal(V("a",n,e,t),V("b",n,e,t))];case"NotEqual":return[s.notEqual(V("a",n,e,t),V("b",n,e,t))];case"Greater":return[s.greater(V("a",n,e,t),V("b",n,e,t))];case"GreaterEqual":return[s.greaterEqual(V("a",n,e,t),V("b",n,e,t))];case"Less":return[s.less(V("a",n,e,t),V("b",n,e,t))];case"LessEqual":return[s.lessEqual(V("a",n,e,t),V("b",n,e,t))];case"LogicalAnd":return[s.logicalAnd(V("a",n,e,t),V("b",n,e,t))];case"LogicalNot":return[s.logicalNot(V("a",n,e,t))];case"LogicalOr":return[s.logicalOr(V("a",n,e,t),V("b",n,e,t))];case"Select":case"SelectV2":return[s.where(V("condition",n,e,t),V("a",n,e,t),V("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uye=(n,e,t,s=Ur)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(V("a",n,e,t),V("b",n,e,t),V("transposeA",n,e,t),V("transposeB",n,e,t))];case"Einsum":return[s.einsum(V("equation",n,e,t),...V("tensors",n,e,t))];case"Transpose":return[s.transpose(V("x",n,e,t),V("perm",n,e,t))];case"_FusedMatMul":const[r,i]=V("fusedOps",n,e,t),a=r==="biasadd",o=i==="prelu",l=V("numArgs",n,e,t),c=V("leakyreluAlpha",n,e,t);if(a){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[h,p]=V("args",n,e,t);return[s.fused.matMul({a:V("a",n,e,t),b:V("b",n,e,t),transposeA:V("transposeA",n,e,t),transposeB:V("transposeB",n,e,t),bias:h,activation:i,preluActivationWeights:p,leakyreluAlpha:c})];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gye=(n,e,t,s=Ur)=>{switch(n.op){case"EuclideanNorm":return[s.euclideanNorm(V("x",n,e,t),V("axis",n,e,t),V("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(V("x",n,e,t),V("mean",n,e,t),V("variance",n,e,t),V("offset",n,e,t),V("scale",n,e,t),V("epsilon",n,e,t))];case"FusedBatchNormV3":return[s.batchNorm(V("x",n,e,t),V("mean",n,e,t),V("variance",n,e,t),V("offset",n,e,t),V("scale",n,e,t),V("epsilon",n,e,t))];case"LRN":return[s.localResponseNormalization(V("x",n,e,t),V("radius",n,e,t),V("bias",n,e,t),V("alpha",n,e,t),V("beta",n,e,t))];case"Softmax":return[s.softmax(V("x",n,e,t))];case"LogSoftmax":return[s.logSoftmax(V("x",n,e,t))];case"SparseToDense":return[s.sparseToDense(V("sparseIndices",n,e,t),V("outputShape",n,e,t),V("sparseValues",n,e,t),V("defaultValue",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wye=(n,e,t,s=Ur)=>{switch(n.op){case"Max":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[s.max(V("x",n,e,t),o,l)]}case"Mean":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[s.mean(V("x",n,e,t),o,l)]}case"Min":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[s.min(V("x",n,e,t),o,l)]}case"Sum":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[s.sum(V("x",n,e,t),o,l)]}case"All":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[s.all(V("x",n,e,t),o,l)]}case"Any":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[s.any(V("x",n,e,t),o,l)]}case"ArgMax":{const o=V("axis",n,e,t);return[s.argMax(V("x",n,e,t),o)]}case"ArgMin":{const o=V("axis",n,e,t);return[s.argMin(V("x",n,e,t),o)]}case"Prod":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[s.prod(V("x",n,e,t),o,l)]}case"Cumprod":{const o=V("axis",n,e,t),l=V("exclusive",n,e,t),c=V("reverse",n,e,t);return[s.cumprod(V("x",n,e,t),o,l,c)]}case"Cumsum":{const o=V("axis",n,e,t),l=V("exclusive",n,e,t),c=V("reverse",n,e,t);return[s.cumsum(V("x",n,e,t),o,l,c)]}case"Bincount":const r=V("x",n,e,t),i=V("weights",n,e,t),a=V("size",n,e,t);return[s.bincount(r,i,a)];case"DenseBincount":{const o=V("x",n,e,t),l=V("weights",n,e,t),c=V("size",n,e,t),h=V("binaryOutput",n,e,t);return[s.denseBincount(o,l,c,h)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hye=(n,e,t,s=Ur)=>{switch(n.op){case"ConcatV2":case"Concat":{const r=V("n",n,e,t),i=V("axis",n,e,t);let a=V("tensors",n,e,t);return a=a.slice(0,r),[s.concat(a,i)]}case"Gather":{const r=V("x",n,e,t),i=V("indices",n,e,t);return[s.gather(r,s.cast(i,"int32"),0)]}case"GatherV2":{const r=V("axis",n,e,t),i=V("batchDims",n,e,t),a=V("x",n,e,t),o=V("indices",n,e,t);return[s.gather(a,s.cast(o,"int32"),r,i)]}case"Reverse":{const r=V("dims",n,e,t),i=[];for(let o=0;o<r.length;o++)r[o]&&i.push(o);const a=V("x",n,e,t);return[s.reverse(a,i)]}case"ReverseV2":{const r=V("axis",n,e,t),i=V("x",n,e,t);return[s.reverse(i,r)]}case"Slice":{const r=V("begin",n,e,t),i=V("size",n,e,t);return[s.slice(V("x",n,e,t),r,i)]}case"StridedSlice":{const r=V("begin",n,e,t),i=V("end",n,e,t),a=V("strides",n,e,t),o=V("beginMask",n,e,t),l=V("endMask",n,e,t),c=V("ellipsisMask",n,e,t),h=V("newAxisMask",n,e,t),p=V("shrinkAxisMask",n,e,t),m=V("x",n,e,t);return[s.stridedSlice(m,r,i,a,o,l,c,h,p)]}case"Pack":return pn(()=>{const r=V("axis",n,e,t),i=V("tensors",n,e,t),a=i[0].shape,o=s.squeeze(i[0]).shape,l=i.map(c=>{const h=ql(c.shape,a);if(!h&&!ql(s.squeeze(c).shape,o))throw new Error("the input tensors shape does not match");return h?c:s.reshape(c,a)});return[s.stack(l,r)]});case"Unpack":{const r=V("axis",n,e,t),i=V("tensor",n,e,t);return s.unstack(i,r)}case"Tile":{const r=V("reps",n,e,t);return[s.tile(V("x",n,e,t),r)]}case"Split":case"SplitV":{const r=V("axis",n,e,t),i=V("numOrSizeSplits",n,e,t),a=V("x",n,e,t);return s.split(a,i,r)}case"ScatterNd":{const r=V("indices",n,e,t),i=V("values",n,e,t),a=V("shape",n,e,t);return[s.scatterND(r,i,a)]}case"GatherNd":{const r=V("x",n,e,t),i=V("indices",n,e,t);return[s.gatherND(r,i)]}case"SparseToDense":{const r=V("sparseIndices",n,e,t),i=V("outputShape",n,e,t),a=V("sparseValues",n,e,t),o=V("defaultValue",n,e,t);return[s.sparseToDense(r,a,i,a.dtype===o.dtype?o:s.cast(o,a.dtype))]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qye=(n,e,t,s=Ur)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:i,emptyRowIndicator:a,reverseIndexMap:o}=s.sparse.sparseFillEmptyRows(V("indices",n,e,t),V("values",n,e,t),V("denseShape",n,e,t),V("defaultValue",n,e,t));return[r,i,a,o]}case"SparseReshape":{const{outputIndices:r,outputShape:i}=s.sparse.sparseReshape(V("inputIndices",n,e,t),V("inputShape",n,e,t),V("newShape",n,e,t));return[r,i]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(V("data",n,e,t),V("indices",n,e,t),V("segmentIds",n,e,t))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(V("data",n,e,t),V("indices",n,e,t),V("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kye=(n,e,t,s=Ur)=>{switch(n.op){case"FFT":return[s.fft(V("x",n,e,t))];case"IFFT":return[s.ifft(V("x",n,e,t))];case"RFFT":return[s.rfft(V("x",n,e,t))];case"IRFFT":return[s.irfft(V("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xye=(n,e,t,s=Ur)=>{switch(n.op){case"StringNGrams":{const{nGrams:r,nGramsSplits:i}=s.string.stringNGrams(V("data",n,e,t),V("dataSplits",n,e,t),V("separator",n,e,t),V("nGramWidths",n,e,t),V("leftPad",n,e,t),V("rightPad",n,e,t),V("padWidth",n,e,t),V("preserveShortSequences",n,e,t));return[r,i]}case"StringSplit":{const{indices:r,values:i,shape:a}=s.string.stringSplit(V("input",n,e,t),V("delimiter",n,e,t),V("skipEmpty",n,e,t));return[r,i,a]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(V("input",n,e,t),V("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zye=(n,e,t,s=Ur)=>{switch(n.op){case"Cast":return[s.cast(V("x",n,e,t),V("dtype",n,e,t))];case"ExpandDims":{const r=V("axis",n,e,t);return[s.expandDims(V("x",n,e,t),r)]}case"Squeeze":{const r=V("axis",n,e,t);return[s.squeeze(V("x",n,e,t),r)]}case"Reshape":return[s.reshape(V("x",n,e,t),V("shape",n,e,t))];case"MirrorPad":return[s.mirrorPad(V("x",n,e,t),V("padding",n,e,t),V("mode",n,e,t))];case"PadV2":case"Pad":return[s.pad(V("x",n,e,t),V("padding",n,e,t),V("constantValue",n,e,t))];case"SpaceToBatchND":{const r=V("blockShape",n,e,t),i=V("paddings",n,e,t);return[s.spaceToBatchND(V("x",n,e,t),r,i)]}case"BatchToSpaceND":{const r=V("blockShape",n,e,t),i=V("crops",n,e,t);return[s.batchToSpaceND(V("x",n,e,t),r,i)]}case"DepthToSpace":{const r=V("blockSize",n,e,t),i=V("dataFormat",n,e,t).toUpperCase();return[s.depthToSpace(V("x",n,e,t),r,i)]}case"BroadcastTo":return[s.broadcastTo(V("x",n,e,t),V("shape",n,e,t))];case"BroadcastArgs":return[s.broadcastArgs(V("s0",n,e,t),V("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PM(n,e,t,s,r=pn){const i=((a,o,l)=>{switch(a.category){case"arithmetic":return r(()=>Nye(a,o,l));case"basic_math":return r(()=>Iye(a,o,l));case"control":return Dye(a,o,l);case"convolution":return r(()=>Lye(a,o,l));case"creation":return r(()=>Oye(a,o,l));case"dynamic":return Pye(a,o,l);case"evaluation":return r(()=>Mye(a,o,l));case"image":return r(()=>zye(a,o,l));case"graph":return r(()=>Fye(a,o,l));case"logical":return r(()=>Vye(a,o,l));case"matrices":return r(()=>Uye(a,o,l));case"normalization":return r(()=>Gye(a,o,l));case"reduction":return r(()=>Wye(a,o,l));case"slice_join":return r(()=>Hye(a,o,l));case"sparse":return r(()=>qye(a,o,l));case"spectral":return r(()=>Kye(a,o,l));case"string":return r(()=>Xye(a,o,l));case"transformation":return r(()=>Zye(a,o,l));case"hash_table":return Bye(a,o,l,s);case"custom":const c=BW(a.op);if(c&&c.customExecutor)return c.customExecutor(new Eye(a,o,l));throw TypeError(`Custom op ${a.op} is not registered.`);default:throw TypeError(`Unknown op '${a.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return yf(i)?i.then(a=>[].concat(a)):[].concat(i)}class MM{constructor(e={},t={},s={},r={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=s,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const s=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FM(n,e,t,s){const r=new Set,i=[];let a=null,o=null;const l=new Set,c=Object.keys(n).map(m=>Zi(m)[0]);let h=[];s!=null&&(h=s.map(m=>Zi(m.name)[0]));const p=[...e];for(;p.length>0;){const m=p.pop();if((UW(m)||tve(m)||nve(m))&&a==null&&(a=m,o=a.children.map(v=>v.name).filter(v=>r.has(v))),r.add(m.name),t[m.name]==null&&c.indexOf(m.name)===-1&&h.indexOf(m.name)===-1){if(m.inputs.length===0){i.push(m.name);continue}m.inputs.forEach(v=>{l.has(v.name)||(l.add(v.name),p.push(v))})}}return{inputs:n,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:a,syncInputs:o}}function Yye(n,e,t){const{usedNodes:s,inputs:r}=t,i=[],a=Object.keys(r).map(h=>Zi(h)[0]).map(h=>n.nodes[h]),o=n.initNodes;a.forEach(h=>{s.has(h.name)&&i.push(h)}),n.weights.forEach(h=>{s.has(h.name)&&i.push(h)}),o?.forEach(h=>{s.has(h.name)&&i.push(h)});const l=new Set,c=[];for(;i.length>0;){const h=i.pop();l.add(h.name),e[h.name]||c.push(h),h.children.forEach(p=>{!l.has(p.name)&&s.has(p.name)&&p.inputs.every(m=>l.has(m.name))&&i.push(p)})}return c}const Qye=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],Jye=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],eve=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function UW(n){return Qye.indexOf(n.op)>=0}function tve(n){return Jye.indexOf(n.op)>=0}function nve(n){return eve.indexOf(n.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q0{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new q0(e.functions[s],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}getCompilationKey(e,t){const s=e.map(i=>i.name).sort(),r=t.map(i=>i.name).sort();return s.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(e,t){const s=FM(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:a}=s;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(r.length>0){const o=t.map(c=>c.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${o}] from the provided inputs [${l}]. Missing the following inputs: [${r}]`)}return Yye(this.graph,this.weightMap,s)}execute(e,t){e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=s.map(p=>this.graph.nodes[Zi(p)[0]]),i=t.map(p=>Zi(p)[0]);let a=i.map(p=>this.graph.nodes[p]);this.resetIntermediateTensors(),a.length===0&&(a=this._outputs);const o=this.getCompilationKey(r,a);let l=this.compiledMap.get(o);l==null&&(l=this.compile(e,a),this.compiledMap.set(o,l));const c={},h={};return pn(()=>{const p=new MM(this.weightMap,c,h,this.functionExecutorMap),m=Object.assign({},this.weightMap);Object.keys(e).forEach(w=>{const[T,E]=Zi(w),C=[];C[E]=e[w],m[T]=C});const v=this.getFrozenTensorIds(m),x={};for(let w=0;w<l.length;w++){const T=l[w];if(!m[T.name]){const E=PM(T,m,p,this._resourceManager);if(yf(E))throw new Error(`The execution of the op '${T.op}' returned a promise. Please use model.executeAsync() instead.`);m[T.name]=E,this.checkTensorForDisposal(T.name,T,m,p,v,i,x)}}return this.parent==null&&p.dispose(v),t.map(w=>li(w,m,p))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(t)}checkTensorForDisposal(e,t,s,r,i,a,o){t.category==="control"||a.indexOf(e)!==-1||(s[e].forEach(l=>{l!=null&&(o[l.id]=(o[l.id]||0)+t.children.length)}),t.inputs.forEach(l=>{if(l.category!=="control"){const c=jge(l.name,s,r);c?.forEach(h=>{if(h&&!h.kept&&!i.has(h.id)){const p=o[h.id];if(p===1){if(!this.keepTensorForDebug)h.dispose();else{const[m,v]=Tl(t.name,r);this.intermediateTensors[m]?this.intermediateTensors[m][v]=h:(this.intermediateTensors[m]=[],this.intermediateTensors[m][v]=h)}delete o[h.id]}else p!=null&&o[h.id]--}})}}))}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(t=>t.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(s=>{s&&!s.kept&&!s.isDisposed&&!this.keepIds.has(s.id)&&s.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(t=>t.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,t,s=!1,r={},i={}){s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepTensorForDebug=At().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){console.warn(h.message)}this.resetIntermediateTensors();const a=new MM(this.weightMap,r,i,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,a,t,s);const o=t.map(h=>li(h,this.tensorsMap,a)),l=o.map(h=>h.id),c=Object.keys(e).map(h=>e[h].id);return this.keepIds=new Set([...l,...c,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&a.dispose(this.keepIds),o}async executeFunctionAsync(e,t,s){const r=e.reduce((i,a,o)=>(i[this.inputs[o].name]=a,i),{});return this._executeAsync(r,this.outputNodes,!0,t,s)}async executeWithControlFlow(e,t,s,r){const i=Object.keys(e),a=i.map($=>this.graph.nodes[Zi($)[0]]),o=s.map($=>Zi($)[0]);let l=o.map($=>this.graph.nodes[$]);l.length===0&&(l=this._outputs);const{usedNodes:c,missingInputs:h,dynamicNode:p,syncInputs:m}=FM(e,l,this.weightMap,this._initNodes),v=[...a,...this.graph.weights,...this._initNodes||[]].map($=>({node:$,contexts:t.currentContext})),x=Object.assign({},this.weightMap);Object.keys(e).forEach($=>{const[R,P]=Zi($),U=[];U[P]=e[$],x[R]=U});const w={},T=this.getFrozenTensorIds(x),E={};for(;v.length>0;){const $=this.processStack(a,v,t,x,E,T,o,w,c);await Promise.all($)}p==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const C=l.filter($=>!UW($)&&!li($.name,x,t)).map($=>$.name);if(C.length>0){let $="";throw p!=null&&($=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${m}]`),new Error(`Cannot compute the outputs [${C}] from the provided inputs [${i}]. Consider providing the following inputs: [${h}]. ${$}`)}return x}processStack(e,t,s,r,i,a,o,l,c){const h=[];for(;t.length>0;){const p=t.pop();s.currentContext=p.contexts;let m="";if(p.node.op==="Enter"&&V("isConstant",p.node,r,s)&&([m]=Tl(p.node.name,s)),r[p.node.name]==null){const v=PM(p.node,r,s,this._resourceManager);m||([m]=Tl(p.node.name,s));const x=s.currentContext;yf(v)?h.push(v.then(w=>(r[m]=w,s.currentContext=x,this.checkTensorForDisposal(m,p.node,r,s,a,o,l),this.processChildNodes(p.node,t,s,r,i,c),w))):(r[m]=v,this.checkTensorForDisposal(m,p.node,r,s,a,o,l),this.processChildNodes(p.node,t,s,r,i,c))}else this.processChildNodes(p.node,t,s,r,i,c)}return h}processChildNodes(e,t,s,r,i,a){e.children.forEach(o=>{const[l]=Tl(o.name,s);i[l]||!a.has(o.name)||(o.op==="Merge"?o.inputNames.some(c=>!!li(c,r,s))&&(i[l]=!0,t.push({contexts:s.currentContext,node:o})):o.inputNames.every(c=>!!li(c,r,s))&&(i[l]=!0,t.push({contexts:s.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const s=e[t],[r]=Zi(t),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const a=i.attrParams.shape.value,o=a.length===s.shape.length&&s.shape.every((l,c)=>a[c]===-1||a[c]===l);se(o,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${a}], but was [${s.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&se(s.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){const t={};for(const s in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[s]!=null){const r=this._signature.inputs[s];t[r.name]=e[s]}else t[s]=e[s];return t}checkInputs(e){const t=Object.keys(e).filter(s=>{const[r]=Zi(s);return this.graph.nodes[r]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[t]!=null?this._signature.outputs[t].name:t,{})}checkOutputs(e){e.forEach(t=>{const[s]=Zi(t);if(!this.graph.nodes[s])throw new Error(`The output '${t}' is not found in the graph`)})}}class sve{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rve="?tfjs-format=file",ive="model.json";class ave{constructor(e,t={},s=Wk){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=s,t==null&&(this.loadOptions={}),this.resourceManager=new sve}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return yf(e)?e.then(t=>this.loadSync(t)):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(s=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}this.signature=s,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new q0(RM.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=RM.Instance.transformGraph(e.modelInitializer);this.initializer=new q0(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){const s=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const r=s instanceof os?[s]:s,i={};return r.forEach((a,o)=>i[this.structuredOutputKeys[o]]=a),i}return s}normalizeInputs(e){if(!(e instanceof os)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((t,s,r)=>(t[s]=e[r],t),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=this.executor.execute(e,t);return s.length>1?s:s[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=await this.executor.executeAsync(e,t);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,s)=>(t[s]=[e[s]],t),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function ove(n,e={},t=Wk){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=lve(n));const s=new ave(n,e,t);return await s.load(),s}function lve(n){return n.endsWith("/")||(n=n+"/"),`${n}${ive}${rve}`}/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    *//**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function K0(n,e,t,s){return new(t||(t=Promise))((function(r,i){function a(c){try{l(s.next(c))}catch(h){i(h)}}function o(c){try{l(s.throw(c))}catch(h){i(h)}}function l(c){c.done?r(c.value):new t((function(h){h(c.value)})).then(a,o)}l((s=s.apply(n,[])).next())}))}function X0(n,e){var t,s,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(l){return function(c){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,s&&(r=2&h[0]?s.return:h[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,h[1])).done)return r;switch(s=0,r&&(h=[2&h[0],r.value]),h[0]){case 0:case 1:r=h;break;case 4:return a.label++,{value:h[1],done:!1};case 5:a.label++,s=h[1],h=[0];continue;case 7:h=a.ops.pop(),a.trys.pop();continue;default:if(r=a.trys,!((r=r.length>0&&r[r.length-1])||h[0]!==6&&h[0]!==2)){a=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){a.label=h[1];break}if(h[0]===6&&a.label<r[1]){a.label=r[1],r=h;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(h);break}r[2]&&a.ops.pop(),a.trys.pop();continue}h=e.call(n,a)}catch(p){h=[6,p],s=0}finally{t=r=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([l,c])}}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var cve="https://tfhub.dev/tensorflow/tfjs-model/deeplab",uve=513,rN={ADE20K:[[0,0,0],[120,120,120],[180,120,120],[6,230,230],[80,50,50],[4,200,3],[120,120,80],[140,140,140],[204,5,255],[230,230,230],[4,250,7],[224,5,255],[235,255,7],[150,5,61],[120,120,70],[8,255,51],[255,6,82],[143,255,140],[204,255,4],[255,51,7],[204,70,3],[0,102,200],[61,230,250],[255,6,51],[11,102,255],[255,7,71],[255,9,224],[9,7,230],[220,220,220],[255,9,92],[112,9,255],[8,255,214],[7,255,224],[255,184,6],[10,255,71],[255,41,10],[7,255,255],[224,255,8],[102,8,255],[255,61,6],[255,194,7],[255,122,8],[0,255,20],[255,8,41],[255,5,153],[6,51,255],[235,12,255],[160,150,20],[0,163,255],[140,140,140],[250,10,15],[20,255,0],[31,255,0],[255,31,0],[255,224,0],[153,255,0],[0,0,255],[255,71,0],[0,235,255],[0,173,255],[31,0,255],[11,200,200],[255,82,0],[0,255,245],[0,61,255],[0,255,112],[0,255,133],[255,0,0],[255,163,0],[255,102,0],[194,255,0],[0,143,255],[51,255,0],[0,82,255],[0,255,41],[0,255,173],[10,0,255],[173,255,0],[0,255,153],[255,92,0],[255,0,255],[255,0,245],[255,0,102],[255,173,0],[255,0,20],[255,184,184],[0,31,255],[0,255,61],[0,71,255],[255,0,204],[0,255,194],[0,255,82],[0,10,255],[0,112,255],[51,0,255],[0,194,255],[0,122,255],[0,255,163],[255,153,0],[0,255,10],[255,112,0],[143,255,0],[82,0,255],[163,255,0],[255,235,0],[8,184,170],[133,0,255],[0,255,92],[184,0,255],[255,0,31],[0,184,255],[0,214,255],[255,0,112],[92,255,0],[0,224,255],[112,224,255],[70,184,160],[163,0,255],[153,0,255],[71,255,0],[255,0,163],[255,204,0],[255,0,143],[0,255,235],[133,255,0],[255,0,235],[245,0,255],[255,0,122],[255,245,0],[10,190,212],[214,255,0],[0,204,255],[20,0,255],[255,255,0],[0,153,255],[0,41,255],[0,255,204],[41,0,255],[41,255,0],[173,0,255],[0,245,255],[71,0,255],[122,0,255],[0,255,184],[0,92,255],[184,255,0],[0,133,255],[255,214,0],[25,194,194],[102,255,0],[92,0,255]],CITYSCAPES:[[128,64,128],[244,35,232],[70,70,70],[102,102,156],[190,153,153],[153,153,153],[250,170,30],[220,220,0],[107,142,35],[152,251,152],[70,130,180],[220,20,60],[255,0,0],[0,0,142],[0,0,70],[0,60,100],[0,80,100],[0,0,230],[119,11,32]],PASCAL:[[0,0,0],[128,0,0],[0,128,0],[128,128,0],[0,0,128],[128,0,128],[0,128,128],[128,128,128],[64,0,0],[192,0,0],[64,128,0],[192,128,0],[64,0,128],[192,0,128],[64,128,128],[192,128,128],[0,64,0],[128,64,0],[0,192,0],[128,192,0],[0,64,128],[128,64,128],[0,192,128],[128,192,128],[64,64,0],[192,64,0],[64,192,0],[192,192,0],[64,64,128],[192,64,128],[64,192,128],[192,192,128],[0,0,64],[128,0,64],[0,128,64],[128,128,64],[0,0,192],[128,0,192],[0,128,192],[128,128,192],[64,0,64],[192,0,64],[64,128,64],[192,128,64],[64,0,192],[192,0,192],[64,128,192],[192,128,192],[0,64,64],[128,64,64],[0,192,64],[128,192,64],[0,64,192],[128,64,192],[0,192,192],[128,192,192],[64,64,64],[192,64,64],[64,192,64],[192,192,64],[64,64,192],[192,64,192],[64,192,192],[192,192,192],[32,0,0],[160,0,0],[32,128,0],[160,128,0],[32,0,128],[160,0,128],[32,128,128],[160,128,128],[96,0,0],[224,0,0],[96,128,0],[224,128,0],[96,0,128],[224,0,128],[96,128,128],[224,128,128],[32,64,0],[160,64,0],[32,192,0],[160,192,0],[32,64,128],[160,64,128],[32,192,128],[160,192,128],[96,64,0],[224,64,0],[96,192,0],[224,192,0],[96,64,128],[224,64,128],[96,192,128],[224,192,128],[32,0,64],[160,0,64],[32,128,64],[160,128,64],[32,0,192],[160,0,192],[32,128,192],[160,128,192],[96,0,64],[224,0,64],[96,128,64],[224,128,64],[96,0,192],[224,0,192],[96,128,192],[224,128,192],[32,64,64],[160,64,64],[32,192,64],[160,192,64],[32,64,192],[160,64,192],[32,192,192],[160,192,192],[96,64,64],[224,64,64],[96,192,64],[224,192,64],[96,64,192],[224,64,192],[96,192,192],[224,192,192],[0,32,0],[128,32,0],[0,160,0],[128,160,0],[0,32,128],[128,32,128],[0,160,128],[128,160,128],[64,32,0],[192,32,0],[64,160,0],[192,160,0],[64,32,128],[192,32,128],[64,160,128],[192,160,128],[0,96,0],[128,96,0],[0,224,0],[128,224,0],[0,96,128],[128,96,128],[0,224,128],[128,224,128],[64,96,0],[192,96,0],[64,224,0],[192,224,0],[64,96,128],[192,96,128],[64,224,128],[192,224,128],[0,32,64],[128,32,64],[0,160,64],[128,160,64],[0,32,192],[128,32,192],[0,160,192],[128,160,192],[64,32,64],[192,32,64],[64,160,64],[192,160,64],[64,32,192],[192,32,192],[64,160,192],[192,160,192],[0,96,64],[128,96,64],[0,224,64],[128,224,64],[0,96,192],[128,96,192],[0,224,192],[128,224,192],[64,96,64],[192,96,64],[64,224,64],[192,224,64],[64,96,192],[192,96,192],[64,224,192],[192,224,192],[32,32,0],[160,32,0],[32,160,0],[160,160,0],[32,32,128],[160,32,128],[32,160,128],[160,160,128],[96,32,0],[224,32,0],[96,160,0],[224,160,0],[96,32,128],[224,32,128],[96,160,128],[224,160,128],[32,96,0],[160,96,0],[32,224,0],[160,224,0],[32,96,128],[160,96,128],[32,224,128],[160,224,128],[96,96,0],[224,96,0],[96,224,0],[224,224,0],[96,96,128],[224,96,128],[96,224,128],[224,224,128],[32,32,64],[160,32,64],[32,160,64],[160,160,64],[32,32,192],[160,32,192],[32,160,192],[160,160,192],[96,32,64],[224,32,64],[96,160,64],[224,160,64],[96,32,192],[224,32,192],[96,160,192],[224,160,192],[32,96,64],[160,96,64],[32,224,64],[160,224,64],[32,96,192],[160,96,192],[32,224,192],[160,224,192],[96,96,64],[224,96,64],[96,224,64],[224,224,64],[96,96,192],[224,96,192],[96,224,192],[224,224,192]]},iN={PASCAL:["background","aeroplane","bicycle","bird","boat","bottle","bus","car","cat","chair","cow","dining table","dog","horse","motorbike","person","potted plant","sheep","sofa","train","TV"],CITYSCAPES:["road","sidewalk","building","wall","fence","pole","traffic light","traffic sign","vegetation","terrain","sky","person","rider","car","truck","bus","train","motorcycle","bicycle"],ADE20K:["background","wall","building","sky","floor","tree","ceiling","road","bed","windowpane","grass","cabinet","sidewalk","person","earth","door","table","mountain","plant","curtain","chair","car","water","painting","sofa","shelf","house","sea","mirror","rug","field","armchair","seat","fence","desk","rock","wardrobe","lamp","bathtub","railing","cushion","base","box","column","signboard","chest","counter","sand","sink","skyscraper","fireplace","refrigerator","grandstand","path","stairs","runway","case","pool","pillow","screen","stairway","river","bridge","bookcase","blind","coffee","toilet","flower","book","hill","bench","countertop","stove","palm","kitchen","computer","swivel","boat","bar","arcade","hovel","bus","towel","light","truck","tower","chandelier","awning","streetlight","booth","television","airplane","dirt","apparel","pole","land","bannister","escalator","ottoman","bottle","buffet","poster","stage","van","ship","fountain","conveyer","canopy","washer","plaything","swimming","stool","barrel","basket","waterfall","tent","bag","minibike","cradle","oven","ball","food","step","tank","trade","microwave","pot","animal","bicycle","lake","dishwasher","screen","blanket","sculpture","hood","sconce","vase","traffic","tray","ashcan","fan","pier","screen","plate","monitor","bulletin","shower","radiator","glass","clock","flag"]};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hve(n,e){return""+cve+"/"+(e===4?n+"/1/default/1/model.json":n+"/1/quantized/"+e+"/1/model.json")+"?tfjs-format=file"}function dve(n){if(n==="pascal")return rN.PASCAL;if(n==="ade20k")return rN.ADE20K;if(n==="cityscapes")return rN.CITYSCAPES;throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+n+". Try one of 'pascal', 'cityscapes' and 'ade20k'.")}function fve(n){if(n==="pascal")return iN.PASCAL;if(n==="ade20k")return iN.ADE20K;if(n==="cityscapes")return iN.CITYSCAPES;throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+n+". Try one of 'pascal', 'cityscapes' and 'ade20k'.")}function pve(n,e,t,s){return K0(this,void 0,void 0,(function(){var r,i,a,o,l,c,h,p,m,v,x,w,T,E;return X0(this,(function(C){switch(C.label){case 0:if(n.length<e.length)throw new Error("The colormap must be expansive enough to encode each label. Aborting, since the given colormap has length "+n.length+", but there are "+e.length+" labels.");return r=t.shape,i=r[0],a=r[1],o=Ko([i,a,3],"int32"),[4,t.array()];case 1:for(l=C.sent(),c=new Set,h=0;h<i;++h)for(p=0;p<a;++p)E=l[h][p],c.add(E),o.set(n[E][0],h,p,0),o.set(n[E][1],h,p,1),o.set(n[E][2],h,p,2);return m=o.toTensor(),[4,s6(m,s)];case 2:for(v=C.sent(),Mr(m),x={},w=0,T=Array.from(c);w<T.length;w++)E=T[w],x[e[E]]=n[E];return[2,{legend:x,segmentationMap:v}]}}))}))}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mve(n){return n===void 0&&(n={base:"pascal",quantizationBytes:2}),K0(this,void 0,void 0,(function(){var e;return X0(this,(function(t){switch(t.label){case 0:if(Pge==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(n.base){if(["pascal","cityscapes","ade20k"].indexOf(n.base)===-1)throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+n.base+". Try one of 'pascal', 'cityscapes' and 'ade20k'.");if([1,2,4].indexOf(n.quantizationBytes)===-1)throw new Error("Only quantization to 1, 2 or 4 bytes is supported.")}else if(!n.modelUrl)throw new Error("SemanticSegmentation can be constructed either by passing the weights URL or one of the supported base model names from 'pascal', 'cityscapes' and 'ade20k',together with the degree of quantization (either 1, 2 or 4).Aborting, since neither has been provided.");return[4,ove(n.modelUrl||hve(n.base,n.quantizationBytes))];case 1:return e=t.sent(),[2,new gve(e,n.base)]}}))}))}var gve=(function(){function n(e,t){this.model=e,this.base=t}return n.prototype.predict=function(e){var t=this;return pn((function(){var s=es((function(r){return pn((function(){var i=r instanceof os?r:r6(r),a=i.shape,o=a[0],l=a[1],c=uve/Math.max(l,o),h=Math.round(o*c),p=Math.round(l*c);return Lc(D2.resizeBilinear(i,[h,p]))}))})(e),"int32");return Hv(t.model.execute(s))}))},n.prototype.segment=function(e,t){return t===void 0&&(t={}),K0(this,void 0,void 0,(function(){var s,r,i,a,o,l,c,h,p,m,v=this;return X0(this,(function(x){switch(x.label){case 0:if(!(t.colormap&&t.labels||this.base))throw new Error("Calling the 'segment' method requires either the 'base' attribute to be defined (e.g. 'pascal', 'cityscapes' or'ade20k'), or 'colormap' and 'labels' options to be set. Aborting, since neither has been provided.");return t.colormap&&t.labels||(t.colormap=dve(this.base),t.labels=fve(this.base)),s=t.colormap,r=t.labels,i=t.canvas,a=pn((function(){return v.predict(e)})),o=a.shape,l=o[0],c=o[1],[4,pve(s,r,a,i)];case 1:return h=x.sent(),p=h.legend,m=h.segmentationMap,Mr(a),[2,{legend:p,height:l,width:c,segmentationMap:m}]}}))}))},n.prototype.dispose=function(){return K0(this,void 0,void 0,(function(){return X0(this,(function(e){return this.model&&this.model.dispose(),[2]}))}))},n})();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yve=1e-7,vve=1e-4;class GW{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class P2{refCount(e){return Xi("refCount")}incRef(e){return Xi("incRef")}timerAvailable(){return!0}time(e){return Xi("time")}read(e){return Xi("read")}readSync(e){return Xi("readSync")}readToGPU(e,t){return Xi("readToGPU")}numDataIds(){return Xi("numDataIds")}disposeData(e,t){return Xi("disposeData")}write(e,t,s){return Xi("write")}move(e,t,s,r,i){return Xi("move")}createTensorFromGPUData(e,t,s){return Xi("createTensorFromGPUData")}memory(){return Xi("memory")}floatPrecision(){return Xi("floatPrecision")}epsilon(){return this.floatPrecision()===32?yve:vve}dispose(){return Xi("dispose")}}function Xi(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bve(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,qp(n,e,t)}function Sf(n,e,t){return Math.max(n,Math.min(e,t))}function M2(n){return n%2===0?n:n+1}function qp(n,e,t){const s=n[e];n[e]=n[t],n[t]=s}function _ve(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function J(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function F2(n,e,t=""){J(xn(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function WW(n){J(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Me(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function xn(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Nm(n){return n%1===0}function LI(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function lm(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function jM(n,e=r=>0,t,s){return new Promise((r,i)=>{let a=0;const o=()=>{if(n()){r();return}a++;const l=e(a);if(t!=null&&a>=t){i();return}s!=null?s(o,l):setTimeout(o,l)};o()})}function HW(n,e){let t=1,s=-1;for(let i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(n[i]<0)throw Error(`Shapes can not be < 0. Found ${n[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const r=n.slice();return r[s]=e/t,r}function Vt(n,e){const t=e.length;return n=n==null?e.map((s,r)=>r):[].concat(n),J(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),J(n.every(s=>Nm(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function ed(n,e){const t=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:Vt(e,n).sort();let a=0;for(let o=0;o<n.length;++o){if(i!=null){if(i[a]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(i[a]==null||i[a]>o)&&n[o]===1&&(t.push(n[o]),s.push(o)),i[a]<=o&&a++}n[o]!==1&&(t.push(n[o]),s.push(o))}return{newShape:t,keptDims:s}}function Br(n,e){return ws(n,e)}function ws(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function xve(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function wve(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function qW(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function Z0(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function Tve(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function Kv(n){return typeof n=="string"||n instanceof String}function Sve(n){return typeof n=="boolean"}function OI(n){return typeof n=="number"}function Ym(n){return Array.isArray(n)?Ym(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":OI(n)?"float32":Kv(n)?"string":Sve(n)?"bool":"float32"}function PI(n){return!!(n&&n.constructor&&n.call&&n.apply)}function MI(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function ht(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function KW(n,e,t,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let a=0;a<i;a++)r[a]=t[n+a]}else{const i=e[0],a=e.slice(1),o=a.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=KW(n+l*o,a,t,s)}return r}function Uo(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((r,i)=>r*i)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return KW(0,n,e,t)}function Eve(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function j2(n,e){const t=zr(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function zr(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function XW(n,e){const t=n.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return Uo(n,new Float32Array(t));if(e==="int32")return Uo(n,new Int32Array(t));if(e==="bool")return Uo(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function ou(n){n.forEach(e=>{J(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function Fl(n,e,t){if(e===0)return 0;if(e===1)return n[0];let s=n[n.length-1];for(let r=0;r<n.length-1;++r)s+=t[r]*n[r];return s}function Qm(n,e,t){if(e===0)return[];if(e===1)return[n];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(n/t[r]),n-=s[r]*t[r];return s[s.length-1]=n,s}function B2(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BM="tfjsflags";class Nve{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Ive,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(De().getBool("IS_TEST")||De().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];De().getBool("IS_TEST")||De().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(B2(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);BM in e&&e[BM].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=kve(r,i)})}}function Ive(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(Cve(e,s[0],s[1]),s.join("="))),e}function Cve(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function kve(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function De(){return ZW}let ZW=null;function $ve(n){ZW=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let aN;function YW(){if(aN==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");aN=n}return aN}function Ave(){const n=YW();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function z2(n,e){const t=Ave();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const yw="Abs",Xv="Acos",Zv="Acosh",Jm="Add",V2="AddN",U2="All",G2="Any",vw="ArgMax",bw="ArgMin",Yv="Asin",Qv="Asinh",Jv="Atan",eb="Atanh",tb="Atan2",_w="AvgPool",W2="AvgPoolGrad",xw="AvgPool3D",H2="AvgPool3DGrad",ww="BatchMatMul",Tw="BatchToSpaceND",q2="Bincount",K2="BitwiseAnd",Rve="BroadcastTo",QW="BroadcastArgs",nb="Cast",sb="Ceil",rb="ClipByValue",X2="Complex",Sw="ComplexAbs",Ew="Concat",Nw="Conv2D",Z2="Conv2DBackpropFilter",Iw="Conv2DBackpropInput",Cw="Conv3D",Y2="Conv3DBackpropFilterV2",Q2="Conv3DBackpropInputV2",ib="Cos",ab="Cosh",J2="Cumprod",kw="Cumsum",e$="CropAndResize",t$="DenseBincount",n$="DepthToSpace",$w="DepthwiseConv2dNative",s$="DepthwiseConv2dNativeBackpropFilter",r$="DepthwiseConv2dNativeBackpropInput",JW="Diag",Aw="Dilation2D",FI="Dilation2DBackpropInput",jI="Dilation2DBackpropFilter",Dve="Draw",ob="RealDiv",i$="Einsum",lb="Elu",a$="EluGrad",cb="Erf",Rw="Equal",ub="Exp",Dw="ExpandDims",hb="Expm1",o$="FFT",l$="Fill",c$="FlipLeftRight",db="Floor",fb="FloorDiv",Lw="FusedBatchNorm",Ow="GatherV2",eH="GatherNd",Pw="Greater",pb="GreaterEqual",mb="Identity",u$="IFFT",h$="Imag",gb="IsFinite",yb="IsInf",vb="IsNan",Mw="LeakyRelu",Fw="Less",jw="LessEqual",tH="LinSpace",bb="Log",_b="Log1p",Bw="LogicalAnd",zw="LogicalNot",Vw="LogicalOr",Lve="LogSoftmax",Uw="LRN",d$="LRNGrad",Gw="Max",xb="Maximum",Ww="MaxPool",f$="MaxPoolGrad",Hw="MaxPool3D",p$="MaxPool3DGrad",nH="MaxPoolWithArgmax",qw="Mean",Kw="Min",wb="Minimum",Xw="MirrorPad",Tb="Mod",sH="Multinomial",Sb="Multiply",Zw="Neg",Yw="NotEqual",m$="NonMaxSuppressionV3",g$="NonMaxSuppressionV4",y$="NonMaxSuppressionV5",Qw="OnesLike",Jw="OneHot",eT="Pack",tT="PadV2",Eb="Pow",nT="Prelu",sT="Prod",rH="RaggedGather",iH="RaggedRange",aH="RaggedTensorToTensor",v$="Range",b$="Real",Nb="Reciprocal",Ib="Relu",rT="Reshape",iT="ResizeNearestNeighbor",_$="ResizeNearestNeighborGrad",aT="ResizeBilinear",x$="ResizeBilinearGrad",Cb="Relu6",oT="Reverse",kb="Round",$b="Rsqrt",oH="ScatterNd",lH="TensorScatterUpdate",cH="SearchSorted",lT="Select",Ab="Selu",cT="Slice",Rb="Sin",Db="Sinh",Lb="Sign",Ob="Sigmoid",Pb="Softplus",Mb="Sqrt",uT="Sum",hT="SpaceToBatchND",dT="SplitV",fT="Softmax",uH="SparseFillEmptyRows",hH="SparseReshape",dH="SparseSegmentMean",fH="SparseSegmentSum",pH="SparseToDense",Fb="SquaredDifference",w$="Square",T$="StaticRegexReplace",S$="StridedSlice",mH="StringNGrams",gH="StringSplit",yH="StringToHashBucketFast",jb="Sub",Bb="Tan",zb="Tanh",Vb="Tile",E$="TopK",N$="Transform",cm="Transpose",I$="Unique",pT="Unpack",mT="UnsortedSegmentSum",gT="ZerosLike",Ub="Step",Ove="FromPixels",C$="RotateWithOffset",Y0="_FusedMatMul",Q0="FusedConv2D",vH="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Na(...n){De().getBool("IS_TEST")||De().getBool("PROD")||console.warn(...n)}function Pve(...n){De().getBool("IS_TEST")||De().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J0=z2("kernelRegistry",()=>new Map),BI=z2("gradRegistry",()=>new Map);function zM(n,e){const t=_H(n,e);return J0.get(t)}function VM(n){return BI.get(n)}function UM(n){const e=J0.entries(),t=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,a]=r,[o]=i.split("_");o===n&&t.push(a)}return t}function bH(n){const{kernelName:e,backendName:t}=n,s=_H(e,t);J0.has(s)&&Na(`The kernel '${e}' for backend '${t}' is already registered`),J0.set(s,n)}function Mve(n){const{kernelName:e}=n;BI.has(e)&&De().getBool("DEBUG")&&Na(`Overriding the gradient for '${e}'`),BI.set(e,n)}function _H(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xH(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hd=Ok||$U;function yT(n){return Hd.fromString(n,!0,16)}const wH=yT("c3a5c85c97cb3127"),Gd=yT("b492b66fbe98f273"),ai=yT("9ae16a3b2f90404f");function zI(n){return n.xor(n.shru(47))}function TH(n,e,t){const s=n.slice(e,e+t);return Hd.fromBytes(Array.from(s),!0,!0)}function Bn(n,e){return TH(n,e,8)}function GM(n,e){return TH(n,e,4)}function ar(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function wh(n,e,t=yT("9ddfea08eb382d69")){let s=n.xor(e).mul(t);s=s.xor(s.shru(47));let r=e.xor(s).mul(t);return r=r.xor(r.shru(47)),r=r.mul(t),r}function Fve(n,e,t,s,r,i){r=r.add(n),i=ar(i.add(r).add(s),21);const a=r;return r=r.add(e),r=r.add(t),i=i.add(ar(r,44)),[r.add(s),i.add(a)]}function Nx(n,e,t,s){return Fve(Bn(n,e),Bn(n,e+8),Bn(n,e+16),Bn(n,e+24),t,s)}function jve(n,e=n.length){if(e>=8){const t=ai.add(e*2),s=Bn(n,0).add(ai),r=Bn(n,e-8),i=ar(r,37).mul(t).add(s),a=ar(s,25).add(r).mul(t);return wh(i,a,t)}if(e>=4){const t=ai.add(e*2),s=GM(n,0);return wh(s.shl(3).add(e),GM(n,e-4),t)}if(e>0){const t=n[0],s=n[e>>1],r=n[e-1],i=t+(s<<8),a=e+(r<<2);return zI(ai.mul(i).xor(wH.mul(a))).mul(ai)}return ai}function Bve(n,e=n.length){const t=ai.add(e*2),s=Bn(n,0).mul(Gd),r=Bn(n,8),i=Bn(n,e-8).mul(t),a=Bn(n,e-16).mul(ai);return wh(ar(s.add(r),43).add(ar(i,30)).add(a),s.add(ar(r.add(ai),18)).add(i),t)}function zve(n,e=n.length){const t=ai.add(e*2),s=Bn(n,0).mul(ai),r=Bn(n,8),i=Bn(n,e-8).mul(t),a=Bn(n,e-16).mul(ai),o=ar(s.add(r),43).add(ar(i,30)).add(a),l=wh(o,s.add(ar(r.add(ai),18)).add(i),t),c=Bn(n,16).mul(t),h=Bn(n,24),p=o.add(Bn(n,e-32)).mul(t),m=l.add(Bn(n,e-24)).mul(t);return wh(ar(c.add(h),43).add(ar(p,30)).add(m),c.add(ar(h.add(s),18)).add(p),t)}function Vve(n,e=n.length){const t=Hd.fromNumber(81,!0);if(e<=32)return e<=16?jve(n,e):Bve(n,e);if(e<=64)return zve(n,e);let s=t,r=t.mul(Gd).add(113),i=zI(r.mul(ai).add(113)).mul(ai),a=[Hd.UZERO,Hd.UZERO],o=[Hd.UZERO,Hd.UZERO];s=s.mul(ai).add(Bn(n,0));let l=0;const c=(e-1>>6)*64,h=c+(e-1&63)-63;do s=ar(s.add(r).add(a[0]).add(Bn(n,l+8)),37).mul(Gd),r=ar(r.add(a[1]).add(Bn(n,l+48)),42).mul(Gd),s=s.xor(o[1]),r=r.add(a[0]).add(Bn(n,l+40)),i=ar(i.add(o[0]),33).mul(Gd),a=Nx(n,l,a[1].mul(Gd),s.add(o[0])),o=Nx(n,l+32,i.add(o[1]),r.add(Bn(n,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const p=Gd.add(i.and(255).shl(1));return l=h,o[0]=o[0].add(e-1&63),a[0]=a[0].add(o[0]),o[0]=o[0].add(a[0]),s=ar(s.add(r).add(a[0]).add(Bn(n,l+8)),37).mul(p),r=ar(r.add(a[1]).add(Bn(n,l+48)),42).mul(p),s=s.xor(o[1].mul(9)),r=r.add(a[0].mul(9).add(Bn(n,l+40))),i=ar(i.add(o[0]),33).mul(p),a=Nx(n,l,a[1].mul(p),s.add(o[0])),o=Nx(n,l+32,i.add(o[1]),r.add(Bn(n,l+16))),[i,s]=[s,i],wh(wh(a[0],o[0],p).add(zI(r).mul(wH)).add(i),wh(a[1],o[1],p).add(s),p)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function td(n,e){return e==="string"?Th(n):Uf([n],e)}function Uve(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function Uf(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Ef(n)),De().getBool("DEBUG")&&xve(n,e),Uve(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function $i(){return De().platform.now()}function Th(n,e="utf-8"){return e=e||"utf-8",De().platform.encode(n,e)}function jh(n,e="utf-8"){return e=e||"utf-8",De().platform.decode(n,e)}function lo(n){return De().platform.isTypedArray!=null?De().platform.isTypedArray(n):xH(n)}function Ef(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||B2(n)||n==null||lo(n)&&t)e.push(n);else if(Array.isArray(n)||lo(n))for(let s=0;s<n.length;++s)Ef(n[s],e,t);else{let s=-1;for(const r of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Ef(n[r],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gve{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new Hve)}profileKernel(e,t,s){let r;const i=()=>{r=s()};let a;const o=$i();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();a=Promise.resolve({kernelMs:$i()-o})}if(De().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const h=r[c];h.data().then(p=>{Wve(p,h.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then(c=>c.kernelMs),extraInfo:a.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:r,inputs:i,extraInfo:a}=e;s.forEach(o=>{Promise.all([o.data(),r,a]).then(l=>{this.logger.logKernelProfile(t,o,l[0],l[1],i,l[2])})})}}function Wve(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${t}'`),!0}return!1}class Hve{logKernelProfile(e,t,s,r,i,a){const o=typeof r=="number"?lm(`${r}ms`,9):r.error,l=lm(e,25),c=t.rank,h=t.size,p=lm(t.shape.toString(),14);let m="";for(const v in i){const x=i[v];if(x!=null){const w=x.shape||t.shape,T=w.length;m+=`${v}: ${T}D ${T>0?w:""} `}}console.log(`%c${l}	%c${o}	%c${c}D ${p}	%c${h}	%c${m}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qve(n,e,t){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<n.length;l++){const c=n[l],h=c.inputs;for(const p in h){const m=h[p];let v=!1;for(let x=0;x<e.length;x++)if(s[m.id]){c.outputs.forEach(w=>s[w.id]=!0),v=!0,r[c.id]=!0;break}if(v)break}}const i={};i[t.id]=!0;const a={};for(let l=n.length-1;l>=0;l--){const c=n[l],h=c.inputs;for(let p=0;p<c.outputs.length;p++)if(i[c.outputs[p].id]){for(const m in h)i[h[m].id]=!0,a[c.id]=!0;break}}const o=[];for(let l=0;l<n.length;l++){const c=n[l];if(r[c.id]&&a[c.id]){const h={};for(const m in c.inputs){const v=c.inputs[m];s[v.id]&&(h[m]=v)}const p=Object.assign({},c);p.inputs=h,p.outputs=c.outputs,o.push(p)}}return o}function Kve(n,e,t,s){for(let r=e.length-1;r>=0;r--){const i=e[r],a=[];if(i.outputs.forEach(l=>{const c=n[l.id];c!=null?a.push(c):a.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const o=i.gradient(a);for(const l in i.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const c=t(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const h=i.inputs[l];if(!xn(c.shape,h.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${h.shape}'`);if(n[h.id]==null)n[h.id]=c;else{const p=n[h.id];n[h.id]=s(p,c),p.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WM=20,oy=3,oN=7;function Xve(n,e,t,s){const r=ht(e),i=Zve(n,e,t,r),a=e.length,o=h0(n,e,t,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function Zve(n,e,t,s){const r=Me(e),i=s[s.length-1],a=new Array(i).fill(0),o=e.length,l=t==="complex64"?xy(n):n;if(o>1)for(let c=0;c<r/i;c++){const h=c*i;for(let p=0;p<i;p++)a[p]=Math.max(a[p],_y(l[h+p],0,t).length)}return a}function _y(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(oN))} + ${parseFloat(n[1].toFixed(oN))}j`:Kv(n)?s=`'${n}'`:t==="bool"?s=SH(n):s=parseFloat(n.toFixed(oN)).toString(),lm(s,e)}function SH(n){return n===0?"false":"true"}function h0(n,e,t,s,r,i=!0){const a=t==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(t==="complex64"){const w=xy(n);return[_y(w[0],0,t)]}return t==="bool"?[SH(n[0])]:[n[0].toString()]}if(l===1){if(o>WM){const T=oy*a;let E=Array.from(n.slice(0,T)),C=Array.from(n.slice((o-oy)*a,o*a));return t==="complex64"&&(E=xy(E),C=xy(C)),["["+E.map(($,R)=>_y($,r[R],t)).join(", ")+", ..., "+C.map(($,R)=>_y($,r[o-oy+R],t)).join(", ")+"]"]}return["["+(t==="complex64"?xy(n):Array.from(n)).map((T,E)=>_y(T,r[E],t)).join(", ")+"]"]}const c=e.slice(1),h=s.slice(1),p=s[0]*a,m=[];if(o>WM){for(let w=0;w<oy;w++){const T=w*p,E=T+p;m.push(...h0(n.slice(T,E),c,t,h,r,!1))}m.push("...");for(let w=o-oy;w<o;w++){const T=w*p,E=T+p;m.push(...h0(n.slice(T,E),c,t,h,r,w===o-1))}}else for(let w=0;w<o;w++){const T=w*p,E=T+p;m.push(...h0(n.slice(T,E),c,t,h,r,w===o-1))}const v=l===2?",":"";m[0]="["+(o>0?m[0]+v:"");for(let w=1;w<m.length-1;w++)m[w]=" "+m[w]+v;let x=`,
`;for(let w=2;w<l;w++)x+=`
`;return m[m.length-1]=" "+m[m.length-1]+"]"+(i?"":x),m}function xy(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Er{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=Me(e),s!=null){const r=s.length;J(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||ws(t,this.size),this.strides=ht(e)}set(e,...t){t.length===0&&(t=[0]),J(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const r of e){if(r<0||r>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Mo().makeTensor(this.values,this.shape,this.dtype)}}let Mo=null,Kp=null;function Yve(n){Mo=n}function Qve(n){Kp=n}class Gs{constructor(e,t,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Me(e),this.strides=ht(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Kp.buffer(this.shape,this.dtype,e)}bufferSync(){return Kp.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Uo(this.shape,e,this.dtype==="complex64")}arraySync(){return Uo(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Mo().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>jh(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Mo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Mo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>jh(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Mo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Mo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Kp.print(this,e)}clone(){return this.throwIfDisposed(),Kp.clone(this)}toString(e=!1){const t=this.dataSync();return Xve(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Kp.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),Mo().makeVariable(this,e,t,s)}}Object.defineProperty(Gs,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function Pe(){return z2("Tensor",()=>Gs)}Pe();class e1 extends Gs{constructor(e,t,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!xn(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Mo().disposeTensor(this),this.dataId=e.dataId,Mo().incRef(this,null)}dispose(){Mo().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(e1,Symbol.hasInstance,{value:n=>n instanceof Gs&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var HM;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(HM||(HM={}));var VI;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(VI||(VI={}));var UI;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(UI||(UI={}));var GI;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(GI||(GI={}));var WI;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(WI||(WI={}));const Jve={float32:GI,int32:VI,bool:UI,complex64:WI};function ra(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return Jve[n][e]}function k$(n){return ra(n,"int32")}function EH(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function NH(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Es(n,e){if(n.dtype===e.dtype)return[n,e];const t=ra(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function IH(n){const e=[];return CH(n,e,new Set),e}function CH(n,e,t){if(n==null)return;if(n instanceof Gs){e.push(n);return}if(!ebe(n))return;const s=n;for(const r in s){const i=s[r];t.has(i)||(t.add(i),CH(i,e,t))}}function ebe(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lN(n){return n.kernelName!=null}class qM{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Im{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new qM}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(Na(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Gve(this.backendInstance),!0}setupRegisteredKernels(){UM(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){UM(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof P2)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(a=>r<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Na(`Initialization of backend ${e} failed`),Na(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Na(`Initialization of backend ${e} failed`),Na(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),r=s.backend,i=this.readSync(t),a=r.refCount(t);r.disposeData(t,!0),s.backend=e,e.move(t,i,s.shape,s.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,s){e();try{const r=s();return t(),r}catch(r){throw t(),r}}nextTensorId(){return Im.nextTensorId++}nextVariableId(){return Im.nextVariableId++}clone(e){const t=be.runKernel(mb,{x:e}),s={x:e},r=a=>({x:()=>{const o="float32",l={x:a},c={dtype:o};return be.runKernel(nb,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[t],r,i,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(zM(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-i-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const r=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const c=lN(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(lN(e)){const{kernelName:x,inputs:w,attrs:T}=e;this.backendName==null&&this.backend;const E=zM(x,this.backendName);J(E!=null,()=>`Cannot find registered kernel '${x}' for backend '${this.backendName}'`),o=()=>{const C=this.backend.numDataIds();l=E.kernelFunc({inputs:w,attrs:T,backend:this.backend});const $=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(x,C,$);const R=$.map(P=>P.rank!=null?P:this.makeTensorFromTensorInfo(P));if(r){const P=this.getTensorsForGradient(x,w,R);s=this.saveTensorsForBackwardMode(P)}return R}}else{const{forwardFunc:x}=e,w=T=>{r&&(s=T.map(E=>this.keep(this.clone(E))))};o=()=>{const T=this.backend.numDataIds();l=this.tidy(()=>x(this.backend,w));const E=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,T,E),E}}const{inputs:h,attrs:p}=e,m=lN(e)?null:e.backwardsFunc;let v;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=o():(v=this.profiler.profileKernel(c,h,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(v),t=v.outputs)}),r&&this.addTapeNode(c,h,t,m,s,p),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(x=>h[x]!=null?h[x].shape:null),outputShapes:t.map(x=>x.shape),kernelTimeMs:v.timeMs,extraInfo:v.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const r=VM(e);if(r!=null){const i=r.inputsToSave||[],a=r.outputsToSave||[];let o;r.saveAllInputs?(J(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(c=>t[c])):o=i.map(c=>t[c]);const l=s.filter((c,h)=>a[h]);return o.concat(l)}return[]}makeTensor(e,t,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&Kv(e[0])&&(i=e.map(l=>Th(l)));const a=r.write(i,t,s),o=new Gs(t,s,a,this.nextTensorId());if(this.trackTensor(o,r),s==="string"){const l=this.state.tensorInfo.get(a),c=Tve(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(e,t,s,r){s=s||"float32";const i={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:r,dtype:i}=e,a=new Gs(r,i,s,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new e1(e,t,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*Z0(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof e1||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*Z0(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,r,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:i},l=VM(e);l!=null&&(r=l.gradFunc),r!=null&&(o.gradient=c=>(c=c.map((h,p)=>{if(h==null){const m=s[p],v=zr(m.size,m.dtype);return this.makeTensor(v,m.shape,m.dtype)}return h}),r(c.length>1?c:c[0],i,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=IH(e),s=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const a=this.state.activeScope.track[i];!a.kept&&!s.has(a.id)&&a.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,t,s,r=!1){if(J(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));J(i instanceof Gs,()=>"The result y returned by f() must be a tensor.");const a=qve(this.state.activeTape,t,i);if(!r&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[i.id]=s??tbe(i.shape),Kve(o,a,c=>this.tidy(c),nbe);const l=t.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const h of c.saved)h.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return J(PI(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{J(t.every(o=>o instanceof Gs),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};t.forEach((o,l)=>{r[l]=o});const i=(o,l)=>(s=e(...t,l),J(s.value instanceof Gs,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),J(PI(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),a=(o,l)=>{const c=s.gradFunc(o,l),h=Array.isArray(c)?c:[c];J(h.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),J(h.every(m=>m instanceof Gs),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const p={};return h.forEach((m,v)=>{p[v]=()=>m}),p};return this.runKernelFunc({forwardFunc:i,backwardsFunc:a,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=$i(),s=await this.backend.time(e);return s.wallMs=$i()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new qM;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Im.nextTensorId=0;Im.nextVariableId=0;function tbe(n){const e=j2(Me(n),"float32");return be.makeTensor(e,n,"float32")}function kH(){const n=YW();if(n._tfengine==null){const e=new Nve(n);n._tfengine=new Im(e)}return $ve(n._tfengine.ENV),Yve(()=>n._tfengine),n._tfengine}const be=kH();function nbe(n,e){const t={a:n,b:e};return be.runKernel(Jm,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sbe(){return typeof navigator<"u"&&navigator!=null}function $H(n){if(n||sbe()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function AH(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Li=De();Li.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Li.registerFlag("IS_BROWSER",()=>AH());Li.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Li.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Li.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Li.registerFlag("PROD",()=>!1);Li.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Li.getBool("DEBUG"));Li.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Li.registerFlag("IS_TEST",()=>!1);Li.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Li.getBool("DEBUG"));Li.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Li.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Li.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vT(n,e){let t=n;if(lo(n))return e==="string"?[]:[n.length];if(EH(n)){const r=n.channels||"RGBA";return[n.height,n.width*r.length]}else if(NH(n))return[n.buffer.size/(e==null?4:Z0(e))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||lo(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&De().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&RH(n,s,[]),s}function RH(n,e,t){if(t=t||[],!Array.isArray(n)&&!lo(n)){J(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}J(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),J(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let r=0;r<n.length;++r)RH(n[r],s,t.concat(r))}function KM(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function oe(n,e,t,s="numeric"){if(n instanceof Pe())return KM(s,n.dtype,e,t),n;let r=Ym(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),KM(s,r,e,t),n==null||!lo(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const i=vT(n,r);!lo(n)&&!Array.isArray(n)&&(n=[n]);const o=r!=="string"?Uf(n,r):Ef(n,[],!0);return be.makeTensor(o,i,r)}function DH(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,a)=>oe(i,`${e}[${a}]`,t,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rbe="__op";function xe(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+rbe;const r=(...i)=>{be.startScope(t);try{const a=s(...i);return B2(a)&&console.error("Cannot return a Promise inside of tidy."),be.endScope(a),a}catch(a){throw be.endScope(null),a}};return Object.defineProperty(r,"name",{value:t,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ibe(n,e){const t=oe(n,"real","complex"),s=oe(e,"imag","complex");F2(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:t,imag:s};return be.runKernel(X2,r)}const Cm=xe({complex_:ibe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bT(n,e,t,s){if(s==null)s=Ym(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(NH(n)||EH(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return be.backend.createTensorFromGPUData(n,e||t,s)}if(!lo(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ou(e);const r=Me(e),i=Me(t);J(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let a=0;a<t.length;++a){const o=t[a],l=a===t.length-1?o!==Me(e.slice(a)):!0;J(t[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!lo(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?Uf(n,s):Ef(n,[],!0),be.makeTensor(n,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LH(n,e,t){const s=vT(n,t);return bT(n,e,s,t)}class eg{static join(e){return new eg(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>lo(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=t+r.byteLength;this.shards.push({buffer:r,start:t,end:i}),t=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=t-e,i=new ArrayBuffer(r),a=new Uint8Array(i);let o=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],p=e+o-c.start,m=o,x=Math.min(t,c.end)-c.start,w=new Uint8Array(c.buffer,p,x-p);if(a.set(w,m),o+=w.length,t<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(r){return e<r.start?-1:e>=r.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=abe(this.shards,t);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function abe(n,e){let t=0,s=n.length;for(;t<=s;){const r=Math.floor((s-t)/2)+t,i=e(n[r]);if(i===0)return r;i<0?s=r:t=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bl(){return be}function XM(){return be.memory()}function ke(n,e){return be.tidy(n,e)}function Ht(n){IH(n).forEach(t=>t.dispose())}function jl(n){return be.keep(n)}function OH(n,e,t=1){return be.registerBackend(n,e,t)}function obe(){return be.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZM=4;async function YM(n,e){const t=[],s=[],r=Array.isArray(n)?n.map(a=>a.name):Object.keys(n);for(let a=0;a<r.length;++a){const o=r[a],l=Array.isArray(n)?n[a].tensor:n[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const h=new Promise(async p=>{const m=await l.bytes(),v=m.reduce((T,E)=>T+E.length,0)+ZM*m.length,x=new Uint8Array(v);let w=0;for(let T=0;T<m.length;T++){const E=m[T],C=new Uint8Array(new Uint32Array([E.length]).buffer);x.set(C,w),w+=ZM,x.set(E,w),w+=E.length}p(x)});s.push(h)}else s.push(l.data());e!=null&&(c.group=e),t.push(c)}const i=await Promise.all(s);return{data:lbe(i),specs:t}}function lbe(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return t.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const $$=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function QM(n){return $$?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function cbe(n){if($$)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,r=e.length;s<r;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function ube(n){if($$){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function hbe(n){return eg.join(n)}function PH(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:QM(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:QM(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new eg(n.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ti{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return ti.instance==null&&(ti.instance=new ti),ti.instance}static registerSaveRouter(e){ti.getInstance().saveRouters.push(e)}static registerLoadRouter(e){ti.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return ti.getHandlers(e,"save")}static getLoadHandlers(e,t){return ti.getHandlers(e,"load",t)}static getHandlers(e,t,s){const r=[];return(t==="load"?ti.getInstance().loadRouters:ti.getInstance().saveRouters).forEach(a=>{const o=a(e,s);o!==null&&r.push(o)}),r}}const dbe=n=>ti.getSaveHandlers(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HI="tensorflowjs",qI=1,Yd="models_store",ph="model_info_store";function MH(){if(!De().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function KI(n){const e=n.result;e.createObjectStore(Yd,{keyPath:"modelPath"}),e.createObjectStore(ph,{keyPath:"modelPath"})}class Nf{constructor(e){if(this.indexedDB=MH(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,r)=>{const i=this.indexedDB.open(HI,qI);i.onupgradeneeded=()=>KI(i),i.onsuccess=()=>{const a=i.result;if(t==null){const o=a.transaction(Yd,"readonly"),c=o.objectStore(Yd).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return a.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=h=>(a.close(),r(c.error)),o.oncomplete=()=>a.close()}else{t.weightData=eg.join(t.weightData);const o=PH(t),l=a.transaction(ph,"readwrite");let c=l.objectStore(ph),h;try{h=c.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(m){return r(m)}let p;h.onsuccess=()=>{p=a.transaction(Yd,"readwrite");const m=p.objectStore(Yd);let v;try{v=m.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o})}catch(x){return r(x)}v.onsuccess=()=>s({modelArtifactsInfo:o}),v.onerror=x=>{c=l.objectStore(ph);const w=c.delete(this.modelPath);w.onsuccess=()=>(a.close(),r(v.error)),w.onerror=T=>(a.close(),r(v.error))}},h.onerror=m=>(a.close(),r(h.error)),l.oncomplete=()=>{p==null?a.close():p.oncomplete=()=>a.close()}}},i.onerror=a=>r(i.error)})}}Nf.URL_SCHEME="indexeddb://";const FH=n=>De().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Nf.URL_SCHEME)?fbe(n.slice(Nf.URL_SCHEME.length)):null;ti.registerSaveRouter(FH);ti.registerLoadRouter(FH);function fbe(n){return new Nf(n)}function pbe(n){return n.startsWith(Nf.URL_SCHEME)?n.slice(Nf.URL_SCHEME.length):n}class mbe{constructor(){this.indexedDB=MH()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(HI,qI);s.onupgradeneeded=()=>KI(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(ph,"readonly"),o=i.objectStore(ph).getAll();o.onsuccess=()=>{const l={};for(const c of o.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},o.onerror=l=>(r.close(),t(o.error)),i.oncomplete=()=>r.close()},s.onerror=r=>t(s.error)})}async removeModel(e){return e=pbe(e),new Promise((t,s)=>{const r=this.indexedDB.open(HI,qI);r.onupgradeneeded=()=>KI(r),r.onsuccess=()=>{const i=r.result,a=i.transaction(ph,"readwrite"),o=a.objectStore(ph),l=o.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const h=o.delete(e),p=()=>{c=i.transaction(Yd,"readwrite");const v=c.objectStore(Yd).delete(e);v.onsuccess=()=>t(l.result.modelArtifactsInfo),v.onerror=x=>s(l.error)};h.onsuccess=p,h.onerror=m=>(p(),i.close(),s(l.error))}},l.onerror=h=>(i.close(),s(l.error)),a.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jc="/",Xp="tensorflowjs_models",jH="info",gbe="model_topology",ybe="weight_specs",vbe="weight_data",bbe="model_metadata";function BH(n){return{info:[Xp,n,jH].join(jc),topology:[Xp,n,gbe].join(jc),weightSpecs:[Xp,n,ybe].join(jc),weightData:[Xp,n,vbe].join(jc),modelMetadata:[Xp,n,bbe].join(jc)}}function zH(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function _be(n){const e=n.split(jc);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(jc)}function xbe(n){return n.startsWith(If.URL_SCHEME)?n.slice(If.URL_SCHEME.length):n}class If{constructor(e){if(!De().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=BH(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=PH(e),i=eg.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,cbe(i));const a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:r}}catch{throw zH(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const o=JSON.parse(i);t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,o.signature!=null&&(t.signature=o.signature),o.userDefinedMetadata!=null&&(t.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(t.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(t.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(t.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=ube(a),t}}If.URL_SCHEME="localstorage://";const VH=n=>De().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(If.URL_SCHEME)?wbe(n.slice(If.URL_SCHEME.length)):null;ti.registerSaveRouter(VH);ti.registerLoadRouter(VH);function wbe(n){return new If(n)}class Tbe{constructor(){J(De().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),J(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=Xp+jc,s=jc+jH;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(t)&&i.endsWith(s)){const a=_be(i);e[a]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=xbe(e);const t=BH(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return zH(t),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JM="://";class xl{constructor(){this.managers={}}static getInstance(){return xl.instance==null&&(xl.instance=new xl),xl.instance}static registerManager(e,t){J(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(JM)&&(e=e.slice(0,e.indexOf(JM))),J(e.length>0,()=>"scheme must not be an empty string.");const s=xl.getInstance();J(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=xl.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(xl.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sbe{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!De().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return xH(e)}}if(De().get("IS_BROWSER")){De().setPlatform("browser",new Sbe);try{xl.registerManager(If.URL_SCHEME,new Tbe)}catch{}try{xl.registerManager(Nf.URL_SCHEME,new mbe)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ebe={importFetch:()=>require("node-fetch")};let cN;class Nbe{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return De().global.fetch!=null?De().global.fetch(e,t):(cN==null&&(cN=Ebe.importFetch()),cN(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}De().get("IS_NODE")&&!De().get("IS_BROWSER")&&De().setPlatform("node",new Nbe);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zt(n,e="float32",t){return e=e||"float32",ou(n),new Er(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ibe(n,e){const t=oe(n,"x","cast");if(!wve(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},r={dtype:e};return be.runKernel(nb,s,r)}const tt=xe({cast_:Ibe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(n){const t={x:oe(n,"x","clone","string_or_numeric")};return be.runKernel(mb,t)}const af=xe({clone_:Cbe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */kH();const $be={buffer:zt,cast:tt,clone:af,print:kbe};Qve($be);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Abe(n,e){let t=oe(n,"a","add"),s=oe(e,"b","add");[t,s]=Es(t,s);const r={a:t,b:s};return be.runKernel(Jm,r)}const Ke=xe({add_:Abe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rbe(n,e){let t=oe(n,"a","floorDiv"),s=oe(e,"b","floorDiv");[t,s]=Es(t,s);const r={a:t,b:s};return be.runKernel(fb,r)}const UH=xe({floorDiv_:Rbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dbe(n,e){let t=oe(n,"a","div"),s=oe(e,"b","div");if([t,s]=Es(t,s),t.dtype==="int32"&&s.dtype==="int32")return UH(t,s);const r={a:t,b:s},i={};return be.runKernel(ob,r,i)}const yt=xe({div_:Dbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lbe(n,e){let t=oe(n,"a","mul"),s=oe(e,"b","mul");[t,s]=Es(t,s);const r={a:t,b:s};return be.runKernel(Sb,r)}const ye=xe({mul_:Lbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(n){const e=oe(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return be.runKernel(Sw,t)}else{const t={x:e};return be.runKernel(yw,t)}}const si=xe({abs_:Obe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pbe(n){const t={x:oe(n,"x","acos")};return be.runKernel(Xv,t)}const Mbe=xe({acos_:Pbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbe(n){const t={x:oe(n,"x","acosh")};return be.runKernel(Zv,t)}const jbe=xe({acosh_:Fbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bbe(n,e=null,t=!1){const r={x:oe(n,"x","all","bool")},i={axis:e,keepDims:t};return be.runKernel(U2,r,i)}const GH=xe({all_:Bbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zbe(n,e=null,t=!1){const r={x:oe(n,"x","any","bool")},i={axis:e,keepDims:t};return be.runKernel(G2,r,i)}const XI=xe({any_:zbe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(n,e=0){const s={x:oe(n,"x","argMax")},r={axis:e};return be.runKernel(vw,s,r)}const rv=xe({argMax_:Vbe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ube(n,e=0){const s={x:oe(n,"x","argMin")},r={axis:e};return be.runKernel(bw,s,r)}const Gbe=xe({argMin_:Ube});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(n){const t={x:oe(n,"x","asin")};return be.runKernel(Yv,t)}const Hbe=xe({asin_:Wbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qbe(n){const t={x:oe(n,"x","asinh")};return be.runKernel(Qv,t)}const Kbe=xe({asinh_:qbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xbe(n){const t={x:oe(n,"x","atan")};return be.runKernel(Jv,t)}const Zbe=xe({atan_:Xbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ybe(n,e){let t=oe(n,"a","atan2"),s=oe(e,"b","atan2");[t,s]=Es(t,s);const r={a:t,b:s};return be.runKernel(tb,r)}const Qbe=xe({atan2_:Ybe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(n){const t={x:oe(n,"x","atanh")};return be.runKernel(eb,t)}const e_e=xe({atanh_:Jbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gb(n,e,t,s,r="NHWC",i){const a=n[3],o=[...e,a],l=cu(r);return Nr(n,o,t,i,s,null,null,l)}function ho(n,e,t,s,r,i,a="channelsLast"){const[o,l]=iv(e);let c;if(a==="channelsLast")c=[o,l,n[3],n[3]];else if(a==="channelsFirst")c=[o,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return Nr(n,c,t,s,r,i,!1,a)}function lu(n,e,t,s,r,i,a="NDHWC"){const[o,l,c]=ZI(e);let h,p;if(a==="NDHWC")p="channelsLast",h=[o,l,c,n[4],n[4]];else if(a==="NCDHW")p="channelsFirst",h=[o,l,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return nd(n,h,t,s,r,!1,p,i)}function Nr(n,e,t,s,r,i,a=!1,o="channelsLast"){let[l,c,h,p]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,h,p]=n;else if(o==="channelsFirst")[l,p,c,h]=n;else throw new Error(`Unknown dataFormat ${o}`);const[m,v,,x]=e,[w,T]=iv(t),[E,C]=iv(s),$=um(m,E),R=um(v,C),{padInfo:P,outHeight:U,outWidth:j}=s_e(r,c,h,w,T,$,R,i,o),O=a?x*p:x;let M;return o==="channelsFirst"?M=[l,O,U,j]:o==="channelsLast"&&(M=[l,U,j,O]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:h,inChannels:p,outHeight:U,outWidth:j,outChannels:O,padInfo:P,strideHeight:w,strideWidth:T,filterHeight:m,filterWidth:v,effectiveFilterHeight:$,effectiveFilterWidth:R,dilationHeight:E,dilationWidth:C,inShape:n,outShape:M,filterShape:e}}function nd(n,e,t,s,r,i=!1,a="channelsLast",o){let[l,c,h,p,m]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,c,h,p,m]=n;else if(a==="channelsFirst")[l,m,c,h,p]=n;else throw new Error(`Unknown dataFormat ${a}`);const[v,x,w,,T]=e,[E,C,$]=ZI(t),[R,P,U]=ZI(s),j=um(v,R),O=um(x,P),M=um(w,U),{padInfo:B,outDepth:D,outHeight:W,outWidth:H}=r_e(r,c,h,p,E,C,$,j,O,M,o),ae=i?T*m:T;let te;return a==="channelsFirst"?te=[l,ae,D,W,H]:a==="channelsLast"&&(te=[l,D,W,H,ae]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:h,inWidth:p,inChannels:m,outDepth:D,outHeight:W,outWidth:H,outChannels:ae,padInfo:B,strideDepth:E,strideHeight:C,strideWidth:$,filterDepth:v,filterHeight:x,filterWidth:w,effectiveFilterDepth:j,effectiveFilterHeight:O,effectiveFilterWidth:M,dilationDepth:R,dilationHeight:P,dilationWidth:U,inShape:n,outShape:te,filterShape:e}}function t_e(n,e,t,s,r){s==null&&(s=A$(n,e,t));const i=n[0],a=n[1],o=av((i-e+2*s)/t+1,r),l=av((a-e+2*s)/t+1,r);return[o,l]}function n_e(n,e,t,s,r,i){r==null&&(r=A$(n,e[0],s[0]));const a=[0,0,0,t];for(let o=0;o<3;o++)n[o]+2*r>=e[o]&&(a[o]=av((n[o]-e[o]+2*r)/s[o]+1,i));return a}function A$(n,e,t,s=1){const r=um(e,s);return Math.floor((n[0]*(t-1)-t+r)/2)}function iv(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function ZI(n){return typeof n=="number"?[n,n,n]:n}function um(n,e){return e<=1?n:n+(n-1)*(e-1)}function s_e(n,e,t,s,r,i,a,o,l){let c,h,p;if(typeof n=="number"){c={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const v=t_e([e,t],i,s,n,o);h=v[0],p=v[1]}else if(n==="same"){h=Math.ceil(e/s),p=Math.ceil(t/r);const m=Math.max(0,(h-1)*s+i-e),v=Math.max(0,(p-1)*r+a-t),x=Math.floor(m/2),w=m-x,T=Math.floor(v/2),E=v-T;c={top:x,bottom:w,left:T,right:E,type:"SAME"}}else if(n==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-i+1)/s),p=Math.ceil((t-a+1)/r);else if(typeof n=="object"){const m=l==="channelsLast"?n[1][0]:n[2][0],v=l==="channelsLast"?n[1][1]:n[2][1],x=l==="channelsLast"?n[2][0]:n[3][0],w=l==="channelsLast"?n[2][1]:n[3][1];c={top:m,bottom:v,left:x,right:w,type:m===0&&v===0&&x===0&&w===0?"VALID":"EXPLICIT"},h=av((e-i+m+v)/s+1,o),p=av((t-a+x+w)/r+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:c,outHeight:h,outWidth:p}}function r_e(n,e,t,s,r,i,a,o,l,c,h){let p,m,v,x;if(n==="valid"&&(n=0),typeof n=="number"){p={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const T=n_e([e,t,s,1],[o,l,c],1,[r,i,a],n,h);m=T[0],v=T[1],x=T[2]}else if(n==="same"){m=Math.ceil(e/r),v=Math.ceil(t/i),x=Math.ceil(s/a);const w=(m-1)*r+o-e,T=(v-1)*i+l-t,E=(x-1)*a+c-s,C=Math.floor(w/2),$=w-C,R=Math.floor(T/2),P=T-R,U=Math.floor(E/2),j=E-U;p={top:R,bottom:P,left:U,right:j,front:C,back:$,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:p,outDepth:m,outHeight:v,outWidth:x}}function av(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function Cf(n){const[e,t,s]=iv(n);return e===1&&t===1&&s===1}function Gr(n,e){return Cf(n)||Cf(e)}function kf(n){return iv(n).every(e=>e>0)}function cu(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function Pi(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")J(Nm(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{J(Nm(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i_e(n,e){const s={x:oe(n,"x","reshape","string_or_numeric")},r={shape:e};return be.runKernel(rT,s,r)}const _e=xe({reshape_:i_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_e(n,e,t,s,r){const i=oe(n,"x","avgPool","float32"),a=1;J(Gr(t,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);let o=i,l=!1;i.rank===3&&(l=!0,o=_e(i,[1,i.shape[0],i.shape[1],i.shape[2]])),J(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),Pi("avgPool",s,r);const c={x:o},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r};let p=be.runKernel(_w,c,h);return p=tt(p,i.dtype),l?_e(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const R$=xe({avgPool_:a_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_e(n,e,t,s,r,i="NDHWC"){const a=oe(n,"x","avgPool3d","float32");let o=a,l=!1;a.rank===4&&(l=!0,o=_e(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),J(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),J(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),J(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),Pi("avgPool3d",s,r);const c={x:o},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:i};let p=be.runKernel(xw,c,h);return p=tt(p,o.dtype),l?_e(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const l_e=xe({avgPool3d_:o_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c_e(n,e=0){J(n.length>=1,()=>"Pass at least one tensor to concat");const t=DH(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return af(t[0]);const s=t,r={axis:e};return be.runKernel(Ew,s,r)}const Di=xe({concat_:c_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_e(n,e,t=!1,s=!1){let r=oe(n,"a","matMul"),i=oe(e,"b","matMul");[r,i]=Es(r,i);const a={a:r,b:i},o={transposeA:t,transposeB:s};return be.runKernel(ww,a,o)}const bn=xe({matMul_:u_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h_e(n){const t={x:oe(n,"x","sigmoid","float32")};return be.runKernel(Ob,t)}const tg=xe({sigmoid_:h_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_e(n,e,t){const s=oe(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:t};return be.runKernel(cT,r,i)}const zn=xe({slice_:d_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_e(n){const t={x:oe(n,"x","tanh","float32")};return be.runKernel(zb,t)}const _T=xe({tanh_:f_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p_e(n,e,t){const s=oe(n,"x","batchToSpaceND"),r=e.reduce((o,l)=>o*l);J(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),J(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),J(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},a={blockShape:e,crops:t};return be.runKernel(Tw,i,a)}const D$=xe({batchToSpaceND_:p_e});function m_e(n){let e;return n.rank===0||n.rank===1?e=_e(n,[1,1,1,n.size]):n.rank===2?e=_e(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=_e(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_e(n,e,t,s,r,i){i==null&&(i=.001);const a=oe(n,"x","batchNorm"),o=oe(e,"mean","batchNorm"),l=oe(t,"variance","batchNorm");let c;r!=null&&(c=oe(r,"scale","batchNorm"));let h;s!=null&&(h=oe(s,"offset","batchNorm")),J(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),J(h==null||o.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),J(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const m={x:m_e(a),scale:c,offset:h,mean:o,variance:l},v={varianceEpsilon:i},x=be.runKernel(Lw,m,v);return _e(x,a.shape)}const xT=xe({batchNorm_:g_e});function y_e(n,e,t,s,r,i){const a=oe(n,"x","batchNorm"),o=oe(e,"mean","batchNorm"),l=oe(t,"variance","batchNorm");let c;r!=null&&(c=oe(r,"scale","batchNorm"));let h;return s!=null&&(h=oe(s,"offset","batchNorm")),J(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),J(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),J(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&J(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),h!=null&&J(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),xT(a,o,l,h,c,i)}const v_e=xe({batchNorm2d_:y_e});function b_e(n,e,t,s,r,i){const a=oe(n,"x","batchNorm"),o=oe(e,"mean","batchNorm"),l=oe(t,"variance","batchNorm");let c;r!=null&&(c=oe(r,"scale","batchNorm"));let h;return s!=null&&(h=oe(s,"offset","batchNorm")),J(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),J(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),J(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&J(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),h!=null&&J(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),xT(a,o,l,h,c,i)}const __e=xe({batchNorm3d_:b_e});function x_e(n,e,t,s,r,i){const a=oe(n,"x","batchNorm"),o=oe(e,"mean","batchNorm"),l=oe(t,"variance","batchNorm");let c;r!=null&&(c=oe(r,"scale","batchNorm"));let h;return s!=null&&(h=oe(s,"offset","batchNorm")),J(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),J(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),J(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&J(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),h!=null&&J(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),xT(a,o,l,h,c,i)}const w_e=xe({batchNorm4d_:x_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T_e(n,e,t){const s=oe(n,"x","bincount"),r=oe(e,"weights","bincount");J(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),J(t>=0,()=>`size must be non-negative, but got ${t}.`),J(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},a={size:t};return be.runKernel(q2,i,a)}const S_e=xe({bincount_:T_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_e(n,e){let t=oe(n,"broadcastTo","x");const s=t.shape;if(ou(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const c=t.shape.slice();for(;c.length<e.length;)c.unshift(1);t=_e(t,c)}const r=t.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(t.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,h)=>c>1?h:-1).filter(c=>c>=0).length===0)return af(t);const o={x:t},l={reps:i};return be.runKernel(Vb,o,l)}const Oy=xe({broadcastTo_:E_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N_e(n){const t={x:oe(n,"x","ceil","float32")};return be.runKernel(sb,t)}const I_e=xe({ceil_:N_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wT(n,e,t){ou(n),t=t||Ym(e);const s={shape:n,value:e,dtype:t};return be.runKernel(l$,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_e(n,e,t){const s=oe(n,"x","clipByValue");if(J(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return wT(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:t};return be.runKernel(rb,r,i)}const Ra=xe({clipByValue_:C_e});function k_e(n){return Di(n,0)}const $_e=xe({concat1d_:k_e});function A_e(n,e){return Di(n,e)}const R_e=xe({concat2d_:A_e});function D_e(n,e){return Di(n,e)}const L_e=xe({concat3d_:D_e});function O_e(n,e){return Di(n,e)}const P_e=xe({concat4d_:O_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M_e(n,e,t,s,r="NHWC",i=[1,1],a){const o=oe(n,"x","conv2d","float32"),l=oe(e,"filter","conv2d","float32");let c=o,h=!1;o.rank===3&&(h=!0,c=_e(o,[1,o.shape[0],o.shape[1],o.shape[2]])),J(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),J(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Pi("conv2d",s,a);const p=r==="NHWC"?c.shape[3]:c.shape[1];J(p===l.shape[2],()=>`Error in conv2d: depth of input (${p}) must match input depth for filter ${l.shape[2]}.`),J(Gr(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),J(kf(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),J(kf(t),()=>"Error in conv2D: Strides should be larger than 0.");const m={x:c,filter:l},v={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a},x=be.runKernel(Nw,m,v);return h?_e(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const $f=xe({conv2d_:M_e});function F_e(n,e,t,s,r="NWC",i=1,a){const o=oe(n,"x","conv1d"),l=oe(e,"filter","conv1d");let c=o,h=!1;o.rank===2&&(h=!0,c=_e(o,[1,o.shape[0],o.shape[1]])),J(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),J(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Pi("conv1d",s,a),J(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),J(Gr(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),J(kf(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),J(kf(t),()=>"Error in conv1D: Stride should be larger than 0."),J(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const p=_e(l,[1,l.shape[0],l.shape[1],l.shape[2]]),m=_e(c,[c.shape[0],1,c.shape[1],c.shape[2]]),T=$f(m,p,[1,t],s,"NHWC",[1,i],a);return h?_e(T,[T.shape[2],T.shape[3]]):_e(T,[T.shape[0],T.shape[2],T.shape[3]])}const WH=xe({conv1d_:F_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j_e(n,e,t,s,r,i="NHWC",a){J(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,l=e,c=!1;e.rank===3&&(c=!0,l=_e(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,n[0],n[1],n[2]]),J(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),J(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),J(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const h=i==="NHWC"?o[3]:o[1],p=i==="NHWC"?l.shape[3]:l.shape[1];J(h===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${t.shape[2]}.`),J(p===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${p}) must match output depth for filter ${t.shape[3]}.`),Pi("conv2dDerInput",r,a);const m={dy:l,filter:t},v={strides:s,pad:r,dataFormat:i,dimRoundingMode:a,inputShape:o},x=be.runKernel(Iw,m,v);return c?_e(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const L$=xe({conv2DBackpropInput_:j_e});function B_e(n,e,t,s,r,i){const a=oe(n,"x","conv2dTranspose"),o=oe(e,"filter","conv2dTranspose");return L$(t,a,o,s,r,"NHWC",i)}const HH=xe({conv2dTranspose_:B_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z_e(n,e,t,s,r="NDHWC",i=[1,1,1]){const a=oe(n,"x","conv3d"),o=oe(e,"filter","conv3d");let l=a,c=!1;a.rank===4&&(c=!0,l=_e(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),J(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),J(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),J(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),J(Gr(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),J(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),J(kf(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),J(kf(t),()=>"Error in conv3D: Strides should be larger than 0.");const h={x:l,filter:o},p={strides:t,pad:s,dataFormat:r,dilations:i},m=be.runKernel(Cw,h,p);return c?_e(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const V_e=xe({conv3d_:z_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_e(n,e,t,s,r){J(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,a=e,o=!1;e.rank===4&&(o=!0,a=_e(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const l=i[4],c=a.shape[4];J(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),J(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),J(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),J(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),J(c===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${t.shape[4]}.`);const h={dy:a,filter:t},p={pad:r,strides:s,inputShape:i},m=be.runKernel(Q2,h,p);return o?_e(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const qH=xe({conv3DBackpropInput_:U_e});function G_e(n,e,t,s,r){const i=oe(n,"x","conv3dTranspose"),a=oe(e,"filter","conv3dTranspose");return qH(t,i,a,s,r)}const W_e=xe({conv3dTranspose_:G_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_e(n){const t={x:oe(n,"x","cos","float32")};return be.runKernel(ib,t)}const O$=xe({cos_:H_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q_e(n){const t={x:oe(n,"x","cosh","float32")};return be.runKernel(ab,t)}const KH=xe({cosh_:q_e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_e(n,e=0,t=!1,s=!1){const i={x:oe(n,"x","cumprod")},a={axis:e,exclusive:t,reverse:s};return be.runKernel(J2,i,a)}const YI=xe({cumprod_:K_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_e(n,e=0,t=!1,s=!1){const i={x:oe(n,"x","cumsum")},a={axis:e,exclusive:t,reverse:s};return be.runKernel(kw,i,a)}const XH=xe({cumsum_:X_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_e(n,e,t,s=!1){const r=oe(n,"x","denseBincount"),i=oe(e,"weights","denseBincount");J(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),J(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),J(t>=0,()=>`size must be non-negative, but got ${t}.`),J(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const a={x:r,weights:i},o={size:t,binaryOutput:s};return be.runKernel(t$,a,o)}const e3=xe({denseBincount_:Z_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y_e(n,e,t="NHWC"){const s=oe(n,"x","depthToSpace","float32"),r=t==="NHWC"?s.shape[1]:s.shape[2],i=t==="NHWC"?s.shape[2]:s.shape[3],a=t==="NHWC"?s.shape[3]:s.shape[1];J(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),J(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),J(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),J(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${s.shape}`);const o={x:s},l={blockSize:e,dataFormat:t};return be.runKernel(n$,o,l)}const Q_e=xe({depthToSpace_:Y_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_e(n,e,t,s,r="NHWC",i=[1,1],a){const o=oe(n,"x","depthwiseConv2d","float32"),l=oe(e,"filter","depthwiseConv2d","float32");let c=o,h=!1;o.rank===3&&(h=!0,c=_e(o,[1,o.shape[0],o.shape[1],o.shape[2]])),J(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),J(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const p=r==="NHWC"?c.shape[3]:c.shape[1];J(p===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${p}) must match the inChannels dimension in filter ${l.shape[2]}.`),Pi("depthwiseConv2d",s,a);const m={x:c,filter:l},v={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a},x=be.runKernel($w,m,v);return h?_e(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const P$=xe({depthwiseConv2d_:J_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function exe(n,e,t,s,r=[1,1],i="NHWC"){const a=oe(n,"x","dilation2d"),o=oe(e,"filter","dilation2d");J(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),J(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),J(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=a,c=!1;a.rank===3&&(l=_e(a,[1,a.shape[0],a.shape[1],a.shape[2]]),c=!0),J(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const h={x:l,filter:o},p={strides:t,pad:s,dilations:r},m=be.runKernel(Aw,h,p);return c?_e(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const txe=xe({dilation2d_:exe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function km(n,e){const t=n.length,s=[];for(let r=0;r<t;r++){const i=t-1-r,a=n[i]||1;(e[e.length-1-r]||1)>1&&a===1&&s.unshift(i)}return s}function Ys(n,e){const t=[];for(let s=0;s<e.length;s++){const r=n[n.length-s-1],i=e.length-s-1,a=e[i];(r==null||r===1&&a>1)&&t.unshift(i)}return t}function Rt(n,e){const t=Math.max(n.length,e.length),s=new Array(t);for(let r=0;r<t;r++){let i=n[n.length-r-1];i==null&&(i=1);let a=e[e.length-r-1];if(a==null&&(a=1),i===1)s[t-r-1]=a;else if(a===1)s[t-r-1]=i;else if(i!==a){const o=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(o)}else s[t-r-1]=i}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nxe(n,e){let t=oe(n,"a","equal","string_or_numeric"),s=oe(e,"b","equal","string_or_numeric");[t,s]=Es(t,s),Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(Rw,r)}const Ql=xe({equal_:nxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sxe(n,e,t){const s=oe(e,"a","where"),r=oe(t,"b","where"),i=oe(n,"condition","where","bool"),a=Rt(Rt(i.shape,s.shape),r.shape),o=Oy(i,a),l=Oy(s,a),c=Oy(r,a),h={condition:o,t:l,e:c};return be.runKernel(lT,h)}const ui=xe({where_:sxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rxe(n){const t={x:oe(n,"x","zerosLike")};return be.runKernel(gT,t)}const ln=xe({zerosLike_:rxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ixe(n,e){let t=oe(n,"a","div"),s=oe(e,"b","div");[t,s]=Es(t,s);const r=yt(t,s),i=ln(r),a=Ql(s,i);return ui(a,i,r)}const axe=xe({divNoNan_:ixe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oxe(n,e){const t=oe(n,"t1","dot"),s=oe(e,"t2","dot");J((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const r=t.rank===1?t.size:t.shape[1],i=s.rank===1?s.size:s.shape[0];if(J(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),t.rank===1&&s.rank===1){const a=_e(t,[1,-1]),o=_e(s,[-1,1]),l=bn(a,o);return _e(l,[])}else if(t.rank===1&&s.rank===2){const a=_e(t,[1,-1]),o=_e(s,[s.shape[0],s.shape[1]]),l=bn(a,o);return _e(l,[l.size])}else if(t.rank===2&&s.rank===1){const a=_e(s,[-1,1]),o=bn(t,a);return _e(o,[o.size])}else{const a=_e(s,[s.shape[0],s.shape[1]]);return bn(t,a)}}const lxe=xe({dot_:oxe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cxe(n,...e){const t=e.map((r,i)=>oe(r,`tensors${i}`,"einsum")),s={equation:n};return be.runKernel(i$,t,s)}const ly=xe({einsum_:cxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uxe(n){const t={x:oe(n,"x","elu","float32")};return be.runKernel(lb,t)}const TT=xe({elu_:uxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hxe(n){let e=oe(n,"x","erf");J(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=tt(e,"float32"));const t={x:e};return be.runKernel(cb,t)}const ZH=xe({erf_:hxe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M$(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function YH(n,e,t){const s=n.length+e.length,r=[];let i=0,a=0;for(let o=0;o<s;o++)t.indexOf(o)===-1?r.push(n[i++]):r.push(e[a++]);return r}function ur(n,e){const t=[],s=n.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&t.push(n[i]);const r=e.map(i=>n[i]);return[t,r]}function js(n,e){const t=e.map(s=>1);return YH(n,t,e)}function Ir(n,e,t){J(M$(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function us(n,e){if(M$(n,e))return null;const t=[];for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);return n.forEach(s=>t.push(s)),t}function sd(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Is(n,e){const t=[];for(let s=e-n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dxe(n,e=null,t=!1){const r={x:oe(n,"x","max")},i={reductionIndices:e,keepDims:t};return be.runKernel(Gw,r,i)}const Go=xe({max_:dxe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fxe(n,e=null,t=!1){const r={x:oe(n,"x","min")},i={axis:e,keepDims:t};return be.runKernel(Kw,r,i)}const t1=xe({min_:fxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pxe(n,e){let t=oe(n,"base","pow"),s=oe(e,"exp","pow");[t,s]=Es(t,s);const r={a:t,b:s};return be.runKernel(Eb,r)}const Af=xe({pow_:pxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _n(n,e){if((lo(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&lo(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return bT(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mxe(n){const t={x:oe(n,"x","sqrt","float32")};return be.runKernel(Mb,t)}const Vr=xe({sqrt_:mxe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gxe(n){const e=oe(n,"x","square"),t={};return be.runKernel("Square",{x:e},t)}const Kn=xe({square_:gxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yxe(n,e=null,t=!1){let s=oe(n,"x","sum");s.dtype==="bool"&&(s=tt(s,"int32"));const r={x:s},i={axis:e,keepDims:t};return be.runKernel(uT,r,i)}const mt=xe({sum_:yxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vxe(n,e="euclidean",t=null,s=!1){n=oe(n,"x","norm");const r=QH(n,e,t);let i=r.shape;if(s){const a=Vt(t,n.shape);i=js(r.shape,a)}return _e(r,i)}function QH(n,e,t=null){if(n.rank===0)return si(n);if(n.rank!==1&&t===null)return QH(_e(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return mt(si(n),t);if(e===1/0)return Go(si(n),t);if(e===-1/0)return t1(si(n),t);if(e==="euclidean"||e===2)return Vr(mt(Af(si(n),_n(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Go(mt(si(n),t[0]),t[1]-1);if(e===1/0)return Go(mt(si(n),t[1]),t[0]);if(e===-1/0)return t1(mt(si(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Vr(mt(Kn(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const ST=xe({norm_:vxe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bxe(n,e=null,t=!1){return ST(n,"euclidean",e,t)}const _xe=xe({euclideanNorm_:bxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xxe(n){const t={x:oe(n,"x","exp")};return be.runKernel(ub,t)}const Jl=xe({exp_:xxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wxe(n,e=0){const t=oe(n,"x","expandDims","string_or_numeric");J(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},r={dim:e};return be.runKernel(Dw,s,r)}const Ai=xe({expandDims_:wxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Txe(n){const t={x:oe(n,"x","expm1")};return be.runKernel(hb,t)}const Sxe=xe({expm1_:Txe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Exe(n,e){const t=oe(n,"x","tile","string_or_numeric");J(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},r={reps:e};return be.runKernel(Vb,s,r)}const Bo=xe({tile_:Exe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxe(n,e,t,s="float32"){e==null&&(e=n);const r=zt([n,e],s),i=n<=e?n:e;for(let o=0;o<i;++o)r.set(1,o,o);const a=_e(r.toTensor(),[n,e]);if(t==null)return a;if(t.length===1)return Bo(Ai(a,0),[t[0],1,1]);if(t.length===2)return Bo(Ai(Ai(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return Bo(Ai(Ai(Ai(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const JH=xe({eye_:Nxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ixe(n){const t={x:oe(n,"x","floor","float32")};return be.runKernel(db,t)}const ET=xe({floor_:Ixe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cxe(n,e,t=0,s=0){const r=oe(n,"x","gather"),i=oe(e,"indices","gather","int32"),a={x:r,indices:i},o={axis:t,batchDims:s};return be.runKernel(Ow,a,o)}const F$=xe({gather_:Cxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kxe(n,e){let t=oe(n,"a","greater","string_or_numeric"),s=oe(e,"b","greater","string_or_numeric");[t,s]=Es(t,s),Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(Pw,r)}const Da=xe({greater_:kxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $xe(n,e){let t=oe(n,"a","greaterEqual","string_or_numeric"),s=oe(e,"b","greaterEqual","string_or_numeric");[t,s]=Es(t,s),Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(pb,r)}const Gf=xe({greaterEqual_:$xe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Axe(n){const t={input:oe(n,"input","imag")};return be.runKernel(h$,t)}const j$=xe({imag_:Axe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rxe(n){const t={x:oe(n,"x","isFinite")};return be.runKernel(gb,t)}const Dxe=xe({isFinite_:Rxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lxe(n){const t={x:oe(n,"x","isInf")};return be.runKernel(yb,t)}const Oxe=xe({isInf_:Lxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxe(n){const t={x:oe(n,"x","isNaN")};return be.runKernel(vb,t)}const Mxe=xe({isNaN_:Pxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fxe(n,e=.2){const s={x:oe(n,"x","leakyRelu")},r={alpha:e};return be.runKernel(Mw,s,r)}const B$=xe({leakyRelu_:Fxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jxe(n,e){let t=oe(n,"a","less","string_or_numeric"),s=oe(e,"b","less","string_or_numeric");[t,s]=Es(t,s),Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(Fw,r)}const n1=xe({less_:jxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bxe(n,e){let t=oe(n,"a","lessEqual","string_or_numeric"),s=oe(e,"b","lessEqual","string_or_numeric");[t,s]=Es(t,s),Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(jw,r)}const ng=xe({lessEqual_:Bxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zxe(n,e=5,t=1,s=1,r=.5){const i=oe(n,"x","localResponseNormalization");J(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),J(Nm(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=i,o=!1;i.rank===3&&(o=!0,a=_e(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:a},c={depthRadius:e,bias:t,alpha:s,beta:r},h=be.runKernel(Uw,l,c);return o?_e(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Vxe=xe({localResponseNormalization_:zxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uxe(n){const t={x:oe(n,"x","log","float32")};return be.runKernel(bb,t)}const ec=xe({log_:Uxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gxe(n){const t={x:oe(n,"x","log1p")};return be.runKernel(_b,t)}const e5=xe({log1p_:Gxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wxe(n,e){J(PI(n),()=>"The f passed in variableGrads(f) must be a function"),J(e==null||Array.isArray(e)&&e.every(c=>c instanceof e1),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const c in be.registeredVariables)e.push(be.registeredVariables[c])}const s=t?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),J(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:a,grads:o}=be.gradients(n,e,null,i);J(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),J(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return e.forEach((c,h)=>{o[h]!=null&&(l[c.name]=o[h])}),s?.forEach(c=>l[c.name]=null),{value:a,grads:l}}function $m(n){return be.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hxe(n){const t={x:oe(n,"x","neg")};return be.runKernel(Zw,t)}const Ts=xe({neg_:Hxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qxe(n){const t={x:oe(n,"x","softplus")};return be.runKernel(Pb,t)}const Wb=xe({softplus_:qxe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kxe(n){const e=oe(n,"x","logSigmoid");return $m(s=>({value:Ts(Wb(Ts(s))),gradFunc:a=>ye(a,tg(Ts(s)))}))(e)}const Xxe=xe({logSigmoid_:Kxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zxe(n,e){let t=oe(n,"a","sub"),s=oe(e,"b","sub");[t,s]=Es(t,s);const r={a:t,b:s};return be.runKernel(jb,r)}const _t=xe({sub_:Zxe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yxe(n,e=-1){const t=oe(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return $m((r,i)=>{const o=Go(r,e,!0),l=_t(r,o),c=_t(tt(l,"float32"),ec(mt(Jl(l),e,!0)));return i([c]),{value:c,gradFunc:(p,m)=>{const[v]=m,x=!0,w=Jl(v);return _t(p,ye(mt(p,e,x),w))}}})(t)}const t5=xe({logSoftmax_:Yxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qxe(n,e=null,t=!1){const s=oe(n,"x","logSumExp"),r=Vt(e,s.shape),i=Go(s,r,!0),a=_t(s,i),o=Jl(a),l=mt(o,r),c=ec(l),h=Ke(_e(i,c.shape),c);if(t){const p=js(h.shape,r);return _e(h,p)}return h}const n5=xe({logSumExp_:Qxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jxe(n,e){const t=oe(n,"a","logicalAnd","bool"),s=oe(e,"b","logicalAnd","bool");Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(Bw,r)}const eu=xe({logicalAnd_:Jxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0e(n){const t={x:oe(n,"x","logicalNot","bool")};return be.runKernel(zw,t)}const z$=xe({logicalNot_:e0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t0e(n,e){const t=oe(n,"a","logicalOr","bool"),s=oe(e,"b","logicalOr","bool");Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(Vw,r)}const s5=xe({logicalOr_:t0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0e(n,e){const t=oe(n,"a","logicalXor","bool"),s=oe(e,"b","logicalXor","bool");return Rt(t.shape,s.shape),eu(s5(n,e),z$(eu(n,e)))}const s0e=xe({logicalXor_:n0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r0e(n,e,t,s,r){const i=oe(n,"x","maxPool"),a=1;let o=i,l=!1;i.rank===3&&(l=!0,o=_e(i,[1,i.shape[0],i.shape[1],i.shape[2]])),J(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),J(Gr(t,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),Pi("maxPool",s,r);const c={x:o},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r},p=be.runKernel(Ww,c,h);return l?_e(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const V$=xe({maxPool_:r0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0e(n,e=[1,1,1],t,s,r,i="NDHWC"){const a=oe(n,"x","maxPool3d");let o=a,l=!1;a.rank===4&&(l=!0,o=_e(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),J(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),J(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Pi("maxPool3d",s,r);const c={x:o},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:i},p=be.runKernel(Hw,c,h);return l?_e(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const a0e=xe({maxPool3d_:i0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0e(n,e){let t=oe(n,"a","maximum"),s=oe(e,"b","maximum");[t,s]=Es(t,s),t.dtype==="bool"&&(t=tt(t,"int32"),s=tt(s,"int32")),Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(xb,r)}const rd=xe({maximum_:o0e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0e(n,e=null,t=!1){const r={x:oe(n,"x","mean")},i={axis:e,keepDims:t};return be.runKernel(qw,r,i)}const Os=xe({mean_:l0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function or(n,e="float32"){if(ou(n),e==="complex64"){const s=or(n,"float32"),r=or(n,"float32");return Cm(s,r)}const t=zr(Me(n),e);return be.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function id(n,e="float32"){if(ou(n),e==="complex64"){const s=id(n,"float32"),r=or(n,"float32");return Cm(s,r)}const t=j2(Me(n),e);return be.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c0e(n,e){let t=oe(n,"a","minimum"),s=oe(e,"b","minimum");[t,s]=Es(t,s),t.dtype==="bool"&&(t=tt(t,"int32"),s=tt(s,"int32")),Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(wb,r)}const ov=xe({minimum_:c0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0e(n,e,t){J(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=oe(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");J(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=t==="reflect"?1:0;for(let o=0;o<s.rank;o++)J(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),J(e[o][0]>=0&&e[o][0]<=s.shape[o]-r&&e[o][1]>=0&&e[o][1]<=s.shape[o]-r,()=>`Padding in dimension ${o} cannot be greater than or equal to ${s.shape[o]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:t},a={x:s};return be.runKernel(Xw,a,i)}const h0e=xe({mirrorPad_:u0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0e(n,e){let t=oe(n,"a","mod"),s=oe(e,"b","mod");[t,s]=Es(t,s);const r={a:t,b:s};return be.runKernel(Tb,r)}const f0e=xe({mod_:d0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(n,e=null,t=!1){n=oe(n,"x","moments");const s=Vt(e,n.shape),r=Os(n,s,t);let i=r.shape;t||(i=js(r.shape,s));const a=Kn(_t(tt(n,"float32"),_e(r,i))),o=Os(a,s,t);return{mean:r,variance:o}}const U$=xe({moments_:p0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0e(n,e){let t=oe(n,"a","notEqual","string_or_numeric"),s=oe(e,"b","notEqual","string_or_numeric");[t,s]=Es(t,s),Rt(t.shape,s.shape);const r={a:t,b:s};return be.runKernel(Yw,r)}const s1=xe({notEqual_:m0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(n,e,t=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:oe(n,"indices","oneHot","int32")},o={dtype:r,depth:e,onValue:t,offValue:s};return be.runKernel(Jw,a,o)}const r5=xe({oneHot_:g0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y0e(n){const t={x:oe(n,"x","onesLike")};return be.runKernel(Qw,t)}const co=xe({onesLike_:y0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0e(n,e,t=0){const s=oe(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:t},i={x:s};return be.runKernel(tT,i,r)}const G$=xe({pad_:v0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b0e(n,e,t){const s=oe(n,"x","spaceToBatchND");J(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),J(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),J(s.shape.reduce((a,o,l)=>l>0&&l<=e.length?a&&(o+t[l-1][0]+t[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:t};return be.runKernel(hT,r,i)}const W$=xe({spaceToBatchND_:b0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _0e(n,e,t,s,r,i,a){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const o=oe(n,"x","maxPool");let l=o,c=!1;o.rank===3&&(c=!0,l=_e(o,[1,o.shape[0],o.shape[1],o.shape[2]])),J(Gr(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const h=ho(l.shape,e,i,r,s),p=[h.dilationHeight,h.dilationWidth];let m;s==="same"?m=w0e([h.filterHeight,h.filterWidth],p):m=[[0,0],[0,0]];const v=p[0]===1&&p[1]===1,[x,w]=x0e([h.inHeight,h.inWidth],p,m),T=v?s:"valid",E=v?l:W$(l,p,x),$=(t==="avg"?()=>R$(E,e,i,T,a):()=>V$(E,e,i,T,a))(),R=v?$:D$($,p,w);return c?_e(R,[R.shape[1],R.shape[2],R.shape[3]]):R}function x0e(n,e,t){const s=t.map(h=>h[0]),r=t.map(h=>h[1]),i=n.concat(s,r),a=e.map((h,p)=>(h-i[p]%h)%h),o=r.map((h,p)=>h+a[p]),l=e.map((h,p)=>[s[p],o[p]]),c=e.map((h,p)=>[0,a[p]]);return[l,c]}function w0e(n,e){const s=n.map((a,o)=>a+(a-1)*(e[o]-1)).map(a=>a-1),r=s.map(a=>Math.floor(a/2)),i=s.map((a,o)=>a-r[o]);return s.map((a,o)=>[r[o],i[o]])}const T0e=xe({pool_:_0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0e(n,e){const t=oe(n,"x","prelu"),s=oe(e,"alpha","prelu"),r={x:t,alpha:s};return be.runKernel(nT,r)}const H$=xe({prelu_:S0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E0e(n,e=null,t=!1){let s=oe(n,"x","prod");s.dtype==="bool"&&(s=tt(s,"int32"));const r={x:s},i={axis:e,keepDims:t};return be.runKernel(sT,r,i)}const N0e=xe({prod_:E0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i5{constructor(e,t,s,r,i){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=i||Math.random();this.random=Xm.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,t,s=!1;for(;!s;){let r,i,a;do r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class I0e{constructor(e=0,t=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=Xm.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C0e(n,e=0,t=1,s,r){if(ou(n),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new i5(e,t,s,!1,r),a=zt(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const k0e=xe({randomNormal_:C0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $0e(n,e=0,t=1,s="float32",r){ou(n);const i=zt(n,s),a=new I0e(e,t,null,r);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const Hb=xe({randomUniform_:$0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lv(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:e,step:t,dtype:s};return be.runKernel(v$,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A0e(n){const t={input:oe(n,"input","real")};return be.runKernel(b$,t)}const r1=xe({real_:A0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R0e(n){const t={x:oe(n,"x","reciprocal")};return be.runKernel(Nb,t)}const D0e=xe({reciprocal_:R0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L0e(n){const t={x:oe(n,"x","relu")};return be.runKernel(Ib,t)}const Wf=xe({relu_:L0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O0e(n){const t={x:oe(n,"x","relu6")};return be.runKernel(Cb,t)}const a5=xe({relu6_:O0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P0e(n,e){const s={x:oe(n,"x","reverse")},r={dims:e};return be.runKernel(oT,s,r)}const Rf=xe({reverse_:P0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M0e(n){const t={x:oe(n,"x","round")};return be.runKernel(kb,t)}const o5=xe({round_:M0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0e(n){const t={x:oe(n,"x","rsqrt","float32")};return be.runKernel($b,t)}const l5=xe({rsqrt_:F0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j0e(n){const t={x:oe(n,"x","selu")};return be.runKernel(Ab,t)}const c5=xe({selu_:j0e});function B0e(n,e,t,s,r,i=[1,1],a="NHWC"){const o=oe(n,"x","separableConv2d"),l=oe(e,"depthwiseFilter","separableConv2d"),c=oe(t,"pointwiseFilter","separableConv2d");let h=o,p=!1;if(o.rank===3&&(p=!0,h=_e(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");J(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),J(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),J(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),J(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),J(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const m=l.shape[2],v=l.shape[3];J(c.shape[2]===m*v,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${m*v}, but got ${c.shape[2]}.`);const x=P$(h,l,s,r,a,i),T=$f(x,c,1,"valid",a);return p?_e(T,[T.shape[1],T.shape[2],T.shape[3]]):T}const u5=xe({separableConv2d_:B0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0e(n){const t={x:oe(n,"x","sign")};return be.runKernel(Lb,t)}const V0e=xe({sign_:z0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U0e(n){const t={x:oe(n,"x","sin","float32")};return be.runKernel(Rb,t)}const h5=xe({sin_:U0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G0e(n){const t={x:oe(n,"x","sinh")};return be.runKernel(Db,t)}const d5=xe({sinh_:G0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0e(n,e,t){const s=oe(n,"x","slice1d");return J(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),zn(s,[e],[t])}const q$=xe({slice1d_:W0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0e(n,e,t){const s=oe(n,"x","slice2d");return J(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),zn(s,e,t)}const f5=xe({slice2d_:H0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q0e(n,e,t){const s=oe(n,"x","slice3d");return J(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),zn(s,e,t)}const K$=xe({slice3d_:q0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0e(n,e,t){const s=oe(n,"x","slice4d");return J(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),zn(s,e,t)}const i1=xe({slice4d_:K0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X0e(n,e=-1){const t=oe(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},r={dim:e};return be.runKernel(fT,s,r)}const X$=xe({softmax_:X0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z0e(n){J(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return be.runKernel(o$,e)}const p5=xe({fft_:Z0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y0e(n){J(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return be.runKernel(u$,e)}const QI=xe({ifft_:Y0e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0e(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const r=_e(n,[t,e]);s=QI(r)}else{const r=[t,2*(e-1)],i=_e(r1(n),[t,e]),a=_e(j$(n),[t,e]),o=Rf(zn(i,[0,1],[t,e-2]),1),l=ye(Rf(zn(a,[0,1],[t,e-2]),1),_n(-1)),c=Di([i,o],1),h=Di([a,l],1),p=_e(Cm(c,h),[r[0],r[1]]);s=QI(p)}if(s=r1(s),n.rank===3&&n.shape[0]!==0){const r=s,i=n.shape[0];s=_e(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const J0e=xe({irfft_:Q0e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e1e(n,e,t=0){const r={x:oe(n,"x","split")},i={numOrSizeSplits:e,axis:t};return be.runKernel(dT,r,i)}const $a=xe({split_:e1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t1e(n,e){J(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let r;if(e!=null&&e<t){const x=n.shape.map(T=>0),w=n.shape.map(T=>T);w[n.shape.length-1]=e,r=zn(n,x,w),t=e}else if(e!=null&&e>t){const x=n.shape.map(w=>w);x[n.shape.length-1]=e-t,r=Di([n,or(x)],n.shape.length-1),t=e}else r=n;const i=ln(r),a=_e(Cm(r,i),[s,t]),o=p5(a),l=Math.floor(t/2)+1,c=r1(o),h=j$(o),p=$a(c,[l,t-l],c.shape.length-1),m=$a(h,[l,t-l],h.shape.length-1),v=r.shape.slice();return v[r.shape.length-1]=l,_e(Cm(p[0],m[0]),v)}const n1e=xe({rfft_:t1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s1e(n,e){let t=oe(n,"a","squaredDifference"),s=oe(e,"b","squaredDifference");[t,s]=Es(t,s),Rt(t.shape,s.shape);const r={a:t,b:s},i={};return be.runKernel(Fb,r,i)}const r1e=xe({squaredDifference_:s1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i1e(n,e){const t=oe(n,"x","squeeze","string_or_numeric");return _e(t,ed(t.shape,e).newShape)}const qb=xe({squeeze_:i1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a1e(n,e=0){const t=DH(n,"tensors","stack","string_or_numeric");J(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&J(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,r={axis:e};return be.runKernel(eT,s,r)}const tu=xe({stack_:a1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1e(n,e=0){const s={x:oe(n,"x","step")},r={alpha:e};return be.runKernel(Ub,s,r)}const Kb=xe({step_:o1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l1e(n,e,t,s,r=0,i=0,a=0,o=0,l=0){const h={x:oe(n,"x","stridedSlice","string_or_numeric")},p={begin:e,end:t,strides:s,beginMask:r,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};return be.runKernel(S$,h,p)}const c1e=xe({stridedSlice_:l1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1e(n){const t={x:oe(n,"x","tan","float32")};return be.runKernel(Bb,t)}const h1e=xe({tan_:u1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ta(n,e){WW(n);const t=vT(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return bT(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uN(n,e,t){if(WW(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=vT(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return bT(n,e,s,t)}function m5(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(t.rank<r)throw new Error(i+` update.rank < ${r}. `);if(n.length<s+(t.rank-r))throw new Error(i+` Output shape length < ${s+(t.rank-r)}`);if(t.rank!==r+n.length-s)throw new Error(i+` update.rank != ${r+n.length-s}`);for(let a=0;a<r;++a)if(t.shape[a]!==e.shape[a])throw new Error(i+` updates.shape[${a}] (${t.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<t.rank-r;++a)if(t.shape[a+r]!==n[a+s])throw new Error(i+` updates.shape[${a+r}] (${t.shape[a+r]}) != shape[${a+r}] (${n[a+r]})`)}function d1e(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}m5(t,e,n)}function Hf(n,e,t){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=t.length;let a=1;for(let p=r;p<i;++p)a*=t[p];const o=r<1?1:r,l=Me(e.shape)/o,c=[...ht(t.slice(0,r)),1],h=Me(t);return{sliceRank:r,numUpdates:l,sliceSize:a,strides:c,outputSize:h}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f1e(n,e=1,t=!0){const s=oe(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},a={k:e,sorted:t},[o,l]=be.runKernel(E$,i,a);return{values:o,indices:l}}const p1e=xe({topk_:f1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1e(n,e=0,t=1,s,r){if(ou(n),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new i5(e,t,s,!0,r),a=zt(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const g5=xe({truncatedNormal_:m1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1e(n,e=0){const t=oe(n,"x","unique","string_or_numeric");J(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},r={axis:e},[i,a]=be.runKernel(I$,s,r);return{values:i,indices:a}}const y1e=xe({unique_:g1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1e(n,e,t){const s=oe(n,"x","unsortedSegmentSum"),r=oe(e,"segmentIds","unsortedSegmentSum","int32");J(Nm(t),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},a={numSegments:t};return be.runKernel(mT,i,a)}const y5=xe({unsortedSegmentSum_:v1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1e(n,e=0){const t=oe(n,"x","unstack","string_or_numeric");J(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},r={axis:e};return be.runKernel(pT,s,r)}const Df=xe({unstack_:b1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1e(n,e=!0,t,s){return be.makeVariable(n,e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v5(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const s=zt(n,"int32"),r=zt([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const a=s.indexToLoc(t[i]),o=i*n.length;r.values.set(a,o)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1e(n,e,t){const s=oe(n,"x","transpose");if(e==null&&(e=s.shape.map((a,o)=>o).reverse()),J(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(a=>{J(a>=0&&a<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?ke(()=>{let a=r1(s),o=j$(s);return a=be.runKernel(cm,{x:a},i),o=be.runKernel(cm,{x:o},i),t&&(o=Ts(o)),Cm(a,o)}):be.runKernel(cm,r,i)}const on=xe({transpose_:x1e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1e(n,e){if(e==null)return n.shape.slice();if(xn(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1e(n,e,t,s){const r=oe(n,"x","dropout");if(J(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),J(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Gs?r.clone():r;const i=w1e(r,t),a=1-e,o=yt(ET(Ke(Hb(i,0,1,"float32",s),a)),a);return ye(r,o)}const S1e=xe({dropout_:T1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E1e(n,e,t,s,r,i="NHWC",a){let o=n;n.rank===3&&(o=_e(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=_e(e,[1,e.shape[0],e.shape[1],e.shape[2]])),J(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),J(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),J(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const c=i==="NHWC"?o.shape[3]:o.shape[1],h=i==="NHWC"?l.shape[3]:l.shape[1];J(c===t[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${t[2]}.`),J(h===t[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${t[3]}).`),Pi("conv2dDerFilter",r,a);const p={x:o,dy:l},m={strides:s,pad:r,dataFormat:i,dimRoundingMode:a,filterShape:t};return be.runKernel(Z2,p,m)}const Z$=xe({conv2DBackpropFilter_:E1e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return ye(n,Kb(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function Q$(n,e){let t=e;const s=Ys(n.shape,e.shape);return s.length>0&&(t=mt(t,s)),_e(t,n.shape)}function J$(n,e,t,s){if(e==="linear")return n;if(e==="relu")return Wf(n);if(e==="elu")return TT(n);if(e==="relu6")return a5(n);if(e==="prelu")return H$(n,t);if(e==="leakyrelu")return B$(n,s);if(e==="sigmoid")return tg(n);throw new Error(`Unknown fused activation ${e}.`)}const eA=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1e({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:h}){if(l=l||"linear",eA(be.state.gradientDepth,l)===!1){J(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let U=$f(n,e,t,s,r,i,a);return o!=null&&(U=Ke(U,o)),J$(U,l,c,h)}const p=oe(n,"x","conv2d","float32"),m=oe(e,"filter","conv2d","float32");let v=p,x=!1;p.rank===3&&(x=!0,v=_e(p,[1,p.shape[0],p.shape[1],p.shape[2]])),J(v.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${v.rank}.`),J(m.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${m.rank}.`),Pi("fused conv2d",s,a);const w=r==="NHWC"?v.shape[3]:v.shape[1];J(m.shape[2]===w,()=>`Error in conv2d: depth of input (${w}) must match input depth for filter ${m.shape[2]}.`),J(Gr(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const T=Nr(v.shape,m.shape,t,i,s,a);let E;o!=null&&(E=oe(o,"bias","fused conv2d"),[E]=Es(E,p),r==="NHWC"?Rt(T.outShape,E.shape):(J(E.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${E.shape.length}.`),J(E.shape.length===0||E.shape[0]===T.outChannels||E.shape[0]===1,()=>`Error in fused conv2d: bias shape (${E.shape}) is not compatible with the number of output channels (${T.outChannels})`)));let C;if(c!=null){const U=c.shape;if(J(U.length<=1||U.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${U.length}.`),U.length===1)J(U[0]===1||U[0]===T.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${U}) is not compatible with the number of output channels (${T.outChannels}).`);else if(U.length===3)try{Rt(U,T.outShape)}catch{const O=`Error in fused conv2d: PReLU activation weights (${U}) is not compatible with the output shape of the conv2d (${T.outShape}).`;throw Error(O)}C=oe(c,"prelu weights","fused conv2d")}const $=(U,j)=>{J(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[O,M,B,D]=j,W=Y$(U,B,l);J(Cf(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const H=L$(M.shape,W,O,t,s),ae=Z$(M,W,O.shape,t,s),te=[H,ae];if(D!=null){const Z=Q$(D,W);te.push(Z)}return te},R={x:v,filter:m,bias:E,preluActivationWeights:C},P={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:h};return o==null?$m((j,O,M)=>{let B=be.runKernel(Q0,R,P);return M([O,j,B]),x&&(B=_e(B,[B.shape[1],B.shape[2],B.shape[3]])),{value:B,gradFunc:$}})(v,m):$m((j,O,M,B)=>{let D=be.runKernel(Q0,R,P);return B([O,j,D,M]),x&&(D=_e(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:$}})(v,m,E)}const I1e=xe({fusedConv2d_:N1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1e(n,e,t,s,r,i=[1,1],a){let o=n;n.rank===3&&(o=_e(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=_e(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:o,dy:l},h={strides:s,pad:r,dimRoundingMode:a,dilations:i,filterShape:t};return be.runKernel(s$,c,h)}const k1e=xe({depthwiseConv2dNativeBackpropFilter_:C1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1e(n,e,t,s,r,i=[1,1],a){let o=e,l=!1;e.rank===3&&(l=!0,o=_e(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:o,filter:t},h={strides:s,pad:r,dimRoundingMode:a,dilations:i,inputShape:n},p=be.runKernel(r$,c,h);return l?_e(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const A1e=xe({depthwiseConv2dNativeBackpropInput_:$1e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1e({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(eA(be.state.gradientDepth,i)===!1){let D=bn(n,e,t,s);return r!=null&&(D=Ke(D,r)),J$(D,i,a,o)}let l=oe(n,"a","fused matMul"),c=oe(e,"b","fused matMul");[l,c]=Es(l,c);const h=t?l.shape[l.rank-2]:l.shape[l.rank-1],p=s?c.shape[c.rank-1]:c.shape[c.rank-2],m=t?l.shape[l.rank-1]:l.shape[l.rank-2],v=s?c.shape[c.rank-2]:c.shape[c.rank-1],x=l.shape.slice(0,-2),w=c.shape.slice(0,-2),T=Me(x),E=Me(w);J(h===p,()=>`Error in fused matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${t} and transposeB=${s} must match.`);const $=Rt(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([m,v]),R=t?_e(l,[T,h,m]):_e(l,[T,m,h]),P=s?_e(c,[E,v,p]):_e(c,[E,p,v]);let U;r!=null&&(U=oe(r,"bias","fused matMul"),[U]=Es(U,l),Rt($,U.shape));let j;a!=null&&(j=oe(a,"prelu weights","fused matMul"));const O=(D,W)=>{const[H,ae,te,Z]=W,re=Y$(_e(D,te.shape),te,i);let ne,he;if(!t&&!s?(ne=bn(re,ae,!1,!0),he=bn(H,re,!0,!1)):!t&&s?(ne=bn(re,ae,!1,!1),he=bn(re,H,!0,!1)):t&&!s?(ne=bn(ae,re,!1,!0),he=bn(H,re,!1,!1)):(ne=bn(ae,re,!0,!0),he=bn(re,H,!0,!0)),r!=null){const K=Q$(Z,re);return[ne,he,K]}else return[ne,he]},M={a:R,b:P,bias:U,preluActivationWeights:j},B={transposeA:t,transposeB:s,activation:i,leakyreluAlpha:o};return r==null?$m((W,H,ae)=>{const te=be.runKernel(Y0,M,B);return ae([W,H,te]),{value:_e(te,$),gradFunc:O}})(R,P):$m((W,H,ae,te)=>{const Z=be.runKernel(Y0,M,B);return te([W,H,Z,ae]),{value:_e(Z,$),gradFunc:O}})(R,P,U)}const t3=xe({fusedMatMul_:R1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1e(n,e,t,s,r="bilinear",i=0){const a=oe(n,"image","cropAndResize"),o=oe(e,"boxes","cropAndResize","float32"),l=oe(t,"boxInd","cropAndResize","int32"),c=o.shape[0];J(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),J(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),J(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),J(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),J(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),J(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const h={image:a,boxes:o,boxInd:l},p={method:r,extrapolationValue:i,cropSize:s};return be.runKernel(e$,h,p)}const L1e=xe({cropAndResize_:D1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1e(n){const e=oe(n,"image","flipLeftRight","float32");J(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return be.runKernel(c$,t,{})}const P1e=xe({flipLeftRight_:O1e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1e(n){const e=oe(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];J(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),J(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,t),r[t]=3,Bo(e,r)}const F1e=xe({grayscaleToRGB_:M1e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j1e(n){const e=oe(n,"image","RGBToGrayscale"),t=e.rank-1,s=e.shape[t];J(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),J(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,i=tt(e,"float32"),a=ta([.2989,.587,.114]);let o;switch(e.rank){case 2:o=ly("ij,j->i",i,a);break;case 3:o=ly("ijk,k->ij",i,a);break;case 4:o=ly("ijkl,l->ijk",i,a);break;case 5:o=ly("ijklm,m->ijkl",i,a);break;case 6:o=ly("ijklmn,n->ijklm",i,a);break;default:throw new Error("Not a valid tensor rank.")}return o=Ai(o,-1),tt(o,r)}const B1e=xe({rgbToGrayscale_:j1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z1e(n,e,t=0,s=.5){const r=oe(n,"image","rotateWithOffset","float32");J(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},a={radians:e,fillValue:t,center:s};return be.runKernel(C$,i,a)}const V1e=xe({rotateWithOffset_:z1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sg(n,e,t,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const a=n.shape[0];return t=Math.min(t,a),J(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),J(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),J(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),J(e.rank===1,()=>"scores must be a 1D tensor"),J(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),J(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U1e(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const i=oe(n,"boxes","nonMaxSuppression","float32"),a=oe(e,"scores","nonMaxSuppression","float32"),o=sg(i,a,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l={maxOutputSize:t,iouThreshold:s,scoreThreshold:r};return be.runKernel(m$,{boxes:i,scores:a},l)}const G1e=xe({nonMaxSuppression_:U1e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1e(n,e,t){const s=H1e(n,e,t),r=s<0?-(s+1):s;n.splice(r,0,e)}function H1e(n,e,t){return K1e(n,e,t||q1e)}function q1e(n,e){return n>e?1:n<e?-1:0}function K1e(n,e,t){let s=0,r=n.length,i=0,a=!1;for(;s<r;){i=s+(r-s>>>1);const o=t(e,n[i]);o>0?s=i+1:(r=i,a=!o)}return a?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tA(n,e,t,s,r){return rA(n,e,t,s,r,0)}function nA(n,e,t,s,r,i){return rA(n,e,t,s,r,0,!1,i,!0)}function sA(n,e,t,s,r,i){return rA(n,e,t,s,r,i,!0)}function rA(n,e,t,s,r,i,a=!1,o=!1,l=!1){const c=[];for(let T=0;T<e.length;T++)e[T]>r&&c.push({score:e[T],boxIndex:T,suppressBeginIndex:0});c.sort(n3);const h=i>0?-.5/i:0,p=[],m=[];for(;p.length<t&&c.length>0;){const T=c.pop(),{score:E,boxIndex:C,suppressBeginIndex:$}=T;if(E<r)break;let R=!1;for(let P=p.length-1;P>=$;--P){const U=X1e(n,C,p[P]);if(U>=s){R=!0;break}if(T.score=T.score*Z1e(s,h,U),T.score<=r)break}T.suppressBeginIndex=p.length,R||(T.score===E?(p.push(C),m.push(T.score)):T.score>r&&W1e(c,T,n3))}const v=p.length,x=t-v;o&&x>0&&(p.push(...new Array(x).fill(0)),m.push(...new Array(x).fill(0)));const w={selectedIndices:p};return a&&(w.selectedScores=m),l&&(w.validOutputs=v),w}function X1e(n,e,t){const s=n.subarray(e*4,e*4+4),r=n.subarray(t*4,t*4+4),i=Math.min(s[0],s[2]),a=Math.min(s[1],s[3]),o=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),h=Math.min(r[1],r[3]),p=Math.max(r[0],r[2]),m=Math.max(r[1],r[3]),v=(o-i)*(l-a),x=(p-c)*(m-h);if(v<=0||x<=0)return 0;const w=Math.max(i,c),T=Math.max(a,h),E=Math.min(o,p),C=Math.min(l,m),$=Math.max(E-w,0)*Math.max(C-T,0);return $/(v+x-$)}function Z1e(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function n3(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Y1e(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const i=oe(n,"boxes","nonMaxSuppressionAsync"),a=oe(e,"scores","nonMaxSuppressionAsync"),o=sg(i,a,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l=await Promise.all([i.data(),a.data()]),c=l[0],h=l[1],{selectedIndices:p}=tA(c,h,t,s,r);return i!==n&&i.dispose(),a!==e&&a.dispose(),ta(p,"int32")}const Q1e=Y1e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J1e(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const a=oe(n,"boxes","nonMaxSuppression"),o=oe(e,"scores","nonMaxSuppression"),l=sg(a,o,t,s,r,i);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:a,scores:o},h={maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},p=be.runKernel(y$,c,h);return{selectedIndices:p[0],selectedScores:p[1]}}const ewe=xe({nonMaxSuppressionWithScore_:J1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function twe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const a=oe(n,"boxes","nonMaxSuppressionAsync"),o=oe(e,"scores","nonMaxSuppressionAsync"),l=sg(a,o,t,s,r,i);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([a.data(),o.data()]),h=c[0],p=c[1],{selectedIndices:m,selectedScores:v}=sA(h,p,t,s,r,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:ta(m,"int32"),selectedScores:ta(v)}}const nwe=twe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function swe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const a=oe(n,"boxes","nonMaxSuppression"),o=oe(e,"scores","nonMaxSuppression"),l=sg(a,o,t,s,r,null),c=l.maxOutputSize,h=l.iouThreshold,p=l.scoreThreshold,m={boxes:a,scores:o},v={maxOutputSize:c,iouThreshold:h,scoreThreshold:p,padToMaxOutputSize:i},x=be.runKernel(g$,m,v);return{selectedIndices:x[0],validOutputs:x[1]}}const rwe=xe({nonMaxSuppressionPadded_:swe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function iwe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const a=oe(n,"boxes","nonMaxSuppressionAsync"),o=oe(e,"scores","nonMaxSuppressionAsync"),l=sg(a,o,t,s,r,null),c=l.maxOutputSize,h=l.iouThreshold,p=l.scoreThreshold,[m,v]=await Promise.all([a.data(),o.data()]),{selectedIndices:x,validOutputs:w}=nA(m,v,c,h,p,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:ta(x,"int32"),validOutputs:_n(w,"int32")}}const awe=iwe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function owe(n,e,t=!1,s=!1){const r=oe(n,"images","resizeBilinear");J(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),J(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),J(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,a=!1;r.rank===3&&(a=!0,i=_e(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:s,size:e},c=be.runKernel(aT,o,l);return a?_e(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const b5=xe({resizeBilinear_:owe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lwe(n,e,t=!1,s=!1){const r=oe(n,"images","resizeNearestNeighbor");J(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),J(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),J(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),J(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,a=!1;r.rank===3&&(a=!0,i=_e(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:s,size:e},c=be.runKernel(iT,o,l);return a?_e(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const _5=xe({resizeNearestNeighbor_:lwe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cwe(n,e="binary",t=!1,s=.5){const r=oe(n,"image","threshold"),i=.2989,a=.587,o=.114,l=r.shape[0]*r.shape[1];let c=ye(ta([s]),255),h,p,m,v;if(J(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),J(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),J(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),J(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[h,p,m]=$a(r,[1,1,1],-1);const T=ye(h,i),E=ye(p,a),C=ye(m,o);v=Ke(Ke(T,E),C)}else v=n;if(e==="otsu"){const T=S_e(tt(o5(v),"int32"),LH([]),256);c=uwe(T,l)}const x=t?ng(v,c):Da(v,c);return tt(ye(x,255),"int32")}function uwe(n,e){let t=ta([-1]),s=ta([0]),r=ta([0]),i,a,o,l,c,h;for(let p=0;p<n.size-1;p++){i=zn(n,0,p+1),a=zn(n,p+1),c=yt(mt(i),e),h=yt(mt(a),e);const m=mt(ye(i,lv(0,i.size)));o=yt(m,mt(i));const v=wT(a.shape,i.size),x=Ke(lv(0,a.size),v),w=ye(a,x);l=yt(mt(w),mt(a));const T=_t(o,l),E=_t(o,l),C=ye(c,h);r=ye(ye(C,T),E);const $=Da(r,s);s=ui($,r,s),t=ui($,ta([p]),t)}return t}const hwe=xe({threshold_:cwe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dwe(n,e,t="nearest",s="constant",r=0,i){const a=oe(n,"image","transform","float32"),o=oe(e,"transforms","transform","float32");J(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),J(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),J(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:a,transforms:o},c={interpolation:t,fillMode:s,fillValue:r,outputShape:i};return be.runKernel(N$,l,c)}const fwe=xe({transform_:dwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pwe(n,e,t){const s=oe(n,"a","bandPart");J(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,a]=s.shape.slice(-2);let o,l;typeof e=="number"?(J(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),J(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),o=oe(e<0?i:e,"numLower","bandPart")):(J(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=ui(n1(e,0),i,ov(e,i))),typeof t=="number"?(J(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),J(t<=a,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${a}).`),l=oe(t<0?a:t,"numUpper","bandPart")):(J(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=ui(n1(t,0),a,ov(t,a)));const c=_e(lv(0,i,1,"int32"),[-1,1]),h=lv(0,a,1,"int32"),p=_t(c,h),m=eu(ng(p,o),Gf(p,Ts(l))),v=or([i,a],s.dtype);return _e(tu(Df(_e(s,[-1,i,a])).map(x=>ui(m,x,v))),r)}const mwe=xe({bandPart_:pwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gwe(n){let e;if(Array.isArray(n)){e=!1,J(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let i=1;i<n.length;++i)J(n[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${r})`)}else e=!0,n=$a(n,n.shape[0],0).map(r=>qb(r,[0]));J(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let r=0;r<n.length;++r)t.push(be.tidy(()=>{let i=s[r];if(r>0)for(let a=0;a<r;++a){const o=ye(mt(ye(t[a],i)),t[a]);i=_t(i,o)}return yt(i,ST(i,"euclidean"))}));return e?tu(t,0):t}const ywe=xe({gramSchmidt_:gwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vwe(n,e=!1){if(J(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return s3(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,c)=>l*c),s=Df(_e(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,h]=s3(l,e);r.push(c),i.push(h)});const a=_e(tu(r,0),n.shape),o=_e(tu(i,0),n.shape);return[a,o]}}function s3(n,e=!1){return be.tidy(()=>{J(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let r=JH(t),i=af(n);const a=uN([[1]],[1,1]);let o=af(a);const l=t>=s?s:t;for(let c=0;c<l;++c){const h=i,p=o,m=r;[o,i,r]=be.tidy(()=>{const v=zn(i,[c,c],[t-c,1]),x=ST(v),w=zn(i,[c,c],[1,1]),T=ui(Da(w,0),uN([[-1]]),uN([[1]])),E=_t(w,ye(T,x)),C=yt(v,E);C.shape[0]===1?o=af(a):o=Di([a,zn(C,[1,0],[C.shape[0]-1,C.shape[1]])],0);const $=Ts(yt(bn(T,E),x)),R=zn(i,[c,0],[t-c,s]),P=ye($,o),U=on(o);if(c===0)i=_t(R,bn(P,bn(U,R)));else{const M=_t(R,bn(P,bn(U,R)));i=Di([zn(i,[0,0],[c,s]),M],0)}const j=on(P),O=zn(r,[0,c],[t,r.shape[1]-c]);if(c===0)r=_t(O,bn(bn(O,o),j));else{const M=_t(O,bn(bn(O,o),j));r=Di([zn(r,[0,0],[t,c]),M],1)}return[o,i,r]}),Ht([h,p,m])}return!e&&t>s&&(r=zn(r,[0,0],[t,s]),i=zn(i,[0,0],[s,s])),[r,i]})}const bwe=xe({qr_:vwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vc={flipLeftRight:P1e,grayscaleToRGB:F1e,resizeNearestNeighbor:_5,resizeBilinear:b5,rgbToGrayscale:B1e,rotateWithOffset:V1e,cropAndResize:L1e,nonMaxSuppression:G1e,nonMaxSuppressionAsync:Q1e,nonMaxSuppressionWithScore:ewe,nonMaxSuppressionWithScoreAsync:nwe,nonMaxSuppressionPadded:rwe,nonMaxSuppressionPaddedAsync:awe,threshold:hwe,transform:fwe},_we={bandPart:mwe,gramSchmidt:ywe,qr:bwe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xwe=new Map,wwe=new Map;class rg{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class so{constructor(){this.classNameMap={}}static getMap(){return so.instance==null&&(so.instance=new so),so.instance}static register(e){so.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function We(n,e,t){J(n.className!=null,()=>"Class being registered does not have the static className property defined."),J(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),J(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const s=t,r=e+">"+s;return so.register(n),xwe.set(r,n),wwe.set(n,r),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ad extends rg{minimize(e,t=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const a=s.map(o=>({name:o.name,tensor:i[o.name]}));this.applyGradients(a)}else this.applyGradients(i);return Ht(i),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return Wxe(e,t)}dispose(){this.iterations_!=null&&Ht(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:_n(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ad,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x5 extends ad{static get className(){return"Adadelta"}constructor(e,t,s=null){super(),this.learningRate=e,this.rho=t,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=be.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=be.registeredVariables[s],a=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:ke(()=>ln(i).variable(a))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:ke(()=>ln(i).variable(a))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;ke(()=>{const h=Ke(ye(l,this.rho),ye(Kn(o),1-this.rho)),p=ye(yt(Vr(Ke(c,this.epsilon)),Vr(Ke(l,this.epsilon))),o),m=Ke(ye(c,this.rho),ye(Kn(p),1-this.rho));l.assign(h),c.assign(m);const v=Ke(ye(p,-this.learningRate),i);i.assign(v)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ht(this.accumulatedGrads.map(e=>e.variable)),Ht(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w5 extends ad{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=be.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:ke(()=>wT(i.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const o=this.accumulatedGrads[r].variable;ke(()=>{const l=Ke(o,Kn(a));o.assign(l);const c=Ke(ye(yt(a,Vr(Ke(l,be.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ht(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T5 extends ad{static get className(){return"Adam"}constructor(e,t,s,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ke(()=>{this.accBeta1=_n(t).variable(),this.accBeta2=_n(s).variable()}),r==null&&(this.epsilon=be.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ke(()=>{const s=_t(1,this.accBeta1),r=_t(1,this.accBeta2);t.forEach((i,a)=>{const o=be.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:ke(()=>ln(o).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${i}/v`,variable:ke(()=>ln(o).variable(l))});const c=Array.isArray(e)?e[a].tensor:e[i];if(c==null)return;const h=this.accumulatedFirstMoment[a].variable,p=this.accumulatedSecondMoment[a].variable,m=Ke(ye(h,this.beta1),ye(c,1-this.beta1)),v=Ke(ye(p,this.beta2),ye(Kn(c),1-this.beta2)),x=yt(m,s),w=yt(v,r);h.assign(m),p.assign(v);const T=Ke(ye(yt(x,Ke(Vr(w),this.epsilon)),-this.learningRate),o);o.assign(T)}),this.accBeta1.assign(ye(this.accBeta1,this.beta1)),this.accBeta2.assign(ye(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ht(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Ht(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),ke(()=>{this.accBeta1.assign(Af(this.beta1,this.iterations_+1)),this.accBeta2.assign(Af(this.beta2,this.iterations_+1))});const t=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S5 extends ad{static get className(){return"Adamax"}constructor(e,t,s,r=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ke(()=>{this.iteration=_n(0).variable(),this.accBeta1=_n(t).variable()}),r==null&&(this.epsilon=be.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ke(()=>{const s=_t(1,this.accBeta1),r=yt(-this.learningRate,Ke(ye(this.iteration,this.decay),1));t.forEach((i,a)=>{const o=be.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:ln(o).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${i}/v`,variable:ln(o).variable(l)});const c=Array.isArray(e)?e[a].tensor:e[i];if(c==null)return;const h=this.accumulatedFirstMoment[a].variable,p=this.accumulatedWeightedInfNorm[a].variable,m=Ke(ye(h,this.beta1),ye(c,1-this.beta1)),v=ye(p,this.beta2),x=si(c),w=rd(v,x);h.assign(m),p.assign(w);const T=Ke(ye(yt(r,s),yt(m,Ke(w,this.epsilon))),o);o.assign(T)}),this.iteration.assign(Ke(this.iteration,1)),this.accBeta1.assign(ye(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ht(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Ht(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iA extends ad{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const a=be.registeredVariables[s];ke(()=>{const o=Ke(ye(this.c,i),a);a.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=jl(_n(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E5 extends iA{static get className(){return"Momentum"}constructor(e,t,s=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=s,this.accumulations=[],this.m=_n(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=be.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:ke(()=>ln(i).variable(!1))});const a=this.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[s];o!=null&&ke(()=>{let l;const c=Ke(ye(this.m,a),o);this.useNesterov?l=Ke(ye(this.c,Ke(o,ye(c,this.m))),i):l=Ke(ye(this.c,c),i),a.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ht(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N5 extends ad{static get className(){return"RMSProp"}constructor(e,t=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=be.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=be.registeredVariables[s],a=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:ke(()=>ln(i).variable(a))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:ke(()=>ln(i).variable(a))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:ke(()=>ln(i).variable(a))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;ke(()=>{const h=Ke(ye(l,this.decay),ye(Kn(o),1-this.decay));if(this.centered){const p=this.accumulatedMeanGrads[r].variable,m=Ke(ye(p,this.decay),ye(o,1-this.decay)),v=yt(ye(o,this.learningRate),Vr(_t(h,Ke(Kn(m),this.epsilon)))),x=Ke(ye(c,this.momentum),v);l.assign(h),p.assign(m),c.assign(x);const w=_t(i,x);i.assign(w)}else{const p=Ke(ye(l,this.decay),ye(Kn(o),1-this.decay)),m=Ke(ye(c,this.momentum),yt(ye(o,this.learningRate),Vr(Ke(p,this.epsilon))));l.assign(p),c.assign(m);const v=_t(i,m);i.assign(v)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ht(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ht(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Ht(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Twe=[x5,w5,T5,S5,E5,N5,iA];function Swe(){for(const n of Twe)We(n)}function aA(n,e){const t=n.shape.length,s=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${t}`);if(Me(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const r=e.shape,i=r[r.length-1];let a=1;for(let p=0;p<r.length-1;++p)a*=r[p];const o=n.shape,l=r.slice();l.pop();let c=1;for(let p=i;p<t;++p)c*=o[p],l.push(o[p]);const h=[...ht(n.shape).map(p=>p/c),1].slice(0,i);return[l,a,c,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JI=-2,Ewe=-1;function oA(n,e,t){const s=n.shape.length;J(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),J(s===t.length,()=>`Error in slice${s}D: Length of size ${t} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)J(e[r]+t[r]<=n.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+t[r]}) would overflow input.shape[${r}] (${n.shape[r]})`)}function Nwe(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function lA(n,e,t){const s=[];for(let r=0;r<n.length;r++)s[r]=Math.ceil((e[r]-n[r])/t[r]);return s}function I5(n,e,t,s){const r=[...n];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<t;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function C5(n,e,t){return t<=n?t:t-(e-1)}function k5(n,e){const t=[];for(let s=0;s<n;s++)t.push(e+s);return t}function Iwe(n,e,t,s,r,i,a,o,l){const c=n.length;let h=new Array(c),p=new Array(c),m=new Array(c);if(e.length&&t>0){const v=e[0],x=t+1;h=$5(a,v,x,s,n),p=A5(o,v,x,r,n),m=I5(i,v,x,n)}else for(let v=0;v<c;v++)h[v]=D5(a,s,i,n,v,l),p[v]=L5(o,r,i,n,v,l),m[v]=R5(i,v,l);return{begin:h,end:p,strides:m}}function $5(n,e,t,s,r){const i=[...r],a=k5(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=0;else{const l=C5(e,t,o);let c=s[l];n&1<<l&&(c=0),i[o]=c}return i}function A5(n,e,t,s,r){const i=[...r],a=k5(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{const l=C5(e,t,o);let c=s[l];n&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[o]=c}for(let o=0;o<i.length;o++){const l=r[o];i[o]<0&&(i[o]+=l),i[o]=Sf(0,i[o],r[o])}return i}function R5(n,e,t){let s=n[e];return(t&1<<e||s==null)&&(s=1),s}function D5(n,e,t,s,r,i){let a=e[r];const o=t[r]||1;(n&1<<r||i&1<<r||a==null)&&(o>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=s[r];return a<0&&(a+=l),a=Sf(0,a,l-1),a}function L5(n,e,t,s,r,i){let a=e[r];const o=t[r]||1;(n&1<<r||i&1<<r||a==null)&&(o>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=s[r];return a<0&&(a+=l),o>0?a=Sf(0,a,l):a=Sf(-1,a,l-1),a}function cA(n,e,t){let s=t.length;for(let r=0;r<t.length;r++)if(t[r]>1){s=r;break}for(let r=s+1;r<t.length;r++)if(e[r]>0||t[r]!==n[r])return!1;return!0}function uA(n,e){let t=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)t+=n[s]*e[s];return t}function NT(n,e,t){let s;const r=n.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(a=>{J(a!==-1,()=>"slice() does not support negative begin indexing.")});let i;return t==null?i=new Array(r).fill(-1):typeof t=="number"?i=[t,...new Array(r-1).fill(-1)]:t.length<r?i=t.concat(new Array(r-t.length).fill(-1)):i=t,i=i.map((a,o)=>a>=0?a:(J(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${o}.`),n.shape[o]-s[o])),[s,i]}function hA(n,e,t,s,r,i,a,o,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const p={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};for(let $=0;$<p.dims;$++)h&&(1<<$&o)!==0&&p.numAddAxisAfterEllipsis++,1<<$&a&&(h=!0);h||(p.ellipsisMask|=1<<p.dims,p.dims++);const m={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Cwe(p,m);let v=!0,x=!0,w=!0;const T=[],E=[];for(let $=0;$<n.length;++$){if(m.strides[$]===0)throw Error(`strides[${$}] must be non-zero`);const R=!!(m.shrinkAxisMask&1<<$),P=n[$];if(P===-1){T.push(R?1:-1);continue}const U=[m.beginMask&1<<$,m.endMask&1<<$],j=[m.strides[$]>0?0:-1,m.strides[$]>0?P:P-1];if(R&&m.strides[$]<=0)throw Error("only stride 1 allowed on non-range indexing.");w=w&&m.strides[$]===1;const O=!!(m.beginMask&1<<$&&m.endMask&1<<$);if(m.beginValid&&m.endValid){if(R){const W=m.begin[$]<0?P+m.begin[$]:m.begin[$];if(m.begin[$]=W,m.end[$]=m.begin[$]+1,W<0||W>=P)throw Error(`slice index ${m.begin[$]} of dimension ${$} out of bounds.`)}else m.begin[$]=r3(m.begin[$],0,m.strides[$],P,U,j),m.end[$]=r3(m.end[$],1,m.strides[$],P,U,j);const D=m.strides[$]===1&&m.begin[$]===0&&m.end[$]===P;v=v&&D,x=x&&($===0&&m.strides[$]===1||D)}else v=v&&m.strides[$]===1&&O,x=x&&($===0&&m.strides[$]===1||O);let M,B=!1;if(m.beginValid&&m.endValid?(M=m.end[$]-m.begin[$],B=!0):R?(M=1,B=!0):O&&P>=0&&(m.strides[$]<0?M=-P:M=P,B=!0),B){let D;M===0||M<0!=m.strides[$]<0?D=0:D=Math.trunc(M/m.strides[$])+(M%m.strides[$]!==0?1:0),T.push(D)}else T.push(-1)}for(let $=0;$<m.finalShapeGatherIndices.length;++$){const R=m.finalShapeGatherIndices[$];R>=0?E.push(T[R]):R===JI&&E.push(1)}return{finalShapeSparse:E.filter(($,R)=>m.finalShapeGatherIndices[R]!==JI),finalShape:E,isIdentity:v,sliceDim0:x,isSimpleSlice:w,begin:m.begin,end:m.end,strides:m.strides}}function Cwe(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const r=Math.min(e.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<r;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=s}else if(1<<s&n.newAxisMask)e.finalShapeGatherIndices.push(JI),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[s]),n.end!=null&&(e.end[t]=n.end[s]),e.strides[t]=n.strides[s],n.beginMask&1<<s&&(e.beginMask|=1<<t),n.endMask&1<<s&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(Ewe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[t]=s,t++}}function r3(n,e,t,s,r,i){if(r[e])return t>0?i[e]:i[e+1&1];{const a=n<0?s+n:n;return a<i[0]?i[0]:a>i[1]?i[1]:a}}const kwe=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:oA,computeFlatOffset:uA,computeOutShape:lA,getNormalizedAxes:Iwe,isSliceContinous:cA,maskToAxes:Nwe,parseSliceParams:NT,sliceInfo:hA,startForAxis:D5,startIndicesWithElidedDims:$5,stopForAxis:L5,stopIndicesWithElidedDims:A5,stridesForAxis:R5,stridesWithElidedDims:I5},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $we{static sgd(e){return new iA(e)}static momentum(e,t,s=!1){return new E5(e,t,s)}static rmsprop(e,t=.9,s=0,r=null,i=!1){return new N5(e,t,s,r,i)}static adam(e=.001,t=.9,s=.999,r=null){return new T5(e,t,s,r)}static adadelta(e=.001,t=.95,s=null){return new x5(e,t,s)}static adamax(e=.002,t=.9,s=.999,r=null,i=0){return new S5(e,t,s,r,i)}static adagrad(e,t=.1){return new w5(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mp=$we;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Awe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function O5(){return new Promise(n=>Awe(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dA(n,e){const t=n[0].length;n.forEach((r,i)=>{J(r.length===t,()=>`Error in concat${t}D: rank of tensors[${i}] must be the same as the rank of the rest (${t})`)}),J(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const s=n[0];n.forEach((r,i)=>{for(let a=0;a<t;a++)J(a===e||r[a]===s[a],()=>`Error in concat${t}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function Bl(n,e){const t=n[0].slice();for(let s=1;s<n.length;s++)t[e]+=n[s][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Fo;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Fo||(Fo={}));function P5(n,e,t){let s=new Array;if(t==null&&e==null)return s;if(e==null)for(;s.length<n+t.length;)s.push(-1);else s=e.slice();if(t==null)return s;if(n+t.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${s.length}`);for(let r=1;r<t.length;++r){const i=t[r],a=s[s.length-t.length+r],o=s[a];if(i>=0)if(o>=0){if(o!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+n}] = ${i} but shape[${r+n}] = ${o}`)}else s[a]=i}return s}function M5(n){const e={FIRST_DIM_SIZE:Fo.FIRST_DIM_SIZE,VALUE_ROWIDS:Fo.VALUE_ROWIDS,ROW_LENGTHS:Fo.ROW_LENGTHS,ROW_SPLITS:Fo.ROW_SPLITS,ROW_LIMITS:Fo.ROW_LIMITS,ROW_STARTS:Fo.ROW_STARTS},t=[];for(const s of n)if(s in e)t.push(e[s]);else break;return t}function F5(n){return n.length===0?0:n[0]===Fo.FIRST_DIM_SIZE?n.length-1:n.length}function j5(n,e){if(n==null||e==null)return;const t=n.length,s=e.length;if(t>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(t,s-1);++r){const i=n[r],a=e[r+1];if(i>=0&&a>=0&&i!==1&&i!==a)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-n.length}] = ${i} but ragged tensor input.flatValues.shape[${r-n.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fA=30;function IT(n){return n<=fA?n:MI(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pA(n,e,t){const s=t*(typeof n=="number"?n:n[0]),r=e*(typeof n=="number"?n:n[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xb(n,e,t,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(n[0]/t),r=r.concat(n.slice(1));else{r=r.concat(n[0]);const i=e.length;for(let a=0;a<i;++a)r=r.concat([n[a+1]/e[a],e[a]]);r=r.concat(n.slice(i+1))}return r}function Zb(n,e,t=!0){const s=[];if(t){s.push(e);for(let r=e+1;r<n;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let a=1;a<n;++a)a>=e*2+1||a%2===1?i.push(a):r.push(a);s.push(...r),s.push(0),s.push(...i)}return s}function Yb(n,e,t,s=!0){const r=[];s?r.push(n[0]/t):r.push(n[0]*t);for(let i=1;i<n.length;++i)i<=e.length?s?r.push(e[i-1]*n[i]):r.push(n[i]/e[i-1]):r.push(n[i]);return r}function mA(n,e){const t=[0];for(let s=0;s<e;++s)t.push(n[s][0]);return t}function gA(n,e,t){const s=n.slice(0,1);for(let r=0;r<t;++r)s.push(n[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CT=1.7580993408473768,kT=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yA=.3275911,vA=.254829592,bA=-.284496736,_A=1.421413741,xA=-1.453152027,wA=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nu(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let s=0;s<t.length;s+=2)t[s]=n[s/2],t[s+1]=e[s/2];return t}function B5(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)e[s/2]=n[s],t[s/2]=n[s+1];return{real:e,imag:t}}function z5(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function V5(n){const e=Math.floor(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function TA(n,e){const t=n[e*2],s=n[e*2+1];return{real:t,imag:s}}function U5(n,e,t,s){n[s*2]=e,n[s*2+1]=t}function G5(n,e){const t=new Float32Array(n/2),s=new Float32Array(n/2);for(let r=0;r<Math.ceil(n/2);r++){const i=(e?2:-2)*Math.PI*(r/n);t[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:t,imag:s}}function W5(n,e,t){const s=(t?2:-2)*Math.PI*(n/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hN="->",Rwe=/->/g,i3=",",a3="...";function SA(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(Rwe,"").length)/hN.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${hN}").`);const[s,r]=n.split(hN);J(s.indexOf(a3)===-1,()=>`The ellipsis notation ("${a3}") is not supported yet.`);const i=s.split(i3),a=i.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let m=0;m<r.length;++m){const v=r[m];if(!i.some(x=>x.indexOf(v)!==-1))throw new Error(`Output subscripts contain the label ${v} not present in the input subscripts.`);o.indexOf(v)===-1&&o.push(v)}for(let m=0;m<s.length;++m){const v=s[m];o.indexOf(v)===-1&&v!==i3&&o.push(v)}const l=new Array(i.length);for(let m=0;m<a;++m){if(new Set(i[m].split("")).size!==i[m].length)throw new Error(`Found duplicate axes in input component ${i[m]}. Support for duplicate axes in input is not implemented yet.`);l[m]=[];for(let v=0;v<i[m].length;++v)l[m].push(o.indexOf(i[m][v]))}const c=o.length,h=r.length,p=[];for(let m=h;m<c;++m)p.push(m);return{allDims:o,summedDims:p,idDims:l}}function EA(n,e){let t=new Array(n);t.fill(-1);for(let r=0;r<e.length;++r)t[e[r]]=r;const s=[];for(let r=0;r<n;++r)t[r]===-1&&s.push(r);return t=t.filter(r=>r!==-1),{permutationIndices:t,expandDims:s}}function NA(n,e,t){const s=new Array(n);for(let r=0;r<t.length;++r){const i=t[r].shape;for(let a=0;a<e[r].length;++a)s[e[r][a]]===void 0?s[e[r][a]]=i[a]:J(s[e[r][a]]===i[a],()=>`Expected dimension ${s[e[r][a]]} at axis ${a} of input shaped ${JSON.stringify(i)}, but got dimension ${i[a]}`)}}function IA(n,e){const t=n,s=[];let r=0;n.length===0&&t.push(-1),r=n.length+1;for(let a=0;a<r;++a)s.push([]);const i=[];for(let a=0;a<t.length;++a){const o=t[a],l=Dwe(e,o);for(const c of l)i.indexOf(c)===-1&&(s[a].push(c),i.push(c))}return{path:t,steps:s}}function CA(n){return n.every((e,t)=>e===t)}function Dwe(n,e){const t=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(e)!==-1||e===-1)&&t.push(s);return t}function kA(n,e,t=0){let s=[];if(typeof e=="number")J(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(n.shape[t]/e);else{const r=e.reduce((a,o)=>(o===-1&&(a+=1),a),0);J(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const a=e.reduce((o,l)=>l>0?o+l:o);e[i]=n.shape[t]-a}J(n.shape[t]===e.reduce((a,o)=>a+o),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H5(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function q5(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function K5(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X5(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function Z5(n,e){return`size ${n} must be non-negative, not ${e}`}function Y5(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Q5(n,e){const t=Me(n),s=Me(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${e}`}function J5(n,e){const t=Me(n),s=Me(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eC(){return"segment ids must be >= 0"}function eq(){return"segment ids are not increasing"}function tq(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function nq(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(n,e){let t=!1,s;for(n<=fA?(s=n,t=!0):s=MI(n,Math.floor(Math.sqrt(n)));!t;)s>e||s===n?t=!0:s=MI(n,s+1);return s}function rq(n,e,t){const s=[],r=n.length;for(let i=0;i<r;i++)i!==e?s.push(n[i]):s.push(t);return s}function $A(n,e,t,s){const r=e.shape.length,i=n.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(t<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${t}).`);for(let p=0;p<s;++p)if(n.shape[p]!==e.shape[p])throw new Error(`x.shape[${p}]: ${n.shape[p]} should be equal to indices.shape[${p}]: ${e.shape[p]}.`);const a=n.shape[t],o=[];let l=1,c=1,h=1;for(let p=0;p<s;++p)o.push(n.shape[p]),l*=n.shape[p];for(let p=s;p<t;p++)o.push(n.shape[p]),c*=n.shape[p];for(let p=s;p<r;p++)o.push(e.shape[p]);for(let p=t+1;p<i;p++)o.push(n.shape[p]),h*=n.shape[p];return{batchSize:l,sliceSize:h,outerSize:c,dimSize:a,outputShape:o}}const Lwe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:$A,computeOutShape:rq,segOpComputeOptimalWindowSize:sq},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function su(n){try{return n.map(e=>jh(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function iq(n){return n.map(e=>Th(e))}const Owe=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:vA,ERF_A2:bA,ERF_A3:_A,ERF_A4:xA,ERF_A5:wA,ERF_P:yA,PARALLELIZE_THRESHOLD:fA,get RowPartitionType(){return Fo},SELU_SCALE:kT,SELU_SCALEALPHA:CT,applyActivation:J$,assertAndGetBroadcastShape:Rt,assertAxesAreInnerMostDims:Ir,assertParamsConsistent:dA,assignToTypedArray:U5,axesAreInnerMostDims:M$,calculateShapes:Hf,checkEinsumDimSizes:NA,checkPadOnDimRoundingMode:Pi,combineLocations:YH,combineRaggedTensorToTensorShapes:P5,complexWithEvenIndex:z5,complexWithOddIndex:V5,computeConv2DInfo:Nr,computeConv3DInfo:nd,computeDefaultPad:A$,computeDilation2DInfo:Gb,computeOptimalWindowSize:IT,computeOutAndReduceShapes:ur,computeOutShape:Bl,computePool2DInfo:ho,computePool3DInfo:lu,convertConv2DDataFormat:cu,decodeEinsumEquation:SA,eitherStridesOrDilationsAreOne:Gr,expandShapeToKeepDim:js,exponent:W5,exponents:G5,fromStringArrayToUint8:iq,fromUint8ToStringArray:su,getAxesPermutation:us,getBroadcastDims:km,getComplexWithIndex:TA,getEinsumComputePath:IA,getEinsumPermutation:EA,getFusedBiasGradient:Q$,getFusedDyActivation:Y$,getImageCenter:pA,getInnerMostAxes:Is,getPermuted:Zb,getRaggedRank:F5,getReductionAxes:Ys,getReshaped:Xb,getReshapedPermuted:Yb,getRowPartitionTypesHelper:M5,getSliceBeginCoords:mA,getSliceSize:gA,getSparseFillEmptyRowsIndicesDenseShapeMismatch:H5,getSparseFillEmptyRowsNegativeIndexErrorMessage:q5,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:K5,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:Y5,getSparseReshapeInputOutputMismatchErrorMessage:J5,getSparseReshapeInputOutputMultipleErrorMessage:Q5,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:X5,getSparseReshapeNegativeOutputDimErrorMessage:Z5,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:nq,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:eC,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:eq,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:tq,getUndoAxesPermutation:sd,isIdentityPermutation:CA,log:Pve,mergeRealAndImagArrays:nu,prepareAndValidate:aA,prepareSplitSize:kA,segment_util:Lwe,shouldFuse:eA,slice_util:kwe,splitRealAndImagArrays:B5,stridesOrDilationsArePositive:kf,tupleValuesAreOne:Cf,upcastType:ra,validateDefaultValueShape:j5,validateInput:d1e,validateUpdateShape:m5,warn:Na},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Swe();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq={kernelName:yw,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(n,Kb(tt(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pwe={kernelName:Xv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Kn(tt(t,"float32")),r=Vr(_t(_n(1),s));return Ts(yt(n,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mwe={kernelName:Zv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Vr(_t(Kn(tt(t,"float32")),1));return yt(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fwe={kernelName:Jm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Rt(t.shape,s.shape);return{a:()=>{let o=n;const l=Ys(t.shape,r);return l.length>0&&(o=mt(o,l)),_e(o,t.shape)},b:()=>{let o=n;const l=Ys(s.shape,r);return l.length>0&&(o=mt(o,l)),_e(o,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jwe={kernelName:V2,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((s,r)=>{t[r]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bwe={kernelName:vw,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ln(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zwe={kernelName:bw,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ln(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vwe={kernelName:Yv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yt(n,Vr(_t(_n(1),Kn(tt(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uwe={kernelName:Qv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Vr(Ke(_n(1),Kn(tt(t,"float32"))));return yt(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gwe={kernelName:tb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Rt(t.shape,s.shape);return{a:()=>{const o=Ke(Kn(t),Kn(s));let l=ye(n,yt(s,o));const c=Ys(t.shape,r);return c.length>0&&(l=mt(l,c)),_e(l,t.shape)},b:()=>{const o=Ke(Kn(t),Kn(s));let l=Ts(ye(n,yt(t,o)));const c=Ys(s.shape,r);return c.length>0&&(l=mt(l,c)),_e(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wwe={kernelName:Jv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yt(n,Ke(Kn(tt(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hwe={kernelName:eb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yt(n,_t(_n(1),Kn(tt(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qwe(n,e,t,s,r,i){const a=oe(n,"dy","avgPool3dGrad"),o=oe(e,"input","avgPool3dGrad");let l=a,c=o,h=!1;o.rank===4&&(h=!0,l=_e(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),c=_e(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),J(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),J(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Pi("avgPool3dGrad",r,i);const p={dy:l,input:c},m={filterSize:t,strides:s,pad:r,dimRoundingMode:i},v=be.runKernel(H2,p,m);return h?_e(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const Kwe=xe({avgPool3dGrad_:qwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xwe={kernelName:xw,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:o}=t;return{x:()=>Kwe(n,s,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zwe(n,e,t,s,r){const i=oe(n,"dy","avgPoolGrad"),a=oe(e,"input","avgPoolGrad");J(a.rank===i.rank,()=>`Rank of input (${a.rank}) does not match rank of dy (${i.rank})`);let o=a,l=i,c=!1;a.rank===3&&(c=!0,o=_e(a,[1,a.shape[0],a.shape[1],a.shape[2]]),l=_e(i,[1,i.shape[0],i.shape[1],i.shape[2]])),J(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),J(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const h={dy:l,input:o},p={filterSize:t,strides:s,pad:r},m=be.runKernel(W2,h,p);return c?_e(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Ywe=xe({avgPoolGrad_:Zwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qwe={kernelName:_w,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:i,pad:a}=t;return{x:()=>Ywe(n,s,r,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jwe={kernelName:ww,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[s,r]=e,{transposeA:i,transposeB:a}=t;return!i&&!a?{a:()=>bn(n,r,!1,!0),b:()=>bn(s,n,!0,!1)}:!i&&a?{a:()=>bn(n,r,!1,!1),b:()=>bn(n,s,!0,!1)}:i&&!a?{a:()=>bn(r,n,!1,!0),b:()=>bn(s,n,!1,!1)}:{a:()=>bn(r,n,!0,!0),b:()=>bn(n,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eTe={kernelName:Tw,gradFunc:(n,e,t)=>{const{blockShape:s,crops:r}=t;return{x:()=>W$(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tTe={kernelName:Rve,gradFunc:(n,e,t)=>{const s=t,r=s.inputShape,i=s.shape,a=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])a[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const o=[];for(let l=0;l<a.length;l++)a[l]>1&&o.push(l);return{x:()=>mt(n,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nTe={kernelName:nb,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sTe={kernelName:sb,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rTe={kernelName:rb,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=t;return{x:()=>ui(eu(Gf(s,r),ng(s,i)),n,ln(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iTe={kernelName:Sw,inputsToSave:["x"],gradFunc:aq.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aTe={kernelName:Ew,saveAllInputs:!0,gradFunc:(n,e,t)=>{const s=e.map(l=>l.shape),{axis:r}=t,i=Vt(r,e[0].shape)[0],a=s.map(l=>l[i]);return $a(n,a,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oTe={kernelName:Nw,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{dilations:i,strides:a,pad:o,dataFormat:l}=t;return J(Cf(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>L$(s.shape,n,r,a,o,l),filter:()=>Z$(s,n,r.shape,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lTe={kernelName:Iw,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{strides:i,pad:a,dataFormat:o,dimRoundingMode:l}=t;return{dy:()=>$f(n,r,i,a,o,1,l),filter:()=>Z$(n,s,r.shape,i,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cTe(n,e,t,s,r){let i=n;n.rank===4&&(i=_e(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let a=e;a.rank===4&&(a=_e(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),J(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),J(a.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${a.shape}.`),J(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),J(i.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${t[3]}.`),J(a.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${t[4]}).`);const o={x:i,dy:a},l={strides:s,pad:r,filterShape:t};return be.runKernel(Y2,o,l)}const uTe=xe({conv3DBackpropFilter_:cTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hTe={kernelName:Cw,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:i}=t;J(Cf(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[a,o]=e;return{x:()=>qH(a.shape,n,o,r,i),filter:()=>uTe(a,n,o.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dTe={kernelName:ib,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(Ts(h5(tt(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fTe={kernelName:ab,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(d5(tt(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pTe={kernelName:kw,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r,exclusive:i,reverse:a}=t;return{x:()=>{const o=us([r],s.rank);let l=XH(n,r,i,!a);return o!=null&&(l=on(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mTe={kernelName:$w,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:a}=t,o=s??[1,1];J(Cf(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,c]=e;return J(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),J(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),J(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),J(Gr(r,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${o}'.`),Pi("depthwiseConv2d",i,a),{x:()=>A1e(l.shape,n,c,r,i,o,a),filter:()=>k1e(l,n,c.shape,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gTe={kernelName:Aw,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,i={x:s,filter:r,dy:n},a={x:s,filter:r,dy:n};return{x:()=>be.runKernel(FI,i,t),filter:()=>be.runKernel(jI,a,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yTe={kernelName:lb,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,s={dy:n,y:t};return{x:()=>be.runKernel(a$,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vTe={kernelName:cb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=ye(Jl(Ts(Kn(t))),2/Math.sqrt(Math.PI));return{x:()=>ye(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bTe={kernelName:ub,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Te={kernelName:Dw,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>_e(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xTe={kernelName:hb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(n,Jl(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wTe={kernelName:db,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TTe={kernelName:fb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Rt(t.shape,s.shape);return{a:()=>{const o=yt(n,tt(s,"float32")),l=Ys(t.shape,r);return l.length>0?_e(mt(o,l),t.shape):o},b:()=>{let o=ye(n,tt(t,"float32"));const l=Ys(s.shape,r);l.length>0&&(o=_e(mt(o,l),s.shape));const c=Kn(s);return Ts(yt(o,tt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const STe={kernelName:Lw,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:s}=t,[r,i,a,o]=e,l=o??_n(1),c=Ys(i.shape,r.shape),h=[];if(i.rank===1){for(let R=0;R<r.shape.length-1;++R)h.push(r.shape[R]);h.push(1)}const p=_t(r,i),m=ye(n,l),v=l5(Ke(a,_n(s))),x=ye(ye(ye(v,v),v),_n(-.5));return{x:()=>i.rank===1?_e(ye(ye(n,Bo(_e(v,[1,1,1,i.shape[0]]),h)),l),r.shape):_e(ye(ye(n,v),l),r.shape),mean:()=>{let R=ye(ye(v,_n(-1)),m);return i.rank===1&&(R=mt(R,c)),_e(R,i.shape)},variance:()=>{let R=ye(ye(x,p),m);return i.rank===1&&(R=mt(R,c)),_e(R,i.shape)},scale:()=>{const R=ye(p,v);let P=ye(n,R);return i.rank===1&&(P=mt(P,c)),_e(P,i.shape)},offset:()=>{let R=n;return i.rank===1&&(R=mt(R,c)),_e(R,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ETe={kernelName:Ow,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[s,r]=e,{axis:i,batchDims:a}=t,o=Vt(i,s.shape)[0],l=(c,h,p)=>()=>{const m=c.shape,v=h.size,x=m.slice(0,o),w=x.length,T=m.slice(i,m.length).slice(1),E=T.length,C=o3(0,w),$=o3(w+1,w+1+E),R=l3([x,[v],T]),P=_e(p,R),U=_e(h,[v]),j=l3([[w],C,$]),O=on(P,j);let M=y5(O,U,c.shape[o]);const B=sd(j);return M=on(M,B),M};if(a===1){const c=s.shape[0],h=s.split(c,0);return{x:()=>tu(h.map((v,x)=>l(v,r.slice(x,1),n.slice(x,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,n),indices:()=>r}}};function o3(n,e){const t=[];for(let s=n;s<e;++s)t.push(s);return t}function l3(n){const e=[];for(let t=0;t<n.length;++t)for(let s=0;s<n[t].length;++s)e.push(n[t][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NTe={kernelName:pb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>ln(t),b:()=>ln(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ITe={kernelName:mb,gradFunc:n=>({x:()=>tt(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CTe={kernelName:gb,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kTe={kernelName:yb,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Te={kernelName:vb,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ATe={kernelName:Mw,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{alpha:r}=t,i=Da(s,0);return{x:()=>ui(i,n,ye(n,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RTe={kernelName:_b,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yt(n,Ke(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DTe={kernelName:bb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yt(n,tt(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LTe={kernelName:Lve,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;return{logits:()=>{const a=Jl(s);return _t(n,ye(mt(n,r,!0),a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OTe(n,e,t,s=5,r=1,i=1,a=.5){const o={x:n,y:e,dy:t},l={depthRadius:s,bias:r,alpha:i,beta:a};return be.runKernel(d$,o,l)}const PTe=xe({localResponseNormalizationBackprop_:OTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MTe={kernelName:Uw,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{depthRadius:i,bias:a,alpha:o,beta:l}=t;return{x:()=>PTe(s,r,n,i,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(n,e,t,s){return e.rank<t.rank&&(e=_e(e,js(e.shape,s))),n.rank<t.rank&&(n=_e(n,js(n.shape,s))),{x:()=>ye(n,tt(Ql(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c3={kernelName:Gw,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{reductionIndices:r}=s,i=e[0],a=e[1],o=Vt(r,i.shape),l=oq(n,a,i,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FTe={kernelName:xb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>ye(n,tt(Gf(t,s),"float32")),b:()=>ye(n,tt(n1(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jTe(n,e,t,s,r,i,a){const o=oe(n,"dy","maxPool3dGrad"),l=oe(e,"input","maxPool3dGrad"),c=oe(t,"output","maxPool3dGrad");let h=o,p=l,m=c,v=!1;l.rank===4&&(v=!0,h=_e(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),p=_e(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),m=_e(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),J(h.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${h.rank}.`),J(p.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${p.rank}.`),J(m.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${m.rank}.`),Pi("maxPool3dGrad",i,a);const x={dy:h,input:p,output:m},w={filterSize:s,strides:r,pad:i,dimRoundingMode:a},T=be.runKernel(p$,x,w);return v?_e(T,[T.shape[1],T.shape[2],T.shape[3],T.shape[4]]):T}const BTe=xe({maxPool3dGrad_:jTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zTe={kernelName:Hw,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=t;return{x:()=>BTe(n,s,r,i,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VTe(n,e,t,s,r,i,a){const o=oe(n,"dy","maxPoolGrad"),l=oe(e,"input","maxPoolGrad"),c=oe(t,"output","maxPoolGrad");J(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),J(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),J(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Pi("maxPoolGrad",i,a);const h={dy:o,input:l,output:c},p={filterSize:s,strides:r,pad:i,dimRoundingMode:a};return be.runKernel(f$,h,p)}const UTe=xe({maxPoolGrad_:VTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GTe={kernelName:Ww,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:i,strides:a,pad:o}=t;return{x:()=>UTe(n,s,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WTe={kernelName:qw,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t,i=Vt(r,s.shape),o=ur(s.shape,i)[1],l=Me(o);return{x:()=>{const h=s.shape.slice();i.forEach(v=>{h[v]=1});const p=_e(n,h);return yt(ye(p,id(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HTe={kernelName:Kw,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{axis:r}=s,[i,a]=e,o=Vt(r,i.shape),l=oq(n,a,i,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qTe={kernelName:wb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>ye(n,tt(ng(t,s),"float32")),b:()=>ye(n,tt(Da(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KTe={kernelName:Xw,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,i=r.map(a=>a[0]);return{x:()=>zn(n,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XTe={kernelName:Tb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Rt(t.shape,s.shape);return{a:()=>{const o=Ys(t.shape,r);return o.length>0?_e(mt(n,o),t.shape):n},b:()=>{const o=ye(n,Ts(ET(yt(t,s)))),l=Ys(s.shape,r);return l.length>0?_e(mt(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZTe={kernelName:Sb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Rt(t.shape,s.shape);return{a:()=>{const o=ye(n,tt(s,"float32")),l=Ys(t.shape,r);return l.length>0?_e(mt(o,l),t.shape):o},b:()=>{const o=ye(n,tt(t,"float32")),l=Ys(s.shape,r);return l.length>0?_e(mt(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YTe={kernelName:Zw,gradFunc:n=>({x:()=>Ts(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QTe={kernelName:Jw,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>or(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JTe={kernelName:Qw,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eSe={kernelName:eT,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:s}=t;return Df(n,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u3={kernelName:tT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,i=r.map(a=>a[0]);return{x:()=>zn(n,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tSe={kernelName:Eb,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,s,r]=e,i=t,a=s,o=Rt(i.shape,a.shape);return{a:()=>{const h=tt(a,"float32");let p=ye(n,ye(h,Af(i,_t(h,_n(1)))));const m=Ys(i.shape,o);return m.length>0&&(p=mt(p,m)),_e(p,i.shape)},b:()=>{const h=Da(i,0),p=ui(h,ec(i),ln(i));let m=ye(n,ye(r,p));const v=Ys(a.shape,o);return v.length>0&&(m=mt(m,v)),_e(m,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nSe={kernelName:nT,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,s]=e,r=Da(t,0);return{x:()=>ui(r,n,ye(n,s)),alpha:()=>{let i=ui(r,ln(n),ye(n,t));const a=Ys(s.shape,n.shape);return a.length>0&&(i=mt(i,a)),_e(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sSe(n,e,t){const s=n.shape.slice();s[t]=1;const r=_e(e,s),i=YI(n,t,!0,!1),a=YI(n,t,!0,!0),o=ye(i,a);return ye(r,o)}function rSe(n,e,t){const s=n.shape.length,r=s-t.length,i=us(t,s);let a=n;i!=null&&(a=on(n,i));const o=a.shape.slice(),c=o.splice(s-t.length,t.length).reduce((m,v)=>m*v,1);o.push(c);const h=a.reshape(o);let p=sSe(h,e,r);if(p=p.reshape(a.shape),i!=null){const m=sd(i);p=on(p,m)}return p}const iSe={kernelName:sT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;let i=[];return r==null?i=s.shape.map((a,o)=>o):typeof r=="number"?i=[r]:i=r,{x:()=>rSe(s,n,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aSe={kernelName:ob,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Rt(t.shape,s.shape);return{a:()=>{const o=yt(n,tt(s,"float32")),l=Ys(t.shape,r);return l.length>0?_e(mt(o,l),t.shape):o},b:()=>{let o=ye(n,tt(t,"float32"));const l=Ys(s.shape,r);l.length>0&&(o=_e(mt(o,l),s.shape));const c=Kn(s);return Ts(yt(o,tt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oSe={kernelName:Nb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yt(n,Ts(Kn(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lSe={kernelName:Cb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=ye(ng(t,6),Kb(t));return{x:()=>ye(n,tt(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cSe={kernelName:Ib,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(n,tt(Kb(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uSe={kernelName:rT,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hSe={kernelName:aT,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>be.runKernel(x$,r,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dSe={kernelName:iT,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>be.runKernel(_$,r,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fSe={kernelName:oT,gradFunc:(n,e,t)=>{const{dims:s}=t,r=Vt(s,n.shape);return{x:()=>Rf(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pSe={kernelName:kb,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mSe={kernelName:$b,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ts(yt(n,ye(Af(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gSe={kernelName:lT,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>tt(ln(t),"float32"),t:()=>ye(n,tt(t,n.dtype)),e:()=>ye(n,tt(z$(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ySe={kernelName:Ab,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Da(t,_n(0)),r=_n(CT),i=_n(kT),a=ye(n,i),o=ye(ye(n,r),Jl(tt(t,"float32")));return ui(s,a,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vSe={kernelName:Ob,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(n,ye(t,_t(_n(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bSe={kernelName:Lb,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Se={kernelName:Rb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(O$(tt(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xSe={kernelName:Db,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(KH(tt(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wSe={kernelName:cT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{begin:r,size:i}=t,a=s.shape,[o,l]=NT(s,r,i),c=[];for(let h=0;h<n.rank;h++)c.push([o[h],a[h]-o[h]-l[h]]);return{x:()=>G$(n,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TSe={kernelName:fT,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{dim:r}=t,i=!0,a=ye(n,s);return{logits:()=>_t(a,ye(mt(a,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SSe={kernelName:Pb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(n,tg(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h3={kernelName:hT,gradFunc:(n,e,t)=>{const{blockShape:s,paddings:r}=t;return{x:()=>D$(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d3={kernelName:dT,gradFunc:(n,e,t)=>{const{axis:s}=t;return{x:()=>Di(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ESe={kernelName:Mb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yt(n,ye(Vr(tt(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NSe={kernelName:w$,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(n,ye(tt(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ISe={kernelName:Fb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=_n(2);return{a:()=>ye(n,ye(r,_t(t,s))),b:()=>ye(n,ye(r,_t(s,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CSe={kernelName:Ub,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kSe={kernelName:jb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Rt(t.shape,s.shape);return{a:()=>{let o=n;const l=Ys(t.shape,r);return l.length>0&&(o=mt(o,l)),_e(o,t.shape)},b:()=>{let o=n;const l=Ys(s.shape,r);return l.length>0&&(o=mt(o,l)),_e(Ts(o),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Se={kernelName:uT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,r=s.shape.slice(),{axis:i}=t;Vt(i,s.shape).forEach(c=>{r[c]=1});const o=_e(n,r),l=ye(o,id(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ASe={kernelName:Bb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yt(n,Kn(O$(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RSe={kernelName:zb,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(_t(_n(1),Kn(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DSe={kernelName:Vb,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{reps:r}=t;return{x:()=>{let a=ln(s);if(s.rank===1)for(let o=0;o<r[0];++o)a=Ke(a,zn(n,[o*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)a=Ke(a,zn(n,[o*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)a=Ke(a,zn(n,[o*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let h=0;h<r[3];++h)a=Ke(a,zn(n,[o*s.shape[0],l*s.shape[1],c*s.shape[2],h*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LSe={kernelName:cm,gradFunc:(n,e,t)=>{const s=t,{perm:r}=s,i=sd(r);return{x:()=>on(n,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OSe={kernelName:pT,gradFunc:(n,e,t)=>{const s=t,{axis:r}=s;return{value:()=>tu(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PSe={kernelName:mT,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>MSe(n,t)}}};function MSe(n,e){const t=rd(e,ln(e)),s=F$(n,t);let r=Gf(e,_n(0,"int32"));const i=s.rank-r.rank;for(let o=0;o<i;++o)r=Ai(r,o+1);r=eu(r,id(s.shape,"bool"));const a=ln(s);return ui(r,s,a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FSe={kernelName:gT,gradFunc:n=>({x:()=>ln(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jSe=[aq,Pwe,Mwe,Fwe,jwe,Bwe,zwe,Vwe,Uwe,Gwe,Wwe,Hwe,Xwe,Qwe,Jwe,eTe,tTe,nTe,sTe,rTe,iTe,aTe,lTe,oTe,hTe,dTe,fTe,pTe,mTe,gTe,aSe,yTe,vTe,bTe,_Te,xTe,TTe,wTe,STe,ETe,NTe,ITe,CTe,kTe,$Te,ATe,RTe,DTe,LTe,MTe,c3,c3,FTe,zTe,GTe,WTe,HTe,qTe,KTe,XTe,ZTe,YTe,QTe,JTe,eSe,u3,u3,tSe,nSe,iSe,oSe,lSe,cSe,uSe,hSe,dSe,fSe,pSe,mSe,gSe,ySe,vSe,bSe,_Se,xSe,wSe,TSe,SSe,h3,h3,d3,d3,ESe,ISe,NSe,CSe,kSe,$Se,ASe,RSe,DSe,LSe,OSe,PSe,FSe];for(const n of jSe)Mve(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.abs=function(){return this.throwIfDisposed(),si(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.acos=function(){return this.throwIfDisposed(),Mbe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.acosh=function(){return this.throwIfDisposed(),jbe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.add=function(n){return this.throwIfDisposed(),Ke(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.all=function(n,e){return this.throwIfDisposed(),GH(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.any=function(n,e){return this.throwIfDisposed(),XI(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.argMax=function(n){return this.throwIfDisposed(),rv(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.argMin=function(n){return this.throwIfDisposed(),Gbe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.asScalar=function(){return this.throwIfDisposed(),J(this.size===1,()=>"The array must have only 1 element."),_e(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.asType=function(n){return this.throwIfDisposed(),tt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.as1D=function(){return this.throwIfDisposed(),_e(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.as2D=function(n,e){return this.throwIfDisposed(),_e(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),_e(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.as4D=function(n,e,t,s){return this.throwIfDisposed(),_e(this,[n,e,t,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.as5D=function(n,e,t,s,r){return this.throwIfDisposed(),_e(this,[n,e,t,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.asin=function(){return this.throwIfDisposed(),Hbe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.asinh=function(){return this.throwIfDisposed(),Kbe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.atan=function(){return this.throwIfDisposed(),Zbe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.atan2=function(n){return this.throwIfDisposed(),Qbe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.atanh=function(){return this.throwIfDisposed(),e_e(this)};Pe().prototype.avgPool=function(n,e,t,s){return this.throwIfDisposed(),R$(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),D$(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.batchNorm=function(n,e,t,s,r){return this.throwIfDisposed(),xT(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.broadcastTo=function(n){return this.throwIfDisposed(),Oy(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.cast=function(n){return this.throwIfDisposed(),tt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.ceil=function(){return this.throwIfDisposed(),I_e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),Ra(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof Gs&&(n=[n]),Di([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.conv1d=function(n,e,t,s,r,i){return this.throwIfDisposed(),WH(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.conv2dTranspose=function(n,e,t,s,r){return this.throwIfDisposed(),HH(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.conv2d=function(n,e,t,s,r,i){return this.throwIfDisposed(),$f(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.cos=function(){return this.throwIfDisposed(),O$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.cosh=function(){return this.throwIfDisposed(),KH(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),YI(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),XH(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),Q_e(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.depthwiseConv2d=function(n,e,t,s,r,i){return this.throwIfDisposed(),P$(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.dilation2d=function(n,e,t,s,r){return this.throwIfDisposed(),txe(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.divNoNan=function(n){return this.throwIfDisposed(),axe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.div=function(n){return this.throwIfDisposed(),yt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.dot=function(n){return this.throwIfDisposed(),lxe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.elu=function(){return this.throwIfDisposed(),TT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.equal=function(n){return this.throwIfDisposed(),Ql(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.erf=function(){return this.throwIfDisposed(),ZH(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),_xe(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.exp=function(){return this.throwIfDisposed(),Jl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.expandDims=function(n){return this.throwIfDisposed(),Ai(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.expm1=function(){return this.throwIfDisposed(),Sxe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.fft=function(){return this.throwIfDisposed(),p5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.flatten=function(){return this.throwIfDisposed(),_e(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.floor=function(){return this.throwIfDisposed(),ET(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.floorDiv=function(n){return this.throwIfDisposed(),UH(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.gather=function(n,e,t){return this.throwIfDisposed(),F$(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.greaterEqual=function(n){return this.throwIfDisposed(),Gf(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.greater=function(n){return this.throwIfDisposed(),Da(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.ifft=function(){return this.throwIfDisposed(),QI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.irfft=function(){return this.throwIfDisposed(),J0e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.isFinite=function(){return this.throwIfDisposed(),Dxe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.isInf=function(){return this.throwIfDisposed(),Oxe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.isNaN=function(){return this.throwIfDisposed(),Mxe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.leakyRelu=function(n){return this.throwIfDisposed(),B$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.lessEqual=function(n){return this.throwIfDisposed(),ng(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.less=function(n){return this.throwIfDisposed(),n1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.localResponseNormalization=function(n,e,t,s){return this.throwIfDisposed(),Vxe(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.logSigmoid=function(){return this.throwIfDisposed(),Xxe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.logSoftmax=function(n){return this.throwIfDisposed(),t5(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),n5(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.log=function(){return this.throwIfDisposed(),ec(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.log1p=function(){return this.throwIfDisposed(),e5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.logicalAnd=function(n){return this.throwIfDisposed(),eu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.logicalNot=function(){return this.throwIfDisposed(),z$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.logicalOr=function(n){return this.throwIfDisposed(),s5(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.logicalXor=function(n){return this.throwIfDisposed(),s0e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),bn(this,n,e,t)};Pe().prototype.maxPool=function(n,e,t,s){return this.throwIfDisposed(),V$(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.max=function(n,e){return this.throwIfDisposed(),Go(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.maximum=function(n){return this.throwIfDisposed(),rd(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.mean=function(n,e){return this.throwIfDisposed(),Os(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.min=function(n,e){return this.throwIfDisposed(),t1(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.minimum=function(n){return this.throwIfDisposed(),ov(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),h0e(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.mod=function(n){return this.throwIfDisposed(),f0e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.mul=function(n){return this.throwIfDisposed(),ye(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.neg=function(){return this.throwIfDisposed(),Ts(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.norm=function(n,e,t){return this.throwIfDisposed(),ST(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.notEqual=function(n){return this.throwIfDisposed(),s1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),r5(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.onesLike=function(){return this.throwIfDisposed(),co(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.pad=function(n,e){return this.throwIfDisposed(),G$(this,n,e)};Pe().prototype.pool=function(n,e,t,s,r,i){return this.throwIfDisposed(),T0e(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.pow=function(n){return this.throwIfDisposed(),Af(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.prelu=function(n){return this.throwIfDisposed(),H$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.prod=function(n,e){return this.throwIfDisposed(),N0e(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.reciprocal=function(){return this.throwIfDisposed(),D0e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.relu=function(){return this.throwIfDisposed(),Wf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.relu6=function(){return this.throwIfDisposed(),a5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.reshapeAs=function(n){return this.throwIfDisposed(),_e(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.reshape=function(n){return this.throwIfDisposed(),_e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),b5(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),_5(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.reverse=function(n){return this.throwIfDisposed(),Rf(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.rfft=function(){return this.throwIfDisposed(),n1e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.round=function(){return this.throwIfDisposed(),o5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.rsqrt=function(){return this.throwIfDisposed(),l5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.selu=function(){return this.throwIfDisposed(),c5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.separableConv2d=function(n,e,t,s,r,i){return this.throwIfDisposed(),u5(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.sigmoid=function(){return this.throwIfDisposed(),tg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.sign=function(){return this.throwIfDisposed(),V0e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.sin=function(){return this.throwIfDisposed(),h5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.sinh=function(){return this.throwIfDisposed(),d5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.slice=function(n,e){return this.throwIfDisposed(),zn(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.softmax=function(n){return this.throwIfDisposed(),X$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.softplus=function(){return this.throwIfDisposed(),Wb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),W$(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.split=function(n,e){return this.throwIfDisposed(),$a(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.sqrt=function(){return this.throwIfDisposed(),Vr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.square=function(){return this.throwIfDisposed(),Kn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.squaredDifference=function(n){return this.throwIfDisposed(),r1e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.squeeze=function(n){return this.throwIfDisposed(),qb(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof Gs?[this,n]:[this,...n];return tu(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.step=function(n){return this.throwIfDisposed(),Kb(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.stridedSlice=function(n,e,t,s,r,i,a,o){return this.throwIfDisposed(),c1e(this,n,e,t,s,r,i,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.sub=function(n){return this.throwIfDisposed(),_t(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.sum=function(n,e){return this.throwIfDisposed(),mt(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.tan=function(){return this.throwIfDisposed(),h1e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.tanh=function(){return this.throwIfDisposed(),_T(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.tile=function(n){return this.throwIfDisposed(),Bo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.toBool=function(){return this.throwIfDisposed(),tt(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.toFloat=function(){return this.throwIfDisposed(),tt(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.toInt=function(){return this.throwIfDisposed(),tt(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.topk=function(n,e){return this.throwIfDisposed(),p1e(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.transpose=function(n){return this.throwIfDisposed(),on(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.unique=function(n){return this.throwIfDisposed(),y1e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),y5(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.unstack=function(n){return this.throwIfDisposed(),Df(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.where=function(n,e){return this.throwIfDisposed(),ui(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pe().prototype.zerosLike=function(){return this.throwIfDisposed(),ln(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Sl extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Sl.prototype)}}class io extends Error{constructor(e){super(e),Object.setPrototypeOf(this,io.prototype)}}class me extends Error{constructor(e){super(e),Object.setPrototypeOf(this,me.prototype)}}class Mt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Mt.prototype)}}class AA extends Error{constructor(e){super(e),Object.setPrototypeOf(this,AA.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lq{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lf(n,e){if(Array.isArray(n)){let t=[];for(let s=0;s<e;s++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function El(n,e){if(!n)throw new AA(e)}function f3(n,e){let t=0;for(const s of n)s===e&&t++;return t}function Ri(n){return n.length===1?n[0]:n}function En(n){return Array.isArray(n)?n:[n]}function Pc(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function qd(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let Ya={};function RA(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function tC(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>tC(e));else{const e=Object.keys(n);for(const t of e){const s=n[t];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[t]=s.value:tC(s))}}}function Qb(n,e={},t={},s="object",r=!1){if(typeof n=="string"){const i=n;let a;if(i in t)a=t[i];else if(i in Ya)a=Ya[i];else if(a=e[i],a==null)throw new me(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}else{const i=n;if(i.className==null||i.config==null)throw new me(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const a=i.className;let o,l;if(a in t?[o,l]=t[a]:a in Ya?[o,l]=Ya.className:a in e&&([o,l]=e[a]),o==null)throw new me(`Unknown ${s}: ${a}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const v of Object.keys(Ya))c[v]=Ya[v];for(const v of Object.keys(t))c[v]=t[v];const h=i.config;h.customObjects=c;const p=Object.assign({},Ya);for(const v of Object.keys(t))Ya[v]=t[v];tC(i.config);const m=l(o,i.config,t,r);return Ya=Object.assign({},p),m}else{const c=Object.assign({},Ya);for(const p of Object.keys(t))Ya[p]=t[p];const h=new o(i.config);return Ya=Object.assign({},c),h}}}function BSe(n,e){return n<e?-1:n>e?1:0}function Ix(n,e){return-1*BSe(n,e)}function Sh(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function zSe(n){if(n==null)throw new me(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function qf(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new me(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function DA(n,e,t=0,s=1/0){return El(t>=0),El(s>=t),Array.isArray(n)&&n.length>=t&&n.length<=s&&n.every(r=>typeof r===e)}function lr(n,e){Array.isArray(n)?(J(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,s)=>lr(t,`element ${s+1} of ${e}`))):J(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${cq(n)}.`)}function cq(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>cq(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function VSe(n,e,t){let s=t!=null?t():$i(),r;return(...a)=>{const o=t!=null?t():$i();return o-s<e||(s=o,r=n(...a)),r}}function uq(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let USe=0;function hq(){return USe++}const Cx={};function $T(n=""){return n in Cx||(Cx[n]=0),Cx[n]+=1,n+Cx[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const GSe=["channelsFirst","channelsLast"],WSe=["nearest","bilinear"],HSe=["valid","same","causal"],qSe=["max","avg"],KSe=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Fp=new Map;function Cs(n){qf(GSe,"DataFormat",n)}function XSe(n){qf(WSe,"InterpolationFormat",n)}function La(n){qf(HSe,"PaddingMode",n)}function dq(n){qf(qSe,"PoolMode",n)}const Py=[],p3="/";function of(n,e){Py.push(n);try{const t=e();return Py.pop(),t}catch(t){throw Py.pop(),t}}function ZSe(){return Py.length===0?"":Py.join(p3)+p3}function fq(n){if(!mq(n))throw new Error("Not a valid tensor name: '"+n+"'");return ZSe()+n}function pq(n){if(!mq(n))throw new Error("Not a valid tensor name: '"+n+"'");Fp.has(n)||Fp.set(n,0);const e=Fp.get(n);if(Fp.set(n,Fp.get(n)+1),e>0){const t=`${n}_${e}`;return Fp.set(t,1),t}else return n}const YSe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function mq(n){return!!n.match(YSe)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QSe(n){return n===parseInt(n.toString(),10)}function Eh(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let s=1;for(let r=e;r<t;++r)s*=n[r];return s}function Am(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s<e&&(e=s)}return e}function Bh(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s>e&&(e=s)}return e}function Xo(n,e){if(e<n)throw new me(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let s=n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let dN;function qs(){return dN==null&&(dN=obe().epsilon()),dN}function Zo(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zl(n,e){return tt(n,e)}function Jb(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),_e(n,t)}function JSe(n,e){return ke(()=>{if(n.shape.length!==2)throw new me(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=Jb(n,1);return nC(t,[1,e,1])})}function eEe(n){const e=[Eh(n.shape)];return _e(n,e)}function tEe(n){if(n.rank<=1)throw new me(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],Eh(n.shape,1)];return _e(n,e)}function lf(n,e,t){return ke(()=>{switch(n.rank){case 1:return q$(n,e,t);case 2:return f5(n,[e,0],[t,n.shape[1]]);case 3:return K$(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return i1(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return zn(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return zn(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new me(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function fN(n,e,t){return ke(()=>{switch(n.rank){case 1:return q$(n,e,t);case 2:return f5(n,[0,e],[n.shape[0],t]);case 3:return K$(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return i1(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new me(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function kx(n,e,t,s){return ke(()=>{switch(n.rank){case 1:return q$(n,e,t);case 2:switch(s){case 1:return lf(n,e,t);case 2:return fN(n,e,t);default:throw new me(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return lf(n,e,t);case 2:return K$(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return fN(n,e,t);default:throw new me(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return lf(n,e,t);case 2:return i1(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return i1(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return fN(n,e,t);default:throw new me(`The axis is not within the rank of the tensor ${s}`)}default:throw new me(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function LA(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),Di(n,e)}function m3(n,e){switch(n.rank){case 1:return $_e([n,e]);case 2:return R_e([n,e],0);case 3:return L_e([n,e],0);case 4:return P_e([n,e],0);default:throw new me(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function nC(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new me(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return Bo(n,e)}function AT(n,e=0,t=1,s,r){return k0e(n,e,t,s,r)}function Vl(n,e,t,s){if(n.rank<2||e.rank<2)throw new Mt(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=n.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new Mt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return t3({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?sC(n.rank,s,Zo()):null,activation:t});{const r=n.shape.slice(),i=r.pop();n=_e(n,[-1,i]);const a=e.shape.slice(),o=a.pop(),l=a.pop(),c=[...a,o],h=Array.from({length:e.rank},(x,w)=>w===0?e.rank-2:w<=e.rank-2?w-1:w);e=_e(on(e,h),[l,-1]);const p=[...r,...c];return _e(t3({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?sC(n.rank,s,Zo()):null,activation:t}),p)}}function gq(n,e,t){return ke(()=>(Array.isArray(e)?e=ta(e,"int32"):e=tt(e,"int32"),F$(n,e,t)))}function e_(n){return ye(n,n)}function sC(n,e,t){const s=e.shape;if(e.rank!==1&&e.rank!==n)throw new me(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return s.length===1?_e(e,[1,s[0],1,1,1]):_e(e,[1,s[3],s[0],s[1],s[2]]);if(t==="channelsLast")return s.length===1?_e(e,[1,1,1,1,s[0]]):_e(e,[1].concat(s))}else if(n===4){if(t==="channelsFirst")return s.length===1?_e(e,[1,s[0],1,1]):_e(e,[1,s[2],s[0],s[1]]);if(t==="channelsLast")return s.length===1?_e(e,[1,1,1,s[0]]):_e(e,[1].concat(s))}else if(n===3){if(t==="channelsFirst")return s.length===1?_e(e,[1,s[0],1]):_e(e,[1,s[1],s[0]]);if(t==="channelsLast")return s.length===1?_e(e,[1,1,s[0]]):_e(e,[1].concat(s))}else if(n<3)return e;throw new me(`Unsupported input rank by biasAdd: ${e.rank}`)}function Jo(n,e,t){return ke(()=>(t==null&&(t=Zo()),Cs(t),Ke(n,sC(n.rank,e,t))))}function nEe(n,e=1){if(e!==1)throw new Mt(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return TT(n)}function sEe(n){return ke(()=>yt(n,Ke(si(n),1)))}function yq(n,e,t,s){return ke(()=>S1e(n,e,t,s))}function rEe(n){return ke(()=>{const e=Ke(.5,ye(.2,n));return Ra(e,0,1)})}function t_(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const iEe=["fanIn","fanOut","fanAvg"],aEe=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oEe(n){qf(iEe,"FanMode",n)}function lEe(n){qf(aEe,"Distribution",n)}class fo extends rg{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class vq extends fo{apply(e,t){return or(e,t)}}vq.className="Zeros";We(vq);class OA extends fo{apply(e,t){return id(e,t)}}OA.className="Ones";We(OA);class bq extends fo{constructor(e){if(super(),typeof e!="object")throw new me(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new me(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return ke(()=>ye(_n(this.value),id(e,t)))}getConfig(){return{value:this.value}}}bq.className="Constant";We(bq);class _q extends fo{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Hb(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}_q.className="RandomUniform";We(_q);class xq extends fo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Mt(`randomNormal does not support dType ${t}.`);return AT(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}xq.className="RandomNormal";We(xq);class wq extends fo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Mt(`truncatedNormal does not support dType ${t}.`);return g5(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}wq.className="TruncatedNormal";We(wq);class Tq extends fo{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return ke(()=>{if(e.length!==2||e[0]!==e[1])throw new me("Identity matrix initializer can only be used for 2D square matrices.");return ye(this.gain,JH(e[0]))})}getConfig(){return{gain:this.gain}}}Tq.className="Identity";We(Tq);function cEe(n,e="channelsLast"){let t,s;if(Cs(e),n.length===2)t=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const r=Eh(n,2);t=n[1]*r,s=n[0]*r}else if(e==="channelsLast"){const r=Eh(n,0,n.length-2);t=n[n.length-2]*r,s=n[n.length-1]*r}}else{const r=Eh(n);t=Math.sqrt(r),s=Math.sqrt(r)}return[t,s]}class ia extends fo{constructor(e){if(super(),e.scale<0)throw new me(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,oEe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,lEe(this.distribution),this.seed=e.seed}apply(e,t){const s=cEe(e),r=s[0],i=s[1];let a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,r):this.mode==="fanOut"?a/=Math.max(1,i):a/=Math.max(1,(r+i)/2),this.distribution==="normal"){const o=Math.sqrt(a);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Mt(`${this.getClassName()} does not support dType ${t}.`);return g5(e,0,o,t,this.seed)}else{const o=Math.sqrt(3*a);return Hb(e,-o,o,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}ia.className="VarianceScaling";We(ia);class PA extends ia{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ia.className}}PA.className="GlorotUniform";We(PA);class MA extends ia{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ia.className}}MA.className="GlorotNormal";We(MA);class FA extends ia{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ia.className}}FA.className="HeNormal";We(FA);class jA extends ia{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ia.className}}jA.className="HeUniform";We(jA);class BA extends ia{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ia.className}}BA.className="LeCunNormal";We(BA);class zA extends ia{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ia.className}}zA.className="LeCunUniform";We(zA);class Sq extends fo{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return ke(()=>{if(e.length<2)throw new Mt("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const s=Me(e.slice(0,-1)),r=e[e.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const a=[Math.max(r,s),Math.min(r,s)],o=AT(a,0,1,t,this.seed),l=_we.qr(o,!1);let c=l[0];const p=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=ye(c,p.sign()),s<r&&(c=c.transpose()),ye(_n(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}Sq.className="Orthogonal";We(Sq);const g3={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function y3(n,e={}){return Qb(n,so.getMap().classNameMap,e,"initializer")}function ls(n){return RA(n)}function Jn(n){if(typeof n=="string"){const e=n in g3?g3[n]:n;if(e==="GlorotNormal")return new MA;if(e==="GlorotUniform")return new PA;if(e==="HeNormal")return new FA;if(e==="HeUniform")return new jA;if(e==="LeCunNormal")return new BA;if(e==="LeCunUniform")return new zA;{const t={};return t.className=e,t.config={},y3(t)}}else return n instanceof fo?n:y3(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rC(n){return Array.isArray(n)&&Array.isArray(n[0])}function a1(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function St(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new me(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function mn(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new me(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function o1(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const v3="Variable";class uEe{constructor(e,t="float32",s=v3,r=!0,i=null){this.dtype=t??"float32",this.shape=e.shape,this.id=hq(),s=s??v3,this.originalName=fq(s),this.name=pq(this.originalName),this.trainable_=r,this.constraint=i,this.val=_1e(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),hEe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function hEe(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function iC(n){return n.map(e=>e.read())}function VA(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ks{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class tc{constructor(e,t,s,r,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=hq(),a!=null&&(this.originalName=fq(a),this.name=pq(this.originalName)),this.rank=t.length}}let dEe=0;class RT{constructor(e,t){this.callArgs=t,this.id=dEe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s?.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let fEe=0;class Ut extends rg{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=fEe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const s=this.getClassName();t=Pc(s)+"_"+$T(s)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new io(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new me(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Ri(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Ri(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Sl(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Sl(`Layer ${this.name} is not connected, no input to return.`);return Ri(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Sl(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Sl(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ri(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=En(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=En(this.inputSpec);if(t.length!==s.length)throw new me(`Layer ${this.name} expects ${s.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let r=0;r<t.length;r++){const i=t[r],a=s[r];if(a==null)continue;const o=i.rank;if(a.ndim!=null&&o!==a.ndim)throw new me(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${o}`);if(a.maxNDim!=null&&o>a.maxNDim)throw new me(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${o}`);if(a.minNDim!=null&&o<a.minNDim)throw new me(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${o}.`);if(a.dtype!=null&&i.dtype!==a.dtype)throw new me(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${i.dtype}.`);if(a.axes){const l=i.shape;for(const c in a.axes){const h=Number(c),p=a.axes[c],m=h>=0?l[h]:l[l.length+h];if(p!=null&&[p,null].indexOf(m)===-1)throw new me(`Input ${r} is incompatible with layer ${this.name}: expected axis ${h} of input shape to have value ${p} but got shape ${l}.`)}}if(a.shape!=null)for(let l=0;l<a.shape.length;++l){const c=a.shape[l],h=i.shape[l];if(c!=null&&h!=null&&c!==h)throw new me(`Input ${r} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${i.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const s=En(e),r=gEe(e),i=yEe(e);if(r===i)throw new me("Arguments to apply() must be all SymbolicTensors or all Tensors");return of(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const a=[];for(const o of En(e))a.push(o.shape);this.build(Ri(a)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let a=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,a);const o=En(a),l=[];for(let c of o)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(a=Ri(l),this.activityRegularizer!=null)throw new Mt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}else{const a=pEe(e),o=this.computeOutputShape(a);let l;const c=mEe(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((h,p)=>new tc(c,h,this,En(e),t,this.name,p)):l=new tc(c,o,this,En(e),t,this.name),this.addInboundNode(e,l,null,null,a,o,t),this._refCount++,this.activityRegularizer!=null)throw new Mt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Sl(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const s=JSON.stringify(t.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new Sl(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new io(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return o1(this.weights)}build(e){this.built=!0}getWeights(e=!1){return iC(e?this.trainableWeights:this.weights)}setWeights(e){ke(()=>{const t=this.weights;if(t.length!==e.length)throw new me(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const s=[],r=iC(t);for(let i=0;i<r.length;++i){const a=r[i],o=t[i],l=e[i];if(!xn(a.shape,l.shape))throw new me(`Layer weight shape ${a.shape} not compatible with provided weight shape ${l.shape}`);s.push([o,l])}VA(s)})}addWeight(e,t,s,r,i,a,o,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new me(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():Jn("zeros"));const c=r.apply(t,s),h=new uEe(c,s,e,a,o);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(h.read())),a==null&&(a=!0),a?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=En(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),i=En(t),a=En(r);if(i.length!==a.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let o=0;o<i.length;o++)i[o].kerasMask=a[o]}addInboundNode(e,t,s,r,i,a,o=null){const l=En(e);t=En(t),s=En(s),r=En(r),i=a1(i),a=a1(a);const c=[],h=[],p=[];for(const m of l)c.push(m.sourceLayer),h.push(m.nodeIndex),p.push(m.tensorIndex);new RT({outboundLayer:this,inboundLayers:c,nodeIndices:h,tensorIndices:p,inputTensors:l,outputTensors:t,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:a},o);for(let m=0;m<t.length;m++)t[m].sourceLayer=this,t[m].nodeIndex=this.inboundNodes.length-1,t[m].tensorIndex=m}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function pEe(n){n=En(n);const e=[];for(const t of n)e.push(t.shape);return Ri(e)}function mEe(n){return"float32"}function Eq(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const s=e.inboundNodes[t];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const a=s.inputTensors[i],o=s.inboundLayers[i],l=s.nodeIndices[i],c=Eq(a,o,l);for(const h of c)r.indexOf(h)===-1&&r.push(h)}return r}}}function gEe(n){let e=!0;for(const t of En(n))if(!(t instanceof tc)){e=!1;break}return e}function yEe(n){let e=!0;for(const t of En(n))if(t instanceof tc){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class n_ extends Ut{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:$T("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new me("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new me("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new me("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=t,this.dtype=s,this.inputSpec=[{shape:t}];const r=new tc(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new RT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new me(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}n_.className="InputLayer";We(n_);function vEe(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new me("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new n_({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bEe(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return tt(e,n.dtype)}catch{throw new me(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class mh{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof mh)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=bEe(e,t),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new me(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof tc){if(this.id2Value[e.id]==null)throw new me(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new me(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof tc){if(this.id2Value[e.id]==null)throw new me(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new me(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&Ht(this.id2Mask)}}const l1=new lq,c1=new lq;function _Ee(n){l1?.setMaxEntries(n),c1?.setMaxEntries(n)}function wy(n,e,t,s){const r=t==null?!1:t.training,i=Array.isArray(n),a=i?n:[n],o=a.map(x=>x.name),l=[],c=e.names();for(const x of o)c.indexOf(x)!==-1?l.push(e.getValue(x)):l.push(null);const h=o.join(",")+"|"+e.names().sort().join(",");let p=l1.get(h),m;if(p==null){const x=xEe(a,e);p=x.sorted,m=x.recipientCounts,l1.put(h,p),c1.put(h,m)}m={},r||Object.assign(m,c1.get(h));const v=new mh(e);for(let x=0;x<p.length;++x){const w=p[x],T=w.sourceLayer;if(T instanceof n_)continue;const E=[],C=[],$=[];let R=!1;for(const M of w.inputs){const B=v.getValue(M),D=v.getMask(M);E.push(B),C.push(D),D!=null&&(R=!0),r||(m[M.name]--,m[M.name]===0&&!e.hasKey(M)&&o.indexOf(M.name)===-1&&!B.isDisposed&&M.sourceLayer.stateful!==!0&&$.push(B))}R&&(t=t||{},t.mask=C[0]);const P=En(T.apply(E,t));let U=null;T.supportsMasking&&(U=T.computeMask(E,C));const j=TEe(w),O=Array.isArray(j)?j:[j];for(let M=0;M<O.length;++M){v.hasKey(O[M])||v.add(O[M],P[M],Array.isArray(U)?U[0]:U);const B=o.indexOf(O[M].name);B!==-1&&(l[B]=P[M])}r||Ht($)}return v.disposeMasks(),i?l:l[0]}function xEe(n,e){J(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],s={};if(n.length===1){const r=b3(n[0],e);t=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of n){const{sorted:a,recipientMap:o}=b3(i,e);for(const l of a)r.has(l.name)||(t.push(l),r.add(l.name));for(const l in o)s[l]==null&&(s[l]=new Set),o[l].forEach(c=>s[l].add(c))}}return{sorted:t,recipientCounts:wEe(s)}}function wEe(n){const e={};for(const t in n)e[t]=n[t].size;return e}function b3(n,e){const t=new Set,s=[],r={};for(const o of e.names())t.add(o);const i=[],a=[];for(i.push(n);i.length>0;){const o=i[i.length-1];if(t.has(o.name)){i.pop();continue}const l=a[a.length-1]===i.length-1;if(o.inputs.length===0||l)i.pop(),s.push(o),t.add(o.name),l&&a.pop();else{a.push(i.length-1);for(const c of o.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(o.name),!t.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function TEe(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const r of n.sourceLayer.inboundNodes[s].outputTensors)if(r.id===n.id){t=s;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SEe=De();SEe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,_Ee);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function UA(n,e){return ke(()=>Vr(mt(ye(n,n),e,!0)))}class s_ extends rg{getConfig(){return{}}}class Nq extends s_{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ke(()=>{const t=UA(e,this.axis),s=Ra(t,0,this.maxValue);return ye(e,yt(s,Ke(qs(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}Nq.className="MaxNorm";We(Nq);class Iq extends s_{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ke(()=>yt(e,Ke(qs(),UA(e,this.axis))))}getConfig(){return{axis:this.axis}}}Iq.className="UnitNorm";We(Iq);class Cq extends s_{apply(e){return Wf(e)}}Cq.className="NonNeg";We(Cq);class kq extends s_{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ke(()=>{const t=UA(e,this.axis),s=Ke(ye(this.rate,Ra(t,this.minValue,this.maxValue)),ye(1-this.rate,t));return ye(e,yt(s,Ke(qs(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}kq.className="MinMaxNorm";We(kq);const _3={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Xs(n){return RA(n)}function x3(n,e={}){return Qb(n,so.getMap().classNameMap,e,"constraint")}function Zs(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in _3?_3[n]:n,config:{}};return x3(t)}else return n instanceof s_?n:x3(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Bd(n){if(n==null)return;const e=[],t=[],s=[];for(const r in n){const i=n[r];if(typeof i!="number"){const a=i;e.push(a.data()),t.push(r),s.push(a)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)n[t[i]]=r[i][0];Ht(s)}}function $q(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var w3;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(w3||(w3={}));const EEe=125;class cv{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class NEe{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class IEe extends cv{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const s=t.size==null?0:t.size;this.seen+=s;for(const r in t){const i=t[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let a;r in this.totals?a=this.totals[r]:this.totals[r]=0;const o=ke(()=>Ke(this.totals[r],ye(i,s)));this.totals[r]=o,a?.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?t[s]=this.totals[s]/this.seen:ke(()=>{const r=ye(yt(1,this.seen),this.totals[s]);t[s]=r,this.totals[s].dispose(),jl(t[s])}))}}class CEe extends cv{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const s in t)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(t[s])}async syncData(){const e=[],t=[],s=[];for(const i in this.history){const a=this.history[i];for(let o=0;o<a.length;++o)if(typeof a[o]!="number"){const l=a[o];e.push(l.data()),t.push(i),s.push(o)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[t[i]][s[i]].dispose(),this.history[t[i]][s[i]]=r[i][0]}}class kEe extends cv{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||O5,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=EEe),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");OI(this.yieldEvery)&&(this.maybeWait=VSe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,s){const r=[];this.yield!=null&&(await Bd(s),r.push(this.yield(e,t,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Bd(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const s=[];this.epochEnd!=null&&(await Bd(t),s.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Bd(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const s=[];this.batchEnd!=null&&(await Bd(t),s.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):OI(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await Bd(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Bd(e),await this.trainEnd(e))}}function Aq(n,e){return n==null&&(n={}),n instanceof cv?[n]:Array.isArray(n)&&n[0]instanceof cv?n:En(n).map(s=>new kEe(s,e))}class eo{constructor(){}static registerCallbackConstructor(e,t){J(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),eo.checkForDuplicate(t),eo.constructors[e]==null&&(eo.constructors[e]=[]),eo.constructors[e].push(t)}static checkForDuplicate(e){for(const t in eo.constructors)eo.constructors[+t].forEach(r=>{if(r===e)throw new me("Duplicate callback constructor.")})}static clear(){eo.constructors={}}static createCallbacks(e){const t=[];for(const s in eo.constructors){const r=+s;e>=r&&t.push(...eo.constructors[r])}return t.map(s=>new s)}}eo.constructors={};function Rq(n,e,t,s,r,i,a,o,l){const c=new CEe,h=[new IEe,...eo.createCallbacks(e)];n!=null&&h.push(...n),h.push(c);const p=new NEe(h);return p.setParams({epochs:t,initialEpoch:s,samples:r,steps:i,batchSize:a,verbose:e,doValidation:o,metrics:l}),{callbackList:p,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qc(n,e={},t=!1){return Qb(n,so.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function u1(n,e){return ke(()=>{n.dtype!=="float32"&&(n=tt(n,"float32"));const t=mt(e_(n),e,!0),s=wT(t.shape,qs()),r=Vr(rd(t,s));return yt(n,r)})}function DT(n,e){return ke(()=>Os(e_(_t(e,n)),-1))}function GA(n,e){return ke(()=>Os(si(_t(e,n)),-1))}function WA(n,e){return ke(()=>{const t=_t(n,e),s=Ra(si(n),qs(),Number.MAX_VALUE),r=si(yt(t,s));return ye(100,Os(r,-1))})}function $Ee(n,e){return ke(()=>{const t=Ra(e,qs(),Number.MAX_VALUE),s=ec(Ke(1,t)),r=Ra(n,qs(),Number.MAX_VALUE),i=ec(Ke(1,r));return Os(e_(_t(s,i)),-1)})}function AEe(n,e){return ke(()=>{const t=rd(0,_t(1,ye(n,e)));return Os(e_(t),-1)})}function REe(n,e){return ke(()=>{const t=rd(0,_t(1,ye(n,e)));return Os(t,-1)})}function DEe(n,e){return ke(()=>{const t=mt(ye(n,e),-1),s=Go(ye(_t(1,n),e),-1);return rd(0,Ke(1,_t(s,t)))})}function LEe(n,e){return ke(()=>{const t=Math.log(2),s=_t(e,n),r=_t(Ke(s,Wb(ye(-2,s))),t);return Os(r,-1)})}function uv(n,e,t=!1){return ke(()=>{if(t)e=X$(e);else{const s=mt(e,e.shape.length-1,!0);e=yt(e,s)}return e=Ra(e,qs(),1-qs()),Ts(mt(ye(tt(n,"float32"),ec(e)),e.shape.length-1))})}function h1(n,e,t=!1){return ke(()=>{const s=tt(ET(eEe(n)),"int32");e=Ra(e,qs(),1-qs());const r=e.shape,i=_e(r5(s,r[r.length-1]),r);return uv(i,e,t)})}function OEe(n,e){if(!xn(n.shape,e.shape))throw new me(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return ke(()=>{const t=Wf(e),s=Ts(si(e));return Ke(_t(t,ye(e,n)),e5(Jl(s)))})}function LT(n,e){return ke(()=>{let t;return t=Ra(e,qs(),1-qs()),t=ec(yt(t,_t(1,t))),Os(OEe(n,t),-1)})}function PEe(n,e){return ke(()=>{const t=Ra(n,qs(),1),s=Ra(e,qs(),1);return mt(ye(n,ec(yt(t,s))),-1)})}function MEe(n,e){return ke(()=>{const t=ec(Ke(qs(),e));return Os(_t(e,ye(n,t)),-1)})}function Dq(n,e){return ke(()=>{const t=u1(n,-1),s=u1(e,-1),r=ye(t,s);return Ts(mt(r,-1))})}const d1={meanSquaredError:DT,meanAbsoluteError:GA,meanAbsolutePercentageError:WA,meanSquaredLogarithmicError:$Ee,squaredHinge:AEe,hinge:REe,categoricalHinge:DEe,logcosh:LEe,categoricalCrossentropy:uv,sparseCategoricalCrossentropy:h1,binaryCrossentropy:LT,kullbackLeiblerDivergence:PEe,poisson:MEe,cosineProximity:Dq};function pN(n){if(typeof n=="string"){if(n in d1)return d1[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new me(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lq(n,e){return ke(()=>{const t=ye(.5,co(e)),s=zl(Da(e,t),n.dtype);return Os(Ql(n,s),-1)})}function Oq(n,e){return ke(()=>zl(Ql(rv(n,-1),rv(e,-1)),"float32"))}function FEe(n,e){return ke(()=>tt(mt(eu(Ql(n,1),Ql(e,1))),"float32"))}function jEe(n,e){return ke(()=>tt(mt(eu(Ql(n,0),Ql(e,1))),"float32"))}function BEe(n,e){return ke(()=>{const t=FEe(n,e),s=jEe(n,e),r=Ke(t,s);return tt(ui(Da(r,0),yt(t,r),0),"float32")})}function zEe(n,e){return LT(n,e)}function VEe(n,e){return n.rank===e.rank&&(n=qb(n,[n.rank-1])),e=rv(e,-1),e.dtype!==n.dtype&&(e=tt(e,n.dtype)),tt(Ql(n,e),"float32")}const UEe=DT,GEe=DT,WEe=GA,HEe=GA,qEe=WA,KEe=WA,Pq=uv,XEe=Dq,Mq=h1,f1={binaryAccuracy:Lq,categoricalAccuracy:Oq,precision:BEe,categoricalCrossentropy:Pq,sparseCategoricalCrossentropy:Mq,mse:UEe,MSE:GEe,mae:WEe,MAE:HEe,mape:qEe,MAPE:KEe,cosine:XEe};function ZEe(n){if(typeof n=="string"&&n in f1)return f1[n];if(typeof n!="string"&&n!=null)return n;throw new me(`Unknown metric ${n}`)}function $x(n){if(El(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(d1))if(d1[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(f1))if(f1[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function YEe(n){const e={Adagrad:()=>Mp.adagrad(.01),Adadelta:()=>Mp.adadelta(1,.95,qs()),Adam:()=>Mp.adam(.001,.9,.999,qs()),Adamax:()=>Mp.adamax(.002,.9,.999,qs(),0),RMSProp:()=>Mp.rmsprop(.001,.9,0,qs()),SGD:()=>Mp.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new me(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const T3=1*1024*1024;function S3(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!aC(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const s=JSON.stringify(n);s.length>T3&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${T3}.`)}}function aC(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!aC(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!aC(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QEe(n,e,t,s=console.log){const r=eNe(n),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(h=>Math.floor(e*h)));let a;if(!r){i.push("Receives inputs"),a=[];for(const h in n.nodesByDepth)a.push(...n.nodesByDepth[h])}s("_".repeat(e)),p1(i,t,s),s("=".repeat(e));const o=n.layers;for(let h=0;h<o.length;++h)r?tNe(o[h],t,s):nNe(o[h],t,a,s),s((h===o.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const l=JEe(n),c=o1(n.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function JEe(n){let e;return n.collectedTrainableWeights!=null?e=o1(n.collectedTrainableWeights):e=o1(n.trainableWeights),e}function eNe(n){let e=!0;const t=[],s=[];for(const r in n.nodesByDepth)t.push(n.nodesByDepth[r]);for(const r of t){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of n.layers){let i=!1;for(const a of r.inboundNodes)if(s.indexOf(a)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function p1(n,e,t=console.log){let s="";for(let r=0;r<n.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=n[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);t(s)}function tNe(n,e,t){let s,r;try{r=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const i=n.name,a=n.getClassName(),o=[`${i} (${a})`,r,s,n.countParams().toString()];p1(o,e,t)}function nNe(n,e,t,s){let r,i;try{i=n.inboundNodes.map(p=>JSON.stringify(p.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const a=[];for(const p of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(p)===-1))for(let m=0;m<p.inboundLayers.length;++m){const v=p.inboundLayers[m].name,x=p.nodeIndices[m],w=p.tensorIndices[m];a.push(`${v}[${x}][${w}]`)}const o=n.name,l=n.getClassName(),c=a.length===0?"":a[0],h=[`${o} (${l})`,i,r,n.countParams().toString(),c];p1(h,e,s);for(let p=1;p<a.length;++p)p1(["","","","",a[p]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Fq(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function oC(n,e){if(n===null)return null;if(typeof n=="string")return qd(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const i=n[r];Fq(e,r,i)?t.push(i):t.push(oC(i,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s];if(s==="name"&&typeof r=="string")t[s]=r;else{const i=qd(s);t[i]=oC(r,i)}}return t}}function lC(n,e){if(n==null)return null;if(typeof n=="string")return Pc(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const i=n[r];Fq(e,r,i)?t.push(i):t.push(lC(i,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s],i=Pc(s);(s==="name"||s==="className")&&typeof r=="string"?t[i]=r:t[i]=lC(r,s)}return t}}/** @license See the LICENSE file. */const jq="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const sNe=n=>{const e=Object.keys(n);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class Oo extends Ut{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const C=this.getClassName().toLowerCase();this.name=$T(C)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Sh(this.inputs).length!==this.inputs.length)throw new me(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(C=>C.name)}`);Sh(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(C=>C.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const C of this.outputs){const $=C.sourceLayer,R=C.nodeIndex,P=C.tensorIndex;this.outputLayers.push($),this.outputLayersNodeIndices.push(R),this.outputLayersTensorIndices.push(P)}for(const C of this.inputs){const $=C.sourceLayer,R=C.nodeIndex,P=C.tensorIndex;El(R===0,"input layer has >1 nodes"),El(P===0,"input layer has >1 tensors"),this.inputLayers.push($),this.inputLayersNodeIndices.push(R),this.inputLayersTensorIndices.push(P)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let C=0;C<this.inputLayers.length;C++){const $=this.inputLayers[C];if(!($ instanceof n_))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${C} (0-based) originates from layer type ${$.getClassName()}.`);this.inputNames.push($.name),this.feedInputShapes.push($.batchInputShape),this.feedInputNames.push($.name)}for(const C of this.outputLayers)this.outputNames.push(C.name);this.internalInputShapes=this.inputs.map(C=>C.shape),this.internalOutputShapes=this.outputs.map(C=>C.shape);const t={},s={},r={},i={},a={},o=[],l=(C,$,R,P,U,j)=>{(P==null||U==null||j==null)&&(P=C.sourceLayer,U=C.nodeIndex,j=C.tensorIndex);const O=P.inboundNodes[U];if(R.indexOf(O)!==-1)throw new io(`The tensor ${C.name} at layer "${P.name}" is part of a cycle.`);if($.indexOf(O)!==-1)return;this.containerNodes.add(Oo.nodeKey(P,U)),P.id in a||(a[P.id]=Object.keys(a).length),R.indexOf(O)===-1&&R.push(O);const M=O.inboundLayers.length;for(let B=0;B<M;B++){const D=O.inputTensors[B],W=O.inboundLayers[B],H=O.nodeIndices[B],ae=O.tensorIndices[B];l(D,$,R,W,H,ae)}for($.push(O);R.indexOf(O)>=0;)R.splice(R.indexOf(O),1);o.push(O)},c=[],h=[];for(const C of this.outputs)l(C,c,h);const p=o.slice().reverse();for(const C of p){s[C.id]=C,C.id in t||(t[C.id]=0);let $=t[C.id];const R=r[C.outboundLayer.id]==null?0:r[C.outboundLayer.id];$=Math.max($,R),r[C.outboundLayer.id]=$,i[C.outboundLayer.id]=C.outboundLayer,t[C.id]=$;for(let P=0;P<C.inboundLayers.length;P++){const U=C.inboundLayers[P],j=C.nodeIndices[P],O=U.inboundNodes[j],M=t[O.id]==null?0:t[O.id];t[O.id]=Math.max($+1,M),s[O.id]=O}}const m={};for(const C in t){const $=t[C];$ in m||(m[$]=[]),m[$].push(s[C])}const v={};for(const C in r){const $=r[C];$ in v||(v[$]=[]),v[$].push(i[C])}let x=Object.keys(v).map(C=>parseInt(C,10)).sort(Ix);this.layers=[];for(const C of x){const $=v[C];$.sort((R,P)=>{const U=a[R.id],j=a[P.id];return U<j?-1:U>j?1:0});for(const R of $)R instanceof Oo&&this.internalContainerRefs.push(R),this.layers.push(R)}this.layersByDepth=v,x=Object.keys(m).map(C=>parseInt(C,10)).sort(Ix);const w=this.inputs.slice(),T=[];for(const C of x)for(const $ of m[C]){const R=$.outboundLayer;if(R!=null){for(const P of $.inputTensors)if(w.indexOf(P)===-1)throw new io(`Graph disconnected: cannot obtain value for tensor ${P} at layer "${R.name}". The following previous layers were accessed without issue: ${T}`);for(const P of $.outputTensors)w.push(P);T.push(R.name)}}this.nodesByDepth=m;const E=this.layers.map(C=>C.name);for(const C of E){const $=E.filter(R=>R===C).length;if($!==1)throw new io(`The name "${C}" is used ${$} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(E))}this.outboundNodes=[],this.inboundNodes=[],new RT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(C=>null),outputMasks:this.outputs.map(C=>null),inputShapes:this.inputs.map(C=>C.shape),outputShapes:this.outputs.map(C=>C.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new me("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.layers)t.push(...s.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const s={};let r=0;const i=sNe(e);i&&this.parseWeights(e);for(const o of this.layers)for(const[l,c]of o.weights.entries()){const h=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[h]!=null)throw new me(`Duplicate weight name: ${h}`);s[h]=c,r++}const a=[];for(const o in e){let l=o;if(s[o]==null){const c=o.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)a.push([s[l],e[o]]);else if(t)throw new me(`Provided weight data has no target variable: ${o}`);delete s[l]}if(t){const o=[];for(const l in s)o.push(l);if(o.length>0)throw new me(`${o.length} of ${r} weights are not set: ${o}`)}VA(a)}parseWeights(e){for(const t in Object.keys(e)){const s=t.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(a=>a.startsWith("_")?a.slice(1):a).filter(a=>!r.includes(a)).join("/");i!==t&&(e[i]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${jq}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const s=lC(this.updatedConfig());return t?JSON.stringify(s):s}call(e,t){return ke(()=>{e=En(e);const s=new mh;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return wy(this.outputs,s,t)})}computeMask(e,t){return ke(()=>{e=En(e);let s;return t==null?s=Lf(null,e.length):s=En(t),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const t=a1(e);if(t.length!==this.inputLayers.length)throw new me(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let o=0;o<t.length;o++){const l=this.inputLayers[o],c=t[o],h=l.name+"_0_0";s[h]=c}const r=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(Ix);if(r.length>1)for(const o of r){const l=this.nodesByDepth[o];for(const c of l){const h=c.outboundLayer;if(this.inputLayers.map(w=>w.id).indexOf(h.id)!==-1)continue;const p=[];for(let w=0;w<c.inboundLayers.length;w++){const T=c.inboundLayers[w],E=c.nodeIndices[w],C=c.tensorIndices[w],$=`${T.name}_${E}_${C}`,R=s[$];p.push(R)}const m=h.computeOutputShape(Ri(p)),v=a1(m),x=h.inboundNodes.indexOf(c);for(let w=0;w<v.length;w++){const T=`${h.name}_${x}_${w}`;s[T]=v[w]}}}const i=[],a=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],h=this.outputLayersTensorIndices[o],p=`${l.name}_${c}_${h}`;a.push(p)}for(let o=0;o<a.length;o++){const l=a[o];El(l in s),i.push(s[l])}return Ri(i)}runInternalGraph(e,t){t==null&&(t=Lf(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],h=e[l],p=t[l];s[c.id]=[h,p]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Ix);for(const l of r){const c=this.nodesByDepth[l];for(const h of c){const p=h.outboundLayer,m=h.inputTensors,v=h.outputTensors,x=new Array;for(const w of m)w.id in s&&x.push(s[w.id]);if(x.length===m.length){let w={},T,E,C,$;if(h.callArgs!=null&&(w=h.callArgs),x.length===1){const[R,P]=x[0];w.mask==null&&(w.mask=P),C=En(p.call(R,w)),$=En(p.computeMask(R,P)),T=[R],E=[P]}else T=x.map(R=>R[0]),E=x.map(R=>R[1]),w.mask==null&&(w.mask=E),C=En(p.call(T,w)),$=En(p.computeMask(T,E));if(p.activityRegularizer)throw new Mt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let R=0;R<v.length;++R){const P=v[R],U=C[R],j=$[R];s[P.id]=[U,j]}}}}const i=[],a=[],o=[];for(const l of this.outputs){El(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,h]=s[l.id];o.push(c.shape),i.push(c),a.push(h)}return[i,a,o]}buildNodeConversionMap(e){const t={};let s;for(const r of this.layers){s=r instanceof Oo?1:0;for(let i=0;i<r.inboundNodes.length;i++){const a=Oo.nodeKey(r,i);this.containerNodes.has(a)&&(t[a]=s,s+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new me("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new me(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new me(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return ke(()=>{const e=[];for(const t of this.layers)for(let s=0;s<t.inboundNodes.length;++s){const r=Oo.nodeKey(t,s);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),s=[];for(const a of this.layers){const o=a.getClassName(),l=a.getConfig(),c=[];for(let p=0;p<a.inboundNodes.length;p++){const m=a.inboundNodes[p],v=Oo.nodeKey(a,p);let x={};if(this.containerNodes.has(v)){if(m.callArgs)try{JSON.stringify(m.callArgs),x=m.callArgs}catch{console.warn(`Layer ${a.name} was passed non-serializable keyword arguments: ${m.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),x={}}if(m.inboundLayers.length>0){const w=[];for(let T=0;T<m.inboundLayers.length;T++){const E=m.inboundLayers[T],C=m.nodeIndices[T],$=m.tensorIndices[T],R=Oo.nodeKey(E,C);let P=t[R];P==null&&(P=0),w.push([E.name,P,$,x])}c.push(w)}}}const h={};h.name=a.name,h.className=o,h.config=l,h.inboundNodes=c,s.push(h)}e.layers=s;const r=[];for(let a=0;a<this.inputLayers.length;a++){const o=this.inputLayers[a],l=this.inputLayersNodeIndices[a],c=Oo.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let h=t[c];h==null&&(h=0);const p=this.inputLayersTensorIndices[a];r.push([o.name,h,p])}e.inputLayers=r;const i=[];for(let a=0;a<this.outputLayers.length;a++){const o=this.outputLayers[a],l=this.outputLayersNodeIndices[a],c=Oo.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let h=t[c];h==null&&(h=0);const p=this.outputLayersTensorIndices[a];i.push([o.name,h,p])}return e.outputLayers=i,e}static fromConfig(e,t,s={},r=!1){const i={},a={};function o(T,E){T.name in a?a[T.name].push(E):a[T.name]=[E]}function l(T,E){const C=[];let $;for(const R of E){const P=R[0],U=R[1],j=R[2];if($=R[3]==null?{}:R[3],!(P in i)){o(T,E);return}const O=i[P];if(O.inboundNodes.length<=U){o(T,E);return}const M=O.inboundNodes[U];C.push(M.outputTensors[j])}C.length>0&&T.apply(Ri(C),$)}function c(T){const E=T.name,C=qc(T,t.customObjects!=null?t.customObjects:{});C.setFastWeightInitDuringBuild(r),i[E]=C,T.inboundNodes.forEach(R=>{if(!(R instanceof Array))throw new me(`Corrupted configuration, expected array for nodeData: ${R}`);o(C,R)})}const h=t.name,p=t.layers;for(const T of p)c(T);for(;!zSe(a);)for(const T of p){const E=i[T.name];if(E.name in a){const C=a[E.name];delete a[E.name];for(const $ of C)l(E,$)}}const m=[],v=[],x=t.inputLayers;for(const T of x){const E=T[0],C=T[1],$=T[2];El(E in i);const P=i[E].inboundNodes[C].outputTensors;m.push(P[$])}const w=t.outputLayers;for(const T of w){const E=T[0],C=T[1],$=T[2];El(E in i);const P=i[E].inboundNodes[C].outputTensors;v.push(P[$])}return new e({inputs:m,outputs:v,name:h})}get stateful(){if(this._stateful)throw new me("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){ke(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rNe(n,e,t){const s=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const r=[];return e.forEach(i=>{i in n?r.push(n[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${t} must be either an array with ${s} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function Bq(n,e){return rNe(n,e,"classWeight")}async function zq(n,e,t,s){if(t!=null){const r=ke(()=>{if(n.shape.length===1)return af(n);if(n.shape.length===2){if(n.shape[1]>1)return rv(n,1);if(n.shape[1]===1)return _e(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());Ht(r);const a=[];return i.forEach(o=>{if(t[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);a.push(t[o])}),ta(a,"float32")}else return null}function iNe(n,e){return ye(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const aNe=32;function Vq(n,e){let t,s;const r=e;t=r.xs,s=r.ys,J(t!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=E3("input",n.inputNames,t),a=E3("output",n.outputNames,s),o=i[0].shape[0];J(i.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),J(a.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<i.length;l++)J(i[l].shape[0]===o,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);for(let l=0;l<a.length;l++)J(a[l].shape[0]===o,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);return{xs:i,ys:a}}function E3(n,e,t){if(t instanceof Gs)return[t];if(Array.isArray(t))return J(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const s=[];for(const r of e){if(t[r]==null)throw new me(`The feature data generated by the dataset lacks the required ${n} key '${r}'.`);s.push(t[r])}return s}}function oNe(n){if(n.length===3)throw new Mt("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function lNe(n,e,t){const s=t.batchesPerEpoch!=null;if(J(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),J(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),J(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),J(!s||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),J(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const r=t.validationData!=null;let i,a;if(r)if(N3(t.validationData))J(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const T=oNe(t.validationData);i=T.xs,a=T.ys}const o=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(T=>"val_"+T)):c=l.slice();const h=Aq(t.callbacks,t.yieldEvery),p=t.verbose==null?1:t.verbose,{callbackList:m,history:v}=Rq(h,p,t.epochs,null,null,cNe(e,t),null,r,c);m.setModel(n),n.history=v,await m.onTrainBegin(),n.stopTraining_=!1;let x=t.initialEpoch==null?0:t.initialEpoch,w=await e.iterator();for(;x<t.epochs;){const T={};await m.onEpochBegin(x);let E=0,C=0;for(s||(w=await e.iterator());!s||E<t.batchesPerEpoch;){const $=await w.next();if(s&&$.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${E} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if($.value!=null){const{xs:R,ys:P}=Vq(n,$.value),U={};U.batch=C,U.size=R[0].shape[0],await m.onBatchBegin(C,U);const j=[];if(t.classWeight!=null){const B=Bq(t.classWeight,n.outputNames);for(let D=0;D<B.length;++D)j.push(await zq(P[D],null,B[D]))}const O=R.concat(P).concat(j),M=o(O);Ht(O);for(let B=0;B<l.length;++B){const D=l[B],W=M[B];U[D]=W,jl(W)}await m.onBatchEnd(C,U),$q(U),C++,E++}if(s?E>=t.batchesPerEpoch:$.done){if(r){let R;N3(t.validationData)?R=En(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):R=En(n.evaluate(i,a,{batchSize:t.validationBatchSize==null?aNe:t.validationBatchSize,verbose:0}));for(let P=0;P<n.metricsNames.length;++P)T[`val_${n.metricsNames[P]}`]=R[P]}break}if(n.stopTraining_)break}if(await m.onEpochEnd(x,T),x++,n.stopTraining_)break}return await m.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function cNe(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function N3(n){return typeof n.iterator=="function"}function uNe(n){return typeof n.next=="function"}async function hNe(n,e,t){t=t||{};const s=t.batches!=null,r=n.testFunction;let i=[];if(t.verbose>0)throw new Mt("Verbose mode is not implemented yet.");J(!s||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const a=uNe(e)?e:await e.iterator();let o=0,l=0;for(;!s||l<t.batches;){const c=await a.next();if(i=ke(()=>{if(c.value){const{xs:h,ys:p}=Vq(n,c.value),m=h.concat(p),v=ke(()=>r(m));if(Ht(m),l===0)for(let w=0;w<v.length;++w)i.push(_n(0));const x=m[0].shape[0];for(let w=0;w<v.length;++w){const T=v[w],E=i[w];i[w]=ke(()=>Ke(i[w],ye(x,T))),l>0&&Ht(E)}Ht(v),o+=x,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const h=i[c];i[c]=yt(i[c],o),Ht(h)}return Ri(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mN(n){J(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function cy(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(s=>lf(s,e,t-e)):lf(n,e,t-e)}function cC(n,e){return ke(()=>n==null?null:Array.isArray(n)?n.map(t=>cC(t,e)):gq(n,e.dtype==="int32"?e:tt(e,"int32")))}function gN(n,e){const t=[];let s=0,r=null;for(;s<n;)r=s+e,r>=n&&(r=n),t.push([s,r]),s=r;return t}function Uq(n){const e=[];n instanceof Gs&&(n=[n]);for(let t=0;t<n.length;++t){const s=n[t];if(s.rank===1)e.push(Jb(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Do(n,e){if(n==null)return;const t=[];if(e instanceof Gs)t.push(e.id);else if(Array.isArray(e))e.forEach(r=>t.push(r.id));else if(e!=null)for(const r in e){const i=e[r];t.push(i.id)}const s=[];if(n instanceof Gs)t.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(r=>{t.indexOf(r.id)===-1&&s.push(r)});else if(n!=null)for(const r in n){const i=n[r];t.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dNe(n){return n instanceof Gs}function uC(n){return Array.isArray(n)}function I3(n){return!dNe(n)&&!uC(n)}function C3(n,e,t,s=!0,r=""){if(e==null||e.length===0){if(n!=null){let a=!1;if(uC(n)&&n.length>0)a=!0;else if(I3(n)){for(const o in n)if(n.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new me(`Error when checking model ${r} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(a=>null);let i;if(I3(n)){n=n,i=[];for(const a of e){if(n[a]==null)throw new me(`No data provided for "${a}". Need data for each key in: ${e}`);i.push(n[a])}}else if(uC(n)){if(n=n,n.length!==e.length)throw new me(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);i=n}else{if(n=n,e.length>1)throw new me(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);i=[n]}if(i=Uq(i),t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const o=i[a];if(o.shape.length!==t[a].length)throw new me(`Error when checking ${r}: expected ${e[a]} to have ${t[a].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<t[a].length;++l){if(l===0&&!s)continue;const c=o.shape[l],h=t[a][l];if(h!=null&&h>=0&&c!==h)throw new me(`${r} expected a batch of elements where each example has shape [${t[a].slice(1,t[a].length)}] (i.e.,tensor shape [*,${t[a].slice(1,t[a].length)}]) but the ${r} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return i}function fNe(n,e,t){const s=Sh(n.map(i=>i.shape[0]));s.sort();const r=Sh(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new me(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(i=>i.shape))}`);if(r.length>1)throw new me(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!xn(s,r))throw new me(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function pNe(n,e,t){const s=[DT,LT,uv];for(let r=0;r<n.length;++r){const i=n[r],a=e[r],o=t[r];if(a!=null){if(a===uv&&i.shape[i.shape.length-1]===1)throw new me(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(a)!==-1){const l=i.shape.slice(1),c=o.slice(1);for(let h=0;h<l.length;++h){const p=l[h],m=c[h];if(m!=null&&p!==m)throw new me(`A target Tensor with shape ${i.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function k3(n,e,t,s=!0,r=""){let i;if(Array.isArray(n)){if(n.length!==e.length)throw new me(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);i=n}else{if(e.length>1)throw new me(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);i=[n]}if(t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const o=i[a];if(o.shape.length!==t[a].length)throw new me(`Error when checking ${r}: expected ${e[a]} to have ${t[a].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<t[a].length;++l){if(l===0&&!s)continue;const c=o.shape[l],h=t[a][l];if(h!=null&&h!==c)throw new me(`Error when checking ${r}: expected ${e[a]} to have shape ${JSON.stringify(t[a])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function mNe(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(s=>t);{const s=[];for(const r of e){let i=t.hasOwnProperty(r)?t[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const gNe="layers-model";class hm extends Oo{constructor(e){super(e),this.isTraining=!1}summary(e,t,s=console.log){if(!this.built)throw new me("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");QEe(this,e,t,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=YEe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ad))throw new me("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new me(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),t.push(pN(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new me(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(o=>pN(o))}else{const a=pN(e.loss);this.outputs.forEach(o=>{t.push(a)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const o=this.internalOutputShapes[a],l=this.outputNames[a];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[a])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],of("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(s.indexOf(a)!==-1)continue;const o=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([o,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});const r=mNe(e.metrics,this.outputNames),i=(a,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[a]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,a])};of("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(s.indexOf(a)!==-1)continue;const o=r[a];(c=>{let p,m,v;for(const x of c){if(typeof x=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(x)!==-1){const T=this.internalOutputShapes[a];T[T.length-1]===1||this.lossFunctions[a]===LT?["accuracy","acc"].indexOf(x)!==-1?m=Lq:["crossentropy","ce"].indexOf(x)!==-1&&(m=zEe):this.lossFunctions[a]===h1?["accuracy","acc"].indexOf(x)!==-1?m=VEe:["crossentropy","ce"].indexOf(x)!==-1&&(m=Mq):["accuracy","acc"].indexOf(x)!==-1?m=Oq:["crossentropy","ce"].indexOf(x)!==-1&&(m=Pq);let E;["accuracy","acc"].indexOf(x)!==-1?E="acc":["crossentropy","ce"].indexOf(x)!==-1&&(E="ce"),v=m,p=""+E}else v=ZEe(x),p=""+$x(x);let w;of(p,()=>{w=v}),i(a,p,w)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,s={}){const r=s.batchSize==null?32:s.batchSize;mN(r);const a=this.standardizeUserDataXY(e,t,!0,r);try{const o=a[0].concat(a[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,o,r,s.verbose,s.steps);return Ri(c)}finally{Do(a[0],e),Do(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),hNe(this,e,t)}checkNumSamples(e,t,s,r="steps"){let i;if(s!=null){if(i=null,t!=null)throw new me(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new me(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new me("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(t),r=s?t:[t],i=this.retrieveSymbolicTensors(r),a=new mh;if(e instanceof Gs&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new me(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)a.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new me(`No value is provided for the model's input ${l.name}`);a.add(l,c)}const o=wy(i,a);return s?o:o[0]}retrieveSymbolicTensors(e){const t=Lf(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],a=i.map(o=>o.name);for(let o=0;o<e.length;++o){const l=a.indexOf(e[o]);if(l!==-1&&(t[o]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw t.forEach((i,a)=>{i==null&&r.push(e[a])}),new me(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return t}predictLoop(e,t=32,s=!1){return ke(()=>{const r=this.checkNumSamples(e);if(s)throw new Mt("Verbose predictLoop() is not implemented yet.");const i=gN(r,t),a=this.outputs.map(o=>[]);for(let o=0;o<i.length;++o)ke(()=>{const c=i[o][0],h=i[o][1],p=cy(e,c,h),m=[];if(Array.isArray(p))for(let x=0;x<p.length;++x)m.push({key:this.inputs[x],value:p[x]});else m.push({key:this.inputs[0],value:p});const v=new mh(m);return wy(this.outputs,v)}).forEach((c,h)=>a[h].push(c));return Ri(a.map(o=>Di(o,0)))})}predict(e,t={}){const s=Uq(e);k3(s,this.inputNames,this.feedInputShapes,!1);try{const r=t.batchSize==null?32:t.batchSize;return mN(r),this.predictLoop(s,r)}finally{Do(s,e)}}predictOnBatch(e){k3(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,s=!0,r){if(this.optimizer_==null)throw new io("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let a=0;a<this.feedOutputShapes.length;++a){const o=this.feedOutputShapes[a];this.feedLossFns[a]===h1?i.push(o.slice(0,o.length-1).concat([1])):i.push(o)}if(e=C3(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=C3(t,this.feedOutputNames,i,!1,"target"),fNe(e,t),pNe(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new me(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,s,r,i=!0,a){const[o,l]=this.standardizeUserDataXY(e,t,i,a);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const h=Bq(r,this.outputNames);c=[];for(let p=0;p<h.length;++p)c.push(await zq(l[p],null,h[p]))}return[o,l,c]}testLoop(e,t,s,r=0,i){return ke(()=>{const a=this.checkNumSamples(t,s,i,"steps"),o=[];if(r>0)throw new Mt("Verbose mode is not implemented yet.");if(i!=null)throw new Mt("steps mode in testLoop() is not implemented yet");{const l=gN(a,s),c=ta(Xo(0,a));for(let h=0;h<l.length;++h){const p=l[h][0],m=l[h][1],v=lf(c,p,m-p),x=cC(t,v),w=e(x);if(h===0)for(let T=0;T<w.length;++T)o.push(_n(0));for(let T=0;T<w.length;++T){const E=w[T];o[T]=Ke(o[T],ye(m-p,E))}}for(let h=0;h<o.length;++h)o[h]=yt(o[h],a)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(f3(e,r)>1){const a=f3(e.slice(0,s),r);i+=`_${a}`}t.push(i)}return t}makeTrainFunction(){return e=>{const t=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],o=()=>{const p=[];for(let w=0;w<this.inputs.length;++w)p.push({key:this.inputs[w],value:s[w]});const m=new mh(p),v=wy(this.outputs,m,{training:!0});let x;for(let w=0;w<this.lossFunctions.length;++w){const T=this.lossFunctions[w];let E=T(r[w],v[w]);i[w]!=null&&(E=iNe(E,i[w]));const C=Os(E);t.push(C),w===0?x=E:x=Ke(x,E)}for(let w=0;w<this.metricsTensors.length;++w){let T;if(this.outputs.length>1&&w<this.outputs.length)T=t[w];else{const E=this.metricsTensors[w][0],C=this.metricsTensors[w][1];T=Os(E(r[C],v[C]))}jl(T),a.push(T)}return x=Os(x),this.calculateLosses().forEach(w=>{x=Ke(x,w)}),x},l=this.collectedTrainableWeights.map(p=>p.read());return[this.optimizer_.minimize(o,!0,l)].concat(a)}}makeTestFunction(){this.testFunction=e=>ke(()=>{const t=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let c=0;c<this.inputs.length;++c)a.push({key:this.inputs[c],value:r[c]});const o=new mh(a),l=wy(this.outputs,o);for(let c=0;c<this.lossFunctions.length;++c){const h=this.lossFunctions[c],p=Os(h(i[c],l[c]));c===0?s=p:s=Ke(s,p),t.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const h=this.metricsTensors[c][0],p=this.metricsTensors[c][1],m=Os(h(i[p],l[p]));t.push(m)}return t})}async fit(e,t,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,a,o,l,c,h,p,m;try{const v=s.batchSize==null?32:s.batchSize;mN(v);const w=await this.standardizeUserData(e,t,s.sampleWeight,s.classWeight,!1,v);r=w[0],i=w[1],m=w[2];let T=!1,E;if(s.validationData!=null&&s.validationData.length>0){if(T=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Mt("validationData including sample weights is not supported yet."):new me(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const B=await this.standardizeUserData(l,c,null,null,!0,v);h=B[0],p=B[1],E=h.concat(p)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){T=!0;const M=Math.floor(r[0].shape[0]*(1-s.validationSplit)),B=r[0].shape[0];h=cy(r,M,B),a=r,r=cy(r,0,M),p=cy(i,M,B),o=i,i=cy(i,0,M),E=h.concat(p)}else s.validationSteps!=null&&(T=!0);const C=r.concat(i).concat(m);this.checkTrainableWeightsConsistency();const $=this.makeTrainFunction(),R=this.getDedupedMetricsNames();let P,U;T?(this.makeTestFunction(),P=this.testFunction,U=R.slice().concat(R.map(M=>"val_"+M))):(P=null,E=[],U=R.slice());const j=Aq(s.callbacks,s.yieldEvery);return await this.fitLoop($,C,R,v,s.epochs,s.verbose,j,P,E,s.shuffle,U,s.initialEpoch,null,null)}finally{this.isTraining=!1,Do(r,e),Do(i,t),Do(a,e),Do(o,t),Do(h,l),Do(p,c),m!=null&&Ht(m)}}async fitLoop(e,t,s,r,i,a,o,l,c,h,p,m,v,x){r==null&&(r=32),i==null&&(i=1),h==null&&(h=!0),m==null&&(m=0);let w=!1;if(l!=null&&c!=null&&(w=!0),x!=null&&(w=!0,v==null))throw new me("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const T=this.checkNumSamples(t,r,v,"steps_per_epoch");let E;T!=null&&(E=Xo(0,T)),a==null&&(a=1);const{callbackList:C,history:$}=Rq(o,a,i,m,T,v,r,w,p);C.setModel(this),this.history=$,await C.onTrainBegin(),this.stopTraining_=!1;for(let R=m;R<i;++R){await C.onEpochBegin(R);const P={};if(v!=null)throw new Mt("stepsPerEpoch mode is not implemented yet.");{if(h==="batch")throw new Mt("batch shuffling is not implemneted yet");h&&bve(E);const U=ta(E),j=gN(T,r);for(let O=0;O<j.length;++O){const M={};if(await C.onBatchBegin(O,M),ke(()=>{const B=j[O][0],D=j[O][1],W=lf(U,B,D-B);M.batch=O,M.size=D-B;const H=cC(t,W),ae=e(H);for(let te=0;te<s.length;++te){const Z=s[te],re=ae[te];M[Z]=re,jl(re)}if(O===j.length-1&&w){const te=this.testLoop(l,c,r);for(let Z=0;Z<s.length;++Z){const re=s[Z],ne=te[Z];jl(ne),P["val_"+re]=ne}}}),await C.onBatchEnd(O,M),$q(M),this.stopTraining_)break}U.dispose()}if(await C.onEpochEnd(R,P),this.stopTraining_)break}return await C.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return lNe(this,e,t)}async trainOnBatch(e,t){const s=await this.standardizeUserData(e,t),r=s[0],i=s[1],o=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of o){const h=await c.data();l.push(h[0])}return Ht(o),Do(s[0],e),Do(s[1],t),Ri(l)}getNamedWeights(e){const t=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let a=0;a<r.length;++a)s&&!r[a].trainable||t.push({name:r[a].originalName,tensor:i[a]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=XM().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-XM().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Pc(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>Pc(t))}else{const t=Object.keys(this.loss);e={};const s=this.loss;for(const r of t)if(typeof s[r]=="string")e[r]=Pc(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Pc($x(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Pc($x(e)));{const e={};for(const t in this.metrics)e[t]=Pc($x(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=oC(e.optimizer_config),s=qc(t);let r;if(typeof e.loss=="string")r=qd(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(a=>qd(a));else if(e.loss!=null){r={};for(const a in e.loss)r[a]=qd(e.loss[a])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(a=>qd(a));else if(e.metrics!=null){i={};for(const a in e.metrics)i[a]=qd(e.metrics[a])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,t){if(typeof e=="string"){const c=dbe(e);if(c.length===0)throw new me(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new me(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new me("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await YM(this.getNamedWeights(t)),o={modelTopology:this.toJSON(null,!1),format:gNe,generatedBy:`TensorFlow.js tfjs-layers v${jq}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:h,specs:p}=await YM(await this.optimizer.getWeights(),c);s.specs.push(...p),s.data=hbe([s.data,h])}return this.userDefinedMetadata!=null&&(S3(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=s.data,o.weightSpecs=s.specs,e.save(o)}setUserDefinedMetadata(e){S3(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}hm.className="Model";We(hm);class Gq extends hm{}Gq.className="Functional";We(Gq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hv extends hm{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:$T("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new me(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof hv||e instanceof hm;let s;if(t){if(s=e,s.outputs.length!==1)throw new me("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new me("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new me("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=vEe({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(t)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new me(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new me("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=Eq(this.outputs[0])}this.inboundNodes=[],new RT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Lf(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(mn(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new hm({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,s=console.log){this.built||this.build(),super.summary(e,t,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,s={}){if(!this.built)throw new io("The model needs to be compiled before being used.");return this.model.evaluate(e,t,s)}async evaluateDataset(e,t){if(!this.built)throw new io("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,s={}){if(!this.built)throw new io("The model needs to be compiled before being used.");return this.model.fit(e,t,s)}async fitDataset(e,t){if(!this.built)throw new io("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,s={},r=!1){let i,a={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new me("Legacy serialization format not supported yet.");i=t}else J(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=t.layers,delete t.layers,a=t;const o=new e(a);if(!(o instanceof hv))throw new Mt(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of i){const h=qc(l,void 0,r);r&&h.setFastWeightInitDuringBuild(!0),o.add(h)}return o}set stopTraining(e){if(this.model==null)throw new me("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new me("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const s={};s.className=t.getClassName(),s.config=t.getConfig(),e.push(s)}return{name:this.name,layers:e}}}hv.className="Sequential";We(hv);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Wr=class extends rg{getConfig(){return{}}};class Wq extends Wr{apply(e,t=1){return nEe(e,t)}}Wq.className="elu";We(Wq);class Hq extends Wr{apply(e){return c5(e)}}Hq.className="selu";We(Hq);class qq extends Wr{apply(e){return Wf(e)}}qq.className="relu";We(qq);class Kq extends Wr{apply(e){return ke(()=>ov(6,Wf(e)))}}Kq.className="relu6";We(Kq);class Xq extends Wr{apply(e){return e}}Xq.className="linear";We(Xq);class Zq extends Wr{apply(e){return tg(e)}}Zq.className="sigmoid";We(Zq);class Yq extends Wr{apply(e){return rEe(e)}}Yq.className="hardSigmoid";We(Yq);class Qq extends Wr{apply(e){return Wb(e)}}Qq.className="softplus";We(Qq);class Jq extends Wr{apply(e){return sEe(e)}}Jq.className="softsign";We(Jq);class e9 extends Wr{apply(e){return _T(e)}}e9.className="tanh";We(e9);let HA=class extends Wr{apply(e,t=-1){return X$(e,t)}};HA.className="softmax";We(HA);class t9 extends Wr{apply(e,t=-1){return t5(e,t)}}t9.className="logSoftmax";We(t9);class n9 extends Wr{apply(e){return ke(()=>ke(()=>{const t=Math.sqrt(2),s=ye(.5,Ke(1,ZH(yt(e,t))));return ye(e,s)}))}}n9.className="gelu";We(n9);class s9 extends Wr{apply(e){return ke(()=>ye(.5,ye(e,Ke(1,_T(ye(Vr(yt(2,Math.PI)),Ke(e,ye(.044715,Af(e,3)))))))))}}s9.className="gelu_new";We(s9);class r9 extends Wr{apply(e){return ke(()=>ye(e,_T(Wb(e))))}}r9.className="mish";We(r9);class i9 extends Wr{apply(e,t=1){return ke(()=>ye(tg(ye(e,t)),e))}}i9.className="swish";We(i9);function zh(n){return n.getClassName()}function yN(n,e={}){return Qb(n,so.getMap().classNameMap,e,"activation")}function Vh(n){if(n==null){const e={};return e.className="linear",e.config={},yN(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},yN(e)}else return n instanceof Wr?n:yN(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yNe(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class a9 extends rg{}class o9 extends a9{constructor(e){super(),yNe(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ke(()=>{let t=or([1]);return this.hasL1&&(t=Ke(t,mt(ye(this.l1,si(e))))),this.hasL2&&(t=Ke(t,mt(ye(this.l2,e_(e))))),_e(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}o9.className="L1L2";We(o9);const $3={l1l2:"L1L2"};function Mn(n){return RA(n)}function A3(n,e={}){return Qb(n,so.getMap().classNameMap,e,"regularizer")}function ts(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in $3?$3[n]:n,config:{}};return A3(t)}else return n instanceof a9?n:A3(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class l9 extends Ut{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=St(e);let s=Wf(e);return this.maxValue!=null&&(s=Ra(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}l9.className="ReLU";We(l9);class c9 extends Ut{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=St(e);return B$(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}c9.className="LeakyReLU";We(c9);class u9 extends Ut{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Jn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=ts(e.alphaRegularizer),this.alphaConstraint=Zs(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new me(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=mn(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Ks({ndim:e.length,axes:s})],this.built=!0}call(e,t){return e=St(e),H$(e,this.alpha.read())}getConfig(){const e={alphaInitializer:ls(this.alphaInitializer),alphaRegularizer:Mn(this.alphaRegularizer),alphaConstraint:Xs(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}u9.className="PReLU";We(u9);let h9=class extends Ut{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Mt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=St(e);return TT(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};h9.className="ELU";We(h9);class d9 extends Ut{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const s=St(e);return ye(s,tt(Da(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}d9.className="ThresholdedReLU";We(d9);class f9 extends Ut{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new HA().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return ke(()=>{let s=St(e);const r=t.mask;if(r!=null){const i=ye(_t(id(s.shape),tt(r,s.dtype)),_n(-1e9));s=Ke(s,i)}return this.axis instanceof Array?this.axis.length>1?Jl(_t(s,n5(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}f9.className="Softmax";We(f9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dm(n,e,t){if(typeof n=="number")return Lf(n,e);if(n.length!==e)throw new me(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let s=0;s<e;++s){const r=n[s];if(!QSe(r))throw new me(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${r}`)}return n}function Wo(n,e,t,s,r=1){if(n==null)return n;const i=e+(e-1)*(r-1);let a;return t==="same"?a=n:a=n-i+1,Math.floor((a+s-1)/s)}function Nl(n,e,t,s){if(n==null)return null;if(s==="valid")n=n*e+Bh([t-e,0]);else if(s==="same")n=n*e;else throw new me(`Unsupport padding mode: ${s}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qA(n,e){return ke(()=>(Cs(e),e==="channelsFirst"?on(n,[0,2,3,1]):n))}function p9(n,e){return ke(()=>(Cs(e),e==="channelsFirst"?on(n,[0,2,3,4,1]):n))}function vNe(n,e,t,s=1,r="valid",i,a=1){return ke(()=>{if(i==null&&(i=Zo()),Cs(i),n.shape.length!==3)throw new me(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new me(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new me(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(i==="channelsFirst"&&(n=on(n,[0,2,1])),r==="causal")throw new Mt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=WH(n,e,s,r==="same"?"same":"valid","NWC",a);return t!=null&&(o=Jo(o,t)),o})}function R3(n,e,t,s=[1,1],r="valid",i,a,o=null){return ke(()=>{if(i==null&&(i=Zo()),Cs(i),n.rank!==3&&n.rank!==4)throw new me(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new me(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=qA(n,i);if(r==="causal")throw new Mt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=I1e({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:t,activation:o}),i==="channelsFirst"&&(l=on(l,[0,3,1,2])),l})}function bNe(n,e,t,s=[1,1,1],r="valid",i,a){return ke(()=>{if(i==null&&(i=Zo()),Cs(i),n.rank!==4&&n.rank!==5)throw new me(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new me(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let o=p9(n,i);if(r==="causal")throw new Mt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=V_e(o,e,s,r==="same"?"same":"valid","NDHWC",a),t!=null&&(o=Jo(o,t)),i==="channelsFirst"&&(o=on(o,[0,4,1,2,3])),o})}class OT extends Ut{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",OT.verifyArgs(t),this.rank=e,lr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Mt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=dm(t.kernelSize,e,"kernelSize"),this.strides=dm(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,La(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Cs(this.dataFormat),this.activation=Vh(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=Jn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Zs(t.biasConstraint),this.biasRegularizer=ts(t.biasRegularizer),this.activityRegularizer=ts(t.activityRegularizer),this.dilationRate=dm(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new me(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new me(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new me(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(El("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!DA(e.kernelSize,"number",1,3))throw new me(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:zh(this.activation),useBias:this.useBias,biasInitializer:ls(this.biasInitializer),biasRegularizer:Mn(this.biasRegularizer),activityRegularizer:Mn(this.activityRegularizer),biasConstraint:Xs(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class ig extends OT{constructor(e,t){super(e,t),this.kernel=null,ig.verifyArgs(t),this.filters=t.filters,lr(this.filters,"filters"),this.kernelInitializer=Jn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Zs(t.kernelConstraint),this.kernelRegularizer=ts(t.kernelRegularizer)}build(e){e=mn(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new me(`The channel dimension of the input should be defined. Found ${e[t]}`);const s=e[t],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:s}}],this.built=!0}call(e,t){return ke(()=>{e=St(e);let s;const r=this.bias==null?null:this.bias.read(),i=uq(this.activation.getClassName());if(i!=null&&this.rank===2)s=R3(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=vNe(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=R3(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=bNe(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Mt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=mn(e);const t=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const a=Wo(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);t.push(a)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:ls(this.kernelInitializer),kernelRegularizer:Mn(this.kernelRegularizer),kernelConstraint:Xs(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new me(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class r_ extends ig{constructor(e){super(2,e),r_.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!DA(e.kernelSize,"number",1,2))throw new me(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}r_.className="Conv2D";We(r_);class i_ extends ig{constructor(e){super(3,e),i_.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new me(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}i_.className="Conv3D";We(i_);class m9 extends r_{constructor(e){if(super(e),this.inputSpec=[new Ks({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new me(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=mn(e),e.length!==4)throw new me("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new me("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ks({ndim:4,axes:{[t]:s}})],this.built=!0}call(e,t){return ke(()=>{let s=St(e);if(s.shape.length!==4)throw new me(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let a,o;this.dataFormat==="channelsFirst"?(a=2,o=3):(a=1,o=2);const l=r[a],c=r[o],h=this.kernelSize[0],p=this.kernelSize[1],m=this.strides[0],v=this.strides[1],x=Nl(l,m,h,this.padding),w=Nl(c,v,p,this.padding),T=[i,x,w,this.filters];this.dataFormat!=="channelsLast"&&(s=on(s,[0,2,3,1]));let E=HH(s,this.kernel.read(),T,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(E=on(E,[0,3,1,2])),this.bias!=null&&(E=Jo(E,this.bias.read(),this.dataFormat)),this.activation!=null&&(E=this.activation.apply(E)),E})}computeOutputShape(e){e=mn(e);const t=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const a=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return t[s]=this.filters,t[r]=Nl(t[r],l,a,this.padding),t[i]=Nl(t[i],c,o,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}m9.className="Conv2DTranspose";We(m9);class g9 extends i_{constructor(e){if(super(e),this.inputSpec=[new Ks({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new me(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=mn(e),e.length!==5)throw new me("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new me("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ks({ndim:5,axes:{[t]:s}})],this.built=!0}call(e,t){return ke(()=>{let s=St(e);if(s.shape.length!==5)throw new me(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let a,o,l;this.dataFormat==="channelsFirst"?(l=2,a=3,o=4):(l=1,a=2,o=3);const c=r[l],h=r[a],p=r[o],m=this.kernelSize[0],v=this.kernelSize[1],x=this.kernelSize[2],w=this.strides[0],T=this.strides[1],E=this.strides[2],C=Nl(c,w,m,this.padding),$=Nl(h,T,v,this.padding),R=Nl(p,E,x,this.padding),P=[i,C,$,R,this.filters];this.dataFormat!=="channelsLast"&&(s=on(s,[0,2,3,4,1]));let U=W_e(s,this.kernel.read(),P,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(U=on(U,[0,4,1,2,3])),this.bias!==null&&(U=Jo(U,this.bias.read(),this.dataFormat)),this.activation!==null&&(U=this.activation.apply(U)),U})}computeOutputShape(e){e=mn(e);const t=e.slice();let s,r,i,a;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,a=4):(s=4,r=1,i=2,a=3);const o=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],h=this.strides[0],p=this.strides[1],m=this.strides[2];return t[s]=this.filters,t[r]=Nl(t[r],h,o,this.padding),t[i]=Nl(t[i],p,l,this.padding),t[a]=Nl(t[a],m,c,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}g9.className="Conv3DTranspose";We(g9);class y9 extends ig{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new me("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new me("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new me(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Jn(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=ts(t.depthwiseRegularizer),this.depthwiseConstraint=Zs(t.depthwiseConstraint),this.pointwiseInitializer=Jn(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=ts(t.pointwiseRegularizer),this.pointwiseConstraint=Zs(t.pointwiseConstraint)}build(e){if(e=mn(e),e.length<this.rank+2)throw new me(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new me(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const s=e[t],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let o=0;o<this.rank;++o)i.push(1);i.push(s*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new Ks({ndim:this.rank+2,axes:{[t]:s}})],this.built=!0}call(e,t){return ke(()=>{e=St(e);let s;if(this.rank===1)throw new Mt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=on(e,[0,2,3,1])),s=u5(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Jo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=on(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=ls(this.depthwiseInitializer),e.pointwiseInitializer=ls(this.pointwiseInitializer),e.depthwiseRegularizer=Mn(this.depthwiseRegularizer),e.pointwiseRegularizer=Mn(this.pointwiseRegularizer),e.depthwiseConstraint=Xs(this.depthwiseConstraint),e.pointwiseConstraint=Xs(this.pointwiseConstraint),e}}y9.className="SeparableConv";class v9 extends y9{constructor(e){super(2,e)}}v9.className="SeparableConv2D";We(v9);class PT extends ig{constructor(e){super(1,e),PT.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!DA(e.kernelSize,"number",1,1))throw new me(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}PT.className="Conv1D";We(PT);class b9 extends Ut{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return ke(()=>{if(e=St(e),this.dataFormat==="channelsLast"){const s=kx(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return kx(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=kx(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return kx(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}b9.className="Cropping2D";We(b9);class _9 extends Ut{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Cs(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,XSe(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,s]}else{const t=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],t,s,e[3]]}}call(e,t){return ke(()=>{let s=St(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=on(s,[0,2,3,1]);const i=this.size[0]*r[2],a=this.size[1]*r[3],o=this.interpolation==="nearest"?Vc.resizeNearestNeighbor(s,[i,a]):Vc.resizeBilinear(s,[i,a]);return on(o,[0,3,1,2])}else{const i=this.size[0]*r[1],a=this.size[1]*r[2];return this.interpolation==="nearest"?Vc.resizeNearestNeighbor(s,[i,a]):Vc.resizeBilinear(s,[i,a])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}_9.className="UpSampling2D";We(_9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _Ne(n,e,t=[1,1],s="valid",r,i){return ke(()=>{r==null&&(r=Zo()),Cs(r);let a=qA(n,r);if(n.rank!==4)throw new me(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new me(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return a=P$(a,e,t,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(a=on(a,[0,3,1,2])),a})}class x9 extends OT{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Jn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Zs(e.depthwiseConstraint),this.depthwiseRegularizer=ts(e.depthwiseRegularizer)}build(e){if(e=mn(e),e.length<4)throw new me(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new me(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const s=e[t],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ke(()=>{e=St(e);let s=_Ne(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Jo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=mn(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Wo(t,this.kernelSize[0],this.padding,this.strides[0]),a=Wo(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,a]:[e[0],i,a,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=ls(this.depthwiseInitializer),e.depthwiseRegularizer=Mn(this.depthwiseRegularizer),e.depthwiseConstraint=Xs(this.depthwiseRegularizer),e}}x9.className="DepthwiseConv2D";We(x9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function w9(n,e,t,s){if(Array.isArray(n)){if(e!=null||t!=null)throw new me("When inputs is an array, neither initialState or constants should be provided");s!=null&&(t=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),t=r(t),{inputs:n,initialState:e,constants:t}}function T9(n,e,t,s=!1,r,i,a=!1,o=!1){return ke(()=>{const l=e.shape.length;if(l<3)throw new me(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Xo(2,l));e=on(e,c),a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=tt(tt(r,"bool"),"float32"),r.rank===l-1&&(r=Ai(r,-1)),r=on(r,c)),s&&(e=Rf(e,0),r!=null&&(r=Rf(r,0)));const h=[];let p,m=t;const v=e.shape[0],x=Df(e);let w;r!=null&&(w=Df(r));for(let E=0;E<v;++E){const C=x[E],$=ke(()=>n(C,m));if(r==null)p=$[0],m=$[1];else{const R=ke(()=>{const P=w[E],U=_t(co(P),P),j=Ke(ye($[0],P),ye(m[0],U)),O=m.map((M,B)=>Ke(ye($[1][B],P),ye(M,U)));return{output:j,newStates:O}});p=R.output,m=R.newStates}o&&h.push(p)}let T;return o&&(T=tu(h,1)),[p,T,m]})}class od extends Ut{constructor(e){super(e);let t;if(e.cell==null)throw new me("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new ZA({cells:e.cell}):t=e.cell,t.stateSize==null)throw new me("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Ks({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Xo(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){rC(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const s=t[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const a of t)i.push([e[0],a]);return[r].concat(i)}else return r}computeMask(e,t){return ke(()=>{Array.isArray(t)&&(t=t[0]);const s=this.returnSequences?t:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let s=0;s<e;++s)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Mt("Constants support is not implemented in RNN yet.");rC(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Ks({shape:[t,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!xn(this.stateSpec.map(a=>a.shape[a.shape.length-1]),i))throw new me(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(a=>new Ks({shape:[null,a]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){ke(()=>{if(!this.stateful)throw new Sl("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new me("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>or([s,r])):this.states_=[or([s,this.cell.stateSize])];else if(e==null)Ht(this.states_),this.keptStates!=null&&(Ht(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>or([s,r])):this.states_[0]=or([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new me(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):Ht(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,o=[s,a];if(!xn(i.shape,o))throw new me(`State ${r} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>jl(r.clone()))})}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const i=w9(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let a=[],o=[];if(s!=null){t.initialState=s,a=a.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new Ks({shape:c.shape}));o=o.concat(this.stateSpec)}if(r!=null&&(t.constants=r,a=a.concat(r),this.numConstants=r.length),a[0]instanceof tc){const c=[e].concat(a),h=this.inputSpec.concat(o),p=this.inputSpec;this.inputSpec=h;const m=super.apply(c,t);return this.inputSpec=p,m}else return super.apply(e,t)}call(e,t){return ke(()=>{const s=t==null?null:t.mask,r=t==null?null:t.training;let i=t==null?null:t.initialState;e=St(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new me(`RNN Layer has ${a} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},c=T9((x,w)=>{const T=this.cell.call([x].concat(w),o);return[T[0],T.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),h=c[0],p=c[1],m=c[2];this.stateful&&this.resetStates(m,r);const v=this.returnSequences?p:h;return this.returnState?[v].concat(m):v})}getInitialState(e){return ke(()=>{let t=or(e.shape);return t=mt(t,[1,2]),t=Jb(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?nC(t,[1,s]):t):this.cell.stateSize>1?[nC(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===od.className&&(t.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),t)}static fromConfig(e,t,s={}){const r=t.cell,i=qc(r,s);return new e(Object.assign(t,{cell:i}))}}od.className="RNN";We(od);class MT extends Ut{}class KA extends MT{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,lr(this.units,"units"),this.activation=Vh(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Jn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=ts(e.kernelRegularizer),this.recurrentRegularizer=ts(e.recurrentRegularizer),this.biasRegularizer=ts(e.biasRegularizer),this.kernelConstraint=Zs(e.kernelConstraint),this.recurrentConstraint=Zs(e.recurrentConstraint),this.biasConstraint=Zs(e.biasConstraint),this.dropout=Am([1,Bh([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Am([1,Bh([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=mn(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ke(()=>{if(e=e,e.length!==2)throw new me(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Uh({ones:()=>co(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Uh({ones:()=>co(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const a=this.dropoutMask,o=this.recurrentDropoutMask;a!=null?i=Vl(ye(e,a),this.kernel.read()):i=Vl(e,this.kernel.read()),this.bias!=null&&(i=Jo(i,this.bias.read())),o!=null&&(s=ye(s,o));let l=Ke(i,Vl(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:zh(this.activation),useBias:this.useBias,kernelInitializer:ls(this.kernelInitializer),recurrentInitializer:ls(this.recurrentInitializer),biasInitializer:ls(this.biasInitializer),kernelRegularizer:Mn(this.kernelRegularizer),recurrentRegularizer:Mn(this.recurrentRegularizer),biasRegularizer:Mn(this.biasRegularizer),activityRegularizer:Mn(this.activityRegularizer),kernelConstraint:Xs(this.kernelConstraint),recurrentConstraint:Xs(this.recurrentConstraint),biasConstraint:Xs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}KA.className="SimpleRNNCell";We(KA);class S9 extends od{constructor(e){e.cell=new KA(e),super(e)}call(e,t){return ke(()=>{this.cell.dropoutMask!=null&&(Ht(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ht(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,t){return new e(t)}}S9.className="SimpleRNN";We(S9);class XA extends MT{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new me("GRUCell does not support reset_after parameter set to true.");this.units=e.units,lr(this.units,"units"),this.activation=Vh(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Vh(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Jn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=ts(e.kernelRegularizer),this.recurrentRegularizer=ts(e.recurrentRegularizer),this.biasRegularizer=ts(e.biasRegularizer),this.kernelConstraint=Zs(e.kernelConstraint),this.recurrentConstraint=Zs(e.recurrentConstraint),this.biasConstraint=Zs(e.biasConstraint),this.dropout=Am([1,Bh([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Am([1,Bh([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=mn(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ke(()=>{if(e=e,e.length!==2)throw new me(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training==null?!1:t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Uh({ones:()=>co(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Uh({ones:()=>co(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let o,l,c;0<this.dropout&&this.dropout<1&&(e=ye(e,i[0]));let h=Vl(e,this.kernel.read());this.useBias&&(h=Jo(h,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=ye(r,a[0]));const p=this.recurrentKernel.read(),[m,v]=$a(p,[2*this.units,this.units],p.rank-1),x=Vl(r,m),[w,T,E]=$a(h,3,h.rank-1),[C,$]=$a(x,2,x.rank-1);o=this.recurrentActivation.apply(Ke(w,C)),l=this.recurrentActivation.apply(Ke(T,$));const R=Vl(ye(l,r),v);c=this.activation.apply(Ke(E,R));const P=Ke(ye(o,r),ye(Ke(1,Ts(o)),c));return[P,P]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:zh(this.activation),recurrentActivation:zh(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ls(this.kernelInitializer),recurrentInitializer:ls(this.recurrentInitializer),biasInitializer:ls(this.biasInitializer),kernelRegularizer:Mn(this.kernelRegularizer),recurrentRegularizer:Mn(this.recurrentRegularizer),biasRegularizer:Mn(this.biasRegularizer),activityRegularizer:Mn(this.activityRegularizer),kernelConstraint:Xs(this.kernelConstraint),recurrentConstraint:Xs(this.recurrentConstraint),biasConstraint:Xs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}XA.className="GRUCell";We(XA);class E9 extends od{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new XA(e),super(e)}call(e,t){return ke(()=>{this.cell.dropoutMask!=null&&(Ht(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ht(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}E9.className="GRU";We(E9);class FT extends MT{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,lr(this.units,"units"),this.activation=Vh(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Vh(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Jn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=ts(e.kernelRegularizer),this.recurrentRegularizer=ts(e.recurrentRegularizer),this.biasRegularizer=ts(e.biasRegularizer),this.kernelConstraint=Zs(e.kernelConstraint),this.recurrentConstraint=Zs(e.recurrentConstraint),this.biasConstraint=Zs(e.biasConstraint),this.dropout=Am([1,Bh([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Am([1,Bh([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=mn(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,a=this.units;r=new(t=class extends fo{apply(l,c){const h=i.apply([a]),p=new OA().apply([a]),m=i.apply([a*2]);return m3(m3(h,p),m)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return ke(()=>{const s=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new me(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Uh({ones:()=>co(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Uh({ones:()=>co(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let l,c,h,p;0<this.dropout&&this.dropout<1&&(e=ye(e,a[0]));let m=Vl(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=ye(r,o[0])),m=Ke(m,Vl(r,this.recurrentKernel.read())),this.useBias&&(m=Jo(m,this.bias.read()));const[v,x,w,T]=$a(m,4,m.rank-1);l=this.recurrentActivation.apply(v),c=this.recurrentActivation.apply(x),h=Ke(ye(c,i),ye(l,this.activation.apply(w))),p=this.recurrentActivation.apply(T);const E=ye(p,this.activation.apply(h));return[E,E,h]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:zh(this.activation),recurrentActivation:zh(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ls(this.kernelInitializer),recurrentInitializer:ls(this.recurrentInitializer),biasInitializer:ls(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Mn(this.kernelRegularizer),recurrentRegularizer:Mn(this.recurrentRegularizer),biasRegularizer:Mn(this.biasRegularizer),activityRegularizer:Mn(this.activityRegularizer),kernelConstraint:Xs(this.kernelConstraint),recurrentConstraint:Xs(this.recurrentConstraint),biasConstraint:Xs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}FT.className="LSTMCell";We(FT);class N9 extends od{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new FT(e),super(e)}call(e,t){return ke(()=>{this.cell.dropoutMask!=null&&(Ht(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ht(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}N9.className="LSTM";We(N9);class ZA extends MT{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return ke(()=>{e=e;let s=e.slice(1);const r=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?r.push(s.splice(0,o.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let a;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];s=r[o],o===0?a=[e[0]].concat(s):a=[a[0]].concat(s),a=l.call(a,t),i.push(a.slice(1))}s=[];for(const o of i.slice().reverse())s.push(...o);return[a[0]].concat(s)})}build(e){rC(e)&&(e=e[0]),e=e;let t;this.cells.forEach((s,r)=>{of(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?t=s.stateSize[0]:t=s.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,t,s={}){const r=[];for(const i of t.cells)r.push(qc(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.cells)t.push(...s.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return iC(e)}setWeights(e){const t=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let a=0;a<s.weights.length;++a)t.push([s.weights[a],i[a]])}VA(t)}}ZA.className="StackedRNNCells";We(ZA);function Uh(n){const{ones:e,rate:t,training:s=!1,count:r=1,dropoutFunc:i}=n,a=()=>i!=null?i(e(),t):yq(e(),t),o=()=>t_(a,e,s);return!r||r<=1?jl(o().clone()):Array(r).fill(void 0).map(o).map(c=>jl(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var xNe=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class I9 extends od{constructor(e){if(e.unroll)throw new Mt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Mt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Ks({ndim:5})]}call(e,t){return ke(()=>{if(this.cell.dropoutMask!=null&&(Ht(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ht(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new me("ConvRNN2D cell does not support constants");const s=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return ke(()=>{const{stateSize:t}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],a=or(i);return Array.isArray(t)?Array(t.length).fill(a):[a]})}resetStates(e,t=!1){ke(()=>{if(!this.stateful)throw new Sl("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new me("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>or(i)):this.states_=[or(i)];else if(e==null)Ht(this.states_),this.keptStates!=null&&(Ht(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>or(i)):this.states_[0]=or(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new me(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):Ht(this.states_);for(let o=0;o<this.states_.length;++o){const l=e[o],c=i;if(!xn(l.shape,c))throw new me(`State ${o} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>jl(o.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:s,kernelSize:r,padding:i,strides:a,dilationRate:o}=this.cell,l=t==="channelsFirst",c=e[l?3:2],h=e[l?4:3],p=Wo(c,r[0],i,a[0],o[0]),m=Wo(h,r[1],i,a[1],o[1]);return[...e.slice(0,2),...l?[s,p,m]:[p,m,s]]}}I9.className="ConvRNN2D";class YA extends FT{constructor(e){const{filters:t,kernelSize:s,strides:r,padding:i,dataFormat:a,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,lr(this.filters,"filters"),this.kernelSize=dm(s,2,"kernelSize"),this.kernelSize.forEach(l=>lr(l,"kernelSize")),this.strides=dm(r||1,2,"strides"),this.strides.forEach(l=>lr(l,"strides")),this.padding=i||"valid",La(this.padding),this.dataFormat=a||"channelsLast",Cs(this.dataFormat),this.dilationRate=dm(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>lr(l,"dilationRate"))}build(e){var t;e=mn(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new me(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,a=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,h=this.filters;l=new(t=class extends fo{apply(m,v){const x=c.apply([h]),w=id([h]),T=c.apply([h*2]);return LA([x,w,T])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return ke(()=>{if(e.length!==3)throw new me(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training||!1,r=e[0],i=e[1],a=e[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Uh({ones:()=>co(r),rate:this.dropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(K,ie,pe)=>!ie||!ie[pe]?K:ye(ie[pe],K);let h=c(r,l,0),p=c(r,l,1),m=c(r,l,2),v=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Uh({ones:()=>co(i),rate:this.recurrentDropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const x=this.recurrentDropoutMask;let w=c(i,x,0),T=c(i,x,1),E=c(i,x,2),C=c(i,x,3);const $=3,[R,P,U,j]=$a(this.kernel.read(),o,$),[O,M,B,D]=this.useBias?$a(this.bias.read(),o):[null,null,null,null];h=this.inputConv(h,R,O,this.padding),p=this.inputConv(p,P,M,this.padding),m=this.inputConv(m,U,B,this.padding),v=this.inputConv(v,j,D,this.padding);const[W,H,ae,te]=$a(this.recurrentKernel.read(),o,$);w=this.recurrentConv(w,W),T=this.recurrentConv(T,H),E=this.recurrentConv(E,ae),C=this.recurrentConv(C,te);const Z=this.recurrentActivation.apply(Ke(h,w)),re=this.recurrentActivation.apply(Ke(p,T)),ne=Ke(ye(re,a),ye(Z,this.activation.apply(Ke(m,E)))),he=ye(this.recurrentActivation.apply(Ke(v,C)),this.activation.apply(ne));return[he,he,ne]})}getConfig(){const e=super.getConfig(),{units:t}=e,s=xNe(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,t,s,r){const i=$f(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Jo(i,s,this.dataFormat):i}recurrentConv(e,t){return $f(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}YA.className="ConvLSTM2DCell";We(YA);class C9 extends I9{constructor(e){const t=new YA(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}C9.className="ConvLSTM2D";We(C9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class QA extends Ut{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return s}call(e,t){return ke(()=>{this.invokeCallHook(e,t);const s=St(e);if(0<this.rate&&this.rate<1){const r=t.training==null?!1:t.training,i=this.getNoiseShape(s);return t_(()=>yq(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}QA.className="Dropout";We(QA);class k9 extends QA{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}k9.className="SpatialDropout1D";We(k9);class $9 extends Ut{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,lr(this.units,"units"),this.activation=Vh(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Zs(e.kernelConstraint),this.biasConstraint=Zs(e.biasConstraint),this.kernelRegularizer=ts(e.kernelRegularizer),this.biasRegularizer=ts(e.biasRegularizer),this.activityRegularizer=ts(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=mn(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=mn(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return ke(()=>{this.invokeCallHook(e,t);const s=St(e),r=uq(this.activation.getClassName());let i;return r!=null?i=Vl(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=Vl(s,this.kernel.read()),this.bias!=null&&(i=Jo(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:zh(this.activation),useBias:this.useBias,kernelInitializer:ls(this.kernelInitializer),biasInitializer:ls(this.biasInitializer),kernelRegularizer:Mn(this.kernelRegularizer),biasRegularizer:Mn(this.biasRegularizer),activityRegularizer:Mn(this.activityRegularizer),kernelConstraint:Xs(this.kernelConstraint),biasConstraint:Xs(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}$9.className="Dense";We($9);class A9 extends Ut{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=mn(e);for(const t of e.slice(1))if(t==null)throw new me(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Eh(e,1)]}call(e,t){return ke(()=>{this.invokeCallHook(e,t);let s=St(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=on(s,r)}return tEe(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}A9.className="Flatten";We(A9);class R9 extends Ut{constructor(e){super(e),this.supportsMasking=!0,this.activation=Vh(e.activation)}call(e,t){return ke(()=>{this.invokeCallHook(e,t);const s=St(e);return this.activation.apply(s)})}getConfig(){const e={activation:zh(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}R9.className="Activation";We(R9);class D9 extends Ut{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return ke(()=>(e=St(e),JSe(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}D9.className="RepeatVector";We(D9);class L9 extends Ut{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const s="Total size of new array must be unchanged.",r=t.slice();let i=1,a=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(a===null)a=l;else throw new me("Can only specifiy one unknown dimension.");else i*=c}const o=Eh(e);if(a!==null){if(i===0||o%i!==0)throw new me(s);r[a]=o/i}else if(o!==i)throw new me(s);return r}computeOutputShape(e){let t=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return ke(()=>{this.invokeCallHook(e,t);const s=St(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return _e(s,i)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}L9.className="Reshape";We(L9);class O9 extends Ut{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=Xo(1,e.dims.length+1);if(!xn(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Ks({ndim:this.dims.length+1})]}computeOutputShape(e){e=mn(e);const t=e.slice();return this.dims.forEach((s,r)=>{t[r+1]=e[s]}),t}call(e,t){return on(St(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}O9.className="Permute";We(O9);class P9 extends Ut{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const s=St(e);return XI(s1(s,this.maskValue),-1)}call(e,t){return ke(()=>{this.invokeCallHook(e,t);const s=St(e),a=XI(s1(s,this.maskValue),-1,!0);return ye(s,tt(a,s.dtype))})}}P9.className="Masking";We(P9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class M9 extends Ut{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(En(e.inputLength))}this.inputDim=e.inputDim,lr(this.inputDim,"inputDim"),this.outputDim=e.outputDim,lr(this.outputDim,"outputDim"),this.embeddingsInitializer=Jn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=ts(e.embeddingsRegularizer),this.activityRegularizer=ts(e.activityRegularizer),this.embeddingsConstraint=Zs(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return ke(()=>this.maskZero?(e=St(e),s1(e,ln(e))):null)}computeOutputShape(e){if(e=mn(e),this.inputLength==null)return[...e,this.outputDim];const t=En(this.inputLength);if(t.length!==e.length-1)throw new me(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<t.length;++r){const i=t[r],a=e[r+1];if(i!=null&&a!=null&&i!==a)throw new me(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(t[s]=a),s++}}return[e[0],...t,this.outputDim]}call(e,t){return ke(()=>{this.invokeCallHook(e,t);let s=St(e);s.dtype!=="int32"&&(s=zl(s,"int32"));const r=gq(this.embeddings.read(),_e(s,[s.size]));return _e(r,mn(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:ls(this.embeddingsInitializer),embeddingsRegularizer:Mn(this.embeddingsRegularizer),activityRegularizer:Mn(this.activityRegularizer),embeddingsConstraint:Xs(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}M9.className="Embedding";We(M9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Kf extends Ut{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Mt}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const s=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const i=e[e.length-t.length+r],a=t[r];if(i==null||a==null||i<0||a<0)s.push(null);else if(i===1)s.push(a);else if(a===1)s.push(i);else{if(i!==a)throw new me("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[mn(e)]),e=e,e.length<2)throw new me(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const i of e)i!=null&&i[0]!==null&&t.push(i[0]);if(t=Sh(t),t.length>1)throw new me(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const a=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,a)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&Sh(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return ke(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=Bh(r);for(let a of e){const o=a.rank;for(let l=0;l<i-o;++l)a=Jb(a,1);s.push(a)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const h=l.shape,p=h[0],m=h.slice(1).concat([p]);let v=_e(l,[p].concat(Eh(h.slice(1))));v=on(v,[1,0]),v=_e(v,m),s.push(v),i=!0}else if(c>1){const h=Xo(1,c).concat([0]);s.push(on(l,h)),i=!0}else s.push(l)}let a=this.mergeFunction(s);const o=a.rank;if(i){if(o==null){const l=a.shape,c=l.length,h=l[c-1],p=[h].concat(l.slice(0,l.length-1));a=_e(on(_e(a,[-1,h]),[1,0]),p)}else if(o>1){const l=[o-1].concat(Xo(0,o-1));a=on(a,l)}}return a}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Sh(s),s.length===1?t=s.concat(t):t=[null].concat(t),t}computeMask(e,t){return ke(()=>{if(t==null)return null;if(!Array.isArray(t))throw new me("`mask` should be an Array");if(!Array.isArray(e))throw new me("`inputs` should be an Array");if(t.length!==e.length)throw new me(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:Ai(r,0));let s=t[0];for(let r=1;r<t.length-1;++r)s=eu(s,t[r]);return s})}}class F9 extends Kf{constructor(e){super(e)}mergeFunction(e){return ke(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=Ke(t,e[s]);return t})}}F9.className="Add";We(F9);class j9 extends Kf{constructor(e){super(e)}mergeFunction(e){return ke(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=ye(t,e[s]);return t})}}j9.className="Multiply";We(j9);class B9 extends Kf{constructor(e){super(e)}mergeFunction(e){return ke(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=Ke(t,e[s]);return ye(1/e.length,t)})}}B9.className="Average";We(B9);class z9 extends Kf{constructor(e){super(e)}mergeFunction(e){return ke(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=rd(t,e[s]);return t})}}z9.className="Maximum";We(z9);class V9 extends Kf{constructor(e){super(e)}mergeFunction(e){return ke(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=ov(t,e[s]);return t})}}V9.className="Minimum";We(V9);class U9 extends Kf{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new me("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const r of e)if(r!=null){t=!1;break}if(t)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let a=!1;for(const o of s)if(xn(o,i)){a=!0;break}a||s.push(i)}if(s.length>1)throw new me("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ke(()=>LA(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new me("A `Concatenate` layer should be called on a list of inputs.");const t=e,s=t[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of t.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new me("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new me("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new me(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return ke(()=>{let s=!0;if(t.forEach(a=>{if(a!=null){s=!1;return}}),s)return null;const r=[];for(let a=0;a<e.length;++a)t[a]==null?r.push(tt(co(e[a]),"bool")):t[a].rank<e[a].rank?r.push(Ai(t[a],-1)):r.push(t[a]);const i=Di(r,this.axis);return GH(i,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}U9.className="Concatenate";We(U9);function uy(n,e){for(;n<0;)n+=e;return n}function wNe(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new Mt("batchDot is not implemented for tensors of 4D or higher rank yet");if(J(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),J(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new Mt("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,r=e.shape.length;t==null&&(t=[s-1,r-2]);const i=t;return ke(()=>{let a;if(s>r){a=s-r;const l=[];for(let c=0;c<a;++c)l.push(1);e=_e(e,e.shape.concat(l))}else if(r>s){a=r-s;const l=[];for(let c=0;c<a;++c)l.push(1);n=_e(n,n.shape.concat(l))}else a=0;let o;if(n.shape.length===2&&e.shape.length===2)i[0]===i[1]?o=mt(ye(n,e),i[0]):o=mt(ye(on(n,[1,0]),e),i[1]);else{const l=i[0]!==n.shape.length-1,c=i[1]===e.shape.length-1;o=bn(n,e,l,c)}if(a>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let h=l;h<l+a;++h)c.push(h);o=qb(o,c)}return o.shape.length===1&&(o=Ai(o,1)),o})}class G9 extends Kf{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){J(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],s=e[1];if(t.length>3||s.length>3)throw new Mt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);if(t[r[0]]!==s[r[1]])throw new me(`Dimension incompatibility: ${t[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new me(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,a)=>uy(i,e[a].shape.length)):r=[uy(this.axes,t.shape.length),uy(this.axes,s.shape.length)],this.normalize&&(t=u1(t,r[0]),s=u1(s,r[1])),wNe(t,s,r)}interpretAxes(e,t){let s;return Array.isArray(this.axes)?s=this.axes:s=[uy(this.axes,e.length),uy(this.axes,t.length)],s}computeOutputShape(e){J(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),s=e[1].slice();if(t.length>3||s.length>3)throw new Mt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);t.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=t.concat(s);return i.length===1&&i.push(1),i}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}G9.className="Dot";We(G9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class W9 extends Ut{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return ke(()=>{this.invokeCallHook(e,t);const s=St(e);return t_(()=>Ke(AT(s.shape,0,this.stddev),s),()=>s,t.training||!1)})}}W9.className="GaussianNoise";We(W9);class H9 extends Ut{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ke(()=>{this.invokeCallHook(e,t);const s=St(e);return this.rate>0&&this.rate<1?t_(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return ye(s,AT(s.shape,1,i))},()=>s,t.training||!1):s})}}H9.className="GaussianDropout";We(H9);class q9 extends Ut{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||St(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ke(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return t_(()=>{const i=St(e),o=-1.6732632423543772*1.0507009873554805;let l=Gf(Hb(s),this.rate);l=zl(l,"float32");const c=((1-this.rate)*(1+this.rate*o**2))**-.5,h=-c*o*this.rate,p=Ke(ye(i,l),ye(Ke(l,-1),o));return Ke(ye(p,c),h)},()=>St(e),t.training||!1)}return e})}}q9.className="AlphaDropout";We(q9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dv(n,e,t,s,r,i=.001){let a;if(n.rank===2)a=v_e(n,e,t,s,r,i);else if(n.rank===3)a=__e(n,e,t,s,r,i);else if(n.rank===4)a=w_e(n,e,t,s,r,i);else throw new Mt(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return a}function TNe(n,e,t,s,r=.001){return ke(()=>{const i=U$(n,s),a=i.mean,o=i.variance;return[dv(n,a,o,t,e,r),a,o]})}function SNe(n,e,t,s,r=.001){return ke(()=>{const i=U$(n,s),a=i.mean,o=i.variance,l=[];for(const x of Xo(0,n.rank))s.indexOf(x)!==-1?l.push(1):l.push(n.shape[x]);const c=_e(a,l),h=_e(o,l),p=e==null?null:_e(e,l),m=t==null?null:_e(t,l);return[dv(n,c,h,m,p,r),a,o]})}function ENe(n,e,t,s,r=.001){return xn(s.slice().sort(),Xo(0,n.rank-1))?TNe(n,e,t,s,r):SNe(n,e,t,s,r)}class K9 extends Ut{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Jn(e.betaInitializer||"zeros"),this.gammaInitializer=Jn(e.gammaInitializer||"ones"),this.movingMeanInitializer=Jn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Jn(e.movingVarianceInitializer||"ones"),this.betaConstraint=Zs(e.betaConstraint),this.gammaConstraint=Zs(e.gammaConstraint),this.betaRegularizer=ts(e.betaRegularizer),this.gammaRegularizer=ts(e.gammaRegularizer)}build(e){e=mn(e);const t=this.axis>=0?this.axis:this.axis+e.length,s=e[t];if(s==null)throw new me(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Ks({ndim:e.length,axes:{[t]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return ke(()=>{const s=t.training==null?!1:t.training,r=St(e),i=r.shape,a=i.length,o=Xo(0,a),l=this.axis>=0?this.axis:this.axis+a;o.splice(l,1);const c=Lf(1,a);c[l]=i[l];const h=o.slice();h.sort();const p=!xn(h,Xo(0,a).slice(0,a-1)),m=()=>{if(p){const C=_e(this.movingMean.read(),c),$=_e(this.movingVariance.read(),c),R=this.center?_e(this.beta.read(),c):null,P=this.scale?_e(this.gamma.read(),c):null;return dv(r,C,$,R,P,this.epsilon)}else return dv(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return m();const[v,x,w]=ENe(r,this.gamma.read(),this.beta.read(),o,this.epsilon),T=(C,$,R)=>{ke(()=>{const P=1-R,U=C.read(),j=ye(_t(U,$),P);C.write(_t(U,j))})};return(()=>{T(this.movingMean,x,this.momentum),T(this.movingVariance,w,this.momentum)})(),v})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ls(this.betaInitializer),gammaInitializer:ls(this.gammaInitializer),movingMeanInitializer:ls(this.movingMeanInitializer),movingVarianceInitializer:ls(this.movingVarianceInitializer),betaRegularizer:Mn(this.betaRegularizer),gammaRegularizer:Mn(this.gammaRegularizer),betaConstraint:Xs(this.betaConstraint),gammaConstraint:Xs(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}K9.className="BatchNormalization";We(K9);class X9 extends Ut{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Jn(e.betaInitializer||"zeros"),this.gammaInitializer=Jn(e.gammaInitializer||"ones"),this.betaRegularizer=ts(e.betaRegularizer),this.gammaRegularizer=ts(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=mn(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=t);for(const i of this.axis)if(i<0||i>=t)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Sh(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const s=St(e),r=s.shape,i=r.length;return ke(()=>{let{mean:o,variance:l}=U$(s,this.axis,!0);const c=Lf(1,i);for(const w of this.axis)c[w]=r[w];const h=w=>w!=null&&w.shape.length!==i?_e(w,c):w;let p=this.scale?h(this.gamma.read()):null,m=this.center?h(this.beta.read()):null;const v=[],x=[];for(let w=0;w<i;++w)this.axis.indexOf(w)!==-1?(v.push(r[w]),x.push(1)):(v.push(1),x.push(r[w]));return o=Bo(o,v),l=Bo(l,v),p!=null&&(p=Bo(p,x)),m!=null&&(m=Bo(m,x)),dv(s,o,l,m,p,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ls(this.betaInitializer),gammaInitializer:ls(this.gammaInitializer),betaRegularizer:Mn(this.betaRegularizer),gammaRegularizer:Mn(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}X9.className="LayerNormalization";We(X9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function NNe(n,e,t){return ke(()=>{if(n.rank!==4)throw new me(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new me("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=Zo()),t!=="channelsLast"&&t!=="channelsFirst")throw new me(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return t==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],G$(n,s)})}class Z9 extends Ut{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Zo():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new me(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,s;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new me(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new me(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[t,s]}this.inputSpec=[new Ks({ndim:4})]}computeOutputShape(e){e=mn(e);let t,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],t,s]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],t,s,e[3]])}call(e,t){return ke(()=>NNe(St(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}Z9.className="ZeroPadding2D";We(Z9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jT(n,e,t,s,r,i){return ke(()=>{Cs(r),dq(i),La(s),t==null&&(t=[1,1]),s==null&&(s="valid"),r==null&&(r=Zo()),i==null&&(i="max"),n=qA(n,r);let a;const o=s==="same"?"same":"valid";return i==="max"?a=V$(n,e,t,o):a=R$(n,e,t,o),r==="channelsFirst"&&(a=on(a,[0,3,1,2])),a})}function Y9(n,e,t,s,r,i){return ke(()=>{Cs(r),dq(i),La(s),t==null&&(t=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Zo()),i==null&&(i="max"),n=p9(n,r);let a;const o=s==="same"?"same":"valid";return i==="max"?a=a0e(n,e,t,o):a=l_e(n,e,t,o),r==="channelsFirst"&&(a=on(a,[0,4,1,2,3])),a})}class Q9 extends Ut{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new me(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(lr(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new me(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);lr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,La(this.padding),this.inputSpec=[new Ks({ndim:3})]}computeOutputShape(e){e=mn(e);const t=Wo(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return ke(()=>{this.invokeCallHook(e,t),e=Jb(St(e),2);const s=this.poolingFunction(St(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return qb(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class J9 extends Q9{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Cs(i),La(r),jT(e,t,s,r,i,"max")}}J9.className="MaxPooling1D";We(J9);class e8 extends Q9{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Cs(i),La(r),jT(e,t,s,r,i,"avg")}}e8.className="AveragePooling1D";We(e8);class t8 extends Ut{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new me(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];lr(this.poolSize,"poolSize"),lr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Cs(this.dataFormat),La(this.padding),this.inputSpec=[new Ks({ndim:4})]}computeOutputShape(e){e=mn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Wo(t,this.poolSize[0],this.padding,this.strides[0]),s=Wo(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s]:[e[0],t,s,e[3]]}call(e,t){return ke(()=>(this.invokeCallHook(e,t),this.poolingFunction(St(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class n8 extends t8{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Cs(i),La(r),jT(e,t,s,r,i,"max")}}n8.className="MaxPooling2D";We(n8);class s8 extends t8{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Cs(i),La(r),jT(e,t,s,r,i,"avg")}}s8.className="AveragePooling2D";We(s8);class r8 extends Ut{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new me(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];lr(this.poolSize,"poolSize"),lr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Cs(this.dataFormat),La(this.padding),this.inputSpec=[new Ks({ndim:5})]}computeOutputShape(e){e=mn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Wo(t,this.poolSize[0],this.padding,this.strides[0]),s=Wo(s,this.poolSize[1],this.padding,this.strides[1]),r=Wo(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s,r]:[e[0],t,s,r,e[4]]}call(e,t){return ke(()=>(this.invokeCallHook(e,t),this.poolingFunction(St(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class i8 extends r8{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Cs(i),La(r),Y9(e,t,s,r,i,"max")}}i8.className="MaxPooling3D";We(i8);class a8 extends r8{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Cs(i),La(r),Y9(e,t,s,r,i,"avg")}}a8.className="AveragePooling3D";We(a8);class o8 extends Ut{constructor(e){super(e),this.inputSpec=[new Ks({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new Mt}}class l8 extends o8{constructor(e){super(e||{})}call(e,t){return ke(()=>{const s=St(e);return Os(s,1)})}}l8.className="GlobalAveragePooling1D";We(l8);class c8 extends o8{constructor(e){super(e||{})}call(e,t){return ke(()=>{const s=St(e);return Go(s,1)})}}c8.className="GlobalMaxPooling1D";We(c8);class u8 extends Ut{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Cs(this.dataFormat),this.inputSpec=[new Ks({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new Mt}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class h8 extends u8{call(e,t){return ke(()=>{const s=St(e);return this.dataFormat==="channelsLast"?Os(s,[1,2]):Os(s,[2,3])})}}h8.className="GlobalAveragePooling2D";We(h8);class d8 extends u8{call(e,t){return ke(()=>{const s=St(e);return this.dataFormat==="channelsLast"?Go(s,[1,2]):Go(s,[2,3])})}}d8.className="GlobalMaxPooling2D";We(d8);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class f8 extends Ut{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,s={}){const r=t.layer,i=qc(r,s);delete t.layer;const a={layer:i};return Object.assign(a,t),new e(a)}}class p8 extends f8{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=mn(e),e.length<3)throw new me(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=mn(e);const t=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(t),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,t){return ke(()=>(e=St(e),T9((a,o)=>[St(this.layer.call(a,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}p8.className="TimeDistributed";We(p8);function INe(n){qf(KSe,"BidirectionalMergeMode",n)}const CNe="concat";class m8 extends f8{constructor(e){super(e);const t=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=t,this.forwardLayer=qc(s),t.goBackwards=t.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=qc(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?CNe:e.mergeMode,INe(this.mergeMode),e.weights)throw new Mt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,s=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let s,r,i;return this.returnState&&(i=t.slice(1)),s=t[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):Ri(r)}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const i=w9(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,t);const a=[],o=[];if(s!=null){const c=s.length;if(c%2>0)throw new me("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=s,a.push(...s);const h=s.map(p=>new Ks({shape:p.shape}));this.forwardLayer.stateSpec=h.slice(0,c/2),this.backwardLayer.stateSpec=h.slice(c/2),o.push(...h)}if(r!=null)throw new Mt("Support for constants in Bidirectional layers is not implemented yet.");const l=a[0]instanceof tc;for(const c of a)if(c instanceof tc!==l)throw new me("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(a),h=this.inputSpec.concat(o),p=this.inputSpec;this.inputSpec=h;const m=super.apply(c,t);return this.inputSpec=p,m}else return super.apply(e,t)}call(e,t){return ke(()=>{const s=t.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:c}))}let a;this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=Rf(i,1));let o;return this.mergeMode==="concat"?o=LA([r,i]):this.mergeMode==="sum"?o=Ke(r,i):this.mergeMode==="ave"?o=ye(.5,Ke(r,i)):this.mergeMode==="mul"?o=ye(r,i):this.mergeMode==null&&(o=[r,i]),this.returnState?this.mergeMode==null?o.concat(a):[o].concat(a):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){of(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),of(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[t,t]:s=t:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(a=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const s=qc(t.layer);if(delete t.layer,t.numConstants!=null)throw new Mt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=s,new e(r)}}m8.className="Bidirectional";We(m8);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class g8 extends Ut{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ke(()=>(e=St(e),e.dtype!=="float32"&&(e=zl(e,"float32")),Ke(ye(e,this.scale),this.offset)))}}g8.className="Rescaling";We(g8);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:kNe,cropAndResize:$Ne}=Vc;class y8 extends Ut{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,s,r,i,a,o,l){return ke(()=>{let c,h=!1;const p=t/a,m=s/o,v=(r+t)/a,x=(i+s)/o,w=[p,m,v,x],T=[];e.rank===3?(h=!0,c=tu([e])):c=e;for(let P=0;P<c.shape[0];P++)T.push(w);const E=LH(T,[T.length,4]),C=lv(0,T.length,1,"int32"),R=$Ne(c,E,C,[r,i],"nearest");return zl(h?St(Df(R)):R,l)})}upsize(e,t,s,r){return ke(()=>{const i=kNe(e,[t,s]);return zl(i,r)})}call(e,t){return ke(()=>{const s=St(e),r=s.dtype,i=s.shape,a=i[i.length-3],o=i[i.length-2];let l=0;a!==this.height&&(l=Math.floor((a-this.height)/2));let c=0;return o!==this.width&&(c=Math.floor((o-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,a,o,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=mn(e);const t=e.length-3,s=e.length-2;return e[t]=this.height,e[s]=this.width,e}}y8.className="CenterCrop";We(y8);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ANe(n,e,t,s){let r=St(n);if(r.dtype!=="int32"&&(r=zl(r,"int32")),e==="int")return r;const i=r.shape;if(r.rank===0&&(r=Ai(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=Ai(r,-1)),r.rank>2)throw new me(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${r.rank}.`);const a=["multiHot","oneHot"].includes(e),o=r;let l;if(typeof s<"u"&&e==="count"?l=e3(o,s,t,a):l=e3(o,[],t,a),e!=="tfIdf")return l;if(s)return ye(l,s);throw new me("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class v8 extends Ut{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=mn(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return ke(()=>{e=St(e),e.dtype!=="int32"&&(e=zl(e,"int32"));let s;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new me(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);s=St(t.countWeights)}const r=Go(e),i=t1(e),a=Da(this.numTokens,r).bufferSync().get(0),o=Gf(i,0).bufferSync().get(0);if(!(a&&o))throw new me(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return ANe(e,this.outputMode,this.numTokens,s)})}}v8.className="CategoryEncoding";We(v8);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const RNe=["bilinear","nearest"],D3=new Set(RNe);class b8 extends Ut{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(D3.has(e.interpolation))this.interpolation=e.interpolation;else throw new me(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=mn(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ke(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Vc.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Vc.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...D3]} are supported`)})}}b8.className="Resizing";We(b8);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _8{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}_8.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class x8 extends Ut{constructor(e){super(e),this.randomGenerator=new _8(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}x8.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const DNe=["bilinear","nearest"],L3=new Set(DNe);class w8 extends x8{constructor(e){super(e);const{factor:t,interpolation:s="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new me(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new me(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new me(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(L3.has(s))this.interpolation=s;else throw new me(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=mn(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return ke(()=>{const s=St(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Hb([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const a=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Vc.resizeBilinear(e,a);case"nearest":return Vc.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...L3]} are supported`)}})}}w8.className="RandomWidth";We(w8);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LNe=De();LNe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var O3;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(O3||(O3={}));var P3;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(P3||(P3={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var M3;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(M3||(M3={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function at(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&J(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ONe=v5;class BT extends P2{nextDataId(){return BT.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new GW(this,bl())}write(e,t,s){this.firstUse&&(this.firstUse=!1,De().get("IS_NODE")&&Na(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&Kv(s[0])){const i=s.map(a=>Th(a));r=this.write(i,e,t)}else r=this.write(s,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,s,r,i){this.data.set(e,{values:t,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:s}=this.data.get(e);if(t==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return nu(r,i)}return Eve(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>jh(r));return zt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return zt(e.shape,e.dtype,t)}makeOutput(e,t,s){return bl().makeTensorFromTensorInfo(this.makeTensorInfo(t,s,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=$i();return e(),{kernelMs:$i()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){at([e],"where");const t=this.readSync(e.dataId);return ONe(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}BT.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T8(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const PNe=n=>{const{x:e}=n.inputs,t=n.backend;at(e,"abs");let s=new Float32Array(Me(e.shape));const r=t.data.get(e.dataId).values;return s=T8(r),t.makeOutput(s,e.shape,e.dtype)},MNe={kernelName:yw,backendName:"cpu",kernelFunc:PNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ks(n){return(e,t,s,r,i)=>{const a=Rt(e,t),o=a.length,l=ht(a),c=Me(a),h=Br(i,c),p=e.length,m=t.length,v=ht(e),x=ht(t),w=km(e,a),T=km(t,a);if(w.length+T.length===0)for(let E=0;E<h.length;++E)h[E]=n(s[E%s.length],r[E%r.length]);else for(let E=0;E<h.length;++E){const C=Qm(E,o,l),$=C.slice(-p);w.forEach(j=>$[j]=0);const R=Fl($,p,v),P=C.slice(-m);T.forEach(j=>P[j]=0);const U=Fl(P,m,x);h[E]=n(s[R],r[U])}return[h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ea(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,o=t.makeTensorInfo(s.shape,"complex64"),l=t.data.get(o.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(s.shape,"float32",i),imag:t.makeTensorInfo(r.shape,"float32",a)},o}const FNe={kernelName:X2,backendName:"cpu",kernelFunc:ea};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1(n,e,t="float32"){if(t==="complex64"){const r=m1(n,e,"float32"),i=m1(n,e,"float32");return ea({inputs:{real:r,imag:i},backend:n})}const s=zr(Me(e),t);return n.makeTensorInfo(e,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nc(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const jNe={kernelName:mb,backendName:"cpu",kernelFunc:nc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Of(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.real,i=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,i)}const BNe={kernelName:b$,backendName:"cpu",kernelFunc:Of};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(n,e,t,s){if(s==="int32"){const r=Int32Array.from(n);return[e,"int32",r]}if(s==="bool"){const r=Uf([0],t),[i,a]=ks((o,l)=>o!==l?1:0)(e,[],n,r,"bool");return[a,"bool",i]}throw new Error(`Error in Cast: failed to cast ${t} to ${s}`)}function Gh(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return nc({inputs:{x:r},backend:t});const h=m1(t,r.shape,r.dtype),p=Gh({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),m=ea({inputs:{real:p,imag:h},backend:t});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),m}if(r.dtype==="complex64"){const h=Of({inputs:{input:r},backend:t}),p=Gh({inputs:{x:h},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(h),p}if(!qW(r.dtype,i)){const h=nc({inputs:{x:r},backend:t});return{dataId:h.dataId,shape:h.shape,dtype:i}}const a=t.data.get(r.dataId).values,[o,l,c]=S8(a,r.shape,r.dtype,i);return t.makeTensorInfo(o,l,c)}const zNe={kernelName:nb,backendName:"cpu",kernelFunc:Gh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qs(n,e,t,s){return t==null?({inputs:r,backend:i})=>{const{a,b:o}=r,l=i;at([a,o],n);const c=l.data.get(a.dataId).values,h=l.data.get(o.dataId).values,p=a.dtype==="string"?su(c):c,m=a.dtype==="string"?su(h):h,v=s||a.dtype,[x,w]=e(a.shape,o.shape,p,m,v);return l.makeTensorInfo(w,v,x)}:({inputs:r,backend:i})=>{const{a,b:o}=r,l=i;if(a.dtype==="complex64"||o.dtype==="complex64"){const c=Gh({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),h=l.data.get(c.dataId),p=h.complexTensorInfos.real,m=h.complexTensorInfos.imag,v=l.data.get(p.dataId).values,x=l.data.get(m.dataId).values,w=Gh({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),T=l.data.get(w.dataId),E=T.complexTensorInfos.real,C=T.complexTensorInfos.imag,$=l.data.get(E.dataId).values,R=l.data.get(C.dataId).values,[P,U,j]=t(a.shape,o.shape,v,x,$,R),O=l.makeTensorInfo(j,"float32",P),M=l.makeTensorInfo(j,"float32",U),B=ea({inputs:{real:O,imag:M},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(w),l.disposeIntermediateTensorInfo(O),l.disposeIntermediateTensorInfo(M),B}else{const c=l.data.get(a.dataId).values,h=l.data.get(o.dataId).values,p=s||a.dtype,[m,v]=e(a.shape,o.shape,c,h,p);return l.makeTensorInfo(v,p,m)}}}function JA(n){return(e,t,s,r,i,a)=>{const o=Rt(e,t),l=Me(o),c=o.length,h=ht(o),p=Br("float32",l),m=Br("float32",l),v=km(e,o),x=km(t,o),w=nu(s,r),T=nu(i,a),E=e.length,C=ht(e),$=t.length,R=ht(t);if(v.length+x.length===0)for(let P=0;P<p.length;P++){const U=P%w.length,j=P%T.length,O=n(w[U*2],w[U*2+1],T[j*2],T[j*2+1]);p[P]=O.real,m[P]=O.imag}else for(let P=0;P<p.length;P++){const U=Qm(P,c,h),j=U.slice(-E);v.forEach(W=>j[W]=0);const O=Fl(j,E,C),M=U.slice(-$);x.forEach(W=>M[W]=0);const B=Fl(M,$,R),D=n(w[O*2],w[O*2+1],T[B*2],T[B*2+1]);p[P]=D.real,m[P]=D.imag}return[p,m,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8=ks(((n,e)=>n+e)),VNe=JA(((n,e,t,s)=>({real:n+t,imag:e+s}))),Rm=Qs(Jm,E8,VNe),UNe={kernelName:Jm,backendName:"cpu",kernelFunc:Rm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eR(n,e,t,s,r){const i=Me(s),a=zr(r,t);for(let o=0;o<n.length;o++){const l=n[o];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?a[l]+=e[o]:a[l]+=1)}return a}function N8(n,e,t,s=!1){const r=n.shape[0],i=n.shape[1],a=zt([r,t],e.dtype);for(let o=0;o<r;o++)for(let l=0;l<i;l++){const c=n.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=t||(s?a.set(1,o,c):e.size>0?a.set(a.get(o,c)+e.get(o,l),o,c):a.set(a.get(o,c)+1,o,c))}return a}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I8=ks(((n,e)=>n&e)),GNe=Qs(K2,I8),WNe={kernelName:K2,backendName:"cpu",kernelFunc:GNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ic(n){return(e,t,s)=>{const r=ws(t,e.length);for(let i=0;i<e.length;++i)r[i]=n(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function In(n,e,t){const s=ic(e);return ld(n,s,t)}function ld(n,e,t){return({inputs:s,attrs:r,backend:i})=>{const{x:a}=s;at(a,n);const o=i,l=o.data.get(a.dataId).values;let c;if(a.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=su(l)}else c=l;const h=t||a.dtype,p=e(c,h,r);return o.makeTensorInfo(a.shape,h,p)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C8=ic(n=>Math.ceil(n)),HNe=ld(sb,C8),qNe={kernelName:sb,backendName:"cpu",kernelFunc:HNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8(n,e,t,s){const r=ws(t,Me(e));if(s&&t!=="string"){let i=0;n.forEach(a=>{const o=Me(a.shape);r.set(a.vals,i),i+=o})}else{let i=0;n.forEach(a=>{const o=t==="string"?su(a.vals):a.vals;let l=0;for(let c=0;c<a.shape[0];++c){const h=c*e[1]+i;for(let p=0;p<a.shape[1];++p)r[h+p]=o[l++]}i+=a.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $8=ks((n,e)=>n===e?1:0),A8=Qs(Rw,$8,null,"bool"),KNe={kernelName:Rw,backendName:"cpu",kernelFunc:A8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R8=ic(n=>Math.exp(n)),D8=ld(ub,R8,"float32"),XNe={kernelName:ub,backendName:"cpu",kernelFunc:D8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L8=ic(n=>Math.expm1(n)),ZNe=ld(hb,L8),YNe={kernelName:hb,backendName:"cpu",kernelFunc:ZNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8=ic(n=>Math.floor(n)),QNe=ld(db,O8),JNe={kernelName:db,backendName:"cpu",kernelFunc:QNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P8=ks((n,e)=>Math.floor(n/e)),eIe=Qs(fb,P8,null,"int32"),tIe={kernelName:fb,backendName:"cpu",kernelFunc:eIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M8(n,e,t,s,r,i,a,o,l){const c=zt([s,i],t);for(let h=0;h<s;h++){const p=[];let m=0;for(let v=0;v<r;v++){const x=n[h*r+v];m+=x*a[v],p.push(x)}if(m<0||m>=l/i)throw new Error(`Invalid indices: ${p} does not index into ${o}`);for(let v=0;v<i;v++)c.values[h*i+v]=e.get(...e.indexToLoc(m*i+v))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F8(n,e,t){const s=zt(t,n.dtype);for(let r=0;r<s.size;++r){const a=s.indexToLoc(r).slice(),o=a[0],l=a[2],c=e.locToIndex([o,l]);a[2]=e.values[c];const h=n.locToIndex(a);0<=h&&h<n.values.length&&(s.values[r]=n.values[h])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j8=ks((n,e)=>n>e?1:0),nIe=Qs(Pw,j8,null,"bool"),sIe={kernelName:Pw,backendName:"cpu",kernelFunc:nIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B8=ks((n,e)=>n>=e?1:0),rIe=Qs(pb,B8,null,"bool"),iIe={kernelName:pb,backendName:"cpu",kernelFunc:rIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z8=ks((n,e)=>n<e?1:0),aIe=Qs(Fw,z8,null,"bool"),oIe={kernelName:Fw,backendName:"cpu",kernelFunc:aIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V8=ks((n,e)=>n<=e?1:0),lIe=Qs(jw,V8,null,"bool"),cIe={kernelName:jw,backendName:"cpu",kernelFunc:lIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8(n,e,t){const s=(e-n)/(t-1),r=zr(t,"float32");r[0]=n;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G8=ic(n=>Math.log(n)),uIe=ld(bb,G8),hIe={kernelName:bb,backendName:"cpu",kernelFunc:uIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(n,e,t,s){const r=Br(s,Me(t));for(let i=0;i<r.length;++i){const a=i*e;let o=n[a];for(let l=0;l<e;++l){const c=n[a+l];(Number.isNaN(c)||c>o)&&(o=c)}r[i]=o}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H8=ks(((n,e)=>Math.max(n,e))),dIe=Qs(xb,H8),fIe={kernelName:xb,backendName:"cpu",kernelFunc:dIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q8=ks(((n,e)=>Math.min(n,e))),pIe=Qs(wb,q8),mIe={kernelName:wb,backendName:"cpu",kernelFunc:pIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tR=ks(((n,e)=>n*e)),gIe=JA(((n,e,t,s)=>({real:n*t-e*s,imag:n*s+e*t}))),zT=Qs(Sb,tR,gIe),yIe={kernelName:Sb,backendName:"cpu",kernelFunc:zT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(n,e,t){const s=td(-1,t);return tR([],e,s,n,t)}function vIe(n){const{inputs:e,backend:t}=n,{x:s}=e;at(s,"neg");const r=t.data.get(s.dataId).values,[i,a]=K8(r,s.shape,s.dtype);return t.makeTensorInfo(a,s.dtype,i)}const bIe={kernelName:Zw,backendName:"cpu",kernelFunc:vIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X8=ks(((n,e)=>n!==e?1:0)),_Ie=Qs(Yw,X8,null,"bool"),xIe={kernelName:Yw,backendName:"cpu",kernelFunc:_Ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nR(n,e,t,s,r){const i=e.length,a=Me(e),o=ht(e),l=ht(r),c=Br(t,Me(r));for(let h=0;h<a;++h){const p=Qm(h,i,o),m=new Array(p.length);for(let x=0;x<m.length;x++)m[x]=p[s[x]];const v=Fl(m,i,l);c[v]=n[h]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oi(n){const{inputs:e,attrs:t,backend:s}=n,{x:r}=e,{perm:i}=t;at(r,"transpose");const a=r.shape.length,o=new Array(a);for(let p=0;p<o.length;p++)o[p]=r.shape[i[p]];const l=s.data.get(r.dataId).values,c=nR(l,r.shape,r.dtype,i,o);return{dataId:s.write(c,o,r.dtype),shape:o,dtype:r.dtype}}const wIe={kernelName:cm,backendName:"cpu",kernelFunc:Oi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(n,e,t,s){const[r,i]=ur(n,s),a=ra(e,"int32"),o=zr(Me(r),a),l=Me(i);for(let c=0;c<o.length;++c){const h=c*l;let p=1;for(let m=0;m<l;++m)p*=t[h+m];o[c]=p}return{outVals:o,outShape:r,outDtype:a}}function TIe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;at(r,"prod");const o=r.shape.length,l=Vt(i,r.shape),c=us(l,o);let h=l,p=r;const m=[];c!=null&&(p=Oi({inputs:{x:r},backend:t,attrs:{perm:c}}),m.push(p),h=Is(h.length,o));const v=t.data.get(p.dataId).values,{outVals:x,outShape:w,outDtype:T}=Z8(p.shape,p.dtype,v,h);let E=w;return a&&(E=js(w,l)),m.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.makeTensorInfo(E,T,x)}const SIe={kernelName:sT,backendName:"cpu",kernelFunc:TIe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EIe(n,e,t){n.forEach((s,r)=>{if(s<0||s>=t){const i=Qm(r,e.length,ht(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${t})`)}})}function NIe(n,e){for(let t=0;t<n.length;++t){const s=n[t],r=t===n.length-1?e:n[t+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function IIe(n,e,t,s){const r=[];let i=0;const a=e.length-1+t.length,o=new Array(a).fill(null).map(()=>[0]);NIe(t,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const h=e[c+1];for(let p=1;p<l+1;++p)o[c].push(p*h)}for(let c=0;c<n.length;++c){let h=n[c],p=n[c]+1;for(let m=0;m<t.length;++m){const v=t[m],x=m+e.length-1;if(x>=0){const w=o[x],T=w[w.length-1]-v[h];for(let E=h;E<p;++E)o[x].push(v[E+1]+T)}h=v[h],p=v[p]}p!==h&&(r.push([h,p]),i+=p-h)}return{outSplits:o,valueSlices:r,numValues:i}}function CIe(n){const e=[];for(let t=0;t<n.length;++t){const s=n[t].length,r=ws("int32",s);e.push(r),n[t].forEach((i,a)=>r[a]=i)}return e}function F3(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let s=e;s<n.length;s++)t[e-1]*=n[s];return t}function kIe(n,e,t,s,r,i){const a=F3(e,2)[1],o=F3(i,2)[1];let l=0;for(const c of t)for(let h=c[0];h<c[1];++h){for(let p=0;p<s;++p)r[l*o+p]=n[h*a+p];++l}}function $Ie(n,e,t,s,r){const i=e.slice();i[0]=r;const a=ws(t,Me(i)),o=n.length,l=o===0?0:o/e[0];return kIe(n,e,s,l,a,i),[a,i]}function Y8(n,e,t,s,r,i,a,o){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(EIe(i,a,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:h,valueSlices:p,numValues:m}=IIe(i,a,n,c),v=CIe(h),x=$Ie(t,s,r,p,m);return[v,x[0],x[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j3=2147483647;function Q8(n,e,t,s,r,i,a){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const o=e.length===0,l=r.length===0,c=a.length===0,h=[];o||h.push(e[0]),l||h.push(r[0]),c||h.push(a[0]);for(let T=1;T<h.length;++T)if(h[T]!==h[T-1])throw new Error("starts, limits, and deltas must have the same shape");const p=h.length===0?1:h[0],m=ws("int32",p+1);m[0]=0;for(let T=0;T<p;++T){const E=o?n[0]:n[T],C=l?s[0]:s[T],$=c?i[0]:i[T];if($===0)throw new Error("Requires delta != 0");let R;if($>0&&C<E||$<0&&C>E)R=0;else if(R=Math.ceil(Math.abs((C-E)/$)),R>j3)throw new Error(`Requires ((limit - start) / delta) <= ${j3}`);m[T+1]=m[T]+R}const v=m[p],x=ws(t,v);let w=0;for(let T=0;T<p;++T){const E=m[T+1]-m[T];let C=o?n[0]:n[T];const $=c?i[0]:i[T];for(let R=0;R<E;++R)x[w++]=C,C+=$}return[m,x]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Qa=Fo;class g1{constructor(e,t,s,r,i,a,o,l,c,h){this.shape=e,this.shapeShape=t,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=a,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=M5(h),this.raggedRank=F5(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Qa.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Qa.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Qa.VALUE_ROWIDS:return g1.getMaxWidthValueRowID(t);case Qa.ROW_SPLITS:return g1.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Qa[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let s=0;for(let r=0;r<t-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let s=0,r=e[0],i=0;for(let a=1;a<t;++a){const o=e[a];o!==r&&(r=o,i=Math.max(a-s,i),s=a)}return Math.max(t-s,i)}tensorShapeFromTensor(e,t,s=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return z3(e,s)}calculateOutputSize(e){const t=this.valuesShape,s=this.defaultValueShape;j5(s,t);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=P5(this.raggedRank,r,t);a[0]<0&&(a[0]=e);for(let o=1;o<=this.raggedRank;++o)a[o]<0&&(a[o]=this.getMaxWidth(o));return a}calculateFirstParentOutputIndex(e,t,s){const r=Math.min(e,s),i=[];let a=0;for(let o=0;o<r;++o,a+=t)i.push(a);for(let o=r;o<e;++o)i.push(-1);return J(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,t,s,r){const i=e.length,a=[];for(let o=0;o<i-1;++o){const l=e[o+1]-e[o];let c=Math.min(r,l),h=t[o];h===-1&&(c=0);for(let p=0;p<c;++p)a.push(h),h+=s;for(let p=0;p<l-c;++p)a.push(-1)}if(i>0&&a.length!==e[i-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,t,s,r){const i=e.length,a=[];if(i===0)return[];let o=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let c=t[l];a.push(c);for(let h=1;h<i;++h){const p=e[h];if(p===l)c>=0&&(++o,o<r?c+=s:c=-1);else{if(o=0,l=p,p>=t.length)throw new Error(`Got nextValueRowId=${p} which is not less than ${t.length}`);c=t[p]}a.push(c)}if(a.length!==e.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(e,t,s,r){const i=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case Qa.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,s,r);case Qa.ROW_SPLITS:if(i.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,s,r);default:throw new Error(`Unsupported partition type: ${Qa[a]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Qa.FIRST_DIM_SIZE:return e[0];case Qa.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Qa.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Qa[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),s=this.calculateOutputSize(t),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=z3(s,!1),a=ws(this.valuesDType,Me(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(t,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,a,i)}return[i,a]}setOutput(e,t,s,r){if(s.length===0)return;const i=this.values,a=s;let o=r.slice();o=o.slice(e+1);const l=Me(o),c=t.length;let h=this.defaultValue;if(h.length!==l&&h.length!==1){const x=this.defaultValueShape;ke(()=>{const w=_e(h,x);h=Oy(w,o).dataSync()})}let p=0,m=0,v=0;for(let x=0;x<=c;++x){let w=x<c?t[x]:-1;if(w===v){++v;continue}if(m<v){const T=i.subarray(p*l),E=a.subarray(m*l),C=(v-m)*l;B3(E,T,C)}if(x>=c){const T=s.length;w=Math.floor(T/l)}if(w>v)if(this.defaultValue.length===1)a.subarray(v*l,w*l).fill(this.defaultValue[0]),v=w;else for(;w>v;){const T=a.slice(v*l);B3(T,h,l),++v}w<0?(p=x+1,m=v):(p=x,m=v,v=m+1)}}}function B3(n,e,t){for(let s=0;s<t;s++)n[s]=e[s]}function z3(n,e){const t=[];for(let s of n){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}t.push(s)}return t}function J8(n,e,t,s,r,i,a,o,l,c){return new g1(n,e,t,s,r,i,a,o,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eK(n,e,t,s){const r=n===e,i=n<e&&t<0,a=e<n&&t>1;if(r||i||a)return zr(0,s);const o=Math.abs(Math.ceil((e-n)/t)),l=zr(o,s);e<n&&t===1&&(t=-1),l[0]=n;for(let c=1;c<l.length;c++)l[c]=l[c-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tK=ic(n=>1/Math.sqrt(n)),AIe=ld($b,tK),RIe={kernelName:$b,backendName:"cpu",kernelFunc:AIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qd(n,e,t,s,r,i,a,o,l,c){const h=[s/r,r],p=n.values,m=e.values;if(s===0)return zt(t,e.dtype);const v=l instanceof Er?l:zt(h,e.dtype);typeof l=="string"||typeof l=="number"?v.values.fill(l):typeof l=="boolean"&&v.values.fill(+l);for(let x=0;x<i;x++){const w=[];let T=0;for(let E=0;E<a;E++){const C=p[x*a+E];w.push(C),T+=C*o[E]}if(T<0||T>=s/r)throw new Error(`Invalid indices: ${w} does not index into ${t}`);for(let E=0;E<r;E++)c?v.values[T*r+E]+=m[x*r+E]:v.values[T*r+E]=e.rank===0?m[0]:m[x*r+E]}return v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DIe=ic(n=>1/(1+Math.exp(-n))),nK=In(Ob,n=>1/(1+Math.exp(-n))),LIe={kernelName:Ob,backendName:"cpu",kernelFunc:nK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sK(n,e,t,s,r){const i=cA(s,e,t),a=Me(t),o=ht(s);if(i){const p=uA(e,o);return r==="string"?n.slice(p,p+a):n.subarray(p,p+a)}const l=r==="string"?su(n):n,c=zt(s,r,l),h=zt(t,r);for(let p=0;p<h.size;++p){const m=h.indexToLoc(p),v=m.map((x,w)=>x+e[w]);h.set(c.get(...v),...m)}return r==="string"?iq(h.values):h.values}function Pf(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:i,size:a}=s;at(r,"slice");const[o,l]=NT(r,i,a);oA(r,o,l);const c=t.data.get(r.dataId).values,h=sK(c,o,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,h)}const OIe={kernelName:cT,backendName:"cpu",kernelFunc:Pf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rK(n,e,t,s,r,i,a){const o=e[0],l=i[0],c=new Array(l),h=new Array(o),p=e[1];if(l===0){if(o!==0)throw new Error(H5(o));const T=ws(t,0),E=ws(r,0);return[T,[0,p],E,c,h]}let m=!0,v=0;const x=new Array(l).fill(0);for(let T=0;T<o;++T){const E=n[T*p];if(E<0)throw new Error(q5(T,E));if(E>=l)throw new Error(K5(T,E,l));++x[E],m=m&&E>=v,v=E}let w=!0;for(let T=0;T<l;++T){const E=x[T]===0;c[T]=E,w=w&&!E,x[T]=Math.max(x[T],1),T>0&&(x[T]+=x[T-1])}if(w&&m){const T=n,E=s;for(let C=0;C<o;++C)h[C]=C;return[T,[o,p],E,c,h]}else{const T=x[l-1],E=ws(t,T*p),C=ws(r,T),$=new Array(l).fill(0);for(let R=0;R<o;++R){const P=n[R*p],U=$[P],j=(P===0?0:x[P-1])+U;$[P]++;for(let O=0;O<p;++O)E[j*p+O]=n[R*p+O];C[j]=s[R],h[R]=j}for(let R=0;R<l;++R)if($[R]===0){const U=R===0?0:x[R-1];E[U*p+0]=R;for(let j=1;j<p;++j)E[U*p+j]=0;C[U]=a}return[E,[T,p],C,c,h]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(n,e,t,s,r){const i=Me(s),a=e[0],o=r.length,l=[];let c=1,h=-1;for(let T=0;T<o;++T){const E=r[T];if(E===-1){if(h!==-1)throw new Error(X5(h,T));h=T,l.push(1)}else{if(E<0)throw new Error(Z5(T,E));c*=E,l.push(E)}}if(h!==-1){if(c<=0)throw new Error(Y5());const T=Math.trunc(i/c);if(c*T!==i)throw new Error(Q5(s,l));l[h]=T}if(Me(l)!==i)throw new Error(J5(s,l));const m=s.length,v=[];if(m>0){v[m-1]=1;for(let T=m-2;T>=0;--T)v[T]=v[T+1]*s[T+1]}const x=[];if(o>0){x[o-1]=1;for(let T=o-2;T>=0;--T)x[T]=x[T+1]*l[T+1]}const w=ws(t,a*o);for(let T=0;T<a;++T){let E=0;for(let C=0;C<m;++C)E+=n[T*m+C]*v[C];for(let C=0;C<o;++C)w[T*o+C]=Math.trunc(E/x[C]),E%=x[C]}return[w,[a,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sR(n,e,t,s,r,i=!1,a=0){const o=s.length,l=[e[0],n.length/e[0]],c=l[1],p=o>0?r[o-1]+1:0;if(p<0)throw new Error(eC());const m=e.slice();m[0]=p;const v=m.reduce(($,R)=>$*R,1),x=ws(t,v);if(o===0)return p>0&&x.fill(a),[x,m];if(p<=0)throw new Error(eC());let w=0,T=1,E=0,C=r[w];for(;;){let $=0;if(T<o){if($=r[T],C===$){++T;continue}if(C>=$)throw new Error(eq())}if(C<0||C>=p)throw new Error(tq(C,p));C>E&&x.fill(a,E*c,C*c);for(let R=w;R<T;++R){const P=s[R];if(P<0||P>=l[0])throw new Error(nq(R,s[R],l[0]));for(let U=0;U<c;U++)x[C*c+U]+=n[P*c+U]}if(i)for(let R=0;R<c;R++)x[C*c+R]/=T-w;if(w=T,++T,E=C+1,C=$,T>o)break}return E<p&&x.fill(a,E*c,p*c),[x,m]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PIe=ic(n=>Math.sqrt(n)),MIe=In(Mb,n=>Math.sqrt(n)),FIe={kernelName:Mb,backendName:"cpu",kernelFunc:MIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aK=ks(((n,e)=>{const t=n-e;return t*t})),jIe=Qs(Fb,aK),BIe={kernelName:Fb,backendName:"cpu",kernelFunc:jIe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oK=ic((n,e)=>{const{pattern:t,replaceGlobal:s,rewrite:r}=e;return n.replace(new RegExp(t,s?"g":""),r)}),zIe=ld(T$,oK),VIe={kernelName:T$,backendName:"cpu",kernelFunc:zIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(n,e,t,s){const r=zt(n,e.dtype);for(let i=0;i<r.size;i++){const a=r.indexToLoc(i),o=new Array(a.length);for(let l=0;l<o.length;l++)o[l]=a[l]*t[l]+s[l];r.set(e.get(...o),...a)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UIe{constructor(e,t,s,r,i,a){this.separator=Th(e),this.nGramWidths=t,this.leftPad=Th(s),this.rightPad=Th(r),this.padWidth=i,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const s=this.getPadWidth(t);return Math.max(0,e+2*s-t+1)}createNGrams(e,t,s,r,i,a){for(let o=0;o<i;++o){const l=this.getPadWidth(a),c=Math.max(0,l-o),h=Math.max(0,l-(i-(o+1))),p=a-(c+h),m=t+(c>0?0:o-l);let v=0;v+=c*this.leftPad.length;for(let C=0;C<p;++C)v+=e[m+C].length;v+=h*this.rightPad.length;const x=c+h+p-1;v+=x*this.separator.length,s[r+o]=new Uint8Array(v);const w=s[r+o];let T=0;const E=C=>C.forEach($=>w[T++]=$);for(let C=0;C<c;++C)E(this.leftPad),E(this.separator);for(let C=0;C<p-1;++C)E(e[m+C]),E(this.separator);if(p>0){E(e[m+p-1]);for(let C=0;C<h;++C)E(this.separator),E(this.rightPad)}else{for(let C=0;C<h-1;++C)E(this.rightPad),E(this.separator);E(this.rightPad)}}}compute(e,t){const s=e.length,r=t.length;if(r>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let h=t[c]>=l;if(h=h&&t[c]<=s,!h)throw new Error(`Invalid split value ${t[c]}, must be in [${l}, ${s}]`);l=t[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,a=ws("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)a[c]=0;return[l,a]}a[0]=0;for(let l=1;l<=i;++l){const c=t[l]-t[l-1];let h=0;this.nGramWidths.forEach(p=>{h+=this.getNumNGrams(c,p)}),this.preserveShort&&c>0&&h===0&&(h=1),a[l]=a[l-1]+h}const o=new Array(a[i]);for(let l=0;l<i;++l){const c=t[l];let h=a[l];if(this.nGramWidths.forEach(p=>{const m=t[l+1]-t[l],v=this.getNumNGrams(m,p);this.createNGrams(e,c,o,h,v,p),h+=v}),this.preserveShort&&h===a[l]){const p=t[l+1]-t[l];if(p===0)continue;const m=p+2*this.padWidth;this.createNGrams(e,c,o,h,1,m)}}return[o,a]}}function cK(n,e,t,s,r,i,a,o){return new UIe(t,s,r,i,a,o).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GIe(n,e,t,s){if(!n.length)return;if(e.length===0){for(let i=0;i<n.length;++i)s.push(n.subarray(i,i+1));return}if(e.length===1){const i=e[0];let a=n.indexOf(i);for(;a!==-1;){const o=n.subarray(0,a);(!t||o.length!==0)&&s.push(o),n=n.subarray(a+1),a=n.indexOf(i)}(!t||n.length!==0)&&s.push(n);return}let r=0;for(let i=0;i<n.length+1;i++)if(i===n.length||e.indexOf(n[i])!==-1){const a=n.subarray(r,i);(!t||a.length!==0)&&s.push(a),r=i+1}}function uK(n,e,t){const s=n.length,r=[];let i=0,a=0;const o=new Array(s);for(let m=0;m<s;++m){const v=r.length;GIe(n[m],e,t,r);const x=r.length-v;o[m]=x,i+=x,a=Math.max(a,x)}const l=ws("int32",i*2),c=new Array(i),h=[s,a];let p=0;for(let m=0;m<s;++m)for(let v=0;v<o[m];++v)l[p*2]=m,l[p*2+1]=v,c[p]=r[p],++p;return[l,c,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hK(n,e){const t=ws("int32",n.length);for(let s=0;s<n.length;++s)t[s]=Vve(n[s]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dK=ks(((n,e)=>n-e)),WIe=JA(((n,e,t,s)=>({real:n-t,imag:e-s}))),rR=Qs(jb,dK,WIe),HIe={kernelName:jb,backendName:"cpu",kernelFunc:rR};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fK(n,e){const t=new Array(n.rank);for(let r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];const s=zt(t,n.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),a=new Array(n.rank);for(let l=0;l<a.length;l++)a[l]=i[l]%n.shape[l];const o=n.locToIndex(a);s.values[r]=n.values[o]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ty=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function pK(n,e,t=0,s=n.length-1){for(;s>t;){if(s-t>600){const o=s-t+1,l=e-t+1,c=Math.log(o),h=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*h*(o-h)/o)*Math.sign(l-o/2),m=Math.max(t,Math.floor(e-l*h/o+p)),v=Math.min(s,Math.floor(e+(o-l)*h/o+p));pK(n,e,m,v)}const r=n[e];let i=t,a=s;for(qp(n,t,e),Ty(n[s],r)>0&&qp(n,t,s);i<a;){for(qp(n,i,a),i++,a--;Ty(n[i],r)<0;)i=i+1;for(;Ty(n[a],r)>0;)a=a-1}Ty(n[t],r)===0?qp(n,t,a):(a=a+1,qp(n,a,s)),a<=e&&(t=a+1),e<=a&&(s=a-1)}}function mK(n,e,t,s,r){const i=e[e.length-1],[a,o]=[n.length/i,i],l=Br(t,a*s),c=Br("int32",a*s);for(let p=0;p<a;p++){const m=p*o,v=n.subarray(m,m+o);let x=new Array(v.length);v.forEach((C,$)=>x[$]={value:C,index:$}),s<x.length&&(pK(x,s),x=x.slice(0,s)),r&&x.sort(Ty);const w=p*s,T=l.subarray(w,w+s),E=c.subarray(w,w+s);for(let C=0;C<s;C++)T[C]=x[C].value,E[C]=x[C].index}const h=e.slice();return h[h.length-1]=s,[zt(h,t,l),zt(h,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gK(n,e,t,s){const r=Vt(e,t)[0],i=[1,t[0],1];for(let x=0;x<r;x++)i[0]*=t[x];i[1]=t[r];for(let x=r+1;x<t.length;x++)i[2]*=t[x];const a=new Map,o=new Int32Array(t[r]),l=new Er(i,s,n),c=[],h=i[0]===1&&i[2]===1;for(let x=0;x<t[r];x++){let w;if(h)w=n[x].toString();else{const E=[];for(let C=0;C<i[0];C++)for(let $=0;$<i[2];$++)E.push(l.get(C,x,$));w=E.join(",")}const T=a.get(w);if(T!=null)o[x]=T;else{const E=a.size;a.set(w,E),o[x]=E,c.push(x)}}const p=i.slice();p[1]=a.size;const m=new Er(p,s);c.forEach((x,w)=>{for(let T=0;T<i[0];T++)for(let E=0;E<i[2];E++)m.set(l.get(T,x,E),T,w,E)});const v=t.slice();return v[r]=p[1],{outputValues:m.values,outputShape:v,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qIe=Object.freeze(Object.defineProperty({__proto__:null,addImpl:E8,bincountImpl:eR,bincountReduceImpl:N8,bitwiseAndImpl:I8,castImpl:S8,ceilImpl:C8,concatImpl:k8,equalImpl:$8,expImpl:R8,expm1Impl:L8,floorDivImpl:P8,floorImpl:O8,gatherNdImpl:M8,gatherV2Impl:F8,greaterEqualImpl:B8,greaterImpl:j8,lessEqualImpl:V8,lessImpl:z8,linSpaceImpl:U8,logImpl:G8,maxImpl:W8,maximumImpl:H8,minimumImpl:q8,multiplyImpl:tR,negImpl:K8,notEqualImpl:X8,prodImpl:Z8,raggedGatherImpl:Y8,raggedRangeImpl:Q8,raggedTensorToTensorImpl:J8,rangeImpl:eK,rsqrtImpl:tK,scatterImpl:Qd,sigmoidImpl:DIe,simpleAbsImpl:T8,sliceImpl:sK,sparseFillEmptyRowsImpl:rK,sparseReshapeImpl:iK,sparseSegmentReductionImpl:sR,sqrtImpl:PIe,squaredDifferenceImpl:aK,staticRegexReplaceImpl:oK,stridedSliceImpl:lK,stringNGramsImpl:cK,stringSplitImpl:uK,stringToHashBucketFastImpl:hK,subImpl:dK,tileImpl:fK,topKImpl:mK,transposeImpl:nR,uniqueImpl:gK},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */OH("cpu",()=>new BT,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yK=In(lb,n=>n>=0?n:Math.exp(n)-1),KIe={kernelName:lb,backendName:"cpu",kernelFunc:yK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vK(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:i}=s;at([r],"leakyRelu");const a=Me(r.shape),o=t.data.get(r.dataId).values,l=Br("float32",a);for(let c=0;c<o.length;c++)l[c]=o[c]<0?i*o[c]:o[c];return t.makeTensorInfo(r.shape,"float32",l)}const XIe={kernelName:Mw,backendName:"cpu",kernelFunc:vK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZIe=ks((n,e)=>n<0?e*n:n);function bK(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e;at([s,r],"prelu");const i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,[o,l]=ZIe(s.shape,r.shape,i,a,"float32");return t.makeTensorInfo(l,"float32",o)}const YIe={kernelName:nT,backendName:"cpu",kernelFunc:bK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _K=In(Ib,n=>Math.max(0,n)),QIe={kernelName:Ib,backendName:"cpu",kernelFunc:_K};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xK=In(Cb,n=>Math.min(Math.max(0,n),6)),JIe={kernelName:Cb,backendName:"cpu",kernelFunc:xK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y1(n,e,t,s,r){if(t==="linear")return nc({inputs:{x:e},backend:n});if(t==="relu")return _K({inputs:{x:e},backend:n});if(t==="elu")return yK({inputs:{x:e},backend:n});if(t==="relu6")return xK({inputs:{x:e},backend:n});if(t==="prelu")return bK({inputs:{x:e,alpha:s},backend:n});if(t==="leakyrelu")return vK({inputs:{x:e},backend:n,attrs:{alpha:r}});if(t==="sigmoid")return nK({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gn(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:i}=s,a=Me(r.shape),o=HW(i,a),l=Me(o);J(a===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`),t.incRef(r.dataId);const c=t.data.get(r.dataId);if(c.complexTensorInfos!=null){const h=c.complexTensorInfos.real,p=c.complexTensorInfos.imag;h.shape=o,p.shape=o}return{dataId:r.dataId,shape:o,dtype:r.dtype}}const eCe={kernelName:rT,backendName:"cpu",kernelFunc:Gn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wK(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:i}=e,{transposeA:a,transposeB:o}=s;at([r,i],"matMul");const l=r.shape.length,c=i.shape.length,h=a?r.shape[l-2]:r.shape[l-1],p=o?i.shape[c-1]:i.shape[c-2],m=a?r.shape[l-1]:r.shape[l-2],v=o?i.shape[c-2]:i.shape[c-1],x=r.shape.slice(0,-2),w=i.shape.slice(0,-2),T=Me(x),E=Me(w),$=Rt(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([m,v]);J(h===p,()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${a} and transposeB=${o} must match.`);const R=a?[T,h,m]:[T,m,h],P=o?[E,v,p]:[E,p,v],U=Gn({inputs:{x:r},backend:t,attrs:{shape:R}}),j=Gn({inputs:{x:i},backend:t,attrs:{shape:P}}),O=a?U.shape[1]:U.shape[2],M=a?U.shape[2]:U.shape[1],B=o?j.shape[1]:j.shape[2],D=Math.max(T,E),W=t.data.get(U.dataId).values,H=t.data.get(j.dataId).values,ae=ht(U.shape),te=ht(j.shape),[Z,re,ne]=a?[ae[0],1,ae[1]]:[ae[0],ae[1],1],[he,K,ie]=o?[1,te[1],te[0]]:[te[1],1,te[0]],pe=M*B,fe=zt([D,M,B],U.dtype),Ne=fe.values,Te=t.blockSize;for(let Se=0;Se<D;Se++){const He=Se%T,qe=Se%E;for(let Qe=0;Qe<M;Qe+=Te){const pt=Math.min(Qe+Te,M);for(let vt=0;vt<B;vt+=Te){const Lt=Math.min(vt+Te,B);for(let Gt=0;Gt<O;Gt+=Te){const gn=Math.min(Gt+Te,O);for(let un=Qe;un<pt;un++)for(let qt=vt;qt<Lt;qt++){let Ot=0;for(let sn=Gt;sn<gn;sn++){const wn=W[He*Z+un*re+sn*ne],jt=H[sn*he+qt*K+qe*ie];Ot+=wn*jt}Ne[Se*pe+(un*B+qt)]+=Ot}}}}}return t.disposeIntermediateTensorInfo(U),t.disposeIntermediateTensorInfo(j),t.makeTensorInfo($,fe.dtype,fe.values)}const tCe={kernelName:ww,backendName:"cpu",kernelFunc:wK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nCe(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:h,leakyreluAlpha:p}=s;let m,v,x;const w=[];m=wK({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:t}),a&&(v=Rm({inputs:{a:m,b:a},backend:t}),w.push(m),m=v),h&&(x=y1(t,m,h,o,p),w.push(m),m=x);for(const E of w)t.disposeIntermediateTensorInfo(E);return m}const sCe={kernelName:Y0,backendName:"cpu",kernelFunc:nCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rCe=In(Xv,n=>Math.acos(n)),iCe={kernelName:Xv,backendName:"cpu",kernelFunc:rCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aCe=In(Zv,n=>Math.acosh(n)),oCe={kernelName:Zv,backendName:"cpu",kernelFunc:aCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lCe(n){const{inputs:e,backend:t}=n,s=e;at(e,"addN");const r=s.map(o=>t.data.get(o.dataId).values),i=zt(s[0].shape,s[0].dtype),a=i.values;for(let o=0;o<s.length;o++){const l=r[o];for(let c=0;c<a.length;c++)a[c]+=l[c]}return t.makeTensorInfo(i.shape,i.dtype,i.values)}const cCe={kernelName:V2,backendName:"cpu",kernelFunc:lCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;at(r,"all");const o=Vt(i,r.shape);let l=o;const c=us(l,r.shape.length);let h=r;c!=null&&(h=Oi({inputs:{x:r},backend:t,attrs:{perm:c}}),l=Is(l.length,r.shape.length)),Ir("all",l,h.shape.length);const[p,m]=ur(h.shape,l),v=Me(m),x=zr(Me(p),h.dtype),w=t.data.get(h.dataId).values;for(let E=0;E<x.length;++E){const C=E*v;let $=w[C];for(let R=0;R<v;++R){const P=w[C+R];$=$&&P}x[E]=$}c!=null&&t.disposeIntermediateTensorInfo(h);const T=t.makeTensorInfo(p,h.dtype,x);if(a){const E=js(p,o),C=Gn({inputs:{x:T},backend:t,attrs:{shape:E}});return t.disposeIntermediateTensorInfo(T),C}return T}const hCe={kernelName:U2,backendName:"cpu",kernelFunc:uCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;at(r,"any");const o=Vt(i,r.shape);let l=o;const c=us(l,r.shape.length);let h=r;c!=null&&(h=Oi({inputs:{x:r},backend:t,attrs:{perm:c}}),l=Is(l.length,r.shape.length)),Ir("any",l,h.shape.length);const[p,m]=ur(h.shape,l),v=Me(m),x=zr(Me(p),h.dtype),w=t.data.get(h.dataId).values;for(let E=0;E<x.length;++E){const C=E*v;let $=w[C];for(let R=0;R<v;++R){const P=w[C+R];$=$||P}x[E]=$}c!=null&&t.disposeIntermediateTensorInfo(h);const T=t.makeTensorInfo(p,h.dtype,x);if(a){const E=js(p,o),C=Gn({inputs:{x:T},backend:t,attrs:{shape:E}});return t.disposeIntermediateTensorInfo(T),C}return T}const fCe={kernelName:G2,backendName:"cpu",kernelFunc:dCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i}=s;at(r,"argMax");let a=Vt(i,r.shape);const o=us(a,r.shape.length);let l=r;const c=[];o!=null&&(l=Oi({inputs:{x:r},backend:t,attrs:{perm:o}}),c.push(l),a=Is(a.length,l.shape.length)),a=[a[0]],Ir("argMax",a,l.shape.length);const[h,p]=ur(l.shape,a),m=Me(h),v=zr(m,"int32"),x=Me(p),w=t.data.get(l.dataId).values;for(let T=0;T<v.length;++T){const E=T*x;let C=w[E],$=0;for(let R=0;R<x;++R){const P=w[E+R];P>C&&(C=P,$=R)}v[T]=$}return c.forEach(T=>t.disposeIntermediateTensorInfo(T)),t.makeTensorInfo(h,"int32",v)}const mCe={kernelName:vw,backendName:"cpu",kernelFunc:pCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i}=s;at(r,"argMin");let a=Vt(i,r.shape);const o=us(a,r.shape.length);let l=r;const c=[];o!=null&&(l=Oi({inputs:{x:r},backend:t,attrs:{perm:o}}),c.push(l),a=Is(a.length,l.shape.length)),a=[a[0]],Ir("argMin",a,l.shape.length);const[h,p]=ur(l.shape,a),m=Me(h),v=zr(m,"int32"),x=Me(p),w=t.data.get(l.dataId).values;for(let T=0;T<v.length;++T){const E=T*x;let C=w[E],$=0;for(let R=0;R<x;++R){const P=w[E+R];P<C&&(C=P,$=R)}v[T]=$}return c.forEach(T=>t.disposeIntermediateTensorInfo(T)),t.makeTensorInfo(h,"int32",v)}const yCe={kernelName:bw,backendName:"cpu",kernelFunc:gCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vCe=In(Yv,n=>Math.asin(n)),bCe={kernelName:Yv,backendName:"cpu",kernelFunc:vCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ce=In(Qv,n=>Math.asinh(n)),xCe={kernelName:Qv,backendName:"cpu",kernelFunc:_Ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wCe=In(Jv,n=>Math.atan(n)),TCe={kernelName:Jv,backendName:"cpu",kernelFunc:wCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SCe=ks((n,e)=>Math.atan2(n,e)),ECe=Qs(tb,SCe),NCe={kernelName:tb,backendName:"cpu",kernelFunc:ECe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ICe=In(eb,n=>Math.atanh(n)),CCe={kernelName:eb,backendName:"cpu",kernelFunc:ICe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iR(n,e,t,s,r,i){const a=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.top,v=r.padInfo.left,x=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=zt(r.outShape,t),T=w.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3],C=r.outShape[2]*r.outShape[3],$=r.outShape[3];for(let R=0;R<r.batchSize;++R){const P=R*E,U=R*s[0];for(let j=0;j<r.inChannels;++j)for(let O=0;O<r.outHeight;++O){const M=O*a-m,B=Math.max(0,M),D=Math.min(r.inHeight,h+M),W=P+O*C;for(let H=0;H<r.outWidth;++H){const ae=H*o-v,te=Math.max(0,ae),Z=Math.min(r.inWidth,p+ae);let re=x,ne=0,he=0;for(let ie=B;ie<D;ie+=l){const pe=U+ie*s[1];for(let fe=te;fe<Z;fe+=c){const Ne=pe+fe*s[2],Te=n[Ne+j];i==="max"&&Te>re?re=Te:i==="avg"&&(ne+=Te,he++)}if(isNaN(re))break}const K=W+H*$+j;T[K]=i==="avg"?ne/he:re}}}return w}function TK(n,e,t,s,r=!1,i=!1){const a=zt(s.outShape,"int32"),o=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,h=s.dilationWidth,p=s.effectiveFilterHeight,m=s.effectiveFilterWidth,v=s.padInfo.top,x=s.padInfo.left,w=zt(e,t,n);for(let T=0;T<s.batchSize;++T)for(let E=0;E<s.inChannels;++E)for(let C=0;C<s.outHeight;++C){const $=C*o-v;let R=$;for(;R<0;)R+=c;const P=Math.min(s.inHeight,p+$);for(let U=0;U<s.outWidth;++U){const j=U*l-x;let O=j;for(;O<0;)O+=h;const M=Math.min(s.inWidth,m+j);let B=Number.NEGATIVE_INFINITY,D=-1;for(let W=R;W<P;W+=c){const H=W-$;for(let ae=O;ae<M;ae+=h){const te=ae-j,Z=w.get(T,W,ae,E);Z>B&&(B=Z,r?D=i?((T*s.inHeight+W)*s.inWidth+ae)*s.inChannels+E:(W*s.inWidth+ae)*s.inChannels+E:D=H*m+te)}}a.set(D,T,C,U,E)}}return a}function SK(n,e,t,s,r,i){const a=r.strideDepth,o=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,h=r.dilationHeight,p=r.dilationWidth,m=r.effectiveFilterDepth,v=r.effectiveFilterHeight,x=r.effectiveFilterWidth,w=r.padInfo.front,T=r.padInfo.top,E=r.padInfo.left,C=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,$=zt(r.outShape,t),R=$.values,P=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],U=r.outShape[2]*r.outShape[3]*r.outShape[4],j=r.outShape[3]*r.outShape[4],O=r.outShape[4];for(let M=0;M<r.batchSize;++M){const B=M*P,D=M*s[0];for(let W=0;W<r.inChannels;++W)for(let H=0;H<r.outDepth;++H){const ae=H*a-w;let te=ae;for(;te<0;)te+=c;const Z=Math.min(r.inDepth,m+ae),re=B+H*U;for(let ne=0;ne<r.outHeight;++ne){const he=ne*o-T;let K=he;for(;K<0;)K+=h;const ie=Math.min(r.inHeight,v+he),pe=re+ne*j;for(let fe=0;fe<r.outWidth;++fe){const Ne=fe*l-E;let Te=Ne;for(;Te<0;)Te+=p;const Se=Math.min(r.inWidth,x+Ne),He=pe+fe*O;let qe=C,Qe=0,pt=0;for(let Lt=te;Lt<Z;Lt+=c){const Gt=D+Lt*s[1];for(let gn=K;gn<ie;gn+=h){const un=Gt+gn*s[2];for(let qt=Te;qt<Se;qt+=p){const Ot=un+qt*s[3],sn=n[Ot+W];if(i==="max"&&sn>qe?qe=sn:i==="avg"&&(Qe+=sn,pt++),isNaN(qe))break}if(isNaN(qe))break}if(isNaN(qe))break}const vt=He+W;R[vt]=i==="avg"?Qe/Math.max(pt,1):qe}}}}return $}function kCe(n,e){const t=zt(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,m=e.padInfo.front,v=e.padInfo.top,x=e.padInfo.left;for(let w=0;w<e.batchSize;++w)for(let T=0;T<e.inChannels;++T)for(let E=0;E<e.outDepth;++E){const C=E*s-m;let $=C;for(;$<0;)$+=a;const R=Math.min(e.inDepth,c+C);for(let P=0;P<e.outHeight;++P){const U=P*r-v;let j=U;for(;j<0;)j+=o;const O=Math.min(e.inHeight,h+U);for(let M=0;M<e.outWidth;++M){const B=M*i-x;let D=B;for(;D<0;)D+=l;const W=Math.min(e.inWidth,p+B);let H=Number.NEGATIVE_INFINITY,ae=-1;for(let te=$;te<R;te+=a){const Z=te-C;for(let re=j;re<O;re+=o){const ne=re-U;for(let he=D;he<W;he+=l){const K=he-B,ie=n.get(w,te,re,he,T);ie>=H&&(H=ie,ae=Z*h*p+ne*h+K)}}}t.set(ae,w,E,P,M,T)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;at(r,"avgPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=s,c=1;J(Gr(a,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const h=ho(r.shape,i,a,c,o,l);let p;if(h.filterWidth===1&&h.filterHeight===1&&xn(h.inShape,h.outShape))p=nc({inputs:{x:r},backend:t});else{const m=t.data.get(r.dataId).values,v=ht(r.shape),x=iR(m,r.shape,r.dtype,v,h,"avg");p=t.makeTensorInfo(h.outShape,r.dtype,x.values)}return p}const ACe={kernelName:_w,backendName:"cpu",kernelFunc:$Ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:c}=s;at(r,"avgPool3d");const h=lu(r.shape,i,a,1,o,l,c),p=t.data.get(r.dataId).values,m=SK(p,r.shape,r.dtype,ht(r.shape),h,"avg");return t.makeTensorInfo(m.shape,"float32",m.values)}const DCe={kernelName:xw,backendName:"cpu",kernelFunc:RCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s;at([r,i],"avgPool3DGrad");const h=lu(i.shape,a,o,1,l,c),p=h.strideDepth,m=h.strideHeight,v=h.strideWidth,x=h.filterDepth,w=h.filterHeight,T=h.filterWidth,E=h.dilationDepth,C=h.dilationHeight,$=h.dilationWidth,R=h.effectiveFilterDepth,P=h.effectiveFilterHeight,U=h.effectiveFilterWidth,j=R-1-h.padInfo.front,O=U-1-h.padInfo.left,M=P-1-h.padInfo.top,B=zt(i.shape,"float32"),D=1/(x*w*T),W=t.bufferSync(r);for(let H=0;H<h.batchSize;++H)for(let ae=0;ae<h.inChannels;++ae)for(let te=0;te<h.inDepth;++te)for(let Z=0;Z<h.inHeight;++Z)for(let re=0;re<h.inWidth;++re){const ne=te-j,he=Z-M,K=re-O;let ie=0;for(let pe=0;pe<R;pe+=E){const fe=(ne+pe)/p;if(!(fe<0||fe>=h.outDepth||Math.floor(fe)!==fe))for(let Ne=0;Ne<P;Ne+=C){const Te=(he+Ne)/m;if(!(Te<0||Te>=h.outHeight||Math.floor(Te)!==Te))for(let Se=0;Se<U;Se+=$){const He=(K+Se)/v;if(He<0||He>=h.outWidth||Math.floor(He)!==He)continue;const qe=W.get(H,fe,Te,He,ae);ie+=qe}}}B.set(ie*D,H,te,Z,re,ae)}return t.makeTensorInfo(B.shape,B.dtype,B.values)}const OCe={kernelName:H2,backendName:"cpu",kernelFunc:LCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PCe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,a=i;at([r,i],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=s,h=ho(a.shape,o,l,1,c),p=h.strideHeight,m=h.strideWidth,v=h.filterHeight,x=h.filterWidth,w=h.dilationHeight,T=h.dilationWidth,E=h.effectiveFilterHeight,C=h.effectiveFilterWidth,$=C-1-h.padInfo.left,R=E-1-h.padInfo.top,P=zt(a.shape,"float32"),U=1/(v*x),j=t.data.get(r.dataId).values,O=zt(r.shape,"float32",j);for(let M=0;M<h.batchSize;++M)for(let B=0;B<h.inChannels;++B)for(let D=0;D<h.inHeight;++D)for(let W=0;W<h.inWidth;++W){const H=D-R,ae=W-$;let te=0;for(let Z=0;Z<E;Z+=w){const re=(H+Z)/p;if(!(re<0||re>=h.outHeight||Math.floor(re)!==re))for(let ne=0;ne<C;ne+=T){const he=(ae+ne)/m;if(he<0||he>=h.outWidth||Math.floor(he)!==he)continue;const K=O.get(M,re,he,B);te+=K}}P.set(te*U,M,D,W,B)}return t.makeTensorInfo(P.shape,P.dtype,P.values)}const MCe={kernelName:W2,backendName:"cpu",kernelFunc:PCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,scale:i,offset:a,mean:o,variance:l}=e;J(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),J(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),J(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),at([r,o,l,i,a],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const h=t.data.get(r.dataId).values,p=t.data.get(o.dataId).values,m=t.data.get(l.dataId).values,v=i?t.data.get(i.dataId).values:new Float32Array([1]),x=a?t.data.get(a.dataId).values:new Float32Array([0]),w=new Float32Array(h.length),T=x.length,E=v.length,C=m.length,$=p.length;let R=0,P=0,U=0,j=0;for(let O=0;O<h.length;++O)w[O]=x[R++]+(h[O]-p[P++])*v[U++]/Math.sqrt(m[j++]+c),R>=T&&(R=0),P>=$&&(P=0),U>=E&&(U=0),j>=C&&(j=0);return t.makeTensorInfo(r.shape,r.dtype,w)}const jCe={kernelName:Lw,backendName:"cpu",kernelFunc:FCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:i,crops:a}=s;at([r],"batchToSpaceND");const o=i.reduce((E,C)=>E*C),l=Xb(r.shape,i,o),c=Zb(l.length,i.length),h=Yb(r.shape,i,o),p=mA(a,i.length),m=gA(h,a,i.length),v=Gn({inputs:{x:r},backend:t,attrs:{shape:l}}),x=Oi({inputs:{x:v},backend:t,attrs:{perm:c}}),w=Gn({inputs:{x},backend:t,attrs:{shape:h}}),T=Pf({inputs:{x:w},backend:t,attrs:{begin:p,size:m}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(w),T}const zCe={kernelName:Tw,backendName:"cpu",kernelFunc:BCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:i}=e,{size:a}=s,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,c=eR(o,l,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,c)}const UCe={kernelName:q2,backendName:"cpu",kernelFunc:VCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GCe(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,o=Rt(Array.from(i),Array.from(a));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const WCe={kernelName:QW,backendName:"cpu",kernelFunc:GCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HCe=In(rb,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),qCe={kernelName:rb,backendName:"cpu",kernelFunc:HCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KCe=n=>{const{x:e}=n.inputs,t=n.backend,s=new Float32Array(Me(e.shape)),r=t.data.get(e.dataId),i=r.complexTensorInfos.real,a=r.complexTensorInfos.imag,o=t.data.get(i.dataId).values,l=t.data.get(a.dataId).values;for(let c=0;c<o.length;c++){const h=o[c],p=l[c];s[c]=Math.hypot(h,p)}return t.makeOutput(s,e.shape,"float32")},XCe={kernelName:Sw,backendName:"cpu",kernelFunc:KCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dm(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.imag,i=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,i)}const ZCe={kernelName:h$,backendName:"cpu",kernelFunc:Dm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lm(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,i=Vt(r,e[0].shape)[0],a=e.map(w=>w.shape);dA(a,i);let o=Bl(e.map(w=>w.shape),i);if(Me(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(w=>Me(w.shape)>0);if(l.length===1)return nc({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const w=l.map(R=>Of({inputs:{input:R},backend:t})),T=l.map(R=>Dm({inputs:{input:R},backend:t})),E=Lm({inputs:w,backend:t,attrs:{axis:i}}),C=Lm({inputs:T,backend:t,attrs:{axis:i}}),$=ea({inputs:{real:E,imag:C},backend:t});return w.forEach(R=>t.disposeIntermediateTensorInfo(R)),T.forEach(R=>t.disposeIntermediateTensorInfo(R)),t.disposeIntermediateTensorInfo(E),t.disposeIntermediateTensorInfo(C),$}const c=l.map(w=>{const E=[-1,Me(w.shape.slice(i))];return Gn({inputs:{x:w},backend:t,attrs:{shape:E}})}),h=c.map(w=>({vals:t.data.get(w.dataId).values,shape:w.shape}));o=Bl(c.map(w=>w.shape),1);const p=c[0].shape[0]===1,m=k8(h,o,e[0].dtype,p),v=Bl(l.map(w=>w.shape),i),x=t.makeTensorInfo(v,e[0].dtype,m);return c.forEach(w=>t.disposeIntermediateTensorInfo(w)),x}const YCe={kernelName:Ew,backendName:"cpu",kernelFunc:Lm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EK(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dataFormat:l,dilations:c,dimRoundingMode:h}=s;at([r,i],"conv2d");const p=cu(l),m=Nr(r.shape,i.shape,a,c,o,h,!1,p),v=m.filterHeight,x=m.filterWidth,w=m.dilationHeight,T=m.dilationWidth,E=m.padInfo.left,C=m.padInfo.top,$=m.dataFormat==="channelsLast",R=new Er(m.outShape,r.dtype),P=ht(r.shape),U=ht(i.shape),j=P[0],O=$?P[1]:P[2],M=$?P[2]:1,B=$?1:P[1],D=R.strides[0],W=$?R.strides[1]:R.strides[2],H=$?R.strides[2]:1,ae=$?1:R.strides[1],te=t.data.get(r.dataId).values,Z=t.data.get(i.dataId).values,re=R.values;for(let ne=0;ne<m.batchSize;++ne){const he=ne*j,K=ne*D;for(let ie=0;ie<m.outHeight;++ie){const pe=K+ie*W,fe=ie*m.strideHeight-C;for(let Ne=0;Ne<v;++Ne){const Te=fe+Ne*w;if(Te<0||Te>=m.inHeight)continue;const Se=Ne*U[0],He=he+Te*O;for(let qe=0;qe<m.outWidth;++qe){const Qe=pe+qe*H,pt=qe*m.strideWidth-E;for(let vt=0;vt<x;++vt){const Lt=pt+vt*T;if(Lt<0||Lt>=m.inWidth)continue;const Gt=Se+vt*U[1],gn=He+Lt*M;let un=Gt;for(let qt=0;qt<m.inChannels;++qt){const Ot=te[gn+qt*B];for(let sn=0;sn<m.outChannels;++sn)re[Qe+sn*ae]+=Ot*Z[un+sn];un+=m.outChannels}}}}}}return t.makeTensorInfo(R.shape,R.dtype,re)}const QCe={kernelName:Nw,backendName:"cpu",kernelFunc:EK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:h}=s;at([r,i],"conv2dBackpropFilter");const p=cu(l),m=Nr(r.shape,h,a,1,o,c,!1,p),{strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:T}=m,E=m.dataFormat==="channelsLast",C=new Er(m.filterShape,"float32"),$=m.padInfo.left,R=m.padInfo.top,P=t.data.get(r.dataId).values,U=t.data.get(i.dataId).values,j=new Er(r.shape,r.dtype,P),O=new Er(i.shape,i.dtype,U);for(let M=0;M<w;++M){const B=Math.max(0,Math.ceil((R-M)/v)),D=Math.min(m.outHeight,(m.inHeight+R-M)/v);for(let W=0;W<T;++W){const H=Math.max(0,Math.ceil(($-W)/x)),ae=Math.min(m.outWidth,(m.inWidth+$-W)/x);for(let te=0;te<m.inChannels;++te)for(let Z=0;Z<m.outChannels;++Z){let re=0;for(let ne=0;ne<m.batchSize;++ne)for(let he=B;he<D;++he){const K=M+he*v-R;for(let ie=H;ie<ae;++ie){const pe=W+ie*x-$;E?re+=j.get(ne,K,pe,te)*O.get(ne,he,ie,Z):re+=j.get(ne,te,K,pe)*O.get(ne,Z,he,ie)}}C.set(re,M,W,te,Z)}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const eke={kernelName:Z2,backendName:"cpu",kernelFunc:JCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tke(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{inputShape:a,strides:o,pad:l,dataFormat:c,dimRoundingMode:h}=s;at([r,i],"conv2dBackpropInput");const p=ht(i.shape),m=ht(r.shape);let v=cu(c);const x=Nr(a,i.shape,o,1,l,h,!1,v),w=new Er(x.inShape,"float32"),T=w.values,E=t.data.get(r.dataId).values,C=t.data.get(i.dataId).values,[$,R,P]=p,{batchSize:U,filterHeight:j,filterWidth:O,inChannels:M,inHeight:B,inWidth:D,outChannels:W,outHeight:H,outWidth:ae,strideHeight:te,strideWidth:Z}=x;v=x.dataFormat;const re=j-1-x.padInfo.top,ne=O-1-x.padInfo.left,he=v==="channelsLast",K=w.strides[0],ie=he?w.strides[1]:w.strides[2],pe=he?w.strides[2]:1,fe=he?1:w.strides[1],Ne=m[0],Te=he?m[1]:m[2],Se=he?m[2]:1,He=he?1:m[1];for(let qe=0;qe<U;++qe)for(let Qe=0;Qe<M;++Qe)for(let pt=0;pt<B;++pt){const vt=pt-re,Lt=Math.max(0,Math.ceil(vt/te)),Gt=Math.min(H,(j+vt)/te);for(let gn=0;gn<D;++gn){const un=gn-ne,qt=Math.max(0,Math.ceil(un/Z)),Ot=Math.min(ae,(O+un)/Z);let sn=0;for(let jt=Lt;jt<Gt;++jt){const bs=jt*te-vt;for(let Bs=qt;Bs<Ot;++Bs){const qr=Bs*Z-un,kr=Ne*qe+Te*jt+Se*Bs,Js=$*(j-1-bs)+R*(O-1-qr)+P*Qe;for(let $s=0;$s<W;++$s){const An=E[kr+He*$s],ns=C[Js+$s];sn+=An*ns}}}const wn=K*qe+ie*pt+pe*gn+fe*Qe;T[wn]=sn}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const nke={kernelName:Iw,backendName:"cpu",kernelFunc:tke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ske(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l}=s;at([r,i],"conv3d");const c=nd(r.shape,i.shape,a,l,o),{filterDepth:h,filterHeight:p,filterWidth:m,dilationDepth:v,dilationHeight:x,dilationWidth:w,padInfo:T}=c,E=T.front,C=T.left,$=T.top,R=new Er(c.outShape,r.dtype),P=t.data.get(r.dataId).values,U=t.data.get(i.dataId).values,j=R.values,O=ht(r.shape),M=ht(i.shape);for(let B=0;B<c.batchSize;++B){const D=B*O[0],W=B*R.strides[0];for(let H=0;H<c.outDepth;++H){const ae=W+H*R.strides[1],te=H*c.strideDepth-E;for(let Z=0;Z<h;++Z){const re=te+Z*v;if(re<0||re>=c.inDepth)continue;const ne=Z*M[0],he=D+re*O[1];for(let K=0;K<c.outHeight;++K){const ie=ae+K*R.strides[2],pe=K*c.strideHeight-$;for(let fe=0;fe<p;++fe){const Ne=pe+fe*x;if(Ne<0||Ne>=c.inHeight)continue;const Te=ne+fe*M[1],Se=he+Ne*O[2];for(let He=0;He<c.outWidth;++He){const qe=ie+He*c.outChannels,Qe=He*c.strideWidth-C;for(let pt=0;pt<m;++pt){const vt=Qe+pt*w;if(vt<0||vt>=c.inWidth)continue;const Lt=Te+pt*M[2],Gt=Se+vt*c.inChannels;let gn=Lt;for(let un=0;un<c.inChannels;++un){const qt=P[Gt+un];for(let Ot=0;Ot<c.outChannels;++Ot)j[qe+Ot]+=qt*U[gn+Ot];gn+=c.outChannels}}}}}}}}return t.makeTensorInfo(R.shape,R.dtype,R.values)}const rke={kernelName:Cw,backendName:"cpu",kernelFunc:ske};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ike(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,pad:o,filterShape:l}=s;at([r,i],"conv3dBackpropFilterV2");const c=ht(r.shape),h=ht(i.shape),p=nd(r.shape,l,a,1,o),m=p.strideDepth,v=p.strideHeight,x=p.strideWidth,w=p.filterDepth,T=p.filterHeight,E=p.filterWidth,C=new Er(p.filterShape,"float32"),$=C.values,[R,P,U,j]=C.strides,O=t.data.get(i.dataId).values,[M,B,D,W]=h,H=t.data.get(r.dataId).values,[ae,te,Z,re]=c,ne=p.padInfo.front,he=p.padInfo.left,K=p.padInfo.top;for(let ie=0;ie<w;++ie){const pe=Math.max(0,Math.ceil((ne-ie)/m)),fe=Math.min(p.outDepth,(p.inDepth+ne-ie)/m),Ne=ie*R;for(let Te=0;Te<T;++Te){const Se=Math.max(0,Math.ceil((K-Te)/v)),He=Math.min(p.outHeight,(p.inHeight+K-Te)/v),qe=Te*P+Ne;for(let Qe=0;Qe<E;++Qe){const pt=Math.max(0,Math.ceil((he-Qe)/x)),vt=Math.min(p.outWidth,(p.inWidth+he-Qe)/x),Lt=Qe*U+qe;for(let Gt=0;Gt<p.inChannels;++Gt){const gn=Gt*j+Lt;for(let un=0;un<p.outChannels;++un){let qt=0;for(let Ot=0;Ot<p.batchSize;++Ot){const sn=Ot*ae,wn=Ot*M;for(let jt=pe;jt<fe;++jt){const Bs=(ie+jt*m-ne)*te+sn,qr=jt*B+wn;for(let kr=Se;kr<He;++kr){const $s=(Te+kr*v-K)*Z+Bs,An=kr*D+qr;for(let ns=pt;ns<vt;++ns){const el=(Qe+ns*x-he)*re+$s,mo=ns*W+An;qt+=H[el+Gt]*O[mo+un]}}}}$[gn+un]=qt}}}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const ake={kernelName:Y2,backendName:"cpu",kernelFunc:ike};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oke(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{pad:a,strides:o,inputShape:l}=s;at([r],"conv3dBackpropInputV2");const c=ht(r.shape),h=ht(i.shape),p=nd(l,i.shape,o,1,a),m=new Er(p.inShape,"float32"),v=m.values,[x,w,T,E]=m.strides,C=t.data.get(r.dataId).values,[$,R,P,U]=c,j=t.data.get(i.dataId).values,[O,M,B,D]=h,{batchSize:W,filterDepth:H,filterHeight:ae,filterWidth:te,inChannels:Z,inDepth:re,inHeight:ne,inWidth:he,outChannels:K,outDepth:ie,outHeight:pe,outWidth:fe,strideDepth:Ne,strideHeight:Te,strideWidth:Se}=p,He=H-1-p.padInfo.front,qe=ae-1-p.padInfo.top,Qe=te-1-p.padInfo.left;for(let pt=0;pt<W;++pt)for(let vt=0;vt<Z;++vt)for(let Lt=0;Lt<re;++Lt){const Gt=Lt-He,gn=Math.max(0,Math.ceil(Gt/Ne)),un=Math.min(ie,(H+Gt)/Ne);for(let qt=0;qt<ne;++qt){const Ot=qt-qe,sn=Math.max(0,Math.ceil(Ot/Te)),wn=Math.min(pe,(ae+Ot)/Te);for(let jt=0;jt<he;++jt){const bs=jt-Qe,Bs=Math.max(0,Math.ceil(bs/Se)),qr=Math.min(fe,(te+bs)/Se);let kr=0;for(let Js=gn;Js<un;++Js){const $s=Js*Ne-Gt;for(let An=sn;An<wn;++An){const ns=An*Te-Ot;for(let hs=Bs;hs<qr;++hs){const el=hs*Se-bs,mo=$*pt+R*Js+P*An+U*hs,hu=O*(H-1-$s)+M*(ae-1-ns)+B*(te-1-el)+D*vt;for(let hr=0;hr<K;++hr){const Mi=C[mo+hr],Kr=j[hu+hr];kr+=Mi*Kr}}}}v[x*pt+w*Lt+T*qt+E*jt+vt]=kr}}}return t.makeTensorInfo(m.shape,m.dtype,m.values)}const lke={kernelName:Q2,backendName:"cpu",kernelFunc:oke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cke=In(ib,n=>Math.cos(n)),uke={kernelName:ib,backendName:"cpu",kernelFunc:cke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hke=In(ab,n=>Math.cosh(n)),dke={kernelName:ab,backendName:"cpu",kernelFunc:hke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fke(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:i,boxInd:a}=e,{cropSize:o,method:l,extrapolationValue:c}=s,[h,p,m,v]=r.shape,x=i.shape[0],[w,T]=o,E=zt([x,w,T,v],"float32"),C=t.data.get(i.dataId).values,$=t.data.get(a.dataId).values,R=t.data.get(r.dataId).values,P=ht(r.shape),U=ht(E.shape);for(let j=0;j<x;j++){const O=j*4,M=C[O],B=C[O+1],D=C[O+2],W=C[O+3],H=$[j];if(H>=h)continue;const ae=w>1?(D-M)*(p-1)/(w-1):0,te=T>1?(W-B)*(m-1)/(T-1):0;for(let Z=0;Z<w;Z++){const re=w>1?M*(p-1)+Z*ae:.5*(M+D)*(p-1);if(re<0||re>p-1){for(let ne=0;ne<T;ne++)for(let he=0;he<v;he++){const K=he+ne*U[2]+Z*U[1]+j*U[0];E.values[K]=c}continue}if(l==="bilinear"){const ne=Math.floor(re),he=Math.ceil(re),K=re-ne;for(let ie=0;ie<T;ie++){const pe=T>1?B*(m-1)+ie*te:.5*(B+W)*(m-1);if(pe<0||pe>m-1){for(let Se=0;Se<v;Se++){const He=Se+ie*U[2]+Z*U[1]+j*U[0];E.values[He]=c}continue}const fe=Math.floor(pe),Ne=Math.ceil(pe),Te=pe-fe;for(let Se=0;Se<v;Se++){let He=Se+fe*P[2]+ne*P[1]+H*P[0];const qe=R[He];He=Se+Ne*P[2]+ne*P[1]+H*P[0];const Qe=R[He];He=Se+fe*P[2]+he*P[1]+H*P[0];const pt=R[He];He=Se+Ne*P[2]+he*P[1]+H*P[0];const vt=R[He],Lt=qe+(Qe-qe)*Te,Gt=pt+(vt-pt)*Te;He=Se+ie*U[2]+Z*U[1]+j*U[0],E.values[He]=Lt+(Gt-Lt)*K}}}else for(let ne=0;ne<T;++ne){const he=T>1?B*(m-1)+ne*te:.5*(B+W)*(m-1);if(he<0||he>m-1){for(let pe=0;pe<v;pe++){const fe=pe+ne*U[2]+Z*U[1]+j*U[0];E.values[fe]=c}continue}const K=Math.round(he),ie=Math.round(re);for(let pe=0;pe<v;pe++){const fe=pe+K*P[2]+ie*P[1]+H*P[0],Ne=pe+ne*U[2]+Z*U[1]+j*U[0];E.values[Ne]=R[fe]}}}}return t.makeTensorInfo(E.shape,E.dtype,E.values)}const pke={kernelName:e$,backendName:"cpu",kernelFunc:fke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mke(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,exclusive:a,reverse:o}=s;at(r,"cumprod");const l=us([i],r.shape.length);let c=r;l!=null&&(c=Oi({inputs:{x:r},backend:t,attrs:{perm:l}}));const h=Is(1,r.shape.length)[0];if(h!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${h}`);const p=ra(c.dtype,"int32"),m=j2(Me(c.shape),p),v=t.data.get(c.dataId).values,x=c.shape[c.shape.length-1],w=o?(E,C)=>E+x-C-1:(E,C)=>E+C;for(let E=0;E<v.length;E+=x)for(let C=0;C<x;C++){const $=w(E,C);if(C===0)m[$]=a?1:v[$];else{const R=w(E,C-1);m[$]=a?v[R]*m[R]:v[$]*m[R]}}const T=t.makeTensorInfo(c.shape,p,m);if(l!=null){const E=sd(l),C=Oi({inputs:{x:T},backend:t,attrs:{perm:E}});return t.disposeIntermediateTensorInfo(T),t.disposeIntermediateTensorInfo(c),C}return T}const gke={kernelName:J2,backendName:"cpu",kernelFunc:mke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yke(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,exclusive:a,reverse:o}=s;at(r,"cumsum");const l=us([i],r.shape.length);let c=r;l!=null&&(c=Oi({inputs:{x:r},backend:t,attrs:{perm:l}}));const h=Is(1,r.shape.length)[0];if(h!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${h}`);const p=ra(c.dtype,"int32"),m=zr(Me(c.shape),p),v=t.data.get(c.dataId).values,x=c.shape[c.shape.length-1],w=o?(E,C)=>E+x-C-1:(E,C)=>E+C;for(let E=0;E<v.length;E+=x)for(let C=0;C<x;C++){const $=w(E,C);if(C===0)m[$]=a?0:v[$];else{const R=w(E,C-1);m[$]=a?v[R]+m[R]:v[$]+m[R]}}const T=t.makeTensorInfo(c.shape,p,m);if(l!=null){const E=sd(l),C=Oi({inputs:{x:T},backend:t,attrs:{perm:E}});return t.disposeIntermediateTensorInfo(T),t.disposeIntermediateTensorInfo(c),C}return T}const vke={kernelName:kw,backendName:"cpu",kernelFunc:yke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bke(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:i}=e,{size:a,binaryOutput:o}=s;if(r.shape.length===1){const l=t.data.get(r.dataId).values,c=t.data.get(i.dataId).values,h=eR(l,c,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,h)}else if(r.shape.length===2){const l=t.bufferSync(r),c=t.bufferSync(i),h=N8(l,c,a,o);return t.makeTensorInfo(h.shape,i.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const _ke={kernelName:t$,backendName:"cpu",kernelFunc:bke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:i,dataFormat:a}=s;J(a==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`);const o=r.shape[0],l=r.shape[1],c=r.shape[2],h=r.shape[3],p=l*i,m=c*i,v=h/(i*i),x=t.data.get(r.dataId).values,w=new Float32Array(o*p*m*v);let T=0;for(let E=0;E<o;++E)for(let C=0;C<p;++C){const $=Math.floor(C/i),R=C%i;for(let P=0;P<m;++P){const U=Math.floor(P/i),j=P%i,O=(R*i+j)*v;for(let M=0;M<v;++M){const D=M+O+h*(U+c*($+l*E));w[T++]=x[D]}}}return t.makeTensorInfo([o,p,m,v],r.dtype,w)}const wke={kernelName:n$,backendName:"cpu",kernelFunc:xke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NK(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l,dimRoundingMode:c}=s;at([r,i],"depthwiseConv2DNative");const h=ht(r.shape),p=ht(i.shape);let m=l;m==null&&(m=[1,1]),J(Gr(a,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${m}'`);const v=Nr(r.shape,i.shape,a,m,o,c,!0),{filterHeight:x,filterWidth:w,dilationHeight:T,dilationWidth:E,padInfo:C}=v,$=C.left,R=C.top,P=v.outChannels/v.inChannels,U=new Er(v.outShape,r.dtype),j=t.data.get(r.dataId).values,O=t.data.get(i.dataId).values,M=U.values;for(let B=0;B<v.batchSize;++B){const D=B*h[0],W=B*U.strides[0];for(let H=0;H<v.outHeight;++H){const ae=W+H*U.strides[1],te=H*v.strideHeight-R;for(let Z=0;Z<x;++Z){const re=te+Z*T;if(re<0||re>=v.inHeight)continue;const ne=Z*p[0],he=D+re*h[1];for(let K=0;K<v.outWidth;++K){const ie=ae+K*U.strides[2],pe=K*v.strideWidth-$;for(let fe=0;fe<w;++fe){const Ne=pe+fe*E;if(Ne<0||Ne>=v.inWidth)continue;const Te=ne+fe*p[1],Se=he+Ne*v.inChannels;let He=ie,qe=Te;for(let Qe=0;Qe<v.inChannels;++Qe){const pt=j[Se+Qe];for(let vt=0;vt<P;++vt)M[He+vt]+=pt*O[qe+vt];He+=P,qe+=P}}}}}}return t.makeTensorInfo(U.shape,U.dtype,U.values)}const Tke={kernelName:$w,backendName:"cpu",kernelFunc:NK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ske(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,filterShape:h}=s;at([r,i],"depthwiseConv2dNativeBackpropFilter");const p=Nr(r.shape,h,a,o,l,c,!0),{strideHeight:m,strideWidth:v,filterHeight:x,filterWidth:w}=p,T=new Er(p.filterShape,"float32"),E=p.padInfo.left,C=p.padInfo.top,$=p.outChannels/p.inChannels,R=t.data.get(r.dataId).values,P=new Er(r.shape,r.dtype,R),U=t.data.get(i.dataId).values,j=new Er(i.shape,i.dtype,U);for(let O=0;O<x;++O){const M=Math.max(0,Math.ceil((C-O)/m)),B=Math.min(p.outHeight,(p.inHeight+C-O)/m);for(let D=0;D<w;++D){const W=Math.max(0,Math.ceil((E-D)/v)),H=Math.min(p.outWidth,(p.inWidth+E-D)/v);for(let ae=0;ae<p.outChannels;++ae){const te=Math.trunc(ae/$),Z=ae%$;let re=0;for(let ne=0;ne<p.batchSize;++ne)for(let he=M;he<B;++he){const K=O+he*m-C;for(let ie=W;ie<H;++ie){const pe=D+ie*v-E;re+=P.get(ne,K,pe,te)*j.get(ne,he,ie,ae)}}T.set(re,O,D,te,Z)}}}return t.makeTensorInfo(T.shape,T.dtype,T.values)}const Eke={kernelName:s$,backendName:"cpu",kernelFunc:Ske};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nke(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,inputShape:h}=s;at([r,i],"depthwiseConv2DNativeBackpropInput");const p=ht(r.shape),m=ht(i.shape),v=Nr(h,i.shape,a,o,l,c,!0),x=new Er(v.inShape,"float32"),w=x.values,[T,E,C]=x.strides,$=t.data.get(r.dataId).values,[R,P,U]=p,j=t.data.get(i.dataId).values,[O,M,B]=m,{batchSize:D,filterHeight:W,filterWidth:H,inChannels:ae,inHeight:te,inWidth:Z,outChannels:re,outHeight:ne,outWidth:he,strideHeight:K,strideWidth:ie}=v,pe=W-1-v.padInfo.top,fe=H-1-v.padInfo.left,Ne=re/ae;for(let Te=0;Te<D;++Te)for(let Se=0;Se<ae;++Se)for(let He=0;He<te;++He){const qe=He-pe,Qe=Math.max(0,Math.ceil(qe/K)),pt=Math.min(ne,(W+qe)/K);for(let vt=0;vt<Z;++vt){const Lt=vt-fe,Gt=Math.max(0,Math.ceil(Lt/ie)),gn=Math.min(he,(H+Lt)/ie);let un=0;for(let qt=Qe;qt<pt;++qt){const Ot=qt*K-qe;for(let sn=Gt;sn<gn;++sn){const wn=sn*ie-Lt,jt=R*Te+P*qt+U*sn,bs=O*(W-1-Ot)+M*(H-1-wn)+B*Se;for(let Bs=0;Bs<Ne;++Bs){const qr=Se*Ne+Bs,kr=$[jt+qr],Js=j[bs+Bs];un+=kr*Js}}}w[T*Te+E*He+C*vt+Se]=un}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}const Ike={kernelName:r$,backendName:"cpu",kernelFunc:Nke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(n){const{inputs:e,backend:t}=n,{x:s}=e,r=Me(s.shape),i=t.data.get(s.dataId).values,a=zt([r,r],s.dtype),o=a.values;for(let c=0;c<i.length;c++)o[c*r+c]=i[c];const l=[...s.shape,...s.shape];return t.makeTensorInfo(l,a.dtype,a.values)}const kke={kernelName:JW,backendName:"cpu",kernelFunc:Cke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ke={kernelName:Aw,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r}=n,{strides:i,pad:a,dilations:o}=t,l=e,c=l.data.get(s.dataId).values,h=s.shape.length,p=l.data.get(r.dataId).values,m=r.shape.length,{batchSize:v,inHeight:x,inWidth:w,inChannels:T,outHeight:E,outWidth:C,padInfo:$,strideHeight:R,strideWidth:P,filterHeight:U,filterWidth:j,dilationHeight:O,dilationWidth:M,outShape:B}=Gb(s.shape,r.shape,i,a,"NHWC",o),D=Me(B),W=B.length,H=ws(s.dtype,D);for(let te=0;te<v;++te)for(let Z=0;Z<E;++Z){const re=Z*R-$.top;for(let ne=0;ne<C;++ne){const he=ne*P-$.left;for(let K=0;K<T;++K){let ie=Number.MIN_SAFE_INTEGER;for(let fe=0;fe<U;++fe){const Ne=re+fe*O;if(Ne>=0&&Ne<x)for(let Te=0;Te<j;++Te){const Se=he+Te*M;if(Se>=0&&Se<w){const He=Fl([te,Ne,Se,K],h,ht(s.shape)),qe=Fl([fe,Te,K],m,ht(r.shape)),Qe=c[He]+p[qe];Qe>ie&&(ie=Qe)}}}const pe=Fl([te,Z,ne,K],W,ht(B));H[pe]=ie}}}return{dataId:l.write(Uf(H,s.dtype),B,s.dtype),shape:B,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ake={kernelName:jI,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:i}=n,{strides:a,pad:o,dilations:l}=t,c=e,h=Uo(s.shape,c.data.get(s.dataId).values),p=Uo(r.shape,c.data.get(r.dataId).values),{batchSize:m,inHeight:v,inWidth:x,inChannels:w,outHeight:T,outWidth:E,padInfo:C,strideHeight:$,strideWidth:R,filterHeight:P,filterWidth:U,dilationHeight:j,dilationWidth:O,outShape:M}=Gb(s.shape,r.shape,a,o,"NHWC",l);J(i.rank===M.length,()=>`Error in ${jI}, dy must have the same rank as output ${M.length}, but got ${i.rank}`);const B=Uo(M,c.data.get(i.dataId).values),D=XW(r.shape,r.dtype);for(let H=0;H<m;++H)for(let ae=0;ae<T;++ae){const te=ae*$-C.top;for(let Z=0;Z<E;++Z){const re=Z*R-C.left;for(let ne=0;ne<w;++ne){let he=Number.MIN_SAFE_INTEGER,K=0,ie=0;for(let pe=0;pe<P;++pe){const fe=te+pe*j;if(fe>=0&&fe<v)for(let Ne=0;Ne<U;++Ne){const Te=re+Ne*O;if(Te>=0&&Te<x){const Se=h[H][fe][Te][ne]+p[pe][Ne][ne];Se>he&&(he=Se,K=pe,ie=Ne)}}}D[K][ie][ne]+=B[H][ae][Z][ne]}}}return{dataId:c.write(Uf(D,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rke={kernelName:FI,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:i}=n,{strides:a,pad:o,dilations:l}=t,c=e,h=Uo(s.shape,c.data.get(s.dataId).values),p=Uo(r.shape,c.data.get(r.dataId).values),{batchSize:m,inHeight:v,inWidth:x,inChannels:w,outHeight:T,outWidth:E,padInfo:C,strideHeight:$,strideWidth:R,filterHeight:P,filterWidth:U,dilationHeight:j,dilationWidth:O,outShape:M}=Gb(s.shape,r.shape,a,o,"NHWC",l);J(i.rank===M.length,()=>`Error in ${FI}, dy must have the same rank as output ${M.length}, but got ${i.rank}`);const B=Uo(M,c.data.get(i.dataId).values),D=XW(s.shape,s.dtype);for(let H=0;H<m;++H)for(let ae=0;ae<T;++ae){const te=ae*$-C.top;for(let Z=0;Z<E;++Z){const re=Z*R-C.left;for(let ne=0;ne<w;++ne){let he=Number.MIN_SAFE_INTEGER,K=te<0?0:te,ie=re<0?0:re;for(let pe=0;pe<P;++pe){const fe=te+pe*j;if(fe>=0&&fe<v)for(let Ne=0;Ne<U;++Ne){const Te=re+Ne*O;if(Te>=0&&Te<x){const Se=h[H][fe][Te][ne]+p[pe][Ne][ne];Se>he&&(he=Se,K=fe,ie=Te)}}}D[H][K][ie][ne]+=B[H][ae][Z][ne]}}}return{dataId:c.write(Uf(D,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dke(n){const{inputs:e,backend:t,attrs:s}=n,{image:r}=e,{canvas:i,options:a}=s,{contextOptions:o,imageOptions:l}=a||{},c=l?.alpha||1,h=o?.contextType||"2d";if(h!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const p=i.getContext(h,o?.contextAttributes||{});if(p==null)throw new Error(`Could not get the context with ${h} type.`);const[m,v]=r.shape.slice(0,2),x=r.shape.length===2?1:r.shape[2],w=t.data.get(r.dataId).values,T=r.dtype==="float32"?255:1,E=new Uint8ClampedArray(v*m*4);for(let $=0;$<m*v;++$){const R=[0,0,0,255*c];for(let U=0;U<x;U++){const j=w[$*x+U];if(r.dtype==="float32"){if(j<0||j>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${j}.`)}else if(r.dtype==="int32"&&(j<0||j>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${j}.`);x===1?(R[0]=j*T,R[1]=j*T,R[2]=j*T):R[U]=j*T}const P=$*4;E[P+0]=Math.round(R[0]),E[P+1]=Math.round(R[1]),E[P+2]=Math.round(R[2]),E[P+3]=Math.round(R[3])}i.width=v,i.height=m;const C=new ImageData(E,v,m);return p.putImageData(C,0,0),r}const Lke={kernelName:Dve,backendName:"cpu",kernelFunc:Dke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;at(r,"sum");let o;r.dtype==="bool"?o=Gh({inputs:{x:r},backend:t,attrs:{dtype:"int32"}}):o=nc({inputs:{x:r},backend:t});const l=o.shape.length,c=Vt(i,o.shape),h=us(c,l);let p=c,m=o;h!=null&&(m=Oi({inputs:{x:o},backend:t,attrs:{perm:h}}),p=Is(p.length,l)),Ir("sum",p,m.shape.length);const[v,x]=ur(m.shape,p),w=ra(m.dtype,"int32");let T=m1(t,v,w);const E=Me(x),C=t.data.get(T.dataId).values,$=t.data.get(m.dataId).values;for(let R=0;R<C.length;++R){const P=R*E;let U=0;for(let j=0;j<E;++j)U+=$[P+j];C[R]=U}if(a){const R=js(T.shape,c),P=T;T=Gn({inputs:{x:T},backend:t,attrs:{shape:R}}),t.disposeIntermediateTensorInfo(P)}return t.disposeIntermediateTensorInfo(o),h!=null&&t.disposeIntermediateTensorInfo(m),T}const Oke={kernelName:uT,backendName:"cpu",kernelFunc:a_};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pke(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,i=e,{allDims:a,summedDims:o,idDims:l}=SA(r,i.length);NA(a.length,l,i);const{path:c,steps:h}=IA(o,l),p=h.length;let m=null,v=a.length;const x=[];for(let w=0;w<p;++w){for(const T of h[w]){const{permutationIndices:E,expandDims:C}=EA(v,l[T]);let $;CA(E)?$=i[T]:($=Oi({inputs:{x:i[T]},backend:t,attrs:{perm:E}}),x.push($));const R=$.shape.slice();for(let P=0;P<C.length;++P)R.splice(C[P],0,1);xn($.shape,R)||($=Gn({inputs:{x:$},backend:t,attrs:{shape:R}}),x.push($)),m===null?m=$:(m=zT({inputs:{a:$,b:m},backend:t}),x.push(m))}w<p-1&&(c[w]>=0&&(m=a_({inputs:{x:m},backend:t,attrs:{axis:c[w]-(a.length-v),keepDims:!1}}),x.push(m)),v--)}for(const w of x)w!==m&&t.disposeIntermediateTensorInfo(w);return m}const Mke={kernelName:i$,backendName:"cpu",kernelFunc:Pke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fke(n){const{inputs:e,backend:t}=n,{dy:s,y:r}=e;at([s,r],"eluGrad");const i=new Float32Array(Me(r.shape)),a=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values;for(let l=0;l<a.length;++l){const c=a[l];c>=0?i[l]=o[l]:i[l]=o[l]*(c+1)}return t.makeTensorInfo(r.shape,"float32",i)}const jke={kernelName:a$,backendName:"cpu",kernelFunc:Fke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bke=yA,zke=vA,Vke=bA,Uke=_A,Gke=xA,Wke=wA,Hke=In(cb,n=>{const e=Math.sign(n),t=Math.abs(n),s=1/(1+Bke*t);return e*(1-((((Wke*s+Gke)*s+Uke)*s+Vke)*s+zke)*s*Math.exp(-t*t))}),qke={kernelName:cb,backendName:"cpu",kernelFunc:Hke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1(n){const{inputs:e,backend:t,attrs:s}=n,{input:r}=e,{dim:i}=s,a=r.shape.length,o=r.shape.slice();let l=i;return i<0&&(J(-(a+1)<=i,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+i+1),o.splice(l,0,1),Gn({inputs:{x:r},backend:t,attrs:{shape:o}})}const Kke={kernelName:Dw,backendName:"cpu",kernelFunc:v1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xke=ks((n,e)=>n/e),aR=Qs(ob,Xke),hC={kernelName:ob,backendName:"cpu",kernelFunc:aR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IK(n,e,t){const s=n.shape,r=s[0],i=s[1],a=t.data.get(n.dataId),o=a.complexTensorInfos.real,l=a.complexTensorInfos.imag,c=[r,i],h=Me(c),p=Br("float32",h),m=Br("float32",h);for(let T=0;T<r;T++){const E=Pf({inputs:{x:o},backend:t,attrs:{begin:[T,0],size:[1,i]}}),C=Pf({inputs:{x:l},backend:t,attrs:{begin:[T,0],size:[1,i]}}),$=ea({inputs:{real:E,imag:C},backend:t}),{real:R,imag:P}=Zke($,e,t),U=nu(R,P);for(let j=0;j<i;j++){const O=TA(U,j);p[T*i+j]=O.real,m[T*i+j]=O.imag}t.disposeIntermediateTensorInfo(E),t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo($)}const v=t.makeTensorInfo(c,"float32",p),x=t.makeTensorInfo(c,"float32",m),w=ea({inputs:{real:v,imag:x},backend:t});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(x),w}function Zke(n,e,t){const s=Me(n.shape),r=t.data.get(n.dataId),i=t.data.get(r.complexTensorInfos.real.dataId).values,a=t.data.get(r.complexTensorInfos.imag.dataId).values;if(Yke(s)){const o=dC(i,a,s,e,t),l=[n.shape[0],n.shape[1]];if(e){const c=t.makeTensorInfo(l,"float32",o.real),h=t.makeTensorInfo(l,"float32",o.imag),p=t.makeTensorInfo([],"float32",td(s,"float32")),m=nc({inputs:{x:p},backend:t}),v=hC.kernelFunc({inputs:{a:c,b:p},backend:t}),x=hC.kernelFunc({inputs:{a:h,b:m},backend:t}),w=t.data.get(v.dataId).values,T=t.data.get(x.dataId).values;return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(x),{real:w,imag:T}}return o}else{const o=nu(i,a),l=Qke(o,s,e);return B5(l)}}function Yke(n){return(n&n-1)===0}function dC(n,e,t,s,r){if(t===1)return{real:n,imag:e};const i=nu(n,e),a=t/2,o=z5(i),l=o.real,c=o.imag,h=[l.length],p=r.makeTensorInfo(h,"float32",l),m=r.makeTensorInfo(h,"float32",c),v=ea({inputs:{real:p,imag:m},backend:r}),x=V5(i),w=x.real,T=x.imag,E=[w.length],C=r.makeTensorInfo(E,"float32",w),$=r.makeTensorInfo(E,"float32",T),R=ea({inputs:{real:C,imag:$},backend:r}),P=dC(l,c,a,s,r),U=P.real,j=P.imag,O=[U.length],M=r.makeTensorInfo(O,"float32",U),B=r.makeTensorInfo(O,"float32",j),D=ea({inputs:{real:M,imag:B},backend:r}),W=dC(w,T,a,s,r),H=W.real,ae=W.imag,te=[H.length],Z=r.makeTensorInfo(te,"float32",H),re=r.makeTensorInfo(te,"float32",ae),ne=ea({inputs:{real:Z,imag:re},backend:r}),he=G5(t,s),K=[he.real.length],ie=r.makeTensorInfo(K,"float32",he.real),pe=r.makeTensorInfo(K,"float32",he.imag),fe=ea({inputs:{real:ie,imag:pe},backend:r}),Ne=zT({inputs:{a:fe,b:ne},backend:r}),Te=Rm({inputs:{a:D,b:Ne},backend:r}),Se=rR({inputs:{a:D,b:Ne},backend:r}),He=Of({inputs:{input:Te},backend:r}),qe=Of({inputs:{input:Se},backend:r}),Qe=Dm({inputs:{input:Te},backend:r}),pt=Dm({inputs:{input:Se},backend:r}),vt=Lm({inputs:[He,qe],backend:r,attrs:{axis:0}}),Lt=Lm({inputs:[Qe,pt],backend:r,attrs:{axis:0}}),Gt=r.data.get(vt.dataId).values,gn=r.data.get(Lt.dataId).values;return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(B),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(re),r.disposeIntermediateTensorInfo(ne),r.disposeIntermediateTensorInfo(ie),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(fe),r.disposeIntermediateTensorInfo(Ne),r.disposeIntermediateTensorInfo(Te),r.disposeIntermediateTensorInfo(Se),r.disposeIntermediateTensorInfo(He),r.disposeIntermediateTensorInfo(Qe),r.disposeIntermediateTensorInfo(qe),r.disposeIntermediateTensorInfo(pt),r.disposeIntermediateTensorInfo(vt),r.disposeIntermediateTensorInfo(Lt),{real:Gt,imag:gn}}function Qke(n,e,t){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,a=0;for(let o=0;o<e;o++){const l=W5(r*o,e,t),c=TA(n,o);i+=c.real*l.real-c.imag*l.imag,a+=c.real*l.imag+c.imag*l.real}t&&(i/=e,a/=e),U5(s,i,a,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jke(n){const{inputs:e,backend:t}=n,{input:s}=e,r=Me(s.shape),i=s.shape[s.shape.length-1],a=r/i,o=Gn({inputs:{x:s},backend:t,attrs:{shape:[a,i]}}),l=IK(o,!1,t),c=Gn({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}const e2e={kernelName:o$,backendName:"cpu",kernelFunc:Jke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oR(n){const{backend:e,attrs:t}=n,{shape:s,value:r,dtype:i}=t,a=i||Ym(r),o=ws(a,Me(s));return n2e(o,r,a),e.makeTensorInfo(s,a,o)}const t2e={kernelName:l$,backendName:"cpu",kernelFunc:oR};function n2e(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s2e={kernelName:c$,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,r=t,i=Br(s.dtype,Me(s.shape)),[a,o,l,c]=s.shape,h=r.data.get(s.dataId).values;for(let m=0;m<a;m++){const v=m*l*o*c;for(let x=0;x<o;x++){const w=x*(l*c);for(let T=0;T<l;T++){const E=T*c;for(let C=0;C<c;C++){const $=Math.round(l-T-1),R=v+w+E+C;let P=h[R];if($>=0&&$<l){const U=$*c,j=v+w+U+C;P=h[j]}i[R]=P}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:h,dilations:p,dimRoundingMode:m,activation:v,leakyreluAlpha:x}=s;let w=EK({inputs:{x:r,filter:i},backend:t,attrs:{strides:l,pad:c,dataFormat:h,dilations:p,dimRoundingMode:m}});if(a){const T=w;if(h==="NCHW"&&a.shape.length===1&&a.shape[0]!==1){const E=Gn({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});w=Rm({inputs:{a:w,b:E},backend:t}),t.disposeIntermediateTensorInfo(E)}else w=Rm({inputs:{a:w,b:a},backend:t});t.disposeIntermediateTensorInfo(T)}if(v){const T=w;if(h==="NCHW"&&v==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const E=Gn({inputs:{x:o},backend:t,attrs:{shape:[o.shape[0],1,1]}});w=y1(t,w,v,E,x),t.disposeIntermediateTensorInfo(E)}else w=y1(t,w,v,o,x);t.disposeIntermediateTensorInfo(T)}return w}const i2e={kernelName:Q0,backendName:"cpu",kernelFunc:r2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:h,dilations:p,dimRoundingMode:m,activation:v,leakyreluAlpha:x}=s;let w=NK({inputs:{x:r,filter:i},backend:t,attrs:{strides:l,pad:c,dataFormat:h,dilations:p,dimRoundingMode:m}});if(a){const T=w;w=Rm({inputs:{a:w,b:a},backend:t}),t.disposeIntermediateTensorInfo(T)}if(v){const T=w;w=y1(t,w,v,o,x),t.disposeIntermediateTensorInfo(T)}return w}const o2e={kernelName:vH,backendName:"cpu",kernelFunc:a2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l2e(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,i=Me(s.shape),a=r.shape,o=a[a.length-1],[l,c,h,p]=aA(s,r);if(c===0)return t.makeTensorInfo(l,s.dtype,[]);const m=t.data.get(r.dataId).values,v=t.bufferSync(s),x=M8(m,v,s.dtype,c,o,h,p,s.shape,i);return t.makeTensorInfo(l,s.dtype,x.values)}const c2e={kernelName:eH,backendName:"cpu",kernelFunc:l2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:i}=e,{axis:a,batchDims:o}=s;at([r,i],"gatherV2");const l=Vt(a,r.shape)[0],c=t.data.get(i.dataId).values,h=r.shape[l];for(let R=0;R<c.length;++R){const P=c[R];J(P<=h-1&&P>=0,()=>`GatherV2: the index value ${P} is not in [0, ${h-1}]`)}let p=o;o==null&&(p=0);const m=Me(i.shape),v=$A(r,i,l,p),x=Gn({inputs:{x:r},backend:t,attrs:{shape:[v.batchSize,v.outerSize,v.dimSize,v.sliceSize]}}),w=Gn({inputs:{x:i},backend:t,attrs:{shape:[v.batchSize,m/v.batchSize]}}),T=[v.batchSize,v.outerSize,m/v.batchSize,v.sliceSize],E=t.bufferSync(w),C=t.bufferSync(x),$=F8(C,E,T);return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(w),t.makeTensorInfo(v.outputShape,$.dtype,$.values)}const h2e={kernelName:Ow,backendName:"cpu",kernelFunc:u2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d2e(n){const{inputs:e,backend:t}=n,{input:s}=e,r=Me(s.shape),i=s.shape[s.shape.length-1],a=r/i,o=Gn({inputs:{x:s},backend:t,attrs:{shape:[a,i]}}),l=IK(o,!0,t),c=Gn({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}const f2e={kernelName:u$,backendName:"cpu",kernelFunc:d2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p2e=In(gb,n=>Number.isFinite(n)?1:0,"bool"),m2e={kernelName:gb,backendName:"cpu",kernelFunc:p2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g2e=In(yb,n=>Math.abs(n)===1/0?1:0,"bool"),y2e={kernelName:yb,backendName:"cpu",kernelFunc:g2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v2e=In(vb,n=>Number.isNaN(n)?1:0,"bool"),b2e={kernelName:vb,backendName:"cpu",kernelFunc:v2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _2e(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:i}=t,a=U8(s,r,i);return e.makeTensorInfo([a.length],"float32",a)}const x2e={kernelName:tH,backendName:"cpu",kernelFunc:_2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2e=In(_b,n=>Math.log1p(n)),T2e={kernelName:_b,backendName:"cpu",kernelFunc:w2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S2e=ks((n,e)=>n&&e),E2e=Qs(Bw,S2e,null,"bool"),N2e={kernelName:Bw,backendName:"cpu",kernelFunc:E2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I2e=In(zw,n=>n?0:1,"bool"),C2e={kernelName:zw,backendName:"cpu",kernelFunc:I2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k2e=ks((n,e)=>n||e),$2e=Qs(Vw,k2e,null,"bool"),A2e={kernelName:Vw,backendName:"cpu",kernelFunc:$2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:i,bias:a,alpha:o,beta:l}=s;at(r,"LRN");const c=r.shape[3],h=c-1,p=t.data.get(r.dataId).values,m=Me(r.shape),v=new Float32Array(m);function x(w){const T=w%c;let E=w-T+Math.max(0,T-i);const C=w-T+Math.min(T+i,h);let $=0;for(;E<=C;E++){const R=p[E];$+=R*R}return $}for(let w=0;w<m;w++){const T=x(w),E=p[w]*Math.pow(a+o*T,-l);v[w]=E}return t.makeTensorInfo(r.shape,r.dtype,v)}const D2e={kernelName:Uw,backendName:"cpu",kernelFunc:R2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,y:i,dy:a}=e,{depthRadius:o,bias:l,alpha:c,beta:h}=s;at(a,"LRNGrad");const p=Me(a.shape),m=a.shape[3],v=t.data.get(a.dataId).values,x=t.data.get(r.dataId).values,w=t.data.get(i.dataId).values,T=new Float32Array(p),E=p;for(let C=0;C<E;C++){const $=C%m,R=C-$+Math.max(0,$-o),P=C-$+Math.min(m,$+o+1);let U=0;for(let j=R;j<P;j++)U+=Math.pow(x[j],2);U=c*U+l;for(let j=R;j<P;j++){let O=-2*c*h*x[j]*w[C]/U;C===j&&(O+=Math.pow(U,-h)),O*=v[C],T[j]+=O}}return t.makeTensorInfo(a.shape,r.dtype,T)}const O2e={kernelName:d$,backendName:"cpu",kernelFunc:L2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CK(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:i,keepDims:a}=s,o=t;let l=r.shape;const c=l.length,h=Vt(i,l);let p=h;const m=us(p,c);let v=o.data.get(r.dataId).values;if(m!=null){const R=new Array(c);for(let P=0;P<R.length;P++)R[P]=l[m[P]];v=nR(v,l,r.dtype,m,R),p=Is(p.length,c),l=R}at(r,"max"),Ir("max",p,c);const[x,w]=ur(l,p),T=Me(w),E=W8(v,T,x,r.dtype),C=o.write(E,x,r.dtype);let $=x;return a&&($=js(x,h)),{dataId:C,shape:$,dtype:r.dtype}}const P2e={kernelName:Gw,backendName:"cpu",kernelFunc:CK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;at(r,"maxPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=s,c=1;J(Gr(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const h=ho(r.shape,i,a,c,o,l);let p;if(h.filterWidth===1&&h.filterHeight===1&&xn(h.inShape,h.outShape))p=nc({inputs:{x:r},backend:t});else{const m=t.data.get(r.dataId).values,v=ht(r.shape),x=iR(m,r.shape,r.dtype,v,h,"max");p=t.makeTensorInfo(h.outShape,r.dtype,x.values)}return p}const F2e={kernelName:Ww,backendName:"cpu",kernelFunc:M2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:c}=s;at(r,"maxPool3d");const h=lu(r.shape,i,a,1,o,l,c),p=t.data.get(r.dataId).values,m=SK(p,r.shape,r.dtype,ht(r.shape),h,"max");return t.makeTensorInfo(m.shape,"float32",m.values)}const B2e={kernelName:Hw,backendName:"cpu",kernelFunc:j2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2e(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s;at([r,i],"maxPool3DGrad");const h=lu(i.shape,a,o,1,l,c),p=t.bufferSync(i),m=kCe(p,h),v=h.strideDepth,x=h.strideHeight,w=h.strideWidth,T=h.dilationDepth,E=h.dilationHeight,C=h.dilationWidth,$=h.effectiveFilterDepth,R=h.effectiveFilterHeight,P=h.effectiveFilterWidth,U=$-1-h.padInfo.front,j=P-1-h.padInfo.left,O=R-1-h.padInfo.top,M=zt(i.shape,"float32"),B=t.bufferSync(r);for(let D=0;D<h.batchSize;++D)for(let W=0;W<h.inChannels;++W)for(let H=0;H<h.inDepth;++H)for(let ae=0;ae<h.inHeight;++ae)for(let te=0;te<h.inWidth;++te){const Z=H-U,re=ae-O,ne=te-j;let he=0;for(let K=0;K<$;K+=T){const ie=(Z+K)/v;if(!(ie<0||ie>=h.outDepth||Math.floor(ie)!==ie))for(let pe=0;pe<R;pe+=E){const fe=(re+pe)/x;if(!(fe<0||fe>=h.outHeight||Math.floor(fe)!==fe))for(let Ne=0;Ne<P;Ne+=C){const Te=(ne+Ne)/w;if(Te<0||Te>=h.outWidth||Math.floor(Te)!==Te)continue;const Se=$*R*P-1-m.get(D,ie,fe,Te,W),He=K*R*P+pe*P+Ne,qe=Se===He?1:0;if(qe===0)continue;const Qe=B.get(D,ie,fe,Te,W);he+=Qe*qe}}}M.set(he,D,H,ae,te,W)}return t.makeTensorInfo(M.shape,M.dtype,M.values)}const V2e={kernelName:p$,backendName:"cpu",kernelFunc:z2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U2e(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i,output:a}=e,o=i;at([i,a],"maxPoolGrad");const{filterSize:l,strides:c,pad:h,dimRoundingMode:p}=s,m=ho(o.shape,l,c,1,h,p),v=t.data.get(o.dataId).values,x=zt(m.outShape,o.dtype,TK(v,o.shape,o.dtype,m).values),w=m.strideHeight,T=m.strideWidth,E=m.dilationHeight,C=m.dilationWidth,$=m.effectiveFilterHeight,R=m.effectiveFilterWidth,P=R-1-m.padInfo.left,U=$-1-m.padInfo.top,j=zt(o.shape,"float32"),O=t.data.get(r.dataId).values,M=zt(r.shape,"float32",O);for(let B=0;B<m.batchSize;++B)for(let D=0;D<m.inChannels;++D)for(let W=0;W<m.inHeight;++W)for(let H=0;H<m.inWidth;++H){const ae=W-U,te=H-P;let Z=0;for(let re=0;re<$;re+=E){const ne=(ae+re)/w;if(!(ne<0||ne>=m.outHeight||Math.floor(ne)!==ne))for(let he=0;he<R;he+=C){const K=(te+he)/T;if(K<0||K>=m.outWidth||Math.floor(K)!==K)continue;const ie=$*R-1-x.get(B,ne,K,D),pe=re*R+he,fe=ie===pe?1:0;if(fe===0)continue;const Ne=M.get(B,ne,K,D);Z+=Ne*fe}}j.set(Z,B,W,H,D)}return t.makeTensorInfo(j.shape,j.dtype,j.values)}const G2e={kernelName:f$,backendName:"cpu",kernelFunc:U2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W2e(n,e,t,s,r){const i=ht(e),a=iR(n,e,t,i,r,"max"),o=TK(n,e,t,r,!0,s);return[a.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H2e={kernelName:nH,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:i,pad:a,includeBatchInIndex:o}=e,l=t;at(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,h=ho(s.shape,r,i,[1,1],a),[p,m]=W2e(c,s.shape,s.dtype,o,h),v=l.write(p,h.outShape,s.dtype),x=l.write(m,h.outShape,s.dtype);return[{dataId:v,shape:h.outShape,dtype:s.dtype},{dataId:x,shape:h.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=Vt(i,r.shape),c=ur(r.shape,o)[1],h=Me(c),p=[],m=t.makeTensorInfo([],"float32",new Float32Array([h]));p.push(m);const v=Gh({inputs:{x:r},backend:t,attrs:{dtype:"float32"}});p.push(v);const x=aR({inputs:{a:v,b:m},backend:t});p.push(x);const w=a_({inputs:{x},backend:t,attrs:{axis:i,keepDims:a}});return p.forEach(T=>t.disposeIntermediateTensorInfo(T)),w}const K2e={kernelName:qw,backendName:"cpu",kernelFunc:q2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;at(r,"min");const o=Vt(i,r.shape);let l=o;const c=us(l,r.shape.length);let h=r;c!=null&&(h=Oi({inputs:{x:r},backend:t,attrs:{perm:c}}),l=Is(l.length,r.shape.length)),Ir("min",l,h.shape.length);const[p,m]=ur(h.shape,l),v=Me(m),x=zr(Me(p),h.dtype),w=t.data.get(h.dataId).values;for(let E=0;E<x.length;++E){const C=E*v;let $=w[C];for(let R=0;R<v;++R){const P=w[C+R];(Number.isNaN(P)||P<$)&&($=P)}x[E]=$}c!=null&&t.disposeIntermediateTensorInfo(h);const T=t.makeTensorInfo(p,h.dtype,x);if(a){const E=js(p,o),C=Gn({inputs:{x:T},backend:t,attrs:{shape:E}});return t.disposeIntermediateTensorInfo(T),C}return T}const Z2e={kernelName:Kw,backendName:"cpu",kernelFunc:X2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:i,mode:a}=s;at(r,"mirrorPad");const o=i.map(($,R)=>$[0]+r.shape[R]+$[1]),l=i.map($=>$[0]),c=i.map(($,R)=>$[0]+r.shape[R]),h=a==="reflect"?0:1,p=t.data.get(r.dataId).values,m=r.shape.length,v=ht(r.shape),x=Me(o),w=o.length,T=ht(o),E=Br(r.dtype,x);for(let $=0;$<x;$++){let R=Qm($,w,T);for(let U=0;U<w;U++)R[U]<l[U]?R[U]=l[U]*2-R[U]-h:R[U]>=c[U]&&(R[U]=(c[U]-1)*2-R[U]+h);R=R.map((U,j)=>U-l[j]);const P=Fl(R,m,v);E[$]=p[P]}return{dataId:t.write(E,o,r.dtype),shape:o,dtype:r.dtype}}const Q2e={kernelName:Xw,backendName:"cpu",kernelFunc:Y2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J2e=ks(((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e})),e$e=Qs(Tb,J2e),t$e={kernelName:Tb,backendName:"cpu",kernelFunc:e$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kK(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:i}=s,a=r.shape.length;let o=i;if(o===-1&&(o=a-1),o!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${o}`);const l=Vt([o],r.shape),c=CK({inputs:{x:r},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),h=js(c.shape,l),p=Gn({inputs:{x:c},backend:t,attrs:{shape:h}}),m=rR({inputs:{a:r,b:p},backend:t}),v=D8({inputs:{x:m},backend:t}),x=a_({inputs:{x:v},backend:t,attrs:{axis:l,keepDims:!1}}),w=Gn({inputs:{x},backend:t,attrs:{shape:h}}),T=aR({inputs:{a:v,b:w},backend:t});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(w),T}const n$e={kernelName:fT,backendName:"cpu",kernelFunc:kK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$e(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:i,seed:a,normalized:o}=s;at(r,"multinomial");const l=o?r:kK({inputs:{logits:r},backend:t,attrs:{dim:-1}}),c=l.shape[0],h=l.shape[1],p=t.data.get(l.dataId).values,m=[c,i],v=zr(Me(m),"int32");for(let x=0;x<c;++x){const w=x*h,T=new Float32Array(h-1);T[0]=p[w];for(let $=1;$<T.length;++$)T[$]=T[$-1]+p[w+$];const E=Xm.alea(a.toString()),C=x*i;for(let $=0;$<i;++$){const R=E();v[C+$]=T.length;for(let P=0;P<T.length;P++)if(R<T[P]){v[C+$]=P;break}}}return o||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(m,"int32",v)}const r$e={kernelName:sH,backendName:"cpu",kernelFunc:s$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i$e=tA;function a$e(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=s;at(r,"NonMaxSuppression");const c=t.data.get(r.dataId).values,h=t.data.get(i.dataId).values,{selectedIndices:p}=i$e(c,h,a,o,l);return t.makeTensorInfo([p.length],"int32",new Int32Array(p))}const o$e={kernelName:m$,backendName:"cpu",kernelFunc:a$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l$e=nA;function c$e(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=s;at(r,"NonMaxSuppressionPadded");const h=t.data.get(r.dataId).values,p=t.data.get(i.dataId).values,{selectedIndices:m,validOutputs:v}=l$e(h,p,a,o,l,c);return[t.makeTensorInfo([m.length],"int32",new Int32Array(m)),t.makeTensorInfo([],"int32",new Int32Array([v]))]}const u$e={kernelName:g$,backendName:"cpu",kernelFunc:c$e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h$e=sA;function d$e(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=s;at(r,"NonMaxSuppressionWithScore");const h=t.data.get(r.dataId).values,p=t.data.get(i.dataId).values,m=a,v=o,x=l,w=c,{selectedIndices:T,selectedScores:E}=h$e(h,p,m,v,x,w);return[t.makeTensorInfo([T.length],"int32",new Int32Array(T)),t.makeTensorInfo([E.length],"float32",new Float32Array(E))]}const f$e={kernelName:y$,backendName:"cpu",kernelFunc:d$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p$e(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:i,depth:a,onValue:o,offValue:l}=s;at(r,"oneHot");const c=Me(r.shape),h=new Float32Array(c*a);h.fill(l);const p=t.data.get(r.dataId).values;for(let m=0;m<c;++m)p[m]>=0&&p[m]<a&&(h[m*a+p[m]]=o);return t.makeTensorInfo([...r.shape,a],i,h)}const m$e={kernelName:Jw,backendName:"cpu",kernelFunc:p$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Of({inputs:{input:s},backend:t}),i=b1({inputs:{x:r},backend:t}),a=Dm({inputs:{input:s},backend:t}),o=b1({inputs:{x:a},backend:t}),l=ea({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return oR({backend:t,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const g$e={kernelName:gT,backendName:"cpu",kernelFunc:b1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $K(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Of({inputs:{input:s},backend:t}),i=$K({inputs:{x:r},backend:t}),a=Dm({inputs:{input:s},backend:t}),o=b1({inputs:{x:a},backend:t}),l=ea({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return oR({backend:t,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const y$e={kernelName:Qw,backendName:"cpu",kernelFunc:$K};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AK(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return v1({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const i=e[0].shape,a=e[0].dtype;e.forEach(h=>{F2(i,h.shape,"All tensors passed to stack must have matching shapes"),J(a===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(h=>{const p=v1({inputs:{input:h},backend:t,attrs:{dim:r}});return o.push(p),p}),c=Lm({inputs:l,backend:t,attrs:{axis:r}});return o.forEach(h=>t.disposeIntermediateTensorInfo(h)),c}const v$e={kernelName:eT,backendName:"cpu",kernelFunc:AK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b$e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:i,constantValue:a}=s;at(r,"pad");const o=i.map((C,$)=>C[0]+r.shape[$]+C[1]),l=i.map(C=>C[0]),c=t.data.get(r.dataId).values,h=Me(r.shape),p=r.shape.length,m=ht(r.shape),v=Me(o),x=o.length,w=ht(o),T=Br(r.dtype,v);a!==0&&T.fill(a);for(let C=0;C<h;C++){const R=Qm(C,p,m).map((U,j)=>U+l[j]),P=Fl(R,x,w);T[P]=c[C]}return{dataId:t.write(T,o,r.dtype),shape:o,dtype:r.dtype}}const RK={kernelName:tT,backendName:"cpu",kernelFunc:b$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _$e=ks((n,e)=>Math.pow(n,e)),x$e=Qs(Eb,_$e),w$e={kernelName:Eb,backendName:"cpu",kernelFunc:x$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T$e(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:i,indices:a}=e,{outputRaggedRank:o}=s,l=r.map(E=>t.data.get(E.dataId).values),c=r.map(E=>E.shape),h=t.data.get(i.dataId).values,p=t.data.get(a.dataId).values,[m,v,x]=Y8(l,c,h,i.shape,i.dtype,p,a.shape),w=m.map(E=>t.makeTensorInfo([E.length],"int32",E)),T=t.makeTensorInfo(x,i.dtype,v);return w.concat([T])}const S$e={kernelName:rH,backendName:"cpu",kernelFunc:T$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E$e(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:i}=e,a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,[c,h]=Q8(a,s.shape,s.dtype,o,r.shape,l,i.shape),p=t.makeTensorInfo([c.length],"int32",c),m=t.makeTensorInfo([h.length],s.dtype,h);return[p,m]}const N$e={kernelName:iH,backendName:"cpu",kernelFunc:E$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I$e(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:i,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,c=t.data.get(r.dataId).values,h=t.data.get(i.dataId).values,p=t.data.get(a.dataId).values,m=o.map(T=>t.data.get(T.dataId).values),v=o.map(T=>T.shape),[x,w]=J8(c,r.shape,h,i.shape,i.dtype,p,a.shape,m,v,l);return t.makeTensorInfo(x,i.dtype,w)}const C$e={kernelName:aH,backendName:"cpu",kernelFunc:I$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k$e(n){const{backend:e,attrs:t}=n,{start:s,stop:r,dtype:i,step:a}=t,o=eK(s,r,a,i);return e.makeTensorInfo([o.length],i,o)}const $$e={kernelName:v$,backendName:"cpu",kernelFunc:k$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$e=In(Nb,n=>1/n),R$e={kernelName:Nb,backendName:"cpu",kernelFunc:A$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D$e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:i,halfPixelCenters:a,size:o}=s;at(r,"resizeBilinear");const l=ht(r.shape),[c,h]=o,[p,m,v,x]=r.shape,w=t.data.get(r.dataId).values,T=new Float32Array(Me([p,c,h,x])),E=[i&&c>1?m-1:m,i&&h>1?v-1:v],C=[i&&c>1?c-1:c,i&&h>1?h-1:h];let $=0;const R=E[0]/C[0],P=E[1]/C[1];for(let U=0;U<p;U++)for(let j=0;j<c;j++){let O;a?O=R*(j+.5)-.5:O=R*j;const M=Math.max(0,Math.floor(O)),B=O-M,D=Math.min(m-1,Math.ceil(O)),W=U*l[0]+M*l[1],H=U*l[0]+D*l[1];for(let ae=0;ae<h;ae++){let te;a?te=P*(ae+.5)-.5:te=P*ae;const Z=Math.max(0,Math.floor(te)),re=te-Z,ne=Math.min(v-1,Math.ceil(te)),he=W+Z*l[2],K=H+Z*l[2],ie=W+ne*l[2],pe=H+ne*l[2];for(let fe=0;fe<x;fe++){const Ne=w[he+fe],Te=w[K+fe],Se=w[ie+fe],He=w[pe+fe],qe=Ne+(Se-Ne)*re,Qe=Te+(He-Te)*re,pt=qe+(Qe-qe)*B;T[$++]=pt}}}return t.makeTensorInfo([p,c,h,x],"float32",T)}const L$e={kernelName:aT,backendName:"cpu",kernelFunc:D$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O$e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:i}=e,{alignCorners:a}=s;at([i,r],"resizeBilinearGrad");const o=ht(r.shape),[l,c,h,p]=r.shape,[,m,v]=i.shape,x=new Float32Array(l*c*h*p),w=[a&&m>1?c-1:c,a&&v>1?h-1:h],T=[a&&m>1?m-1:m,a&&v>1?v-1:v],E=w[0]/T[0],C=w[1]/T[1],$=t.data.get(i.dataId).values;let R=0;for(let P=0;P<l;P++){const U=P*o[0];for(let j=0;j<m;j++){const O=j*E,M=Math.floor(O),B=Math.min(Math.ceil(O),c-1),D=U+M*o[1],W=U+B*o[1],H=O-M,ae=1-H;for(let te=0;te<v;te++){const Z=te*C,re=Math.floor(Z),ne=Math.min(Math.ceil(Z),h-1),he=Z-re,K=1-he,ie=D+re*o[2],pe=D+ne*o[2],fe=W+re*o[2],Ne=W+ne*o[2],Te=ae*K,Se=ae*he,He=H*K,qe=H*he;for(let Qe=0;Qe<p;Qe++){const pt=$[R++];x[ie+Qe]+=pt*Te,x[pe+Qe]+=pt*Se,x[fe+Qe]+=pt*He,x[Ne+Qe]+=pt*qe}}}}return t.makeTensorInfo([l,h,c,p],"float32",x)}const P$e={kernelName:x$,backendName:"cpu",kernelFunc:O$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M$e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:i,halfPixelCenters:a,size:o}=s;at(r,"resizeNearestNeighbor");const l=ht(r.shape),[c,h]=o,[p,m,v,x]=r.shape,w=t.data.get(r.dataId).values,T=new Float32Array(p*c*h*x),E=[i&&c>1?m-1:m,i&&h>1?v-1:v],C=[i&&c>1?c-1:c,i&&h>1?h-1:h],$=E[0]/C[0],R=E[1]/C[1];let P=0;for(let U=0;U<p;U++){const j=U*l[0];for(let O=0;O<c;O++){const M=a?$*(O+.5):$*O;let B=Math.min(m-1,i?Math.round(M):Math.floor(M));a&&(B=Math.max(0,B));const D=j+B*l[1];for(let W=0;W<h;W++){const H=a?R*(W+.5):R*W;let ae=Math.min(v-1,i?Math.round(H):Math.floor(H));a&&(ae=Math.max(0,ae));const te=D+ae*l[2];for(let Z=0;Z<x;Z++){const re=w[te+Z];T[P++]=re}}}}return t.makeTensorInfo([p,c,h,x],r.dtype,T)}const F$e={kernelName:iT,backendName:"cpu",kernelFunc:M$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j$e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:i}=e,{alignCorners:a}=s;at([i,r],"resizeNearestNeighborGrad");const o=ht(r.shape),l=ht(i.shape),[c,h,p,m]=r.shape,[,v,x]=i.shape,w=new Float32Array(c*h*p*m),T=t.data.get(i.dataId).values,E=[a&&v>1?h-1:h,a&&x>1?p-1:p],C=[a&&v>1?v-1:v,a&&x>1?x-1:x],$=E[0]/C[0],R=E[1]/C[1],P=1/$,U=1/R,j=Math.ceil(P)*2+2,O=Math.ceil(U)*2+2;for(let M=0;M<c;M++){const B=M*o[0];for(let D=0;D<h;D++){const W=B+D*o[1],H=Math.floor(D*P),ae=Math.floor(H-j/2);for(let te=0;te<p;te++){const Z=W+te*o[2],re=Math.floor(te*U),ne=Math.floor(re-O/2);for(let he=0;he<m;he++){let K=0;for(let ie=0;ie<j;ie++){const pe=ie+ae;if(pe<0||pe>=v)continue;const fe=B+pe*l[1],Ne=pe*$,Te=Math.min(h-1,a?Math.round(Ne):Math.floor(Ne));if(D===Te)for(let Se=0;Se<O;Se++){const He=Se+ne;if(He<0||He>=x)continue;const qe=fe+He*l[2],Qe=He*R,pt=Math.min(p-1,a?Math.round(Qe):Math.floor(Qe));te===pt&&(K+=T[qe+he])}}w[Z+he]=K}}}}return t.makeTensorInfo(r.shape,r.dtype,w)}const B$e={kernelName:_$,backendName:"cpu",kernelFunc:j$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z$e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:i}=s;at(r,"reverse");const a=r.shape.length,o=Vt(i,r.shape);if(a===0)return nc({inputs:{x:r},backend:t});const l=new Er(r.shape,r.dtype),c=t.bufferSync(r);for(let h=0;h<l.size;h++){const p=l.indexToLoc(h),m=p.slice();o.forEach(v=>m[v]=r.shape[v]-1-m[v]),l.set(c.get(...m),...p)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const V$e={kernelName:oT,backendName:"cpu",kernelFunc:z$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U$e={kernelName:C$,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:i,center:a}=e,o=t,l=Br(s.dtype,Me(s.shape)),[c,h,p,m]=s.shape,[v,x]=pA(a,h,p),w=255,T=Math.sin(r),E=Math.cos(r),C=o.data.get(s.dataId).values;for(let R=0;R<c;R++){const P=R*p*h*m;for(let U=0;U<h;U++){const j=U*(p*m);for(let O=0;O<p;O++){const M=O*m;for(let B=0;B<m;B++){const D=[c,U,O,B],W=D[2],H=D[1];let ae=(W-v)*E-(H-x)*T,te=(W-v)*T+(H-x)*E;ae=Math.round(ae+v),te=Math.round(te+x);let Z=i;if(typeof i!="number"&&(B===3?Z=w:Z=i[B]),ae>=0&&ae<p&&te>=0&&te<h){const ne=te*(p*m),he=ae*m,K=P+ne+he+B;Z=C[K]}const re=P+j+M+B;l[re]=Z}}}}return{dataId:o.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$e=In(kb,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),W$e={kernelName:kb,backendName:"cpu",kernelFunc:G$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H$e(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:i}=e,{shape:a}=s,{sliceRank:o,numUpdates:l,sliceSize:c,strides:h,outputSize:p}=Hf(i,r,a),m=!0,v=t.bufferSync(r),x=t.bufferSync(i),w=Qd(v,x,a,p,c,l,o,h,0,m);return t.makeTensorInfo(a,w.dtype,w.values)}const q$e={kernelName:oH,backendName:"cpu",kernelFunc:H$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K$e(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<e?t=r+1:s=r;return s}function X$e(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<=e?t=r+1:s=r;return s}function Z$e(n,e,t,s,r,i){const a=ws("int32",t*r);for(let o=0;o<t;++o){const l=n.slice(o*s,(o+1)*s),c=o*r;for(let h=0;h<r;++h)a[c+h]=i==="left"?K$e(l,e[h+c]):X$e(l,e[h+c])}return a}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$e(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:i}=e,{side:a}=s,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,c=Z$e(o,l,r.shape[0],r.shape[1],i.shape[1],a);return t.makeTensorInfo(i.shape,"int32",c)}const Q$e={kernelName:cH,backendName:"cpu",kernelFunc:Y$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$e(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:i}=e;at([s,r,i],"select");const a=s.shape.length,o=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,c=t.data.get(i.dataId).values,h=ra(r.dtype,i.dtype),p=zr(Me(r.shape),h);let m=0;const v=a===0||a>1||r.shape.length===1?1:Me(r.shape.slice(1));for(let x=0;x<o.length;x++)for(let w=0;w<v;w++)o[x]===1?p[m++]=l[x]:p[m++]=c[x];return t.makeTensorInfo(r.shape,h,p)}const eAe={kernelName:lT,backendName:"cpu",kernelFunc:J$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tAe=CT,nAe=kT,sAe=In(Ab,n=>n>=0?nAe*n:tAe*(Math.exp(n)-1)),rAe={kernelName:Ab,backendName:"cpu",kernelFunc:sAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iAe=In(Lb,n=>n<0?-1:n>0?1:0),aAe={kernelName:Lb,backendName:"cpu",kernelFunc:iAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oAe=In(Rb,n=>Math.sin(n)),lAe={kernelName:Rb,backendName:"cpu",kernelFunc:oAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cAe=In(Db,n=>Math.sinh(n)),uAe={kernelName:Db,backendName:"cpu",kernelFunc:cAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hAe=11920928955078125e-23,V3=Math.log(hAe)+2,dAe=In(Pb,n=>{const e=n>-V3,t=n<V3,s=Math.exp(n);let r;return t?r=s:e?r=n:r=Math.log(1+s),r}),fAe={kernelName:Pb,backendName:"cpu",kernelFunc:dAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pAe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:i,paddings:a}=s;at([r],"spaceToBatchND");const o=Me(i),l=[[0,0]];l.push(...a);for(let U=1+i.length;U<r.shape.length;++U)l.push([0,0]);const c=RK.kernelFunc({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),h=Xb(c.shape,i,o,!1),p=Zb(h.length,i.length,!1),m=Yb(c.shape,i,o,!1),w=Gn({inputs:{x:c},backend:t,attrs:{shape:h}}),C=Oi({inputs:{x:w},backend:t,attrs:{perm:p}}),P=Gn({inputs:{x:C},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(C),P}const mAe={kernelName:hT,backendName:"cpu",kernelFunc:pAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gAe(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:i,defaultValue:a}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,c=t.data.get(i.dataId).values,h=t.data.get(a.dataId).values[0],[p,m,v,x,w]=rK(o,s.shape,s.dtype,l,r.dtype,c,h);return[t.makeTensorInfo(m,s.dtype,p),t.makeTensorInfo([m[0]],r.dtype,v),t.makeTensorInfo([x.length],"bool",new Uint8Array(x.map(T=>Number(T)))),t.makeTensorInfo([w.length],s.dtype,new Int32Array(w))]}const yAe={kernelName:uH,backendName:"cpu",kernelFunc:gAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vAe(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const a=Array.from(t.data.get(r.dataId).values),o=t.data.get(s.dataId).values,l=Array.from(t.data.get(i.dataId).values),[c,h,p]=iK(o,s.shape,s.dtype,a,l);return[t.makeTensorInfo(h,s.dtype,c),t.makeTensorInfo([p.length],i.dtype,new Int32Array(p))]}const bAe={kernelName:hH,backendName:"cpu",kernelFunc:vAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ae(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,[c,h]=sR(a,s.shape,s.dtype,o,l,!0);return t.makeTensorInfo(h,s.dtype,c)}const xAe={kernelName:dH,backendName:"cpu",kernelFunc:_Ae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wAe(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,[c,h]=sR(a,s.shape,s.dtype,o,l);return t.makeTensorInfo(h,s.dtype,c)}const TAe={kernelName:fH,backendName:"cpu",kernelFunc:wAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SAe(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:i,defaultValue:a}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:h,strides:p,outputSize:m}=Hf(i,r,o),v=!1,x=t.bufferSync(r);let w;switch(i.dtype){case"bool":{const T=t.bufferSync(i),E=!!t.data.get(a.dataId).values[0];w=Qd(x,T,o,m,h,c,l,p,E,v);break}case"float32":{const T=t.bufferSync(i),E=t.data.get(a.dataId).values[0];w=Qd(x,T,o,m,h,c,l,p,E,v);break}case"int32":{const T=t.bufferSync(i),E=t.data.get(a.dataId).values[0];w=Qd(x,T,o,m,h,c,l,p,E,v);break}case"string":{const T=t.bufferSync(i),E=jh(t.data.get(a.dataId).values[0]);w=Qd(x,T,o,m,h,c,l,p,E,v);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return t.makeTensorInfo(o,w.dtype,w.values)}const EAe={kernelName:pH,backendName:"cpu",kernelFunc:SAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NAe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:i,axis:a}=s,o=Vt(a,r.shape)[0],l=kA(r,i,o),c=new Array(r.shape.length).fill(0),h=r.shape.slice();return l.map(p=>{const m=[...h];m[o]=p;const v=Pf({inputs:{x:r},backend:t,attrs:{begin:c,size:m}});return c[o]+=p,v})}const IAe={kernelName:dT,backendName:"cpu",kernelFunc:NAe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CAe={kernelName:w$,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,s=e;at(t,"square");const r=s.data.get(t.dataId).values,i=new Float32Array(r.length);for(let o=0;o<r.length;++o){const l=r[o];i[o]=l*l}return{dataId:s.write(i,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kAe=In(Ub,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),$Ae={kernelName:Ub,backendName:"cpu",kernelFunc:kAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AAe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:i,end:a,strides:o,beginMask:l,endMask:c,ellipsisMask:h,newAxisMask:p,shrinkAxisMask:m}=s;at(r,"stridedSlice");const{finalShapeSparse:v,finalShape:x,isIdentity:w,sliceDim0:T,isSimpleSlice:E,begin:C,end:$,strides:R}=hA(r.shape,i,a,o,l,c,h,p,m);let P;if(w)P=Gn({inputs:{x:r},backend:t,attrs:{shape:x}});else if(T||E){J(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const U=lA(C,$,R),j=Pf({inputs:{x:r},backend:t,attrs:{begin:C,size:U}});P=Gn({inputs:{x:j},backend:t,attrs:{shape:x}}),t.disposeIntermediateTensorInfo(j)}else{const U=t.bufferSync(r),j=lK(v,U,R,C);P=t.makeTensorInfo(x,j.dtype,j.values)}return P}const RAe={kernelName:S$,backendName:"cpu",kernelFunc:AAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DAe(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:i,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:c}=s,{data:h,dataSplits:p}=e,m=t.data.get(h.dataId).values,v=t.data.get(p.dataId).values,[x,w]=cK(m,v,r,i,a,o,l,c);return[t.makeTensorInfo([x.length],"string",x),t.makeTensorInfo(p.shape,"int32",w)]}const LAe={kernelName:mH,backendName:"cpu",kernelFunc:DAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OAe(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:i,delimiter:a}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=t.data.get(i.dataId).values,l=t.data.get(a.dataId).values[0],[c,h,p]=uK(o,l,r),m=h.length;return[t.makeTensorInfo([m,2],"int32",c),t.makeTensorInfo([m],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(p))]}const PAe={kernelName:gH,backendName:"cpu",kernelFunc:OAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MAe(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const a=t.data.get(i.dataId).values,o=hK(a,r);return t.makeTensorInfo(i.shape,"int32",o)}const FAe={kernelName:yH,backendName:"cpu",kernelFunc:MAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jAe=In(Bb,n=>Math.tan(n)),BAe={kernelName:Bb,backendName:"cpu",kernelFunc:jAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zAe=In(zb,n=>Math.tanh(n)),VAe={kernelName:zb,backendName:"cpu",kernelFunc:zAe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UAe(n){const{inputs:e,backend:t}=n,{tensor:s,indices:r,updates:i}=e,{sliceRank:a,numUpdates:o,sliceSize:l,strides:c,outputSize:h}=Hf(i,r,s.shape),p=!1,m=t.bufferSync(r),v=t.bufferSync(i),x=t.bufferSync(s),w=Qd(m,v,s.shape,h,l,o,a,c,x,p);return t.makeTensorInfo(s.shape,w.dtype,w.values)}const GAe={kernelName:lH,backendName:"cpu",kernelFunc:UAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WAe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:i}=s;at(r,"tile");const a=fK(t.bufferSync(r),i);return t.makeTensorInfo(a.shape,a.dtype,a.values)}const HAe={kernelName:Vb,backendName:"cpu",kernelFunc:WAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qAe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:i,sorted:a}=s;at(r,"topk");const o=t.data.get(r.dataId).values,[l,c]=mK(o,r.shape,r.dtype,i,a);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(c.shape,c.dtype,c.values)]}const KAe={kernelName:E$,backendName:"cpu",kernelFunc:qAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XAe(n){const{inputs:e,attrs:t,backend:s}=n,{image:r,transforms:i}=e,{interpolation:a,fillMode:o,fillValue:l,outputShape:c}=t,[h,p,m,v]=r.shape,[x,w]=c??[p,m],T=[h,x,w,v],E=ht(r.shape),C=E[0],$=E[1],R=E[2],P=ht(T),U=P[0],j=P[1],O=P[2],M=Br(r.dtype,Me(T));M.fill(l);const B=s.data.get(r.dataId).values,D=s.data.get(i.dataId).values;for(let H=0;H<h;++H){const ae=i.shape[0]===1?D:D.subarray(H*8,H*8+8);for(let te=0;te<x;++te)for(let Z=0;Z<w;++Z)for(let re=0;re<v;++re){let ne;const he=ae[6]*Z+ae[7]*te+1;if(he===0)continue;const K=(ae[0]*Z+ae[1]*te+ae[2])/he,ie=(ae[3]*Z+ae[4]*te+ae[5])/he,pe=U3(K,m,o),fe=U3(ie,p,o);switch(a){case"nearest":ne=tRe(B,p,m,C,$,R,H,fe,pe,re,l);break;case"bilinear":ne=nRe(B,p,m,C,$,R,H,fe,pe,re,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}const Ne=H*U+te*j+Z*O+re;M[Ne]=ne}return s.makeTensorInfo(T,r.dtype,M)}return{dataId:s.write(M,T,r.dtype),shape:r.shape,dtype:r.dtype}}const ZAe={kernelName:N$,backendName:"cpu",kernelFunc:XAe};function U3(n,e,t){switch(t){case"reflect":return YAe(n,e);case"wrap":return QAe(n,e);case"nearest":return eRe(n,e);case"constant":default:return JAe(n)}}function YAe(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=2*e;t<s&&(t=s*Math.trunc(-t/s)+t),t=t<-e?t+s:-t-1}else if(t>e-1)if(e<=1)t=0;else{const s=2*e;t-=s*Math.trunc(t/s),t>=e&&(t=s-t-1)}return Sf(0,t,e-1)}function QAe(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=e-1;t+=e*(Math.trunc(-t/s)+1)}else if(t>e-1)if(e<=1)t=0;else{const s=e-1;t-=e*Math.trunc(t/s)}return Sf(0,t,e-1)}function JAe(n,e){return n}function eRe(n,e){return Sf(0,n,e-1)}function Sy(n,e,t,s,r,i,a,o,l,c,h){const p=a*s+o*r+l*i+c;return 0<=o&&o<e&&0<=l&&l<t?n[p]:h}function tRe(n,e,t,s,r,i,a,o,l,c,h){const p=Math.round(o),m=Math.round(l);return Sy(n,e,t,s,r,i,a,p,m,c,h)}function nRe(n,e,t,s,r,i,a,o,l,c,h){const p=Math.floor(o),m=Math.floor(l),v=p+1,x=m+1,w=(x-l)*Sy(n,e,t,s,r,i,a,p,m,c,h)+(l-m)*Sy(n,e,t,s,r,i,a,p,x,c,h),T=(x-l)*Sy(n,e,t,s,r,i,a,v,m,c,h)+(l-m)*Sy(n,e,t,s,r,i,a,v,x,c,h);return(v-o)*w+(o-p)*T}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sRe(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:i}=e;at(i,"unique");const a=s.data.get(i.dataId).values,{outputValues:o,outputShape:l,indices:c}=gK(a,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,o),s.makeTensorInfo([c.length],"int32",c)]}const rRe={kernelName:I$,backendName:"cpu",kernelFunc:sRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iRe(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const a=r.shape.length,o=r.shape[i],l=new Array(a-1);let c=0;for(let v=0;v<a;v++)v!==i&&(l[c++]=r.shape[v]);const h=new Array(a).fill(0),p=r.shape.slice();p[i]=1;const m=new Array(o);for(let v=0;v<m.length;v++){h[i]=v;const x=Pf({inputs:{x:r},backend:t,attrs:{begin:h,size:p}});m[v]=Gn({inputs:{x},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(x)}return m}const aRe={kernelName:pT,backendName:"cpu",kernelFunc:iRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oRe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:i}=e,{numSegments:a}=s;at(r,"unsortedSegmentSum");const o=r.shape.length,l=i.shape.length,c=[],h=[],p=o-l;let m=i;for(let x=0;x<p;++x){const w=v1({inputs:{input:m},backend:t,attrs:{dim:x+1}});m=w,h.push(w)}for(let x=0;x<a;++x){const w=td(x,"int32"),T=t.makeTensorInfo([],"int32",w),E=A8({inputs:{a:T,b:m},backend:t}),C=Gh({inputs:{x:E},backend:t,attrs:{dtype:"float32"}}),$=zT({inputs:{a:C,b:r},backend:t}),R=a_({inputs:{x:$},backend:t,attrs:{axis:0,keepDims:!1}});c.push(R),h.push(T),h.push(E),h.push(C),h.push($),h.push(R)}const v=AK({inputs:c,backend:t,attrs:{axis:0}});return h.forEach(x=>t.disposeIntermediateTensorInfo(x)),v}const lRe={kernelName:mT,backendName:"cpu",kernelFunc:oRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cRe=[sCe,MNe,iCe,oCe,UNe,cCe,hCe,fCe,mCe,yCe,bCe,xCe,TCe,NCe,CCe,ACe,DCe,OCe,MCe,tCe,jCe,zCe,UCe,WNe,WCe,zNe,qNe,qCe,FNe,XCe,YCe,QCe,eke,nke,rke,ake,lke,uke,dke,pke,gke,vke,_ke,wke,Tke,Eke,Ike,kke,$ke,Ake,Rke,Lke,Mke,KIe,jke,KNe,qke,XNe,Kke,YNe,e2e,t2e,s2e,JNe,tIe,i2e,o2e,c2e,h2e,sIe,iIe,jNe,f2e,ZCe,m2e,y2e,b2e,XIe,oIe,cIe,x2e,hIe,T2e,N2e,C2e,A2e,D2e,O2e,P2e,fIe,F2e,B2e,V2e,G2e,H2e,K2e,Z2e,mIe,Q2e,t$e,r$e,yIe,bIe,o$e,u$e,f$e,xIe,m$e,y$e,v$e,RK,w$e,YIe,SIe,S$e,N$e,C$e,$$e,BNe,hC,R$e,QIe,JIe,eCe,L$e,P$e,F$e,B$e,V$e,U$e,W$e,RIe,q$e,Q$e,eAe,rAe,LIe,aAe,lAe,uAe,OIe,n$e,fAe,mAe,yAe,bAe,xAe,TAe,EAe,IAe,FIe,CAe,BIe,VIe,$Ae,RAe,LAe,PAe,FAe,HIe,Oke,BAe,VAe,GAe,HAe,KAe,ZAe,wIe,rRe,aRe,lRe,g$e];for(const n of cRe)bH(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kd={},Ax={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function uRe(n,e){Kd[n]=e}function Yo(n,e){if(!(n in Kd)||e!=null){const s=dRe(n,e);if(s!==null)Kd[n]=s;else return console.log("Could not get context for WebGL version",n),null}const t=Kd[n];return t==null||t.isContextLost()?(delete Kd[n],Yo(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Kd[n])}function hRe(n){if(!De().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function dRe(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??hRe(n);return t.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Kd[n]},!1),De().getBool("SOFTWARE_WEBGL_ENABLED")&&(Ax.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Ax)||t.getContext("experimental-webgl",Ax):t.getContext("webgl2",Ax)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fv;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(fv||(fv={}));var ka;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(ka||(ka={}));var Sr;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Sr||(Sr={}));function o_(n,e){return[e,n]}function fRe(n,e){return n*e}function Rx(n){const e=Me(n),t=Math.ceil(e/4);return LI(t)}function ag(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function pRe(n,e){const[t,s]=ag(n,e);return t*s*4}function lR(n,e){const t=n;let s,r,i,a,o,l,c,h,p,m;return De().getNumber("WEBGL_VERSION")===2?(s=t.R32F,r=t.R16F,i=t.RGBA16F,a=t.RGBA32F,o=t.RED,c=4,h=1,p=t.HALF_FLOAT,m=t.FLOAT,l=t.RGBA8):(s=n.RGBA,r=n.RGBA,i=n.RGBA,a=t.RGBA,o=n.RGBA,c=4,h=4,p=e!=null?e.HALF_FLOAT_OES:null,m=n.FLOAT,l=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:h,textureTypeHalfFloat:p,textureTypeFloat:m}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function et(n,e){const t=e();return De().getBool("DEBUG")&&mRe(n),t}function mRe(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+bRe(n,e))}const gRe=596e-10,yRe=65504;function vRe(n){return!!(De().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||gRe<Math.abs(n)&&Math.abs(n)<yRe)}function bRe(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Dx(n,e){return uu(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function _Re(n,e){const t=uu(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(et(n,()=>n.shaderSource(t,e)),et(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function xRe(n,e){const t=uu(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(et(n,()=>n.shaderSource(t,e)),et(n,()=>n.compileShader(t)),De().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw DK(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const wRe=/ERROR: [0-9]+:([0-9]+):/g;function DK(n,e){const t=wRe.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const s=+t[1],r=n.split(`
`),i=r.length.toString().length+2,a=r.map((p,m)=>lm((m+1).toString(),i)+p);let o=0;for(let p=0;p<a.length;p++)o=Math.max(a[p].length,o);const l=a.slice(0,s-1),c=a.slice(s-1,s),h=a.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${lm(c[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join(`
`))}function TRe(n){return uu(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function SRe(n,e){if(et(n,()=>n.linkProgram(e)),!De().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function vN(n,e){if(et(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function ERe(n,e){const t=uu(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return et(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),et(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function NRe(n,e){const t=uu(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return et(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),et(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function IRe(n){return uu(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function CRe(n,e){const t=De().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const s=`[${n}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>t||e>t){const s=`[${n}x${e}]`,r=`[${t}x${t}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function kRe(n){return uu(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function G3(n,e,t,s,r,i,a){const o=n.getAttribLocation(e,t);return o===-1?!1:(et(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),et(n,()=>n.vertexAttribPointer(o,r,n.FLOAT,!1,i,a)),et(n,()=>n.enableVertexAttribArray(o)),!0)}function $Re(n,e,t){ORe(n,t),et(n,()=>n.activeTexture(n.TEXTURE0+t)),et(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function ARe(n,e,t){return uu(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function RRe(n,e,t){return n.getUniformLocation(e,t)}function DRe(n,e,t,s){et(n,()=>$Re(n,e,s)),et(n,()=>n.uniform1i(t,s))}function bN(n,e,t){et(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),et(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function W3(n,e){et(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),et(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function Lx(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+LRe(n,e))}function LRe(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function uu(n,e,t){const s=et(n,()=>e());if(s==null)throw new Error(t);return s}function ORe(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+n.TEXTURE0;if(s<n.TEXTURE0||s>t){const r=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Om(n,e=2){return Me(n.slice(0,n.length-e))}function Pm(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Ox(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Om(n),...Pm(n)]),e}function PRe(n,e=!1){let t=De().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=De().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&De().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=t/2),e&&(t=t*2,s=s*2,n=n.map((o,l)=>l>=n.length-2?M2(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=ed(n).newShape);let r=Me(n),i=null;n.length<=1&&r<=t?i=[1,r]:n.length===2&&n[0]<=t&&n[1]<=t?i=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?i=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?i=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?i=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(i=[n[0],n[1]*n[2]*n[3]]);const a=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||a)if(e){const o=Om(n);let l=2,c=2;n.length&&([l,c]=Pm(n)),r=o*(l/2)*(c/2),i=LI(r).map(h=>h*2)}else i=LI(r);return i}function Px(n){return n%2===0}function _1(n,e){if(n=n.slice(-2),e=e.slice(-2),xn(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],s=e[e.length-1];if(t===s||Px(t)&&Px(s)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&Px(n[0])&&Px(e[0])}let _N,xN;function MRe(n){if(_N==null){const e=Yo(n);_N=e.getParameter(e.MAX_TEXTURE_SIZE)}return _N}function FRe(n){if(xN==null){const e=Yo(n);xN=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,xN)}function jRe(n){if(n===0)return 0;let e;const t=Yo(n);return ao(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:ao(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function ao(n,e){return n.getExtension(e)!=null}function H3(n){try{if(Yo(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function BRe(n){if(n===0)return!1;const e=Yo(n);if(n===1){if(!ao(e,"OES_texture_float"))return!1}else if(!ao(e,"EXT_color_buffer_float"))return!1;return fC(e)}function zRe(n){if(n===0)return!1;const e=Yo(n);if(n===1){if(!ao(e,"OES_texture_float")||!ao(e,"WEBGL_color_buffer_float"))return!1}else{if(ao(e,"EXT_color_buffer_float"))return fC(e);const s="EXT_color_buffer_half_float";if(ao(e,s)){const r=e.getExtension(s);return VRe(e,r)}return!1}return fC(e)}function fC(n){const e=lR(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(i),a}function VRe(n,e){const t=lR(n,e),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(a),o}function URe(n){return n!==2?!1:Yo(n).fenceSync!=null}function l_(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&J(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ct=De();ct.registerFlag("HAS_WEBGL",()=>ct.getNumber("WEBGL_VERSION")>0);ct.registerFlag("WEBGL_VERSION",()=>H3(2)?2:H3(1)?1:0);ct.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);ct.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>ct.get("WEBGL_VERSION")===2);ct.registerFlag("WEBGL_CPU_FORWARD",()=>!0);ct.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);ct.registerFlag("WEBGL_PACK",()=>ct.getBool("HAS_WEBGL"));ct.registerFlag("WEBGL_PACK_NORMALIZATION",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_PACK_CLIP",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_PACK_REDUCE",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_LAZILY_UNPACK",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_CONV_IM2COL",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>ct.getBool("WEBGL_PACK"));ct.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>MRe(ct.getNumber("WEBGL_VERSION")));ct.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>FRe(ct.getNumber("WEBGL_VERSION")));ct.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=ct.getNumber("WEBGL_VERSION");return n===0?0:jRe(n)});ct.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>ct.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!$H());ct.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>BRe(ct.getNumber("WEBGL_VERSION")));ct.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>ct.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:ct.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));ct.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>zRe(ct.getNumber("WEBGL_VERSION")));ct.registerFlag("WEBGL_FENCE_API_ENABLED",()=>URe(ct.getNumber("WEBGL_VERSION")));ct.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>ct.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);ct.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});ct.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>$H()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});ct.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);ct.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);ct.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);ct.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);ct.registerFlag("WEBGL_EXP_CONV",()=>!1);ct.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>ct.getBool("IS_TEST"));ct.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);ct.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);ct.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);ct.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pi(){let n,e,t,s,r,i,a,o,l,c;return De().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",s="in",r="texture",i="outputColor",a="out vec4 outputColor;",o=De().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",s="varying",r="texture2D",i="gl_FragColor",a="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:s,texture2D:r,output:i,defineOutput:a,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xf(n,e,t="index"){const s=ht(e);return s.map((r,i)=>{const a=`int ${n[i]} = ${t} / ${r}`,o=i===s.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${r}`:`index -= ${n[i]} * ${r}`;return`${a}; ${o};`}).join("")}function VT(n,e,t="index"){const s=ht(e);return s.map((r,i)=>{const a=`int ${n[i]} = ${t} / outShapeStrides[${i}]`,o=i===s.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * outShapeStrides[${i}]`:`index -= ${n[i]} * outShapeStrides[${i}]`;return`${a}; ${o};`}).join("")}function GRe(n,e){const t=n.length,s=n.map(i=>`${e}[${i}]`),r=new Array(t-1);r[t-2]=s[t-1];for(let i=t-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function WRe(n,e,t="index"){const s=n.map((i,a)=>a),r=GRe(s,e);return r.map((i,a)=>{const o=`int ${n[a]} = ${t} / ${r[a]}`,l=a===r.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * ${r[a]}`:`index -= ${n[a]} * ${r[a]}`;return`${o}; ${l};`}).join("")}function cR(n){const e=ht(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function uR(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const LK=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:OK}=Owe;function HRe(n,e,t){const s=[];if(n.forEach(v=>{const x=Me(v.shapeInfo.logicalShape);if(v.shapeInfo.isUniform?s.push(`uniform float ${v.name}${x>1?`[${x}]`:""};`):(s.push(`uniform sampler2D ${v.name};`),s.push(`uniform int offset${v.name};`)),t.enableShapeUniforms){const{uniformShape:w}=hR(t.packedInputs,v.shapeInfo.logicalShape,v.shapeInfo.texShape);switch(w.length){case 1:s.push(`uniform int ${v.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${v.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${v.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${v.name}Shape;`);break}s.push(`uniform ivec2 ${v.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(v=>{s.push(`uniform ${v.type} ${v.name}${v.arrayIndex?`[${v.arrayIndex}]`:""};`)});const r=s.join(`
`),i=n.map(v=>qRe(v,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),a=e.texShape,o=pi(),l=ZRe(o);let c,h,p=JRe(o);return e.isPacked?(c=KRe(e.logicalShape,a,t.enableShapeUniforms),h=QRe(o)):(c=XRe(e.logicalShape,a,t.enableShapeUniforms),h=YRe(o)),t.packedInputs&&(p+=sDe),[p,l,h,r,c,i,t.userCode].join(`
`)}function og(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return mDe(n,e);case 1:return yDe(n,e);case 2:return bDe(n,e);case 3:return xDe(n,e);case 4:return TDe(n,e);case 5:return SDe(n);case 6:return EDe(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function PK(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return pDe(n);case 1:return gDe(n,e);case 2:return vDe(n,e);case 3:return _De(n,e);default:return wDe(n,e)}}function qRe(n,e,t=!1,s){let r="";t?r+=PK(n,s):r+=og(n,s);const i=n.shapeInfo.logicalShape,a=e.logicalShape;return i.length<=a.length&&(t?r+=NDe(n,e):r+=IDe(n,e)),r}function KRe(n,e,t){switch(n.length){case 0:return MK();case 1:return rDe(n,e,t);case 2:return dDe(n,e,t);case 3:return aDe(n,e,t);default:return lDe(n,e,t)}}function XRe(n,e,t){switch(n.length){case 0:return MK();case 1:return iDe(n,e,t);case 2:return fDe(n,e,t);case 3:return oDe(n,e,t);case 4:return cDe(n,e,t);case 5:return uDe(n,e);case 6:return hDe(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function ZRe(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function YRe(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function QRe(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function JRe(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${eDe}
    ${tDe}
    ${nDe}
  `}const eDe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,tDe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,nDe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,sDe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function MK(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function rDe(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function iDe(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function aDe(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[2]/2),i=r*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function oDe(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${VT(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=Xf(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function lDe(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[n.length-1]/2),i=r*Math.ceil(n[n.length-2]/2);let a=i,o="",l="b, r, c";for(let c=2;c<n.length-1;c++)a*=n[n.length-c-1],o=`
      int b${c} = index / ${a};
      index -= b${c} * ${a};
    `+o,l=`b${c}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${o}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${n.length}(${l});
    }
  `}function cDe(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${VT(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Xf(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function uDe(n,e){const t=Xf(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function hDe(n,e){const t=Xf(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function dDe(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(xn(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function fDe(n,e,t){return xn(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Zf(n){return`offset${n}`}function pDe(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),s=pi();return`
    vec4 ${t}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function mDe(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${t};}`;const[r,i]=n.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=Zf(t);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${a});
      return sampleTexture(${t}, uv);
    }
  `;const[o,l]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${a});
      return sampleTexture(${t}, uv);
    }
  `}function gDe(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=n.shapeInfo.texShape,i=pi();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${t}, uv);
    }
  `;const a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${a[0]}, ${a[1]}, index);
      return ${i.texture2D}(${t}, uv);
    }
  `}function yDe(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${lg(n)}
      }
    `;const r=n.shapeInfo.texShape,i=r[0],a=r[1];if(a===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=Zf(t);return a===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${i}.0);
        return sampleTexture(${t}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${a}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${o});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${a}, index + ${o});
      return sampleTexture(${t}, uv);
    }
  `}function vDe(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n.shapeInfo.texShape,a=i[0],o=i[1],l=pi();if(i!=null&&xn(t,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${a}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],h=Math.ceil(t[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${h}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function bDe(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n.shapeInfo.texShape;if(i!=null&&xn(t,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const m=i[0],v=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${v}.0, ${m}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:a,keptDims:o}=ed(t),l=a;if(l.length<t.length){const m=cg(n,l),v=["row","col"];return`
      ${og(m,e)}
      float ${r}(int row, int col) {
        return ${r}(${ug(v,o)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${lg(n)}
      }
    `;const c=i[0],h=i[1],p=Zf(s);return h===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${h}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${p};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${p};
    vec2 uv = uvFromFlat(${c}, ${h}, index);
    return sampleTexture(${s}, uv);
  }
`}function _De(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(t[0]===1){const m=t.slice(1),v=[1,2],x=cg(n,m),w=["b","row","col"];return`
        ${PK(x,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${ug(w,v)});
        }
      `}const o=pi();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `;const l=a[0],c=a[1],h=Math.ceil(t[2]/2),p=h*Math.ceil(t[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${p}, ${h}, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `}function xDe(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t[1]*t[2],a=t[2],{newShape:o,keptDims:l}=ed(t),c=o;if(c.length<t.length){const w=cg(n,c),T=["row","col","depth"];return`
        ${og(w,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${ug(T,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${a}, 1)));
        ${lg(n)}
      }
    `;const h=n.shapeInfo.texShape,p=h[0],m=h[1],v=n.shapeInfo.flatOffset;if(m===i&&v==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${a}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${m}.0, ${p}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(m===a&&v==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${m}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `;const x=Zf(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${x};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${a} + depth + ${x};
        vec2 uv = uvFromFlat(${p}, ${m}, index);
        return sampleTexture(${s}, uv);
      }
  `}function wDe(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=pi();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${t}, uv);
    }
  `;const i=n.shapeInfo.logicalShape,a=i.length,o=n.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],h=l[1],p=Math.ceil(i[a-1]/2);let m=p*Math.ceil(i[a-2]/2),v="int b, int row, int col",x=`b * ${m} + (row / 2) * ${p} + (col / 2)`;for(let w=2;w<a-1;w++)v=`int b${w}, `+v,m*=i[a-w-1],x=`b${w} * ${m} + `+x;return`
    vec4 ${s}(${v}) {
      int index = ${x};
      int texR = index / ${h};
      int texC = index - texR * ${h};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${c});
      return ${r.texture2D}(${t}, uv);
    }
  `}function TDe(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t[3],a=t[2]*i,o=t[1]*a,{newShape:l,keptDims:c}=ed(t);if(l.length<t.length){const C=cg(n,l),$=["row","col","depth","depth2"];return`
      ${og(C,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${ug($,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${a}, ${i}, 1)));
        ${lg(n)}
      }
    `;const h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,m=p[0],v=p[1],x=`int stride2 = ${s}Shape[3];`,w=`int stride1 = ${s}Shape[2] * stride2;`,T=`int stride0 = ${s}Shape[1] * stride1;`;if(v===o&&h==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${x}
        ${w}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${a}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${v}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(v===i&&h==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${v}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;const E=Zf(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${x}
      ${w}
      ${T}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${E});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${m}, ${v}, index + ${E});
      return sampleTexture(${s}, uv);
    }
  `}function SDe(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e[4],i=e[3]*r,a=e[2]*i,o=e[1]*a,{newShape:l,keptDims:c}=ed(e);if(l.length<e.length){const w=cg(n,l),T=["row","col","depth","depth2","depth3"];return`
      ${og(w)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${ug(T,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${a}, ${i}, ${r})) +
          depth3;
        ${lg(n)}
      }
    `;const h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,m=p[0],v=p[1];if(v===o&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${a}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${v}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(v===r&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${v}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;const x=Zf(t);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} + depth * ${i} +
          depth2 * ${r} + depth3 + ${x};
      vec2 uv = uvFromFlat(${m}, ${v}, index);
      return sampleTexture(${t}, uv);
    }
  `}function EDe(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:r,keptDims:i}=ed(e);if(r.length<e.length){const T=cg(n,r),E=["row","col","depth","depth2","depth3","depth4"];return`
      ${og(T)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${ug(E,i)});
      }
    `}const a=e[5],o=e[4]*a,l=e[3]*o,c=e[2]*l,h=e[1]*c;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${h}, ${c}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${a}, 1)));
        ${lg(n)}
      }
    `;const p=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,v=m[0],x=m[1];if(x===h&&p==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${o}, ${a})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${x}.0, ${v}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(x===a&&p==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${x}.0, ${v}.0);
        return sampleTexture(${t}, uv);
      }
    `;const w=Zf(t);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${h} + col * ${c} + depth * ${l} +
          depth2 * ${o} + depth3 * ${a} + depth4 + ${w};
      vec2 uv = uvFromFlat(${v}, ${x}, index);
      return sampleTexture(${t}, uv);
    }
  `}function lg(n){const e=n.name,t=Me(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function NDe(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",i=n.shapeInfo.logicalShape.length,a=e.logicalShape.length,o=OK(n.shapeInfo.logicalShape,e.logicalShape),l=$n(a),c=a-i;let h;const p=["x","y","z","w","u","v"];i===0?h="":a<2&&o.length>=1?h="coords = 0;":h=o.map(C=>`coords.${p[C+c]} = 0;`).join(`
`);let m="";a<2&&i>0?m="coords":m=n.shapeInfo.logicalShape.map((C,$)=>`coords.${p[$+c]}`).join(", ");let v="return outputValue;";const w=Me(n.shapeInfo.logicalShape)===1,E=Me(e.logicalShape)===1;if(i===1&&!w&&!E)v=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(w&&!E)a===1?v=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:v=`
        return vec4(outputValue.x);
      `;else if(o.length){const C=i-2,$=i-1;o.indexOf(C)>-1&&o.indexOf($)>-1?v="return vec4(outputValue.x);":o.indexOf(C)>-1?v="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf($)>-1&&(v="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${h}
      vec4 outputValue = get${s}(${m});
      ${v}
    }
  `}function IDe(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,a=n.shapeInfo.texShape,o=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&o===l&&n.shapeInfo.flatOffset==null&&xn(a,i))return`
      float ${r}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const c=$n(l),h=OK(n.shapeInfo.logicalShape,e.logicalShape),p=l-o;let m;const v=["x","y","z","w","u","v"];o===0?m="":l<2&&h.length>=1?m="coords = 0;":m=h.map(w=>`coords.${v[w+p]} = 0;`).join(`
`);let x="";return l<2&&o>0?x="coords":x=n.shapeInfo.logicalShape.map((w,T)=>`coords.${v[T+p]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${m}
      return get${s}(${x});
    }
  `}function $n(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function hR(n,e,t){const{newShape:s,keptDims:r}=ed(e),i=e.length,a=n&&i===3&&e[0]===1,o=a?e.slice(1):s,l=!n&&i>1&&!xn(e,t)&&s.length<i||a;return{useSqueezeShape:l,uniformShape:l?o:e,keptDims:r}}function cg(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function ug(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CDe(n,e,t,s){const r=t.map((h,p)=>{const m={logicalShape:h.shape,texShape:h.isUniform?null:h.texData.texShape,isUniform:h.isUniform,isPacked:h.isUniform?!1:h.texData.isPacked,flatOffset:null};return h.texData!=null&&h.texData.slice!=null&&h.texData.slice.flatOffset>0&&(m.flatOffset=h.texData.slice.flatOffset),{name:e.variableNames[p],shapeInfo:m}}),i=r.map(h=>h.shapeInfo),a={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},o=HRe(r,a,e),l=xRe(n.gl,o),c=n.createProgram(l);return De().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:a,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(c),Object.assign({program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:a},FK(n,e,c)))}function FK(n,e,t){const s=[],r=[];let i,a,o,l=null,c=null;c=n.getUniformLocation(t,"NAN",!1),De().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(t,"INFINITY",!1));const h=!1;for(const p of e.variableNames){const m={name:p,uniform:n.getUniformLocation(t,p,h),offset:n.getUniformLocation(t,`offset${p}`,h)};e.enableShapeUniforms&&(m.shape=n.getUniformLocation(t,`${p}Shape`,h),m.texShape=n.getUniformLocation(t,`${p}TexShape`,h)),s.push(m)}if(e.enableShapeUniforms&&(i=n.getUniformLocation(t,"outShape",h),o=n.getUniformLocation(t,"outShapeStrides",h),a=n.getUniformLocation(t,"outTexShape",h)),e.customUniforms)for(const p of e.customUniforms)r.push(n.getUniformLocation(t,p.name,h));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:a}}function q3(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,s)=>{const r=t.logicalShape,i=e[s],a=i.shape;if(!xn(r,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${a} must match`);if(t.isUniform&&i.isUniform)return;const o=t.texShape,l=i.isUniform?null:i.texData.texShape;if(!xn(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function kDe(n,e,t,s,r){e.program.enableShapeUniforms||(q3(e.inShapeInfos,t),q3([e.outShapeInfo],[s]));const i=s.texData.texture,a=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(i.texture,a[0],a[1]):n.setOutputMatrixTexture(i.texture,a[0],a[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),De().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<t.length;++l){const c=t[l],{uniform:h,offset:p,shape:m,texShape:v}=e.variablesLocations[l];if(m){const{uniformShape:x}=hR(e.program.packedInputs,c.shape,c.texData.texShape);switch(x.length){case 1:n.gl.uniform1iv(m,new Int32Array(x));break;case 2:n.gl.uniform2iv(m,new Int32Array(x));break;case 3:n.gl.uniform3iv(m,new Int32Array(x));break;case 4:n.gl.uniform4iv(m,new Int32Array(x));break}}if(v&&n.gl.uniform2i(v,c.texData.texShape[0],c.texData.texShape[1]),h!=null){if(c.isUniform){if(Me(c.shape)<2)n.gl.uniform1f(h,c.uniformValues[0]);else{let x=c.uniformValues;x instanceof Float32Array||(x=new Float32Array(x)),n.gl.uniform1fv(h,x)}continue}c.texData.slice!=null&&p!=null&&n.gl.uniform1i(p,c.texData.slice.flatOffset),n.setInputMatrixTexture(c.texData.texture.texture,h,l)}}const o=e.outShapeLocation;if(o)switch(s.shape.length){case 1:n.gl.uniform1iv(o,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(o,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(o,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(o,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=ht(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],h=e.customUniformLocations[l],p=r[l];if(c.type==="float")n.gl.uniform1fv(h,p);else if(c.type==="vec2")n.gl.uniform2fv(h,p);else if(c.type==="vec3")n.gl.uniform3fv(h,p);else if(c.type==="vec4")n.gl.uniform4fv(h,p);else if(c.type==="int")n.gl.uniform1iv(h,p);else if(c.type==="ivec2")n.gl.uniform2iv(h,p);else if(c.type==="ivec3")n.gl.uniform3iv(h,p);else if(c.type==="ivec4")n.gl.uniform4iv(h,p);else throw Error(`uniform type ${c.type} is not supported yet.`)}n.executeProgram()}function $De(n,e,t){let s="";e.concat(t).forEach(a=>{const o=a.texData!=null&&a.texData.slice!=null&&a.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!a.isUniform){const l=a.texData.texShape,{useSqueezeShape:c,uniformShape:h,keptDims:p}=hR(n.packedInputs,a.shape,l);let m="",v="",x="";if(h.length===1&&n.packedInputs){const P=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];m=`${P[0]>1}_${P[1]>1}`}else if(h.length===2&&!n.packedInputs)v=`${h[0]>1}_${h[1]>1}`;else if(h.length>2&&!n.packedInputs){const P=ht(h);x=`${P[0]===l[1]}_${P[P.length-1]===l[1]}`}const w=a.shape.length,T=h.length===2&&xn(a.shape,l),E=Me(a.shape)===1,C=km(a.shape,t.shape),$=!n.packedInputs&&w===t.shape.length&&xn(l,t.texData.texShape),R=n.packedInputs||h.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${w}_${$}_${c?p:""}_${h.length}_${E}_${C}_${T}_${m}_${v}_${x}_${R}_${o}`}else{const l=a.isUniform?"uniform":a.texData.texShape;s+=`${a.shape}_${l}_${o}`}});const r=n.userCode;let i=n.constructor.name;return i+="_"+s+"_"+r+`${De().getNumber("WEBGL_VERSION")}`,i}function Hr(n){return De().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ADe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=fv.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=pi();this.outputShape=e,this.enableShapeUniforms=Hr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?VT(["r","c","d"],e):Xf(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RDe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=fv.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=pi();this.outputShape=e,this.enableShapeUniforms=Hr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?VT(["r","c","d"],e):Xf(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DDe{constructor(e){this.variableNames=["A"],this.outTexUsage=ka.DOWNLOAD;const t=pi();this.outputShape=e,this.userCode=`
      ${LK}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LDe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ka.DOWNLOAD;const t=pi();this.outputShape=e,this.userCode=`
      ${LK}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ODe={R:0,G:1,B:2,A:3};class K3{constructor(e,t=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=pi();this.outputShape=e,this.enableShapeUniforms=Hr(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let a="";for(let o=0;o<s.length;o++){const l=s[o];a+=`
          if(offset == ${o}) {
            result = values[${ODe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?uR():cR(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${a}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PDe{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=pi();this.outputShape=e,this.enableShapeUniforms=Hr(this.outputShape.length);let r="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){const l=a*2+o;r+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?uR():cR(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MDe(n){const e=pi(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return _Re(n,t)}function FDe(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return ERe(n,e)}function jDe(n){const e=new Uint16Array([0,1,2,2,1,3]);return NRe(n,e)}function c_(n,e,t,s,r,i){CRe(e,t);const a=IRe(n),o=n.TEXTURE_2D;return et(n,()=>n.bindTexture(o,a)),et(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),et(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),et(n,()=>n.texParameteri(o,n.TEXTURE_MIN_FILTER,n.NEAREST)),et(n,()=>n.texParameteri(o,n.TEXTURE_MAG_FILTER,n.NEAREST)),De().getNumber("WEBGL_VERSION")===1?et(n,()=>n.texImage2D(o,0,s,e,t,0,r,i,null)):et(n,()=>n.texStorage2D(o,1,s,e,t)),et(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:a,texShape:[t,e]}}function jK(n){return n.internalFormatFloat}function BDe(n,e,t,s){const[r,i]=o_(e,t);return c_(n,r,i,jK(s),s.textureFormatFloat,n.FLOAT)}function BK(n){return n.internalFormatHalfFloat}function zDe(n,e,t,s){const[r,i]=o_(e,t);return c_(n,r,i,BK(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function zK(n){return n.downloadTextureFormat}function VDe(n,e,t,s){const[r,i]=o_(e,t);return c_(n,r,i,zK(s),n.RGBA,n.UNSIGNED_BYTE)}function VK(n){return n.internalFormatPackedFloat}function UDe(n,e,t,s){const[r,i]=ag(e,t);return c_(n,r,i,VK(s),n.RGBA,n.FLOAT)}function UK(n){return n.internalFormatPackedHalfFloat}function GDe(n,e,t,s){const[r,i]=ag(e,t);return c_(n,r,i,UK(s),n.RGBA,s.textureTypeHalfFloat)}function WDe(n,e,t){return et(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),G3(n,e,"clipSpacePos",t,3,20,0)&&G3(n,e,"uv",t,2,20,12)}function HDe(n,e,t,s,r,i){et(n,()=>n.bindTexture(n.TEXTURE_2D,e));let a,o,l;r instanceof Uint8Array?(a=new Uint8Array(t*s*4),o=n.UNSIGNED_BYTE,l=n.RGBA):(a=new Float32Array(t*s*4),o=n.FLOAT,l=i.internalFormatPackedFloat),a.set(r),De().getNumber("WEBGL_VERSION")===2?et(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,s,n.RGBA,o,a)):et(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,s,0,n.RGBA,o,a)),et(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function qDe(n,e,t){et(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?De().getNumber("WEBGL_VERSION")===2?et(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):et(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):De().getNumber("WEBGL_VERSION")===2?et(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):et(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),et(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function KDe(n,e,t,s){const r=n.createBuffer();et(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,r));const o=4*4*e*t;return et(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,o,n.STREAM_READ)),et(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),et(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),r}function XDe(n,e,t){const s=n,r=new Float32Array(t);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function ZDe(n,e,t,s){const[r,i]=o_(e,t),a=4,o=new Uint8Array(fRe(e*t,a));return et(n,()=>n.readPixels(0,0,r,i,s.downloadTextureFormat,n.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function YDe(n,e,t,s,r,i,a,o){const l=n,c=new Float32Array(pRe(i,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function QDe(n,e,t){const s=new Float32Array(e*t*4);return et(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wN{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=De().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,uRe(t,e)):this.gl=Yo(t),e=this.gl,De().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>et(i,()=>i.createVertexArray()),this.bindVertexArray=a=>et(i,()=>i.bindVertexArray(a)),this.deleteVertexArray=a=>et(i,()=>i.deleteVertexArray(a)),this.getVertexArray=()=>et(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>et(e,()=>i.createVertexArrayOES()),this.bindVertexArray=a=>et(e,()=>i.bindVertexArrayOES(a)),this.deleteVertexArray=a=>et(e,()=>i.deleteVertexArrayOES(a)),this.getVertexArray=()=>et(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),De().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=Dx(this.gl,i),ao(this.gl,a))this.textureHalfFloatExtension=Dx(this.gl,a);else if(De().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),ao(this.gl,r))this.colorBufferHalfFloatExtension=Dx(this.gl,r);else if(De().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",ao(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(ao(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=FDe(this.gl),this.indexBuffer=jDe(this.gl),this.framebuffer=kRe(this.gl),this.textureConfig=lR(this.gl,this.textureHalfFloatExtension)}get debug(){return De().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;et(e,()=>e.finish()),et(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),et(e,()=>e.deleteFramebuffer(this.framebuffer)),et(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),et(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),et(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),BDe(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),zDe(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),VDe(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),qDe(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,s,r){this.throwIfDisposed(),HDe(this.gl,e,t,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),GDe(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),UDe(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(W3(this.gl,this.framebuffer),this.outputTexture=null),et(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,s){return this.downloadMatrixDriver(e,()=>ZDe(this.gl,t,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,s,r,i,a){return YDe(this.gl,e,t,s,r,i,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return XDe(this.gl,e,t)}createBufferFromTexture(e,t,s){this.bindTextureToFrameBuffer(e);const r=KDe(this.gl,t,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,s;if(De().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const a=r.clientWaitSync(i,0,0);return a===r.ALREADY_SIGNALED||a===r.CONDITION_SATISFIED},t=i}else De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(t,De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:t,isFencePassed:s}}downloadMatrixFromPackedTexture(e,t,s){return this.downloadMatrixDriver(e,()=>QDe(this.gl,t,s))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=MDe(t));const s=TRe(t);et(t,()=>t.attachShader(s,this.vertexShader)),et(t,()=>t.attachShader(s,e)),SRe(t,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&vN(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;et(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),WDe(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(et(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&vN(this.gl,this.program),et(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,s=!0){return this.throwIfDisposed(),s?ARe(this.gl,e,t):RRe(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),et(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,s){this.throwIfDisposed(),this.throwIfNoProgram(),DRe(this.gl,e,t,s)}setOutputMatrixTexture(e,t,s){this.setOutputMatrixTextureDriver(e,s,t)}setOutputPackedMatrixTexture(e,t,s){this.throwIfDisposed();const[r,i]=ag(t,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,t,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&vN(this.gl,this.program),Lx(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}et(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),et(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Dx(this.gl,De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,s=this.getQueryTimerExtensionWebGL2();t.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await jM(()=>this.disposed||this.isQueryAvailable(e,De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=JDe(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:s}=this.itemsToPoll[t];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in De().platform&&(s=De().platform.setTimeoutCustom.bind(De().platform)),jM(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),bN(this.gl,e,this.framebuffer),this.debug&&Lx(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(bN(this.gl,this.outputTexture,this.framebuffer),this.debug&&Lx(this.gl)):W3(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const s=t();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,t,s){this.throwIfDisposed();const r=this.gl;bN(r,e,this.framebuffer),this.debug&&Lx(r),this.outputTexture=e,et(r,()=>r.viewport(0,0,t,s)),et(r,()=>r.scissor(0,0,t,s))}setOutputMatrixWriteRegionDriver(e,t,s,r){this.throwIfDisposed(),et(this.gl,()=>this.gl.scissor(e,t,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function JDe(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:eLe,bincountImpl:GK,bincountReduceImpl:tLe,bitwiseAndImpl:nLe,castImpl:sLe,ceilImpl:rLe,concatImpl:iLe,equalImpl:aLe,expImpl:oLe,expm1Impl:lLe,floorImpl:cLe,gatherNdImpl:uLe,gatherV2Impl:hLe,greaterImpl:dLe,greaterEqualImpl:fLe,lessImpl:pLe,lessEqualImpl:mLe,linSpaceImpl:gLe,logImpl:yLe,maxImpl:vLe,maximumImpl:bLe,minimumImpl:_Le,multiplyImpl:xLe,negImpl:wLe,notEqualImpl:TLe,prodImpl:SLe,raggedGatherImpl:ELe,raggedRangeImpl:NLe,raggedTensorToTensorImpl:ILe,rangeImpl:CLe,rsqrtImpl:kLe,scatterImpl:$Le,sigmoidImpl:ALe,simpleAbsImpl:WK,sliceImpl:RLe,sparseFillEmptyRowsImpl:DLe,sparseReshapeImpl:LLe,sparseSegmentReductionImpl:HK,sqrtImpl:OLe,staticRegexReplaceImpl:PLe,stridedSliceImpl:MLe,stringNGramsImpl:FLe,stringSplitImpl:jLe,stringToHashBucketFastImpl:BLe,subImpl:zLe,tileImpl:VLe,topKImpl:ULe,transposeImpl:dR,uniqueImpl:GLe}=qIe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qK(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function ci(n,e){return e===1?[n]:qK(n,e)}function WLe(n,e){if(n===1)return"rc";let t="";for(let s=0;s<n;s++)t+=e[s],s<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HLe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Hr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=ci("rc",this.rank),s=$n(this.rank),r=this.getOutOfBoundsCondition(t),i=this.getSetup(t),a=this.getOutput(t);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)i=`${e[e.length-1-a]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let s=this.rank-2;s<this.rank;s++)t+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KK{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Hr(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${qLe(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?uR():cR(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function qLe(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?WRe(["r","c","d"],"inputShape"):Xf(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KLe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,s){const r=Z3(t,s),i=Y3(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const a=X3(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let o;return r===Sr.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Sr.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Sr.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Sr.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Sr.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(e,t,s,r){if(this.freeTextures==null)return;const i=Z3(s,r),a=Y3(t,i,r);a in this.freeTextures||(this.freeTextures[a]=[]);const o=X3(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=De().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const c=this.usedTextures[a],h=c&&c.indexOf(e);if(h==null||h<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[h]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function XLe(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function X3(n,e,t,s,r){const i=ZLe(e,s);let a;if(r){const[l,c]=ag(n[0],n[1]);a=l*c}else{const[l,c]=o_(n[0],n[1]);a=l*c}const o=XLe(t,i);return a*o}function ZLe(n,e){switch(n){case Sr.PACKED_2X2_FLOAT32:return VK(e);case Sr.PACKED_2X2_FLOAT16:return UK(e);case Sr.UNPACKED_FLOAT32:return jK(e);case Sr.UNPACKED_FLOAT16:return BK(e);case Sr.PACKED_4X1_UNSIGNED_BYTE:return zK(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function YLe(n){return De().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Sr.PACKED_2X2_FLOAT32:Sr.UNPACKED_FLOAT32:n?Sr.PACKED_2X2_FLOAT16:Sr.UNPACKED_FLOAT16}function Z3(n,e){if(n===ka.UPLOAD)return Sr.PACKED_2X2_FLOAT32;if(n===ka.RENDER||n==null)return YLe(e);if(n===ka.DOWNLOAD||n===ka.PIXELS)return Sr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function Y3(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kl{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Hr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const po="if (isnan(x)) return x;",QLe="return x;",Q3="return abs(x);",JLe="return (x >= 0.0) ? x : (exp(x) - 1.0);",eOe=po+`
  return (x < 0.0) ? 0.0 : x;
`,tOe=po+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,sh="return x;",nOe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sOe="return x;",rOe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,iOe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,aOe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,oOe="return 1.0 / (1.0 + exp(-1.0 * x));";class gh{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Hr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lOe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Hr(this.outputShape.length);const t=e.length,s=ci("rc",t),r=$n(t),i=WLe(t,s),a=s.slice(-2),o=t<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cOe=v5,uOe=1e-7,hOe=1e-4,Mx={};function dOe(n){return n in Mx||(Mx[n]={}),Mx[n]}const fOe=De().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),pOe=600;function mOe(){return De().global.screen==null?1024:De().global.screen.height*De().global.screen.width*window.devicePixelRatio*pOe/1024/1024}class UT extends P2{nextDataId(){return UT.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!De().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof wN)t=e;else{const s=Yo(De().getNumber("WEBGL_VERSION"),e);t=new wN(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Yo(De().getNumber("WEBGL_VERSION"));t=new wN(s),this.binaryCache=dOe(De().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new KLe(this.gpgpu),this.numMBBeforeWarning=mOe(),this.texData=new GW(this,bl())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,s,r,i,a){const o=this.makeTensorInfo(t,s),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,i]},l.texShape=[r,i];const c=Ox(t),h=new K3(c,!1,a),p=this.runWebGLProgram(h,[o],s,[[r,i]]);return p.shape=t,l.texture=null,this.disposeIntermediateTensorInfo(o),p.dataId}write(e,t,s){if((De().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||De().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:s,values:e,usage:ka.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,s,r,i){if(De().getBool("DEBUG")&&this.checkNumericalProblems(t),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:t,usage:ka.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:a,shape:o,isPacked:l}=t;if(a!=null){let m;l?m=new gh(o,sh):m=new kl(o,sh);const v=this.runWebGLProgram(m,[{dataId:e,shape:o,dtype:r}],r),x=this.readSync(v.dataId);return this.disposeIntermediateTensorInfo(v),x}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let h;c&&(h=$i());let p;if(r==="complex64"){const m=this.readSync(i.real.dataId),v=this.readSync(i.imag.dataId);p=nu(m,v)}else p=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=$i()-h),this.convertAndCacheOnCPU(e,p)}async read(e){if(this.pendingRead.has(e)){const x=this.pendingRead.get(e);return new Promise(w=>x.push(w))}const t=this.texData.get(e),{values:s,shape:r,slice:i,dtype:a,complexTensorInfos:o,isPacked:l}=t;if(i!=null){let x;l?x=new gh(r,sh):x=new kl(r,sh);const w=this.runWebGLProgram(x,[{dataId:e,shape:r,dtype:a}],a),T=this.read(w.dataId);return this.disposeIntermediateTensorInfo(w),T}if(s!=null)return this.convertAndCacheOnCPU(e);if(De().getBool("DEBUG")&&!De().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&De().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,h;if(a!=="complex64"&&De().get("WEBGL_BUFFER_SUPPORTED")){h=this.decode(e);const x=this.texData.get(h.dataId);c=this.gpgpu.createBufferFromTexture(x.texture.texture,...Rx(r))}this.pendingRead.set(e,[]),a!=="complex64"&&await this.gpgpu.createAndWaitForFence();let p;if(a==="complex64"){const x=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),w=x[0],T=x[1];p=nu(w,T)}else if(c==null)p=this.getValuesFromTexture(e);else{const x=Me(r);p=this.gpgpu.downloadFloat32MatrixFromBuffer(c,x)}if(h!=null&&this.disposeIntermediateTensorInfo(h),c!=null){const x=this.gpgpu.gl;et(x,()=>x.deleteBuffer(c))}const m=this.convertAndCacheOnCPU(e,p),v=this.pendingRead.get(e);return this.pendingRead.delete(e),v.forEach(x=>x(m)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&bl().removeDataId(e,this),this.pendingDeletes--),m}readToGPU(e,t={}){const s=this.texData.get(e),{values:r,shape:i,slice:a,dtype:o,isPacked:l,texture:c}=s;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let v;l?v=new gh(i,sh):v=new kl(i,sh);const x=this.runWebGLProgram(v,[{dataId:e,shape:i,dtype:o}],o),w=this.readToGPU(x,t);return this.disposeIntermediateTensorInfo(x),w}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const h=this.decode(e,t.customTexShape),p=bl().makeTensorFromTensorInfo(h),m=this.texData.get(h.dataId);return Object.assign({tensorRef:p},m.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>jh(r));return zt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return zt(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const s=e[t];if(!vRe(s))throw De().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:s,isPacked:r}=this.texData.get(e),i=Me(t);if(De().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const m=this.decode(e),v=this.texData.get(m.dataId),x=this.gpgpu.downloadMatrixFromPackedTexture(v.texture.texture,...Rx(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(m),x}const a=De().getBool("WEBGL_PACK")&&r===!0,o=a?Ox(t):t,l=a?new LDe(o):new DDe(o),c=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:e}],"float32"),h=this.texData.get(c.dataId),p=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture.texture,h.texShape[0],h.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),p}timerAvailable(){return De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=Ef(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),a=Ef(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);o.kernelMs=_ve(l),o.getExtraProfileInfo=()=>l.map((c,h)=>({name:a[h],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:$i(),endMs:null}}endTimer(e){return De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=$i(),e)}async getQueryTime(e){if(De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,t),this.disposeData(s.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:s,texShape:r,usage:i,isPacked:a,slice:o}=this.texData.get(e),l=o&&o.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(t,r,i,a)));const h=this.texData.get(e);h.texture=null,h.texShape=null,h.isPacked=!1,h.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=fOe){return De().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&Me(s.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Na("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return cOe(e.shape,t)}packedUnaryOp(e,t,s){const r=new gh(e.shape,t),i=this.compileAndRun(r,[e],s);return bl().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=WK(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(De().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Q3,e.dtype);const t=new kl(e.shape,Q3),s=this.compileAndRun(t,[e]);return bl().makeTensorFromTensorInfo(s)}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&Kv(s[0])){const i=s.map(a=>Th(a));r=this.write(i,e,t)}else r=this.write(s,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,s){return bl().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,s),this)}unpackTensor(e){const t=new lOe(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new HLe(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const s=[Om(e.shape),...Pm(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[Om(t),...Pm(t)],a=new KK(i,s),o=!0,l=[s],c=this.runWebGLProgram(a,[r],e.dtype,l,o);return{dataId:c.dataId,shape:t,dtype:c.dtype}}decode(e,t){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:a}=s;if(t!=null){const m=Me(i),v=t[0]*t[1]*4;J(m<=v,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=Ox(i);let l;r?l=new RDe(o):l=new ADe(o);const c=!0,h=[t??Rx(o)],p=this.runWebGLProgram(l,[{shape:o,dtype:a,dataId:e}],a,h,c,t);return{dtype:a,shape:i,dataId:p.dataId}}runWebGLProgram(e,t,s,r,i=!1,a){const o=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===fv.DENSE){const E=a??Rx(e.outputShape);l.texShape=E.map(C=>C*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Me(o.shape)===0)return l.values=Br(o.dtype,0),o;const c=[],h=t.map(E=>{if(E.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let C=this.texData.get(E.dataId);if(C.texture==null){if(!e.packedInputs&&Me(E.shape)<=De().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:E.shape,texData:null,isUniform:!0,uniformValues:C.values};e.packedInputs&&(C.isPacked=!0,C.shape=E.shape)}if(this.uploadToGPU(E.dataId),!!C.isPacked!=!!e.packedInputs)E=C.isPacked?this.unpackTensor(E):this.packTensor(E),c.push(E),C=this.texData.get(E.dataId);else if(C.isPacked&&!_1(C.shape,E.shape)){const $=E,R=E.shape;E.shape=C.shape,E=this.packedReshape(E,R),c.push(E),C=this.texData.get(E.dataId),$.shape=R}return{shape:E.shape,texData:C,isUniform:!1}});this.uploadToGPU(o.dataId);const p={shape:o.shape,texData:l,isUniform:!1},m=$De(e,h,p),v=this.getAndSaveBinary(m,()=>CDe(this.gpgpu,e,h,p)),x=this.activeTimers!=null;let w;x&&(w=this.startTimer()),De().get("ENGINE_COMPILE_ONLY")||kDe(this.gpgpu,v,h,p,r),c.forEach(E=>this.disposeIntermediateTensorInfo(E)),x&&(w=this.endTimer(w),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(w)}));const T=De().getNumber("WEBGL_FLUSH_THRESHOLD");if(T>0){const E=$i();E-this.lastGlFlushTime>T&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=E)}if(!De().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const E=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),E}return o}compileAndRun(e,t,s,r,i=!1){return s=s||t[0].dtype,this.runWebGLProgram(e,t,s,r,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(De().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ke(()=>{if(!De().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=De().getBool("DEBUG");De().set("DEBUG",!1);const t=this.abs(_n(1e-8)).dataSync()[0];if(De().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?uOe:hOe}uploadToGPU(e){const t=this.texData.get(e),{shape:s,dtype:r,values:i,texture:a,usage:o,isPacked:l}=t;if(a!=null)return;const c=this.activeTimers!=null;let h;c&&(h=$i());let p=t.texShape;if(p==null&&(p=PRe(s,l),t.texShape=p),i!=null){const m=Ox(s);let v,x=p[1],w=p[0];const T=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!T)&&([x,w]=ag(p[0],p[1])),l?v=new PDe(m,T):v=new K3(m,T);const E=T?[w,x]:p,C=this.makeTensorInfo(E,r),$=this.texData.get(C.dataId);T?$.usage=ka.PIXELS:$.usage=ka.UPLOAD,$.texShape=E,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),x,w,i);const R=[[w,x]],U=this.runWebGLProgram(v,[C],r,R,!0),j=this.texData.get(U.dataId);t.texShape=j.texShape,t.isPacked=j.isPacked,t.usage=j.usage,De().get("ENGINE_COMPILE_ONLY")?this.disposeData(U.dataId):(t.texture=j.texture,t.values=null,this.texData.delete(U.dataId)),this.disposeIntermediateTensorInfo(C),c&&(this.uploadWaitMs+=$i()-h)}else{const m=this.acquireTexture(p,o,r,l);t.texture=m}}convertAndCacheOnCPU(e,t){const s=this.texData.get(e),{dtype:r}=s;return t!=null&&(s.values=gOe(t,r)),s.values}acquireTexture(e,t,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*Z0(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(t),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await O5(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(DK(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:l}=FK(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=a,e.outShapeStridesLocation=o,e.outTexShapeLocation=l}}createTensorFromGPUData(e,t,s){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:a,channels:o}=e,l=bl().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,t,s,i,a,o);return bl().makeTensorFromDataId(c,t,s,l)}}UT.nextDataId=0;function gOe(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<t.length;++s)t[s]=Math.round(n[s]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */AH()&&OH("webgl",()=>new UT,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fR=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Mf{constructor(e,t,s){this.variableNames=["A","B"],this.outputShape=Rt(t,s),this.enableShapeUniforms=Hr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yf=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class hg{constructor(e,t,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Rt(t,s);const i=this.outputShape.length;this.enableShapeUniforms=Hr(i);let a="";if(r)if(i===0||Me(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${$n(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ci("coords",i);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aa(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const yOe={kernelName:mb,backendName:"webgl",kernelFunc:aa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cd(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,i=t.makeTensorInfo(s.shape,"complex64"),a=t.texData.get(i.dataId),o=aa({inputs:{x:s},backend:t}),l=aa({inputs:{x:r},backend:t});return a.complexTensorInfos={real:o,imag:l},i}const vOe={kernelName:X2,backendName:"webgl",kernelFunc:cd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XK="return (a < 0.) ? b * a : a;",ZK=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function bOe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:i}=s,a=t.makeTensorInfo([],"float32",td(i,"float32")),o=De().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hg(ZK,r.shape,a.shape):new Mf(XK,r.shape,a.shape),l=t.runWebGLProgram(o,[r,a],"float32");return t.disposeIntermediateTensorInfo(a),l}const _Oe={kernelName:Mw,backendName:"webgl",kernelFunc:bOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YK="return (a < 0.) ? b * a : a;",QK=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function xOe(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e,i=De().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hg(QK,s.shape,r.shape):new Mf(YK,s.shape,r.shape);return t.runWebGLProgram(i,[s,r],"float32")}const wOe={kernelName:nT,backendName:"webgl",kernelFunc:xOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dg="if (isnan(x)) return x;";function cn({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:s}){return({inputs:r,backend:i})=>{const{x:a}=r,o=i,l=s||a.dtype;if(o.shouldExecuteOnCPU([a])&&t!=null){const p=o.texData.get(a.dataId),m=t(p.values,l);return o.makeTensorInfo(a.shape,l,m)}const c=De().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let h;return c?h=new gh(a.shape,e):h=new kl(a.shape,n),o.runWebGLProgram(h,[a],l)}}function Cr({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:a,backend:o})=>{const{a:l,b:c}=a,h=o;if(s&&l.dtype==="complex64"){const x=h.texData.get(l.dataId),w=h.texData.get(c.dataId),[T,E]=[[x.complexTensorInfos.real,w.complexTensorInfos.real],[x.complexTensorInfos.imag,w.complexTensorInfos.imag]].map($=>{const[R,P]=$,U={dataId:R.dataId,dtype:R.dtype,shape:l.shape},j={dataId:P.dataId,dtype:P.dtype,shape:c.shape},O=new Mf(n,l.shape,c.shape);return h.runWebGLProgram(O,[U,j],ra(R.dtype,P.dtype))}),C=cd({inputs:{real:T,imag:E},backend:h});return h.disposeIntermediateTensorInfo(T),h.disposeIntermediateTensorInfo(E),C}const p=i||ra(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||h.shouldExecuteOnCPU([l,c]))&&r!=null){const x=h.texData.get(l.dataId).values,w=h.texData.get(c.dataId).values,T=l.dtype==="string"?su(x):x,E=l.dtype==="string"?su(w):w,[C,$]=r(l.shape,c.shape,T,E,p),R=h.makeTensorInfo($,p),P=h.texData.get(R.dataId);return P.values=C,R}const m=De().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let v;return m?v=new hg(e,l.shape,c.shape,t):v=new Mf(n,l.shape,c.shape),h.runWebGLProgram(v,[l,c],p)}}function pv(n,e=!1){if(n==="linear")return e?sOe:QLe;if(n==="relu")return e?iOe:eOe;if(n==="elu")return e?rOe:JLe;if(n==="relu6")return e?aOe:tOe;if(n==="prelu")return e?QK:YK;if(n==="leakyrelu")return e?ZK:XK;if(n==="sigmoid")return e?oOe:nOe;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JK{constructor(e,t,s,r=!1,i=!1,a=!1,o=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Hr(this.outputShape.length);const h=r?e[1]:e[2],p=Math.ceil(h/2),m=r?"i * 2, rc.y":"rc.y, i * 2",v=i?"rc.z, i * 2":"i * 2, rc.z",x=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],w=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let T="",E="";o&&(l?T=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:c?T=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:T=`vec4 activation(vec4 x) {
          ${o}
        }`,E="result = activation(result);");const C=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let $="rc.x",R="rc.x";e[0]<t[0]?$=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(R=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${T}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${p}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${$};
        int batchB = ${R};
        for (int i = 0; i < ${p}; i++) {
          vec4 a = getMatrixA(batchA, ${m});
          vec4 b = getMatrixB(batchB, ${v});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${x[0]} * ${w[0]});
          result += (${x[1]} * ${w[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${C}

        ${E}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J3={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class eF{constructor(e,t,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Rt(t,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tF="return a * b;";function pR(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,i=ra(s.dtype,r.dtype);if(s.dtype==="complex64"){const o=t.texData.get(s.dataId),l=t.texData.get(r.dataId),c=new eF(J3.REAL,s.shape,r.shape),h=new eF(J3.IMAG,s.shape,r.shape),p=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:s.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],m=t.runWebGLProgram(c,p,"float32"),v=t.runWebGLProgram(h,p,"float32"),x=cd({inputs:{real:m,imag:v},backend:t});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(v),x}if(t.shouldExecuteOnCPU([s,r])){const o=t.texData.get(s.dataId),l=t.texData.get(r.dataId),[c,h]=xLe(s.shape,r.shape,o.values,l.values,i),p=t.makeTensorInfo(h,i),m=t.texData.get(p.dataId);return m.values=c,p}let a;return De().getBool("WEBGL_PACK_BINARY_OPERATIONS")?a=new hg(tF,s.shape,r.shape):a=new Mf(tF,s.shape,r.shape),t.runWebGLProgram(a,[s,r],i)}const TOe={kernelName:Sb,backendName:"webgl",kernelFunc:pR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SOe(n,e,t){const s=[Om(n.shape),...Pm(n.shape)],r={dtype:n.dtype,shape:s,dataId:n.dataId},i=[Om(e),...Pm(e)],a=new KK(i,s),o=!0,l=[s],c=t.runWebGLProgram(a,[r],n.dtype,l,o);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:i}=s,a=t,o=Me(r.shape),l=HW(i,o),c=Me(l);J(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const h=a.texData.get(r.dataId);return h.isPacked&&!_1(r.shape,l)&&!(h.texture!==null&&_1(h.shape,l))?SOe(r,l,a):(a.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const EOe={kernelName:rT,backendName:"webgl",kernelFunc:Ze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nF{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];const o=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(t!=null){const p=1/t;c=`sumValue += dot(values * ${Nm(p)?p.toPrecision(2):p}, ones);`}let h="";i%s>0&&(h=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NOe{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];let o="0.0",l="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",l="min"):t==="max"&&(o="-1.0 / 1e-20",l="max");let c=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");const h=Math.floor(s/4)*4,p=s%4;let m=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,v="vec4";t==="all"?(o="1.0",m=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,v="bvec4"):t==="any"&&(o="0.0",m=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,v="bvec4");let x="";i%s>0&&(x=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${x}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          ${v} values = ${v}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${m}
        }

        int inIdx = inOffset + ${h};
        if (${p===1}) {
          ${v} values = ${v}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${p===2}) {
          ${v} values = ${v}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${p===3}) {
          ${v} values = ${v}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${m}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IOe(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],s=IT(t);e.push({inSize:t,windowSize:s,outSize:Math.ceil(t/s)})}return e}function Qf(n,e,t,s){const r=IOe(n.shape);let i=n;for(let a=0;a<r.length;a++){const{inSize:o,windowSize:l,outSize:c}=r[a];let h,p;t==="mean"?h=a===0?new nF({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c},o):new nF({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c}):h=new NOe({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c},t),p=i,i=s.runWebGLProgram(h,[i],e),p.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(p)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class COe{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let a=0;a<s.length;a++)s[a]=e[t[a]];this.outputShape=s,this.rank=s.length;const r=$n(this.rank),i=kOe(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function kOe(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<n.length;r++)s[n[r]]=t[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Oe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let h=0;h<s.length;h++)s[h]=e[t[h]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=$n(this.rank),i=qK("rc",this.rank),a=new Array(this.rank);for(let h=0;h<t.length;h++)a[t[h]]=i[h];const o=`vec2(${a.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GT(n,e,t){const s=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $Oe(n.shape,e):new COe(n.shape,e);return t.runWebGLProgram(s,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AOe(n,e,t,s){const r=e,i=n.shape.length,a=Vt(r,n.shape);let o=a;const l=us(o,i),c=l!=null;let h=n;c&&(h=GT(n,l,s),o=Is(o.length,i)),Ir("sum",o,i);const[p,m]=ur(h.shape,o);let v=p;t&&(v=js(p,a));const x=Me(m),T=Me(n.shape)/x,E=Ze({inputs:{x:h},attrs:{shape:[T,x]},backend:s}),C=k$(n.dtype),$=Qf(E,C,"sum",s),R=Ze({inputs:{x:$},attrs:{shape:v},backend:s});return s.disposeIntermediateTensorInfo(E),s.disposeIntermediateTensorInfo($),c&&s.disposeIntermediateTensorInfo(h),R}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WT(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;return AOe(r,i,a,t)}const ROe={kernelName:uT,backendName:"webgl",kernelFunc:WT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function di(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{perm:i}=s,a=t,o=r.shape.length,l=new Array(o);for(let h=0;h<l.length;h++)l[h]=r.shape[i[h]];let c;if(a.shouldExecuteOnCPU([r])){const p=a.texData.get(r.dataId).values,m=dR(p,r.shape,r.dtype,i,l);c=a.makeTensorInfo(l,r.dtype);const v=a.texData.get(c.dataId);v.values=m}else c=GT(r,i,a);return c}const DOe={kernelName:cm,backendName:"webgl",kernelFunc:di};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7=1e3;function x1({a:n,b:e,transposeA:t,transposeB:s,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const c=n.shape.length,h=e.shape.length,p=t?n.shape[c-2]:n.shape[c-1],m=s?e.shape[h-1]:e.shape[h-2],v=t?n.shape[c-1]:n.shape[c-2],x=s?e.shape[h-2]:e.shape[h-1],w=n.shape.slice(0,-2),T=e.shape.slice(0,-2),E=Me(w),C=Me(T),R=Rt(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([v,x]);J(p===m,()=>`Error in matMul: inner shapes (${p}) and (${m}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${s} must match.`);const P=t?[E,p,v]:[E,v,p],U=s?[C,x,m]:[C,m,x],j=Ze({inputs:{x:n},backend:r,attrs:{shape:P}}),O=Ze({inputs:{x:e},backend:r,attrs:{shape:U}}),M=[j,O],B=Math.max(E,C),D=t?j.shape[1]:j.shape[2],W=i!=null,H=a!=null,ae=l==="leakyrelu",te=l!=null?pv(l,!0):null,Z=W||H||ae||te!=null;let re;if((v===1||x===1)&&D>e7&&Z===!1){let he=j,K=O;t&&(he=di({inputs:{x:j},backend:r,attrs:{perm:[0,2,1]}}),M.push(he)),s&&(K=di({inputs:{x:O},backend:r,attrs:{perm:[0,2,1]}}),M.push(K));const ie=x!==1,pe=x===1;let fe=he;ie&&(fe=Ze({inputs:{x:he},backend:r,attrs:{shape:[B,D,1]}}),M.push(fe));const Ne=x===1?2:1;let Te=K;pe&&(Te=Ze({inputs:{x:K},backend:r,attrs:{shape:[B,1,D]}}),M.push(Te));const Se=pR({inputs:{a:fe,b:Te},backend:r});re=WT({inputs:{x:Se},backend:r,attrs:{axis:Ne,keepDims:!0}}),M.push(Se)}else{const he=ra(n.dtype,e.dtype),K=new JK(P,U,[B,v,x],t,s,W,te,H,ae),ie=[j,O];if(i!=null&&ie.push(i),H&&ie.push(a),ae){const pe=r.makeTensorInfo([],"float32",td(o,"float32"));ie.push(pe),M.push(pe)}re=r.runWebGLProgram(K,ie,he)}const ne=Ze({inputs:{x:re},backend:r,attrs:{shape:R}});M.push(re);for(const he of M)r.disposeIntermediateTensorInfo(he);return ne}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LOe(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:h,leakyreluAlpha:p}=s;return x1({a:r,b:i,transposeA:l,transposeB:c,backend:t,bias:a,preluActivationWeights:o,leakyreluAlpha:p,activation:h})}const OOe={kernelName:Y0,backendName:"webgl",kernelFunc:LOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sF="return abs(x);";function POe(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=t.texData.get(s.dataId),a=WK(i.values);return t.makeTensorInfo(s.shape,s.dtype,a)}let r;return De().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new gh(s.shape,sF):r=new kl(s.shape,sF),t.runWebGLProgram(r,[s],s.dtype)}const MOe={kernelName:yw,backendName:"webgl",kernelFunc:POe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FOe=po+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,jOe=cn({opSnippet:FOe}),BOe={kernelName:Xv,backendName:"webgl",kernelFunc:jOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zOe=po+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,VOe=cn({opSnippet:zOe}),UOe={kernelName:Zv,backendName:"webgl",kernelFunc:VOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rF="return a + b;",GOe=Cr({opSnippet:rF,packedOpSnippet:rF,supportsComplex:!0,cpuKernelImpl:eLe}),WOe={kernelName:Jm,backendName:"webgl",kernelFunc:GOe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HOe{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qOe{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0(n){const{inputs:e,backend:t}=n,s=e;if(s.length===1)return aa({inputs:{x:s[0]},backend:t});if(s.length>De().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=d0({inputs:s.slice(0,l),backend:t}),h=d0({inputs:s.slice(l),backend:t});return d0({inputs:[c,h],backend:t})}const r=s.map(l=>l.dtype).reduce((l,c)=>ra(l,c)),i=s.map(l=>l.shape),o=De().getBool("WEBGL_PACK")?new qOe(s[0].shape,i):new HOe(s[0].shape,i);return t.runWebGLProgram(o,s,r)}const KOe={kernelName:V2,backendName:"webgl",kernelFunc:d0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XOe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=r.shape.length,l=Vt(i,r.shape);let c=l;const h=us(c,o);let p=r;h!=null&&(p=di({inputs:{x:r},backend:t,attrs:{perm:h}}),c=Is(c.length,o)),Ir("all",c,o);const[m,v]=ur(p.shape,c),x=Me(v),w=Ze({inputs:{x:p},backend:t,attrs:{shape:[-1,x]}}),T=Qf(w,w.dtype,"all",t);let E;if(a){const C=js(m,l);E=Ze({inputs:{x:T},backend:t,attrs:{shape:C}})}else E=Ze({inputs:{x:T},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(T),h!=null&&t.disposeIntermediateTensorInfo(p),E}const ZOe={kernelName:U2,backendName:"webgl",kernelFunc:XOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YOe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=r.shape.length,l=Vt(i,r.shape);let c=l;const h=us(c,o);let p=r;h!=null&&(p=di({inputs:{x:r},backend:t,attrs:{perm:h}}),c=Is(c.length,o)),Ir("any",c,o);const[m,v]=ur(p.shape,c),x=Me(v),w=Ze({inputs:{x:p},backend:t,attrs:{shape:[-1,x]}}),T=Qf(w,w.dtype,"any",t);let E;if(a){const C=js(m,l);E=Ze({inputs:{x:T},backend:t,attrs:{shape:C}})}else E=Ze({inputs:{x:T},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(T),h!=null&&t.disposeIntermediateTensorInfo(p),E}const QOe={kernelName:G2,backendName:"webgl",kernelFunc:YOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JOe{constructor(e,t,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:a}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];const o=t==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ePe{constructor(e,t,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,J(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,c=$n(l),h=ci("coords",l);let p,m;if(a===1){m=l+1;const O=$n(m);p=`
        ${O} sourceLocR = ${O}(${h.join()}, 0);
        ++${h[l-1]};
        ${O} sourceLocG = ${O}(${h.join()}, 0);
        ++${h[l-2]};
        ${O} sourceLocA = ${O}(${h.join()}, 0);
        --${h[l-1]};
        ${O} sourceLocB = ${O}(${h.join()}, 0);
        --${h[l-2]};`}else m=l,p=`
        ${c} sourceLocR = coords;
        ++${h[l-1]};
        ${c} sourceLocG = coords;
        ++${h[l-2]};
        ${c} sourceLocA = coords;
        --${h[l-1]};
        ${c} sourceLocB = coords;
        --${h[l-2]};`;const v=["x","y","z","w","u","v"].slice(0,m),x="."+v[m-1],w=v.map(O=>"int "+O),T=ci("sourceLocR",m-1).concat("inIdx.r"),E=ci("sourceLocG",m-1).concat("inIdx.g"),C=ci("sourceLocB",m-1).concat("inIdx.b"),$=ci("sourceLocA",m-1).concat("inIdx.a"),R=s==="max"?"greaterThan":"lessThan",P=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${T.join()}),
                             getBestIndicesAChannel(${E.join()}),
                             getBestIndicesAChannel(${C.join()}),
                             getBestIndicesAChannel(${$.join()})));`,U=`vec4(
            getAChannel(${T.join()}),
            hasNextCol ? getAChannel(${E.join()}) : 0.,
            hasNextRow ? getAChannel(${C.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${$.join()}) : 0.)`,j=r?"":`
      float getBestIndicesAChannel(${w.join()}) {
        return getChannel(getBestIndicesA(${v.join()}),
                                          vec2(${v.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${w.join()}) {
        return getChannel(getA(${v.join()}),
                               vec2(${v.slice(-2).join()}));
      }
      ${j}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${h[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${h[l-2]} < ${o[l-2]-1};
        ${p}
        ivec4 srcIdx = ivec4(sourceLocR${x}, sourceLocG${x},
          sourceLocB${x}, sourceLocA${x}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${U};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${P}
          vec4 candidate = ${U};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${R}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t7(n,e,t,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const a=IT(i),o={windowSize:a,inSize:i,batchSize:r,outSize:Math.ceil(i/a)},l=new JOe(o,t,s==null),c=[e];s!=null&&c.push(s);const h=n.runWebGLProgram(l,c,"int32");if(h.shape[1]===1)return h;const p=t7(n,e,t,h);return n.disposeIntermediateTensorInfo(h),p}function n7(n,e,t,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],a=IT(i),o=new ePe(r,a,t,s==null),l=s==null?[e]:[e,s],c=n.runWebGLProgram(o,l,"int32");if(c.shape.length===e.shape.length){const h=n7(n,e,t,c);return n.disposeIntermediateTensorInfo(c),h}return c}function s7(n,e,t,s){const r=[t];if(Ir("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!De().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],a=n.texData.get(e.dataId),o=a!==null&&a.isPacked;let l=e;o&&(l=n.unpackTensor(e),i.push(l));const[c,h]=ur(l.shape,r),p=Me(h),m=Ze({inputs:{x:l},backend:n,attrs:{shape:[-1,p]}});i.push(m);const v=t7(n,m,s);i.push(v);const x=Ze({inputs:{x:v},backend:n,attrs:{shape:c}});return i.forEach(w=>n.disposeIntermediateTensorInfo(w)),x}return n7(n,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tPe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i}=s;let a=Vt(i,r.shape);const o=us(a,r.shape.length);let l=r;const c=[];o!=null&&(l=di({inputs:{x:r},backend:t,attrs:{perm:o}}),c.push(l),a=Is(a.length,l.shape.length)),Ir("argMax",[a[0]],l.shape.length);const h=s7(t,l,a[0],"max");return c.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const nPe={kernelName:vw,backendName:"webgl",kernelFunc:tPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sPe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i}=s;let a=Vt(i,r.shape);const o=us(a,r.shape.length);let l=r;const c=[];o!=null&&(l=di({inputs:{x:r},backend:t,attrs:{perm:o}}),c.push(l),a=Is(a.length,l.shape.length)),Ir("argMin",[a[0]],l.shape.length);const h=s7(t,l,a[0],"min");return c.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const rPe={kernelName:bw,backendName:"webgl",kernelFunc:sPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iPe=po+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,aPe=cn({opSnippet:iPe}),oPe={kernelName:Yv,backendName:"webgl",kernelFunc:aPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lPe=po+"return log(x + sqrt(x * x + 1.0));",cPe=cn({opSnippet:lPe}),uPe={kernelName:Qv,backendName:"webgl",kernelFunc:cPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hPe=po+`
  return atan(x);
`,dPe=cn({opSnippet:hPe}),fPe={kernelName:Jv,backendName:"webgl",kernelFunc:dPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pPe=fR+`
  return atan(a, b);
`,mPe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Yf+`
  return result;
`,gPe=Cr({opSnippet:pPe,packedOpSnippet:mPe}),yPe={kernelName:tb,backendName:"webgl",kernelFunc:gPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vPe=po+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,bPe=cn({opSnippet:vPe}),_Pe={kernelName:eb,backendName:"webgl",kernelFunc:bPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mv{constructor(e,t,s,r=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,v=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const w=t==="avg",T=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,E=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let C="0.0";if(w||(C="-1.0 / 1e-20"),s){this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${v}, ${x});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${m};
                wC += ${h}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?T:E:`wR * ${m} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let R=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(R="avgValue / max(count, 1.0)");const P=Math.floor(a/4)*4,U=a%4,j=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${v}, ${x});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${p};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${P}; wC += 4) {
            int xC = xCCorner + wC * ${h};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              getValue(batch, xR, xC + 3 * ${h}, d)
            );

            ${j}
          }

          int xC = xCCorner + ${P};
          if (${U===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${j}
          } else if (${U===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              initializationValue,
              initializationValue
            );

            ${j}
          } else if (${U===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              initializationValue
            );

            ${j}
          }
        }
        setOutput(${R});
      }
    `}}class mR{constructor(e,t,s,r=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideDepth,l=e.strideHeight,c=e.strideWidth,h=e.dilationDepth,p=e.dilationHeight,m=e.dilationWidth,v=e.effectiveFilterDepth,x=e.effectiveFilterHeight,w=e.effectiveFilterWidth,T=e.padInfo.front,E=e.padInfo.top,C=e.padInfo.left;this.outputShape=e.outShape;const $=t==="avg";let R="0.0";if($||(R="-1.0 / 1e-20"),s){this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${c});
        const ivec3 pads = ivec3(${T}, ${E}, ${C});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${v};
              wD += ${h}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${x};
                wR += ${p}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${w};
                  wC += ${m}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${x} * ${w} +
                      wR * ${w} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const P="max";let U=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(U="avgValue / max(count, 1.0)");const j=Math.floor(a/4)*4,O=a%4,M=`
      if (${$}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${P}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${c});
      const ivec3 pads = ivec3(${T}, ${E}, ${C});
      const float initializationValue = ${R};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${R});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${v};
            wD += ${h}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${x};
            wR += ${p}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${j}; wC += 4) {
              int xC = xCCorner + wC * ${m};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                getValue(batch, xD, xR, xC + 3 * ${m}, ch)
              );

              ${M}
            }

            int xC = xCCorner + ${j};
            if (${O===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${O===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${O===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                initializationValue
              );

              ${M}
            }
          }
        }
        setOutput(${U});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xPe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;l_(r,"avgPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=s,c=1;J(Gr(a,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const h=ho(r.shape,i,a,c,o,l);if(h.filterWidth===1&&h.filterHeight===1&&xn(h.inShape,h.outShape))return aa({inputs:{x:r},backend:t});const p=new mv(h,"avg",!1);return t.runWebGLProgram(p,[r],"float32")}const wPe={kernelName:_w,backendName:"webgl",kernelFunc:xPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TPe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:c}=s,h=[1,1,1],p=lu(r.shape,i,a,h,o,l,c),m=new mR(p,"avg",!1);return t.runWebGLProgram(m,[r],"float32")}const SPe={kernelName:xw,backendName:"webgl",kernelFunc:TPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EPe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,h=l-1-e.padInfo.top,p=c-1-e.padInfo.left,m=1/(t*s);this.userCode=`
      const ivec2 pads = ivec2(${h}, ${p});
      const float avgMultiplier = float(${m});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class NPe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,m=e.effectiveFilterHeight,v=e.effectiveFilterWidth,x=p-1-e.padInfo.front,w=m-1-e.padInfo.top,T=v-1-e.padInfo.left,E=1/(t*s*r);this.userCode=`
      const ivec3 pads = ivec3(${x}, ${w}, ${T});
      const float avgMultiplier = float(${E});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${m};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${v};
                wC += ${h}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IPe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,a=i,{filterSize:o,strides:l,pad:c,dimRoundingMode:h}=s,p=[1,1,1],m=lu(a.shape,o,l,p,c,h),v=new NPe(m);return t.runWebGLProgram(v,[r],a.dtype)}const CPe={kernelName:H2,backendName:"webgl",kernelFunc:IPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kPe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,a=i;l_([r,i],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=s,h=ho(a.shape,o,l,1,c),p=new EPe(h);return t.runWebGLProgram(p,[r],a.dtype)}const $Pe={kernelName:W2,backendName:"webgl",kernelFunc:kPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function APe(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:i}=e,{transposeA:a,transposeB:o}=s;return x1({a:r,b:i,transposeA:a,transposeB:o,backend:t})}const RPe={kernelName:ww,backendName:"webgl",kernelFunc:APe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DPe{constructor(e,t,s,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Rt(e,t),Rt(e,s);let o="0.0";r!=null&&(Rt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Rt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LPe{constructor(e,t,s,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Rt(e,t),Rt(e,s);let o="vec4(0.0)";r!=null&&(Rt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Rt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OPe=({inputs:n,backend:e,attrs:t})=>{const{x:s,mean:r,variance:i,offset:a,scale:o}=n;J(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),J(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),J(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const c=[s,r,i];let h=null;a!=null&&(h=a.shape,c.push(a));let p=null;o!=null&&(p=o.shape,c.push(o));const m=De().getBool("WEBGL_PACK_NORMALIZATION")?new LPe(s.shape,r.shape,i.shape,h,p,l):new DPe(s.shape,r.shape,i.shape,h,p,l);return e.runWebGLProgram(m,c,c[0].dtype)},PPe={kernelName:Lw,backendName:"webgl",kernelFunc:OPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MPe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=$n(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=FPe(this.rank);let r;const i=e.map((a,o)=>`sourceLoc.${pC[o]} = start[${o}] + coords.${pC[o]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const pC=["x","y","z","w","u","v"];function FPe(n){if(n===1)return"sourceLoc";if(n<=6)return pC.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jPe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=$n(this.rank),s=ci("coords",this.rank),r=ci("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,a=`getChannel(getSource(${r.join()}), ${i})`,o=`
      result.x = ${a};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${a};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${a};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${a};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((h,p)=>`start[${p}]`).join()});`:e.map((h,p)=>`${r[p]} = ${s[p]} + start[${p}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BPe(n,e,t,s){const r=s.texData.get(n.dataId),i=s.makeTensorInfo(t,n.dtype),a=s.texData.get(i.dataId);Object.assign(a,r),a.refCount=1,a.shape=t,a.dtype=n.dtype;let o=uA(e,ht(n.shape));r.slice&&(o+=r.slice.flatOffset),a.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||n.dataId};const l=s.dataRefCount.get(a.slice.origDataId)||1;return s.dataRefCount.set(a.slice.origDataId,l+1),i}function fg(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:i,size:a}=s,[o,l]=NT(r,i,a);if(oA(r,o,l),Me(l)===0)return t.makeTensorInfo(l,r.dtype,[]);if(t.shouldExecuteOnCPU([r])||r.dtype==="string"){const p=t.texData.get(r.dataId),m=RLe(p.values,o,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,m)}const{isPacked:c}=t.texData.get(r.dataId),h=cA(r.shape,o,l);if(c||!h){const p=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jPe(l):new MPe(l),m=[o];return t.runWebGLProgram(p,[r],r.dtype,m)}return t.uploadToGPU(r.dataId),BPe(r,o,l,t)}const zPe={kernelName:cT,backendName:"webgl",kernelFunc:fg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VPe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:i,crops:a}=s;J(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=i.reduce((C,$)=>C*$),l=Xb(r.shape,i,o),c=Zb(l.length,i.length),h=Yb(r.shape,i,o),p=mA(a,i.length),m=gA(h,a,i.length),v=[],x=Ze({inputs:{x:r},backend:t,attrs:{shape:l}}),w=di({inputs:{x},backend:t,attrs:{perm:c}}),T=Ze({inputs:{x:w},backend:t,attrs:{shape:h}}),E=fg({inputs:{x:T},backend:t,attrs:{begin:p,size:m}});return v.push(x),v.push(w),v.push(T),v.forEach(C=>t.disposeIntermediateTensorInfo(C)),E},UPe={kernelName:Tw,backendName:"webgl",kernelFunc:VPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GPe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:i}=e,{size:a}=s,o=t.readSync(r.dataId),l=t.readSync(i.dataId),c=GK(o,l,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,c)}const WPe={kernelName:q2,backendName:"webgl",kernelFunc:GPe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HPe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,qPe=`
  return float(int(a.r) & int(b.r));
`;function KPe(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,i=De().getBool("WEBGL_PACK_BINARY_OPERATIONS"),a=De().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([s,r])||a===1){const l=t.texData.get(s.dataId).values,c=t.texData.get(r.dataId).values,[h,p]=nLe(s.shape,r.shape,l,c,s.dtype),m=t.makeTensorInfo(p,s.dtype),v=t.texData.get(m.dataId);return v.values=h,m}let o;return i?o=new hg(HPe,s.shape,r.shape,!1):o=new Mf(qPe,s.shape,r.shape),t.runWebGLProgram(o,[s,r],s.dtype)}const XPe={kernelName:K2,backendName:"webgl",kernelFunc:KPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZPe(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,i=t.readSync(s.dataId),a=t.readSync(r.dataId),o=Rt(Array.from(i),Array.from(a));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const YPe={kernelName:QW,backendName:"webgl",kernelFunc:ZPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QPe="return float(a != b);",r7=Cr({opSnippet:QPe,cpuKernelImpl:TLe,dtype:"bool"}),JPe={kernelName:Yw,backendName:"webgl",kernelFunc:r7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return aa({inputs:{x:r.complexTensorInfos.real},backend:t})}const eMe={kernelName:b$,backendName:"webgl",kernelFunc:u_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tMe="return float(int(x));";function nMe(n,e){const t=new kl(n.shape,tMe),s=e.runWebGLProgram(t,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mC(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return aa({inputs:{x:r},backend:t});const a=or(r.shape),o=mC({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),l=cd({inputs:{real:o,imag:a},backend:t});return a.dispose(),t.disposeIntermediateTensorInfo(o),l}if(r.dtype==="complex64"){const a=u_({inputs:{input:r},backend:t}),o=mC({inputs:{x:a},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(a),o}if(!qW(r.dtype,i)){const a=aa({inputs:{x:r},backend:t});return{dataId:a.dataId,shape:a.shape,dtype:i}}if(t.shouldExecuteOnCPU([r])){const a=t.texData.get(r.dataId).values,[o,l,c]=sLe(a,r.shape,r.dtype,i);return t.makeTensorInfo(o,l,c)}if(i==="int32")return nMe(r,t);if(i==="bool"){const a=t.makeTensorInfo([],"bool",Br("bool",1)),l=r7({inputs:{a:r,b:a},backend:t});return t.disposeIntermediateTensorInfo(a),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const sMe={kernelName:nb,backendName:"webgl",kernelFunc:mC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iF="return ceil(x);",rMe=cn({opSnippet:iF,packedOpSnippet:iF,cpuKernelImpl:rLe}),iMe={kernelName:sb,backendName:"webgl",kernelFunc:rMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aMe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oMe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lMe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{clipValueMin:i,clipValueMax:a}=s;let o;De().getBool("WEBGL_PACK_CLIP")?o=new oMe(r.shape):o=new aMe(r.shape);const l=[[i],[a]];return t.runWebGLProgram(o,[r],r.dtype,l)}const cMe={kernelName:rb,backendName:"webgl",kernelFunc:lMe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uMe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aF(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function hMe(n){const{inputs:e,backend:t}=n,{x:s}=e,r=t.texData.get(s.dataId),i=new uMe(s.shape),a=[aF(s,r.complexTensorInfos.real),aF(s,r.complexTensorInfos.imag)];return t.runWebGLProgram(i,a,a[0].dtype)}const dMe={kernelName:Sw,backendName:"webgl",kernelFunc:hMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fMe{constructor(e){this.outputShape=[],this.outputShape=Bl(e,1),this.variableNames=e.map((a,o)=>`T${o}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let a=1;a<t.length;a++)t[a]=t[a-1]+e[a][1];const s=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<t.length;a++){const o=t[a-1];s.push(`else if (yC < ${t[a]}) setOutput(getT${a}(yR, yC-${o}));`)}const r=t.length,i=t[t.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pMe{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Bl(e,t);const s=this.outputShape,r=s.length,i=$n(r),a=ci("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((w,T)=>`T${T}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let w=1;w<l.length;w++)l[w]=l[w-1]+e[w][t];const c=o[t],h=o.slice(-2),p=o.join();let m=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${p}), vec2(${h.join()}));
        }`;for(let w=1;w<l.length;w++){const T=l[w-1];m+=`
        if (${c} < ${l[w]}  && ${c} >= ${l[w-1]}) {
          return getChannel(
            getT${w}(${Fx(o,c,T)}),
            vec2(${Fx(h,c,T)}));
        }`}const v=l.length,x=l[l.length-1];m+=`
        return getChannel(
          getT${v}(${Fx(o,c,x)}),
          vec2(${Fx(h,c,x)}));`,this.userCode=`
      float getValue(${o.map(w=>"int "+w)}) {
        ${m}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[r-1]} = ${a[r-1]} + 1;
        if (${a[r-1]} < ${s[r-1]}) {
          result.g = getValue(${a});
        }

        ${a[r-2]} = ${a[r-2]} + 1;
        if (${a[r-2]} < ${s[r-2]}) {
          result.a = getValue(${a});
        }

        ${a[r-1]} = ${a[r-1]} - 1;
        if (${a[r-2]} < ${s[r-2]} &&
            ${a[r-1]} < ${s[r-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function Fx(n,e,t){const s=n.indexOf(e);return n.map((i,a)=>a===s?`${i} - ${t}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HT(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return aa({inputs:{x:r.complexTensorInfos.imag},backend:t})}const mMe={kernelName:h$,backendName:"webgl",kernelFunc:HT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ey(n,e,t){const s=n[0].dtype;if(s==="complex64"){const v=n.map(C=>u_({inputs:{input:C},backend:t})),x=n.map(C=>HT({inputs:{input:C},backend:t})),w=Ey(v,e,t),T=Ey(x,e,t),E=cd({inputs:{real:w,imag:T},backend:t});return v.forEach(C=>t.disposeIntermediateTensorInfo(C)),x.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(T),E}let r=t.shouldExecuteOnCPU(n);if(s==="string"&&(r=!0),r){const v=n.map(R=>{const U=[-1,Me(R.shape.slice(e))];return Ze({inputs:{x:R},backend:t,attrs:{shape:U}})}),x=v.map(R=>({vals:t.readSync(R.dataId),shape:R.shape})),w=Bl(v.map(R=>R.shape),1),T=v[0].shape[0]===1,E=iLe(x,w,s,T),C=Bl(n.map(R=>R.shape),e),$=t.makeTensorInfo(C,s,E);return v.forEach(R=>t.disposeIntermediateTensorInfo(R)),$}const i=n.filter(v=>Me(v.shape)>0),a=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const v=a?new kl(n[0].shape,sh):new gh(n[0].shape,sh);return t.runWebGLProgram(v,n,s)}const o=De().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>o){const v=[];for(let w=0;w<i.length;w+=o){const T=i.slice(w,w+o);v.push(Ey(T,e,t))}const x=Ey(v,e,t);for(const w of v)t.disposeIntermediateTensorInfo(w);return x}if(a){const v=new pMe(i.map(x=>x.shape),e);return t.runWebGLProgram(v,i,s)}const{tensors2D:l,outShape:c}=gMe(i,e,t),h=new fMe(l.map(v=>v.shape)),p=t.runWebGLProgram(h,l,s);l.forEach(v=>t.disposeIntermediateTensorInfo(v));const m=Ze({inputs:{x:p},attrs:{shape:c},backend:t});return t.disposeIntermediateTensorInfo(p),m}function gMe(n,e,t){const s=Bl(n.map(i=>i.shape),e);return{tensors2D:n.map(i=>Ze({inputs:{x:i},attrs:{shape:[-1,Me(i.shape.slice(e))]},backend:t})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,i=Vt(r,e[0].shape)[0],a=e.map(c=>c.shape);dA(a,i);const o=Bl(e.map(c=>c.shape),i);if(Me(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(c=>Me(c.shape)>0);return l.length===1?aa({inputs:{x:l[0]},backend:t}):Ey(l,i,t)}const yMe={kernelName:Ew,backendName:"webgl",kernelFunc:i7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a7{constructor(e,t=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const a=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,h=e.dilationHeight,p=e.dilationWidth,m=e.filterHeight,v=e.filterWidth,x=Math.floor(e.inChannels/4)*4,w=e.inChannels%4,T=e.dataFormat==="channelsLast",E=T?1:2,C=T?2:3,$=T?3:1;let R="",P="";s&&(r?R=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?R=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:R=`
          float activation(float x) {
            ${s}
          }
        `,P="result = activation(result);");const U=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${R}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${$}];

        ivec2 xRCCorner =
            ivec2(coords[${E}], coords[${C}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${m}; wR++) {
          int xR = xRCorner + wR * ${h};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${v}; wC++) {
            int xC = xCCorner + wC * ${p};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${x}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${T}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${w===1}) {

              if (${T}) {
                dotProd +=
                    getX(batch, xR, xC, ${x}) *
                    getW(wR, wC, ${x}, d2);
              } else {
                dotProd +=
                    getX(batch, ${x}, xR, xC) *
                    getW(wR, wC, ${x}, d2);
              }

            } else if (${w===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${x}, d2),
                getW(wR, wC, ${x} + 1, d2)
              );

              if (${T}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${x}),
                  getX(batch, xR, xC, ${x} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${x}, xR, xC),
                  getX(batch, ${x} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${w===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${x}, d2),
                getW(wR, wC, ${x} + 1, d2),
                getW(wR, wC, ${x} + 2, d2)
              );

              if (${T}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${x}),
                  getX(batch, xR, xC, ${x} + 1),
                  getX(batch, xR, xC, ${x} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${x}, xR, xC),
                  getX(batch, ${x} + 1, xR, xC),
                  getX(batch, ${x} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${U}
        ${P}
        setOutput(result);
      }
    `}}class vMe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,h=e.dilationWidth,p=e.filterDepth,m=e.filterHeight,v=e.filterWidth,x=Math.floor(e.inChannels/4)*4,w=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${a}, ${o});
      const ivec3 pads = ivec3(${t}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${p}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${v}; wC++) {
              int xC = xCCorner + wC * ${h};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${x}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${w===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${x}) *
                  getW(wF, wR, wC, ${x}, d2);
              } else if (${w===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${x}),
                  getX(batch, xF, xR, xC, ${x} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${x}, d2),
                  getW(wF, wR, wC, ${x} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${w===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${x}),
                  getX(batch, xF, xR, xC, ${x} + 1),
                  getX(batch, xF, xR, xC, ${x} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${x}, d2),
                  getW(wF, wR, wC, ${x} + 1, d2),
                  getW(wF, wR, wC, ${x} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o7{constructor(e,t=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Hr(this.outputShape.length);const a=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,h=e.filterWidth,p=h;let m=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let T=0;T<h;T++)m+=`
           vec4 xTexelC${T*2};
           int xTexelC${T*2}Ready;
           vec4 xTexelC${T*2+1};
           int xTexelC${T*2+1}Ready;
           vec4 xC${T};`;m+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let T=0;T<h;T++)m+=`
           xTexelC${T*2} = vec4(0.0);
           xTexelC${T*2}Ready = 0;
           xTexelC${T*2+1} = vec4(0.0);
           xTexelC${T*2+1}Ready = 0;
           xC${T} = vec4(0.0);`;m+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let T=0;T<(p+1)/2;T++){const E=T*2;if(m+=`
           xC = xCCorner + ${E*l};
           `,o===1){if(E<h&&(a%2===1?(m+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E}Ready == 0) {
                   xTexelC${E} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${E}.zw = vec2(0.0);
                   }
                   xTexelC${E}Ready = 1;
                 }
               `,l===1&&E>0?m+=`
                 xC${E} = vec4(xTexelC${E-2}.zw, xTexelC${E}.xy);
                 `:m+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${E} = vec4(previous.zw, xTexelC${E}.xy);
                   } else {
                     xC${E} = vec4(0.0, 0.0, xTexelC${E}.xy);
                   }
                   `):m+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${E}Ready == 0) {
                   xTexelC${E} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${E}.zw = vec2(0.0);
                   }
                   xTexelC${E}Ready = 1;
                 }

                 xC${E} = xTexelC${E};
                 `,E+1<h)){const C=a%2===0?M2(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(m+=`
                   xCOffset = xC + imod(pads[1], 2) + ${C};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E+1}Ready == 0) {
                     xTexelC${E+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${E+1}.zw = vec2(0.0);
                     }
                     xTexelC${E+1}Ready = 1;
                   }
                   `,l>1?m+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${E+1} = vec4(previous.zw, xTexelC${E+1}.xy);
                     } else {
                      xC${E+1} = vec4(0.0, 0.0, xTexelC${E+1}.xy);
                     }
                     `:m+=`
                     xC${E+1} = vec4(xTexelC${E}.zw, xTexelC${E+1}.xy);
                     `):C===1?m+=`
                     xC${E+1} = xTexelC${E};
                     `:m+=`
                     xCOffset = xC + ${C};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E+1}Ready == 0) {
                       xTexelC${E+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${E+1}.zw = vec2(0.0);
                       }
                       xTexelC${E+1}Ready = 1;
                     }

                     xC${E+1} = xTexelC${E+1};
                     `}}else E<h&&(a%2===1?(m+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E}Ready == 0) {
                   xTexelC${E} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${E}.zw = vec2(0.0);
                   }
                   xTexelC${E}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${E+1}Ready == 0) {
                   xTexelC${E+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${E+1}.zw = vec2(0.0);
                   }
                   xTexelC${E+1}Ready = 1;
                 }

                 xC${E} = vec4(xTexelC${E}.zw, xTexelC${E+1}.zw);
               `,E+1<h&&(m+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${E+1} = vec4(xTexelC${E+1}.xy, final.xy);
                 `)):(m+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${E}Ready == 0) {
                   xTexelC${E} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${E}.zw = vec2(0.0);
                   }
                   xTexelC${E}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E+1}Ready == 0) {
                   xTexelC${E+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${E+1}.zw = vec2(0.);
                   }
                   xTexelC${E+1}Ready = 1;
                 }

                 xC${E} = vec4(
                   xTexelC${E}.xy, xTexelC${E+1}.xy);
               `,E+1<h&&(m+=`
                   xC${E+1} = vec4(xTexelC${E}.zw, xTexelC${E+1}.zw);
                 `)));E<h&&(m+=`
             wTexel = getW(r, ${E}, d1, d2);
             dotProd += xC${E}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${E}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,E+1<h&&(m+=`
               wTexel = getW(r, ${E+1}, d1, d2);
               dotProd += xC${E+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${E+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}m+=`
     }
   `,m+=`
     }
   `,m+=`
     }
   `;let v="",x="";s&&(r?v=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?v=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:v=`vec4 activation(vec4 x) {
           ${s}
         }`,x="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${v}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${m}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${w}
         ${x}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bMe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Hr(this.outputShape.length);const{dataFormat:s}=t,r=pi(),i=s==="channelsLast",a=i?1:2,o=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let h=0;h<=1;h++)for(let p=0;p<=1;p++)c+=`
          blockIndex = rc.z + ${p};
          pos = rc.y + ${h};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${h*2+p}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${h*2+p}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function l7({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:o=null}){const l=n.shape,c=s.texData.get(n.dataId),h=t.inChannels,p=l[0]*l[1]*l[2],m=t.outChannels,v=t.dataFormat==="channelsLast",x=!1,w=!1;let T;const E=[];if(i!=null){const R=w1(i.shape,v);R!=null&&(i=Ze({inputs:{x:i},backend:s,attrs:{shape:R}}),E.push(i))}if(r!=null){const R=w1(r.shape,v);R!=null&&(r=Ze({inputs:{x:r},backend:s,attrs:{shape:R}}),E.push(r))}if(!((p===1||m===1)&&h>e7)&&c.isPacked&&v&&c.texture!=null&&l[2]%2!==0&&xn(c.shape.slice(-3),l.slice(-3))){const R=l[0]*l[1]*(l[2]+1),P={dataId:n.dataId,shape:[1,R,t.inChannels],dtype:n.dtype},U=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,J(_1(c.shape,P.shape),()=>`packed reshape ${c.shape} to ${P.shape} isn't free`);const j=Ze({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}});E.push(j);const O=x1({a:P,b:j,backend:s,transposeA:x,transposeB:w,bias:r,activation:o,preluActivationWeights:i,leakyreluAlpha:a}),M=s.texData.get(O.dataId);J(M.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=U,M.shape=t.outShape,T=aa({inputs:{x:O},backend:s}),T.shape=t.outShape,E.push(O)}else{const R=t.outHeight*t.outWidth,P=Ze({inputs:{x:n},backend:s,attrs:{shape:v?[t.batchSize,R,t.inChannels]:[t.batchSize,t.inChannels,R]}}),U=Ze({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}}),j=x1({a:v?P:U,b:v?U:P,transposeA:!v,transposeB:w,backend:s,bias:r,activation:o,preluActivationWeights:i,leakyreluAlpha:a});T=Ze({inputs:{x:j},backend:s,attrs:{shape:t.outShape}}),E.push(P),E.push(U),E.push(j)}for(const R of E)s.disposeIntermediateTensorInfo(R);return T}function c7({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:o=null}){const{filterWidth:l,filterHeight:c,inChannels:h,outWidth:p,outHeight:m,dataFormat:v}=t,x=v==="channelsLast",w=l*c*h,T=m*p,E=[t.batchSize,w,T],C=!0,$=!1,R=[];if(i!=null){const ne=w1(i.shape,x);ne!=null&&(i=Ze({inputs:{x:i},backend:s,attrs:{shape:ne}}),R.push(i))}if(r!=null){const ne=w1(r.shape,x);ne!=null&&(r=Ze({inputs:{x:r},backend:s,attrs:{shape:ne}}),R.push(r))}const P=Ze({inputs:{x:e},backend:s,attrs:{shape:[1,w,Me(e.shape)/w]}});R.push(P);const U=new bMe(E,t),j=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],O=s.runWebGLProgram(U,[n],"float32",j),M=Ze({inputs:{x:O},backend:s,attrs:{shape:E}});R.push(O),R.push(M);const B=r!=null,D=i!=null,W=o==="leakyrelu",H=o?pv(o,!0):null,ae=new JK(x?M.shape:P.shape,x?P.shape:M.shape,x?[t.batchSize,T,t.outChannels]:[t.batchSize,t.outChannels,T],C,$,B,H,D,W),te=x?[M,P]:[P,M];if(r&&te.push(r),D&&te.push(i),W){const ne=s.makeTensorInfo([],"float32",td(a,"float32"));te.push(ne),R.push(ne)}const Z=s.runWebGLProgram(ae,te,"float32"),re=Ze({inputs:{x:Z},backend:s,attrs:{shape:t.outShape}});R.push(Z);for(const ne of R)s.disposeIntermediateTensorInfo(ne);return re}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Me(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dataFormat:l,dilations:c,dimRoundingMode:h}=s,p=cu(l),m=Nr(r.shape,i.shape,a,c,o,h,!1,p);let v;if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))v=l7({x:r,filter:i,convInfo:m,backend:t});else if(m.strideWidth<=2&&p==="channelsLast"&&De().getBool("WEBGL_EXP_CONV")){const w=new o7(m),T=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]];v=t.runWebGLProgram(w,[r,i],"float32",T)}else if(De().getBool("WEBGL_CONV_IM2COL"))v=c7({x:r,filter:i,convInfo:m,backend:t});else{const w=new a7(m);v=t.runWebGLProgram(w,[r,i],"float32")}const x=Ze({inputs:{x:v},backend:t,attrs:{shape:m.outShape}});return t.disposeIntermediateTensorInfo(v),x}const xMe={kernelName:Nw,backendName:"webgl",kernelFunc:_Me};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wMe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class TMe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,l=s-1-e.padInfo.left,c=a?1:2,h=a?2:3,p=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${p}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${h}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class SMe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class EMe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.front,c=s-1-e.padInfo.top,h=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NMe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:h}=s,p=cu(l),m=Nr(r.shape,h,a,1,o,c,!1,p),v=new wMe(m);return t.runWebGLProgram(v,[r,i],"float32")}const IMe={kernelName:Z2,backendName:"webgl",kernelFunc:NMe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CMe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Hr(this.outputShape.length);const t=e.filterHeight,s=e.filterWidth,r=t-1-e.padInfo.top,i=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kMe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{inputShape:a,strides:o,pad:l,dataFormat:c,dimRoundingMode:h}=s,p=cu(c),m=Nr(a,i.shape,o,1,l,h,!1,p);if(De().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&p==="channelsLast"){const v=[[m.strideHeight,m.strideWidth]],x=new CMe(m);return t.runWebGLProgram(x,[r,i],"float32",v)}else{const v=new TMe(m);return t.runWebGLProgram(v,[r,i],"float32")}}const $Me={kernelName:Iw,backendName:"webgl",kernelFunc:kMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AMe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l}=s,c=nd(r.shape,i.shape,a,l,o),h=new vMe(c);return t.runWebGLProgram(h,[r,i],"float32")}const RMe={kernelName:Cw,backendName:"webgl",kernelFunc:AMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DMe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,pad:o,filterShape:l}=s,c=nd(r.shape,l,a,1,o),h=new SMe(c);return t.runWebGLProgram(h,[r,i],"float32")}const LMe={kernelName:Y2,backendName:"webgl",kernelFunc:DMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OMe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{pad:a,strides:o,inputShape:l}=s,c=nd(l,i.shape,o,1,a),h=new EMe(c);return t.runWebGLProgram(h,[r,i],"float32")}const PMe={kernelName:Q2,backendName:"webgl",kernelFunc:OMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MMe=dg+`
  return cos(x);
`,FMe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Yf}
  return result;
`,jMe=cn({opSnippet:MMe,packedOpSnippet:FMe}),BMe={kernelName:ib,backendName:"webgl",kernelFunc:jMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zMe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,VMe=cn({opSnippet:zMe}),UMe={kernelName:ab,backendName:"webgl",kernelFunc:VMe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GMe{constructor(e,t,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,l,c]=e,[h]=t,[p,m]=s;this.outputShape=[h,p,m,c];const v=r==="bilinear"?1:0,[x,w]=[`${o-1}.0`,`${l-1}.0`],[T,E,C]=p>1?[`${(o-1)/(p-1)}`,"(y2-y1) * height_ratio",`y1*${x} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${x}`],[$,R,P]=m>1?[`${(l-1)/(m-1)}`,"(x2-x1) * width_ratio",`x1*${w} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${w}`];this.userCode=`
      const float height_ratio = float(${T});
      const float width_ratio = float(${$});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${E};
        float width_scale = ${R};

        float in_y = ${C};
        if( in_y < 0.0 || in_y > ${x} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${P};
        if( in_x < 0.0 || in_x > ${w} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${v} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WMe=n=>{const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:i,boxInd:a}=e,{cropSize:o,method:l,extrapolationValue:c}=s,h=new GMe(r.shape,i.shape,o,l,c);return t.runWebGLProgram(h,[r,i,a],"float32")},HMe={kernelName:e$,backendName:"webgl",kernelFunc:WMe};var gv;(function(n){n.Prod="*",n.Sum="+"})(gv||(gv={}));class oF{constructor(e,t,s,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,a=this.op===gv.Prod?"1.0":"0.0",o=s?a:`getX(${lF(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",h="";s?(c=r?`end != ${l-1}`:"end != 0",h=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",h=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${$n(i)} coords = getOutputCoords();
        int end = ${cF(i,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${h};
          ${cF(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${lF(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function lF(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function cF(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(n,e,t,s,r,i){const a=e.shape.length,o=us([s],a);let l=e;o!=null&&(l=di({inputs:{x:e},backend:t,attrs:{perm:o}}));const c=Is(1,a)[0];if(c!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const h=l.shape[c];let p=aa({inputs:{x:l},backend:t});for(let m=0;m<=Math.ceil(Math.log2(h))-1;m++){const v=new oF(n,l.shape,!1,i),x=[[m]],w=p;p=t.runWebGLProgram(v,[p],p.dtype,x),t.disposeIntermediateTensorInfo(w)}if(r){const m=new oF(n,l.shape,r,i),v=p;p=t.runWebGLProgram(m,[p],p.dtype),t.disposeIntermediateTensorInfo(v)}if(o!=null){const m=sd(o),v=di({inputs:{x:p},backend:t,attrs:{perm:m}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(l),v}return p}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qMe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,exclusive:a,reverse:o}=s;return u7(gv.Prod,r,t,i,a,o)}const KMe={kernelName:J2,backendName:"webgl",kernelFunc:qMe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XMe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,exclusive:a,reverse:o}=s;return u7(gv.Sum,r,t,i,a,o)}const ZMe={kernelName:kw,backendName:"webgl",kernelFunc:XMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YMe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:i}=e,{size:a,binaryOutput:o}=s;if(r.shape.length===1){const l=t.readSync(r.dataId),c=t.readSync(i.dataId),h=GK(l,c,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,h)}else if(r.shape.length===2){const l=t.bufferSync(r),c=t.bufferSync(i),h=tLe(l,c,a,o);return t.makeTensorInfo(h.shape,i.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const QMe={kernelName:t$,backendName:"webgl",kernelFunc:YMe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JMe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:i,dataFormat:a}=s,o=r.shape[0],l=a==="NHWC"?r.shape[1]:r.shape[2],c=a==="NHWC"?r.shape[2]:r.shape[3],h=a==="NHWC"?r.shape[3]:r.shape[1],p=l*i,m=c*i,v=h/(i*i),x=a==="NHWC"?[o,p,m,v]:[o,v,p,m],w=new JMe(x,i,a);return t.runWebGLProgram(w,[r],r.dtype)}const t3e={kernelName:n$,backendName:"webgl",kernelFunc:e3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h7{constructor(e,t=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Hr(this.outputShape.length);const a=e.filterHeight,o=e.filterWidth,l=e.outChannels/e.inChannels;let c="",h="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,h="result = activation(result);");const p=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${p}
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d7{constructor(e,t=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Hr(this.outputShape.length);const a=e.outChannels/e.inChannels,o=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,m=p;let v=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let E=0;E<p;E++)v+=`
          vec4 xTexelC${E*2};
          int xTexelC${E*2}Ready;
          vec4 xTexelC${E*2+1};
          int xTexelC${E*2+1}Ready;
          vec4 xC${E};`;v+=`
    for (int r = 0; r < ${h}; r++) {
      `;for(let E=0;E<p;E++)v+=`
          xTexelC${E*2} = vec4(0.0);
          xTexelC${E*2}Ready = 0;
          xTexelC${E*2+1} = vec4(0.0);
          xTexelC${E*2+1}Ready = 0;
          xC${E} = vec4(0.0);`;v+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let E=0;E<(m+1)/2;E++){const C=E*2;if(v+=`
          xC = xCCorner + ${C*c};
          `,l===1){if(C<p&&(o%2===1?(v+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }
              `,c===1&&C>0?v+=`
                xC${C} = vec4(xTexelC${C-2}.zw, xTexelC${C}.xy);
                `:v+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${C} = vec4(previous.zw, xTexelC${C}.xy);
                  } else {
                    xC${C} = vec4(0.0, 0.0, xTexelC${C}.xy);
                  }
                  `):v+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xC${C} = xTexelC${C};
                `,C+1<p)){const $=o%2===0?M2(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(v+=`
                  xCOffset = xC + imod(pads[1], 2) + ${$};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                    xTexelC${C+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${C+1}.zw = vec2(0.0);
                    }
                    xTexelC${C+1}Ready = 1;
                  }
                  `,c>1?v+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${C+1} = vec4(previous.zw, xTexelC${C+1}.xy);
                    } else {
                     xC${C+1} = vec4(0.0, 0.0, xTexelC${C+1}.xy);
                    }
                    `:v+=`
                    xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.xy);
                    `):$===1?v+=`
                    xC${C+1} = xTexelC${C};
                    `:v+=`
                    xCOffset = xC + ${$};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                      xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${C+1}.zw = vec2(0.0);
                      }
                      xTexelC${C+1}Ready = 1;
                    }

                    xC${C+1} = xTexelC${C+1};
                    `}}else C<p&&(o%2===1?(v+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.0);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
              `,C+1<p&&(v+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${C+1} = vec4(xTexelC${C+1}.xy, final.xy);
                `)):(v+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(
                  xTexelC${C}.xy, xTexelC${C+1}.xy);
              `,C+1<p&&(v+=`
                  xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
                `)));C<p&&(v+=`
            wTexel = getW(r, ${C}, d1, q);
            dotProd += xC${C} * vec4(wTexel.xz, wTexel.xz);
          `,C+1<p&&(v+=`
              wTexel = getW(r, ${C+1}, d1, q);
              dotProd += xC${C+1} * vec4(wTexel.xz, wTexel.xz);
            `))}v+=`
    }
  `,v+=`
      }
    `;let x="",w="";s&&(r?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:x=`vec4 activation(vec4 x) {
          ${s}
        }`,w="result = activation(result);");const T=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${x}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${v}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${T}
        ${w}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n3e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l,dimRoundingMode:c}=s;let h=l;h==null&&(h=[1,1]),J(Gr(a,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${h}'`);const p=Nr(r.shape,i.shape,a,h,o,c,!0);let m;De().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?m=new d7(p):m=new h7(p);const v=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return t.runWebGLProgram(m,[r,i],"float32",v)}const s3e={kernelName:$w,backendName:"webgl",kernelFunc:n3e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r3e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class i3e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,filterShape:h}=s,p=Nr(r.shape,h,a,o,l,c,!0),m=new r3e(p);return t.runWebGLProgram(m,[r,i],"float32")}const o3e={kernelName:s$,backendName:"webgl",kernelFunc:a3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3e(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,inputShape:h}=s,p=Nr(h,i.shape,a,o,l,c,!0),m=new i3e(p);return t.runWebGLProgram(m,[r,i],"float32")}const c3e={kernelName:r$,backendName:"webgl",kernelFunc:l3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u3e{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3e(n){const{inputs:e,backend:t}=n,{x:s}=e,r=[...s.shape,...s.shape],i=Me(s.shape),a=Ze({inputs:{x:s},backend:t,attrs:{shape:[i]}}),o=new u3e(i),l=t.runWebGLProgram(o,[a],a.dtype),c=Ze({inputs:{x:l},backend:t,attrs:{shape:r}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),c}const d3e={kernelName:JW,backendName:"webgl",kernelFunc:h3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f3e{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:s,padInfo:r,strideHeight:i,strideWidth:a,filterHeight:o,filterWidth:l,dilationHeight:c,dilationWidth:h}=e,{top:p,left:m}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${a});
      const ivec2 pads = ivec2(${p}, ${m});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${h};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l}=s,c=Gb(r.shape,i.shape,a,o,"NHWC",l);let h;const p=new f3e(c);h=t.runWebGLProgram(p,[r,i],"float32");const m=Ze({inputs:{x:h},backend:t,attrs:{shape:c.outShape}});return t.disposeIntermediateTensorInfo(h),m}const m3e={kernelName:Aw,backendName:"webgl",kernelFunc:p3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g3e(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,i=e,{allDims:a,summedDims:o,idDims:l}=SA(r,i.length);NA(a.length,l,i);const{path:c,steps:h}=IA(o,l),p=h.length;let m=null,v=a.length;const x=[];for(let w=0;w<p;++w){for(const T of h[w]){const{permutationIndices:E,expandDims:C}=EA(v,l[T]);let $;CA(E)?$=i[T]:($=di({inputs:{x:i[T]},backend:t,attrs:{perm:E}}),x.push($));const R=$.shape.slice();for(let P=0;P<C.length;++P)R.splice(C[P],0,1);xn($.shape,R)||($=Ze({inputs:{x:$},backend:t,attrs:{shape:R}}),x.push($)),m===null?m=$:(m=pR({inputs:{a:$,b:m},backend:t}),x.push(m))}w<p-1&&(c[w]>=0&&(m=WT({inputs:{x:m},backend:t,attrs:{axis:c[w]-(a.length-v),keepDims:!1}}),x.push(m)),v--)}for(const w of x)w!==m&&t.disposeIntermediateTensorInfo(w);return m}const y3e={kernelName:i$,backendName:"webgl",kernelFunc:g3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v3e="return (x >= 0.0) ? x : (exp(x) - 1.0);",b3e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,_3e=cn({opSnippet:v3e,packedOpSnippet:b3e}),x3e={kernelName:lb,backendName:"webgl",kernelFunc:_3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w3e="return (b >= 0.0) ? a : a * (b + 1.0);",T3e=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,S3e=n=>{const{inputs:e,backend:t}=n,{dy:s,y:r}=e,i=De().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hg(T3e,s.shape,r.shape):new Mf(w3e,s.shape,r.shape);return t.runWebGLProgram(i,[s,r],s.dtype)},E3e={kernelName:a$,backendName:"webgl",kernelFunc:S3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N3e=`
  return vec4(equal(a, b));
`,I3e="return float(a == b);",C3e=Cr({opSnippet:I3e,packedOpSnippet:N3e,dtype:"bool",cpuKernelImpl:aLe}),k3e={kernelName:Rw,backendName:"webgl",kernelFunc:C3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $3e=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${yA};
  float a1 = ${vA};
  float a2 = ${bA};
  float a3 = ${_A};
  float a4 = ${xA};
  float a5 = ${wA};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,A3e=cn({opSnippet:$3e}),R3e={kernelName:cb,backendName:"webgl",kernelFunc:A3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D3e=dg+`
  return exp(x);
`,L3e=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,f7=cn({opSnippet:D3e,packedOpSnippet:L3e,cpuKernelImpl:oLe,dtype:"float32"}),O3e={kernelName:ub,backendName:"webgl",kernelFunc:f7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gC(n){const{inputs:e,attrs:t,backend:s}=n,{dim:r}=t,{input:i}=e,a=i.shape.length,o=i.shape.slice();let l=r;return r<0&&(J(-(a+1)<=r,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+r+1),o.splice(l,0,1),Ze({inputs:{x:i},backend:s,attrs:{shape:o}})}const P3e={kernelName:Dw,backendName:"webgl",kernelFunc:gC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uF="return exp(x) - 1.0;",M3e=cn({opSnippet:uF,packedOpSnippet:uF,cpuKernelImpl:lLe}),F3e={kernelName:hb,backendName:"webgl",kernelFunc:M3e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hF{constructor(e,t,s){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=s?`${r}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p7(n,e,t){const s=t.texData.get(n.dataId),r=Me(n.shape),i=n.shape[n.shape.length-1],a=r/i,o=Ze({inputs:{x:n},backend:t,attrs:{shape:[a,i]}}),l=o.shape,c=new hF("real",l,e),h=new hF("imag",l,e),p=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],m=t.runWebGLProgram(c,p,"float32"),v=t.runWebGLProgram(h,p,"float32"),x=cd({inputs:{real:m,imag:v},backend:t});t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(v);const w=Ze({inputs:{x},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(x),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3e(n){const{inputs:e,backend:t}=n,{input:s}=e;return p7(s,!1,t)}const B3e={kernelName:o$,backendName:"webgl",kernelFunc:j3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z3e{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h_(n){const{backend:e,attrs:t}=n,{shape:s,value:r}=t;let{dtype:i}=t;if(i=i||Ym(r),i==="string"){const a=ws(i,Me(s));return a.fill(r),e.makeTensorInfo(s,i,a)}else{const a=new z3e(s,r),o=[[r]];return e.runWebGLProgram(a,[],i,o)}}const V3e={kernelName:l$,backendName:"webgl",kernelFunc:h_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U3e{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G3e={kernelName:c$,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,s=e,r=new U3e(t.shape);return s.runWebGLProgram(r,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dF="return floor(x);",W3e=cn({opSnippet:dF,packedOpSnippet:dF,cpuKernelImpl:cLe}),H3e={kernelName:db,backendName:"webgl",kernelFunc:W3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q3e=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,K3e=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,X3e=Cr({opSnippet:q3e,packedOpSnippet:K3e,dtype:"int32"}),Z3e={kernelName:fb,backendName:"webgl",kernelFunc:X3e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y3e{constructor(e){this.variableNames=["A"];const t=pi(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q3e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=pi(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J3e={kernelName:Ove,backendName:"webgl",kernelFunc:eFe};let jp,TN=De().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function eFe(n){const{inputs:e,backend:t,attrs:s}=n;let{pixels:r}=e;const{numChannels:i}=s,a=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=a?[r.videoWidth,r.videoHeight]:[r.width,r.height],h=[c,l],p=[c,l,i];if(o||a){const w=De().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(jp==null||w!==TN)&&(TN=w,jp=document.createElement("canvas").getContext("2d",{willReadFrequently:TN})),jp.canvas.width=l,jp.canvas.height=c,jp.drawImage(r,0,0,l,c),r=jp.canvas}const m=t.makeTensorInfo(h,"int32");t.texData.get(m.dataId).usage=ka.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(m.dataId),r);const v=De().getBool("WEBGL_PACK")?new Q3e(p):new Y3e(p),x=t.runWebGLProgram(v,[m],"int32");return t.disposeData(m.dataId),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tFe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:h,dilations:p,dimRoundingMode:m,activation:v,leakyreluAlpha:x}=s,w=cu(h),T=Nr(r.shape,i.shape,l,p,c,m,!1,w);let E;const C=[],$=a!=null,R=o!=null,P=v==="leakyrelu",U=()=>{const O=[r,i],M=(B,D)=>{if(D==="NCHW"&&B.shape.length===1&&B.shape[0]!==1){const W=Ze({inputs:{x:B},backend:t,attrs:{shape:[B.shape[0],1,1]}});return C.push(W),W}return B};if($&&O.push(M(a,h)),R&&O.push(M(o,h)),P){const B=t.makeTensorInfo([],"float32",td(x,"float32"));O.push(B),C.push(B)}return O};if(T.filterHeight===1&&T.filterWidth===1&&T.dilationHeight===1&&T.dilationWidth===1&&T.strideHeight===1&&T.strideWidth===1&&(T.padInfo.type==="SAME"||T.padInfo.type==="VALID"))E=l7({x:r,filter:i,convInfo:T,backend:t,bias:a,activation:v,preluActivationWeights:o,leakyreluAlpha:x});else if(T.strideWidth<=2&&w==="channelsLast"&&De().getBool("WEBGL_EXP_CONV")){const O=v?pv(v,!0):null,M=new o7(T,$,O,R,P),B=[[T.padInfo.top,T.padInfo.left],[T.strideHeight,T.strideWidth],[T.dilationHeight,T.dilationWidth],[T.inHeight,T.inWidth]],D=U();E=t.runWebGLProgram(M,D,"float32",B)}else if(De().getBool("WEBGL_CONV_IM2COL"))E=c7({x:r,filter:i,convInfo:T,backend:t,bias:a,activation:v,preluActivationWeights:o,leakyreluAlpha:x});else{const O=v?pv(v,!1):null,M=new a7(T,$,O,R,P),B=U();E=t.runWebGLProgram(M,B,"float32")}const j=Ze({inputs:{x:E},backend:t,attrs:{shape:T.outShape}});return C.push(E),C.forEach(O=>t.disposeIntermediateTensorInfo(O)),j}const nFe={kernelName:Q0,backendName:"webgl",kernelFunc:tFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sFe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dilations:h,dimRoundingMode:p,activation:m,leakyreluAlpha:v}=s,x=[];let w=h;w==null&&(w=[1,1]),J(Gr(l,w),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${w}'`);const T=Nr(r.shape,i.shape,l,w,c,p,!0),E=De().getBool("WEBGL_PACK_DEPTHWISECONV")&&T.strideWidth<=2&&T.outChannels/T.inChannels===1,C=m?pv(m,E):null,$=[r,i],R=a!=null,P=o!=null,U=m==="leakyrelu";if(R&&$.push(a),P&&$.push(o),U){const B=t.makeTensorInfo([],"float32",td(v,"float32"));$.push(B),x.push(B)}let j;E?j=new d7(T,R,C,P,U):j=new h7(T,R,C,P,U);const O=[[T.padInfo.top,T.padInfo.left],[T.strideHeight,T.strideWidth],[T.dilationHeight,T.dilationWidth],[T.inHeight,T.inWidth]],M=t.runWebGLProgram(j,$,"float32",O);return x.forEach(B=>t.disposeIntermediateTensorInfo(B)),M}const rFe={kernelName:vH,backendName:"webgl",kernelFunc:sFe};class iFe{constructor(e,t,s,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=$n(s.length);let a=`
    int index;`;for(let o=0;o<this.sliceDim;o++)a+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aFe(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,i=r.shape,a=i[i.length-1],o=Me(s.shape),[l,c,h,p]=aA(s,r),m=Ze({inputs:{x:r},backend:t,attrs:{shape:[c,a]}}),v=Ze({inputs:{x:s},backend:t,attrs:{shape:[Me(s.shape)/h,h]}});if(t.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const E=t.readSync(r.dataId),C=t.bufferSync(s),$=uLe(E,C,s.dtype,c,a,h,p,s.shape,o);return t.makeTensorInfo(l,s.dtype,$.values)}const x=new iFe(a,p,[c,h],s.shape),w=t.runWebGLProgram(x,[v,m],v.dtype),T=Ze({inputs:{x:w},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(w),T}const oFe={kernelName:eH,backendName:"webgl",kernelFunc:aFe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lFe{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const s=$n(this.rank),r=cFe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function cFe(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<n.length;r++)r===2?s.push("index"):s.push(`${t[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:i}=e,{axis:a,batchDims:o}=s,l=Vt(a,r.shape)[0];if(De().get("DEBUG")){const C=t.readSync(i.dataId),$=r.shape[l];for(let R=0;R<C.length;++R){const P=C[R];J(P<=$-1&&P>=0,()=>`GatherV2: the index value ${P} is not in [0, ${$-1}]`)}}const c=$A(r,i,l,o),h=Me(i.shape),p=[],m=Ze({inputs:{x:r},backend:t,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),v=Ze({inputs:{x:i},backend:t,attrs:{shape:[c.batchSize,h/c.batchSize]}});p.push(m),p.push(v);const x=[c.batchSize,c.outerSize,h/c.batchSize,c.sliceSize];if(t.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const C=t.bufferSync(v),$=t.bufferSync(m),R=hLe($,C,x);return p.forEach(P=>t.disposeIntermediateTensorInfo(P)),t.makeTensorInfo(c.outputShape,R.dtype,R.values)}const w=new lFe(m.shape,x),T=t.runWebGLProgram(w,[m,v],m.dtype);p.push(T);const E=Ze({inputs:{x:T},backend:t,attrs:{shape:c.outputShape}});return p.forEach(C=>t.disposeIntermediateTensorInfo(C)),E}const uFe={kernelName:Ow,backendName:"webgl",kernelFunc:m7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hFe="return float(a > b);",dFe=`
  return vec4(greaterThan(a, b));
`,fFe=Cr({opSnippet:hFe,packedOpSnippet:dFe,cpuKernelImpl:dLe,dtype:"bool"}),pFe={kernelName:Pw,backendName:"webgl",kernelFunc:fFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mFe="return float(a >= b);",gFe=`
  return vec4(greaterThanEqual(a, b));
`,yFe=Cr({opSnippet:mFe,packedOpSnippet:gFe,dtype:"bool",cpuKernelImpl:fLe}),vFe={kernelName:pb,backendName:"webgl",kernelFunc:yFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bFe(n){const{inputs:e,backend:t}=n,{input:s}=e;return p7(s,!0,t)}const _Fe={kernelName:u$,backendName:"webgl",kernelFunc:bFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xFe="return float(!isnan(x) && !isinf(x));",wFe=cn({opSnippet:xFe,dtype:"bool"}),TFe={kernelName:gb,backendName:"webgl",kernelFunc:wFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SFe="return float(isinf(x));",EFe=cn({opSnippet:SFe,dtype:"bool"}),NFe={kernelName:yb,backendName:"webgl",kernelFunc:EFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IFe="return float(isnan(x));",CFe=cn({opSnippet:IFe,dtype:"bool"}),kFe={kernelName:vb,backendName:"webgl",kernelFunc:CFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Fe="return float(a < b);",AFe=`
  return vec4(lessThan(a, b));
`,RFe=Cr({opSnippet:$Fe,packedOpSnippet:AFe,cpuKernelImpl:pLe,dtype:"bool"}),DFe={kernelName:Fw,backendName:"webgl",kernelFunc:RFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LFe="return float(a <= b);",OFe=`
  return vec4(lessThanEqual(a, b));
`,PFe=Cr({opSnippet:LFe,packedOpSnippet:OFe,cpuKernelImpl:mLe,dtype:"bool"}),MFe={kernelName:jw,backendName:"webgl",kernelFunc:PFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FFe(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:i}=t,a=gLe(s,r,i);return e.makeTensorInfo([a.length],"float32",a)}const jFe={kernelName:tH,backendName:"webgl",kernelFunc:FFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BFe=dg+`
  return x < 0.0 ? 0./0. : log(x);
`,zFe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,VFe=cn({opSnippet:BFe,packedOpSnippet:zFe,cpuKernelImpl:yLe}),UFe={kernelName:bb,backendName:"webgl",kernelFunc:VFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GFe=dg+`
  return log(1.0 + x);
`,WFe=cn({opSnippet:GFe}),HFe={kernelName:_b,backendName:"webgl",kernelFunc:WFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qFe="return float(a >= 1.0 && b >= 1.0);",KFe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,XFe=Cr({opSnippet:qFe,packedOpSnippet:KFe,dtype:"bool"}),ZFe={kernelName:Bw,backendName:"webgl",kernelFunc:XFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YFe="return float(!(x >= 1.0));",QFe=cn({opSnippet:YFe}),JFe={kernelName:zw,backendName:"webgl",kernelFunc:QFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eje="return float(a >= 1.0 || b >= 1.0);",tje=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,nje=Cr({opSnippet:eje,packedOpSnippet:tje,dtype:"bool"}),sje={kernelName:Vw,backendName:"webgl",kernelFunc:nje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rje{constructor(e,t,s,r,i){this.variableNames=["x"],this.outputShape=[];const a=t,o=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ije{constructor(e,t,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=t,o=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aje=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:i,bias:a,alpha:o,beta:l}=s,c=De().getBool("WEBGL_PACK_NORMALIZATION")?new ije(r.shape,i,a,o,l):new rje(r.shape,i,a,o,l);return t.runWebGLProgram(c,[r],r.dtype)},oje={kernelName:Uw,backendName:"webgl",kernelFunc:aje};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lje{constructor(e,t,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cje=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r,y:i,dy:a}=e,{depthRadius:o,bias:l,alpha:c,beta:h}=s,p=new lje(r.shape,o,l,c,h);return t.runWebGLProgram(p,[r,i,a],r.dtype)},uje={kernelName:d$,backendName:"webgl",kernelFunc:cje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hje(n,e,t,s){const r=Me(e),a=Me(n.shape)/r,o=Ze({inputs:{x:n},attrs:{shape:[a,r]},backend:s}),l=Qf(o,n.dtype,"max",s),c=Ze({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g7(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:i,keepDims:a}=s,o=r.shape.length,l=Vt(i,r.shape);let c=l;const h=us(c,o),p=h!=null,m=t.shouldExecuteOnCPU([r]);let v=r;if(p){if(m){const $=t.texData.get(v.dataId).values,R=new Array(o);for(let j=0;j<R.length;j++)R[j]=r.shape[h[j]];const P=dR($,r.shape,r.dtype,h,R);v=t.makeTensorInfo(R,r.dtype);const U=t.texData.get(v.dataId);U.values=P}else v=GT(r,h,t);c=Is(c.length,o)}Ir("max",c,o);const[x,w]=ur(v.shape,c);let T=x;a&&(T=js(x,l));let E;if(m){const $=t.texData.get(v.dataId).values,R=vLe($,Me(w),T,r.dtype);E=t.makeTensorInfo(T,r.dtype);const P=t.texData.get(E.dataId);P.values=R}else E=hje(v,w,T,t);return p&&t.disposeIntermediateTensorInfo(v),E}const dje={kernelName:Gw,backendName:"webgl",kernelFunc:g7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fje=fR+`
  return max(a, b);
`,pje=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Yf+`
  return result;
`,mje=Cr({opSnippet:fje,packedOpSnippet:pje,cpuKernelImpl:bLe}),gje={kernelName:xb,backendName:"webgl",kernelFunc:mje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yje(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;l_(r,"maxPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=s,c=1;J(Gr(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const h=ho(r.shape,i,a,c,o,l);if(h.filterWidth===1&&h.filterHeight===1&&xn(h.inShape,h.outShape))return aa({inputs:{x:r},backend:t});const p=new mv(h,"max",!1);return t.runWebGLProgram(p,[r],r.dtype)}const vje={kernelName:Ww,backendName:"webgl",kernelFunc:yje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bje(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:i,strides:a,pad:o,dataFormat:l,dimRoundingMode:c}=s,h=[1,1,1],p=lu(r.shape,i,a,h,o,c,l),m=new mR(p,"max",!1);return t.runWebGLProgram(m,[r],r.dtype)}const _je={kernelName:Hw,backendName:"webgl",kernelFunc:bje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xje{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,l=a-1-e.padInfo.left,c=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class wje{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=l-1-e.padInfo.front,m=c-1-e.padInfo.top,v=h-1-e.padInfo.left,x=l*c*h-1;this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${v});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${x} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${h} +
                  wR * ${h} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tje(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,a=i,{filterSize:o,strides:l,pad:c,dimRoundingMode:h}=s,p=[1,1,1],m=lu(a.shape,o,l,p,c,h),v=new mR(m,"max",!0),x=t.runWebGLProgram(v,[a],a.dtype),w=new wje(m),T=t.runWebGLProgram(w,[r,x],a.dtype);return t.disposeIntermediateTensorInfo(x),T}const Sje={kernelName:p$,backendName:"webgl",kernelFunc:Tje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eje(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i,output:a}=e,o=i;l_([i,a],"maxPoolGrad");const{filterSize:l,strides:c,pad:h,dimRoundingMode:p}=s,m=ho(o.shape,l,c,1,h,p),v=!0,x=new mv(m,"max",v),w=t.runWebGLProgram(x,[o],o.dtype),T=new xje(m),E=t.runWebGLProgram(T,[r,w],o.dtype);return t.disposeIntermediateTensorInfo(w),E}const Nje={kernelName:f$,backendName:"webgl",kernelFunc:Eje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ije(n,e,t,s){let r=new mv(t,"max",!1);const i=s.runWebGLProgram(r,[n],"float32");r=new mv(t,"max",!0,!0,e);const a=s.runWebGLProgram(r,[n],"float32");return[i,a]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cje={kernelName:nH,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:i,pad:a,includeBatchInIndex:o}=e,l=t;J(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];J(Gr(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const h=ho(s.shape,r,i,c,a),[p,m]=Ije(s,o,h,l);return[p,m]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kje(n,e,t,s){const r=Me(e),a=Me(n.shape)/r,o=Ze({inputs:{x:n},attrs:{shape:[a,r]},backend:s}),l=Qf(o,"float32","mean",s),c=Ze({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $je={kernelName:qw,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{keepDims:r,axis:i}=e,a=t,o=s.shape.length,l=Vt(i,s.shape);let c=l;const h=us(c,o),p=h!=null,m=a.shouldExecuteOnCPU([s]),v=[];let x=s;if(p){if(m){const R=a.texData.get(x.dataId).values,P=new Array(o);for(let O=0;O<P.length;O++)P[O]=s.shape[h[O]];const U=dR(R,s.shape,s.dtype,h,P);x=a.makeTensorInfo(P,s.dtype);const j=a.texData.get(x.dataId);j.values=U}else x=GT(s,h,a);v.push(x),c=Is(c.length,o)}Ir("sum",c,o);const[w,T]=ur(x.shape,c);let E=w;r&&(E=js(w,l));const C=kje(x,T,E,a);for(const $ of v)a.disposeIntermediateTensorInfo($);return C}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aje(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=r.shape.length,l=Vt(i,r.shape);let c=l;const h=us(c,o);let p=r;h!=null&&(p=di({inputs:{x:r},backend:t,attrs:{perm:h}}),c=Is(c.length,r.shape.length)),Ir("min",c,o);const[m,v]=ur(p.shape,c),x=Me(v),w=Ze({inputs:{x:p},backend:t,attrs:{shape:[-1,x]}}),T=Qf(w,w.dtype,"min",t);let E;if(a){const C=js(m,l);E=Ze({inputs:{x:T},backend:t,attrs:{shape:C}})}else E=Ze({inputs:{x:T},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(T),h!=null&&t.disposeIntermediateTensorInfo(p),E}const Rje={kernelName:Kw,backendName:"webgl",kernelFunc:Aje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dje=fR+`
  return min(a, b);
`,Lje=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Yf+`
  return result;
`,Oje=Cr({opSnippet:Dje,packedOpSnippet:Lje,cpuKernelImpl:_Le}),Pje={kernelName:wb,backendName:"webgl",kernelFunc:Oje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mje{constructor(e,t,s){this.variableNames=["x"],this.outputShape=t.map((h,p)=>h[0]+e[p]+h[1]);const r=e.length,i=$n(r),a=t.map(h=>h[0]).join(","),o=t.map((h,p)=>h[0]+e[p]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fje{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((x,w)=>x[0]+e[w]+x[1]);const r=e.length,i=$n(r),a=t.map(x=>x[0]).join(","),o=t.map((x,w)=>x[0]+e[w]).join(","),l=ci("rc",r),c=ci("source",r),h=`${l[r-1]} < ${this.outputShape[r-1]}`,p=r===1?"source":`vec2(${c.slice(-2).join()})`,m=s==="reflect"?0:1;let v="";if(r===1){const x=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${m};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${m};
        }
        source -= start;
      `;v=`
        ${i} rc = outputLoc;
        ${x}
        result[0] = getChannel(getX(${c.join()}), ${p});
        ${l[r-1]} += 1;
        if(${h}) {
          ${x}
          result[1] = getChannel(getX(${c.join()}), ${p});
        }
      `}else{const x=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${m}) +
                gte * ((end - 1) * 2 - source + ${m});
        source -= start;
      `;v=`
        ${i} rc = outputLoc;
        ${x}
        result[0] = getChannel(getX(${c.join()}), ${p});
        ${l[r-1]} += 1;
        if(${h}) {
          ${x}
          result[1] = getChannel(getX(${c.join()}), ${p});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${x}
          result[2] = getChannel(getX(${c.join()}), ${p});
          ${l[r-1]} += 1;
          if(${h}) {
            ${x}
            result[3] = getChannel(getX(${c.join()}), ${p});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jje=({inputs:n,backend:e,attrs:t})=>{const{x:s}=n,{paddings:r,mode:i}=t,a=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Fje(s.shape,r,i):new Mje(s.shape,r,i);return e.runWebGLProgram(a,[s],s.dtype)},Bje={kernelName:Xw,backendName:"webgl",kernelFunc:jje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zje=`if (b == 0.0) return NAN;
  return mod(a, b);`,Vje=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Yf+`
  return result;
`,Uje=Cr({opSnippet:zje,packedOpSnippet:Vje}),Gje={kernelName:Tb,backendName:"webgl",kernelFunc:Uje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wje{constructor(e,t,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hje=`
if (a == b) {
  return 1.0;
};
return a / b;`,qje=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,y7=Cr({opSnippet:Hje,packedOpSnippet:qje,checkOutOfBounds:!0}),Kje={kernelName:ob,backendName:"webgl",kernelFunc:y7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fF="return a - b;",v7=Cr({opSnippet:fF,packedOpSnippet:fF,supportsComplex:!0,cpuKernelImpl:zLe}),Xje={kernelName:jb,backendName:"webgl",kernelFunc:v7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:i}=s,a=Vt([i],r.shape),o=g7({inputs:{x:r},backend:t,attrs:{reductionIndices:a,keepDims:!1}}),l=js(o.shape,a),c=Ze({inputs:{x:o},backend:t,attrs:{shape:l}}),h=v7({inputs:{a:r,b:c},backend:t}),p=f7({inputs:{x:h},backend:t}),m=WT({inputs:{x:p},backend:t,attrs:{axis:a,keepDims:!1}}),v=Ze({inputs:{x:m},backend:t,attrs:{shape:l}}),x=y7({inputs:{a:p,b:v},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(v),x}const Zje={kernelName:fT,backendName:"webgl",kernelFunc:b7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yje(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:i,seed:a,normalized:o}=s,l=o?r:b7({inputs:{logits:r},backend:t,attrs:{dim:r.shape.length-1}}),c=l.shape[0],h=l.shape[1],p=new Wje(c,h,i),m=[[a]],v=t.runWebGLProgram(p,[l],"int32",m);return o||t.disposeIntermediateTensorInfo(l),v}const Qje={kernelName:sH,backendName:"webgl",kernelFunc:Yje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jje=po+`
  return -x;
`,e4e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function t4e(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])){const i=t.texData.get(s.dataId),[a,o]=wLe(i.values,s.shape,s.dtype);return t.makeTensorInfo(o,s.dtype,a)}let r;return De().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new gh(s.shape,e4e):r=new kl(s.shape,Jje),t.runWebGLProgram(r,[s],s.dtype)}const n4e={kernelName:Zw,backendName:"webgl",kernelFunc:t4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s4e=tA;function r4e(n){Na("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=s,c=t.readSync(r.dataId),h=t.readSync(i.dataId),{selectedIndices:p}=s4e(c,h,a,o,l);return t.makeTensorInfo([p.length],"int32",new Int32Array(p))}const i4e={kernelName:m$,backendName:"webgl",kernelFunc:r4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a4e=nA;function o4e(n){Na("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=s,h=t.readSync(r.dataId),p=t.readSync(i.dataId),{selectedIndices:m,validOutputs:v}=a4e(h,p,a,o,l,c);return[t.makeTensorInfo([m.length],"int32",new Int32Array(m)),t.makeTensorInfo([],"int32",new Int32Array([v]))]}const l4e={kernelName:g$,backendName:"webgl",kernelFunc:o4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c4e=sA;function u4e(n){Na("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=s,h=t.readSync(r.dataId),p=t.readSync(i.dataId),m=a,v=o,x=l,w=c,{selectedIndices:T,selectedScores:E}=c4e(h,p,m,v,x,w);return[t.makeTensorInfo([T.length],"int32",new Int32Array(T)),t.makeTensorInfo([E.length],"float32",new Float32Array(E))]}const h4e={kernelName:y$,backendName:"webgl",kernelFunc:u4e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d4e{constructor(e,t,s,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f4e=n=>{const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:i,depth:a,onValue:o,offValue:l}=s,c=Me(r.shape),h=new d4e(c,a,o,l),p=Ze({inputs:{x:r},backend:t,attrs:{shape:[c]}}),m=t.runWebGLProgram(h,[p],i);t.disposeIntermediateTensorInfo(p);const v=[...r.shape,a],x=Ze({inputs:{x:m},backend:t,attrs:{shape:v}});return t.disposeIntermediateTensorInfo(m),x},p4e={kernelName:Jw,backendName:"webgl",kernelFunc:f4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="complex64"){const r=u_({inputs:{input:s},backend:t}),i=T1({inputs:{x:r},backend:t}),a=HT({inputs:{input:s},backend:t}),o=T1({inputs:{x:a},backend:t}),l=cd({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return h_({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:t})}const m4e={kernelName:gT,backendName:"webgl",kernelFunc:T1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _7(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=u_({inputs:{input:s},backend:t}),i=_7({inputs:{x:r},backend:t}),a=HT({inputs:{input:s},backend:t}),o=T1({inputs:{x:a},backend:t}),l=cd({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return h_({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:t})}const g4e={kernelName:Qw,backendName:"webgl",kernelFunc:_7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4e(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return gC({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const i=e[0].shape,a=e[0].dtype;e.forEach(h=>{F2(i,h.shape,"All tensors passed to stack must have matching shapes"),J(a===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(h=>{const p=gC({inputs:{input:h},backend:t,attrs:{dim:r}});return o.push(p),p}),c=i7({inputs:l,backend:t,attrs:{axis:r}});return o.forEach(h=>t.disposeIntermediateTensorInfo(h)),c}const v4e={kernelName:eT,backendName:"webgl",kernelFunc:y4e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b4e{constructor(e,t,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((c,h)=>c[0]+e[h]+c[1]);const r=e.length,i=$n(r),a=t.map(c=>c[0]).join(","),o=t.map((c,h)=>c[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _4e{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((w,T)=>w[0]+e[T]+w[1]);const r=e.length,i=$n(r),a=t.map(w=>w[0]).join(","),o=t.map((w,T)=>w[0]+e[T]).join(","),l=ci("rc",r),c=ci("source",r),h=`${l[r-1]} < ${this.outputShape[r-1]}`,p=r===1?"source":`vec2(${c.slice(-2).join()})`,m=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${h}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${h}) {`],v=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let x="";for(let w=0,T=r===1?2:4;w<T;w++)x+=`
        ${m[w]}
        if (${v}) {
          result[${w}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${w}] = getChannel(getX(${c.join()}), ${p});
        }
      `;x+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x7=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:i,constantValue:a}=s;if(Me(r.shape)===0){const c=i.map((h,p)=>h[0]+r.shape[p]+h[1]);return h_({backend:t,attrs:{shape:c,value:a,dtype:r.dtype}})}const o=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _4e(r.shape,i,a):new b4e(r.shape,i,a),l=[[a]];return t.runWebGLProgram(o,[r],r.dtype,l)},x4e={kernelName:tT,backendName:"webgl",kernelFunc:x7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w4e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,T4e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Yf+`
  return result;
`,S4e=Cr({opSnippet:w4e,packedOpSnippet:T4e}),E4e={kernelName:Eb,backendName:"webgl",kernelFunc:S4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=r.shape.length,l=[],c=Vt(i,r.shape);let h=c;const p=us(h,o);let m=r;p!=null&&(m=di({inputs:{x:r},backend:t,attrs:{perm:p}}),h=Is(h.length,o),l.push(m)),Ir("prod",h,o);let v;if(t.shouldExecuteOnCPU([m])){const x=t.texData.get(m.dataId).values,{outVals:w,outShape:T,outDtype:E}=SLe(m.shape,m.dtype,x,h);v=t.makeTensorInfo(T,E,w)}else{const[x,w]=ur(m.shape,h),T=Me(w),E=Ze({inputs:{x:m},backend:t,attrs:{shape:[-1,T]}}),C=k$(r.dtype),$=Qf(E,C,"prod",t);v=Ze({inputs:{x:$},backend:t,attrs:{shape:x}}),l.push(E),l.push($)}if(a){l.push(v);const x=js(v.shape,c);v=Ze({inputs:{x:v},backend:t,attrs:{shape:x}})}return l.forEach(x=>t.disposeIntermediateTensorInfo(x)),v}const I4e={kernelName:sT,backendName:"webgl",kernelFunc:N4e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4e(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:i,indices:a}=e,{outputRaggedRank:o}=s,l=r.map(E=>t.readSync(E.dataId)),c=r.map(E=>E.shape),h=t.readSync(i.dataId),p=t.readSync(a.dataId),[m,v,x]=ELe(l,c,h,i.shape,i.dtype,p,a.shape,o),w=m.map(E=>t.makeTensorInfo([E.length],"int32",E)),T=t.makeTensorInfo(x,i.dtype,v);return w.concat([T])}const k4e={kernelName:rH,backendName:"webgl",kernelFunc:C4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4e(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:i}=e,a=t.readSync(s.dataId),o=t.readSync(r.dataId),l=t.readSync(i.dataId),[c,h]=NLe(a,s.shape,s.dtype,o,r.shape,l,i.shape),p=t.makeTensorInfo([c.length],"int32",c),m=t.makeTensorInfo([h.length],s.dtype,h);return[p,m]}const A4e={kernelName:iH,backendName:"webgl",kernelFunc:$4e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4e(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:i,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,c=t.readSync(r.dataId),h=t.readSync(i.dataId),p=t.readSync(a.dataId),m=o.map(T=>t.readSync(T.dataId)),v=o.map(T=>T.shape),[x,w]=ILe(c,r.shape,h,i.shape,i.dtype,p,a.shape,m,v,l);return t.makeTensorInfo(x,i.dtype,w)}const D4e={kernelName:aH,backendName:"webgl",kernelFunc:R4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w7=n=>{const{backend:e,attrs:t}=n,{start:s,stop:r,step:i,dtype:a}=t,o=CLe(s,r,i,a);return e.makeTensorInfo([o.length],a,o)},L4e={kernelName:v$,backendName:"webgl",kernelFunc:w7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O4e="return 1.0 / x;",P4e=cn({opSnippet:O4e}),M4e={kernelName:Nb,backendName:"webgl",kernelFunc:P4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F4e=po+`
  return (x < 0.0) ? 0.0 : x;
`,j4e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,B4e=cn({opSnippet:F4e,packedOpSnippet:j4e}),z4e={kernelName:Ib,backendName:"webgl",kernelFunc:B4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V4e=po+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,U4e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,G4e=cn({opSnippet:V4e,packedOpSnippet:U4e}),W4e={kernelName:Cb,backendName:"webgl",kernelFunc:G4e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H4e{constructor(e,t,s,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,t,s,c];const h=[r&&t>1?o-1:o,r&&s>1?l-1:l],p=[r&&t>1?t-1:t,r&&s>1?s-1:s];let m;i?m="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":m="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/p[0]},
          ${h[1]/p[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q4e{constructor(e,t,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,t,s,c];const h=[r&&t>1?o-1:o,r&&s>1?l-1:l],p=[r&&t>1?t-1:t,r&&s>1?s-1:s];let m;i?m="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":m="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/p[0]},
          ${h[1]/p[1]},
          ${h[1]/p[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K4e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:i,halfPixelCenters:a,size:o}=s,[l,c]=o,h=De().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new q4e(r.shape,l,c,i,a):new H4e(r.shape,l,c,i,a);return t.runWebGLProgram(h,[r],"float32")}const X4e={kernelName:aT,backendName:"webgl",kernelFunc:K4e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z4e{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,i]=t,[,a,o]=e,l=[s&&a>1?r-1:r,s&&o>1?i-1:i],c=[s&&a>1?a-1:a,s&&o>1?o-1:o],h=l[0]/c[0],p=l[1]/c[1],m=1/h,v=1/p,x=Math.ceil(m)*2+2,w=Math.ceil(v)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${p});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${v});

        const int winHeight = int(${x});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:i}=e,{alignCorners:a}=s,o=new Z4e(i.shape,r.shape,a);return t.runWebGLProgram(o,[i],i.dtype)}const Q4e={kernelName:x$,backendName:"webgl",kernelFunc:Y4e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J4e{constructor(e,t,s,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,t,s,c];const h=[r&&t>1?o-1:o,r&&s>1?l-1:l],p=[r&&t>1?t-1:t,r&&s>1?s-1:s],m=r?"0.5":"0.0";let v;i?v="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":v="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/p[0]},
          ${h[1]/p[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${v};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eBe{constructor(e,t,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,t,s,c];const h=[r&&t>1?o-1:o,r&&s>1?l-1:l],p=[r&&t>1?t-1:t,r&&s>1?s-1:s],m=r?"0.5":"0.0";let v;i?v="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":v="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/p[0]},
          ${h[1]/p[1]},
          ${h[1]/p[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${v};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tBe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:i,halfPixelCenters:a,size:o}=s,[l,c]=o,h=De().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new eBe(r.shape,l,c,i,a):new J4e(r.shape,l,c,i,a);return t.runWebGLProgram(h,[r],r.dtype)}const nBe={kernelName:iT,backendName:"webgl",kernelFunc:tBe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sBe{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,i]=t,[,a,o]=e,l=[s&&a>1?r-1:r,s&&o>1?i-1:i],c=[s&&a>1?a-1:a,s&&o>1?o-1:o],h=l[0]/c[0],p=l[1]/c[1],m=1/h,v=1/p,x=Math.ceil(m)*2+2,w=Math.ceil(v)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${p});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${v});

        const int winHeight = int(${x});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rBe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:i}=e,{alignCorners:a}=s,o=new sBe(i.shape,r.shape,a);return t.runWebGLProgram(o,[i],i.dtype)}const iBe={kernelName:_$,backendName:"webgl",kernelFunc:rBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aBe{constructor(e,t){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=o=>t.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,i=e.map((o,l)=>r(l)).join(","),a=$n(s);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oBe{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=ci("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,a=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,o=$n(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${a}) {
            result.b = ${h(r.slice())};
            if(${i}) {
              result.a = ${p(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(x){return m(x)}function c(x){return x[s-1]="("+x[s-1]+" + 1)",m(x)}function h(x){return x[s-2]="("+x[s-2]+" + 1)",m(x)}function p(x){return x[s-1]="("+x[s-1]+" + 1)",x[s-2]="("+x[s-2]+" + 1)",m(x)}function m(x){const w=e.map((C,$)=>v($,x)),T=w.join(","),E=w.slice(-2).join(",");return`getChannel(getX(${T}), vec2(${E}))`}function v(x,w){return t.indexOf(x)!==-1&&e[x]!==1?`${e[x]} - ${w[x]} - 1`:`${w[x]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lBe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:i}=s,a=r.shape.length,o=Vt(i,r.shape);if(a===0)return aa({inputs:{x:r},backend:t});const l=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new oBe(r.shape,o):new aBe(r.shape,o);return t.runWebGLProgram(l,[r],r.dtype)}const cBe={kernelName:oT,backendName:"webgl",kernelFunc:lBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uBe{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof t=="number"?i=`float outputValue = ${t.toFixed(2)};`:i=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hBe={kernelName:C$,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:i,center:a}=e,o=t,l=new uBe(s.shape,i),[c,h]=pA(a,s.shape[1],s.shape[2]),p=[[c,h,Math.sin(r),Math.cos(r)]];return o.runWebGLProgram(l,[s],s.dtype,p)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dBe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,fBe=cn({opSnippet:dBe}),pBe={kernelName:kb,backendName:"webgl",kernelFunc:fBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mBe="return inversesqrt(x);",gBe=cn({opSnippet:mBe,cpuKernelImpl:kLe}),yBe={kernelName:$b,backendName:"webgl",kernelFunc:gBe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gR{constructor(e,t,s,r,i,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const c=$n(i.length),h=$n(a.length);let p="";s===1?p="i":s===2&&(p="i, j");const m=`getIndices(${p})`;let v="";r===1?v="i":r===2&&(v="i, coords[1]");const x=`getUpdates(${v})`;let w="";l&&(w="coords[0], coords[1]");const T=`getDefaultValue(${w})`,E=t>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${h} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${m});
              flattenedIndex += index * ${E};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${x};
              found = true;
            }
          }
          setOutput(mix(${T}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vBe{constructor(e,t,s,r,i,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const c=$n(i.length),h=$n(a.length);let p="";s===1?p="i":s===2&&(p="i, j");const m=`getIndices(${p})`;let v="";r===1?v="i":r===2&&(v="i, coords[1]");const x=`getUpdates(${v})`;let w="";l&&(w="coords[0], coords[1]");const T=`getDefaultValue(${w})`,E=t>1?"strides[j]":"strides",C=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${h} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${m});
              flattenedIndex += index.xz * ${E};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${C};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${x};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${T}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bBe(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:i}=e,{shape:a}=s,{sliceRank:o,numUpdates:l,sliceSize:c,strides:h,outputSize:p}=Hf(i,r,a),m=[p/c,c];if(p===0)return t.makeTensorInfo(a,r.dtype);const v=Ze({inputs:{x:r},backend:t,attrs:{shape:[l,o]}}),x=Ze({inputs:{x:i},backend:t,attrs:{shape:[l,c]}}),w=t.makeTensorInfo([],"float32",new Float32Array([0]));let T;De().getBool("WEBGL_PACK")?T=new vBe(l,o,v.shape.length,x.shape.length,h,m):T=new gR(l,o,v.shape.length,x.shape.length,h,m);const E=t.runWebGLProgram(T,[x,v,w],x.dtype),C=Ze({inputs:{x:E},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(E),t.disposeIntermediateTensorInfo(w),C}const _Be={kernelName:oH,backendName:"webgl",kernelFunc:bBe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xBe{constructor(e,t,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,o=De().getNumber("WEBGL_VERSION")===2?i:a,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wBe(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:i}=e,{side:a}=s,o=new xBe(r.shape[0],r.shape[1],i.shape[1],a),l=[[r.shape[1]]];return t.runWebGLProgram(o,[r,i],"int32",l)}const TBe={kernelName:cH,backendName:"webgl",kernelFunc:wBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SBe{constructor(e,t,s){this.variableNames=["c","a","b"],this.outputShape=t;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let h=0;h<t.length;h++)c.push(`${o[h]}`),h<e&&l.push(`${o[h]}`);r=l.join(),i=c.join()}const a=$n(s);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EBe(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:i}=e,a=new SBe(s.shape.length,r.shape,r.shape.length);return t.runWebGLProgram(a,[s,r,i],ra(r.dtype,i.dtype))}const NBe={kernelName:lT,backendName:"webgl",kernelFunc:EBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IBe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${CT};
  float scale = ${kT};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,CBe=cn({opSnippet:IBe}),kBe={kernelName:Ab,backendName:"webgl",kernelFunc:CBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Be=dg+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,ABe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,RBe=cn({opSnippet:$Be,packedOpSnippet:ABe,cpuKernelImpl:ALe}),DBe={kernelName:Ob,backendName:"webgl",kernelFunc:RBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LBe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,OBe=cn({opSnippet:LBe}),PBe={kernelName:Lb,backendName:"webgl",kernelFunc:OBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MBe=dg+`
  return sin(x);
`,FBe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Yf}
  return result;
`,jBe=cn({opSnippet:MBe,packedOpSnippet:FBe}),BBe={kernelName:Rb,backendName:"webgl",kernelFunc:jBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zBe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,VBe=cn({opSnippet:zBe}),UBe={kernelName:Db,backendName:"webgl",kernelFunc:VBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GBe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,WBe=cn({opSnippet:GBe}),HBe={kernelName:Pb,backendName:"webgl",kernelFunc:WBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qBe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:i,paddings:a}=s;J(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=i.reduce((E,C)=>E*C),l=[[0,0]];l.push(...a);for(let E=1+i.length;E<r.shape.length;++E)l.push([0,0]);const c=[],h=x7({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),p=Xb(h.shape,i,o,!1),m=Zb(p.length,i.length,!1),v=Yb(h.shape,i,o,!1),x=Ze({inputs:{x:h},backend:t,attrs:{shape:p}}),w=di({inputs:{x},backend:t,attrs:{perm:m}}),T=Ze({inputs:{x:w},backend:t,attrs:{shape:v}});return c.push(h),c.push(x),c.push(w),c.forEach(E=>t.disposeIntermediateTensorInfo(E)),T},KBe={kernelName:hT,backendName:"webgl",kernelFunc:qBe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XBe(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:i,defaultValue:a}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=t.readSync(s.dataId),l=t.readSync(r.dataId),c=t.readSync(i.dataId),h=t.readSync(a.dataId)[0],[p,m,v,x,w]=DLe(o,s.shape,s.dtype,l,r.dtype,c,h);return[t.makeTensorInfo(m,s.dtype,p),t.makeTensorInfo([m[0]],r.dtype,v),t.makeTensorInfo([x.length],"bool",new Uint8Array(x.map(T=>Number(T)))),t.makeTensorInfo([w.length],s.dtype,new Int32Array(w))]}const ZBe={kernelName:uH,backendName:"webgl",kernelFunc:XBe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YBe(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const a=Array.from(t.readSync(r.dataId)),o=t.readSync(s.dataId),l=Array.from(t.readSync(i.dataId)),[c,h,p]=LLe(o,s.shape,s.dtype,a,l);return[t.makeTensorInfo(h,s.dtype,c),t.makeTensorInfo([p.length],i.dtype,new Int32Array(p))]}const QBe={kernelName:hH,backendName:"webgl",kernelFunc:YBe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JBe(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const a=t.readSync(s.dataId),o=t.readSync(r.dataId),l=t.readSync(i.dataId),[c,h]=HK(a,s.shape,s.dtype,o,l,!0);return t.makeTensorInfo(h,s.dtype,c)}const eze={kernelName:dH,backendName:"webgl",kernelFunc:JBe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tze(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const a=t.readSync(s.dataId),o=t.readSync(r.dataId),l=t.readSync(i.dataId),[c,h]=HK(a,s.shape,s.dtype,o,l);return t.makeTensorInfo(h,s.dtype,c)}const nze={kernelName:fH,backendName:"webgl",kernelFunc:tze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sze(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:i,defaultValue:a}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:h,strides:p,outputSize:m}=Hf(i,r,o),v=!1;if(i.dtype==="string"){const E=t.bufferSync(r),C=t.bufferSync(i),$=jh(t.readSync(a.dataId)[0]),R=$Le(E,C,o,m,h,c,l,p,$,v);return t.makeTensorInfo(o,R.dtype,R.values)}const x=new gR(c,l,r.shape.length,i.shape.length,p,[m,1],v),w=t.runWebGLProgram(x,[i,r,a],i.dtype),T=Ze({inputs:{x:w},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(w),T}const rze={kernelName:pH,backendName:"webgl",kernelFunc:sze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ize(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:i,axis:a}=s,o=Vt(a,r.shape)[0],l=kA(r,i,o),c=r.shape.length,h=new Array(c).fill(0),p=r.shape.slice();return l.map(m=>{const v=[...p];v[o]=m;const x=fg({inputs:{x:r},backend:t,attrs:{begin:h,size:v}});return h[o]+=m,x})}const aze={kernelName:dT,backendName:"webgl",kernelFunc:ize};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pF="return sqrt(x);",oze=cn({opSnippet:pF,packedOpSnippet:pF,cpuKernelImpl:OLe}),lze={kernelName:Mb,backendName:"webgl",kernelFunc:oze};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cze="return x * x;",uze=cn({opSnippet:cze}),hze={kernelName:w$,backendName:"webgl",kernelFunc:uze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mF="return (a - b) * (a - b);",dze=Cr({opSnippet:mF,packedOpSnippet:mF}),fze={kernelName:Fb,backendName:"webgl",kernelFunc:dze};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=t.readSync(r.dataId),a=su(i),o=PLe(a,"string",s);return t.makeTensorInfo(r.shape,"string",o)}const mze={kernelName:T$,backendName:"webgl",kernelFunc:pze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gze({inputs:n,attrs:e,backend:t}){const{x:s}=n,r=po+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new kl(s.shape,r);return t.runWebGLProgram(i,[s],s.dtype)}const yze={kernelName:Ub,backendName:"webgl",kernelFunc:gze};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vze{constructor(e,t,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=$n(s.length),a=$n(s.length);let o="";if(r===1)o="coords * strides + begin";else{let l=0;o=s.map((c,h)=>(l++,s.length===1?`coords * strides[${h}] + begin[${h}]`:`coords[${l-1}] * strides[${h}] + begin[${h}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:i,end:a,strides:o,beginMask:l,endMask:c,ellipsisMask:h,newAxisMask:p,shrinkAxisMask:m}=s,{finalShapeSparse:v,finalShape:x,isIdentity:w,sliceDim0:T,isSimpleSlice:E,begin:C,end:$,strides:R}=hA(r.shape,i,a,o,l,c,h,p,m);let P;if(w)P=Ze({inputs:{x:r},backend:t,attrs:{shape:x}});else if(T||E){J(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const j=lA(C,$,R),O=fg({inputs:{x:r},backend:t,attrs:{begin:C,size:j}});P=Ze({inputs:{x:O},backend:t,attrs:{shape:x}}),t.disposeIntermediateTensorInfo(O)}else if(t.shouldExecuteOnCPU([r])){const O=t.readSync(r.dataId),M=zt(r.shape,r.dtype,O),B=MLe(v,M,R,C);P=t.makeTensorInfo(x,r.dtype,B.values)}else{const O=new vze(C,R,v);P=t.runWebGLProgram(O,[r],r.dtype)}const U=Ze({inputs:{x:P},backend:t,attrs:{shape:x}});return t.disposeIntermediateTensorInfo(P),U}const _ze={kernelName:S$,backendName:"webgl",kernelFunc:bze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xze(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:i,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:c}=s,{data:h,dataSplits:p}=e,m=t.readSync(h.dataId),v=t.readSync(p.dataId),[x,w]=FLe(m,v,r,i,a,o,l,c);return[t.makeTensorInfo([x.length],"string",x),t.makeTensorInfo(p.shape,"int32",w)]}const wze={kernelName:mH,backendName:"webgl",kernelFunc:xze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tze(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:i,delimiter:a}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=t.readSync(i.dataId),l=t.readSync(a.dataId)[0],[c,h,p]=jLe(o,l,r),m=h.length;return[t.makeTensorInfo([m,2],"int32",c),t.makeTensorInfo([m],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(p))]}const Sze={kernelName:gH,backendName:"webgl",kernelFunc:Tze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eze(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const a=t.readSync(i.dataId),o=BLe(a,r);return t.makeTensorInfo(i.shape,"int32",o)}const Nze={kernelName:yH,backendName:"webgl",kernelFunc:Eze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ize="return tan(x);",Cze=cn({opSnippet:Ize}),kze={kernelName:Bb,backendName:"webgl",kernelFunc:Cze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ze=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Aze=cn({opSnippet:$ze}),Rze={kernelName:zb,backendName:"webgl",kernelFunc:Aze};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dze(n){const{inputs:e,backend:t,attrs:s}=n,{tensor:r,indices:i,updates:a}=e,{sliceRank:o,numUpdates:l,sliceSize:c,strides:h,outputSize:p}=Hf(a,i,r.shape),m=[p/c,c];if(p===0)return t.makeTensorInfo(r.shape,i.dtype);const v=Ze({inputs:{x:i},backend:t,attrs:{shape:[l,o]}}),x=Ze({inputs:{x:a},backend:t,attrs:{shape:[l,c]}}),w=Ze({inputs:{x:r},backend:t,attrs:{shape:m}}),T=new gR(l,o,v.shape.length,x.shape.length,h,m,!1,!0),E=t.runWebGLProgram(T,[x,v,w],w.dtype),C=Ze({inputs:{x:E},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(E),C}const Lze={kernelName:lH,backendName:"webgl",kernelFunc:Dze};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oze{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let a=0;a<s.length;a++)s[a]=e[a]*t[a];this.outputShape=s,this.rank=s.length;const r=$n(this.rank),i=Pze(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function Pze(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<n.length;r++)s.push(`imod(${t[r]}, ${n[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=t.readSync(r.dataId),c=r.dtype==="string"?l.map(m=>jh(m)):l,h=zt(r.shape,r.dtype,c),p=VLe(h,i);return t.makeTensorInfo(p.shape,p.dtype,p.values)}const a=new Oze(r.shape,i);return t.runWebGLProgram(a,[r],r.dtype)}const Mze={kernelName:Vb,backendName:"webgl",kernelFunc:T7};class Fze{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class jze{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zd(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function gF(n){let e=1;for(;e<n;)e*=2;return e}function Bze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:i,sorted:a}=s,o=De().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=De().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,h=c[c.length-1];if(t.shouldExecuteOnCPU([r])||h<o||i>l){const B=t.readSync(r.dataId),[D,W]=ULe(B,c,r.dtype,i,a);return[t.makeTensorInfo(D.shape,D.dtype,D.values),t.makeTensorInfo(W.shape,W.dtype,W.values)]}if(i===0)return c[c.length-1]=0,[t.makeTensorInfo(c,r.dtype,[]),t.makeTensorInfo(c,"int32",[])];if(h===1)return[r,h_({attrs:{shape:c,dtype:"int32",value:0},backend:t})];const p=t.texData.get(r.dataId),m=p!==null&&p.isPacked,v=m?t.unpackTensor(r):r,w=Me(c)/h,T=Ze({inputs:{x:v},attrs:{shape:[w,h]},backend:t});m&&zd(t,v);const E=gF(i),C=gF(h);let $=null;const R=()=>$===null?[T,T]:[T,$],P=(B,D,W)=>{const H=R(),ae=new Fze(W),Z=[[h],[$===null?1:0],[Number.NEGATIVE_INFINITY],[B],[D]],re=$;$=t.runWebGLProgram(ae,H,"int32",Z),zd(t,re)};for(let B=1;B<E;B*=2){const D=B*2;for(let W=B;W>=1;W/=2)P(D,W,[w,C])}for(let B=C;B>E;B/=2){const D=R(),W=new jze([w,B/2]),ae=[[h],[$===null?1:0],[E]],te=$;$=t.runWebGLProgram(W,D,"int32",ae),zd(t,te);const Z=E/2,re=Z*2;for(let ne=Z;ne>=1;ne/=2)P(re,ne,$.shape)}let U=$;$=fg({inputs:{x:$},backend:t,attrs:{begin:0,size:[w,i]}}),zd(t,U);let j=m7({inputs:{x:T,indices:$},backend:t,attrs:{axis:1,batchDims:1}});zd(t,T);const O=c.slice(0,-1);O.push(i),U=$,$=Ze({inputs:{x:$},attrs:{shape:O},backend:t}),zd(t,U);const M=j;return j=Ze({inputs:{x:j},attrs:{shape:O},backend:t}),zd(t,M),[j,$]}const zze={kernelName:E$,backendName:"webgl",kernelFunc:Bze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vze{constructor(e,t,s,r,i,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const o=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uze(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,transforms:i}=e,{interpolation:a,fillMode:o,fillValue:l,outputShape:c}=s,[h,p,m,v]=r.shape,[x,w]=c??[p,m],T=[h,x,w,v],E=new Vze(p,m,a,o,l,T);return t.runWebGLProgram(E,[r,i],"float32")}const Gze={kernelName:N$,backendName:"webgl",kernelFunc:Uze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wze(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:i}=e;l_(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=s.readSync(i.dataId),{outputValues:o,outputShape:l,indices:c}=GLe(a,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,o),s.makeTensorInfo([c.length],"int32",c)]}const Hze={kernelName:I$,backendName:"webgl",kernelFunc:Wze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qze(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const a=r,o=a.shape.length,l=r.shape[i],c=new Array(o-1);let h=0;for(let w=0;w<o;w++)w!==i&&(c[h++]=a.shape[w]);const p=[],m=new Array(o).fill(0),v=a.shape.slice();v[i]=1;const x=new Array(l);for(let w=0;w<x.length;w++){m[i]=w;const T=fg({inputs:{x:a},backend:t,attrs:{begin:m,size:v}}),E=Ze({inputs:{x:T},backend:t,attrs:{shape:c}});x[w]=E,p.push(T)}return p.forEach(w=>t.disposeIntermediateTensorInfo(w)),x}const Kze={kernelName:pT,backendName:"webgl",kernelFunc:qze};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xze{constructor(e,t){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/s);this.outputShape=[r,o];const l="0.0",c="sumValue",h=Math.floor(s/4)*4,p=s%4,m=`
        sumValue += dot(values, segFilter);
    `;let v="";i%s>0&&(v=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let x="";i%s>0&&(x=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${v}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${x}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${m}
        }

        int inIdx = inOffset + ${h};
        if (${p===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${m}
        } else if (${p===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${m}
        } else if (${p===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${m}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:i}=e,{numSegments:a}=s,o=r.shape.length,l=[];let c=0;const h=us([c],o);let p=r;h!=null&&(p=di({inputs:{x:r},backend:t,attrs:{perm:h}}),l.push(p),c=Is(1,o)[0]);const m=rq(p.shape,c,a),v=Me([p.shape[c]]),x=Ze({inputs:{x:p},backend:t,attrs:{shape:[-1,v]}});l.push(x);const w=k$(r.dtype),T=(R,P,U,j,O)=>{const M=R.shape[0],B=R.shape[1],D=sq(B,O),W={windowSize:D,inSize:B,batchSize:M,numSegments:O},H=new Xze(W,P),ae=t.compileAndRun(H,[R,U],j);if(l.push(ae),ae.shape[1]===O)return ae;const te=w7({backend:t,attrs:{start:0,stop:O,step:1,dtype:"float32"}}),Z=T7({inputs:{x:te},backend:t,attrs:{reps:[B/D]}});return l.push(te),l.push(Z),T(ae,P,Z,j,O)},E=T(x,"unsortedSegmentSum",i,w,a),C=Ze({inputs:{x:E},backend:t,attrs:{shape:m}});let $=C;if(h!=null){l.push(C);const R=sd(h);$=di({inputs:{x:$},backend:t,attrs:{perm:R}})}return l.forEach(R=>t.disposeIntermediateTensorInfo(R)),$}const Yze={kernelName:mT,backendName:"webgl",kernelFunc:Zze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qze=[OOe,MOe,BOe,UOe,WOe,KOe,ZOe,QOe,nPe,rPe,oPe,uPe,fPe,yPe,_Pe,wPe,SPe,CPe,$Pe,RPe,PPe,UPe,WPe,XPe,YPe,sMe,iMe,cMe,vOe,dMe,yMe,xMe,IMe,$Me,RMe,LMe,PMe,BMe,UMe,HMe,KMe,ZMe,QMe,t3e,s3e,o3e,c3e,d3e,m3e,y3e,x3e,E3e,k3e,R3e,O3e,P3e,F3e,B3e,V3e,G3e,H3e,Z3e,J3e,nFe,rFe,oFe,uFe,pFe,vFe,yOe,_Fe,mMe,TFe,NFe,kFe,_Oe,DFe,MFe,jFe,UFe,HFe,ZFe,JFe,sje,oje,uje,dje,gje,vje,_je,Sje,Nje,Cje,$je,Rje,Pje,Bje,Gje,Qje,TOe,n4e,i4e,l4e,h4e,JPe,p4e,g4e,v4e,x4e,E4e,wOe,I4e,k4e,A4e,D4e,L4e,eMe,Kje,M4e,z4e,W4e,EOe,X4e,Q4e,nBe,iBe,cBe,hBe,pBe,yBe,_Be,TBe,NBe,kBe,DBe,PBe,BBe,UBe,zPe,Zje,HBe,KBe,ZBe,QBe,eze,nze,rze,aze,lze,hze,fze,mze,yze,_ze,wze,Sze,Nze,Xje,ROe,kze,Rze,Lze,Mze,zze,Gze,DOe,Hze,Kze,Yze,m4e];for(const n of Qze)bH(n);function Jze(){const[n,e]=ve.useState([]),[t,s]=ve.useState(null),[r,i]=ve.useState(1),[a,o]=ve.useState(""),[l,c]=ve.useState(""),h=ve.useRef(null),p=ve.useRef(null),m=ve.useRef([]),v=ve.useRef(null),x=ve.useRef(null),w=ve.useRef([]),[T,E]=ve.useState(null),[C,$]=ve.useState("Model not loaded"),[R,P]=ve.useState([]);ve.useEffect(()=>{(async()=>{const re=(await Mc(Dh(Pr,"projects"))).docs.map(ne=>({id:ne.id,...ne.data()}));e(re)})()},[]);const U=async te=>{if(!t)return alert("No project selected!");const Z=Hl(Pr,"projects",t.id),re={step:`Step ${r}`,reviewer:"Admin User",date:new Date().toISOString().split("T")[0],status:te,notes:a},ne=te==="approved"?"verified":te==="rejected"?"rejected":"under_review";try{await D0(Z,{status:ne,verificationHistory:[...t.verificationHistory||[],re]}),e(he=>he.map(K=>K.id===t.id?{...K,status:ne,verificationHistory:[...K.verificationHistory||[],re]}:K)),s(he=>({...he,status:ne,verificationHistory:[...he.verificationHistory||[],re]})),o(""),i(he=>he+1),alert(`Project ${te} successfully!`)}catch(he){console.error("Firestore update failed:",he),alert("Failed to update project. Check console for details.")}},j=async()=>{if(!t||t.status!=="verified"){alert("Credits can only be generated for a verified project.");return}const te=parseFloat(l);if(isNaN(te)||te<=0){alert("Please enter a valid number of credits to generate.");return}const Z=Hl(Pr,"projects",t.id);try{console.log(`Simulating blockchain transaction for ${te} credits...`);const re=`tx_${new Date().getTime()}`;await D0(Z,{creditsGenerated:(t.creditsGenerated||0)+te,blockchainTx:re}),e(ne=>ne.map(he=>he.id===t.id?{...he,creditsGenerated:(he.creditsGenerated||0)+te,blockchainTx:re}:he)),s(ne=>({...ne,creditsGenerated:(ne.creditsGenerated||0)+te,blockchainTx:re})),c(""),alert(`${te} carbon credits successfully generated!`)}catch(re){console.error("Failed to generate credits:",re),alert("Failed to generate credits. Check console for details.")}},O=te=>{switch(te){case"pending":return"status-badge pending";case"under_review":return"status-badge active";case"verified":return"status-badge verified";case"rejected":return"status-badge rejected";default:return"status-badge no-reports"}},M=te=>{switch(te){case"pending":return"Pending Review";case"under_review":return"Under Review";case"verified":return"Verified";case"rejected":return"Rejected";default:return"Unknown"}};async function B(){$("Loading model...");try{const te=await mve({base:"ade20k",quantizationBytes:2});E(te),$(" Model loaded (ADE20K)!")}catch(te){console.error("Failed to load model:",te),$(" Failed to load model")}}function D(te){try{const Z=document.createElement("canvas"),re=Z.getContext("2d");Z.width=te.naturalWidth||te.width,Z.height=te.naturalHeight||te.height,re.drawImage(te,0,0);const{data:ne}=re.getImageData(0,0,Z.width,Z.height);let he=0;const K=Z.width*Z.height;for(let pe=0;pe<ne.length;pe+=4){const fe=ne[pe],Ne=ne[pe+1],Te=ne[pe+2];2*Ne-fe-Te>20&&he++}const ie=(he/K*100).toFixed(1);return{percentage:parseFloat(ie),greenPixels:he,totalPixels:K}}catch(Z){return console.error("ExG calculation failed:",Z),{percentage:0,greenPixels:0,totalPixels:0}}}async function W(te,Z,re,ne){if(!Z){ae(ne,` ${te}: Image not found`);return}if(!T)return H(te,Z,ne);$(`Analyzing ${te}...`);try{const he=await T.segment(Z),K=he.data||he.segmentationMap,ie=[21,22,47,66,120];let pe=0;for(let He=0;He<K.length;He++)ie.includes(K[He])&&pe++;const fe=pe/K.length*100,Ne=re.current,Te=Ne.getContext("2d");Ne.width=he.width,Ne.height=he.height;const Se=Te.createImageData(Ne.width,Ne.height);for(let He=0;He<K.length;He++){const qe=He*4;ie.includes(K[He])?(Se.data[qe]=0,Se.data[qe+1]=255,Se.data[qe+2]=0,Se.data[qe+3]=120):Se.data[qe+3]=0}if(Te.putImageData(Se,0,0),fe>1)ae(ne,` ${te}: Vegetation detected (${fe.toFixed(1)}% via ADE20K)`);else return H(te,Z,ne);$(" Done")}catch(he){return console.error("AI analysis failed, falling back to ExG:",he),H(te,Z,ne)}}async function H(te,Z,re){try{Z.complete||await new Promise((pe,fe)=>{Z.onload=pe,Z.onerror=fe,setTimeout(fe,5e3)});const ne=D(Z),he=ne.percentage>15?"High vegetation coverage":ne.percentage>5?"Moderate vegetation coverage":"Low vegetation coverage",ie=`${ne.percentage>15?"":ne.percentage>5?"":""} ${te}: ${ne.percentage}% green coverage (${ne.greenPixels.toLocaleString()}/${ne.totalPixels.toLocaleString()} pixels) - ${he}`;ae(re,ie),$(" ExG analysis complete")}catch(ne){console.error(`ExG analysis failed for ${te}:`,ne),ae(re,` ${te}: ExG analysis failed`),$(" ExG analysis failed")}}function ae(te,Z){P(re=>{const ne=[...re];return ne[te]=Z,ne})}return y.jsxs("div",{className:"page-container",children:[y.jsxs("div",{className:"page-header",children:[y.jsx("h1",{className:"page-title",children:" Project Verification Dashboard"}),y.jsx("p",{className:"page-subtitle",children:"Review submitted blue carbon projects and update verification status"})]}),y.jsxs("div",{className:"verification-layout",children:[y.jsxs("div",{className:"projects-sidebar",children:[y.jsxs("h3",{children:["Projects (",n.length,")"]}),y.jsx("div",{className:"projects-list",children:n.map(te=>y.jsxs("div",{className:`project-tile ${t?.id===te.id?"selected":""}`,onClick:()=>{s(te),i(1),o(""),P([]),m.current=[],w.current=[]},children:[y.jsxs("div",{className:"tile-header",children:[y.jsx("h4",{children:te.projectName||te.name}),y.jsx("span",{className:O(te.status),children:M(te.status)})]}),y.jsxs("div",{className:"tile-info",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Type:"})," ",te.projectType||te.type]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Location:"})," ",te.location]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Area:"})," ",te.area||"-"," ha"]})]})]},te.id))})]}),t?y.jsxs("div",{className:"project-details-panel",children:[y.jsxs("div",{className:"project-overview",children:[y.jsx("h2",{children:t.projectName||"-"}),y.jsx("span",{className:O(t.status),children:M(t.status)}),y.jsxs("div",{className:"overview-grid",children:[y.jsxs("div",{className:"overview-item",children:[y.jsx("label",{children:"Type"}),t.projectType||"-"]}),y.jsxs("div",{className:"overview-item",children:[y.jsx("label",{children:"Location"}),t.location||"-"]}),y.jsxs("div",{className:"overview-item",children:[y.jsx("label",{children:"Area"}),t.area||"-"," ha"]}),y.jsxs("div",{className:"overview-item",children:[y.jsx("label",{children:"Expected Credits"}),t.expectedCredits||"-"," tons CO"]}),y.jsxs("div",{className:"overview-item",children:[y.jsx("label",{children:"Timeline"}),t.timeline||"-"]}),y.jsxs("div",{className:"overview-item",children:[y.jsx("label",{children:"Methodology"}),t.methodology||"-"]}),y.jsxs("div",{className:"overview-item",children:[y.jsx("label",{children:"Coordinates"}),t.coordinates||"-"]}),y.jsxs("div",{className:"overview-item",children:[y.jsx("label",{children:"Generated Credits"}),t.creditsGenerated||"-"," tons CO"]}),y.jsxs("div",{className:"overview-item",children:[y.jsx("label",{children:"Blockchain Tx ID"}),y.jsx("span",{className:"tx-id",children:t.blockchainTx||"-"})]})]}),y.jsxs("div",{className:"project-description",children:[y.jsx("label",{children:"Description"}),y.jsx("p",{children:t.description||"-"})]}),t.capturedPhoto&&y.jsxs("div",{className:"verifier-image-block",children:[y.jsx("label",{children:"Captured Photo"}),y.jsx("img",{ref:h,src:t.capturedPhoto,alt:"Captured",className:"project-image",crossOrigin:"anonymous"}),y.jsx("canvas",{ref:v,className:"overlay-canvas"}),y.jsxs("div",{className:"analysis-buttons",children:[y.jsx("button",{onClick:()=>W("Captured Photo",h.current,v,0),children:" AI Analysis"}),y.jsx("button",{onClick:()=>H("Captured Photo",h.current,0),children:" ExG Only"})]})]}),t.satImage&&y.jsxs("div",{className:"verifier-image-block",children:[y.jsx("label",{children:"Satellite Image"}),y.jsx("img",{ref:p,src:t.satImage,alt:"Satellite",className:"project-image",crossOrigin:"anonymous"}),y.jsx("canvas",{ref:x,className:"overlay-canvas"}),y.jsxs("div",{className:"analysis-buttons",children:[y.jsx("button",{onClick:()=>W("Satellite Image",p.current,x,1),children:" AI Analysis"}),y.jsx("button",{onClick:()=>H("Satellite Image",p.current,1),children:" ExG Only"})]})]}),t.documents?.length>0&&t.documents.map((te,Z)=>y.jsxs("div",{className:"verifier-image-block",children:[y.jsxs("label",{children:["Uploaded Image ",Z+1]}),y.jsx("img",{ref:re=>m.current[Z]=re,src:te,alt:`Doc ${Z}`,className:"project-image",crossOrigin:"anonymous"}),y.jsx("canvas",{ref:re=>w.current[Z]=re,className:"overlay-canvas"}),y.jsxs("div",{className:"analysis-buttons",children:[y.jsx("button",{onClick:()=>W(`Uploaded Image ${Z+1}`,m.current[Z],w.current[Z],Z+2),children:" AI Analysis"}),y.jsx("button",{onClick:()=>H(`Uploaded Image ${Z+1}`,m.current[Z],Z+2),children:" ExG Only"})]})]},Z)),y.jsxs("div",{className:"ai-panel",children:[y.jsx("div",{className:"ai-controls",children:y.jsx("button",{onClick:B,disabled:!!T,children:T?" Model Ready":"Load AI Model"})}),y.jsx("div",{className:"ai-status",children:C}),y.jsx("div",{className:"ai-results",children:R.map((te,Z)=>y.jsx("div",{className:"result-item",children:te},Z))})]})]}),y.jsxs("div",{className:"verification-actions",children:[y.jsx("textarea",{value:a,onChange:te=>o(te.target.value),placeholder:"Add verification notes...",rows:"4"}),y.jsx("button",{onClick:()=>U("approved"),children:" Approve"}),y.jsx("button",{onClick:()=>U("under_review"),children:" Request Revision"}),y.jsx("button",{onClick:()=>U("rejected"),children:" Reject"}),y.jsx("hr",{style:{margin:"1rem 0"}}),y.jsxs("div",{className:"credit-generation-controls",children:[y.jsx("input",{type:"number",placeholder:"Enter credits to generate...",value:l,onChange:te=>c(te.target.value),min:"0"}),y.jsx("button",{onClick:j,disabled:!t||t.status!=="verified",children:" Generate Credits"})]})]}),t.verificationHistory?.length>0&&y.jsxs("div",{className:"verification-history",children:[y.jsx("h4",{children:" Verification History"}),t.verificationHistory.map((te,Z)=>y.jsxs("div",{className:"history-item",children:[y.jsxs("strong",{children:[te.step,":"]})," ",te.status," by ",te.reviewer," on ",te.date," ",te.notes&&`- Notes: ${te.notes}`]},Z))]})]}):y.jsx("div",{className:"no-selection",children:y.jsx("h3",{children:" Select a project to view details"})})]})]})}function eVe(){const[n,e]=ve.useState([]),[t,s]=ve.useState(""),[r,i]=ve.useState("all"),[a,o]=ve.useState(!1),[l,c]=ve.useState({name:"",email:"",role:"farmer",organization:"",phone:"",location:""});ve.useEffect(()=>{(async()=>{try{const T=(await Mc(Dh(Pr,"users"))).docs.map(E=>({id:E.id,...E.data()}));e(T)}catch(w){console.error("Error fetching users:",w)}})()},[]);const h=async()=>{try{const x={name:l.name||"Unnamed User",email:l.email||"no-email@example.com",role:l.role||"farmer",organization:l.organization||"N/A",phone:l.phone||"N/A",location:l.location||"N/A",joinDate:new Date().toISOString().split("T")[0],lastActive:new Date().toISOString().split("T")[0],status:"pending",projects:0,credits:0,avatar:l.role==="farmer"?"":l.role==="buyer"?"":""},w=await lB(Dh(Pr,"users"),x);e([...n,{id:w.id,...x}]),c({name:"",email:"",role:"farmer",organization:"",phone:"",location:""}),o(!1)}catch(x){console.error("Error adding user:",x)}},p=async(x,w)=>{try{const T=Hl(Pr,"users",x);await D0(T,{role:w}),e(n.map(E=>E.id===x?{...E,role:w}:E))}catch(T){console.error("Error updating role:",T)}},m=async(x,w)=>{try{const T=Hl(Pr,"users",x);await D0(T,{status:w}),e(n.map(E=>E.id===x?{...E,status:w}:E))}catch(T){console.error("Error updating status:",T)}},v=n.filter(x=>{const w=(x.name||"").toLowerCase(),T=(x.email||"").toLowerCase(),E=(x.organization||"").toLowerCase(),C=w.includes(t.toLowerCase())||T.includes(t.toLowerCase())||E.includes(t.toLowerCase()),$=r==="all"||x.role===r;return C&&$});return y.jsxs("div",{className:"user-management",children:[y.jsx("h2",{children:" User Management"}),y.jsxs("div",{className:"controls",children:[y.jsx("input",{type:"text",placeholder:" Search by name, email, org...",value:t,onChange:x=>s(x.target.value)}),y.jsxs("select",{value:r,onChange:x=>i(x.target.value),children:[y.jsx("option",{value:"all",children:"All Roles"}),y.jsx("option",{value:"farmer",children:"Farmers"}),y.jsx("option",{value:"buyer",children:"Buyers"}),y.jsx("option",{value:"verifier",children:"Verifiers"})]}),y.jsx("button",{onClick:()=>o(!0),children:"+ Add User"})]}),a&&y.jsxs("div",{className:"add-user-form",children:[y.jsx("input",{type:"text",placeholder:"Name",value:l.name,onChange:x=>c({...l,name:x.target.value})}),y.jsx("input",{type:"email",placeholder:"Email",value:l.email,onChange:x=>c({...l,email:x.target.value})}),y.jsxs("select",{value:l.role,onChange:x=>c({...l,role:x.target.value}),children:[y.jsx("option",{value:"farmer",children:"Farmer"}),y.jsx("option",{value:"buyer",children:"Buyer"}),y.jsx("option",{value:"verifier",children:"Verifier"})]}),y.jsx("input",{type:"text",placeholder:"Organization",value:l.organization,onChange:x=>c({...l,organization:x.target.value})}),y.jsx("input",{type:"text",placeholder:"Phone",value:l.phone,onChange:x=>c({...l,phone:x.target.value})}),y.jsx("input",{type:"text",placeholder:"Location",value:l.location,onChange:x=>c({...l,location:x.target.value})}),y.jsx("button",{onClick:h,children:"Save User"})]}),y.jsx("div",{className:"user-list",children:v.length===0?y.jsx("p",{children:"No users found"}):v.map(x=>y.jsxs("div",{className:"user-card",children:[y.jsxs("div",{className:"user-header",children:[y.jsx("span",{className:"avatar",children:x.avatar||""}),y.jsxs("div",{children:[y.jsx("h4",{children:x.name||"Unnamed User"}),y.jsx("p",{className:"user-email",children:x.email||"No email"})]})]}),y.jsxs("div",{className:"user-details",children:[y.jsxs("p",{children:[y.jsx("strong",{children:" Organization:"})," ",x.organization||"N/A"]}),y.jsxs("p",{children:[y.jsx("strong",{children:" Location:"})," ",x.location||"N/A"]}),y.jsxs("p",{children:[y.jsx("strong",{children:" Phone:"})," ",x.phone||"N/A"]}),y.jsxs("p",{children:[y.jsx("strong",{children:" Joined:"})," ",x.joinDate||"-"]}),y.jsxs("p",{children:[y.jsx("strong",{children:" Last Active:"})," ",x.lastActive||"-"]})]}),y.jsxs("div",{className:"user-actions",children:[y.jsxs("label",{children:["Status:",y.jsxs("select",{value:x.status||"pending",onChange:w=>m(x.id,w.target.value),children:[y.jsx("option",{value:"active",children:"Active"}),y.jsx("option",{value:"pending",children:"Pending"}),y.jsx("option",{value:"blocked",children:"Blocked"})]})]}),y.jsxs("label",{children:["Role:",y.jsxs("select",{value:x.role||"farmer",onChange:w=>p(x.id,w.target.value),children:[y.jsx("option",{value:"farmer",children:"Farmer"}),y.jsx("option",{value:"buyer",children:"Buyer"}),y.jsx("option",{value:"verifier",children:"Verifier"})]})]})]}),y.jsxs("div",{className:"user-stats",children:[y.jsxs("p",{children:[y.jsx("strong",{children:" Projects:"})," ",x.projects||0]}),y.jsxs("p",{children:[y.jsx("strong",{children:" Credits:"})," ",x.credits||0]})]})]},x.id))})]})}function tVe(){const[n,e]=ve.useState([]),[t,s]=ve.useState([]),[r,i]=ve.useState(""),[a,o]=ve.useState("all"),[l,c]=ve.useState("all"),[h,p]=ve.useState("all"),[m,v]=ve.useState(null);ve.useEffect(()=>{const P=[{id:"TXN-001",type:"credit_purchase",buyer:"James Chen",seller:"Dr. Marina Santos",project:"Mangrove Restoration - Sundarbans",amount:500,pricePerTon:25.5,totalAmount:12750,currency:"USD",status:"completed",date:"2024-01-20",timestamp:"2024-01-20T14:30:00Z",paymentMethod:"Bank Transfer",transactionHash:"0x742d35cc6cd8f9a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4",blockchainNetwork:"Ethereum",verificationStatus:"verified",notes:"Carbon credit purchase for corporate sustainability goals"},{id:"TXN-002",type:"credit_sale",buyer:"Lisa Thompson",seller:"Sarah Williams",project:"Coral Reef Protection Initiative",amount:300,pricePerTon:28.75,totalAmount:8625,currency:"USD",status:"pending",date:"2024-01-19",timestamp:"2024-01-19T16:45:00Z",paymentMethod:"Credit Card",transactionHash:"0x923c45dd7de8f0a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5",blockchainNetwork:"Ethereum",verificationStatus:"pending",notes:"Partial payment received, awaiting full confirmation"},{id:"TXN-003",type:"credit_purchase",buyer:"Green Investment Corp",seller:"Miguel Rodriguez",project:"Blue Carbon Assessment",amount:800,pricePerTon:22,totalAmount:17600,currency:"USD",status:"completed",date:"2024-01-18",timestamp:"2024-01-18T11:20:00Z",paymentMethod:"Wire Transfer",transactionHash:"0x456e78ff9ef0a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7",blockchainNetwork:"Ethereum",verificationStatus:"verified",notes:"Bulk purchase for portfolio diversification"},{id:"TXN-004",type:"credit_sale",buyer:"Eco Investment Partners",seller:"Dr. Marina Santos",project:"Mangrove Restoration - Sundarbans",amount:200,pricePerTon:26.25,totalAmount:5250,currency:"USD",status:"failed",date:"2024-01-17",timestamp:"2024-01-17T09:15:00Z",paymentMethod:"Bank Transfer",transactionHash:null,blockchainNetwork:"Ethereum",verificationStatus:"failed",notes:"Transaction failed due to insufficient funds"},{id:"TXN-005",type:"credit_purchase",buyer:"James Chen",seller:"Sarah Williams",project:"Coral Reef Protection Initiative",amount:150,pricePerTon:30,totalAmount:4500,currency:"USD",status:"processing",date:"2024-01-16",timestamp:"2024-01-16T13:45:00Z",paymentMethod:"Cryptocurrency",transactionHash:"0x789f01aa0bf1a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8",blockchainNetwork:"Ethereum",verificationStatus:"processing",notes:"Cryptocurrency payment in progress"},{id:"TXN-006",type:"platform_fee",buyer:"Platform",seller:"Dr. Marina Santos",project:"Mangrove Restoration - Sundarbans",amount:0,pricePerTon:0,totalAmount:127.5,currency:"USD",status:"completed",date:"2024-01-20",timestamp:"2024-01-20T14:30:00Z",paymentMethod:"Automatic",transactionHash:"0x123a45bb1cf2a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9",blockchainNetwork:"Ethereum",verificationStatus:"verified",notes:"Platform fee (1% of transaction value)"}];e(P),s(P)},[]),ve.useEffect(()=>{let P=n;if(r&&(P=P.filter(U=>U.id.toLowerCase().includes(r.toLowerCase())||U.buyer.toLowerCase().includes(r.toLowerCase())||U.seller.toLowerCase().includes(r.toLowerCase())||U.project.toLowerCase().includes(r.toLowerCase()))),a!=="all"&&(P=P.filter(U=>U.type===a)),l!=="all"&&(P=P.filter(U=>U.status===l)),h!=="all"){const U=new Date,j=new Date;switch(h){case"today":j.setHours(0,0,0,0);break;case"week":j.setDate(U.getDate()-7);break;case"month":j.setMonth(U.getMonth()-1);break;case"year":j.setFullYear(U.getFullYear()-1);break}P=P.filter(O=>new Date(O.date)>=j)}s(P)},[n,r,a,l,h]);const x=P=>{switch(P){case"credit_purchase":return"type-badge purchase";case"credit_sale":return"type-badge sale";case"platform_fee":return"type-badge fee";default:return"type-badge default"}},w=P=>{switch(P){case"completed":return"status-badge verified";case"pending":return"status-badge pending";case"processing":return"status-badge active";case"failed":return"status-badge rejected";default:return"status-badge no-reports"}},T=P=>{switch(P){case"credit_purchase":return"";case"credit_sale":return"";case"platform_fee":return"";default:return""}},E=(P,U)=>new Intl.NumberFormat("en-US",{style:"currency",currency:U}).format(P),C=P=>new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),$=P=>new Date(P).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),R={total:t.length,completed:t.filter(P=>P.status==="completed").length,pending:t.filter(P=>P.status==="pending").length,processing:t.filter(P=>P.status==="processing").length,failed:t.filter(P=>P.status==="failed").length,totalVolume:t.reduce((P,U)=>P+U.totalAmount,0),totalCredits:t.reduce((P,U)=>P+U.amount,0)};return y.jsxs("div",{className:"page-container",children:[y.jsxs("div",{className:"page-header",children:[y.jsx("h1",{className:"page-title",children:" Transactions"}),y.jsx("p",{className:"page-subtitle",children:"Track all carbon credit transactions, payments, and financial records"})]}),y.jsxs("div",{className:"transaction-stats-grid",children:[y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:R.total}),y.jsx("div",{className:"stat-label",children:"Total Transactions"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:R.completed}),y.jsx("div",{className:"stat-label",children:"Completed"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:R.pending}),y.jsx("div",{className:"stat-label",children:"Pending"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:E(R.totalVolume,"USD")}),y.jsx("div",{className:"stat-label",children:"Total Volume"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:R.totalCredits.toLocaleString()}),y.jsx("div",{className:"stat-label",children:"Credits Traded (tons)"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:R.total>0?E(R.totalVolume/R.totalCredits,"USD"):"$0.00"}),y.jsx("div",{className:"stat-label",children:"Avg Price/Ton"})]})]})]}),y.jsxs("div",{className:"transaction-controls",children:[y.jsxs("div",{className:"search-filter",children:[y.jsx("input",{type:"text",placeholder:"Search transactions...",value:r,onChange:P=>i(P.target.value),className:"search-input"}),y.jsxs("select",{value:a,onChange:P=>o(P.target.value),className:"filter-select",children:[y.jsx("option",{value:"all",children:"All Types"}),y.jsx("option",{value:"credit_purchase",children:"Credit Purchase"}),y.jsx("option",{value:"credit_sale",children:"Credit Sale"}),y.jsx("option",{value:"platform_fee",children:"Platform Fee"})]}),y.jsxs("select",{value:l,onChange:P=>c(P.target.value),className:"filter-select",children:[y.jsx("option",{value:"all",children:"All Status"}),y.jsx("option",{value:"completed",children:"Completed"}),y.jsx("option",{value:"pending",children:"Pending"}),y.jsx("option",{value:"processing",children:"Processing"}),y.jsx("option",{value:"failed",children:"Failed"})]}),y.jsxs("select",{value:h,onChange:P=>p(P.target.value),className:"filter-select",children:[y.jsx("option",{value:"all",children:"All Time"}),y.jsx("option",{value:"today",children:"Today"}),y.jsx("option",{value:"week",children:"This Week"}),y.jsx("option",{value:"month",children:"This Month"}),y.jsx("option",{value:"year",children:"This Year"})]})]}),y.jsx("button",{className:"btn-primary",children:" Export Report"})]}),y.jsxs("div",{className:"transactions-content",children:[y.jsxs("div",{className:"transactions-list",children:[y.jsx("div",{className:"list-header",children:y.jsxs("h3",{children:[" Transaction History (",t.length,")"]})}),y.jsxs("div",{className:"transactions-table",children:[y.jsxs("div",{className:"table-header",children:[y.jsx("div",{className:"col-id",children:"ID"}),y.jsx("div",{className:"col-type",children:"Type"}),y.jsx("div",{className:"col-parties",children:"Parties"}),y.jsx("div",{className:"col-project",children:"Project"}),y.jsx("div",{className:"col-amount",children:"Amount"}),y.jsx("div",{className:"col-price",children:"Price/Ton"}),y.jsx("div",{className:"col-total",children:"Total"}),y.jsx("div",{className:"col-status",children:"Status"}),y.jsx("div",{className:"col-date",children:"Date"}),y.jsx("div",{className:"col-actions",children:"Actions"})]}),y.jsx("div",{className:"table-body",children:t.map(P=>y.jsxs("div",{className:`table-row ${m?.id===P.id?"selected":""}`,onClick:()=>v(P),children:[y.jsx("div",{className:"col-id",children:y.jsx("span",{className:"transaction-id",children:P.id})}),y.jsx("div",{className:"col-type",children:y.jsxs("span",{className:`type-badge ${x(P.type)}`,children:[T(P.type)," ",P.type.replace("_"," ")]})}),y.jsx("div",{className:"col-parties",children:y.jsxs("div",{className:"parties-info",children:[y.jsxs("span",{className:"buyer",children:[" ",P.buyer]}),y.jsxs("span",{className:"seller",children:[" ",P.seller]})]})}),y.jsx("div",{className:"col-project",children:y.jsx("span",{className:"project-name",children:P.project})}),y.jsx("div",{className:"col-amount",children:y.jsxs("span",{className:"amount",children:[P.amount.toLocaleString()," tons"]})}),y.jsx("div",{className:"col-price",children:y.jsx("span",{className:"price",children:E(P.pricePerTon,P.currency)})}),y.jsx("div",{className:"col-total",children:y.jsx("span",{className:"total",children:E(P.totalAmount,P.currency)})}),y.jsx("div",{className:"col-status",children:y.jsx("span",{className:w(P.status),children:P.status.charAt(0).toUpperCase()+P.status.slice(1)})}),y.jsx("div",{className:"col-date",children:y.jsx("span",{className:"date",children:C(P.date)})}),y.jsx("div",{className:"col-actions",children:y.jsx("button",{className:"btn-small",onClick:U=>{U.stopPropagation(),v(P)},children:" View"})})]},P.id))})]})]}),m&&y.jsxs("div",{className:"transaction-details-panel",children:[y.jsxs("div",{className:"panel-header",children:[y.jsx("h3",{children:" Transaction Details"}),y.jsx("span",{className:"transaction-id",children:m.id})]}),y.jsxs("div",{className:"transaction-details",children:[y.jsxs("div",{className:"detail-section",children:[y.jsx("h4",{children:" Basic Information"}),y.jsxs("div",{className:"detail-grid",children:[y.jsxs("div",{className:"detail-item",children:[y.jsx("label",{children:"Transaction ID:"}),y.jsx("span",{children:m.id})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("label",{children:"Type:"}),y.jsxs("span",{className:x(m.type),children:[T(m.type)," ",m.type.replace("_"," ")]})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("label",{children:"Status:"}),y.jsx("span",{className:w(m.status),children:m.status.charAt(0).toUpperCase()+m.status.slice(1)})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("label",{children:"Date:"}),y.jsx("span",{children:$(m.timestamp)})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("label",{children:"Buyer:"}),y.jsx("span",{children:m.buyer})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("label",{children:"Seller:"}),y.jsx("span",{children:m.seller})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("label",{children:"Project:"}),y.jsx("span",{children:m.project})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("label",{children:"Payment Method:"}),y.jsx("span",{children:m.paymentMethod})]})]})]}),y.jsxs("div",{className:"detail-section",children:[y.jsx("h4",{children:" Financial Details"}),y.jsxs("div",{className:"financial-grid",children:[y.jsxs("div",{className:"financial-item",children:[y.jsx("label",{children:"Credits Amount:"}),y.jsxs("span",{className:"amount",children:[m.amount.toLocaleString()," tons CO"]})]}),y.jsxs("div",{className:"financial-item",children:[y.jsx("label",{children:"Price per Ton:"}),y.jsx("span",{className:"price",children:E(m.pricePerTon,m.currency)})]}),y.jsxs("div",{className:"financial-item",children:[y.jsx("label",{children:"Total Amount:"}),y.jsx("span",{className:"total",children:E(m.totalAmount,m.currency)})]}),y.jsxs("div",{className:"financial-item",children:[y.jsx("label",{children:"Currency:"}),y.jsx("span",{children:m.currency})]})]})]}),y.jsxs("div",{className:"detail-section",children:[y.jsx("h4",{children:" Blockchain Information"}),y.jsxs("div",{className:"blockchain-info",children:[y.jsxs("div",{className:"blockchain-item",children:[y.jsx("label",{children:"Network:"}),y.jsx("span",{children:m.blockchainNetwork})]}),y.jsxs("div",{className:"blockchain-item",children:[y.jsx("label",{children:"Transaction Hash:"}),y.jsx("span",{className:"hash",children:m.transactionHash?`${m.transactionHash.substring(0,20)}...`:"Not available"})]}),y.jsxs("div",{className:"blockchain-item",children:[y.jsx("label",{children:"Verification Status:"}),y.jsx("span",{className:w(m.verificationStatus),children:m.verificationStatus.charAt(0).toUpperCase()+m.verificationStatus.slice(1)})]})]})]}),y.jsxs("div",{className:"detail-section",children:[y.jsx("h4",{children:" Notes"}),y.jsx("div",{className:"notes-content",children:y.jsx("p",{children:m.notes})})]}),y.jsxs("div",{className:"transaction-actions",children:[y.jsx("button",{className:"btn-primary",children:" Contact Parties"}),y.jsx("button",{className:"btn-secondary",children:" View on Blockchain"}),y.jsx("button",{className:"btn-secondary",children:" Download Receipt"}),m.status==="pending"&&y.jsx("button",{className:"btn-danger",children:" Cancel Transaction"})]})]})]})]})]})}function nVe(){const[n,e]=ve.useState("overview"),[t,s]=ve.useState("month"),[r,i]=ve.useState("all"),[a,o]=ve.useState({});ve.useEffect(()=>{o({overview:{totalProjects:45,totalUsers:156,totalCredits:12500,totalVolume:312500,averagePrice:25,growthRate:15.2,topProjects:[{name:"Mangrove Restoration - Sundarbans",credits:1500,revenue:38250},{name:"Coral Reef Protection Initiative",credits:2e3,revenue:57500},{name:"Seagrass Carbon Sequestration",credits:800,revenue:23e3},{name:"Blue Carbon Assessment",credits:600,revenue:13200}],monthlyTrends:[{month:"Jan",credits:1200,revenue:3e4},{month:"Feb",credits:1500,revenue:37500},{month:"Mar",credits:1800,revenue:45e3},{month:"Apr",credits:2100,revenue:52500},{month:"May",credits:1900,revenue:47500},{month:"Jun",credits:2200,revenue:55e3}]},financial:{totalRevenue:312500,totalExpenses:45e3,netProfit:267500,platformFees:3125,transactionFees:1875,operationalCosts:4e4,revenueByMonth:[{month:"Jan",revenue:3e4,expenses:3500},{month:"Feb",revenue:37500,expenses:4e3},{month:"Mar",revenue:45e3,expenses:4500},{month:"Apr",revenue:52500,expenses:5e3},{month:"May",revenue:47500,expenses:4500},{month:"Jun",revenue:55e3,expenses:5500}],topEarners:[{name:"Dr. Marina Santos",earnings:38250,projects:5},{name:"Sarah Williams",earnings:57500,projects:8},{name:"Miguel Rodriguez",earnings:13200,projects:2}]},environmental:{totalCarbonSequestration:12500,mangroveCredits:4500,seagrassCredits:3200,coralCredits:4800,averageSequestrationRate:2.5,environmentalImpact:{co2Reduction:12500,equivalentTrees:520833,equivalentCars:2708,equivalentFlights:156},projectTypes:[{type:"Mangrove Restoration",credits:4500,percentage:36},{type:"Coral Reef Conservation",credits:4800,percentage:38.4},{type:"Seagrass Restoration",credits:3200,percentage:25.6}]},user:{totalUsers:156,activeUsers:142,newUsers:23,userRetention:91,usersByRole:[{role:"Farmers",count:89,percentage:57.1},{role:"Buyers",count:45,percentage:28.8},{role:"Admins",count:22,percentage:14.1}],userActivity:[{period:"Week 1",active:120,new:5},{period:"Week 2",active:135,new:8},{period:"Week 3",active:142,new:6},{period:"Week 4",active:138,new:4}],topActiveUsers:[{name:"Dr. Marina Santos",activity:95,projects:5},{name:"Sarah Williams",activity:92,projects:8},{name:"James Chen",activity:88,purchases:12}]}})},[]);const l=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),c=w=>new Intl.NumberFormat("en-US").format(w),h=()=>{const w=a.overview;return w?y.jsxs("div",{className:"report-content",children:[y.jsxs("div",{className:"report-stats-grid",children:[y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:w.totalProjects}),y.jsx("div",{className:"stat-label",children:"Total Projects"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:w.totalUsers}),y.jsx("div",{className:"stat-label",children:"Total Users"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:c(w.totalCredits)}),y.jsx("div",{className:"stat-label",children:"Carbon Credits (tons)"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:l(w.totalVolume)}),y.jsx("div",{className:"stat-label",children:"Total Volume"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:l(w.averagePrice)}),y.jsx("div",{className:"stat-label",children:"Avg Price/Ton"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsxs("div",{className:"stat-number",children:[w.growthRate,"%"]}),y.jsx("div",{className:"stat-label",children:"Growth Rate"})]})]})]}),y.jsxs("div",{className:"report-charts",children:[y.jsxs("div",{className:"chart-section",children:[y.jsx("h3",{children:" Monthly Trends"}),y.jsxs("div",{className:"chart-container",children:[y.jsx("div",{className:"chart-bars",children:w.monthlyTrends.map((T,E)=>y.jsxs("div",{className:"chart-bar-group",children:[y.jsx("div",{className:"chart-bar",children:y.jsx("div",{className:"bar credits-bar",style:{height:`${T.credits/2500*100}%`}})}),y.jsx("div",{className:"chart-bar",children:y.jsx("div",{className:"bar revenue-bar",style:{height:`${T.revenue/6e4*100}%`}})}),y.jsx("div",{className:"chart-label",children:T.month})]},E))}),y.jsxs("div",{className:"chart-legend",children:[y.jsxs("div",{className:"legend-item",children:[y.jsx("div",{className:"legend-color credits-color"}),y.jsx("span",{children:"Credits (tons)"})]}),y.jsxs("div",{className:"legend-item",children:[y.jsx("div",{className:"legend-color revenue-color"}),y.jsx("span",{children:"Revenue ($)"})]})]})]})]}),y.jsxs("div",{className:"chart-section",children:[y.jsx("h3",{children:" Top Performing Projects"}),y.jsx("div",{className:"top-projects-list",children:w.topProjects.map((T,E)=>y.jsxs("div",{className:"project-item",children:[y.jsxs("div",{className:"project-rank",children:["#",E+1]}),y.jsxs("div",{className:"project-info",children:[y.jsx("h4",{children:T.name}),y.jsxs("div",{className:"project-stats",children:[y.jsxs("span",{className:"credits",children:[c(T.credits)," tons"]}),y.jsx("span",{className:"revenue",children:l(T.revenue)})]})]}),y.jsx("div",{className:"project-chart",children:y.jsx("div",{className:"project-bar",style:{width:`${T.credits/2e3*100}%`}})})]},E))})]})]})]}):null},p=()=>{const w=a.financial;return w?y.jsxs("div",{className:"report-content",children:[y.jsxs("div",{className:"financial-summary",children:[y.jsxs("div",{className:"summary-card revenue",children:[y.jsx("h3",{children:" Total Revenue"}),y.jsx("div",{className:"summary-amount",children:l(w.totalRevenue)})]}),y.jsxs("div",{className:"summary-card expenses",children:[y.jsx("h3",{children:" Total Expenses"}),y.jsx("div",{className:"summary-amount",children:l(w.totalExpenses)})]}),y.jsxs("div",{className:"summary-card profit",children:[y.jsx("h3",{children:" Net Profit"}),y.jsx("div",{className:"summary-amount",children:l(w.netProfit)})]})]}),y.jsxs("div",{className:"financial-breakdown",children:[y.jsxs("div",{className:"breakdown-section",children:[y.jsx("h3",{children:" Revenue Breakdown"}),y.jsxs("div",{className:"breakdown-items",children:[y.jsxs("div",{className:"breakdown-item",children:[y.jsx("span",{className:"label",children:"Platform Fees (1%):"}),y.jsx("span",{className:"amount",children:l(w.platformFees)})]}),y.jsxs("div",{className:"breakdown-item",children:[y.jsx("span",{className:"label",children:"Transaction Fees:"}),y.jsx("span",{className:"amount",children:l(w.transactionFees)})]}),y.jsxs("div",{className:"breakdown-item",children:[y.jsx("span",{className:"label",children:"Operational Costs:"}),y.jsx("span",{className:"amount",children:l(w.operationalCosts)})]})]})]}),y.jsxs("div",{className:"breakdown-section",children:[y.jsx("h3",{children:" Monthly Revenue vs Expenses"}),y.jsx("div",{className:"revenue-chart",children:w.revenueByMonth.map((T,E)=>y.jsxs("div",{className:"month-item",children:[y.jsx("div",{className:"month-label",children:T.month}),y.jsxs("div",{className:"month-bars",children:[y.jsxs("div",{className:"revenue-bar",children:[y.jsx("div",{className:"bar",style:{height:`${T.revenue/6e4*100}%`}}),y.jsx("span",{className:"bar-label",children:l(T.revenue)})]}),y.jsxs("div",{className:"expense-bar",children:[y.jsx("div",{className:"bar",style:{height:`${T.expenses/6e3*100}%`}}),y.jsx("span",{className:"bar-label",children:l(T.expenses)})]})]})]},E))})]}),y.jsxs("div",{className:"breakdown-section",children:[y.jsx("h3",{children:" Top Earners"}),y.jsx("div",{className:"earners-list",children:w.topEarners.map((T,E)=>y.jsxs("div",{className:"earner-item",children:[y.jsxs("div",{className:"earner-rank",children:["#",E+1]}),y.jsxs("div",{className:"earner-info",children:[y.jsx("h4",{children:T.name}),y.jsxs("p",{children:[T.projects," projects"]})]}),y.jsx("div",{className:"earner-amount",children:l(T.earnings)})]},E))})]})]})]}):null},m=()=>{const w=a.environmental;return w?y.jsxs("div",{className:"report-content",children:[y.jsxs("div",{className:"environmental-impact",children:[y.jsx("h3",{children:" Environmental Impact Summary"}),y.jsxs("div",{className:"impact-grid",children:[y.jsxs("div",{className:"impact-card",children:[y.jsx("div",{className:"impact-icon",children:""}),y.jsxs("div",{className:"impact-content",children:[y.jsx("div",{className:"impact-number",children:c(w.environmentalImpact.co2Reduction)}),y.jsx("div",{className:"impact-label",children:"Tons CO Sequestered"})]})]}),y.jsxs("div",{className:"impact-card",children:[y.jsx("div",{className:"impact-icon",children:""}),y.jsxs("div",{className:"impact-content",children:[y.jsx("div",{className:"impact-number",children:c(w.environmentalImpact.equivalentTrees)}),y.jsx("div",{className:"impact-label",children:"Equivalent Trees"})]})]}),y.jsxs("div",{className:"impact-card",children:[y.jsx("div",{className:"impact-icon",children:""}),y.jsxs("div",{className:"impact-content",children:[y.jsx("div",{className:"impact-number",children:c(w.environmentalImpact.equivalentCars)}),y.jsx("div",{className:"impact-label",children:"Cars Off Road (yearly)"})]})]}),y.jsxs("div",{className:"impact-card",children:[y.jsx("div",{className:"impact-icon",children:""}),y.jsxs("div",{className:"impact-content",children:[y.jsx("div",{className:"impact-number",children:c(w.environmentalImpact.equivalentFlights)}),y.jsx("div",{className:"impact-label",children:"Flights Offset"})]})]})]})]}),y.jsxs("div",{className:"credits-breakdown",children:[y.jsxs("div",{className:"breakdown-section",children:[y.jsx("h3",{children:" Credits by Ecosystem Type"}),y.jsx("div",{className:"ecosystem-chart",children:w.projectTypes.map((T,E)=>y.jsxs("div",{className:"ecosystem-item",children:[y.jsxs("div",{className:"ecosystem-info",children:[y.jsx("h4",{children:T.type}),y.jsxs("div",{className:"ecosystem-stats",children:[y.jsxs("span",{className:"credits",children:[c(T.credits)," tons"]}),y.jsxs("span",{className:"percentage",children:[T.percentage,"%"]})]})]}),y.jsx("div",{className:"ecosystem-bar",children:y.jsx("div",{className:"bar",style:{width:`${T.percentage}%`}})})]},E))})]}),y.jsxs("div",{className:"breakdown-section",children:[y.jsx("h3",{children:" Carbon Sequestration Breakdown"}),y.jsxs("div",{className:"sequestration-grid",children:[y.jsxs("div",{className:"seq-item",children:[y.jsx("div",{className:"seq-icon",children:""}),y.jsxs("div",{className:"seq-content",children:[y.jsx("div",{className:"seq-number",children:c(w.mangroveCredits)}),y.jsx("div",{className:"seq-label",children:"Mangrove Credits"})]})]}),y.jsxs("div",{className:"seq-item",children:[y.jsx("div",{className:"seq-icon",children:""}),y.jsxs("div",{className:"seq-content",children:[y.jsx("div",{className:"seq-number",children:c(w.seagrassCredits)}),y.jsx("div",{className:"seq-label",children:"Seagrass Credits"})]})]}),y.jsxs("div",{className:"seq-item",children:[y.jsx("div",{className:"seq-icon",children:""}),y.jsxs("div",{className:"seq-content",children:[y.jsx("div",{className:"seq-number",children:c(w.coralCredits)}),y.jsx("div",{className:"seq-label",children:"Coral Credits"})]})]})]})]})]})]}):null},v=()=>{const w=a.user;return w?y.jsxs("div",{className:"report-content",children:[y.jsxs("div",{className:"user-stats-grid",children:[y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:w.totalUsers}),y.jsx("div",{className:"stat-label",children:"Total Users"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:w.activeUsers}),y.jsx("div",{className:"stat-label",children:"Active Users"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsx("div",{className:"stat-number",children:w.newUsers}),y.jsx("div",{className:"stat-label",children:"New Users"})]})]}),y.jsxs("div",{className:"stat-card",children:[y.jsx("div",{className:"stat-icon",children:""}),y.jsxs("div",{className:"stat-content",children:[y.jsxs("div",{className:"stat-number",children:[w.userRetention,"%"]}),y.jsx("div",{className:"stat-label",children:"Retention Rate"})]})]})]}),y.jsxs("div",{className:"user-breakdown",children:[y.jsxs("div",{className:"breakdown-section",children:[y.jsx("h3",{children:" Users by Role"}),y.jsx("div",{className:"role-chart",children:w.usersByRole.map((T,E)=>y.jsxs("div",{className:"role-item",children:[y.jsxs("div",{className:"role-info",children:[y.jsx("h4",{children:T.role}),y.jsxs("div",{className:"role-stats",children:[y.jsxs("span",{className:"count",children:[T.count," users"]}),y.jsxs("span",{className:"percentage",children:[T.percentage,"%"]})]})]}),y.jsx("div",{className:"role-bar",children:y.jsx("div",{className:"bar",style:{width:`${T.percentage}%`}})})]},E))})]}),y.jsxs("div",{className:"breakdown-section",children:[y.jsx("h3",{children:" Weekly User Activity"}),y.jsx("div",{className:"activity-chart",children:w.userActivity.map((T,E)=>y.jsxs("div",{className:"week-item",children:[y.jsx("div",{className:"week-label",children:T.period}),y.jsxs("div",{className:"week-bars",children:[y.jsxs("div",{className:"active-bar",children:[y.jsx("div",{className:"bar",style:{height:`${T.active/150*100}%`}}),y.jsxs("span",{className:"bar-label",children:[T.active," active"]})]}),y.jsxs("div",{className:"new-bar",children:[y.jsx("div",{className:"bar",style:{height:`${T.new/10*100}%`}}),y.jsxs("span",{className:"bar-label",children:[T.new," new"]})]})]})]},E))})]}),y.jsxs("div",{className:"breakdown-section",children:[y.jsx("h3",{children:" Most Active Users"}),y.jsx("div",{className:"active-users-list",children:w.topActiveUsers.map((T,E)=>y.jsxs("div",{className:"user-item",children:[y.jsxs("div",{className:"user-rank",children:["#",E+1]}),y.jsxs("div",{className:"user-info",children:[y.jsx("h4",{children:T.name}),y.jsx("p",{children:T.projects?`${T.projects} projects`:`${T.purchases} purchases`})]}),y.jsxs("div",{className:"user-activity",children:[T.activity,"% active"]})]},E))})]})]})]}):null},x=()=>{switch(n){case"overview":return h();case"financial":return p();case"environmental":return m();case"user":return v();default:return h()}};return y.jsxs("div",{className:"page-container",children:[y.jsxs("div",{className:"page-header",children:[y.jsx("h1",{className:"page-title",children:" Reports & Analytics"}),y.jsx("p",{className:"page-subtitle",children:"Comprehensive analytics and reporting for platform performance and environmental impact"})]}),y.jsxs("div",{className:"report-controls",children:[y.jsxs("div",{className:"control-group",children:[y.jsx("label",{children:"Report Type:"}),y.jsxs("select",{value:n,onChange:w=>e(w.target.value),className:"control-select",children:[y.jsx("option",{value:"overview",children:" Overview"}),y.jsx("option",{value:"financial",children:" Financial"}),y.jsx("option",{value:"environmental",children:" Environmental"}),y.jsx("option",{value:"user",children:" User Analytics"})]})]}),y.jsxs("div",{className:"control-group",children:[y.jsx("label",{children:"Date Range:"}),y.jsxs("select",{value:t,onChange:w=>s(w.target.value),className:"control-select",children:[y.jsx("option",{value:"week",children:"This Week"}),y.jsx("option",{value:"month",children:"This Month"}),y.jsx("option",{value:"quarter",children:"This Quarter"}),y.jsx("option",{value:"year",children:"This Year"}),y.jsx("option",{value:"all",children:"All Time"})]})]}),y.jsxs("div",{className:"control-group",children:[y.jsx("label",{children:"Project:"}),y.jsxs("select",{value:r,onChange:w=>i(w.target.value),className:"control-select",children:[y.jsx("option",{value:"all",children:"All Projects"}),y.jsx("option",{value:"mangrove",children:"Mangrove Projects"}),y.jsx("option",{value:"seagrass",children:"Seagrass Projects"}),y.jsx("option",{value:"coral",children:"Coral Projects"})]})]}),y.jsxs("div",{className:"control-actions",children:[y.jsx("button",{className:"btn-primary",children:" Export PDF"}),y.jsx("button",{className:"btn-secondary",children:" Export Excel"}),y.jsx("button",{className:"btn-secondary",children:" Refresh Data"})]})]}),y.jsx("div",{className:"reports-content",children:x()})]})}function sVe(){const n=Qo(),e=n.pathname==="/login"||n.pathname==="/signup"||n.pathname==="/"||n.pathname==="/dashboard"||n.pathname==="/about"||n.pathname==="/contact";return y.jsxs(y.Fragment,{children:[!e&&y.jsx(wY,{}),y.jsxs(BZ,{children:[y.jsx(Ds,{path:"/",element:y.jsx(TY,{})}),y.jsx(Ds,{path:"/dashboard",element:y.jsx(SY,{})}),y.jsx(Ds,{path:"/login",element:y.jsx(Gie,{})}),y.jsx(Ds,{path:"/signup",element:y.jsx(Wie,{})}),y.jsx(Ds,{path:"/farmer",element:y.jsx(qie,{})}),y.jsx(Ds,{path:"/buyer",element:y.jsx(bY,{})}),y.jsx(Ds,{path:"/admin",element:y.jsx(Xie,{})}),y.jsx(Ds,{path:"/profile",element:y.jsx(nM,{})}),y.jsx(Ds,{path:"/profile-form",element:y.jsx(Zie,{})}),y.jsx(Ds,{path:"/profile-display",element:y.jsx(nM,{})}),y.jsx(Ds,{path:"/add-project",element:y.jsx(vae,{})}),y.jsx(Ds,{path:"/mrv-dashboard-farmer",element:y.jsx(bae,{})}),y.jsx(Ds,{path:"/marketplace",element:y.jsx(xae,{})}),y.jsx(Ds,{path:"/mrv-dashboard-buyer",element:y.jsx(_ae,{})}),y.jsx(Ds,{path:"/contact",element:y.jsx(wae,{})}),y.jsx(Ds,{path:"/about",element:y.jsx(Tae,{})}),y.jsx(Ds,{path:"/project-verification",element:y.jsx(Jze,{})}),y.jsx(Ds,{path:"/user-management",element:y.jsx(eVe,{})}),y.jsx(Ds,{path:"/transactions",element:y.jsx(tVe,{})}),y.jsx(Ds,{path:"/reports",element:y.jsx(nVe,{})})]})]})}function rVe(){return y.jsx(sVe,{})}(async()=>{try{const n=await iO(()=>import("./index-CbS6xSDT.js").then(t=>t.i),[]),e=await iO(()=>import("./browser-GzjprDD4.js").then(t=>t.b),[]);window.Buffer=n.Buffer||n.default,window.process=e,ZX.createRoot(document.getElementById("root")).render(y.jsx(ve.StrictMode,{children:y.jsx(cY,{basename:"/",children:y.jsx(rVe,{})})}))}catch(n){console.error("Failed to load polyfills and render application:",n)}})();export{yC as g};
