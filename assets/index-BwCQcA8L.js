function Ore(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const Mre="modulepreload",Fre=function(n){return"/"+n},HO={},WO=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");s=l(t.map(c=>{if(c=Fre(c),c in HO)return;HO[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":Mre,u||(p.as="script"),p.crossOrigin="",p.href=c,o&&p.setAttribute("nonce",o),document.head.appendChild(p),u)return new Promise((x,y)=>{p.addEventListener("load",x),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};var bw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ku(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function a7(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var pN={exports:{}},ry={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qO;function Bre(){if(qO)return ry;qO=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:n,type:r,key:a,ref:s!==void 0?s:null,props:i}}return ry.Fragment=e,ry.jsx=t,ry.jsxs=t,ry}var KO;function zre(){return KO||(KO=1,pN.exports=Bre()),pN.exports}var _=zre(),mN={exports:{}},gn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XO;function jre(){if(XO)return gn;XO=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function p(Q){return Q===null||typeof Q!="object"?null:(Q=d&&Q[d]||Q["@@iterator"],typeof Q=="function"?Q:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,v={};function b(Q,z,D){this.props=Q,this.context=z,this.refs=v,this.updater=D||x}b.prototype.isReactComponent={},b.prototype.setState=function(Q,z){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,z,"setState")},b.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function S(){}S.prototype=b.prototype;function T(Q,z,D){this.props=Q,this.context=z,this.refs=v,this.updater=D||x}var C=T.prototype=new S;C.constructor=T,y(C,b.prototype),C.isPureReactComponent=!0;var I=Array.isArray,$={H:null,A:null,T:null,S:null,V:null},q=Object.prototype.hasOwnProperty;function U(Q,z,D,X,re,W){return D=W.ref,{$$typeof:n,type:Q,key:z,ref:D!==void 0?D:null,props:W}}function F(Q,z){return U(Q.type,z,void 0,void 0,void 0,Q.props)}function G(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===n}function V(Q){var z={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(D){return z[D]})}var O=/\/+/g;function K(Q,z){return typeof Q=="object"&&Q!==null&&Q.key!=null?V(""+Q.key):z.toString(36)}function P(){}function N(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(P,P):(Q.status="pending",Q.then(function(z){Q.status==="pending"&&(Q.status="fulfilled",Q.value=z)},function(z){Q.status==="pending"&&(Q.status="rejected",Q.reason=z)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function M(Q,z,D,X,re){var W=typeof Q;(W==="undefined"||W==="boolean")&&(Q=null);var ae=!1;if(Q===null)ae=!0;else switch(W){case"bigint":case"string":case"number":ae=!0;break;case"object":switch(Q.$$typeof){case n:case e:ae=!0;break;case u:return ae=Q._init,M(ae(Q._payload),z,D,X,re)}}if(ae)return re=re(Q),ae=X===""?"."+K(Q,0):X,I(re)?(D="",ae!=null&&(D=ae.replace(O,"$&/")+"/"),M(re,z,D,"",function(ve){return ve})):re!=null&&(G(re)&&(re=F(re,D+(re.key==null||Q&&Q.key===re.key?"":(""+re.key).replace(O,"$&/")+"/")+ae)),z.push(re)),1;ae=0;var pe=X===""?".":X+":";if(I(Q))for(var de=0;de<Q.length;de++)X=Q[de],W=pe+K(X,de),ae+=M(X,z,D,W,re);else if(de=p(Q),typeof de=="function")for(Q=de.call(Q),de=0;!(X=Q.next()).done;)X=X.value,W=pe+K(X,de++),ae+=M(X,z,D,W,re);else if(W==="object"){if(typeof Q.then=="function")return M(N(Q),z,D,X,re);throw z=String(Q),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return ae}function B(Q,z,D){if(Q==null)return Q;var X=[],re=0;return M(Q,X,"","",function(W){return z.call(D,W,re++)}),X}function Y(Q){if(Q._status===-1){var z=Q._result;z=z(),z.then(function(D){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=D)},function(D){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=D)}),Q._status===-1&&(Q._status=0,Q._result=z)}if(Q._status===1)return Q._result.default;throw Q._result}var Z=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)};function ne(){}return gn.Children={map:B,forEach:function(Q,z,D){B(Q,function(){z.apply(this,arguments)},D)},count:function(Q){var z=0;return B(Q,function(){z++}),z},toArray:function(Q){return B(Q,function(z){return z})||[]},only:function(Q){if(!G(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},gn.Component=b,gn.Fragment=t,gn.Profiler=s,gn.PureComponent=T,gn.StrictMode=r,gn.Suspense=l,gn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,gn.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return $.H.useMemoCache(Q)}},gn.cache=function(Q){return function(){return Q.apply(null,arguments)}},gn.cloneElement=function(Q,z,D){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var X=y({},Q.props),re=Q.key,W=void 0;if(z!=null)for(ae in z.ref!==void 0&&(W=void 0),z.key!==void 0&&(re=""+z.key),z)!q.call(z,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&z.ref===void 0||(X[ae]=z[ae]);var ae=arguments.length-2;if(ae===1)X.children=D;else if(1<ae){for(var pe=Array(ae),de=0;de<ae;de++)pe[de]=arguments[de+2];X.children=pe}return U(Q.type,re,void 0,void 0,W,X)},gn.createContext=function(Q){return Q={$$typeof:a,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:i,_context:Q},Q},gn.createElement=function(Q,z,D){var X,re={},W=null;if(z!=null)for(X in z.key!==void 0&&(W=""+z.key),z)q.call(z,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(re[X]=z[X]);var ae=arguments.length-2;if(ae===1)re.children=D;else if(1<ae){for(var pe=Array(ae),de=0;de<ae;de++)pe[de]=arguments[de+2];re.children=pe}if(Q&&Q.defaultProps)for(X in ae=Q.defaultProps,ae)re[X]===void 0&&(re[X]=ae[X]);return U(Q,W,void 0,void 0,null,re)},gn.createRef=function(){return{current:null}},gn.forwardRef=function(Q){return{$$typeof:o,render:Q}},gn.isValidElement=G,gn.lazy=function(Q){return{$$typeof:u,_payload:{_status:-1,_result:Q},_init:Y}},gn.memo=function(Q,z){return{$$typeof:c,type:Q,compare:z===void 0?null:z}},gn.startTransition=function(Q){var z=$.T,D={};$.T=D;try{var X=Q(),re=$.S;re!==null&&re(D,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(ne,Z)}catch(W){Z(W)}finally{$.T=z}},gn.unstable_useCacheRefresh=function(){return $.H.useCacheRefresh()},gn.use=function(Q){return $.H.use(Q)},gn.useActionState=function(Q,z,D){return $.H.useActionState(Q,z,D)},gn.useCallback=function(Q,z){return $.H.useCallback(Q,z)},gn.useContext=function(Q){return $.H.useContext(Q)},gn.useDebugValue=function(){},gn.useDeferredValue=function(Q,z){return $.H.useDeferredValue(Q,z)},gn.useEffect=function(Q,z,D){var X=$.H;if(typeof D=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(Q,z)},gn.useId=function(){return $.H.useId()},gn.useImperativeHandle=function(Q,z,D){return $.H.useImperativeHandle(Q,z,D)},gn.useInsertionEffect=function(Q,z){return $.H.useInsertionEffect(Q,z)},gn.useLayoutEffect=function(Q,z){return $.H.useLayoutEffect(Q,z)},gn.useMemo=function(Q,z){return $.H.useMemo(Q,z)},gn.useOptimistic=function(Q,z){return $.H.useOptimistic(Q,z)},gn.useReducer=function(Q,z,D){return $.H.useReducer(Q,z,D)},gn.useRef=function(Q){return $.H.useRef(Q)},gn.useState=function(Q){return $.H.useState(Q)},gn.useSyncExternalStore=function(Q,z,D){return $.H.useSyncExternalStore(Q,z,D)},gn.useTransition=function(){return $.H.useTransition()},gn.version="19.1.1",gn}var YO;function j3(){return YO||(YO=1,mN.exports=jre()),mN.exports}var Se=j3(),gN={exports:{}},sy={},xN={exports:{}},yN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZO;function Vre(){return ZO||(ZO=1,(function(n){function e(B,Y){var Z=B.length;B.push(Y);e:for(;0<Z;){var ne=Z-1>>>1,Q=B[ne];if(0<s(Q,Y))B[ne]=Y,B[Z]=Q,Z=ne;else break e}}function t(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var Y=B[0],Z=B.pop();if(Z!==Y){B[0]=Z;e:for(var ne=0,Q=B.length,z=Q>>>1;ne<z;){var D=2*(ne+1)-1,X=B[D],re=D+1,W=B[re];if(0>s(X,Z))re<Q&&0>s(W,X)?(B[ne]=W,B[re]=Z,ne=re):(B[ne]=X,B[D]=Z,ne=D);else if(re<Q&&0>s(W,Z))B[ne]=W,B[re]=Z,ne=re;else break e}}return Y}function s(B,Y){var Z=B.sortIndex-Y.sortIndex;return Z!==0?Z:B.id-Y.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,p=3,x=!1,y=!1,v=!1,b=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function I(B){for(var Y=t(c);Y!==null;){if(Y.callback===null)r(c);else if(Y.startTime<=B)r(c),Y.sortIndex=Y.expirationTime,e(l,Y);else break;Y=t(c)}}function $(B){if(v=!1,I(B),!y)if(t(l)!==null)y=!0,q||(q=!0,K());else{var Y=t(c);Y!==null&&M($,Y.startTime-B)}}var q=!1,U=-1,F=5,G=-1;function V(){return b?!0:!(n.unstable_now()-G<F)}function O(){if(b=!1,q){var B=n.unstable_now();G=B;var Y=!0;try{e:{y=!1,v&&(v=!1,T(U),U=-1),x=!0;var Z=p;try{t:{for(I(B),d=t(l);d!==null&&!(d.expirationTime>B&&V());){var ne=d.callback;if(typeof ne=="function"){d.callback=null,p=d.priorityLevel;var Q=ne(d.expirationTime<=B);if(B=n.unstable_now(),typeof Q=="function"){d.callback=Q,I(B),Y=!0;break t}d===t(l)&&r(l),I(B)}else r(l);d=t(l)}if(d!==null)Y=!0;else{var z=t(c);z!==null&&M($,z.startTime-B),Y=!1}}break e}finally{d=null,p=Z,x=!1}Y=void 0}}finally{Y?K():q=!1}}}var K;if(typeof C=="function")K=function(){C(O)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,N=P.port2;P.port1.onmessage=O,K=function(){N.postMessage(null)}}else K=function(){S(O,0)};function M(B,Y){U=S(function(){B(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_next=function(B){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var Z=p;p=Y;try{return B()}finally{p=Z}},n.unstable_requestPaint=function(){b=!0},n.unstable_runWithPriority=function(B,Y){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Z=p;p=B;try{return Y()}finally{p=Z}},n.unstable_scheduleCallback=function(B,Y,Z){var ne=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ne+Z:ne):Z=ne,B){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=Z+Q,B={id:u++,callback:Y,priorityLevel:B,startTime:Z,expirationTime:Q,sortIndex:-1},Z>ne?(B.sortIndex=Z,e(c,B),t(l)===null&&B===t(c)&&(v?(T(U),U=-1):v=!0,M($,Z-ne))):(B.sortIndex=Q,e(l,B),y||x||(y=!0,q||(q=!0,K()))),B},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(B){var Y=p;return function(){var Z=p;p=Y;try{return B.apply(this,arguments)}finally{p=Z}}}})(yN)),yN}var QO;function Ure(){return QO||(QO=1,xN.exports=Vre()),xN.exports}var bN={exports:{}},ma={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JO;function Gre(){if(JO)return ma;JO=1;var n=j3();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return ma.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,ma.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return i(l,c,null,u)},ma.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},ma.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},ma.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},ma.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),p=typeof c.integrity=="string"?c.integrity:void 0,x=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:p,fetchPriority:x}):u==="script"&&r.d.X(l,{crossOrigin:d,integrity:p,fetchPriority:x,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},ma.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},ma.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},ma.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},ma.requestFormReset=function(l){r.d.r(l)},ma.unstable_batchedUpdates=function(l,c){return l(c)},ma.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},ma.useFormStatus=function(){return a.H.useHostTransitionStatus()},ma.version="19.1.1",ma}var eM;function Hre(){if(eM)return bN.exports;eM=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),bN.exports=Gre(),bN.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tM;function Wre(){if(tM)return sy;tM=1;var n=Ure(),e=j3(),t=Hre();function r(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function i(h){var f=h,g=h;if(h.alternate)for(;f.return;)f=f.return;else{h=f;do f=h,(f.flags&4098)!==0&&(g=f.return),h=f.return;while(h)}return f.tag===3?g:null}function a(h){if(h.tag===13){var f=h.memoizedState;if(f===null&&(h=h.alternate,h!==null&&(f=h.memoizedState)),f!==null)return f.dehydrated}return null}function o(h){if(i(h)!==h)throw Error(r(188))}function l(h){var f=h.alternate;if(!f){if(f=i(h),f===null)throw Error(r(188));return f!==h?null:h}for(var g=h,E=f;;){var R=g.return;if(R===null)break;var j=R.alternate;if(j===null){if(E=R.return,E!==null){g=E;continue}break}if(R.child===j.child){for(j=R.child;j;){if(j===g)return o(R),h;if(j===E)return o(R),f;j=j.sibling}throw Error(r(188))}if(g.return!==E.return)g=R,E=j;else{for(var ie=!1,le=R.child;le;){if(le===g){ie=!0,g=R,E=j;break}if(le===E){ie=!0,E=R,g=j;break}le=le.sibling}if(!ie){for(le=j.child;le;){if(le===g){ie=!0,g=j,E=R;break}if(le===E){ie=!0,E=j,g=R;break}le=le.sibling}if(!ie)throw Error(r(189))}}if(g.alternate!==E)throw Error(r(190))}if(g.tag!==3)throw Error(r(188));return g.stateNode.current===g?h:f}function c(h){var f=h.tag;if(f===5||f===26||f===27||f===6)return h;for(h=h.child;h!==null;){if(f=c(h),f!==null)return f;h=h.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),T=Symbol.for("react.consumer"),C=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function K(h){return h===null||typeof h!="object"?null:(h=O&&h[O]||h["@@iterator"],typeof h=="function"?h:null)}var P=Symbol.for("react.client.reference");function N(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===P?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case y:return"Fragment";case b:return"Profiler";case v:return"StrictMode";case $:return"Suspense";case q:return"SuspenseList";case G:return"Activity"}if(typeof h=="object")switch(h.$$typeof){case x:return"Portal";case C:return(h.displayName||"Context")+".Provider";case T:return(h._context.displayName||"Context")+".Consumer";case I:var f=h.render;return h=h.displayName,h||(h=f.displayName||f.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case U:return f=h.displayName||null,f!==null?f:N(h.type)||"Memo";case F:f=h._payload,h=h._init;try{return N(h(f))}catch{}}return null}var M=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},ne=[],Q=-1;function z(h){return{current:h}}function D(h){0>Q||(h.current=ne[Q],ne[Q]=null,Q--)}function X(h,f){Q++,ne[Q]=h.current,h.current=f}var re=z(null),W=z(null),ae=z(null),pe=z(null);function de(h,f){switch(X(ae,f),X(W,h),X(re,null),f.nodeType){case 9:case 11:h=(h=f.documentElement)&&(h=h.namespaceURI)?bO(h):0;break;default:if(h=f.tagName,f=f.namespaceURI)f=bO(f),h=vO(f,h);else switch(h){case"svg":h=1;break;case"math":h=2;break;default:h=0}}D(re),X(re,h)}function ve(){D(re),D(W),D(ae)}function Ve(h){h.memoizedState!==null&&X(pe,h);var f=re.current,g=vO(f,h.type);f!==g&&(X(W,h),X(re,g))}function ze(h){W.current===h&&(D(re),D(W)),pe.current===h&&(D(pe),Qx._currentValue=Z)}var Ge=Object.prototype.hasOwnProperty,at=n.unstable_scheduleCallback,We=n.unstable_cancelCallback,nt=n.unstable_shouldYield,Nt=n.unstable_requestPaint,ct=n.unstable_now,xt=n.unstable_getCurrentPriorityLevel,en=n.unstable_ImmediatePriority,ht=n.unstable_UserBlockingPriority,St=n.unstable_NormalPriority,an=n.unstable_LowPriority,Ot=n.unstable_IdlePriority,Mt=n.log,Wn=n.unstable_setDisableYieldValue,It=null,Tt=null;function nr(h){if(typeof Mt=="function"&&Wn(h),Tt&&typeof Tt.setStrictMode=="function")try{Tt.setStrictMode(It,h)}catch{}}var Bt=Math.clz32?Math.clz32:xn,Cn=Math.log,Br=Math.LN2;function xn(h){return h>>>=0,h===0?32:31-(Cn(h)/Br|0)|0}var tn=256,Wr=4194304;function rn(h){var f=h&42;if(f!==0)return f;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function hn(h,f,g){var E=h.pendingLanes;if(E===0)return 0;var R=0,j=h.suspendedLanes,ie=h.pingedLanes;h=h.warmLanes;var le=E&134217727;return le!==0?(E=le&~j,E!==0?R=rn(E):(ie&=le,ie!==0?R=rn(ie):g||(g=le&~h,g!==0&&(R=rn(g))))):(le=E&~j,le!==0?R=rn(le):ie!==0?R=rn(ie):g||(g=E&~h,g!==0&&(R=rn(g)))),R===0?0:f!==0&&f!==R&&(f&j)===0&&(j=R&-R,g=f&-f,j>=g||j===32&&(g&4194048)!==0)?f:R}function es(h,f){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&f)===0}function Mn(h,f){switch(h){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qn(){var h=tn;return tn<<=1,(tn&4194048)===0&&(tn=256),h}function ms(){var h=Wr;return Wr<<=1,(Wr&62914560)===0&&(Wr=4194304),h}function Fn(h){for(var f=[],g=0;31>g;g++)f.push(h);return f}function Ft(h,f){h.pendingLanes|=f,f!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function oa(h,f,g,E,R,j){var ie=h.pendingLanes;h.pendingLanes=g,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=g,h.entangledLanes&=g,h.errorRecoveryDisabledLanes&=g,h.shellSuspendCounter=0;var le=h.entanglements,xe=h.expirationTimes,$e=h.hiddenUpdates;for(g=ie&~g;0<g;){var He=31-Bt(g),Ze=1<<He;le[He]=0,xe[He]=-1;var Pe=$e[He];if(Pe!==null)for($e[He]=null,He=0;He<Pe.length;He++){var Fe=Pe[He];Fe!==null&&(Fe.lane&=-536870913)}g&=~Ze}E!==0&&Rn(h,E,0),j!==0&&R===0&&h.tag!==0&&(h.suspendedLanes|=j&~(ie&~f))}function Rn(h,f,g){h.pendingLanes|=f,h.suspendedLanes&=~f;var E=31-Bt(f);h.entangledLanes|=f,h.entanglements[E]=h.entanglements[E]|1073741824|g&4194090}function Dn(h,f){var g=h.entangledLanes|=f;for(h=h.entanglements;g;){var E=31-Bt(g),R=1<<E;R&f|h[E]&f&&(h[E]|=f),g&=~R}}function yi(h){switch(h){case 2:h=1;break;case 8:h=4;break;case 32:h=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:h=128;break;case 268435456:h=134217728;break;default:h=0}return h}function Kn(h){return h&=-h,2<h?8<h?(h&134217727)!==0?32:268435456:8:2}function An(){var h=Y.p;return h!==0?h:(h=window.event,h===void 0?32:BO(h.type))}function bi(h,f){var g=Y.p;try{return Y.p=h,f()}finally{Y.p=g}}var yn=Math.random().toString(36).slice(2),zt="__reactFiber$"+yn,pn="__reactProps$"+yn,nn="__reactContainer$"+yn,Zt="__reactEvents$"+yn,dt="__reactListeners$"+yn,cr="__reactHandles$"+yn,bn="__reactResources$"+yn,ri="__reactMarker$"+yn;function Xn(h){delete h[zt],delete h[pn],delete h[Zt],delete h[dt],delete h[cr]}function vn(h){var f=h[zt];if(f)return f;for(var g=h.parentNode;g;){if(f=g[nn]||g[zt]){if(g=f.alternate,f.child!==null||g!==null&&g.child!==null)for(h=SO(h);h!==null;){if(g=h[zt])return g;h=SO(h)}return f}h=g,g=h.parentNode}return null}function ks(h){if(h=h[zt]||h[nn]){var f=h.tag;if(f===5||f===6||f===13||f===26||f===27||f===3)return h}return null}function mn(h){var f=h.tag;if(f===5||f===26||f===27||f===6)return h.stateNode;throw Error(r(33))}function Bn(h){var f=h[bn];return f||(f=h[bn]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function ur(h){h[ri]=!0}var La=new Set,vi={};function Is(h,f){gs(h,f),gs(h+"Capture",f)}function gs(h,f){for(vi[h]=f,h=0;h<f.length;h++)La.add(f[h])}var To=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),si={},il={};function Lu(h){return Ge.call(il,h)?!0:Ge.call(si,h)?!1:To.test(h)?il[h]=!0:(si[h]=!0,!1)}function Co(h,f,g){if(Lu(f))if(g===null)h.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":h.removeAttribute(f);return;case"boolean":var E=f.toLowerCase().slice(0,5);if(E!=="data-"&&E!=="aria-"){h.removeAttribute(f);return}}h.setAttribute(f,""+g)}}function Ao(h,f,g){if(g===null)h.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(f);return}h.setAttribute(f,""+g)}}function _i(h,f,g,E){if(E===null)h.removeAttribute(g);else{switch(typeof E){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(g);return}h.setAttributeNS(f,g,""+E)}}var Pa,la;function ca(h){if(Pa===void 0)try{throw Error()}catch(g){var f=g.stack.trim().match(/\n( *(at )?)/);Pa=f&&f[1]||"",la=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pa+h+la}var No=!1;function ua(h,f){if(!h||No)return"";No=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var E={DetermineComponentFrameRoot:function(){try{if(f){var Ze=function(){throw Error()};if(Object.defineProperty(Ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ze,[])}catch(Fe){var Pe=Fe}Reflect.construct(h,[],Ze)}else{try{Ze.call()}catch(Fe){Pe=Fe}h.call(Ze.prototype)}}else{try{throw Error()}catch(Fe){Pe=Fe}(Ze=h())&&typeof Ze.catch=="function"&&Ze.catch(function(){})}}catch(Fe){if(Fe&&Pe&&typeof Fe.stack=="string")return[Fe.stack,Pe.stack]}return[null,null]}};E.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var R=Object.getOwnPropertyDescriptor(E.DetermineComponentFrameRoot,"name");R&&R.configurable&&Object.defineProperty(E.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var j=E.DetermineComponentFrameRoot(),ie=j[0],le=j[1];if(ie&&le){var xe=ie.split(`
`),$e=le.split(`
`);for(R=E=0;E<xe.length&&!xe[E].includes("DetermineComponentFrameRoot");)E++;for(;R<$e.length&&!$e[R].includes("DetermineComponentFrameRoot");)R++;if(E===xe.length||R===$e.length)for(E=xe.length-1,R=$e.length-1;1<=E&&0<=R&&xe[E]!==$e[R];)R--;for(;1<=E&&0<=R;E--,R--)if(xe[E]!==$e[R]){if(E!==1||R!==1)do if(E--,R--,0>R||xe[E]!==$e[R]){var He=`
`+xe[E].replace(" at new "," at ");return h.displayName&&He.includes("<anonymous>")&&(He=He.replace("<anonymous>",h.displayName)),He}while(1<=E&&0<=R);break}}}finally{No=!1,Error.prepareStackTrace=g}return(g=h?h.displayName||h.name:"")?ca(g):""}function _n(h){switch(h.tag){case 26:case 27:case 5:return ca(h.type);case 16:return ca("Lazy");case 13:return ca("Suspense");case 19:return ca("SuspenseList");case 0:case 15:return ua(h.type,!1);case 11:return ua(h.type.render,!1);case 1:return ua(h.type,!0);case 31:return ca("Activity");default:return""}}function Nn(h){try{var f="";do f+=_n(h),h=h.return;while(h);return f}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function Tr(h){switch(typeof h){case"bigint":case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function Oa(h){var f=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function so(h){var f=Oa(h)?"checked":"value",g=Object.getOwnPropertyDescriptor(h.constructor.prototype,f),E=""+h[f];if(!h.hasOwnProperty(f)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var R=g.get,j=g.set;return Object.defineProperty(h,f,{configurable:!0,get:function(){return R.call(this)},set:function(ie){E=""+ie,j.call(this,ie)}}),Object.defineProperty(h,f,{enumerable:g.enumerable}),{getValue:function(){return E},setValue:function(ie){E=""+ie},stopTracking:function(){h._valueTracker=null,delete h[f]}}}}function al(h){h._valueTracker||(h._valueTracker=so(h))}function yt(h){if(!h)return!1;var f=h._valueTracker;if(!f)return!0;var g=f.getValue(),E="";return h&&(E=Oa(h)?h.checked?"true":"false":h.value),h=E,h!==g?(f.setValue(h),!0):!1}function xr(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}var zl=/[\n"\\]/g;function ls(h){return h.replace(zl,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function wi(h,f,g,E,R,j,ie,le){h.name="",ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"?h.type=ie:h.removeAttribute("type"),f!=null?ie==="number"?(f===0&&h.value===""||h.value!=f)&&(h.value=""+Tr(f)):h.value!==""+Tr(f)&&(h.value=""+Tr(f)):ie!=="submit"&&ie!=="reset"||h.removeAttribute("value"),f!=null?Ec(h,ie,Tr(f)):g!=null?Ec(h,ie,Tr(g)):E!=null&&h.removeAttribute("value"),R==null&&j!=null&&(h.defaultChecked=!!j),R!=null&&(h.checked=R&&typeof R!="function"&&typeof R!="symbol"),le!=null&&typeof le!="function"&&typeof le!="symbol"&&typeof le!="boolean"?h.name=""+Tr(le):h.removeAttribute("name")}function Hf(h,f,g,E,R,j,ie,le){if(j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(h.type=j),f!=null||g!=null){if(!(j!=="submit"&&j!=="reset"||f!=null))return;g=g!=null?""+Tr(g):"",f=f!=null?""+Tr(f):g,le||f===h.value||(h.value=f),h.defaultValue=f}E=E??R,E=typeof E!="function"&&typeof E!="symbol"&&!!E,h.checked=le?h.checked:!!E,h.defaultChecked=!!E,ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"&&(h.name=ie)}function Ec(h,f,g){f==="number"&&xr(h.ownerDocument)===h||h.defaultValue===""+g||(h.defaultValue=""+g)}function ha(h,f,g,E){if(h=h.options,f){f={};for(var R=0;R<g.length;R++)f["$"+g[R]]=!0;for(g=0;g<h.length;g++)R=f.hasOwnProperty("$"+h[g].value),h[g].selected!==R&&(h[g].selected=R),R&&E&&(h[g].defaultSelected=!0)}else{for(g=""+Tr(g),f=null,R=0;R<h.length;R++){if(h[R].value===g){h[R].selected=!0,E&&(h[R].defaultSelected=!0);return}f!==null||h[R].disabled||(f=h[R])}f!==null&&(f.selected=!0)}}function qr(h,f,g){if(f!=null&&(f=""+Tr(f),f!==h.value&&(h.value=f),g==null)){h.defaultValue!==f&&(h.defaultValue=f);return}h.defaultValue=g!=null?""+Tr(g):""}function ol(h,f,g,E){if(f==null){if(E!=null){if(g!=null)throw Error(r(92));if(M(E)){if(1<E.length)throw Error(r(93));E=E[0]}g=E}g==null&&(g=""),f=g}g=Tr(f),h.defaultValue=g,E=h.textContent,E===g&&E!==""&&E!==null&&(h.value=E)}function Ei(h,f){if(f){var g=h.firstChild;if(g&&g===h.lastChild&&g.nodeType===3){g.nodeValue=f;return}}h.textContent=f}var Ma=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pu(h,f,g){var E=f.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?E?h.setProperty(f,""):f==="float"?h.cssFloat="":h[f]="":E?h.setProperty(f,g):typeof g!="number"||g===0||Ma.has(f)?f==="float"?h.cssFloat=g:h[f]=(""+g).trim():h[f]=g+"px"}function jl(h,f,g){if(f!=null&&typeof f!="object")throw Error(r(62));if(h=h.style,g!=null){for(var E in g)!g.hasOwnProperty(E)||f!=null&&f.hasOwnProperty(E)||(E.indexOf("--")===0?h.setProperty(E,""):E==="float"?h.cssFloat="":h[E]="");for(var R in f)E=f[R],f.hasOwnProperty(R)&&g[R]!==E&&Pu(h,R,E)}else for(var j in f)f.hasOwnProperty(j)&&Pu(h,j,f[j])}function Sc(h){if(h.indexOf("-")===-1)return!1;switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ou=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fa(h){return Ou.test(""+h)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":h}var Mu=null;function Tc(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var Vl=null,ii=null;function Um(h){var f=ks(h);if(f&&(h=f.stateNode)){var g=h[pn]||null;e:switch(h=f.stateNode,f.type){case"input":if(wi(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),f=g.name,g.type==="radio"&&f!=null){for(g=h;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+ls(""+f)+'"][type="radio"]'),f=0;f<g.length;f++){var E=g[f];if(E!==h&&E.form===h.form){var R=E[pn]||null;if(!R)throw Error(r(90));wi(E,R.value,R.defaultValue,R.defaultValue,R.checked,R.defaultChecked,R.type,R.name)}}for(f=0;f<g.length;f++)E=g[f],E.form===h.form&&yt(E)}break e;case"textarea":qr(h,g.value,g.defaultValue);break e;case"select":f=g.value,f!=null&&ha(h,!!g.multiple,f,!1)}}}var Ut=!1;function Si(h,f,g){if(Ut)return h(f,g);Ut=!0;try{var E=h(f);return E}finally{if(Ut=!1,(Vl!==null||ii!==null)&&(w_(),Vl&&(f=Vl,h=ii,ii=Vl=null,Um(f),h)))for(f=0;f<h.length;f++)Um(h[f])}}function Yn(h,f){var g=h.stateNode;if(g===null)return null;var E=g[pn]||null;if(E===null)return null;g=E[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(h=h.type,E=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!E;break e;default:h=!1}if(h)return null;if(g&&typeof g!="function")throw Error(r(231,f,typeof g));return g}var Ti=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ko=!1;if(Ti)try{var ll={};Object.defineProperty(ll,"passive",{get:function(){ko=!0}}),window.addEventListener("test",ll,ll),window.removeEventListener("test",ll,ll)}catch{ko=!1}var da=null,rr=null,Cc=null;function Ac(){if(Cc)return Cc;var h,f=rr,g=f.length,E,R="value"in da?da.value:da.textContent,j=R.length;for(h=0;h<g&&f[h]===R[h];h++);var ie=g-h;for(E=1;E<=ie&&f[g-E]===R[j-E];E++);return Cc=R.slice(h,1<E?1-E:void 0)}function Kr(h){var f=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&f===13&&(h=13)):h=f,h===10&&(h=13),32<=h||h===13?h:0}function Ba(){return!0}function Vh(){return!1}function xs(h){function f(g,E,R,j,ie){this._reactName=g,this._targetInst=R,this.type=E,this.nativeEvent=j,this.target=ie,this.currentTarget=null;for(var le in h)h.hasOwnProperty(le)&&(g=h[le],this[le]=g?g(j):j[le]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?Ba:Vh,this.isPropagationStopped=Vh,this}return u(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),f}var Ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=xs(Ci),Ul=u({},Ci,{view:0,detail:0}),Fu=xs(Ul),Bu,dn,cl,ai=u({},Ul,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zu,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==cl&&(cl&&h.type==="mousemove"?(Bu=h.screenX-cl.screenX,dn=h.screenY-cl.screenY):dn=Bu=0,cl=h),Bu)},movementY:function(h){return"movementY"in h?h.movementY:dn}}),Io=xs(ai),Gm=u({},ai,{dataTransfer:0}),Hm=xs(Gm),Gl=u({},Ul,{relatedTarget:0}),Uh=xs(Gl),Wf=u({},Ci,{animationName:0,elapsedTime:0,pseudoElement:0}),qf=xs(Wf),Kf=u({},Ci,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),Gh=xs(Kf),Hh=u({},Ci,{data:0}),fa=xs(Hh),Wm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ul={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ro={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xf(h){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(h):(h=Ro[h])?!!f[h]:!1}function zu(){return Xf}var Wh=u({},Ul,{key:function(h){if(h.key){var f=Wm[h.key]||h.key;if(f!=="Unidentified")return f}return h.type==="keypress"?(h=Kr(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?ul[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zu,charCode:function(h){return h.type==="keypress"?Kr(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?Kr(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),qh=xs(Wh),Ai=u({},ai,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kh=xs(Ai),qm=u({},Ul,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zu}),kc=xs(qm),A=u({},Ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),J=xs(A),se=u({},ai,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),he=xs(se),Ie=u({},Ci,{newState:0,oldState:0}),Oe=xs(Ie),it=[9,13,27,32],Gt=Ti&&"CompositionEvent"in window,$n=null;Ti&&"documentMode"in document&&($n=document.documentMode);var hr=Ti&&"TextEvent"in window&&!$n,ts=Ti&&(!Gt||$n&&8<$n&&11>=$n),za=" ",io=!1;function ja(h,f){switch(h){case"keyup":return it.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Do(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var $o=!1;function Xh(h,f){switch(h){case"compositionend":return Do(f);case"keypress":return f.which!==32?null:(io=!0,za);case"textInput":return h=f.data,h===za&&io?null:h;default:return null}}function MC(h,f){if($o)return h==="compositionend"||!Gt&&ja(h,f)?(h=Ac(),Cc=rr=da=null,$o=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return ts&&f.locale!=="ko"?null:f.data;default:return null}}var Lo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ju(h){var f=h&&h.nodeName&&h.nodeName.toLowerCase();return f==="input"?!!Lo[h.type]:f==="textarea"}function zv(h,f,g,E){Vl?ii?ii.push(E):ii=[E]:Vl=E,f=N_(f,"onChange"),0<f.length&&(g=new Nc("onChange","change",null,g,E),h.push({event:g,listeners:f}))}var Va=null,Yf=null;function Yh(h){pO(h,0)}function Km(h){var f=mn(h);if(yt(f))return h}function Zh(h,f){if(h==="change")return f}var xx=!1;if(Ti){var Qh;if(Ti){var yx="oninput"in document;if(!yx){var Hl=document.createElement("div");Hl.setAttribute("oninput","return;"),yx=typeof Hl.oninput=="function"}Qh=yx}else Qh=!1;xx=Qh&&(!document.documentMode||9<document.documentMode)}function Zf(){Va&&(Va.detachEvent("onpropertychange",jv),Yf=Va=null)}function jv(h){if(h.propertyName==="value"&&Km(Yf)){var f=[];zv(f,Yf,h,Tc(h)),Si(Yh,f)}}function bx(h,f,g){h==="focusin"?(Zf(),Va=f,Yf=g,Va.attachEvent("onpropertychange",jv)):h==="focusout"&&Zf()}function FC(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return Km(Yf)}function Wl(h,f){if(h==="click")return Km(f)}function BC(h,f){if(h==="input"||h==="change")return Km(f)}function Jh(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var Ua=typeof Object.is=="function"?Object.is:Jh;function Ga(h,f){if(Ua(h,f))return!0;if(typeof h!="object"||h===null||typeof f!="object"||f===null)return!1;var g=Object.keys(h),E=Object.keys(f);if(g.length!==E.length)return!1;for(E=0;E<g.length;E++){var R=g[E];if(!Ge.call(f,R)||!Ua(h[R],f[R]))return!1}return!0}function Qf(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function vx(h,f){var g=Qf(h);h=0;for(var E;g;){if(g.nodeType===3){if(E=h+g.textContent.length,h<=f&&E>=f)return{node:g,offset:f-h};h=E}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=Qf(g)}}function Xm(h,f){return h&&f?h===f?!0:h&&h.nodeType===3?!1:f&&f.nodeType===3?Xm(h,f.parentNode):"contains"in h?h.contains(f):h.compareDocumentPosition?!!(h.compareDocumentPosition(f)&16):!1:!1}function Jf(h){h=h!=null&&h.ownerDocument!=null&&h.ownerDocument.defaultView!=null?h.ownerDocument.defaultView:window;for(var f=xr(h.document);f instanceof h.HTMLIFrameElement;){try{var g=typeof f.contentWindow.location.href=="string"}catch{g=!1}if(g)h=f.contentWindow;else break;f=xr(h.document)}return f}function ep(h){var f=h&&h.nodeName&&h.nodeName.toLowerCase();return f&&(f==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||f==="textarea"||h.contentEditable==="true")}var Ym=Ti&&"documentMode"in document&&11>=document.documentMode,Po=null,ed=null,Vu=null,Zm=!1;function Vv(h,f,g){var E=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Zm||Po==null||Po!==xr(E)||(E=Po,"selectionStart"in E&&ep(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),Vu&&Ga(Vu,E)||(Vu=E,E=N_(ed,"onSelect"),0<E.length&&(f=new Nc("onSelect","select",null,f,g),h.push({event:f,listeners:E}),f.target=Po)))}function hl(h,f){var g={};return g[h.toLowerCase()]=f.toLowerCase(),g["Webkit"+h]="webkit"+f,g["Moz"+h]="moz"+f,g}var td={animationend:hl("Animation","AnimationEnd"),animationiteration:hl("Animation","AnimationIteration"),animationstart:hl("Animation","AnimationStart"),transitionrun:hl("Transition","TransitionRun"),transitionstart:hl("Transition","TransitionStart"),transitioncancel:hl("Transition","TransitionCancel"),transitionend:hl("Transition","TransitionEnd")},Qm={},Uv={};Ti&&(Uv=document.createElement("div").style,"AnimationEvent"in window||(delete td.animationend.animation,delete td.animationiteration.animation,delete td.animationstart.animation),"TransitionEvent"in window||delete td.transitionend.transition);function Ic(h){if(Qm[h])return Qm[h];if(!td[h])return h;var f=td[h],g;for(g in f)if(f.hasOwnProperty(g)&&g in Uv)return Qm[h]=f[g];return h}var Gv=Ic("animationend"),Oo=Ic("animationiteration"),tp=Ic("animationstart"),zC=Ic("transitionrun"),Jm=Ic("transitionstart"),jC=Ic("transitioncancel"),_x=Ic("transitionend"),Hv=new Map,Uu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uu.push("scrollEnd");function Mo(h,f){Hv.set(h,f),Is(f,[h])}var Gu=new WeakMap;function Ha(h,f){if(typeof h=="object"&&h!==null){var g=Gu.get(h);return g!==void 0?g:(f={value:h,source:f,stack:Nn(f)},Gu.set(h,f),f)}return{value:h,source:f,stack:Nn(f)}}var Wa=[],nd=0,Fo=0;function np(){for(var h=nd,f=Fo=nd=0;f<h;){var g=Wa[f];Wa[f++]=null;var E=Wa[f];Wa[f++]=null;var R=Wa[f];Wa[f++]=null;var j=Wa[f];if(Wa[f++]=null,E!==null&&R!==null){var ie=E.pending;ie===null?R.next=R:(R.next=ie.next,ie.next=R),E.pending=R}j!==0&&sp(g,R,j)}}function rp(h,f,g,E){Wa[nd++]=h,Wa[nd++]=f,Wa[nd++]=g,Wa[nd++]=E,Fo|=E,h.lanes|=E,h=h.alternate,h!==null&&(h.lanes|=E)}function Hu(h,f,g,E){return rp(h,f,g,E),Rc(h)}function rd(h,f){return rp(h,null,null,f),Rc(h)}function sp(h,f,g){h.lanes|=g;var E=h.alternate;E!==null&&(E.lanes|=g);for(var R=!1,j=h.return;j!==null;)j.childLanes|=g,E=j.alternate,E!==null&&(E.childLanes|=g),j.tag===22&&(h=j.stateNode,h===null||h._visibility&1||(R=!0)),h=j,j=j.return;return h.tag===3?(j=h.stateNode,R&&f!==null&&(R=31-Bt(g),h=j.hiddenUpdates,E=h[R],E===null?h[R]=[f]:E.push(f),f.lane=g|536870912),j):null}function Rc(h){if(50<Gx)throw Gx=0,FA=null,Error(r(185));for(var f=h.return;f!==null;)h=f,f=h.return;return h.tag===3?h.stateNode:null}var Wu={};function Wv(h,f,g,E){this.tag=h,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qa(h,f,g,E){return new Wv(h,f,g,E)}function e0(h){return h=h.prototype,!(!h||!h.isReactComponent)}function dl(h,f){var g=h.alternate;return g===null?(g=qa(h.tag,f,h.key,h.mode),g.elementType=h.elementType,g.type=h.type,g.stateNode=h.stateNode,g.alternate=h,h.alternate=g):(g.pendingProps=f,g.type=h.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=h.flags&65011712,g.childLanes=h.childLanes,g.lanes=h.lanes,g.child=h.child,g.memoizedProps=h.memoizedProps,g.memoizedState=h.memoizedState,g.updateQueue=h.updateQueue,f=h.dependencies,g.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},g.sibling=h.sibling,g.index=h.index,g.ref=h.ref,g.refCleanup=h.refCleanup,g}function wx(h,f){h.flags&=65011714;var g=h.alternate;return g===null?(h.childLanes=0,h.lanes=f,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=g.childLanes,h.lanes=g.lanes,h.child=g.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=g.memoizedProps,h.memoizedState=g.memoizedState,h.updateQueue=g.updateQueue,h.type=g.type,f=g.dependencies,h.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),h}function ip(h,f,g,E,R,j){var ie=0;if(E=h,typeof h=="function")e0(h)&&(ie=1);else if(typeof h=="string")ie=Ere(h,g,re.current)?26:h==="html"||h==="head"||h==="body"?27:5;else e:switch(h){case G:return h=qa(31,g,f,R),h.elementType=G,h.lanes=j,h;case y:return Dc(g.children,R,j,f);case v:ie=8,R|=24;break;case b:return h=qa(12,g,f,R|2),h.elementType=b,h.lanes=j,h;case $:return h=qa(13,g,f,R),h.elementType=$,h.lanes=j,h;case q:return h=qa(19,g,f,R),h.elementType=q,h.lanes=j,h;default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case S:case C:ie=10;break e;case T:ie=9;break e;case I:ie=11;break e;case U:ie=14;break e;case F:ie=16,E=null;break e}ie=29,g=Error(r(130,h===null?"null":typeof h,"")),E=null}return f=qa(ie,g,f,R),f.elementType=h,f.type=E,f.lanes=j,f}function Dc(h,f,g,E){return h=qa(7,h,E,f),h.lanes=g,h}function Ex(h,f,g){return h=qa(6,h,null,f),h.lanes=g,h}function t0(h,f,g){return f=qa(4,h.children!==null?h.children:[],h.key,f),f.lanes=g,f.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},f}var qu=[],sd=0,m=null,w=0,k=[],H=0,ee=null,oe=1,ge="";function ke(h,f){qu[sd++]=w,qu[sd++]=m,m=h,w=f}function Be(h,f,g){k[H++]=oe,k[H++]=ge,k[H++]=ee,ee=h;var E=oe;h=ge;var R=32-Bt(E)-1;E&=~(1<<R),g+=1;var j=32-Bt(f)+R;if(30<j){var ie=R-R%5;j=(E&(1<<ie)-1).toString(32),E>>=ie,R-=ie,oe=1<<32-Bt(f)+R|g<<R|E,ge=j+h}else oe=1<<j|g<<R|E,ge=h}function Je(h){h.return!==null&&(ke(h,1),Be(h,1,0))}function ft(h){for(;h===m;)m=qu[--sd],qu[sd]=null,w=qu[--sd],qu[sd]=null;for(;h===ee;)ee=k[--H],k[H]=null,ge=k[--H],k[H]=null,oe=k[--H],k[H]=null}var vt=null,At=null,Qt=!1,zr=null,cs=!1,Ni=Error(r(519));function ao(h){var f=Error(r(418,""));throw ad(Ha(f,h)),Ni}function qv(h){var f=h.stateNode,g=h.type,E=h.memoizedProps;switch(f[zt]=h,f[pn]=E,g){case"dialog":jn("cancel",f),jn("close",f);break;case"iframe":case"object":case"embed":jn("load",f);break;case"video":case"audio":for(g=0;g<Wx.length;g++)jn(Wx[g],f);break;case"source":jn("error",f);break;case"img":case"image":case"link":jn("error",f),jn("load",f);break;case"details":jn("toggle",f);break;case"input":jn("invalid",f),Hf(f,E.value,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name,!0),al(f);break;case"select":jn("invalid",f);break;case"textarea":jn("invalid",f),ol(f,E.value,E.defaultValue,E.children),al(f)}g=E.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||f.textContent===""+g||E.suppressHydrationWarning===!0||yO(f.textContent,g)?(E.popover!=null&&(jn("beforetoggle",f),jn("toggle",f)),E.onScroll!=null&&jn("scroll",f),E.onScrollEnd!=null&&jn("scrollend",f),E.onClick!=null&&(f.onclick=k_),f=!0):f=!1,f||ao(h)}function Kv(h){for(vt=h.return;vt;)switch(vt.tag){case 5:case 13:cs=!1;return;case 27:case 3:cs=!0;return;default:vt=vt.return}}function ap(h){if(h!==vt)return!1;if(!Qt)return Kv(h),Qt=!0,!1;var f=h.tag,g;if((g=f!==3&&f!==27)&&((g=f===5)&&(g=h.type,g=!(g!=="form"&&g!=="button")||eN(h.type,h.memoizedProps)),g=!g),g&&At&&ao(h),Kv(h),f===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));e:{for(h=h.nextSibling,f=0;h;){if(h.nodeType===8)if(g=h.data,g==="/$"){if(f===0){At=Yl(h.nextSibling);break e}f--}else g!=="$"&&g!=="$!"&&g!=="$?"||f++;h=h.nextSibling}At=null}}else f===27?(f=At,_d(h.type)?(h=sN,sN=null,At=h):At=f):At=vt?Yl(h.stateNode.nextSibling):null;return!0}function id(){At=vt=null,Qt=!1}function Xv(){var h=zr;return h!==null&&(co===null?co=h:co.push.apply(co,h),zr=null),h}function ad(h){zr===null?zr=[h]:zr.push(h)}var ns=z(null),fl=null,ql=null;function $c(h,f,g){X(ns,f._currentValue),f._currentValue=g}function Kl(h){h._currentValue=ns.current,D(ns)}function op(h,f,g){for(;h!==null;){var E=h.alternate;if((h.childLanes&f)!==f?(h.childLanes|=f,E!==null&&(E.childLanes|=f)):E!==null&&(E.childLanes&f)!==f&&(E.childLanes|=f),h===g)break;h=h.return}}function n0(h,f,g,E){var R=h.child;for(R!==null&&(R.return=h);R!==null;){var j=R.dependencies;if(j!==null){var ie=R.child;j=j.firstContext;e:for(;j!==null;){var le=j;j=R;for(var xe=0;xe<f.length;xe++)if(le.context===f[xe]){j.lanes|=g,le=j.alternate,le!==null&&(le.lanes|=g),op(j.return,g,h),E||(ie=null);break e}j=le.next}}else if(R.tag===18){if(ie=R.return,ie===null)throw Error(r(341));ie.lanes|=g,j=ie.alternate,j!==null&&(j.lanes|=g),op(ie,g,h),ie=null}else ie=R.child;if(ie!==null)ie.return=R;else for(ie=R;ie!==null;){if(ie===h){ie=null;break}if(R=ie.sibling,R!==null){R.return=ie.return,ie=R;break}ie=ie.return}R=ie}}function lp(h,f,g,E){h=null;for(var R=f,j=!1;R!==null;){if(!j){if((R.flags&524288)!==0)j=!0;else if((R.flags&262144)!==0)break}if(R.tag===10){var ie=R.alternate;if(ie===null)throw Error(r(387));if(ie=ie.memoizedProps,ie!==null){var le=R.type;Ua(R.pendingProps.value,ie.value)||(h!==null?h.push(le):h=[le])}}else if(R===pe.current){if(ie=R.alternate,ie===null)throw Error(r(387));ie.memoizedState.memoizedState!==R.memoizedState.memoizedState&&(h!==null?h.push(Qx):h=[Qx])}R=R.return}h!==null&&n0(f,h,g,E),f.flags|=262144}function Yv(h){for(h=h.firstContext;h!==null;){if(!Ua(h.context._currentValue,h.memoizedValue))return!0;h=h.next}return!1}function cp(h){fl=h,ql=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function pa(h){return sL(fl,h)}function Zv(h,f){return fl===null&&cp(h),sL(h,f)}function sL(h,f){var g=f._currentValue;if(f={context:f,memoizedValue:g,next:null},ql===null){if(h===null)throw Error(r(308));ql=f,h.dependencies={lanes:0,firstContext:f},h.flags|=524288}else ql=ql.next=f;return g}var wne=typeof AbortController<"u"?AbortController:function(){var h=[],f=this.signal={aborted:!1,addEventListener:function(g,E){h.push(E)}};this.abort=function(){f.aborted=!0,h.forEach(function(g){return g()})}},Ene=n.unstable_scheduleCallback,Sne=n.unstable_NormalPriority,oi={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function VC(){return{controller:new wne,data:new Map,refCount:0}}function Sx(h){h.refCount--,h.refCount===0&&Ene(Sne,function(){h.controller.abort()})}var Tx=null,UC=0,r0=0,s0=null;function Tne(h,f){if(Tx===null){var g=Tx=[];UC=0,r0=HA(),s0={status:"pending",value:void 0,then:function(E){g.push(E)}}}return UC++,f.then(iL,iL),f}function iL(){if(--UC===0&&Tx!==null){s0!==null&&(s0.status="fulfilled");var h=Tx;Tx=null,r0=0,s0=null;for(var f=0;f<h.length;f++)(0,h[f])()}}function Cne(h,f){var g=[],E={status:"pending",value:null,reason:null,then:function(R){g.push(R)}};return h.then(function(){E.status="fulfilled",E.value=f;for(var R=0;R<g.length;R++)(0,g[R])(f)},function(R){for(E.status="rejected",E.reason=R,R=0;R<g.length;R++)(0,g[R])(void 0)}),E}var aL=B.S;B.S=function(h,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&Tne(h,f),aL!==null&&aL(h,f)};var up=z(null);function GC(){var h=up.current;return h!==null?h:jr.pooledCache}function Qv(h,f){f===null?X(up,up.current):X(up,f.pool)}function oL(){var h=GC();return h===null?null:{parent:oi._currentValue,pool:h}}var Cx=Error(r(460)),lL=Error(r(474)),Jv=Error(r(542)),HC={then:function(){}};function cL(h){return h=h.status,h==="fulfilled"||h==="rejected"}function e_(){}function uL(h,f,g){switch(g=h[g],g===void 0?h.push(f):g!==f&&(f.then(e_,e_),f=g),f.status){case"fulfilled":return f.value;case"rejected":throw h=f.reason,dL(h),h;default:if(typeof f.status=="string")f.then(e_,e_);else{if(h=jr,h!==null&&100<h.shellSuspendCounter)throw Error(r(482));h=f,h.status="pending",h.then(function(E){if(f.status==="pending"){var R=f;R.status="fulfilled",R.value=E}},function(E){if(f.status==="pending"){var R=f;R.status="rejected",R.reason=E}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw h=f.reason,dL(h),h}throw Ax=f,Cx}}var Ax=null;function hL(){if(Ax===null)throw Error(r(459));var h=Ax;return Ax=null,h}function dL(h){if(h===Cx||h===Jv)throw Error(r(483))}var od=!1;function WC(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qC(h,f){h=h.updateQueue,f.updateQueue===h&&(f.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function ld(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function cd(h,f,g){var E=h.updateQueue;if(E===null)return null;if(E=E.shared,(wr&2)!==0){var R=E.pending;return R===null?f.next=f:(f.next=R.next,R.next=f),E.pending=f,f=Rc(h),sp(h,null,g),f}return rp(h,E,f,g),Rc(h)}function Nx(h,f,g){if(f=f.updateQueue,f!==null&&(f=f.shared,(g&4194048)!==0)){var E=f.lanes;E&=h.pendingLanes,g|=E,f.lanes=g,Dn(h,g)}}function KC(h,f){var g=h.updateQueue,E=h.alternate;if(E!==null&&(E=E.updateQueue,g===E)){var R=null,j=null;if(g=g.firstBaseUpdate,g!==null){do{var ie={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};j===null?R=j=ie:j=j.next=ie,g=g.next}while(g!==null);j===null?R=j=f:j=j.next=f}else R=j=f;g={baseState:E.baseState,firstBaseUpdate:R,lastBaseUpdate:j,shared:E.shared,callbacks:E.callbacks},h.updateQueue=g;return}h=g.lastBaseUpdate,h===null?g.firstBaseUpdate=f:h.next=f,g.lastBaseUpdate=f}var XC=!1;function kx(){if(XC){var h=s0;if(h!==null)throw h}}function Ix(h,f,g,E){XC=!1;var R=h.updateQueue;od=!1;var j=R.firstBaseUpdate,ie=R.lastBaseUpdate,le=R.shared.pending;if(le!==null){R.shared.pending=null;var xe=le,$e=xe.next;xe.next=null,ie===null?j=$e:ie.next=$e,ie=xe;var He=h.alternate;He!==null&&(He=He.updateQueue,le=He.lastBaseUpdate,le!==ie&&(le===null?He.firstBaseUpdate=$e:le.next=$e,He.lastBaseUpdate=xe))}if(j!==null){var Ze=R.baseState;ie=0,He=$e=xe=null,le=j;do{var Pe=le.lane&-536870913,Fe=Pe!==le.lane;if(Fe?(sr&Pe)===Pe:(E&Pe)===Pe){Pe!==0&&Pe===r0&&(XC=!0),He!==null&&(He=He.next={lane:0,tag:le.tag,payload:le.payload,callback:null,next:null});e:{var Yt=h,jt=le;Pe=f;var Nr=g;switch(jt.tag){case 1:if(Yt=jt.payload,typeof Yt=="function"){Ze=Yt.call(Nr,Ze,Pe);break e}Ze=Yt;break e;case 3:Yt.flags=Yt.flags&-65537|128;case 0:if(Yt=jt.payload,Pe=typeof Yt=="function"?Yt.call(Nr,Ze,Pe):Yt,Pe==null)break e;Ze=u({},Ze,Pe);break e;case 2:od=!0}}Pe=le.callback,Pe!==null&&(h.flags|=64,Fe&&(h.flags|=8192),Fe=R.callbacks,Fe===null?R.callbacks=[Pe]:Fe.push(Pe))}else Fe={lane:Pe,tag:le.tag,payload:le.payload,callback:le.callback,next:null},He===null?($e=He=Fe,xe=Ze):He=He.next=Fe,ie|=Pe;if(le=le.next,le===null){if(le=R.shared.pending,le===null)break;Fe=le,le=Fe.next,Fe.next=null,R.lastBaseUpdate=Fe,R.shared.pending=null}}while(!0);He===null&&(xe=Ze),R.baseState=xe,R.firstBaseUpdate=$e,R.lastBaseUpdate=He,j===null&&(R.shared.lanes=0),xd|=ie,h.lanes=ie,h.memoizedState=Ze}}function fL(h,f){if(typeof h!="function")throw Error(r(191,h));h.call(f)}function pL(h,f){var g=h.callbacks;if(g!==null)for(h.callbacks=null,h=0;h<g.length;h++)fL(g[h],f)}var i0=z(null),t_=z(0);function mL(h,f){h=eh,X(t_,h),X(i0,f),eh=h|f.baseLanes}function YC(){X(t_,eh),X(i0,i0.current)}function ZC(){eh=t_.current,D(i0),D(t_)}var ud=0,kn=null,Cr=null,Gs=null,n_=!1,a0=!1,hp=!1,r_=0,Rx=0,o0=null,Ane=0;function Rs(){throw Error(r(321))}function QC(h,f){if(f===null)return!1;for(var g=0;g<f.length&&g<h.length;g++)if(!Ua(h[g],f[g]))return!1;return!0}function JC(h,f,g,E,R,j){return ud=j,kn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,B.H=h===null||h.memoizedState===null?QL:JL,hp=!1,j=g(E,R),hp=!1,a0&&(j=xL(f,g,E,R)),gL(h),j}function gL(h){B.H=c_;var f=Cr!==null&&Cr.next!==null;if(ud=0,Gs=Cr=kn=null,n_=!1,Rx=0,o0=null,f)throw Error(r(300));h===null||ki||(h=h.dependencies,h!==null&&Yv(h)&&(ki=!0))}function xL(h,f,g,E){kn=h;var R=0;do{if(a0&&(o0=null),Rx=0,a0=!1,25<=R)throw Error(r(301));if(R+=1,Gs=Cr=null,h.updateQueue!=null){var j=h.updateQueue;j.lastEffect=null,j.events=null,j.stores=null,j.memoCache!=null&&(j.memoCache.index=0)}B.H=Lne,j=f(g,E)}while(a0);return j}function Nne(){var h=B.H,f=h.useState()[0];return f=typeof f.then=="function"?Dx(f):f,h=h.useState()[0],(Cr!==null?Cr.memoizedState:null)!==h&&(kn.flags|=1024),f}function eA(){var h=r_!==0;return r_=0,h}function tA(h,f,g){f.updateQueue=h.updateQueue,f.flags&=-2053,h.lanes&=~g}function nA(h){if(n_){for(h=h.memoizedState;h!==null;){var f=h.queue;f!==null&&(f.pending=null),h=h.next}n_=!1}ud=0,Gs=Cr=kn=null,a0=!1,Rx=r_=0,o0=null}function oo(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gs===null?kn.memoizedState=Gs=h:Gs=Gs.next=h,Gs}function Hs(){if(Cr===null){var h=kn.alternate;h=h!==null?h.memoizedState:null}else h=Cr.next;var f=Gs===null?kn.memoizedState:Gs.next;if(f!==null)Gs=f,Cr=h;else{if(h===null)throw kn.alternate===null?Error(r(467)):Error(r(310));Cr=h,h={memoizedState:Cr.memoizedState,baseState:Cr.baseState,baseQueue:Cr.baseQueue,queue:Cr.queue,next:null},Gs===null?kn.memoizedState=Gs=h:Gs=Gs.next=h}return Gs}function rA(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dx(h){var f=Rx;return Rx+=1,o0===null&&(o0=[]),h=uL(o0,h,f),f=kn,(Gs===null?f.memoizedState:Gs.next)===null&&(f=f.alternate,B.H=f===null||f.memoizedState===null?QL:JL),h}function s_(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return Dx(h);if(h.$$typeof===C)return pa(h)}throw Error(r(438,String(h)))}function sA(h){var f=null,g=kn.updateQueue;if(g!==null&&(f=g.memoCache),f==null){var E=kn.alternate;E!==null&&(E=E.updateQueue,E!==null&&(E=E.memoCache,E!=null&&(f={data:E.data.map(function(R){return R.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),g===null&&(g=rA(),kn.updateQueue=g),g.memoCache=f,g=f.data[f.index],g===void 0)for(g=f.data[f.index]=Array(h),E=0;E<h;E++)g[E]=V;return f.index++,g}function Ku(h,f){return typeof f=="function"?f(h):f}function i_(h){var f=Hs();return iA(f,Cr,h)}function iA(h,f,g){var E=h.queue;if(E===null)throw Error(r(311));E.lastRenderedReducer=g;var R=h.baseQueue,j=E.pending;if(j!==null){if(R!==null){var ie=R.next;R.next=j.next,j.next=ie}f.baseQueue=R=j,E.pending=null}if(j=h.baseState,R===null)h.memoizedState=j;else{f=R.next;var le=ie=null,xe=null,$e=f,He=!1;do{var Ze=$e.lane&-536870913;if(Ze!==$e.lane?(sr&Ze)===Ze:(ud&Ze)===Ze){var Pe=$e.revertLane;if(Pe===0)xe!==null&&(xe=xe.next={lane:0,revertLane:0,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null}),Ze===r0&&(He=!0);else if((ud&Pe)===Pe){$e=$e.next,Pe===r0&&(He=!0);continue}else Ze={lane:0,revertLane:$e.revertLane,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},xe===null?(le=xe=Ze,ie=j):xe=xe.next=Ze,kn.lanes|=Pe,xd|=Pe;Ze=$e.action,hp&&g(j,Ze),j=$e.hasEagerState?$e.eagerState:g(j,Ze)}else Pe={lane:Ze,revertLane:$e.revertLane,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},xe===null?(le=xe=Pe,ie=j):xe=xe.next=Pe,kn.lanes|=Ze,xd|=Ze;$e=$e.next}while($e!==null&&$e!==f);if(xe===null?ie=j:xe.next=le,!Ua(j,h.memoizedState)&&(ki=!0,He&&(g=s0,g!==null)))throw g;h.memoizedState=j,h.baseState=ie,h.baseQueue=xe,E.lastRenderedState=j}return R===null&&(E.lanes=0),[h.memoizedState,E.dispatch]}function aA(h){var f=Hs(),g=f.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=h;var E=g.dispatch,R=g.pending,j=f.memoizedState;if(R!==null){g.pending=null;var ie=R=R.next;do j=h(j,ie.action),ie=ie.next;while(ie!==R);Ua(j,f.memoizedState)||(ki=!0),f.memoizedState=j,f.baseQueue===null&&(f.baseState=j),g.lastRenderedState=j}return[j,E]}function yL(h,f,g){var E=kn,R=Hs(),j=Qt;if(j){if(g===void 0)throw Error(r(407));g=g()}else g=f();var ie=!Ua((Cr||R).memoizedState,g);ie&&(R.memoizedState=g,ki=!0),R=R.queue;var le=_L.bind(null,E,R,h);if($x(2048,8,le,[h]),R.getSnapshot!==f||ie||Gs!==null&&Gs.memoizedState.tag&1){if(E.flags|=2048,l0(9,a_(),vL.bind(null,E,R,g,f),null),jr===null)throw Error(r(349));j||(ud&124)!==0||bL(E,f,g)}return g}function bL(h,f,g){h.flags|=16384,h={getSnapshot:f,value:g},f=kn.updateQueue,f===null?(f=rA(),kn.updateQueue=f,f.stores=[h]):(g=f.stores,g===null?f.stores=[h]:g.push(h))}function vL(h,f,g,E){f.value=g,f.getSnapshot=E,wL(f)&&EL(h)}function _L(h,f,g){return g(function(){wL(f)&&EL(h)})}function wL(h){var f=h.getSnapshot;h=h.value;try{var g=f();return!Ua(h,g)}catch{return!0}}function EL(h){var f=rd(h,2);f!==null&&Uo(f,h,2)}function oA(h){var f=oo();if(typeof h=="function"){var g=h;if(h=g(),hp){nr(!0);try{g()}finally{nr(!1)}}}return f.memoizedState=f.baseState=h,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ku,lastRenderedState:h},f}function SL(h,f,g,E){return h.baseState=g,iA(h,Cr,typeof E=="function"?E:Ku)}function kne(h,f,g,E,R){if(l_(h))throw Error(r(485));if(h=f.action,h!==null){var j={payload:R,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ie){j.listeners.push(ie)}};B.T!==null?g(!0):j.isTransition=!1,E(j),g=f.pending,g===null?(j.next=f.pending=j,TL(f,j)):(j.next=g.next,f.pending=g.next=j)}}function TL(h,f){var g=f.action,E=f.payload,R=h.state;if(f.isTransition){var j=B.T,ie={};B.T=ie;try{var le=g(R,E),xe=B.S;xe!==null&&xe(ie,le),CL(h,f,le)}catch($e){lA(h,f,$e)}finally{B.T=j}}else try{j=g(R,E),CL(h,f,j)}catch($e){lA(h,f,$e)}}function CL(h,f,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(E){AL(h,f,E)},function(E){return lA(h,f,E)}):AL(h,f,g)}function AL(h,f,g){f.status="fulfilled",f.value=g,NL(f),h.state=g,f=h.pending,f!==null&&(g=f.next,g===f?h.pending=null:(g=g.next,f.next=g,TL(h,g)))}function lA(h,f,g){var E=h.pending;if(h.pending=null,E!==null){E=E.next;do f.status="rejected",f.reason=g,NL(f),f=f.next;while(f!==E)}h.action=null}function NL(h){h=h.listeners;for(var f=0;f<h.length;f++)(0,h[f])()}function kL(h,f){return f}function IL(h,f){if(Qt){var g=jr.formState;if(g!==null){e:{var E=kn;if(Qt){if(At){t:{for(var R=At,j=cs;R.nodeType!==8;){if(!j){R=null;break t}if(R=Yl(R.nextSibling),R===null){R=null;break t}}j=R.data,R=j==="F!"||j==="F"?R:null}if(R){At=Yl(R.nextSibling),E=R.data==="F!";break e}}ao(E)}E=!1}E&&(f=g[0])}}return g=oo(),g.memoizedState=g.baseState=f,E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kL,lastRenderedState:f},g.queue=E,g=XL.bind(null,kn,E),E.dispatch=g,E=oA(!1),j=fA.bind(null,kn,!1,E.queue),E=oo(),R={state:f,dispatch:null,action:h,pending:null},E.queue=R,g=kne.bind(null,kn,R,j,g),R.dispatch=g,E.memoizedState=h,[f,g,!1]}function RL(h){var f=Hs();return DL(f,Cr,h)}function DL(h,f,g){if(f=iA(h,f,kL)[0],h=i_(Ku)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var E=Dx(f)}catch(ie){throw ie===Cx?Jv:ie}else E=f;f=Hs();var R=f.queue,j=R.dispatch;return g!==f.memoizedState&&(kn.flags|=2048,l0(9,a_(),Ine.bind(null,R,g),null)),[E,j,h]}function Ine(h,f){h.action=f}function $L(h){var f=Hs(),g=Cr;if(g!==null)return DL(f,g,h);Hs(),f=f.memoizedState,g=Hs();var E=g.queue.dispatch;return g.memoizedState=h,[f,E,!1]}function l0(h,f,g,E){return h={tag:h,create:g,deps:E,inst:f,next:null},f=kn.updateQueue,f===null&&(f=rA(),kn.updateQueue=f),g=f.lastEffect,g===null?f.lastEffect=h.next=h:(E=g.next,g.next=h,h.next=E,f.lastEffect=h),h}function a_(){return{destroy:void 0,resource:void 0}}function LL(){return Hs().memoizedState}function o_(h,f,g,E){var R=oo();E=E===void 0?null:E,kn.flags|=h,R.memoizedState=l0(1|f,a_(),g,E)}function $x(h,f,g,E){var R=Hs();E=E===void 0?null:E;var j=R.memoizedState.inst;Cr!==null&&E!==null&&QC(E,Cr.memoizedState.deps)?R.memoizedState=l0(f,j,g,E):(kn.flags|=h,R.memoizedState=l0(1|f,j,g,E))}function PL(h,f){o_(8390656,8,h,f)}function OL(h,f){$x(2048,8,h,f)}function ML(h,f){return $x(4,2,h,f)}function FL(h,f){return $x(4,4,h,f)}function BL(h,f){if(typeof f=="function"){h=h();var g=f(h);return function(){typeof g=="function"?g():f(null)}}if(f!=null)return h=h(),f.current=h,function(){f.current=null}}function zL(h,f,g){g=g!=null?g.concat([h]):null,$x(4,4,BL.bind(null,f,h),g)}function cA(){}function jL(h,f){var g=Hs();f=f===void 0?null:f;var E=g.memoizedState;return f!==null&&QC(f,E[1])?E[0]:(g.memoizedState=[h,f],h)}function VL(h,f){var g=Hs();f=f===void 0?null:f;var E=g.memoizedState;if(f!==null&&QC(f,E[1]))return E[0];if(E=h(),hp){nr(!0);try{h()}finally{nr(!1)}}return g.memoizedState=[E,f],E}function uA(h,f,g){return g===void 0||(ud&1073741824)!==0?h.memoizedState=f:(h.memoizedState=g,h=HP(),kn.lanes|=h,xd|=h,g)}function UL(h,f,g,E){return Ua(g,f)?g:i0.current!==null?(h=uA(h,g,E),Ua(h,f)||(ki=!0),h):(ud&42)===0?(ki=!0,h.memoizedState=g):(h=HP(),kn.lanes|=h,xd|=h,f)}function GL(h,f,g,E,R){var j=Y.p;Y.p=j!==0&&8>j?j:8;var ie=B.T,le={};B.T=le,fA(h,!1,f,g);try{var xe=R(),$e=B.S;if($e!==null&&$e(le,xe),xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var He=Cne(xe,E);Lx(h,f,He,Vo(h))}else Lx(h,f,E,Vo(h))}catch(Ze){Lx(h,f,{then:function(){},status:"rejected",reason:Ze},Vo())}finally{Y.p=j,B.T=ie}}function Rne(){}function hA(h,f,g,E){if(h.tag!==5)throw Error(r(476));var R=HL(h).queue;GL(h,R,f,Z,g===null?Rne:function(){return WL(h),g(E)})}function HL(h){var f=h.memoizedState;if(f!==null)return f;f={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ku,lastRenderedState:Z},next:null};var g={};return f.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ku,lastRenderedState:g},next:null},h.memoizedState=f,h=h.alternate,h!==null&&(h.memoizedState=f),f}function WL(h){var f=HL(h).next.queue;Lx(h,f,{},Vo())}function dA(){return pa(Qx)}function qL(){return Hs().memoizedState}function KL(){return Hs().memoizedState}function Dne(h){for(var f=h.return;f!==null;){switch(f.tag){case 24:case 3:var g=Vo();h=ld(g);var E=cd(f,h,g);E!==null&&(Uo(E,f,g),Nx(E,f,g)),f={cache:VC()},h.payload=f;return}f=f.return}}function $ne(h,f,g){var E=Vo();g={lane:E,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null},l_(h)?YL(f,g):(g=Hu(h,f,g,E),g!==null&&(Uo(g,h,E),ZL(g,f,E)))}function XL(h,f,g){var E=Vo();Lx(h,f,g,E)}function Lx(h,f,g,E){var R={lane:E,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null};if(l_(h))YL(f,R);else{var j=h.alternate;if(h.lanes===0&&(j===null||j.lanes===0)&&(j=f.lastRenderedReducer,j!==null))try{var ie=f.lastRenderedState,le=j(ie,g);if(R.hasEagerState=!0,R.eagerState=le,Ua(le,ie))return rp(h,f,R,0),jr===null&&np(),!1}catch{}finally{}if(g=Hu(h,f,R,E),g!==null)return Uo(g,h,E),ZL(g,f,E),!0}return!1}function fA(h,f,g,E){if(E={lane:2,revertLane:HA(),action:E,hasEagerState:!1,eagerState:null,next:null},l_(h)){if(f)throw Error(r(479))}else f=Hu(h,g,E,2),f!==null&&Uo(f,h,2)}function l_(h){var f=h.alternate;return h===kn||f!==null&&f===kn}function YL(h,f){a0=n_=!0;var g=h.pending;g===null?f.next=f:(f.next=g.next,g.next=f),h.pending=f}function ZL(h,f,g){if((g&4194048)!==0){var E=f.lanes;E&=h.pendingLanes,g|=E,f.lanes=g,Dn(h,g)}}var c_={readContext:pa,use:s_,useCallback:Rs,useContext:Rs,useEffect:Rs,useImperativeHandle:Rs,useLayoutEffect:Rs,useInsertionEffect:Rs,useMemo:Rs,useReducer:Rs,useRef:Rs,useState:Rs,useDebugValue:Rs,useDeferredValue:Rs,useTransition:Rs,useSyncExternalStore:Rs,useId:Rs,useHostTransitionStatus:Rs,useFormState:Rs,useActionState:Rs,useOptimistic:Rs,useMemoCache:Rs,useCacheRefresh:Rs},QL={readContext:pa,use:s_,useCallback:function(h,f){return oo().memoizedState=[h,f===void 0?null:f],h},useContext:pa,useEffect:PL,useImperativeHandle:function(h,f,g){g=g!=null?g.concat([h]):null,o_(4194308,4,BL.bind(null,f,h),g)},useLayoutEffect:function(h,f){return o_(4194308,4,h,f)},useInsertionEffect:function(h,f){o_(4,2,h,f)},useMemo:function(h,f){var g=oo();f=f===void 0?null:f;var E=h();if(hp){nr(!0);try{h()}finally{nr(!1)}}return g.memoizedState=[E,f],E},useReducer:function(h,f,g){var E=oo();if(g!==void 0){var R=g(f);if(hp){nr(!0);try{g(f)}finally{nr(!1)}}}else R=f;return E.memoizedState=E.baseState=R,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:R},E.queue=h,h=h.dispatch=$ne.bind(null,kn,h),[E.memoizedState,h]},useRef:function(h){var f=oo();return h={current:h},f.memoizedState=h},useState:function(h){h=oA(h);var f=h.queue,g=XL.bind(null,kn,f);return f.dispatch=g,[h.memoizedState,g]},useDebugValue:cA,useDeferredValue:function(h,f){var g=oo();return uA(g,h,f)},useTransition:function(){var h=oA(!1);return h=GL.bind(null,kn,h.queue,!0,!1),oo().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,f,g){var E=kn,R=oo();if(Qt){if(g===void 0)throw Error(r(407));g=g()}else{if(g=f(),jr===null)throw Error(r(349));(sr&124)!==0||bL(E,f,g)}R.memoizedState=g;var j={value:g,getSnapshot:f};return R.queue=j,PL(_L.bind(null,E,j,h),[h]),E.flags|=2048,l0(9,a_(),vL.bind(null,E,j,g,f),null),g},useId:function(){var h=oo(),f=jr.identifierPrefix;if(Qt){var g=ge,E=oe;g=(E&~(1<<32-Bt(E)-1)).toString(32)+g,f="«"+f+"R"+g,g=r_++,0<g&&(f+="H"+g.toString(32)),f+="»"}else g=Ane++,f="«"+f+"r"+g.toString(32)+"»";return h.memoizedState=f},useHostTransitionStatus:dA,useFormState:IL,useActionState:IL,useOptimistic:function(h){var f=oo();f.memoizedState=f.baseState=h;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=g,f=fA.bind(null,kn,!0,g),g.dispatch=f,[h,f]},useMemoCache:sA,useCacheRefresh:function(){return oo().memoizedState=Dne.bind(null,kn)}},JL={readContext:pa,use:s_,useCallback:jL,useContext:pa,useEffect:OL,useImperativeHandle:zL,useInsertionEffect:ML,useLayoutEffect:FL,useMemo:VL,useReducer:i_,useRef:LL,useState:function(){return i_(Ku)},useDebugValue:cA,useDeferredValue:function(h,f){var g=Hs();return UL(g,Cr.memoizedState,h,f)},useTransition:function(){var h=i_(Ku)[0],f=Hs().memoizedState;return[typeof h=="boolean"?h:Dx(h),f]},useSyncExternalStore:yL,useId:qL,useHostTransitionStatus:dA,useFormState:RL,useActionState:RL,useOptimistic:function(h,f){var g=Hs();return SL(g,Cr,h,f)},useMemoCache:sA,useCacheRefresh:KL},Lne={readContext:pa,use:s_,useCallback:jL,useContext:pa,useEffect:OL,useImperativeHandle:zL,useInsertionEffect:ML,useLayoutEffect:FL,useMemo:VL,useReducer:aA,useRef:LL,useState:function(){return aA(Ku)},useDebugValue:cA,useDeferredValue:function(h,f){var g=Hs();return Cr===null?uA(g,h,f):UL(g,Cr.memoizedState,h,f)},useTransition:function(){var h=aA(Ku)[0],f=Hs().memoizedState;return[typeof h=="boolean"?h:Dx(h),f]},useSyncExternalStore:yL,useId:qL,useHostTransitionStatus:dA,useFormState:$L,useActionState:$L,useOptimistic:function(h,f){var g=Hs();return Cr!==null?SL(g,Cr,h,f):(g.baseState=h,[h,g.queue.dispatch])},useMemoCache:sA,useCacheRefresh:KL},c0=null,Px=0;function u_(h){var f=Px;return Px+=1,c0===null&&(c0=[]),uL(c0,h,f)}function Ox(h,f){f=f.props.ref,h.ref=f!==void 0?f:null}function h_(h,f){throw f.$$typeof===d?Error(r(525)):(h=Object.prototype.toString.call(f),Error(r(31,h==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":h)))}function eP(h){var f=h._init;return f(h._payload)}function tP(h){function f(Ne,we){if(h){var Re=Ne.deletions;Re===null?(Ne.deletions=[we],Ne.flags|=16):Re.push(we)}}function g(Ne,we){if(!h)return null;for(;we!==null;)f(Ne,we),we=we.sibling;return null}function E(Ne){for(var we=new Map;Ne!==null;)Ne.key!==null?we.set(Ne.key,Ne):we.set(Ne.index,Ne),Ne=Ne.sibling;return we}function R(Ne,we){return Ne=dl(Ne,we),Ne.index=0,Ne.sibling=null,Ne}function j(Ne,we,Re){return Ne.index=Re,h?(Re=Ne.alternate,Re!==null?(Re=Re.index,Re<we?(Ne.flags|=67108866,we):Re):(Ne.flags|=67108866,we)):(Ne.flags|=1048576,we)}function ie(Ne){return h&&Ne.alternate===null&&(Ne.flags|=67108866),Ne}function le(Ne,we,Re,qe){return we===null||we.tag!==6?(we=Ex(Re,Ne.mode,qe),we.return=Ne,we):(we=R(we,Re),we.return=Ne,we)}function xe(Ne,we,Re,qe){var wt=Re.type;return wt===y?He(Ne,we,Re.props.children,qe,Re.key):we!==null&&(we.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===F&&eP(wt)===we.type)?(we=R(we,Re.props),Ox(we,Re),we.return=Ne,we):(we=ip(Re.type,Re.key,Re.props,null,Ne.mode,qe),Ox(we,Re),we.return=Ne,we)}function $e(Ne,we,Re,qe){return we===null||we.tag!==4||we.stateNode.containerInfo!==Re.containerInfo||we.stateNode.implementation!==Re.implementation?(we=t0(Re,Ne.mode,qe),we.return=Ne,we):(we=R(we,Re.children||[]),we.return=Ne,we)}function He(Ne,we,Re,qe,wt){return we===null||we.tag!==7?(we=Dc(Re,Ne.mode,qe,wt),we.return=Ne,we):(we=R(we,Re),we.return=Ne,we)}function Ze(Ne,we,Re){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return we=Ex(""+we,Ne.mode,Re),we.return=Ne,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case p:return Re=ip(we.type,we.key,we.props,null,Ne.mode,Re),Ox(Re,we),Re.return=Ne,Re;case x:return we=t0(we,Ne.mode,Re),we.return=Ne,we;case F:var qe=we._init;return we=qe(we._payload),Ze(Ne,we,Re)}if(M(we)||K(we))return we=Dc(we,Ne.mode,Re,null),we.return=Ne,we;if(typeof we.then=="function")return Ze(Ne,u_(we),Re);if(we.$$typeof===C)return Ze(Ne,Zv(Ne,we),Re);h_(Ne,we)}return null}function Pe(Ne,we,Re,qe){var wt=we!==null?we.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return wt!==null?null:le(Ne,we,""+Re,qe);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case p:return Re.key===wt?xe(Ne,we,Re,qe):null;case x:return Re.key===wt?$e(Ne,we,Re,qe):null;case F:return wt=Re._init,Re=wt(Re._payload),Pe(Ne,we,Re,qe)}if(M(Re)||K(Re))return wt!==null?null:He(Ne,we,Re,qe,null);if(typeof Re.then=="function")return Pe(Ne,we,u_(Re),qe);if(Re.$$typeof===C)return Pe(Ne,we,Zv(Ne,Re),qe);h_(Ne,Re)}return null}function Fe(Ne,we,Re,qe,wt){if(typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint")return Ne=Ne.get(Re)||null,le(we,Ne,""+qe,wt);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case p:return Ne=Ne.get(qe.key===null?Re:qe.key)||null,xe(we,Ne,qe,wt);case x:return Ne=Ne.get(qe.key===null?Re:qe.key)||null,$e(we,Ne,qe,wt);case F:var Ln=qe._init;return qe=Ln(qe._payload),Fe(Ne,we,Re,qe,wt)}if(M(qe)||K(qe))return Ne=Ne.get(Re)||null,He(we,Ne,qe,wt,null);if(typeof qe.then=="function")return Fe(Ne,we,Re,u_(qe),wt);if(qe.$$typeof===C)return Fe(Ne,we,Re,Zv(we,qe),wt);h_(we,qe)}return null}function Yt(Ne,we,Re,qe){for(var wt=null,Ln=null,Rt=we,Ht=we=0,Ri=null;Rt!==null&&Ht<Re.length;Ht++){Rt.index>Ht?(Ri=Rt,Rt=null):Ri=Rt.sibling;var dr=Pe(Ne,Rt,Re[Ht],qe);if(dr===null){Rt===null&&(Rt=Ri);break}h&&Rt&&dr.alternate===null&&f(Ne,Rt),we=j(dr,we,Ht),Ln===null?wt=dr:Ln.sibling=dr,Ln=dr,Rt=Ri}if(Ht===Re.length)return g(Ne,Rt),Qt&&ke(Ne,Ht),wt;if(Rt===null){for(;Ht<Re.length;Ht++)Rt=Ze(Ne,Re[Ht],qe),Rt!==null&&(we=j(Rt,we,Ht),Ln===null?wt=Rt:Ln.sibling=Rt,Ln=Rt);return Qt&&ke(Ne,Ht),wt}for(Rt=E(Rt);Ht<Re.length;Ht++)Ri=Fe(Rt,Ne,Ht,Re[Ht],qe),Ri!==null&&(h&&Ri.alternate!==null&&Rt.delete(Ri.key===null?Ht:Ri.key),we=j(Ri,we,Ht),Ln===null?wt=Ri:Ln.sibling=Ri,Ln=Ri);return h&&Rt.forEach(function(Cd){return f(Ne,Cd)}),Qt&&ke(Ne,Ht),wt}function jt(Ne,we,Re,qe){if(Re==null)throw Error(r(151));for(var wt=null,Ln=null,Rt=we,Ht=we=0,Ri=null,dr=Re.next();Rt!==null&&!dr.done;Ht++,dr=Re.next()){Rt.index>Ht?(Ri=Rt,Rt=null):Ri=Rt.sibling;var Cd=Pe(Ne,Rt,dr.value,qe);if(Cd===null){Rt===null&&(Rt=Ri);break}h&&Rt&&Cd.alternate===null&&f(Ne,Rt),we=j(Cd,we,Ht),Ln===null?wt=Cd:Ln.sibling=Cd,Ln=Cd,Rt=Ri}if(dr.done)return g(Ne,Rt),Qt&&ke(Ne,Ht),wt;if(Rt===null){for(;!dr.done;Ht++,dr=Re.next())dr=Ze(Ne,dr.value,qe),dr!==null&&(we=j(dr,we,Ht),Ln===null?wt=dr:Ln.sibling=dr,Ln=dr);return Qt&&ke(Ne,Ht),wt}for(Rt=E(Rt);!dr.done;Ht++,dr=Re.next())dr=Fe(Rt,Ne,Ht,dr.value,qe),dr!==null&&(h&&dr.alternate!==null&&Rt.delete(dr.key===null?Ht:dr.key),we=j(dr,we,Ht),Ln===null?wt=dr:Ln.sibling=dr,Ln=dr);return h&&Rt.forEach(function(Pre){return f(Ne,Pre)}),Qt&&ke(Ne,Ht),wt}function Nr(Ne,we,Re,qe){if(typeof Re=="object"&&Re!==null&&Re.type===y&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case p:e:{for(var wt=Re.key;we!==null;){if(we.key===wt){if(wt=Re.type,wt===y){if(we.tag===7){g(Ne,we.sibling),qe=R(we,Re.props.children),qe.return=Ne,Ne=qe;break e}}else if(we.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===F&&eP(wt)===we.type){g(Ne,we.sibling),qe=R(we,Re.props),Ox(qe,Re),qe.return=Ne,Ne=qe;break e}g(Ne,we);break}else f(Ne,we);we=we.sibling}Re.type===y?(qe=Dc(Re.props.children,Ne.mode,qe,Re.key),qe.return=Ne,Ne=qe):(qe=ip(Re.type,Re.key,Re.props,null,Ne.mode,qe),Ox(qe,Re),qe.return=Ne,Ne=qe)}return ie(Ne);case x:e:{for(wt=Re.key;we!==null;){if(we.key===wt)if(we.tag===4&&we.stateNode.containerInfo===Re.containerInfo&&we.stateNode.implementation===Re.implementation){g(Ne,we.sibling),qe=R(we,Re.children||[]),qe.return=Ne,Ne=qe;break e}else{g(Ne,we);break}else f(Ne,we);we=we.sibling}qe=t0(Re,Ne.mode,qe),qe.return=Ne,Ne=qe}return ie(Ne);case F:return wt=Re._init,Re=wt(Re._payload),Nr(Ne,we,Re,qe)}if(M(Re))return Yt(Ne,we,Re,qe);if(K(Re)){if(wt=K(Re),typeof wt!="function")throw Error(r(150));return Re=wt.call(Re),jt(Ne,we,Re,qe)}if(typeof Re.then=="function")return Nr(Ne,we,u_(Re),qe);if(Re.$$typeof===C)return Nr(Ne,we,Zv(Ne,Re),qe);h_(Ne,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint"?(Re=""+Re,we!==null&&we.tag===6?(g(Ne,we.sibling),qe=R(we,Re),qe.return=Ne,Ne=qe):(g(Ne,we),qe=Ex(Re,Ne.mode,qe),qe.return=Ne,Ne=qe),ie(Ne)):g(Ne,we)}return function(Ne,we,Re,qe){try{Px=0;var wt=Nr(Ne,we,Re,qe);return c0=null,wt}catch(Rt){if(Rt===Cx||Rt===Jv)throw Rt;var Ln=qa(29,Rt,null,Ne.mode);return Ln.lanes=qe,Ln.return=Ne,Ln}finally{}}}var u0=tP(!0),nP=tP(!1),pl=z(null),Lc=null;function hd(h){var f=h.alternate;X(li,li.current&1),X(pl,h),Lc===null&&(f===null||i0.current!==null||f.memoizedState!==null)&&(Lc=h)}function rP(h){if(h.tag===22){if(X(li,li.current),X(pl,h),Lc===null){var f=h.alternate;f!==null&&f.memoizedState!==null&&(Lc=h)}}else dd()}function dd(){X(li,li.current),X(pl,pl.current)}function Xu(h){D(pl),Lc===h&&(Lc=null),D(li)}var li=z(0);function d_(h){for(var f=h;f!==null;){if(f.tag===13){var g=f.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||rN(g)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===h)break;for(;f.sibling===null;){if(f.return===null||f.return===h)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function pA(h,f,g,E){f=h.memoizedState,g=g(E,f),g=g==null?f:u({},f,g),h.memoizedState=g,h.lanes===0&&(h.updateQueue.baseState=g)}var mA={enqueueSetState:function(h,f,g){h=h._reactInternals;var E=Vo(),R=ld(E);R.payload=f,g!=null&&(R.callback=g),f=cd(h,R,E),f!==null&&(Uo(f,h,E),Nx(f,h,E))},enqueueReplaceState:function(h,f,g){h=h._reactInternals;var E=Vo(),R=ld(E);R.tag=1,R.payload=f,g!=null&&(R.callback=g),f=cd(h,R,E),f!==null&&(Uo(f,h,E),Nx(f,h,E))},enqueueForceUpdate:function(h,f){h=h._reactInternals;var g=Vo(),E=ld(g);E.tag=2,f!=null&&(E.callback=f),f=cd(h,E,g),f!==null&&(Uo(f,h,g),Nx(f,h,g))}};function sP(h,f,g,E,R,j,ie){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(E,j,ie):f.prototype&&f.prototype.isPureReactComponent?!Ga(g,E)||!Ga(R,j):!0}function iP(h,f,g,E){h=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(g,E),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(g,E),f.state!==h&&mA.enqueueReplaceState(f,f.state,null)}function dp(h,f){var g=f;if("ref"in f){g={};for(var E in f)E!=="ref"&&(g[E]=f[E])}if(h=h.defaultProps){g===f&&(g=u({},g));for(var R in h)g[R]===void 0&&(g[R]=h[R])}return g}var f_=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)};function aP(h){f_(h)}function oP(h){console.error(h)}function lP(h){f_(h)}function p_(h,f){try{var g=h.onUncaughtError;g(f.value,{componentStack:f.stack})}catch(E){setTimeout(function(){throw E})}}function cP(h,f,g){try{var E=h.onCaughtError;E(g.value,{componentStack:g.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(R){setTimeout(function(){throw R})}}function gA(h,f,g){return g=ld(g),g.tag=3,g.payload={element:null},g.callback=function(){p_(h,f)},g}function uP(h){return h=ld(h),h.tag=3,h}function hP(h,f,g,E){var R=g.type.getDerivedStateFromError;if(typeof R=="function"){var j=E.value;h.payload=function(){return R(j)},h.callback=function(){cP(f,g,E)}}var ie=g.stateNode;ie!==null&&typeof ie.componentDidCatch=="function"&&(h.callback=function(){cP(f,g,E),typeof R!="function"&&(yd===null?yd=new Set([this]):yd.add(this));var le=E.stack;this.componentDidCatch(E.value,{componentStack:le!==null?le:""})})}function Pne(h,f,g,E,R){if(g.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){if(f=g.alternate,f!==null&&lp(f,g,R,!0),g=pl.current,g!==null){switch(g.tag){case 13:return Lc===null?zA():g.alternate===null&&ys===0&&(ys=3),g.flags&=-257,g.flags|=65536,g.lanes=R,E===HC?g.flags|=16384:(f=g.updateQueue,f===null?g.updateQueue=new Set([E]):f.add(E),VA(h,E,R)),!1;case 22:return g.flags|=65536,E===HC?g.flags|=16384:(f=g.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([E])},g.updateQueue=f):(g=f.retryQueue,g===null?f.retryQueue=new Set([E]):g.add(E)),VA(h,E,R)),!1}throw Error(r(435,g.tag))}return VA(h,E,R),zA(),!1}if(Qt)return f=pl.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=R,E!==Ni&&(h=Error(r(422),{cause:E}),ad(Ha(h,g)))):(E!==Ni&&(f=Error(r(423),{cause:E}),ad(Ha(f,g))),h=h.current.alternate,h.flags|=65536,R&=-R,h.lanes|=R,E=Ha(E,g),R=gA(h.stateNode,E,R),KC(h,R),ys!==4&&(ys=2)),!1;var j=Error(r(520),{cause:E});if(j=Ha(j,g),Ux===null?Ux=[j]:Ux.push(j),ys!==4&&(ys=2),f===null)return!0;E=Ha(E,g),g=f;do{switch(g.tag){case 3:return g.flags|=65536,h=R&-R,g.lanes|=h,h=gA(g.stateNode,E,h),KC(g,h),!1;case 1:if(f=g.type,j=g.stateNode,(g.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(yd===null||!yd.has(j))))return g.flags|=65536,R&=-R,g.lanes|=R,R=uP(R),hP(R,h,g,E),KC(g,R),!1}g=g.return}while(g!==null);return!1}var dP=Error(r(461)),ki=!1;function Vi(h,f,g,E){f.child=h===null?nP(f,null,g,E):u0(f,h.child,g,E)}function fP(h,f,g,E,R){g=g.render;var j=f.ref;if("ref"in E){var ie={};for(var le in E)le!=="ref"&&(ie[le]=E[le])}else ie=E;return cp(f),E=JC(h,f,g,ie,j,R),le=eA(),h!==null&&!ki?(tA(h,f,R),Yu(h,f,R)):(Qt&&le&&Je(f),f.flags|=1,Vi(h,f,E,R),f.child)}function pP(h,f,g,E,R){if(h===null){var j=g.type;return typeof j=="function"&&!e0(j)&&j.defaultProps===void 0&&g.compare===null?(f.tag=15,f.type=j,mP(h,f,j,E,R)):(h=ip(g.type,null,E,f,f.mode,R),h.ref=f.ref,h.return=f,f.child=h)}if(j=h.child,!SA(h,R)){var ie=j.memoizedProps;if(g=g.compare,g=g!==null?g:Ga,g(ie,E)&&h.ref===f.ref)return Yu(h,f,R)}return f.flags|=1,h=dl(j,E),h.ref=f.ref,h.return=f,f.child=h}function mP(h,f,g,E,R){if(h!==null){var j=h.memoizedProps;if(Ga(j,E)&&h.ref===f.ref)if(ki=!1,f.pendingProps=E=j,SA(h,R))(h.flags&131072)!==0&&(ki=!0);else return f.lanes=h.lanes,Yu(h,f,R)}return xA(h,f,g,E,R)}function gP(h,f,g){var E=f.pendingProps,R=E.children,j=h!==null?h.memoizedState:null;if(E.mode==="hidden"){if((f.flags&128)!==0){if(E=j!==null?j.baseLanes|g:g,h!==null){for(R=f.child=h.child,j=0;R!==null;)j=j|R.lanes|R.childLanes,R=R.sibling;f.childLanes=j&~E}else f.childLanes=0,f.child=null;return xP(h,f,E,g)}if((g&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},h!==null&&Qv(f,j!==null?j.cachePool:null),j!==null?mL(f,j):YC(),rP(f);else return f.lanes=f.childLanes=536870912,xP(h,f,j!==null?j.baseLanes|g:g,g)}else j!==null?(Qv(f,j.cachePool),mL(f,j),dd(),f.memoizedState=null):(h!==null&&Qv(f,null),YC(),dd());return Vi(h,f,R,g),f.child}function xP(h,f,g,E){var R=GC();return R=R===null?null:{parent:oi._currentValue,pool:R},f.memoizedState={baseLanes:g,cachePool:R},h!==null&&Qv(f,null),YC(),rP(f),h!==null&&lp(h,f,E,!0),null}function m_(h,f){var g=f.ref;if(g===null)h!==null&&h.ref!==null&&(f.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(r(284));(h===null||h.ref!==g)&&(f.flags|=4194816)}}function xA(h,f,g,E,R){return cp(f),g=JC(h,f,g,E,void 0,R),E=eA(),h!==null&&!ki?(tA(h,f,R),Yu(h,f,R)):(Qt&&E&&Je(f),f.flags|=1,Vi(h,f,g,R),f.child)}function yP(h,f,g,E,R,j){return cp(f),f.updateQueue=null,g=xL(f,E,g,R),gL(h),E=eA(),h!==null&&!ki?(tA(h,f,j),Yu(h,f,j)):(Qt&&E&&Je(f),f.flags|=1,Vi(h,f,g,j),f.child)}function bP(h,f,g,E,R){if(cp(f),f.stateNode===null){var j=Wu,ie=g.contextType;typeof ie=="object"&&ie!==null&&(j=pa(ie)),j=new g(E,j),f.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,j.updater=mA,f.stateNode=j,j._reactInternals=f,j=f.stateNode,j.props=E,j.state=f.memoizedState,j.refs={},WC(f),ie=g.contextType,j.context=typeof ie=="object"&&ie!==null?pa(ie):Wu,j.state=f.memoizedState,ie=g.getDerivedStateFromProps,typeof ie=="function"&&(pA(f,g,ie,E),j.state=f.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(ie=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),ie!==j.state&&mA.enqueueReplaceState(j,j.state,null),Ix(f,E,j,R),kx(),j.state=f.memoizedState),typeof j.componentDidMount=="function"&&(f.flags|=4194308),E=!0}else if(h===null){j=f.stateNode;var le=f.memoizedProps,xe=dp(g,le);j.props=xe;var $e=j.context,He=g.contextType;ie=Wu,typeof He=="object"&&He!==null&&(ie=pa(He));var Ze=g.getDerivedStateFromProps;He=typeof Ze=="function"||typeof j.getSnapshotBeforeUpdate=="function",le=f.pendingProps!==le,He||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(le||$e!==ie)&&iP(f,j,E,ie),od=!1;var Pe=f.memoizedState;j.state=Pe,Ix(f,E,j,R),kx(),$e=f.memoizedState,le||Pe!==$e||od?(typeof Ze=="function"&&(pA(f,g,Ze,E),$e=f.memoizedState),(xe=od||sP(f,g,xe,E,Pe,$e,ie))?(He||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(f.flags|=4194308)):(typeof j.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=E,f.memoizedState=$e),j.props=E,j.state=$e,j.context=ie,E=xe):(typeof j.componentDidMount=="function"&&(f.flags|=4194308),E=!1)}else{j=f.stateNode,qC(h,f),ie=f.memoizedProps,He=dp(g,ie),j.props=He,Ze=f.pendingProps,Pe=j.context,$e=g.contextType,xe=Wu,typeof $e=="object"&&$e!==null&&(xe=pa($e)),le=g.getDerivedStateFromProps,($e=typeof le=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(ie!==Ze||Pe!==xe)&&iP(f,j,E,xe),od=!1,Pe=f.memoizedState,j.state=Pe,Ix(f,E,j,R),kx();var Fe=f.memoizedState;ie!==Ze||Pe!==Fe||od||h!==null&&h.dependencies!==null&&Yv(h.dependencies)?(typeof le=="function"&&(pA(f,g,le,E),Fe=f.memoizedState),(He=od||sP(f,g,He,E,Pe,Fe,xe)||h!==null&&h.dependencies!==null&&Yv(h.dependencies))?($e||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(E,Fe,xe),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(E,Fe,xe)),typeof j.componentDidUpdate=="function"&&(f.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof j.componentDidUpdate!="function"||ie===h.memoizedProps&&Pe===h.memoizedState||(f.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||ie===h.memoizedProps&&Pe===h.memoizedState||(f.flags|=1024),f.memoizedProps=E,f.memoizedState=Fe),j.props=E,j.state=Fe,j.context=xe,E=He):(typeof j.componentDidUpdate!="function"||ie===h.memoizedProps&&Pe===h.memoizedState||(f.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||ie===h.memoizedProps&&Pe===h.memoizedState||(f.flags|=1024),E=!1)}return j=E,m_(h,f),E=(f.flags&128)!==0,j||E?(j=f.stateNode,g=E&&typeof g.getDerivedStateFromError!="function"?null:j.render(),f.flags|=1,h!==null&&E?(f.child=u0(f,h.child,null,R),f.child=u0(f,null,g,R)):Vi(h,f,g,R),f.memoizedState=j.state,h=f.child):h=Yu(h,f,R),h}function vP(h,f,g,E){return id(),f.flags|=256,Vi(h,f,g,E),f.child}var yA={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bA(h){return{baseLanes:h,cachePool:oL()}}function vA(h,f,g){return h=h!==null?h.childLanes&~g:0,f&&(h|=ml),h}function _P(h,f,g){var E=f.pendingProps,R=!1,j=(f.flags&128)!==0,ie;if((ie=j)||(ie=h!==null&&h.memoizedState===null?!1:(li.current&2)!==0),ie&&(R=!0,f.flags&=-129),ie=(f.flags&32)!==0,f.flags&=-33,h===null){if(Qt){if(R?hd(f):dd(),Qt){var le=At,xe;if(xe=le){e:{for(xe=le,le=cs;xe.nodeType!==8;){if(!le){le=null;break e}if(xe=Yl(xe.nextSibling),xe===null){le=null;break e}}le=xe}le!==null?(f.memoizedState={dehydrated:le,treeContext:ee!==null?{id:oe,overflow:ge}:null,retryLane:536870912,hydrationErrors:null},xe=qa(18,null,null,0),xe.stateNode=le,xe.return=f,f.child=xe,vt=f,At=null,xe=!0):xe=!1}xe||ao(f)}if(le=f.memoizedState,le!==null&&(le=le.dehydrated,le!==null))return rN(le)?f.lanes=32:f.lanes=536870912,null;Xu(f)}return le=E.children,E=E.fallback,R?(dd(),R=f.mode,le=g_({mode:"hidden",children:le},R),E=Dc(E,R,g,null),le.return=f,E.return=f,le.sibling=E,f.child=le,R=f.child,R.memoizedState=bA(g),R.childLanes=vA(h,ie,g),f.memoizedState=yA,E):(hd(f),_A(f,le))}if(xe=h.memoizedState,xe!==null&&(le=xe.dehydrated,le!==null)){if(j)f.flags&256?(hd(f),f.flags&=-257,f=wA(h,f,g)):f.memoizedState!==null?(dd(),f.child=h.child,f.flags|=128,f=null):(dd(),R=E.fallback,le=f.mode,E=g_({mode:"visible",children:E.children},le),R=Dc(R,le,g,null),R.flags|=2,E.return=f,R.return=f,E.sibling=R,f.child=E,u0(f,h.child,null,g),E=f.child,E.memoizedState=bA(g),E.childLanes=vA(h,ie,g),f.memoizedState=yA,f=R);else if(hd(f),rN(le)){if(ie=le.nextSibling&&le.nextSibling.dataset,ie)var $e=ie.dgst;ie=$e,E=Error(r(419)),E.stack="",E.digest=ie,ad({value:E,source:null,stack:null}),f=wA(h,f,g)}else if(ki||lp(h,f,g,!1),ie=(g&h.childLanes)!==0,ki||ie){if(ie=jr,ie!==null&&(E=g&-g,E=(E&42)!==0?1:yi(E),E=(E&(ie.suspendedLanes|g))!==0?0:E,E!==0&&E!==xe.retryLane))throw xe.retryLane=E,rd(h,E),Uo(ie,h,E),dP;le.data==="$?"||zA(),f=wA(h,f,g)}else le.data==="$?"?(f.flags|=192,f.child=h.child,f=null):(h=xe.treeContext,At=Yl(le.nextSibling),vt=f,Qt=!0,zr=null,cs=!1,h!==null&&(k[H++]=oe,k[H++]=ge,k[H++]=ee,oe=h.id,ge=h.overflow,ee=f),f=_A(f,E.children),f.flags|=4096);return f}return R?(dd(),R=E.fallback,le=f.mode,xe=h.child,$e=xe.sibling,E=dl(xe,{mode:"hidden",children:E.children}),E.subtreeFlags=xe.subtreeFlags&65011712,$e!==null?R=dl($e,R):(R=Dc(R,le,g,null),R.flags|=2),R.return=f,E.return=f,E.sibling=R,f.child=E,E=R,R=f.child,le=h.child.memoizedState,le===null?le=bA(g):(xe=le.cachePool,xe!==null?($e=oi._currentValue,xe=xe.parent!==$e?{parent:$e,pool:$e}:xe):xe=oL(),le={baseLanes:le.baseLanes|g,cachePool:xe}),R.memoizedState=le,R.childLanes=vA(h,ie,g),f.memoizedState=yA,E):(hd(f),g=h.child,h=g.sibling,g=dl(g,{mode:"visible",children:E.children}),g.return=f,g.sibling=null,h!==null&&(ie=f.deletions,ie===null?(f.deletions=[h],f.flags|=16):ie.push(h)),f.child=g,f.memoizedState=null,g)}function _A(h,f){return f=g_({mode:"visible",children:f},h.mode),f.return=h,h.child=f}function g_(h,f){return h=qa(22,h,null,f),h.lanes=0,h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},h}function wA(h,f,g){return u0(f,h.child,null,g),h=_A(f,f.pendingProps.children),h.flags|=2,f.memoizedState=null,h}function wP(h,f,g){h.lanes|=f;var E=h.alternate;E!==null&&(E.lanes|=f),op(h.return,f,g)}function EA(h,f,g,E,R){var j=h.memoizedState;j===null?h.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:E,tail:g,tailMode:R}:(j.isBackwards=f,j.rendering=null,j.renderingStartTime=0,j.last=E,j.tail=g,j.tailMode=R)}function EP(h,f,g){var E=f.pendingProps,R=E.revealOrder,j=E.tail;if(Vi(h,f,E.children,g),E=li.current,(E&2)!==0)E=E&1|2,f.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=f.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&wP(h,g,f);else if(h.tag===19)wP(h,g,f);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===f)break e;for(;h.sibling===null;){if(h.return===null||h.return===f)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}E&=1}switch(X(li,E),R){case"forwards":for(g=f.child,R=null;g!==null;)h=g.alternate,h!==null&&d_(h)===null&&(R=g),g=g.sibling;g=R,g===null?(R=f.child,f.child=null):(R=g.sibling,g.sibling=null),EA(f,!1,R,g,j);break;case"backwards":for(g=null,R=f.child,f.child=null;R!==null;){if(h=R.alternate,h!==null&&d_(h)===null){f.child=R;break}h=R.sibling,R.sibling=g,g=R,R=h}EA(f,!0,g,null,j);break;case"together":EA(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Yu(h,f,g){if(h!==null&&(f.dependencies=h.dependencies),xd|=f.lanes,(g&f.childLanes)===0)if(h!==null){if(lp(h,f,g,!1),(g&f.childLanes)===0)return null}else return null;if(h!==null&&f.child!==h.child)throw Error(r(153));if(f.child!==null){for(h=f.child,g=dl(h,h.pendingProps),f.child=g,g.return=f;h.sibling!==null;)h=h.sibling,g=g.sibling=dl(h,h.pendingProps),g.return=f;g.sibling=null}return f.child}function SA(h,f){return(h.lanes&f)!==0?!0:(h=h.dependencies,!!(h!==null&&Yv(h)))}function One(h,f,g){switch(f.tag){case 3:de(f,f.stateNode.containerInfo),$c(f,oi,h.memoizedState.cache),id();break;case 27:case 5:Ve(f);break;case 4:de(f,f.stateNode.containerInfo);break;case 10:$c(f,f.type,f.memoizedProps.value);break;case 13:var E=f.memoizedState;if(E!==null)return E.dehydrated!==null?(hd(f),f.flags|=128,null):(g&f.child.childLanes)!==0?_P(h,f,g):(hd(f),h=Yu(h,f,g),h!==null?h.sibling:null);hd(f);break;case 19:var R=(h.flags&128)!==0;if(E=(g&f.childLanes)!==0,E||(lp(h,f,g,!1),E=(g&f.childLanes)!==0),R){if(E)return EP(h,f,g);f.flags|=128}if(R=f.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),X(li,li.current),E)break;return null;case 22:case 23:return f.lanes=0,gP(h,f,g);case 24:$c(f,oi,h.memoizedState.cache)}return Yu(h,f,g)}function SP(h,f,g){if(h!==null)if(h.memoizedProps!==f.pendingProps)ki=!0;else{if(!SA(h,g)&&(f.flags&128)===0)return ki=!1,One(h,f,g);ki=(h.flags&131072)!==0}else ki=!1,Qt&&(f.flags&1048576)!==0&&Be(f,w,f.index);switch(f.lanes=0,f.tag){case 16:e:{h=f.pendingProps;var E=f.elementType,R=E._init;if(E=R(E._payload),f.type=E,typeof E=="function")e0(E)?(h=dp(E,h),f.tag=1,f=bP(null,f,E,h,g)):(f.tag=0,f=xA(null,f,E,h,g));else{if(E!=null){if(R=E.$$typeof,R===I){f.tag=11,f=fP(null,f,E,h,g);break e}else if(R===U){f.tag=14,f=pP(null,f,E,h,g);break e}}throw f=N(E)||E,Error(r(306,f,""))}}return f;case 0:return xA(h,f,f.type,f.pendingProps,g);case 1:return E=f.type,R=dp(E,f.pendingProps),bP(h,f,E,R,g);case 3:e:{if(de(f,f.stateNode.containerInfo),h===null)throw Error(r(387));E=f.pendingProps;var j=f.memoizedState;R=j.element,qC(h,f),Ix(f,E,null,g);var ie=f.memoizedState;if(E=ie.cache,$c(f,oi,E),E!==j.cache&&n0(f,[oi],g,!0),kx(),E=ie.element,j.isDehydrated)if(j={element:E,isDehydrated:!1,cache:ie.cache},f.updateQueue.baseState=j,f.memoizedState=j,f.flags&256){f=vP(h,f,E,g);break e}else if(E!==R){R=Ha(Error(r(424)),f),ad(R),f=vP(h,f,E,g);break e}else{switch(h=f.stateNode.containerInfo,h.nodeType){case 9:h=h.body;break;default:h=h.nodeName==="HTML"?h.ownerDocument.body:h}for(At=Yl(h.firstChild),vt=f,Qt=!0,zr=null,cs=!0,g=nP(f,null,E,g),f.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(id(),E===R){f=Yu(h,f,g);break e}Vi(h,f,E,g)}f=f.child}return f;case 26:return m_(h,f),h===null?(g=NO(f.type,null,f.pendingProps,null))?f.memoizedState=g:Qt||(g=f.type,h=f.pendingProps,E=I_(ae.current).createElement(g),E[zt]=f,E[pn]=h,Gi(E,g,h),ur(E),f.stateNode=E):f.memoizedState=NO(f.type,h.memoizedProps,f.pendingProps,h.memoizedState),null;case 27:return Ve(f),h===null&&Qt&&(E=f.stateNode=TO(f.type,f.pendingProps,ae.current),vt=f,cs=!0,R=At,_d(f.type)?(sN=R,At=Yl(E.firstChild)):At=R),Vi(h,f,f.pendingProps.children,g),m_(h,f),h===null&&(f.flags|=4194304),f.child;case 5:return h===null&&Qt&&((R=E=At)&&(E=ure(E,f.type,f.pendingProps,cs),E!==null?(f.stateNode=E,vt=f,At=Yl(E.firstChild),cs=!1,R=!0):R=!1),R||ao(f)),Ve(f),R=f.type,j=f.pendingProps,ie=h!==null?h.memoizedProps:null,E=j.children,eN(R,j)?E=null:ie!==null&&eN(R,ie)&&(f.flags|=32),f.memoizedState!==null&&(R=JC(h,f,Nne,null,null,g),Qx._currentValue=R),m_(h,f),Vi(h,f,E,g),f.child;case 6:return h===null&&Qt&&((h=g=At)&&(g=hre(g,f.pendingProps,cs),g!==null?(f.stateNode=g,vt=f,At=null,h=!0):h=!1),h||ao(f)),null;case 13:return _P(h,f,g);case 4:return de(f,f.stateNode.containerInfo),E=f.pendingProps,h===null?f.child=u0(f,null,E,g):Vi(h,f,E,g),f.child;case 11:return fP(h,f,f.type,f.pendingProps,g);case 7:return Vi(h,f,f.pendingProps,g),f.child;case 8:return Vi(h,f,f.pendingProps.children,g),f.child;case 12:return Vi(h,f,f.pendingProps.children,g),f.child;case 10:return E=f.pendingProps,$c(f,f.type,E.value),Vi(h,f,E.children,g),f.child;case 9:return R=f.type._context,E=f.pendingProps.children,cp(f),R=pa(R),E=E(R),f.flags|=1,Vi(h,f,E,g),f.child;case 14:return pP(h,f,f.type,f.pendingProps,g);case 15:return mP(h,f,f.type,f.pendingProps,g);case 19:return EP(h,f,g);case 31:return E=f.pendingProps,g=f.mode,E={mode:E.mode,children:E.children},h===null?(g=g_(E,g),g.ref=f.ref,f.child=g,g.return=f,f=g):(g=dl(h.child,E),g.ref=f.ref,f.child=g,g.return=f,f=g),f;case 22:return gP(h,f,g);case 24:return cp(f),E=pa(oi),h===null?(R=GC(),R===null&&(R=jr,j=VC(),R.pooledCache=j,j.refCount++,j!==null&&(R.pooledCacheLanes|=g),R=j),f.memoizedState={parent:E,cache:R},WC(f),$c(f,oi,R)):((h.lanes&g)!==0&&(qC(h,f),Ix(f,null,null,g),kx()),R=h.memoizedState,j=f.memoizedState,R.parent!==E?(R={parent:E,cache:E},f.memoizedState=R,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=R),$c(f,oi,E)):(E=j.cache,$c(f,oi,E),E!==R.cache&&n0(f,[oi],g,!0))),Vi(h,f,f.pendingProps.children,g),f.child;case 29:throw f.pendingProps}throw Error(r(156,f.tag))}function Zu(h){h.flags|=4}function TP(h,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)h.flags&=-16777217;else if(h.flags|=16777216,!$O(f)){if(f=pl.current,f!==null&&((sr&4194048)===sr?Lc!==null:(sr&62914560)!==sr&&(sr&536870912)===0||f!==Lc))throw Ax=HC,lL;h.flags|=8192}}function x_(h,f){f!==null&&(h.flags|=4),h.flags&16384&&(f=h.tag!==22?ms():536870912,h.lanes|=f,p0|=f)}function Mx(h,f){if(!Qt)switch(h.tailMode){case"hidden":f=h.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?h.tail=null:g.sibling=null;break;case"collapsed":g=h.tail;for(var E=null;g!==null;)g.alternate!==null&&(E=g),g=g.sibling;E===null?f||h.tail===null?h.tail=null:h.tail.sibling=null:E.sibling=null}}function us(h){var f=h.alternate!==null&&h.alternate.child===h.child,g=0,E=0;if(f)for(var R=h.child;R!==null;)g|=R.lanes|R.childLanes,E|=R.subtreeFlags&65011712,E|=R.flags&65011712,R.return=h,R=R.sibling;else for(R=h.child;R!==null;)g|=R.lanes|R.childLanes,E|=R.subtreeFlags,E|=R.flags,R.return=h,R=R.sibling;return h.subtreeFlags|=E,h.childLanes=g,f}function Mne(h,f,g){var E=f.pendingProps;switch(ft(f),f.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return us(f),null;case 1:return us(f),null;case 3:return g=f.stateNode,E=null,h!==null&&(E=h.memoizedState.cache),f.memoizedState.cache!==E&&(f.flags|=2048),Kl(oi),ve(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(h===null||h.child===null)&&(ap(f)?Zu(f):h===null||h.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Xv())),us(f),null;case 26:return g=f.memoizedState,h===null?(Zu(f),g!==null?(us(f),TP(f,g)):(us(f),f.flags&=-16777217)):g?g!==h.memoizedState?(Zu(f),us(f),TP(f,g)):(us(f),f.flags&=-16777217):(h.memoizedProps!==E&&Zu(f),us(f),f.flags&=-16777217),null;case 27:ze(f),g=ae.current;var R=f.type;if(h!==null&&f.stateNode!=null)h.memoizedProps!==E&&Zu(f);else{if(!E){if(f.stateNode===null)throw Error(r(166));return us(f),null}h=re.current,ap(f)?qv(f):(h=TO(R,E,g),f.stateNode=h,Zu(f))}return us(f),null;case 5:if(ze(f),g=f.type,h!==null&&f.stateNode!=null)h.memoizedProps!==E&&Zu(f);else{if(!E){if(f.stateNode===null)throw Error(r(166));return us(f),null}if(h=re.current,ap(f))qv(f);else{switch(R=I_(ae.current),h){case 1:h=R.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:h=R.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":h=R.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":h=R.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":h=R.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof E.is=="string"?R.createElement("select",{is:E.is}):R.createElement("select"),E.multiple?h.multiple=!0:E.size&&(h.size=E.size);break;default:h=typeof E.is=="string"?R.createElement(g,{is:E.is}):R.createElement(g)}}h[zt]=f,h[pn]=E;e:for(R=f.child;R!==null;){if(R.tag===5||R.tag===6)h.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===f)break e;for(;R.sibling===null;){if(R.return===null||R.return===f)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}f.stateNode=h;e:switch(Gi(h,g,E),g){case"button":case"input":case"select":case"textarea":h=!!E.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Zu(f)}}return us(f),f.flags&=-16777217,null;case 6:if(h&&f.stateNode!=null)h.memoizedProps!==E&&Zu(f);else{if(typeof E!="string"&&f.stateNode===null)throw Error(r(166));if(h=ae.current,ap(f)){if(h=f.stateNode,g=f.memoizedProps,E=null,R=vt,R!==null)switch(R.tag){case 27:case 5:E=R.memoizedProps}h[zt]=f,h=!!(h.nodeValue===g||E!==null&&E.suppressHydrationWarning===!0||yO(h.nodeValue,g)),h||ao(f)}else h=I_(h).createTextNode(E),h[zt]=f,f.stateNode=h}return us(f),null;case 13:if(E=f.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(R=ap(f),E!==null&&E.dehydrated!==null){if(h===null){if(!R)throw Error(r(318));if(R=f.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(r(317));R[zt]=f}else id(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;us(f),R=!1}else R=Xv(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=R),R=!0;if(!R)return f.flags&256?(Xu(f),f):(Xu(f),null)}if(Xu(f),(f.flags&128)!==0)return f.lanes=g,f;if(g=E!==null,h=h!==null&&h.memoizedState!==null,g){E=f.child,R=null,E.alternate!==null&&E.alternate.memoizedState!==null&&E.alternate.memoizedState.cachePool!==null&&(R=E.alternate.memoizedState.cachePool.pool);var j=null;E.memoizedState!==null&&E.memoizedState.cachePool!==null&&(j=E.memoizedState.cachePool.pool),j!==R&&(E.flags|=2048)}return g!==h&&g&&(f.child.flags|=8192),x_(f,f.updateQueue),us(f),null;case 4:return ve(),h===null&&XA(f.stateNode.containerInfo),us(f),null;case 10:return Kl(f.type),us(f),null;case 19:if(D(li),R=f.memoizedState,R===null)return us(f),null;if(E=(f.flags&128)!==0,j=R.rendering,j===null)if(E)Mx(R,!1);else{if(ys!==0||h!==null&&(h.flags&128)!==0)for(h=f.child;h!==null;){if(j=d_(h),j!==null){for(f.flags|=128,Mx(R,!1),h=j.updateQueue,f.updateQueue=h,x_(f,h),f.subtreeFlags=0,h=g,g=f.child;g!==null;)wx(g,h),g=g.sibling;return X(li,li.current&1|2),f.child}h=h.sibling}R.tail!==null&&ct()>v_&&(f.flags|=128,E=!0,Mx(R,!1),f.lanes=4194304)}else{if(!E)if(h=d_(j),h!==null){if(f.flags|=128,E=!0,h=h.updateQueue,f.updateQueue=h,x_(f,h),Mx(R,!0),R.tail===null&&R.tailMode==="hidden"&&!j.alternate&&!Qt)return us(f),null}else 2*ct()-R.renderingStartTime>v_&&g!==536870912&&(f.flags|=128,E=!0,Mx(R,!1),f.lanes=4194304);R.isBackwards?(j.sibling=f.child,f.child=j):(h=R.last,h!==null?h.sibling=j:f.child=j,R.last=j)}return R.tail!==null?(f=R.tail,R.rendering=f,R.tail=f.sibling,R.renderingStartTime=ct(),f.sibling=null,h=li.current,X(li,E?h&1|2:h&1),f):(us(f),null);case 22:case 23:return Xu(f),ZC(),E=f.memoizedState!==null,h!==null?h.memoizedState!==null!==E&&(f.flags|=8192):E&&(f.flags|=8192),E?(g&536870912)!==0&&(f.flags&128)===0&&(us(f),f.subtreeFlags&6&&(f.flags|=8192)):us(f),g=f.updateQueue,g!==null&&x_(f,g.retryQueue),g=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(g=h.memoizedState.cachePool.pool),E=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(E=f.memoizedState.cachePool.pool),E!==g&&(f.flags|=2048),h!==null&&D(up),null;case 24:return g=null,h!==null&&(g=h.memoizedState.cache),f.memoizedState.cache!==g&&(f.flags|=2048),Kl(oi),us(f),null;case 25:return null;case 30:return null}throw Error(r(156,f.tag))}function Fne(h,f){switch(ft(f),f.tag){case 1:return h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 3:return Kl(oi),ve(),h=f.flags,(h&65536)!==0&&(h&128)===0?(f.flags=h&-65537|128,f):null;case 26:case 27:case 5:return ze(f),null;case 13:if(Xu(f),h=f.memoizedState,h!==null&&h.dehydrated!==null){if(f.alternate===null)throw Error(r(340));id()}return h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 19:return D(li),null;case 4:return ve(),null;case 10:return Kl(f.type),null;case 22:case 23:return Xu(f),ZC(),h!==null&&D(up),h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 24:return Kl(oi),null;case 25:return null;default:return null}}function CP(h,f){switch(ft(f),f.tag){case 3:Kl(oi),ve();break;case 26:case 27:case 5:ze(f);break;case 4:ve();break;case 13:Xu(f);break;case 19:D(li);break;case 10:Kl(f.type);break;case 22:case 23:Xu(f),ZC(),h!==null&&D(up);break;case 24:Kl(oi)}}function Fx(h,f){try{var g=f.updateQueue,E=g!==null?g.lastEffect:null;if(E!==null){var R=E.next;g=R;do{if((g.tag&h)===h){E=void 0;var j=g.create,ie=g.inst;E=j(),ie.destroy=E}g=g.next}while(g!==R)}}catch(le){Dr(f,f.return,le)}}function fd(h,f,g){try{var E=f.updateQueue,R=E!==null?E.lastEffect:null;if(R!==null){var j=R.next;E=j;do{if((E.tag&h)===h){var ie=E.inst,le=ie.destroy;if(le!==void 0){ie.destroy=void 0,R=f;var xe=g,$e=le;try{$e()}catch(He){Dr(R,xe,He)}}}E=E.next}while(E!==j)}}catch(He){Dr(f,f.return,He)}}function AP(h){var f=h.updateQueue;if(f!==null){var g=h.stateNode;try{pL(f,g)}catch(E){Dr(h,h.return,E)}}}function NP(h,f,g){g.props=dp(h.type,h.memoizedProps),g.state=h.memoizedState;try{g.componentWillUnmount()}catch(E){Dr(h,f,E)}}function Bx(h,f){try{var g=h.ref;if(g!==null){switch(h.tag){case 26:case 27:case 5:var E=h.stateNode;break;case 30:E=h.stateNode;break;default:E=h.stateNode}typeof g=="function"?h.refCleanup=g(E):g.current=E}}catch(R){Dr(h,f,R)}}function Pc(h,f){var g=h.ref,E=h.refCleanup;if(g!==null)if(typeof E=="function")try{E()}catch(R){Dr(h,f,R)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(R){Dr(h,f,R)}else g.current=null}function kP(h){var f=h.type,g=h.memoizedProps,E=h.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":g.autoFocus&&E.focus();break e;case"img":g.src?E.src=g.src:g.srcSet&&(E.srcset=g.srcSet)}}catch(R){Dr(h,h.return,R)}}function TA(h,f,g){try{var E=h.stateNode;ire(E,h.type,g,f),E[pn]=f}catch(R){Dr(h,h.return,R)}}function IP(h){return h.tag===5||h.tag===3||h.tag===26||h.tag===27&&_d(h.type)||h.tag===4}function CA(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||IP(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.tag===27&&_d(h.type)||h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function AA(h,f,g){var E=h.tag;if(E===5||E===6)h=h.stateNode,f?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(h,f):(f=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,f.appendChild(h),g=g._reactRootContainer,g!=null||f.onclick!==null||(f.onclick=k_));else if(E!==4&&(E===27&&_d(h.type)&&(g=h.stateNode,f=null),h=h.child,h!==null))for(AA(h,f,g),h=h.sibling;h!==null;)AA(h,f,g),h=h.sibling}function y_(h,f,g){var E=h.tag;if(E===5||E===6)h=h.stateNode,f?g.insertBefore(h,f):g.appendChild(h);else if(E!==4&&(E===27&&_d(h.type)&&(g=h.stateNode),h=h.child,h!==null))for(y_(h,f,g),h=h.sibling;h!==null;)y_(h,f,g),h=h.sibling}function RP(h){var f=h.stateNode,g=h.memoizedProps;try{for(var E=h.type,R=f.attributes;R.length;)f.removeAttributeNode(R[0]);Gi(f,E,g),f[zt]=h,f[pn]=g}catch(j){Dr(h,h.return,j)}}var Qu=!1,Ds=!1,NA=!1,DP=typeof WeakSet=="function"?WeakSet:Set,Ii=null;function Bne(h,f){if(h=h.containerInfo,QA=O_,h=Jf(h),ep(h)){if("selectionStart"in h)var g={start:h.selectionStart,end:h.selectionEnd};else e:{g=(g=h.ownerDocument)&&g.defaultView||window;var E=g.getSelection&&g.getSelection();if(E&&E.rangeCount!==0){g=E.anchorNode;var R=E.anchorOffset,j=E.focusNode;E=E.focusOffset;try{g.nodeType,j.nodeType}catch{g=null;break e}var ie=0,le=-1,xe=-1,$e=0,He=0,Ze=h,Pe=null;t:for(;;){for(var Fe;Ze!==g||R!==0&&Ze.nodeType!==3||(le=ie+R),Ze!==j||E!==0&&Ze.nodeType!==3||(xe=ie+E),Ze.nodeType===3&&(ie+=Ze.nodeValue.length),(Fe=Ze.firstChild)!==null;)Pe=Ze,Ze=Fe;for(;;){if(Ze===h)break t;if(Pe===g&&++$e===R&&(le=ie),Pe===j&&++He===E&&(xe=ie),(Fe=Ze.nextSibling)!==null)break;Ze=Pe,Pe=Ze.parentNode}Ze=Fe}g=le===-1||xe===-1?null:{start:le,end:xe}}else g=null}g=g||{start:0,end:0}}else g=null;for(JA={focusedElem:h,selectionRange:g},O_=!1,Ii=f;Ii!==null;)if(f=Ii,h=f.child,(f.subtreeFlags&1024)!==0&&h!==null)h.return=f,Ii=h;else for(;Ii!==null;){switch(f=Ii,j=f.alternate,h=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if((h&1024)!==0&&j!==null){h=void 0,g=f,R=j.memoizedProps,j=j.memoizedState,E=g.stateNode;try{var Yt=dp(g.type,R,g.elementType===g.type);h=E.getSnapshotBeforeUpdate(Yt,j),E.__reactInternalSnapshotBeforeUpdate=h}catch(jt){Dr(g,g.return,jt)}}break;case 3:if((h&1024)!==0){if(h=f.stateNode.containerInfo,g=h.nodeType,g===9)nN(h);else if(g===1)switch(h.nodeName){case"HEAD":case"HTML":case"BODY":nN(h);break;default:h.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(r(163))}if(h=f.sibling,h!==null){h.return=f.return,Ii=h;break}Ii=f.return}}function $P(h,f,g){var E=g.flags;switch(g.tag){case 0:case 11:case 15:pd(h,g),E&4&&Fx(5,g);break;case 1:if(pd(h,g),E&4)if(h=g.stateNode,f===null)try{h.componentDidMount()}catch(ie){Dr(g,g.return,ie)}else{var R=dp(g.type,f.memoizedProps);f=f.memoizedState;try{h.componentDidUpdate(R,f,h.__reactInternalSnapshotBeforeUpdate)}catch(ie){Dr(g,g.return,ie)}}E&64&&AP(g),E&512&&Bx(g,g.return);break;case 3:if(pd(h,g),E&64&&(h=g.updateQueue,h!==null)){if(f=null,g.child!==null)switch(g.child.tag){case 27:case 5:f=g.child.stateNode;break;case 1:f=g.child.stateNode}try{pL(h,f)}catch(ie){Dr(g,g.return,ie)}}break;case 27:f===null&&E&4&&RP(g);case 26:case 5:pd(h,g),f===null&&E&4&&kP(g),E&512&&Bx(g,g.return);break;case 12:pd(h,g);break;case 13:pd(h,g),E&4&&OP(h,g),E&64&&(h=g.memoizedState,h!==null&&(h=h.dehydrated,h!==null&&(g=Kne.bind(null,g),dre(h,g))));break;case 22:if(E=g.memoizedState!==null||Qu,!E){f=f!==null&&f.memoizedState!==null||Ds,R=Qu;var j=Ds;Qu=E,(Ds=f)&&!j?md(h,g,(g.subtreeFlags&8772)!==0):pd(h,g),Qu=R,Ds=j}break;case 30:break;default:pd(h,g)}}function LP(h){var f=h.alternate;f!==null&&(h.alternate=null,LP(f)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(f=h.stateNode,f!==null&&Xn(f)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}var rs=null,lo=!1;function Ju(h,f,g){for(g=g.child;g!==null;)PP(h,f,g),g=g.sibling}function PP(h,f,g){if(Tt&&typeof Tt.onCommitFiberUnmount=="function")try{Tt.onCommitFiberUnmount(It,g)}catch{}switch(g.tag){case 26:Ds||Pc(g,f),Ju(h,f,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:Ds||Pc(g,f);var E=rs,R=lo;_d(g.type)&&(rs=g.stateNode,lo=!1),Ju(h,f,g),Kx(g.stateNode),rs=E,lo=R;break;case 5:Ds||Pc(g,f);case 6:if(E=rs,R=lo,rs=null,Ju(h,f,g),rs=E,lo=R,rs!==null)if(lo)try{(rs.nodeType===9?rs.body:rs.nodeName==="HTML"?rs.ownerDocument.body:rs).removeChild(g.stateNode)}catch(j){Dr(g,f,j)}else try{rs.removeChild(g.stateNode)}catch(j){Dr(g,f,j)}break;case 18:rs!==null&&(lo?(h=rs,EO(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,g.stateNode),ny(h)):EO(rs,g.stateNode));break;case 4:E=rs,R=lo,rs=g.stateNode.containerInfo,lo=!0,Ju(h,f,g),rs=E,lo=R;break;case 0:case 11:case 14:case 15:Ds||fd(2,g,f),Ds||fd(4,g,f),Ju(h,f,g);break;case 1:Ds||(Pc(g,f),E=g.stateNode,typeof E.componentWillUnmount=="function"&&NP(g,f,E)),Ju(h,f,g);break;case 21:Ju(h,f,g);break;case 22:Ds=(E=Ds)||g.memoizedState!==null,Ju(h,f,g),Ds=E;break;default:Ju(h,f,g)}}function OP(h,f){if(f.memoizedState===null&&(h=f.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{ny(h)}catch(g){Dr(f,f.return,g)}}function zne(h){switch(h.tag){case 13:case 19:var f=h.stateNode;return f===null&&(f=h.stateNode=new DP),f;case 22:return h=h.stateNode,f=h._retryCache,f===null&&(f=h._retryCache=new DP),f;default:throw Error(r(435,h.tag))}}function kA(h,f){var g=zne(h);f.forEach(function(E){var R=Xne.bind(null,h,E);g.has(E)||(g.add(E),E.then(R,R))})}function Bo(h,f){var g=f.deletions;if(g!==null)for(var E=0;E<g.length;E++){var R=g[E],j=h,ie=f,le=ie;e:for(;le!==null;){switch(le.tag){case 27:if(_d(le.type)){rs=le.stateNode,lo=!1;break e}break;case 5:rs=le.stateNode,lo=!1;break e;case 3:case 4:rs=le.stateNode.containerInfo,lo=!0;break e}le=le.return}if(rs===null)throw Error(r(160));PP(j,ie,R),rs=null,lo=!1,j=R.alternate,j!==null&&(j.return=null),R.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)MP(f,h),f=f.sibling}var Xl=null;function MP(h,f){var g=h.alternate,E=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:Bo(f,h),zo(h),E&4&&(fd(3,h,h.return),Fx(3,h),fd(5,h,h.return));break;case 1:Bo(f,h),zo(h),E&512&&(Ds||g===null||Pc(g,g.return)),E&64&&Qu&&(h=h.updateQueue,h!==null&&(E=h.callbacks,E!==null&&(g=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=g===null?E:g.concat(E))));break;case 26:var R=Xl;if(Bo(f,h),zo(h),E&512&&(Ds||g===null||Pc(g,g.return)),E&4){var j=g!==null?g.memoizedState:null;if(E=h.memoizedState,g===null)if(E===null)if(h.stateNode===null){e:{E=h.type,g=h.memoizedProps,R=R.ownerDocument||R;t:switch(E){case"title":j=R.getElementsByTagName("title")[0],(!j||j[ri]||j[zt]||j.namespaceURI==="http://www.w3.org/2000/svg"||j.hasAttribute("itemprop"))&&(j=R.createElement(E),R.head.insertBefore(j,R.querySelector("head > title"))),Gi(j,E,g),j[zt]=h,ur(j),E=j;break e;case"link":var ie=RO("link","href",R).get(E+(g.href||""));if(ie){for(var le=0;le<ie.length;le++)if(j=ie[le],j.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&j.getAttribute("rel")===(g.rel==null?null:g.rel)&&j.getAttribute("title")===(g.title==null?null:g.title)&&j.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){ie.splice(le,1);break t}}j=R.createElement(E),Gi(j,E,g),R.head.appendChild(j);break;case"meta":if(ie=RO("meta","content",R).get(E+(g.content||""))){for(le=0;le<ie.length;le++)if(j=ie[le],j.getAttribute("content")===(g.content==null?null:""+g.content)&&j.getAttribute("name")===(g.name==null?null:g.name)&&j.getAttribute("property")===(g.property==null?null:g.property)&&j.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&j.getAttribute("charset")===(g.charSet==null?null:g.charSet)){ie.splice(le,1);break t}}j=R.createElement(E),Gi(j,E,g),R.head.appendChild(j);break;default:throw Error(r(468,E))}j[zt]=h,ur(j),E=j}h.stateNode=E}else DO(R,h.type,h.stateNode);else h.stateNode=IO(R,E,h.memoizedProps);else j!==E?(j===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):j.count--,E===null?DO(R,h.type,h.stateNode):IO(R,E,h.memoizedProps)):E===null&&h.stateNode!==null&&TA(h,h.memoizedProps,g.memoizedProps)}break;case 27:Bo(f,h),zo(h),E&512&&(Ds||g===null||Pc(g,g.return)),g!==null&&E&4&&TA(h,h.memoizedProps,g.memoizedProps);break;case 5:if(Bo(f,h),zo(h),E&512&&(Ds||g===null||Pc(g,g.return)),h.flags&32){R=h.stateNode;try{Ei(R,"")}catch(Fe){Dr(h,h.return,Fe)}}E&4&&h.stateNode!=null&&(R=h.memoizedProps,TA(h,R,g!==null?g.memoizedProps:R)),E&1024&&(NA=!0);break;case 6:if(Bo(f,h),zo(h),E&4){if(h.stateNode===null)throw Error(r(162));E=h.memoizedProps,g=h.stateNode;try{g.nodeValue=E}catch(Fe){Dr(h,h.return,Fe)}}break;case 3:if($_=null,R=Xl,Xl=R_(f.containerInfo),Bo(f,h),Xl=R,zo(h),E&4&&g!==null&&g.memoizedState.isDehydrated)try{ny(f.containerInfo)}catch(Fe){Dr(h,h.return,Fe)}NA&&(NA=!1,FP(h));break;case 4:E=Xl,Xl=R_(h.stateNode.containerInfo),Bo(f,h),zo(h),Xl=E;break;case 12:Bo(f,h),zo(h);break;case 13:Bo(f,h),zo(h),h.child.flags&8192&&h.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(PA=ct()),E&4&&(E=h.updateQueue,E!==null&&(h.updateQueue=null,kA(h,E)));break;case 22:R=h.memoizedState!==null;var xe=g!==null&&g.memoizedState!==null,$e=Qu,He=Ds;if(Qu=$e||R,Ds=He||xe,Bo(f,h),Ds=He,Qu=$e,zo(h),E&8192)e:for(f=h.stateNode,f._visibility=R?f._visibility&-2:f._visibility|1,R&&(g===null||xe||Qu||Ds||fp(h)),g=null,f=h;;){if(f.tag===5||f.tag===26){if(g===null){xe=g=f;try{if(j=xe.stateNode,R)ie=j.style,typeof ie.setProperty=="function"?ie.setProperty("display","none","important"):ie.display="none";else{le=xe.stateNode;var Ze=xe.memoizedProps.style,Pe=Ze!=null&&Ze.hasOwnProperty("display")?Ze.display:null;le.style.display=Pe==null||typeof Pe=="boolean"?"":(""+Pe).trim()}}catch(Fe){Dr(xe,xe.return,Fe)}}}else if(f.tag===6){if(g===null){xe=f;try{xe.stateNode.nodeValue=R?"":xe.memoizedProps}catch(Fe){Dr(xe,xe.return,Fe)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===h)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===h)break e;for(;f.sibling===null;){if(f.return===null||f.return===h)break e;g===f&&(g=null),f=f.return}g===f&&(g=null),f.sibling.return=f.return,f=f.sibling}E&4&&(E=h.updateQueue,E!==null&&(g=E.retryQueue,g!==null&&(E.retryQueue=null,kA(h,g))));break;case 19:Bo(f,h),zo(h),E&4&&(E=h.updateQueue,E!==null&&(h.updateQueue=null,kA(h,E)));break;case 30:break;case 21:break;default:Bo(f,h),zo(h)}}function zo(h){var f=h.flags;if(f&2){try{for(var g,E=h.return;E!==null;){if(IP(E)){g=E;break}E=E.return}if(g==null)throw Error(r(160));switch(g.tag){case 27:var R=g.stateNode,j=CA(h);y_(h,j,R);break;case 5:var ie=g.stateNode;g.flags&32&&(Ei(ie,""),g.flags&=-33);var le=CA(h);y_(h,le,ie);break;case 3:case 4:var xe=g.stateNode.containerInfo,$e=CA(h);AA(h,$e,xe);break;default:throw Error(r(161))}}catch(He){Dr(h,h.return,He)}h.flags&=-3}f&4096&&(h.flags&=-4097)}function FP(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var f=h;FP(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),h=h.sibling}}function pd(h,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)$P(h,f.alternate,f),f=f.sibling}function fp(h){for(h=h.child;h!==null;){var f=h;switch(f.tag){case 0:case 11:case 14:case 15:fd(4,f,f.return),fp(f);break;case 1:Pc(f,f.return);var g=f.stateNode;typeof g.componentWillUnmount=="function"&&NP(f,f.return,g),fp(f);break;case 27:Kx(f.stateNode);case 26:case 5:Pc(f,f.return),fp(f);break;case 22:f.memoizedState===null&&fp(f);break;case 30:fp(f);break;default:fp(f)}h=h.sibling}}function md(h,f,g){for(g=g&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var E=f.alternate,R=h,j=f,ie=j.flags;switch(j.tag){case 0:case 11:case 15:md(R,j,g),Fx(4,j);break;case 1:if(md(R,j,g),E=j,R=E.stateNode,typeof R.componentDidMount=="function")try{R.componentDidMount()}catch($e){Dr(E,E.return,$e)}if(E=j,R=E.updateQueue,R!==null){var le=E.stateNode;try{var xe=R.shared.hiddenCallbacks;if(xe!==null)for(R.shared.hiddenCallbacks=null,R=0;R<xe.length;R++)fL(xe[R],le)}catch($e){Dr(E,E.return,$e)}}g&&ie&64&&AP(j),Bx(j,j.return);break;case 27:RP(j);case 26:case 5:md(R,j,g),g&&E===null&&ie&4&&kP(j),Bx(j,j.return);break;case 12:md(R,j,g);break;case 13:md(R,j,g),g&&ie&4&&OP(R,j);break;case 22:j.memoizedState===null&&md(R,j,g),Bx(j,j.return);break;case 30:break;default:md(R,j,g)}f=f.sibling}}function IA(h,f){var g=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(g=h.memoizedState.cachePool.pool),h=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(h=f.memoizedState.cachePool.pool),h!==g&&(h!=null&&h.refCount++,g!=null&&Sx(g))}function RA(h,f){h=null,f.alternate!==null&&(h=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==h&&(f.refCount++,h!=null&&Sx(h))}function Oc(h,f,g,E){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)BP(h,f,g,E),f=f.sibling}function BP(h,f,g,E){var R=f.flags;switch(f.tag){case 0:case 11:case 15:Oc(h,f,g,E),R&2048&&Fx(9,f);break;case 1:Oc(h,f,g,E);break;case 3:Oc(h,f,g,E),R&2048&&(h=null,f.alternate!==null&&(h=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==h&&(f.refCount++,h!=null&&Sx(h)));break;case 12:if(R&2048){Oc(h,f,g,E),h=f.stateNode;try{var j=f.memoizedProps,ie=j.id,le=j.onPostCommit;typeof le=="function"&&le(ie,f.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(xe){Dr(f,f.return,xe)}}else Oc(h,f,g,E);break;case 13:Oc(h,f,g,E);break;case 23:break;case 22:j=f.stateNode,ie=f.alternate,f.memoizedState!==null?j._visibility&2?Oc(h,f,g,E):zx(h,f):j._visibility&2?Oc(h,f,g,E):(j._visibility|=2,h0(h,f,g,E,(f.subtreeFlags&10256)!==0)),R&2048&&IA(ie,f);break;case 24:Oc(h,f,g,E),R&2048&&RA(f.alternate,f);break;default:Oc(h,f,g,E)}}function h0(h,f,g,E,R){for(R=R&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var j=h,ie=f,le=g,xe=E,$e=ie.flags;switch(ie.tag){case 0:case 11:case 15:h0(j,ie,le,xe,R),Fx(8,ie);break;case 23:break;case 22:var He=ie.stateNode;ie.memoizedState!==null?He._visibility&2?h0(j,ie,le,xe,R):zx(j,ie):(He._visibility|=2,h0(j,ie,le,xe,R)),R&&$e&2048&&IA(ie.alternate,ie);break;case 24:h0(j,ie,le,xe,R),R&&$e&2048&&RA(ie.alternate,ie);break;default:h0(j,ie,le,xe,R)}f=f.sibling}}function zx(h,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var g=h,E=f,R=E.flags;switch(E.tag){case 22:zx(g,E),R&2048&&IA(E.alternate,E);break;case 24:zx(g,E),R&2048&&RA(E.alternate,E);break;default:zx(g,E)}f=f.sibling}}var jx=8192;function d0(h){if(h.subtreeFlags&jx)for(h=h.child;h!==null;)zP(h),h=h.sibling}function zP(h){switch(h.tag){case 26:d0(h),h.flags&jx&&h.memoizedState!==null&&Tre(Xl,h.memoizedState,h.memoizedProps);break;case 5:d0(h);break;case 3:case 4:var f=Xl;Xl=R_(h.stateNode.containerInfo),d0(h),Xl=f;break;case 22:h.memoizedState===null&&(f=h.alternate,f!==null&&f.memoizedState!==null?(f=jx,jx=16777216,d0(h),jx=f):d0(h));break;default:d0(h)}}function jP(h){var f=h.alternate;if(f!==null&&(h=f.child,h!==null)){f.child=null;do f=h.sibling,h.sibling=null,h=f;while(h!==null)}}function Vx(h){var f=h.deletions;if((h.flags&16)!==0){if(f!==null)for(var g=0;g<f.length;g++){var E=f[g];Ii=E,UP(E,h)}jP(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)VP(h),h=h.sibling}function VP(h){switch(h.tag){case 0:case 11:case 15:Vx(h),h.flags&2048&&fd(9,h,h.return);break;case 3:Vx(h);break;case 12:Vx(h);break;case 22:var f=h.stateNode;h.memoizedState!==null&&f._visibility&2&&(h.return===null||h.return.tag!==13)?(f._visibility&=-3,b_(h)):Vx(h);break;default:Vx(h)}}function b_(h){var f=h.deletions;if((h.flags&16)!==0){if(f!==null)for(var g=0;g<f.length;g++){var E=f[g];Ii=E,UP(E,h)}jP(h)}for(h=h.child;h!==null;){switch(f=h,f.tag){case 0:case 11:case 15:fd(8,f,f.return),b_(f);break;case 22:g=f.stateNode,g._visibility&2&&(g._visibility&=-3,b_(f));break;default:b_(f)}h=h.sibling}}function UP(h,f){for(;Ii!==null;){var g=Ii;switch(g.tag){case 0:case 11:case 15:fd(8,g,f);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var E=g.memoizedState.cachePool.pool;E!=null&&E.refCount++}break;case 24:Sx(g.memoizedState.cache)}if(E=g.child,E!==null)E.return=g,Ii=E;else e:for(g=h;Ii!==null;){E=Ii;var R=E.sibling,j=E.return;if(LP(E),E===g){Ii=null;break e}if(R!==null){R.return=j,Ii=R;break e}Ii=j}}}var jne={getCacheForType:function(h){var f=pa(oi),g=f.data.get(h);return g===void 0&&(g=h(),f.data.set(h,g)),g}},Vne=typeof WeakMap=="function"?WeakMap:Map,wr=0,jr=null,zn=null,sr=0,Er=0,jo=null,gd=!1,f0=!1,DA=!1,eh=0,ys=0,xd=0,pp=0,$A=0,ml=0,p0=0,Ux=null,co=null,LA=!1,PA=0,v_=1/0,__=null,yd=null,Ui=0,bd=null,m0=null,g0=0,OA=0,MA=null,GP=null,Gx=0,FA=null;function Vo(){if((wr&2)!==0&&sr!==0)return sr&-sr;if(B.T!==null){var h=r0;return h!==0?h:HA()}return An()}function HP(){ml===0&&(ml=(sr&536870912)===0||Qt?qn():536870912);var h=pl.current;return h!==null&&(h.flags|=32),ml}function Uo(h,f,g){(h===jr&&(Er===2||Er===9)||h.cancelPendingCommit!==null)&&(x0(h,0),vd(h,sr,ml,!1)),Ft(h,g),((wr&2)===0||h!==jr)&&(h===jr&&((wr&2)===0&&(pp|=g),ys===4&&vd(h,sr,ml,!1)),Mc(h))}function WP(h,f,g){if((wr&6)!==0)throw Error(r(327));var E=!g&&(f&124)===0&&(f&h.expiredLanes)===0||es(h,f),R=E?Hne(h,f):jA(h,f,!0),j=E;do{if(R===0){f0&&!E&&vd(h,f,0,!1);break}else{if(g=h.current.alternate,j&&!Une(g)){R=jA(h,f,!1),j=!1;continue}if(R===2){if(j=f,h.errorRecoveryDisabledLanes&j)var ie=0;else ie=h.pendingLanes&-536870913,ie=ie!==0?ie:ie&536870912?536870912:0;if(ie!==0){f=ie;e:{var le=h;R=Ux;var xe=le.current.memoizedState.isDehydrated;if(xe&&(x0(le,ie).flags|=256),ie=jA(le,ie,!1),ie!==2){if(DA&&!xe){le.errorRecoveryDisabledLanes|=j,pp|=j,R=4;break e}j=co,co=R,j!==null&&(co===null?co=j:co.push.apply(co,j))}R=ie}if(j=!1,R!==2)continue}}if(R===1){x0(h,0),vd(h,f,0,!0);break}e:{switch(E=h,j=R,j){case 0:case 1:throw Error(r(345));case 4:if((f&4194048)!==f)break;case 6:vd(E,f,ml,!gd);break e;case 2:co=null;break;case 3:case 5:break;default:throw Error(r(329))}if((f&62914560)===f&&(R=PA+300-ct(),10<R)){if(vd(E,f,ml,!gd),hn(E,0,!0)!==0)break e;E.timeoutHandle=_O(qP.bind(null,E,g,co,__,LA,f,ml,pp,p0,gd,j,2,-0,0),R);break e}qP(E,g,co,__,LA,f,ml,pp,p0,gd,j,0,-0,0)}}break}while(!0);Mc(h)}function qP(h,f,g,E,R,j,ie,le,xe,$e,He,Ze,Pe,Fe){if(h.timeoutHandle=-1,Ze=f.subtreeFlags,(Ze&8192||(Ze&16785408)===16785408)&&(Zx={stylesheets:null,count:0,unsuspend:Sre},zP(f),Ze=Cre(),Ze!==null)){h.cancelPendingCommit=Ze(eO.bind(null,h,f,j,g,E,R,ie,le,xe,He,1,Pe,Fe)),vd(h,j,ie,!$e);return}eO(h,f,j,g,E,R,ie,le,xe)}function Une(h){for(var f=h;;){var g=f.tag;if((g===0||g===11||g===15)&&f.flags&16384&&(g=f.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var E=0;E<g.length;E++){var R=g[E],j=R.getSnapshot;R=R.value;try{if(!Ua(j(),R))return!1}catch{return!1}}if(g=f.child,f.subtreeFlags&16384&&g!==null)g.return=f,f=g;else{if(f===h)break;for(;f.sibling===null;){if(f.return===null||f.return===h)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function vd(h,f,g,E){f&=~$A,f&=~pp,h.suspendedLanes|=f,h.pingedLanes&=~f,E&&(h.warmLanes|=f),E=h.expirationTimes;for(var R=f;0<R;){var j=31-Bt(R),ie=1<<j;E[j]=-1,R&=~ie}g!==0&&Rn(h,g,f)}function w_(){return(wr&6)===0?(Hx(0),!1):!0}function BA(){if(zn!==null){if(Er===0)var h=zn.return;else h=zn,ql=fl=null,nA(h),c0=null,Px=0,h=zn;for(;h!==null;)CP(h.alternate,h),h=h.return;zn=null}}function x0(h,f){var g=h.timeoutHandle;g!==-1&&(h.timeoutHandle=-1,ore(g)),g=h.cancelPendingCommit,g!==null&&(h.cancelPendingCommit=null,g()),BA(),jr=h,zn=g=dl(h.current,null),sr=f,Er=0,jo=null,gd=!1,f0=es(h,f),DA=!1,p0=ml=$A=pp=xd=ys=0,co=Ux=null,LA=!1,(f&8)!==0&&(f|=f&32);var E=h.entangledLanes;if(E!==0)for(h=h.entanglements,E&=f;0<E;){var R=31-Bt(E),j=1<<R;f|=h[R],E&=~j}return eh=f,np(),g}function KP(h,f){kn=null,B.H=c_,f===Cx||f===Jv?(f=hL(),Er=3):f===lL?(f=hL(),Er=4):Er=f===dP?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,jo=f,zn===null&&(ys=1,p_(h,Ha(f,h.current)))}function XP(){var h=B.H;return B.H=c_,h===null?c_:h}function YP(){var h=B.A;return B.A=jne,h}function zA(){ys=4,gd||(sr&4194048)!==sr&&pl.current!==null||(f0=!0),(xd&134217727)===0&&(pp&134217727)===0||jr===null||vd(jr,sr,ml,!1)}function jA(h,f,g){var E=wr;wr|=2;var R=XP(),j=YP();(jr!==h||sr!==f)&&(__=null,x0(h,f)),f=!1;var ie=ys;e:do try{if(Er!==0&&zn!==null){var le=zn,xe=jo;switch(Er){case 8:BA(),ie=6;break e;case 3:case 2:case 9:case 6:pl.current===null&&(f=!0);var $e=Er;if(Er=0,jo=null,y0(h,le,xe,$e),g&&f0){ie=0;break e}break;default:$e=Er,Er=0,jo=null,y0(h,le,xe,$e)}}Gne(),ie=ys;break}catch(He){KP(h,He)}while(!0);return f&&h.shellSuspendCounter++,ql=fl=null,wr=E,B.H=R,B.A=j,zn===null&&(jr=null,sr=0,np()),ie}function Gne(){for(;zn!==null;)ZP(zn)}function Hne(h,f){var g=wr;wr|=2;var E=XP(),R=YP();jr!==h||sr!==f?(__=null,v_=ct()+500,x0(h,f)):f0=es(h,f);e:do try{if(Er!==0&&zn!==null){f=zn;var j=jo;t:switch(Er){case 1:Er=0,jo=null,y0(h,f,j,1);break;case 2:case 9:if(cL(j)){Er=0,jo=null,QP(f);break}f=function(){Er!==2&&Er!==9||jr!==h||(Er=7),Mc(h)},j.then(f,f);break e;case 3:Er=7;break e;case 4:Er=5;break e;case 7:cL(j)?(Er=0,jo=null,QP(f)):(Er=0,jo=null,y0(h,f,j,7));break;case 5:var ie=null;switch(zn.tag){case 26:ie=zn.memoizedState;case 5:case 27:var le=zn;if(!ie||$O(ie)){Er=0,jo=null;var xe=le.sibling;if(xe!==null)zn=xe;else{var $e=le.return;$e!==null?(zn=$e,E_($e)):zn=null}break t}}Er=0,jo=null,y0(h,f,j,5);break;case 6:Er=0,jo=null,y0(h,f,j,6);break;case 8:BA(),ys=6;break e;default:throw Error(r(462))}}Wne();break}catch(He){KP(h,He)}while(!0);return ql=fl=null,B.H=E,B.A=R,wr=g,zn!==null?0:(jr=null,sr=0,np(),ys)}function Wne(){for(;zn!==null&&!nt();)ZP(zn)}function ZP(h){var f=SP(h.alternate,h,eh);h.memoizedProps=h.pendingProps,f===null?E_(h):zn=f}function QP(h){var f=h,g=f.alternate;switch(f.tag){case 15:case 0:f=yP(g,f,f.pendingProps,f.type,void 0,sr);break;case 11:f=yP(g,f,f.pendingProps,f.type.render,f.ref,sr);break;case 5:nA(f);default:CP(g,f),f=zn=wx(f,eh),f=SP(g,f,eh)}h.memoizedProps=h.pendingProps,f===null?E_(h):zn=f}function y0(h,f,g,E){ql=fl=null,nA(f),c0=null,Px=0;var R=f.return;try{if(Pne(h,R,f,g,sr)){ys=1,p_(h,Ha(g,h.current)),zn=null;return}}catch(j){if(R!==null)throw zn=R,j;ys=1,p_(h,Ha(g,h.current)),zn=null;return}f.flags&32768?(Qt||E===1?h=!0:f0||(sr&536870912)!==0?h=!1:(gd=h=!0,(E===2||E===9||E===3||E===6)&&(E=pl.current,E!==null&&E.tag===13&&(E.flags|=16384))),JP(f,h)):E_(f)}function E_(h){var f=h;do{if((f.flags&32768)!==0){JP(f,gd);return}h=f.return;var g=Mne(f.alternate,f,eh);if(g!==null){zn=g;return}if(f=f.sibling,f!==null){zn=f;return}zn=f=h}while(f!==null);ys===0&&(ys=5)}function JP(h,f){do{var g=Fne(h.alternate,h);if(g!==null){g.flags&=32767,zn=g;return}if(g=h.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!f&&(h=h.sibling,h!==null)){zn=h;return}zn=h=g}while(h!==null);ys=6,zn=null}function eO(h,f,g,E,R,j,ie,le,xe){h.cancelPendingCommit=null;do S_();while(Ui!==0);if((wr&6)!==0)throw Error(r(327));if(f!==null){if(f===h.current)throw Error(r(177));if(j=f.lanes|f.childLanes,j|=Fo,oa(h,g,j,ie,le,xe),h===jr&&(zn=jr=null,sr=0),m0=f,bd=h,g0=g,OA=j,MA=R,GP=E,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(h.callbackNode=null,h.callbackPriority=0,Yne(St,function(){return iO(),null})):(h.callbackNode=null,h.callbackPriority=0),E=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||E){E=B.T,B.T=null,R=Y.p,Y.p=2,ie=wr,wr|=4;try{Bne(h,f,g)}finally{wr=ie,Y.p=R,B.T=E}}Ui=1,tO(),nO(),rO()}}function tO(){if(Ui===1){Ui=0;var h=bd,f=m0,g=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||g){g=B.T,B.T=null;var E=Y.p;Y.p=2;var R=wr;wr|=4;try{MP(f,h);var j=JA,ie=Jf(h.containerInfo),le=j.focusedElem,xe=j.selectionRange;if(ie!==le&&le&&le.ownerDocument&&Xm(le.ownerDocument.documentElement,le)){if(xe!==null&&ep(le)){var $e=xe.start,He=xe.end;if(He===void 0&&(He=$e),"selectionStart"in le)le.selectionStart=$e,le.selectionEnd=Math.min(He,le.value.length);else{var Ze=le.ownerDocument||document,Pe=Ze&&Ze.defaultView||window;if(Pe.getSelection){var Fe=Pe.getSelection(),Yt=le.textContent.length,jt=Math.min(xe.start,Yt),Nr=xe.end===void 0?jt:Math.min(xe.end,Yt);!Fe.extend&&jt>Nr&&(ie=Nr,Nr=jt,jt=ie);var Ne=vx(le,jt),we=vx(le,Nr);if(Ne&&we&&(Fe.rangeCount!==1||Fe.anchorNode!==Ne.node||Fe.anchorOffset!==Ne.offset||Fe.focusNode!==we.node||Fe.focusOffset!==we.offset)){var Re=Ze.createRange();Re.setStart(Ne.node,Ne.offset),Fe.removeAllRanges(),jt>Nr?(Fe.addRange(Re),Fe.extend(we.node,we.offset)):(Re.setEnd(we.node,we.offset),Fe.addRange(Re))}}}}for(Ze=[],Fe=le;Fe=Fe.parentNode;)Fe.nodeType===1&&Ze.push({element:Fe,left:Fe.scrollLeft,top:Fe.scrollTop});for(typeof le.focus=="function"&&le.focus(),le=0;le<Ze.length;le++){var qe=Ze[le];qe.element.scrollLeft=qe.left,qe.element.scrollTop=qe.top}}O_=!!QA,JA=QA=null}finally{wr=R,Y.p=E,B.T=g}}h.current=f,Ui=2}}function nO(){if(Ui===2){Ui=0;var h=bd,f=m0,g=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||g){g=B.T,B.T=null;var E=Y.p;Y.p=2;var R=wr;wr|=4;try{$P(h,f.alternate,f)}finally{wr=R,Y.p=E,B.T=g}}Ui=3}}function rO(){if(Ui===4||Ui===3){Ui=0,Nt();var h=bd,f=m0,g=g0,E=GP;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?Ui=5:(Ui=0,m0=bd=null,sO(h,h.pendingLanes));var R=h.pendingLanes;if(R===0&&(yd=null),Kn(g),f=f.stateNode,Tt&&typeof Tt.onCommitFiberRoot=="function")try{Tt.onCommitFiberRoot(It,f,void 0,(f.current.flags&128)===128)}catch{}if(E!==null){f=B.T,R=Y.p,Y.p=2,B.T=null;try{for(var j=h.onRecoverableError,ie=0;ie<E.length;ie++){var le=E[ie];j(le.value,{componentStack:le.stack})}}finally{B.T=f,Y.p=R}}(g0&3)!==0&&S_(),Mc(h),R=h.pendingLanes,(g&4194090)!==0&&(R&42)!==0?h===FA?Gx++:(Gx=0,FA=h):Gx=0,Hx(0)}}function sO(h,f){(h.pooledCacheLanes&=f)===0&&(f=h.pooledCache,f!=null&&(h.pooledCache=null,Sx(f)))}function S_(h){return tO(),nO(),rO(),iO()}function iO(){if(Ui!==5)return!1;var h=bd,f=OA;OA=0;var g=Kn(g0),E=B.T,R=Y.p;try{Y.p=32>g?32:g,B.T=null,g=MA,MA=null;var j=bd,ie=g0;if(Ui=0,m0=bd=null,g0=0,(wr&6)!==0)throw Error(r(331));var le=wr;if(wr|=4,VP(j.current),BP(j,j.current,ie,g),wr=le,Hx(0,!1),Tt&&typeof Tt.onPostCommitFiberRoot=="function")try{Tt.onPostCommitFiberRoot(It,j)}catch{}return!0}finally{Y.p=R,B.T=E,sO(h,f)}}function aO(h,f,g){f=Ha(g,f),f=gA(h.stateNode,f,2),h=cd(h,f,2),h!==null&&(Ft(h,2),Mc(h))}function Dr(h,f,g){if(h.tag===3)aO(h,h,g);else for(;f!==null;){if(f.tag===3){aO(f,h,g);break}else if(f.tag===1){var E=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(yd===null||!yd.has(E))){h=Ha(g,h),g=uP(2),E=cd(f,g,2),E!==null&&(hP(g,E,f,h),Ft(E,2),Mc(E));break}}f=f.return}}function VA(h,f,g){var E=h.pingCache;if(E===null){E=h.pingCache=new Vne;var R=new Set;E.set(f,R)}else R=E.get(f),R===void 0&&(R=new Set,E.set(f,R));R.has(g)||(DA=!0,R.add(g),h=qne.bind(null,h,f,g),f.then(h,h))}function qne(h,f,g){var E=h.pingCache;E!==null&&E.delete(f),h.pingedLanes|=h.suspendedLanes&g,h.warmLanes&=~g,jr===h&&(sr&g)===g&&(ys===4||ys===3&&(sr&62914560)===sr&&300>ct()-PA?(wr&2)===0&&x0(h,0):$A|=g,p0===sr&&(p0=0)),Mc(h)}function oO(h,f){f===0&&(f=ms()),h=rd(h,f),h!==null&&(Ft(h,f),Mc(h))}function Kne(h){var f=h.memoizedState,g=0;f!==null&&(g=f.retryLane),oO(h,g)}function Xne(h,f){var g=0;switch(h.tag){case 13:var E=h.stateNode,R=h.memoizedState;R!==null&&(g=R.retryLane);break;case 19:E=h.stateNode;break;case 22:E=h.stateNode._retryCache;break;default:throw Error(r(314))}E!==null&&E.delete(f),oO(h,g)}function Yne(h,f){return at(h,f)}var T_=null,b0=null,UA=!1,C_=!1,GA=!1,mp=0;function Mc(h){h!==b0&&h.next===null&&(b0===null?T_=b0=h:b0=b0.next=h),C_=!0,UA||(UA=!0,Qne())}function Hx(h,f){if(!GA&&C_){GA=!0;do for(var g=!1,E=T_;E!==null;){if(h!==0){var R=E.pendingLanes;if(R===0)var j=0;else{var ie=E.suspendedLanes,le=E.pingedLanes;j=(1<<31-Bt(42|h)+1)-1,j&=R&~(ie&~le),j=j&201326741?j&201326741|1:j?j|2:0}j!==0&&(g=!0,hO(E,j))}else j=sr,j=hn(E,E===jr?j:0,E.cancelPendingCommit!==null||E.timeoutHandle!==-1),(j&3)===0||es(E,j)||(g=!0,hO(E,j));E=E.next}while(g);GA=!1}}function Zne(){lO()}function lO(){C_=UA=!1;var h=0;mp!==0&&(are()&&(h=mp),mp=0);for(var f=ct(),g=null,E=T_;E!==null;){var R=E.next,j=cO(E,f);j===0?(E.next=null,g===null?T_=R:g.next=R,R===null&&(b0=g)):(g=E,(h!==0||(j&3)!==0)&&(C_=!0)),E=R}Hx(h)}function cO(h,f){for(var g=h.suspendedLanes,E=h.pingedLanes,R=h.expirationTimes,j=h.pendingLanes&-62914561;0<j;){var ie=31-Bt(j),le=1<<ie,xe=R[ie];xe===-1?((le&g)===0||(le&E)!==0)&&(R[ie]=Mn(le,f)):xe<=f&&(h.expiredLanes|=le),j&=~le}if(f=jr,g=sr,g=hn(h,h===f?g:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),E=h.callbackNode,g===0||h===f&&(Er===2||Er===9)||h.cancelPendingCommit!==null)return E!==null&&E!==null&&We(E),h.callbackNode=null,h.callbackPriority=0;if((g&3)===0||es(h,g)){if(f=g&-g,f===h.callbackPriority)return f;switch(E!==null&&We(E),Kn(g)){case 2:case 8:g=ht;break;case 32:g=St;break;case 268435456:g=Ot;break;default:g=St}return E=uO.bind(null,h),g=at(g,E),h.callbackPriority=f,h.callbackNode=g,f}return E!==null&&E!==null&&We(E),h.callbackPriority=2,h.callbackNode=null,2}function uO(h,f){if(Ui!==0&&Ui!==5)return h.callbackNode=null,h.callbackPriority=0,null;var g=h.callbackNode;if(S_()&&h.callbackNode!==g)return null;var E=sr;return E=hn(h,h===jr?E:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),E===0?null:(WP(h,E,f),cO(h,ct()),h.callbackNode!=null&&h.callbackNode===g?uO.bind(null,h):null)}function hO(h,f){if(S_())return null;WP(h,f,!0)}function Qne(){lre(function(){(wr&6)!==0?at(en,Zne):lO()})}function HA(){return mp===0&&(mp=qn()),mp}function dO(h){return h==null||typeof h=="symbol"||typeof h=="boolean"?null:typeof h=="function"?h:Fa(""+h)}function fO(h,f){var g=f.ownerDocument.createElement("input");return g.name=f.name,g.value=f.value,h.id&&g.setAttribute("form",h.id),f.parentNode.insertBefore(g,f),h=new FormData(h),g.parentNode.removeChild(g),h}function Jne(h,f,g,E,R){if(f==="submit"&&g&&g.stateNode===R){var j=dO((R[pn]||null).action),ie=E.submitter;ie&&(f=(f=ie[pn]||null)?dO(f.formAction):ie.getAttribute("formAction"),f!==null&&(j=f,ie=null));var le=new Nc("action","action",null,E,R);h.push({event:le,listeners:[{instance:null,listener:function(){if(E.defaultPrevented){if(mp!==0){var xe=ie?fO(R,ie):new FormData(R);hA(g,{pending:!0,data:xe,method:R.method,action:j},null,xe)}}else typeof j=="function"&&(le.preventDefault(),xe=ie?fO(R,ie):new FormData(R),hA(g,{pending:!0,data:xe,method:R.method,action:j},j,xe))},currentTarget:R}]})}}for(var WA=0;WA<Uu.length;WA++){var qA=Uu[WA],ere=qA.toLowerCase(),tre=qA[0].toUpperCase()+qA.slice(1);Mo(ere,"on"+tre)}Mo(Gv,"onAnimationEnd"),Mo(Oo,"onAnimationIteration"),Mo(tp,"onAnimationStart"),Mo("dblclick","onDoubleClick"),Mo("focusin","onFocus"),Mo("focusout","onBlur"),Mo(zC,"onTransitionRun"),Mo(Jm,"onTransitionStart"),Mo(jC,"onTransitionCancel"),Mo(_x,"onTransitionEnd"),gs("onMouseEnter",["mouseout","mouseover"]),gs("onMouseLeave",["mouseout","mouseover"]),gs("onPointerEnter",["pointerout","pointerover"]),gs("onPointerLeave",["pointerout","pointerover"]),Is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Is("onBeforeInput",["compositionend","keypress","textInput","paste"]),Is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nre=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wx));function pO(h,f){f=(f&4)!==0;for(var g=0;g<h.length;g++){var E=h[g],R=E.event;E=E.listeners;e:{var j=void 0;if(f)for(var ie=E.length-1;0<=ie;ie--){var le=E[ie],xe=le.instance,$e=le.currentTarget;if(le=le.listener,xe!==j&&R.isPropagationStopped())break e;j=le,R.currentTarget=$e;try{j(R)}catch(He){f_(He)}R.currentTarget=null,j=xe}else for(ie=0;ie<E.length;ie++){if(le=E[ie],xe=le.instance,$e=le.currentTarget,le=le.listener,xe!==j&&R.isPropagationStopped())break e;j=le,R.currentTarget=$e;try{j(R)}catch(He){f_(He)}R.currentTarget=null,j=xe}}}}function jn(h,f){var g=f[Zt];g===void 0&&(g=f[Zt]=new Set);var E=h+"__bubble";g.has(E)||(mO(f,h,2,!1),g.add(E))}function KA(h,f,g){var E=0;f&&(E|=4),mO(g,h,E,f)}var A_="_reactListening"+Math.random().toString(36).slice(2);function XA(h){if(!h[A_]){h[A_]=!0,La.forEach(function(g){g!=="selectionchange"&&(nre.has(g)||KA(g,!1,h),KA(g,!0,h))});var f=h.nodeType===9?h:h.ownerDocument;f===null||f[A_]||(f[A_]=!0,KA("selectionchange",!1,f))}}function mO(h,f,g,E){switch(BO(f)){case 2:var R=kre;break;case 8:R=Ire;break;default:R=cN}g=R.bind(null,f,g,h),R=void 0,!ko||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(R=!0),E?R!==void 0?h.addEventListener(f,g,{capture:!0,passive:R}):h.addEventListener(f,g,!0):R!==void 0?h.addEventListener(f,g,{passive:R}):h.addEventListener(f,g,!1)}function YA(h,f,g,E,R){var j=E;if((f&1)===0&&(f&2)===0&&E!==null)e:for(;;){if(E===null)return;var ie=E.tag;if(ie===3||ie===4){var le=E.stateNode.containerInfo;if(le===R)break;if(ie===4)for(ie=E.return;ie!==null;){var xe=ie.tag;if((xe===3||xe===4)&&ie.stateNode.containerInfo===R)return;ie=ie.return}for(;le!==null;){if(ie=vn(le),ie===null)return;if(xe=ie.tag,xe===5||xe===6||xe===26||xe===27){E=j=ie;continue e}le=le.parentNode}}E=E.return}Si(function(){var $e=j,He=Tc(g),Ze=[];e:{var Pe=Hv.get(h);if(Pe!==void 0){var Fe=Nc,Yt=h;switch(h){case"keypress":if(Kr(g)===0)break e;case"keydown":case"keyup":Fe=qh;break;case"focusin":Yt="focus",Fe=Uh;break;case"focusout":Yt="blur",Fe=Uh;break;case"beforeblur":case"afterblur":Fe=Uh;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Fe=Io;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Fe=Hm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Fe=kc;break;case Gv:case Oo:case tp:Fe=qf;break;case _x:Fe=J;break;case"scroll":case"scrollend":Fe=Fu;break;case"wheel":Fe=he;break;case"copy":case"cut":case"paste":Fe=Gh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Fe=Kh;break;case"toggle":case"beforetoggle":Fe=Oe}var jt=(f&4)!==0,Nr=!jt&&(h==="scroll"||h==="scrollend"),Ne=jt?Pe!==null?Pe+"Capture":null:Pe;jt=[];for(var we=$e,Re;we!==null;){var qe=we;if(Re=qe.stateNode,qe=qe.tag,qe!==5&&qe!==26&&qe!==27||Re===null||Ne===null||(qe=Yn(we,Ne),qe!=null&&jt.push(qx(we,qe,Re))),Nr)break;we=we.return}0<jt.length&&(Pe=new Fe(Pe,Yt,null,g,He),Ze.push({event:Pe,listeners:jt}))}}if((f&7)===0){e:{if(Pe=h==="mouseover"||h==="pointerover",Fe=h==="mouseout"||h==="pointerout",Pe&&g!==Mu&&(Yt=g.relatedTarget||g.fromElement)&&(vn(Yt)||Yt[nn]))break e;if((Fe||Pe)&&(Pe=He.window===He?He:(Pe=He.ownerDocument)?Pe.defaultView||Pe.parentWindow:window,Fe?(Yt=g.relatedTarget||g.toElement,Fe=$e,Yt=Yt?vn(Yt):null,Yt!==null&&(Nr=i(Yt),jt=Yt.tag,Yt!==Nr||jt!==5&&jt!==27&&jt!==6)&&(Yt=null)):(Fe=null,Yt=$e),Fe!==Yt)){if(jt=Io,qe="onMouseLeave",Ne="onMouseEnter",we="mouse",(h==="pointerout"||h==="pointerover")&&(jt=Kh,qe="onPointerLeave",Ne="onPointerEnter",we="pointer"),Nr=Fe==null?Pe:mn(Fe),Re=Yt==null?Pe:mn(Yt),Pe=new jt(qe,we+"leave",Fe,g,He),Pe.target=Nr,Pe.relatedTarget=Re,qe=null,vn(He)===$e&&(jt=new jt(Ne,we+"enter",Yt,g,He),jt.target=Re,jt.relatedTarget=Nr,qe=jt),Nr=qe,Fe&&Yt)t:{for(jt=Fe,Ne=Yt,we=0,Re=jt;Re;Re=v0(Re))we++;for(Re=0,qe=Ne;qe;qe=v0(qe))Re++;for(;0<we-Re;)jt=v0(jt),we--;for(;0<Re-we;)Ne=v0(Ne),Re--;for(;we--;){if(jt===Ne||Ne!==null&&jt===Ne.alternate)break t;jt=v0(jt),Ne=v0(Ne)}jt=null}else jt=null;Fe!==null&&gO(Ze,Pe,Fe,jt,!1),Yt!==null&&Nr!==null&&gO(Ze,Nr,Yt,jt,!0)}}e:{if(Pe=$e?mn($e):window,Fe=Pe.nodeName&&Pe.nodeName.toLowerCase(),Fe==="select"||Fe==="input"&&Pe.type==="file")var wt=Zh;else if(ju(Pe))if(xx)wt=BC;else{wt=FC;var Ln=bx}else Fe=Pe.nodeName,!Fe||Fe.toLowerCase()!=="input"||Pe.type!=="checkbox"&&Pe.type!=="radio"?$e&&Sc($e.elementType)&&(wt=Zh):wt=Wl;if(wt&&(wt=wt(h,$e))){zv(Ze,wt,g,He);break e}Ln&&Ln(h,Pe,$e),h==="focusout"&&$e&&Pe.type==="number"&&$e.memoizedProps.value!=null&&Ec(Pe,"number",Pe.value)}switch(Ln=$e?mn($e):window,h){case"focusin":(ju(Ln)||Ln.contentEditable==="true")&&(Po=Ln,ed=$e,Vu=null);break;case"focusout":Vu=ed=Po=null;break;case"mousedown":Zm=!0;break;case"contextmenu":case"mouseup":case"dragend":Zm=!1,Vv(Ze,g,He);break;case"selectionchange":if(Ym)break;case"keydown":case"keyup":Vv(Ze,g,He)}var Rt;if(Gt)e:{switch(h){case"compositionstart":var Ht="onCompositionStart";break e;case"compositionend":Ht="onCompositionEnd";break e;case"compositionupdate":Ht="onCompositionUpdate";break e}Ht=void 0}else $o?ja(h,g)&&(Ht="onCompositionEnd"):h==="keydown"&&g.keyCode===229&&(Ht="onCompositionStart");Ht&&(ts&&g.locale!=="ko"&&($o||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&$o&&(Rt=Ac()):(da=He,rr="value"in da?da.value:da.textContent,$o=!0)),Ln=N_($e,Ht),0<Ln.length&&(Ht=new fa(Ht,h,null,g,He),Ze.push({event:Ht,listeners:Ln}),Rt?Ht.data=Rt:(Rt=Do(g),Rt!==null&&(Ht.data=Rt)))),(Rt=hr?Xh(h,g):MC(h,g))&&(Ht=N_($e,"onBeforeInput"),0<Ht.length&&(Ln=new fa("onBeforeInput","beforeinput",null,g,He),Ze.push({event:Ln,listeners:Ht}),Ln.data=Rt)),Jne(Ze,h,$e,g,He)}pO(Ze,f)})}function qx(h,f,g){return{instance:h,listener:f,currentTarget:g}}function N_(h,f){for(var g=f+"Capture",E=[];h!==null;){var R=h,j=R.stateNode;if(R=R.tag,R!==5&&R!==26&&R!==27||j===null||(R=Yn(h,g),R!=null&&E.unshift(qx(h,R,j)),R=Yn(h,f),R!=null&&E.push(qx(h,R,j))),h.tag===3)return E;h=h.return}return[]}function v0(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5&&h.tag!==27);return h||null}function gO(h,f,g,E,R){for(var j=f._reactName,ie=[];g!==null&&g!==E;){var le=g,xe=le.alternate,$e=le.stateNode;if(le=le.tag,xe!==null&&xe===E)break;le!==5&&le!==26&&le!==27||$e===null||(xe=$e,R?($e=Yn(g,j),$e!=null&&ie.unshift(qx(g,$e,xe))):R||($e=Yn(g,j),$e!=null&&ie.push(qx(g,$e,xe)))),g=g.return}ie.length!==0&&h.push({event:f,listeners:ie})}var rre=/\r\n?/g,sre=/\u0000|\uFFFD/g;function xO(h){return(typeof h=="string"?h:""+h).replace(rre,`
`).replace(sre,"")}function yO(h,f){return f=xO(f),xO(h)===f}function k_(){}function Ar(h,f,g,E,R,j){switch(g){case"children":typeof E=="string"?f==="body"||f==="textarea"&&E===""||Ei(h,E):(typeof E=="number"||typeof E=="bigint")&&f!=="body"&&Ei(h,""+E);break;case"className":Ao(h,"class",E);break;case"tabIndex":Ao(h,"tabindex",E);break;case"dir":case"role":case"viewBox":case"width":case"height":Ao(h,g,E);break;case"style":jl(h,E,j);break;case"data":if(f!=="object"){Ao(h,"data",E);break}case"src":case"href":if(E===""&&(f!=="a"||g!=="href")){h.removeAttribute(g);break}if(E==null||typeof E=="function"||typeof E=="symbol"||typeof E=="boolean"){h.removeAttribute(g);break}E=Fa(""+E),h.setAttribute(g,E);break;case"action":case"formAction":if(typeof E=="function"){h.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof j=="function"&&(g==="formAction"?(f!=="input"&&Ar(h,f,"name",R.name,R,null),Ar(h,f,"formEncType",R.formEncType,R,null),Ar(h,f,"formMethod",R.formMethod,R,null),Ar(h,f,"formTarget",R.formTarget,R,null)):(Ar(h,f,"encType",R.encType,R,null),Ar(h,f,"method",R.method,R,null),Ar(h,f,"target",R.target,R,null)));if(E==null||typeof E=="symbol"||typeof E=="boolean"){h.removeAttribute(g);break}E=Fa(""+E),h.setAttribute(g,E);break;case"onClick":E!=null&&(h.onclick=k_);break;case"onScroll":E!=null&&jn("scroll",h);break;case"onScrollEnd":E!=null&&jn("scrollend",h);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(r(61));if(g=E.__html,g!=null){if(R.children!=null)throw Error(r(60));h.innerHTML=g}}break;case"multiple":h.multiple=E&&typeof E!="function"&&typeof E!="symbol";break;case"muted":h.muted=E&&typeof E!="function"&&typeof E!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(E==null||typeof E=="function"||typeof E=="boolean"||typeof E=="symbol"){h.removeAttribute("xlink:href");break}g=Fa(""+E),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":E!=null&&typeof E!="function"&&typeof E!="symbol"?h.setAttribute(g,""+E):h.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":E&&typeof E!="function"&&typeof E!="symbol"?h.setAttribute(g,""):h.removeAttribute(g);break;case"capture":case"download":E===!0?h.setAttribute(g,""):E!==!1&&E!=null&&typeof E!="function"&&typeof E!="symbol"?h.setAttribute(g,E):h.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":E!=null&&typeof E!="function"&&typeof E!="symbol"&&!isNaN(E)&&1<=E?h.setAttribute(g,E):h.removeAttribute(g);break;case"rowSpan":case"start":E==null||typeof E=="function"||typeof E=="symbol"||isNaN(E)?h.removeAttribute(g):h.setAttribute(g,E);break;case"popover":jn("beforetoggle",h),jn("toggle",h),Co(h,"popover",E);break;case"xlinkActuate":_i(h,"http://www.w3.org/1999/xlink","xlink:actuate",E);break;case"xlinkArcrole":_i(h,"http://www.w3.org/1999/xlink","xlink:arcrole",E);break;case"xlinkRole":_i(h,"http://www.w3.org/1999/xlink","xlink:role",E);break;case"xlinkShow":_i(h,"http://www.w3.org/1999/xlink","xlink:show",E);break;case"xlinkTitle":_i(h,"http://www.w3.org/1999/xlink","xlink:title",E);break;case"xlinkType":_i(h,"http://www.w3.org/1999/xlink","xlink:type",E);break;case"xmlBase":_i(h,"http://www.w3.org/XML/1998/namespace","xml:base",E);break;case"xmlLang":_i(h,"http://www.w3.org/XML/1998/namespace","xml:lang",E);break;case"xmlSpace":_i(h,"http://www.w3.org/XML/1998/namespace","xml:space",E);break;case"is":Co(h,"is",E);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=jh.get(g)||g,Co(h,g,E))}}function ZA(h,f,g,E,R,j){switch(g){case"style":jl(h,E,j);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(r(61));if(g=E.__html,g!=null){if(R.children!=null)throw Error(r(60));h.innerHTML=g}}break;case"children":typeof E=="string"?Ei(h,E):(typeof E=="number"||typeof E=="bigint")&&Ei(h,""+E);break;case"onScroll":E!=null&&jn("scroll",h);break;case"onScrollEnd":E!=null&&jn("scrollend",h);break;case"onClick":E!=null&&(h.onclick=k_);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!vi.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(R=g.endsWith("Capture"),f=g.slice(2,R?g.length-7:void 0),j=h[pn]||null,j=j!=null?j[g]:null,typeof j=="function"&&h.removeEventListener(f,j,R),typeof E=="function")){typeof j!="function"&&j!==null&&(g in h?h[g]=null:h.hasAttribute(g)&&h.removeAttribute(g)),h.addEventListener(f,E,R);break e}g in h?h[g]=E:E===!0?h.setAttribute(g,""):Co(h,g,E)}}}function Gi(h,f,g){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":jn("error",h),jn("load",h);var E=!1,R=!1,j;for(j in g)if(g.hasOwnProperty(j)){var ie=g[j];if(ie!=null)switch(j){case"src":E=!0;break;case"srcSet":R=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,f));default:Ar(h,f,j,ie,g,null)}}R&&Ar(h,f,"srcSet",g.srcSet,g,null),E&&Ar(h,f,"src",g.src,g,null);return;case"input":jn("invalid",h);var le=j=ie=R=null,xe=null,$e=null;for(E in g)if(g.hasOwnProperty(E)){var He=g[E];if(He!=null)switch(E){case"name":R=He;break;case"type":ie=He;break;case"checked":xe=He;break;case"defaultChecked":$e=He;break;case"value":j=He;break;case"defaultValue":le=He;break;case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(r(137,f));break;default:Ar(h,f,E,He,g,null)}}Hf(h,j,le,xe,$e,ie,R,!1),al(h);return;case"select":jn("invalid",h),E=ie=j=null;for(R in g)if(g.hasOwnProperty(R)&&(le=g[R],le!=null))switch(R){case"value":j=le;break;case"defaultValue":ie=le;break;case"multiple":E=le;default:Ar(h,f,R,le,g,null)}f=j,g=ie,h.multiple=!!E,f!=null?ha(h,!!E,f,!1):g!=null&&ha(h,!!E,g,!0);return;case"textarea":jn("invalid",h),j=R=E=null;for(ie in g)if(g.hasOwnProperty(ie)&&(le=g[ie],le!=null))switch(ie){case"value":E=le;break;case"defaultValue":R=le;break;case"children":j=le;break;case"dangerouslySetInnerHTML":if(le!=null)throw Error(r(91));break;default:Ar(h,f,ie,le,g,null)}ol(h,E,R,j),al(h);return;case"option":for(xe in g)if(g.hasOwnProperty(xe)&&(E=g[xe],E!=null))switch(xe){case"selected":h.selected=E&&typeof E!="function"&&typeof E!="symbol";break;default:Ar(h,f,xe,E,g,null)}return;case"dialog":jn("beforetoggle",h),jn("toggle",h),jn("cancel",h),jn("close",h);break;case"iframe":case"object":jn("load",h);break;case"video":case"audio":for(E=0;E<Wx.length;E++)jn(Wx[E],h);break;case"image":jn("error",h),jn("load",h);break;case"details":jn("toggle",h);break;case"embed":case"source":case"link":jn("error",h),jn("load",h);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($e in g)if(g.hasOwnProperty($e)&&(E=g[$e],E!=null))switch($e){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,f));default:Ar(h,f,$e,E,g,null)}return;default:if(Sc(f)){for(He in g)g.hasOwnProperty(He)&&(E=g[He],E!==void 0&&ZA(h,f,He,E,g,void 0));return}}for(le in g)g.hasOwnProperty(le)&&(E=g[le],E!=null&&Ar(h,f,le,E,g,null))}function ire(h,f,g,E){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var R=null,j=null,ie=null,le=null,xe=null,$e=null,He=null;for(Fe in g){var Ze=g[Fe];if(g.hasOwnProperty(Fe)&&Ze!=null)switch(Fe){case"checked":break;case"value":break;case"defaultValue":xe=Ze;default:E.hasOwnProperty(Fe)||Ar(h,f,Fe,null,E,Ze)}}for(var Pe in E){var Fe=E[Pe];if(Ze=g[Pe],E.hasOwnProperty(Pe)&&(Fe!=null||Ze!=null))switch(Pe){case"type":j=Fe;break;case"name":R=Fe;break;case"checked":$e=Fe;break;case"defaultChecked":He=Fe;break;case"value":ie=Fe;break;case"defaultValue":le=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(r(137,f));break;default:Fe!==Ze&&Ar(h,f,Pe,Fe,E,Ze)}}wi(h,ie,le,xe,$e,He,j,R);return;case"select":Fe=ie=le=Pe=null;for(j in g)if(xe=g[j],g.hasOwnProperty(j)&&xe!=null)switch(j){case"value":break;case"multiple":Fe=xe;default:E.hasOwnProperty(j)||Ar(h,f,j,null,E,xe)}for(R in E)if(j=E[R],xe=g[R],E.hasOwnProperty(R)&&(j!=null||xe!=null))switch(R){case"value":Pe=j;break;case"defaultValue":le=j;break;case"multiple":ie=j;default:j!==xe&&Ar(h,f,R,j,E,xe)}f=le,g=ie,E=Fe,Pe!=null?ha(h,!!g,Pe,!1):!!E!=!!g&&(f!=null?ha(h,!!g,f,!0):ha(h,!!g,g?[]:"",!1));return;case"textarea":Fe=Pe=null;for(le in g)if(R=g[le],g.hasOwnProperty(le)&&R!=null&&!E.hasOwnProperty(le))switch(le){case"value":break;case"children":break;default:Ar(h,f,le,null,E,R)}for(ie in E)if(R=E[ie],j=g[ie],E.hasOwnProperty(ie)&&(R!=null||j!=null))switch(ie){case"value":Pe=R;break;case"defaultValue":Fe=R;break;case"children":break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(r(91));break;default:R!==j&&Ar(h,f,ie,R,E,j)}qr(h,Pe,Fe);return;case"option":for(var Yt in g)if(Pe=g[Yt],g.hasOwnProperty(Yt)&&Pe!=null&&!E.hasOwnProperty(Yt))switch(Yt){case"selected":h.selected=!1;break;default:Ar(h,f,Yt,null,E,Pe)}for(xe in E)if(Pe=E[xe],Fe=g[xe],E.hasOwnProperty(xe)&&Pe!==Fe&&(Pe!=null||Fe!=null))switch(xe){case"selected":h.selected=Pe&&typeof Pe!="function"&&typeof Pe!="symbol";break;default:Ar(h,f,xe,Pe,E,Fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var jt in g)Pe=g[jt],g.hasOwnProperty(jt)&&Pe!=null&&!E.hasOwnProperty(jt)&&Ar(h,f,jt,null,E,Pe);for($e in E)if(Pe=E[$e],Fe=g[$e],E.hasOwnProperty($e)&&Pe!==Fe&&(Pe!=null||Fe!=null))switch($e){case"children":case"dangerouslySetInnerHTML":if(Pe!=null)throw Error(r(137,f));break;default:Ar(h,f,$e,Pe,E,Fe)}return;default:if(Sc(f)){for(var Nr in g)Pe=g[Nr],g.hasOwnProperty(Nr)&&Pe!==void 0&&!E.hasOwnProperty(Nr)&&ZA(h,f,Nr,void 0,E,Pe);for(He in E)Pe=E[He],Fe=g[He],!E.hasOwnProperty(He)||Pe===Fe||Pe===void 0&&Fe===void 0||ZA(h,f,He,Pe,E,Fe);return}}for(var Ne in g)Pe=g[Ne],g.hasOwnProperty(Ne)&&Pe!=null&&!E.hasOwnProperty(Ne)&&Ar(h,f,Ne,null,E,Pe);for(Ze in E)Pe=E[Ze],Fe=g[Ze],!E.hasOwnProperty(Ze)||Pe===Fe||Pe==null&&Fe==null||Ar(h,f,Ze,Pe,E,Fe)}var QA=null,JA=null;function I_(h){return h.nodeType===9?h:h.ownerDocument}function bO(h){switch(h){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vO(h,f){if(h===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return h===1&&f==="foreignObject"?0:h}function eN(h,f){return h==="textarea"||h==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var tN=null;function are(){var h=window.event;return h&&h.type==="popstate"?h===tN?!1:(tN=h,!0):(tN=null,!1)}var _O=typeof setTimeout=="function"?setTimeout:void 0,ore=typeof clearTimeout=="function"?clearTimeout:void 0,wO=typeof Promise=="function"?Promise:void 0,lre=typeof queueMicrotask=="function"?queueMicrotask:typeof wO<"u"?function(h){return wO.resolve(null).then(h).catch(cre)}:_O;function cre(h){setTimeout(function(){throw h})}function _d(h){return h==="head"}function EO(h,f){var g=f,E=0,R=0;do{var j=g.nextSibling;if(h.removeChild(g),j&&j.nodeType===8)if(g=j.data,g==="/$"){if(0<E&&8>E){g=E;var ie=h.ownerDocument;if(g&1&&Kx(ie.documentElement),g&2&&Kx(ie.body),g&4)for(g=ie.head,Kx(g),ie=g.firstChild;ie;){var le=ie.nextSibling,xe=ie.nodeName;ie[ri]||xe==="SCRIPT"||xe==="STYLE"||xe==="LINK"&&ie.rel.toLowerCase()==="stylesheet"||g.removeChild(ie),ie=le}}if(R===0){h.removeChild(j),ny(f);return}R--}else g==="$"||g==="$?"||g==="$!"?R++:E=g.charCodeAt(0)-48;else E=0;g=j}while(g);ny(f)}function nN(h){var f=h.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var g=f;switch(f=f.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":nN(g),Xn(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}h.removeChild(g)}}function ure(h,f,g,E){for(;h.nodeType===1;){var R=g;if(h.nodeName.toLowerCase()!==f.toLowerCase()){if(!E&&(h.nodeName!=="INPUT"||h.type!=="hidden"))break}else if(E){if(!h[ri])switch(f){case"meta":if(!h.hasAttribute("itemprop"))break;return h;case"link":if(j=h.getAttribute("rel"),j==="stylesheet"&&h.hasAttribute("data-precedence"))break;if(j!==R.rel||h.getAttribute("href")!==(R.href==null||R.href===""?null:R.href)||h.getAttribute("crossorigin")!==(R.crossOrigin==null?null:R.crossOrigin)||h.getAttribute("title")!==(R.title==null?null:R.title))break;return h;case"style":if(h.hasAttribute("data-precedence"))break;return h;case"script":if(j=h.getAttribute("src"),(j!==(R.src==null?null:R.src)||h.getAttribute("type")!==(R.type==null?null:R.type)||h.getAttribute("crossorigin")!==(R.crossOrigin==null?null:R.crossOrigin))&&j&&h.hasAttribute("async")&&!h.hasAttribute("itemprop"))break;return h;default:return h}}else if(f==="input"&&h.type==="hidden"){var j=R.name==null?null:""+R.name;if(R.type==="hidden"&&h.getAttribute("name")===j)return h}else return h;if(h=Yl(h.nextSibling),h===null)break}return null}function hre(h,f,g){if(f==="")return null;for(;h.nodeType!==3;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!g||(h=Yl(h.nextSibling),h===null))return null;return h}function rN(h){return h.data==="$!"||h.data==="$?"&&h.ownerDocument.readyState==="complete"}function dre(h,f){var g=h.ownerDocument;if(h.data!=="$?"||g.readyState==="complete")f();else{var E=function(){f(),g.removeEventListener("DOMContentLoaded",E)};g.addEventListener("DOMContentLoaded",E),h._reactRetry=E}}function Yl(h){for(;h!=null;h=h.nextSibling){var f=h.nodeType;if(f===1||f===3)break;if(f===8){if(f=h.data,f==="$"||f==="$!"||f==="$?"||f==="F!"||f==="F")break;if(f==="/$")return null}}return h}var sN=null;function SO(h){h=h.previousSibling;for(var f=0;h;){if(h.nodeType===8){var g=h.data;if(g==="$"||g==="$!"||g==="$?"){if(f===0)return h;f--}else g==="/$"&&f++}h=h.previousSibling}return null}function TO(h,f,g){switch(f=I_(g),h){case"html":if(h=f.documentElement,!h)throw Error(r(452));return h;case"head":if(h=f.head,!h)throw Error(r(453));return h;case"body":if(h=f.body,!h)throw Error(r(454));return h;default:throw Error(r(451))}}function Kx(h){for(var f=h.attributes;f.length;)h.removeAttributeNode(f[0]);Xn(h)}var gl=new Map,CO=new Set;function R_(h){return typeof h.getRootNode=="function"?h.getRootNode():h.nodeType===9?h:h.ownerDocument}var th=Y.d;Y.d={f:fre,r:pre,D:mre,C:gre,L:xre,m:yre,X:vre,S:bre,M:_re};function fre(){var h=th.f(),f=w_();return h||f}function pre(h){var f=ks(h);f!==null&&f.tag===5&&f.type==="form"?WL(f):th.r(h)}var _0=typeof document>"u"?null:document;function AO(h,f,g){var E=_0;if(E&&typeof f=="string"&&f){var R=ls(f);R='link[rel="'+h+'"][href="'+R+'"]',typeof g=="string"&&(R+='[crossorigin="'+g+'"]'),CO.has(R)||(CO.add(R),h={rel:h,crossOrigin:g,href:f},E.querySelector(R)===null&&(f=E.createElement("link"),Gi(f,"link",h),ur(f),E.head.appendChild(f)))}}function mre(h){th.D(h),AO("dns-prefetch",h,null)}function gre(h,f){th.C(h,f),AO("preconnect",h,f)}function xre(h,f,g){th.L(h,f,g);var E=_0;if(E&&h&&f){var R='link[rel="preload"][as="'+ls(f)+'"]';f==="image"&&g&&g.imageSrcSet?(R+='[imagesrcset="'+ls(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(R+='[imagesizes="'+ls(g.imageSizes)+'"]')):R+='[href="'+ls(h)+'"]';var j=R;switch(f){case"style":j=w0(h);break;case"script":j=E0(h)}gl.has(j)||(h=u({rel:"preload",href:f==="image"&&g&&g.imageSrcSet?void 0:h,as:f},g),gl.set(j,h),E.querySelector(R)!==null||f==="style"&&E.querySelector(Xx(j))||f==="script"&&E.querySelector(Yx(j))||(f=E.createElement("link"),Gi(f,"link",h),ur(f),E.head.appendChild(f)))}}function yre(h,f){th.m(h,f);var g=_0;if(g&&h){var E=f&&typeof f.as=="string"?f.as:"script",R='link[rel="modulepreload"][as="'+ls(E)+'"][href="'+ls(h)+'"]',j=R;switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":j=E0(h)}if(!gl.has(j)&&(h=u({rel:"modulepreload",href:h},f),gl.set(j,h),g.querySelector(R)===null)){switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Yx(j)))return}E=g.createElement("link"),Gi(E,"link",h),ur(E),g.head.appendChild(E)}}}function bre(h,f,g){th.S(h,f,g);var E=_0;if(E&&h){var R=Bn(E).hoistableStyles,j=w0(h);f=f||"default";var ie=R.get(j);if(!ie){var le={loading:0,preload:null};if(ie=E.querySelector(Xx(j)))le.loading=5;else{h=u({rel:"stylesheet",href:h,"data-precedence":f},g),(g=gl.get(j))&&iN(h,g);var xe=ie=E.createElement("link");ur(xe),Gi(xe,"link",h),xe._p=new Promise(function($e,He){xe.onload=$e,xe.onerror=He}),xe.addEventListener("load",function(){le.loading|=1}),xe.addEventListener("error",function(){le.loading|=2}),le.loading|=4,D_(ie,f,E)}ie={type:"stylesheet",instance:ie,count:1,state:le},R.set(j,ie)}}}function vre(h,f){th.X(h,f);var g=_0;if(g&&h){var E=Bn(g).hoistableScripts,R=E0(h),j=E.get(R);j||(j=g.querySelector(Yx(R)),j||(h=u({src:h,async:!0},f),(f=gl.get(R))&&aN(h,f),j=g.createElement("script"),ur(j),Gi(j,"link",h),g.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},E.set(R,j))}}function _re(h,f){th.M(h,f);var g=_0;if(g&&h){var E=Bn(g).hoistableScripts,R=E0(h),j=E.get(R);j||(j=g.querySelector(Yx(R)),j||(h=u({src:h,async:!0,type:"module"},f),(f=gl.get(R))&&aN(h,f),j=g.createElement("script"),ur(j),Gi(j,"link",h),g.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},E.set(R,j))}}function NO(h,f,g,E){var R=(R=ae.current)?R_(R):null;if(!R)throw Error(r(446));switch(h){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(f=w0(g.href),g=Bn(R).hoistableStyles,E=g.get(f),E||(E={type:"style",instance:null,count:0,state:null},g.set(f,E)),E):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){h=w0(g.href);var j=Bn(R).hoistableStyles,ie=j.get(h);if(ie||(R=R.ownerDocument||R,ie={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},j.set(h,ie),(j=R.querySelector(Xx(h)))&&!j._p&&(ie.instance=j,ie.state.loading=5),gl.has(h)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},gl.set(h,g),j||wre(R,h,g,ie.state))),f&&E===null)throw Error(r(528,""));return ie}if(f&&E!==null)throw Error(r(529,""));return null;case"script":return f=g.async,g=g.src,typeof g=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=E0(g),g=Bn(R).hoistableScripts,E=g.get(f),E||(E={type:"script",instance:null,count:0,state:null},g.set(f,E)),E):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,h))}}function w0(h){return'href="'+ls(h)+'"'}function Xx(h){return'link[rel="stylesheet"]['+h+"]"}function kO(h){return u({},h,{"data-precedence":h.precedence,precedence:null})}function wre(h,f,g,E){h.querySelector('link[rel="preload"][as="style"]['+f+"]")?E.loading=1:(f=h.createElement("link"),E.preload=f,f.addEventListener("load",function(){return E.loading|=1}),f.addEventListener("error",function(){return E.loading|=2}),Gi(f,"link",g),ur(f),h.head.appendChild(f))}function E0(h){return'[src="'+ls(h)+'"]'}function Yx(h){return"script[async]"+h}function IO(h,f,g){if(f.count++,f.instance===null)switch(f.type){case"style":var E=h.querySelector('style[data-href~="'+ls(g.href)+'"]');if(E)return f.instance=E,ur(E),E;var R=u({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return E=(h.ownerDocument||h).createElement("style"),ur(E),Gi(E,"style",R),D_(E,g.precedence,h),f.instance=E;case"stylesheet":R=w0(g.href);var j=h.querySelector(Xx(R));if(j)return f.state.loading|=4,f.instance=j,ur(j),j;E=kO(g),(R=gl.get(R))&&iN(E,R),j=(h.ownerDocument||h).createElement("link"),ur(j);var ie=j;return ie._p=new Promise(function(le,xe){ie.onload=le,ie.onerror=xe}),Gi(j,"link",E),f.state.loading|=4,D_(j,g.precedence,h),f.instance=j;case"script":return j=E0(g.src),(R=h.querySelector(Yx(j)))?(f.instance=R,ur(R),R):(E=g,(R=gl.get(j))&&(E=u({},g),aN(E,R)),h=h.ownerDocument||h,R=h.createElement("script"),ur(R),Gi(R,"link",E),h.head.appendChild(R),f.instance=R);case"void":return null;default:throw Error(r(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(E=f.instance,f.state.loading|=4,D_(E,g.precedence,h));return f.instance}function D_(h,f,g){for(var E=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),R=E.length?E[E.length-1]:null,j=R,ie=0;ie<E.length;ie++){var le=E[ie];if(le.dataset.precedence===f)j=le;else if(j!==R)break}j?j.parentNode.insertBefore(h,j.nextSibling):(f=g.nodeType===9?g.head:g,f.insertBefore(h,f.firstChild))}function iN(h,f){h.crossOrigin==null&&(h.crossOrigin=f.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=f.referrerPolicy),h.title==null&&(h.title=f.title)}function aN(h,f){h.crossOrigin==null&&(h.crossOrigin=f.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=f.referrerPolicy),h.integrity==null&&(h.integrity=f.integrity)}var $_=null;function RO(h,f,g){if($_===null){var E=new Map,R=$_=new Map;R.set(g,E)}else R=$_,E=R.get(g),E||(E=new Map,R.set(g,E));if(E.has(h))return E;for(E.set(h,null),g=g.getElementsByTagName(h),R=0;R<g.length;R++){var j=g[R];if(!(j[ri]||j[zt]||h==="link"&&j.getAttribute("rel")==="stylesheet")&&j.namespaceURI!=="http://www.w3.org/2000/svg"){var ie=j.getAttribute(f)||"";ie=h+ie;var le=E.get(ie);le?le.push(j):E.set(ie,[j])}}return E}function DO(h,f,g){h=h.ownerDocument||h,h.head.insertBefore(g,f==="title"?h.querySelector("head > title"):null)}function Ere(h,f,g){if(g===1||f.itemProp!=null)return!1;switch(h){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return h=f.disabled,typeof f.precedence=="string"&&h==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function $O(h){return!(h.type==="stylesheet"&&(h.state.loading&3)===0)}var Zx=null;function Sre(){}function Tre(h,f,g){if(Zx===null)throw Error(r(475));var E=Zx;if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var R=w0(g.href),j=h.querySelector(Xx(R));if(j){h=j._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(E.count++,E=L_.bind(E),h.then(E,E)),f.state.loading|=4,f.instance=j,ur(j);return}j=h.ownerDocument||h,g=kO(g),(R=gl.get(R))&&iN(g,R),j=j.createElement("link"),ur(j);var ie=j;ie._p=new Promise(function(le,xe){ie.onload=le,ie.onerror=xe}),Gi(j,"link",g),f.instance=j}E.stylesheets===null&&(E.stylesheets=new Map),E.stylesheets.set(f,h),(h=f.state.preload)&&(f.state.loading&3)===0&&(E.count++,f=L_.bind(E),h.addEventListener("load",f),h.addEventListener("error",f))}}function Cre(){if(Zx===null)throw Error(r(475));var h=Zx;return h.stylesheets&&h.count===0&&oN(h,h.stylesheets),0<h.count?function(f){var g=setTimeout(function(){if(h.stylesheets&&oN(h,h.stylesheets),h.unsuspend){var E=h.unsuspend;h.unsuspend=null,E()}},6e4);return h.unsuspend=f,function(){h.unsuspend=null,clearTimeout(g)}}:null}function L_(){if(this.count--,this.count===0){if(this.stylesheets)oN(this,this.stylesheets);else if(this.unsuspend){var h=this.unsuspend;this.unsuspend=null,h()}}}var P_=null;function oN(h,f){h.stylesheets=null,h.unsuspend!==null&&(h.count++,P_=new Map,f.forEach(Are,h),P_=null,L_.call(h))}function Are(h,f){if(!(f.state.loading&4)){var g=P_.get(h);if(g)var E=g.get(null);else{g=new Map,P_.set(h,g);for(var R=h.querySelectorAll("link[data-precedence],style[data-precedence]"),j=0;j<R.length;j++){var ie=R[j];(ie.nodeName==="LINK"||ie.getAttribute("media")!=="not all")&&(g.set(ie.dataset.precedence,ie),E=ie)}E&&g.set(null,E)}R=f.instance,ie=R.getAttribute("data-precedence"),j=g.get(ie)||E,j===E&&g.set(null,R),g.set(ie,R),this.count++,E=L_.bind(this),R.addEventListener("load",E),R.addEventListener("error",E),j?j.parentNode.insertBefore(R,j.nextSibling):(h=h.nodeType===9?h.head:h,h.insertBefore(R,h.firstChild)),f.state.loading|=4}}var Qx={$$typeof:C,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function Nre(h,f,g,E,R,j,ie,le){this.tag=1,this.containerInfo=h,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Fn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fn(0),this.hiddenUpdates=Fn(null),this.identifierPrefix=E,this.onUncaughtError=R,this.onCaughtError=j,this.onRecoverableError=ie,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=le,this.incompleteTransitions=new Map}function LO(h,f,g,E,R,j,ie,le,xe,$e,He,Ze){return h=new Nre(h,f,g,ie,le,xe,$e,Ze),f=1,j===!0&&(f|=24),j=qa(3,null,null,f),h.current=j,j.stateNode=h,f=VC(),f.refCount++,h.pooledCache=f,f.refCount++,j.memoizedState={element:E,isDehydrated:g,cache:f},WC(j),h}function PO(h){return h?(h=Wu,h):Wu}function OO(h,f,g,E,R,j){R=PO(R),E.context===null?E.context=R:E.pendingContext=R,E=ld(f),E.payload={element:g},j=j===void 0?null:j,j!==null&&(E.callback=j),g=cd(h,E,f),g!==null&&(Uo(g,h,f),Nx(g,h,f))}function MO(h,f){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var g=h.retryLane;h.retryLane=g!==0&&g<f?g:f}}function lN(h,f){MO(h,f),(h=h.alternate)&&MO(h,f)}function FO(h){if(h.tag===13){var f=rd(h,67108864);f!==null&&Uo(f,h,67108864),lN(h,67108864)}}var O_=!0;function kre(h,f,g,E){var R=B.T;B.T=null;var j=Y.p;try{Y.p=2,cN(h,f,g,E)}finally{Y.p=j,B.T=R}}function Ire(h,f,g,E){var R=B.T;B.T=null;var j=Y.p;try{Y.p=8,cN(h,f,g,E)}finally{Y.p=j,B.T=R}}function cN(h,f,g,E){if(O_){var R=uN(E);if(R===null)YA(h,f,E,M_,g),zO(h,E);else if(Dre(R,h,f,g,E))E.stopPropagation();else if(zO(h,E),f&4&&-1<Rre.indexOf(h)){for(;R!==null;){var j=ks(R);if(j!==null)switch(j.tag){case 3:if(j=j.stateNode,j.current.memoizedState.isDehydrated){var ie=rn(j.pendingLanes);if(ie!==0){var le=j;for(le.pendingLanes|=2,le.entangledLanes|=2;ie;){var xe=1<<31-Bt(ie);le.entanglements[1]|=xe,ie&=~xe}Mc(j),(wr&6)===0&&(v_=ct()+500,Hx(0))}}break;case 13:le=rd(j,2),le!==null&&Uo(le,j,2),w_(),lN(j,2)}if(j=uN(E),j===null&&YA(h,f,E,M_,g),j===R)break;R=j}R!==null&&E.stopPropagation()}else YA(h,f,E,null,g)}}function uN(h){return h=Tc(h),hN(h)}var M_=null;function hN(h){if(M_=null,h=vn(h),h!==null){var f=i(h);if(f===null)h=null;else{var g=f.tag;if(g===13){if(h=a(f),h!==null)return h;h=null}else if(g===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;h=null}else f!==h&&(h=null)}}return M_=h,null}function BO(h){switch(h){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xt()){case en:return 2;case ht:return 8;case St:case an:return 32;case Ot:return 268435456;default:return 32}default:return 32}}var dN=!1,wd=null,Ed=null,Sd=null,Jx=new Map,ey=new Map,Td=[],Rre="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function zO(h,f){switch(h){case"focusin":case"focusout":wd=null;break;case"dragenter":case"dragleave":Ed=null;break;case"mouseover":case"mouseout":Sd=null;break;case"pointerover":case"pointerout":Jx.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":ey.delete(f.pointerId)}}function ty(h,f,g,E,R,j){return h===null||h.nativeEvent!==j?(h={blockedOn:f,domEventName:g,eventSystemFlags:E,nativeEvent:j,targetContainers:[R]},f!==null&&(f=ks(f),f!==null&&FO(f)),h):(h.eventSystemFlags|=E,f=h.targetContainers,R!==null&&f.indexOf(R)===-1&&f.push(R),h)}function Dre(h,f,g,E,R){switch(f){case"focusin":return wd=ty(wd,h,f,g,E,R),!0;case"dragenter":return Ed=ty(Ed,h,f,g,E,R),!0;case"mouseover":return Sd=ty(Sd,h,f,g,E,R),!0;case"pointerover":var j=R.pointerId;return Jx.set(j,ty(Jx.get(j)||null,h,f,g,E,R)),!0;case"gotpointercapture":return j=R.pointerId,ey.set(j,ty(ey.get(j)||null,h,f,g,E,R)),!0}return!1}function jO(h){var f=vn(h.target);if(f!==null){var g=i(f);if(g!==null){if(f=g.tag,f===13){if(f=a(g),f!==null){h.blockedOn=f,bi(h.priority,function(){if(g.tag===13){var E=Vo();E=yi(E);var R=rd(g,E);R!==null&&Uo(R,g,E),lN(g,E)}});return}}else if(f===3&&g.stateNode.current.memoizedState.isDehydrated){h.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}h.blockedOn=null}function F_(h){if(h.blockedOn!==null)return!1;for(var f=h.targetContainers;0<f.length;){var g=uN(h.nativeEvent);if(g===null){g=h.nativeEvent;var E=new g.constructor(g.type,g);Mu=E,g.target.dispatchEvent(E),Mu=null}else return f=ks(g),f!==null&&FO(f),h.blockedOn=g,!1;f.shift()}return!0}function VO(h,f,g){F_(h)&&g.delete(f)}function $re(){dN=!1,wd!==null&&F_(wd)&&(wd=null),Ed!==null&&F_(Ed)&&(Ed=null),Sd!==null&&F_(Sd)&&(Sd=null),Jx.forEach(VO),ey.forEach(VO)}function B_(h,f){h.blockedOn===f&&(h.blockedOn=null,dN||(dN=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,$re)))}var z_=null;function UO(h){z_!==h&&(z_=h,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){z_===h&&(z_=null);for(var f=0;f<h.length;f+=3){var g=h[f],E=h[f+1],R=h[f+2];if(typeof E!="function"){if(hN(E||g)===null)continue;break}var j=ks(g);j!==null&&(h.splice(f,3),f-=3,hA(j,{pending:!0,data:R,method:g.method,action:E},E,R))}}))}function ny(h){function f(xe){return B_(xe,h)}wd!==null&&B_(wd,h),Ed!==null&&B_(Ed,h),Sd!==null&&B_(Sd,h),Jx.forEach(f),ey.forEach(f);for(var g=0;g<Td.length;g++){var E=Td[g];E.blockedOn===h&&(E.blockedOn=null)}for(;0<Td.length&&(g=Td[0],g.blockedOn===null);)jO(g),g.blockedOn===null&&Td.shift();if(g=(h.ownerDocument||h).$$reactFormReplay,g!=null)for(E=0;E<g.length;E+=3){var R=g[E],j=g[E+1],ie=R[pn]||null;if(typeof j=="function")ie||UO(g);else if(ie){var le=null;if(j&&j.hasAttribute("formAction")){if(R=j,ie=j[pn]||null)le=ie.formAction;else if(hN(R)!==null)continue}else le=ie.action;typeof le=="function"?g[E+1]=le:(g.splice(E,3),E-=3),UO(g)}}}function fN(h){this._internalRoot=h}j_.prototype.render=fN.prototype.render=function(h){var f=this._internalRoot;if(f===null)throw Error(r(409));var g=f.current,E=Vo();OO(g,E,h,f,null,null)},j_.prototype.unmount=fN.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var f=h.containerInfo;OO(h.current,2,null,h,null,null),w_(),f[nn]=null}};function j_(h){this._internalRoot=h}j_.prototype.unstable_scheduleHydration=function(h){if(h){var f=An();h={blockedOn:null,target:h,priority:f};for(var g=0;g<Td.length&&f!==0&&f<Td[g].priority;g++);Td.splice(g,0,h),g===0&&jO(h)}};var GO=e.version;if(GO!=="19.1.1")throw Error(r(527,GO,"19.1.1"));Y.findDOMNode=function(h){var f=h._reactInternals;if(f===void 0)throw typeof h.render=="function"?Error(r(188)):(h=Object.keys(h).join(","),Error(r(268,h)));return h=l(f),h=h!==null?c(h):null,h=h===null?null:h.stateNode,h};var Lre={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var V_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!V_.isDisabled&&V_.supportsFiber)try{It=V_.inject(Lre),Tt=V_}catch{}}return sy.createRoot=function(h,f){if(!s(h))throw Error(r(299));var g=!1,E="",R=aP,j=oP,ie=lP,le=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(E=f.identifierPrefix),f.onUncaughtError!==void 0&&(R=f.onUncaughtError),f.onCaughtError!==void 0&&(j=f.onCaughtError),f.onRecoverableError!==void 0&&(ie=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(le=f.unstable_transitionCallbacks)),f=LO(h,1,!1,null,null,g,E,R,j,ie,le,null),h[nn]=f.current,XA(h),new fN(f)},sy.hydrateRoot=function(h,f,g){if(!s(h))throw Error(r(299));var E=!1,R="",j=aP,ie=oP,le=lP,xe=null,$e=null;return g!=null&&(g.unstable_strictMode===!0&&(E=!0),g.identifierPrefix!==void 0&&(R=g.identifierPrefix),g.onUncaughtError!==void 0&&(j=g.onUncaughtError),g.onCaughtError!==void 0&&(ie=g.onCaughtError),g.onRecoverableError!==void 0&&(le=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(xe=g.unstable_transitionCallbacks),g.formState!==void 0&&($e=g.formState)),f=LO(h,1,!0,f,g??null,E,R,j,ie,le,xe,$e),f.context=PO(null),g=f.current,E=Vo(),E=yi(E),R=ld(E),R.callback=null,cd(g,R,E),g=E,f.current.lanes=g,Ft(f,g),Mc(f),h[nn]=f.current,XA(h),new j_(f)},sy.version="19.1.1",sy}var nM;function qre(){if(nM)return gN.exports;nM=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gN.exports=Wre(),gN.exports}var Kre=qre();/**
 * react-router v7.9.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var rM="popstate";function Xre(n={}){function e(r,s){let{pathname:i,search:a,hash:o}=r.location;return zk("",{pathname:i,search:a,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Yy(s)}return Zre(e,t,null,n)}function fs(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function mu(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Yre(){return Math.random().toString(36).substring(2,10)}function sM(n,e){return{usr:n.state,key:n.key,idx:e}}function zk(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Pg(e):e,state:t,key:e&&e.key||r||Yre()}}function Yy({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Pg(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function Zre(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,o="POP",l=null,c=u();c==null&&(c=0,a.replaceState({...a.state,idx:c},""));function u(){return(a.state||{idx:null}).idx}function d(){o="POP";let b=u(),S=b==null?null:b-c;c=b,l&&l({action:o,location:v.location,delta:S})}function p(b,S){o="PUSH";let T=zk(v.location,b,S);c=u()+1;let C=sM(T,c),I=v.createHref(T);try{a.pushState(C,"",I)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;s.location.assign(I)}i&&l&&l({action:o,location:v.location,delta:1})}function x(b,S){o="REPLACE";let T=zk(v.location,b,S);c=u();let C=sM(T,c),I=v.createHref(T);a.replaceState(C,"",I),i&&l&&l({action:o,location:v.location,delta:0})}function y(b){return Qre(b)}let v={get action(){return o},get location(){return n(s,a)},listen(b){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(rM,d),l=b,()=>{s.removeEventListener(rM,d),l=null}},createHref(b){return e(s,b)},createURL:y,encodeLocation(b){let S=y(b);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:p,replace:x,go(b){return a.go(b)}};return v}function Qre(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),fs(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Yy(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function o7(n,e,t="/"){return Jre(n,e,t,!1)}function Jre(n,e,t,r){let s=typeof e=="string"?Pg(e):e,i=wh(s.pathname||"/",t);if(i==null)return null;let a=l7(n);ese(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=hse(i);o=cse(a[l],c,r)}return o}function l7(n,e=[],t=[],r="",s=!1){let i=(a,o,l=s,c)=>{let u={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(r)&&l)return;fs(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length)}let d=gh([r,u.relativePath]),p=t.concat(u);a.children&&a.children.length>0&&(fs(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),l7(a.children,e,p,d,l)),!(a.path==null&&!a.index)&&e.push({path:d,score:ose(d,a.index),routesMeta:p})};return n.forEach((a,o)=>{if(a.path===""||!a.path?.includes("?"))i(a,o);else for(let l of c7(a.path))i(a,o,!0,l)}),e}function c7(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=c7(r.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),s&&o.push(...a),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function ese(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:lse(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var tse=/^:[\w-]+$/,nse=3,rse=2,sse=1,ise=10,ase=-2,iM=n=>n==="*";function ose(n,e){let t=n.split("/"),r=t.length;return t.some(iM)&&(r+=ase),e&&(r+=rse),t.filter(s=>!iM(s)).reduce((s,i)=>s+(tse.test(i)?nse:i===""?sse:ise),r)}function lse(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function cse(n,e,t=!1){let{routesMeta:r}=n,s={},i="/",a=[];for(let o=0;o<r.length;++o){let l=r[o],c=o===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=z2({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),p=l.route;if(!d&&c&&t&&!r[r.length-1].route.index&&(d=z2({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),a.push({params:s,pathname:gh([i,d.pathname]),pathnameBase:mse(gh([i,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(i=gh([i,d.pathnameBase]))}return a}function z2(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=use(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:r.reduce((c,{paramName:u,isOptional:d},p)=>{if(u==="*"){let y=o[p]||"";a=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const x=o[p];return d&&!x?c[u]=void 0:c[u]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:a,pattern:n}}function use(n,e=!1,t=!0){mu(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function hse(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return mu(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function wh(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function dse(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Pg(n):n;return{pathname:t?t.startsWith("/")?t:fse(t,e):e,search:gse(r),hash:xse(s)}}function fse(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function vN(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function pse(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function u7(n){let e=pse(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function h7(n,e,t,r=!1){let s;typeof n=="string"?s=Pg(n):(s={...n},fs(!s.pathname||!s.pathname.includes("?"),vN("?","pathname","search",s)),fs(!s.pathname||!s.pathname.includes("#"),vN("#","pathname","hash",s)),fs(!s.search||!s.search.includes("#"),vN("#","search","hash",s)));let i=n===""||s.pathname==="",a=i?"/":s.pathname,o;if(a==null)o=t;else{let d=e.length-1;if(!r&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),d-=1;s.pathname=p.join("/")}o=d>=0?e[d]:"/"}let l=dse(s,o),c=a&&a!=="/"&&a.endsWith("/"),u=(i||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var gh=n=>n.join("/").replace(/\/\/+/g,"/"),mse=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),gse=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,xse=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function yse(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var d7=["POST","PUT","PATCH","DELETE"];new Set(d7);var bse=["GET",...d7];new Set(bse);var Og=Se.createContext(null);Og.displayName="DataRouter";var aS=Se.createContext(null);aS.displayName="DataRouterState";Se.createContext(!1);var f7=Se.createContext({isTransitioning:!1});f7.displayName="ViewTransition";var vse=Se.createContext(new Map);vse.displayName="Fetchers";var _se=Se.createContext(null);_se.displayName="Await";var Iu=Se.createContext(null);Iu.displayName="Navigation";var B1=Se.createContext(null);B1.displayName="Location";var $h=Se.createContext({outlet:null,matches:[],isDataRoute:!1});$h.displayName="Route";var V3=Se.createContext(null);V3.displayName="RouteError";function wse(n,{relative:e}={}){fs(z1(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=Se.useContext(Iu),{hash:s,pathname:i,search:a}=V1(n,{relative:e}),o=i;return t!=="/"&&(o=i==="/"?t:gh([t,i])),r.createHref({pathname:o,search:a,hash:s})}function z1(){return Se.useContext(B1)!=null}function _c(){return fs(z1(),"useLocation() may be used only in the context of a <Router> component."),Se.useContext(B1).location}var p7="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function m7(n){Se.useContext(Iu).static||Se.useLayoutEffect(n)}function j1(){let{isDataRoute:n}=Se.useContext($h);return n?Pse():Ese()}function Ese(){fs(z1(),"useNavigate() may be used only in the context of a <Router> component.");let n=Se.useContext(Og),{basename:e,navigator:t}=Se.useContext(Iu),{matches:r}=Se.useContext($h),{pathname:s}=_c(),i=JSON.stringify(u7(r)),a=Se.useRef(!1);return m7(()=>{a.current=!0}),Se.useCallback((l,c={})=>{if(mu(a.current,p7),!a.current)return;if(typeof l=="number"){t.go(l);return}let u=h7(l,JSON.parse(i),s,c.relative==="path");n==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:gh([e,u.pathname])),(c.replace?t.replace:t.push)(u,c.state,c)},[e,t,i,s,n])}Se.createContext(null);function V1(n,{relative:e}={}){let{matches:t}=Se.useContext($h),{pathname:r}=_c(),s=JSON.stringify(u7(t));return Se.useMemo(()=>h7(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function Sse(n,e){return g7(n,e)}function g7(n,e,t,r,s){fs(z1(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=Se.useContext(Iu),{matches:a}=Se.useContext($h),o=a[a.length-1],l=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",d=o&&o.route;{let T=d&&d.path||"";x7(c,!d||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let p=_c(),x;if(e){let T=typeof e=="string"?Pg(e):e;fs(u==="/"||T.pathname?.startsWith(u),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${T.pathname}" was given in the \`location\` prop.`),x=T}else x=p;let y=x.pathname||"/",v=y;if(u!=="/"){let T=u.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(T.length).join("/")}let b=o7(n,{pathname:v});mu(d||b!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),mu(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=kse(b&&b.map(T=>Object.assign({},T,{params:Object.assign({},l,T.params),pathname:gh([u,i.encodeLocation?i.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?u:gh([u,i.encodeLocation?i.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),a,t,r,s);return e&&S?Se.createElement(B1.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},S):S}function Tse(){let n=Lse(),e=yse(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",n),a=Se.createElement(Se.Fragment,null,Se.createElement("p",null,"💿 Hey developer 👋"),Se.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Se.createElement("code",{style:i},"ErrorBoundary")," or"," ",Se.createElement("code",{style:i},"errorElement")," prop on your route.")),Se.createElement(Se.Fragment,null,Se.createElement("h2",null,"Unexpected Application Error!"),Se.createElement("h3",{style:{fontStyle:"italic"}},e),t?Se.createElement("pre",{style:s},t):null,a)}var Cse=Se.createElement(Tse,null),Ase=class extends Se.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.unstable_onError?this.props.unstable_onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?Se.createElement($h.Provider,{value:this.props.routeContext},Se.createElement(V3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Nse({routeContext:n,match:e,children:t}){let r=Se.useContext(Og);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),Se.createElement($h.Provider,{value:n},t)}function kse(n,e=[],t=null,r=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,a=t?.errors;if(a!=null){let c=i.findIndex(u=>u.route.id&&a?.[u.route.id]!==void 0);fs(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,c+1))}let o=!1,l=-1;if(t)for(let c=0;c<i.length;c++){let u=i[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:p}=t,x=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!p||p[u.route.id]===void 0);if(u.route.lazy||x){o=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}return i.reduceRight((c,u,d)=>{let p,x=!1,y=null,v=null;t&&(p=a&&u.route.id?a[u.route.id]:void 0,y=u.route.errorElement||Cse,o&&(l<0&&d===0?(x7("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,v=null):l===d&&(x=!0,v=u.route.hydrateFallbackElement||null)));let b=e.concat(i.slice(0,d+1)),S=()=>{let T;return p?T=y:x?T=v:u.route.Component?T=Se.createElement(u.route.Component,null):u.route.element?T=u.route.element:T=c,Se.createElement(Nse,{match:u,routeContext:{outlet:c,matches:b,isDataRoute:t!=null},children:T})};return t&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?Se.createElement(Ase,{location:t.location,revalidation:t.revalidation,component:y,error:p,children:S(),routeContext:{outlet:null,matches:b,isDataRoute:!0},unstable_onError:r}):S()},null)}function U3(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ise(n){let e=Se.useContext(Og);return fs(e,U3(n)),e}function Rse(n){let e=Se.useContext(aS);return fs(e,U3(n)),e}function Dse(n){let e=Se.useContext($h);return fs(e,U3(n)),e}function G3(n){let e=Dse(n),t=e.matches[e.matches.length-1];return fs(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function $se(){return G3("useRouteId")}function Lse(){let n=Se.useContext(V3),e=Rse("useRouteError"),t=G3("useRouteError");return n!==void 0?n:e.errors?.[t]}function Pse(){let{router:n}=Ise("useNavigate"),e=G3("useNavigate"),t=Se.useRef(!1);return m7(()=>{t.current=!0}),Se.useCallback(async(s,i={})=>{mu(t.current,p7),t.current&&(typeof s=="number"?n.navigate(s):await n.navigate(s,{fromRouteId:e,...i}))},[n,e])}var aM={};function x7(n,e,t){!e&&!aM[n]&&(aM[n]=!0,mu(!1,t))}Se.memo(Ose);function Ose({routes:n,future:e,state:t,unstable_onError:r}){return g7(n,void 0,t,r,e)}function $s(n){fs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Mse({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:i=!1}){fs(!z1(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=n.replace(/^\/*/,"/"),o=Se.useMemo(()=>({basename:a,navigator:s,static:i,future:{}}),[a,s,i]);typeof t=="string"&&(t=Pg(t));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:p="default"}=t,x=Se.useMemo(()=>{let y=wh(l,a);return y==null?null:{location:{pathname:y,search:c,hash:u,state:d,key:p},navigationType:r}},[a,l,c,u,d,p,r]);return mu(x!=null,`<Router basename="${a}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:Se.createElement(Iu.Provider,{value:o},Se.createElement(B1.Provider,{children:e,value:x}))}function Fse({children:n,location:e}){return Sse(jk(n),e)}function jk(n,e=[]){let t=[];return Se.Children.forEach(n,(r,s)=>{if(!Se.isValidElement(r))return;let i=[...e,s];if(r.type===Se.Fragment){t.push.apply(t,jk(r.props.children,i));return}fs(r.type===$s,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),fs(!r.props.index||!r.props.children,"An index route cannot have child routes.");let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=jk(r.props.children,i)),t.push(a)}),t}var vw="get",_w="application/x-www-form-urlencoded";function oS(n){return n!=null&&typeof n.tagName=="string"}function Bse(n){return oS(n)&&n.tagName.toLowerCase()==="button"}function zse(n){return oS(n)&&n.tagName.toLowerCase()==="form"}function jse(n){return oS(n)&&n.tagName.toLowerCase()==="input"}function Vse(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Use(n,e){return n.button===0&&(!e||e==="_self")&&!Vse(n)}var U_=null;function Gse(){if(U_===null)try{new FormData(document.createElement("form"),0),U_=!1}catch{U_=!0}return U_}var Hse=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _N(n){return n!=null&&!Hse.has(n)?(mu(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_w}"`),null):n}function Wse(n,e){let t,r,s,i,a;if(zse(n)){let o=n.getAttribute("action");r=o?wh(o,e):null,t=n.getAttribute("method")||vw,s=_N(n.getAttribute("enctype"))||_w,i=new FormData(n)}else if(Bse(n)||jse(n)&&(n.type==="submit"||n.type==="image")){let o=n.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||o.getAttribute("action");if(r=l?wh(l,e):null,t=n.getAttribute("formmethod")||o.getAttribute("method")||vw,s=_N(n.getAttribute("formenctype"))||_N(o.getAttribute("enctype"))||_w,i=new FormData(o,n),!Gse()){let{name:c,type:u,value:d}=n;if(u==="image"){let p=c?`${c}.`:"";i.append(`${p}x`,"0"),i.append(`${p}y`,"0")}else c&&i.append(c,d)}}else{if(oS(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=vw,r=null,s=_w,a=n}return i&&s==="text/plain"&&(a=i,i=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function H3(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function qse(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&wh(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function Kse(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Xse(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Yse(n,e,t){let r=await Promise.all(n.map(async s=>{let i=e.routes[s.route.id];if(i){let a=await Kse(i,t);return a.links?a.links():[]}return[]}));return eie(r.flat(1).filter(Xse).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function oM(n,e,t,r,s,i){let a=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,o=(l,c)=>t[c].pathname!==l.pathname||t[c].route.path?.endsWith("*")&&t[c].params["*"]!==l.params["*"];return i==="assets"?e.filter((l,c)=>a(l,c)||o(l,c)):i==="data"?e.filter((l,c)=>{let u=r.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(a(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function Zse(n,e,{includeHydrateFallback:t}={}){return Qse(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function Qse(n){return[...new Set(n)]}function Jse(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function eie(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let i=JSON.stringify(Jse(s));return t.has(i)||(t.add(i),r.push({key:i,link:s})),r},[])}function y7(){let n=Se.useContext(Og);return H3(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function tie(){let n=Se.useContext(aS);return H3(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var W3=Se.createContext(void 0);W3.displayName="FrameworkContext";function b7(){let n=Se.useContext(W3);return H3(n,"You must render this element inside a <HydratedRouter> element"),n}function nie(n,e){let t=Se.useContext(W3),[r,s]=Se.useState(!1),[i,a]=Se.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=e,p=Se.useRef(null);Se.useEffect(()=>{if(n==="render"&&a(!0),n==="viewport"){let v=S=>{S.forEach(T=>{a(T.isIntersecting)})},b=new IntersectionObserver(v,{threshold:.5});return p.current&&b.observe(p.current),()=>{b.disconnect()}}},[n]),Se.useEffect(()=>{if(r){let v=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(v)}}},[r]);let x=()=>{s(!0)},y=()=>{s(!1),a(!1)};return t?n!=="intent"?[i,p,{}]:[i,p,{onFocus:iy(o,x),onBlur:iy(l,y),onMouseEnter:iy(c,x),onMouseLeave:iy(u,y),onTouchStart:iy(d,x)}]:[!1,p,{}]}function iy(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function rie({page:n,...e}){let{router:t}=y7(),r=Se.useMemo(()=>o7(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?Se.createElement(iie,{page:n,matches:r,...e}):null}function sie(n){let{manifest:e,routeModules:t}=b7(),[r,s]=Se.useState([]);return Se.useEffect(()=>{let i=!1;return Yse(n,e,t).then(a=>{i||s(a)}),()=>{i=!0}},[n,e,t]),r}function iie({page:n,matches:e,...t}){let r=_c(),{manifest:s,routeModules:i}=b7(),{basename:a}=y7(),{loaderData:o,matches:l}=tie(),c=Se.useMemo(()=>oM(n,e,l,s,r,"data"),[n,e,l,s,r]),u=Se.useMemo(()=>oM(n,e,l,s,r,"assets"),[n,e,l,s,r]),d=Se.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let y=new Set,v=!1;if(e.forEach(S=>{let T=s.routes[S.route.id];!T||!T.hasLoader||(!c.some(C=>C.route.id===S.route.id)&&S.route.id in o&&i[S.route.id]?.shouldRevalidate||T.hasClientLoader?v=!0:y.add(S.route.id))}),y.size===0)return[];let b=qse(n,a,"data");return v&&y.size>0&&b.searchParams.set("_routes",e.filter(S=>y.has(S.route.id)).map(S=>S.route.id).join(",")),[b.pathname+b.search]},[a,o,r,s,c,e,n,i]),p=Se.useMemo(()=>Zse(u,s),[u,s]),x=sie(u);return Se.createElement(Se.Fragment,null,d.map(y=>Se.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),p.map(y=>Se.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),x.map(({key:y,link:v})=>Se.createElement("link",{key:y,nonce:t.nonce,...v})))}function aie(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var v7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{v7&&(window.__reactRouterVersion="7.9.3")}catch{}function oie({basename:n,children:e,window:t}){let r=Se.useRef();r.current==null&&(r.current=Xre({window:t,v5Compat:!0}));let s=r.current,[i,a]=Se.useState({action:s.action,location:s.location}),o=Se.useCallback(l=>{Se.startTransition(()=>a(l))},[a]);return Se.useLayoutEffect(()=>s.listen(o),[s,o]),Se.createElement(Mse,{basename:n,children:e,location:i.location,navigationType:i.action,navigator:s})}var _7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dt=Se.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:i,replace:a,state:o,target:l,to:c,preventScrollReset:u,viewTransition:d,...p},x){let{basename:y}=Se.useContext(Iu),v=typeof c=="string"&&_7.test(c),b,S=!1;if(typeof c=="string"&&v&&(b=c,v7))try{let G=new URL(window.location.href),V=c.startsWith("//")?new URL(G.protocol+c):new URL(c),O=wh(V.pathname,y);V.origin===G.origin&&O!=null?c=O+V.search+V.hash:S=!0}catch{mu(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=wse(c,{relative:s}),[C,I,$]=nie(r,p),q=hie(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:d});function U(G){e&&e(G),G.defaultPrevented||q(G)}let F=Se.createElement("a",{...p,...$,href:b||T,onClick:S||i?e:U,ref:aie(x,I),target:l,"data-discover":!v&&t==="render"?"true":void 0});return C&&!v?Se.createElement(Se.Fragment,null,F,Se.createElement(rie,{page:T})):F});Dt.displayName="Link";var lie=Se.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:i,to:a,viewTransition:o,children:l,...c},u){let d=V1(a,{relative:c.relative}),p=_c(),x=Se.useContext(aS),{navigator:y,basename:v}=Se.useContext(Iu),b=x!=null&&gie(d)&&o===!0,S=y.encodeLocation?y.encodeLocation(d).pathname:d.pathname,T=p.pathname,C=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;t||(T=T.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&v&&(C=wh(C,v)||C);const I=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let $=T===S||!s&&T.startsWith(S)&&T.charAt(I)==="/",q=C!=null&&(C===S||!s&&C.startsWith(S)&&C.charAt(S.length)==="/"),U={isActive:$,isPending:q,isTransitioning:b},F=$?e:void 0,G;typeof r=="function"?G=r(U):G=[r,$?"active":null,q?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let V=typeof i=="function"?i(U):i;return Se.createElement(Dt,{...c,"aria-current":F,className:G,ref:u,style:V,to:a,viewTransition:o},typeof l=="function"?l(U):l)});lie.displayName="NavLink";var cie=Se.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:i,method:a=vw,action:o,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...p},x)=>{let y=pie(),v=mie(o,{relative:c}),b=a.toLowerCase()==="get"?"get":"post",S=typeof o=="string"&&_7.test(o),T=C=>{if(l&&l(C),C.defaultPrevented)return;C.preventDefault();let I=C.nativeEvent.submitter,$=I?.getAttribute("formmethod")||a;y(I||C.currentTarget,{fetcherKey:e,method:$,navigate:t,replace:s,state:i,relative:c,preventScrollReset:u,viewTransition:d})};return Se.createElement("form",{ref:x,method:b,action:v,onSubmit:r?l:T,...p,"data-discover":!S&&n==="render"?"true":void 0})});cie.displayName="Form";function uie(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function w7(n){let e=Se.useContext(Og);return fs(e,uie(n)),e}function hie(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:i,viewTransition:a}={}){let o=j1(),l=_c(),c=V1(n,{relative:i});return Se.useCallback(u=>{if(Use(u,e)){u.preventDefault();let d=t!==void 0?t:Yy(l)===Yy(c);o(n,{replace:d,state:r,preventScrollReset:s,relative:i,viewTransition:a})}},[l,o,c,t,r,e,n,s,i,a])}var die=0,fie=()=>`__${String(++die)}__`;function pie(){let{router:n}=w7("useSubmit"),{basename:e}=Se.useContext(Iu),t=$se();return Se.useCallback(async(r,s={})=>{let{action:i,method:a,encType:o,formData:l,body:c}=Wse(r,e);if(s.navigate===!1){let u=s.fetcherKey||fie();await n.fetch(u,t,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||a,formEncType:s.encType||o,flushSync:s.flushSync})}else await n.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||a,formEncType:s.encType||o,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,e,t])}function mie(n,{relative:e}={}){let{basename:t}=Se.useContext(Iu),r=Se.useContext($h);fs(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...V1(n||".",{relative:e})},a=_c();if(n==null){i.search=a.search;let o=new URLSearchParams(i.search),l=o.getAll("index");if(l.some(u=>u==="")){o.delete("index"),l.filter(d=>d).forEach(d=>o.append("index",d));let u=o.toString();i.search=u?`?${u}`:""}}return(!n||n===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:gh([t,i.pathname])),Yy(i)}function gie(n,{relative:e}={}){let t=Se.useContext(f7);fs(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=w7("useViewTransitionState"),s=V1(n,{relative:e});if(!t.isTransitioning)return!1;let i=wh(t.currentLocation.pathname,r)||t.currentLocation.pathname,a=wh(t.nextLocation.pathname,r)||t.nextLocation.pathname;return z2(s.pathname,a)!=null||z2(s.pathname,i)!=null}function lM(){_c();const n=localStorage.getItem("userRole")!==null,e=()=>{const r=localStorage.getItem("userRole");return r==="farmer"?"/farmer":r==="buyer"?"/buyer":r==="admin"?"/admin":"/login"},t=()=>{localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),window.location.href="/login"};return _.jsx("nav",{className:"navbar-container navbar-farmer",children:_.jsxs("div",{className:"navbar-content",children:[_.jsx("div",{className:"navbar-logo-button",children:_.jsx("button",{children:_.jsxs("a",{href:"./farmer",children:[" ",_.jsx("div",{className:"navbar-logo"})]})})}),_.jsxs("div",{className:"navbar-right",children:[_.jsxs("div",{className:"navbar-nav",children:[_.jsxs(Dt,{to:e(),className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"🏠︎"}),"Home"]}),_.jsxs(Dt,{to:"/mrv-dashboard-farmer",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"📊"}),"MRV Dashboard"]}),_.jsxs(Dt,{to:"/marketplace",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"💰"}),"Market Place"]}),_.jsxs(Dt,{to:"/add-project",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"➕"}),"Add Project"]}),_.jsxs(Dt,{to:"/profile",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"👤"}),"Profile"]})]}),_.jsx("div",{className:"navbar-buttons",children:n?_.jsx("a",{href:"./login",children:_.jsx("button",{onClick:t,className:"btn-logout",children:"Logout"})}):_.jsxs(_.Fragment,{children:[_.jsx(Dt,{to:"/login",className:"btn-signin",children:"Sign In"}),_.jsx(Dt,{to:"/signup",className:"btn-signup",children:"Sign Up"})]})})]})]})})}function xie(){return _.jsxs("div",{className:"home-container",children:[_.jsxs("div",{className:"hero-section hero-buyer",children:[_.jsx("div",{className:"hero-background"}),_.jsxs("div",{className:"hero-content",children:[_.jsx("div",{className:"hero-badge",children:"🛒 Buyer Portal"}),_.jsx("h1",{className:"hero-title",children:"Invest in Nature. Own Verified Carbon Credits."}),_.jsx("p",{className:"hero-subtitle",children:"Support Blue Carbon projects in India and track your real climate impact with transparency."}),_.jsxs("div",{className:"hero-actions",children:[_.jsx(Dt,{to:"/marketplace",className:"btn-hero-primary",children:"Browse Credits"}),_.jsx(Dt,{to:"/mrv-dashboard-buyer",className:"btn-hero-secondary",children:"View Portfolio"})]})]})]}),_.jsxs("div",{className:"dashboard-grid",children:[_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"🛒"}),_.jsx("h3",{children:"Browse Marketplace"}),_.jsx("p",{children:"Explore available carbon credits from verified projects"}),_.jsx(Dt,{to:"/marketplace",className:"card-button",children:"Browse Credits"})]}),_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"📊"}),_.jsx("h3",{children:"MRV Dashboard"}),_.jsx("p",{children:"Monitor carbon credit marketplace and your portfolio"}),_.jsx(Dt,{to:"/mrv-dashboard-buyer",className:"card-button",children:"View Dashboard"})]}),_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"🔍"}),_.jsx("h3",{children:"Project Verification"}),_.jsx("p",{children:"Research project details and verification status"}),_.jsx(Dt,{to:"/verification",className:"card-button",children:"Verify Projects"})]}),_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"📊"}),_.jsx("h3",{children:"Impact Reports"}),_.jsx("p",{children:"Track your carbon offset contributions"}),_.jsx(Dt,{to:"/impact-reports",className:"card-button",children:"View Impact"})]})]}),_.jsxs("div",{className:"featured-projects",children:[_.jsx("h2",{children:"Featured Projects"}),_.jsxs("div",{className:"project-grid",children:[_.jsxs("div",{className:"project-card",children:[_.jsx("div",{className:"project-image",children:"🌊"}),_.jsx("h4",{children:"Coastal Mangrove Restoration"}),_.jsx("p",{children:"1,250 credits available"}),_.jsx("span",{className:"project-price",children:"$25/credit"})]}),_.jsxs("div",{className:"project-card",children:[_.jsx("div",{className:"project-image",children:"🐟"}),_.jsx("h4",{children:"Seagrass Conservation"}),_.jsx("p",{children:"800 credits available"}),_.jsx("span",{className:"project-price",children:"$30/credit"})]}),_.jsxs("div",{className:"project-card",children:[_.jsx("div",{className:"project-image",children:"🦪"}),_.jsx("h4",{children:"Oyster Reef Restoration"}),_.jsx("p",{children:"600 credits available"}),_.jsx("span",{className:"project-price",children:"$35/credit"})]})]})]})]})}function yie(){_c();const n=localStorage.getItem("userRole")!==null,e=()=>{const r=localStorage.getItem("userRole");return r==="farmer"?"/farmer":r==="buyer"?"/buyer":r==="admin"?"/admin":"/login"},t=()=>{localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),window.location.href="/login"};return _.jsx("nav",{className:"navbar-container navbar-buyer",children:_.jsxs("div",{className:"navbar-content",children:[_.jsx("div",{className:"navbar-logo-button",children:_.jsx("button",{children:_.jsxs("a",{href:"./Buyer",children:[" ",_.jsx("div",{className:"navbar-logo"})]})})}),_.jsxs("div",{className:"navbar-right",children:[_.jsxs("div",{className:"navbar-nav",children:[_.jsxs(Dt,{to:e(),className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"🏠︎"}),"Home"]}),_.jsxs(Dt,{to:"/mrv-dashboard-buyer",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"📊"}),"MRV Dashboard"]}),_.jsxs(Dt,{to:"/marketplace",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"💰"}),"Market Place"]}),_.jsxs(Dt,{to:"/my-purchases",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"📋"}),"My Purchases"]}),_.jsxs(Dt,{to:"/profile",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"👤"}),"Profile"]})]}),_.jsx("div",{className:"navbar-buttons",children:n?_.jsx("a",{href:"./login",children:_.jsx("button",{onClick:t,className:"btn-logout",children:"Logout"})}):_.jsxs(_.Fragment,{children:[_.jsx(Dt,{to:"/login",className:"btn-signin",children:"Sign In"}),_.jsx(Dt,{to:"/signup",className:"btn-signup",children:"Sign Up"})]})})]})]})})}function bie(){_c();const n=localStorage.getItem("userRole")!==null,e=()=>{const r=localStorage.getItem("userRole");return r==="farmer"?"/farmer":r==="buyer"?"/buyer":r==="admin"?"/admin":"/login"},t=()=>{localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),window.location.href="/login"};return _.jsx("nav",{className:"navbar-container navbar-admin",children:_.jsxs("div",{className:"navbar-content",children:[_.jsx("div",{className:"navbar-logo-button",children:_.jsx("button",{children:_.jsxs("a",{href:"./admin",children:[" ",_.jsx("div",{className:"navbar-logo"})]})})}),_.jsxs("div",{className:"navbar-right",children:[_.jsxs("div",{className:"navbar-nav",children:[_.jsxs(Dt,{to:e(),className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"🏠︎"}),"Home"]}),_.jsxs(Dt,{to:"/project-verification",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"✅"}),"Project Verification"]}),_.jsxs(Dt,{to:"/user-management",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"👥"}),"User Management"]}),_.jsxs(Dt,{to:"/transactions",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"💳"}),"Transactions"]}),_.jsxs(Dt,{to:"/reports",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"📋"}),"Reports"]}),_.jsxs(Dt,{to:"/profile",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"👤"}),"Profile"]})]}),_.jsx("div",{className:"navbar-buttons",children:n?_.jsx("a",{href:"./login",children:_.jsx("button",{onClick:t,className:"btn-logout",children:"Logout"})}):_.jsxs(_.Fragment,{children:[_.jsx(Dt,{to:"/login",className:"btn-signin",children:"Sign In"}),_.jsx(Dt,{to:"/signup",className:"btn-signup",children:"Sign Up"})]})})]})]})})}function vie(){const[n,e]=Se.useState(null);switch(Se.useEffect(()=>{const t=localStorage.getItem("userRole");e(t);const r=()=>{const s=localStorage.getItem("userRole");e(s)};return window.addEventListener("storage",r),window.addEventListener("userRoleChanged",r),()=>{window.removeEventListener("storage",r),window.removeEventListener("userRoleChanged",r)}},[]),n){case"farmer":return _.jsx(lM,{});case"buyer":return _.jsx(yie,{});case"admin":return _.jsx(bie,{});default:return _.jsx(lM,{})}}function lS(){return _.jsx("nav",{className:"navbar-container navbar-default",children:_.jsxs("div",{className:"navbar-content",children:[_.jsx("div",{className:"navbar-logo-button",children:_.jsx("button",{children:_.jsxs("a",{href:"./",children:[" ",_.jsx("div",{className:"navbar-logo"})]})})}),_.jsxs("div",{className:"navbar-right",children:[_.jsxs("div",{className:"navbar-nav",children:[_.jsxs(Dt,{to:"/",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"🏠"}),"Home"]}),_.jsxs(Dt,{to:"/dashboard",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"📊"}),"Dashboard"]}),_.jsxs(Dt,{to:"/about",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"ℹ️"}),"About Us"]}),_.jsxs(Dt,{to:"/contact",className:"nav-link",children:[_.jsx("span",{className:"nav-icon",children:"📞"}),"Contact Us"]})]}),_.jsxs("div",{className:"navbar-buttons",children:[_.jsx(Dt,{to:"/login",className:"btn-signin",children:"Sign In"}),_.jsx(Dt,{to:"/signup",className:"btn-signup",children:"Sign Up"})]})]})]})})}function _ie(){return _.jsxs("div",{className:"default-landing",children:[_.jsx(lS,{}),_.jsx("section",{className:"default-hero",children:_.jsxs("div",{className:"default-hero-content",children:[_.jsxs("div",{className:"default-hero-text",children:[_.jsx("h1",{className:"default-hero-title",children:"Welcome to CarbonLens"}),_.jsx("p",{className:"default-hero-subtitle",children:"Revolutionizing carbon credit trading through blockchain technology and sustainable agriculture"}),_.jsxs("div",{className:"default-hero-actions",children:[_.jsx("a",{href:"/login",className:"default-btn-primary",children:"Get Started"}),_.jsx("a",{href:"/about",className:"default-btn-secondary",children:"Learn More"})]})]}),_.jsx("div",{className:"right-side",children:_.jsxs("div",{className:"floating-emojis",children:[_.jsx("span",{className:"emoji e1",children:"🌱"}),_.jsx("span",{className:"emoji e2",children:"🌍"}),_.jsx("span",{className:"emoji e3",children:"☁️"}),_.jsx("span",{className:"emoji e4",children:"🌳"}),_.jsx("span",{className:"emoji e5",children:"🍃"})]})})]})}),_.jsx("section",{className:"default-features",children:_.jsxs("div",{className:"default-container",children:[_.jsx("h2",{className:"default-section-title",children:"Why Choose CarbonLens?"}),_.jsxs("div",{className:"default-features-grid",children:[_.jsxs("div",{className:"default-feature-card",children:[_.jsx("div",{className:"default-feature-icon",children:"🌾"}),_.jsx("h3",{children:"For Farmers"}),_.jsx("p",{children:"Monetize your sustainable farming practices and earn carbon credits"})]}),_.jsxs("div",{className:"default-feature-card",children:[_.jsx("div",{className:"default-feature-icon",children:"💼"}),_.jsx("h3",{children:"For Buyers"}),_.jsx("p",{children:"Invest in verified carbon credits and support environmental sustainability"})]}),_.jsxs("div",{className:"default-feature-card",children:[_.jsx("div",{className:"default-feature-icon",children:"🔒"}),_.jsx("h3",{children:"Secure & Transparent"}),_.jsx("p",{children:"Blockchain-powered verification ensures trust and transparency"})]})]})]})}),_.jsx("section",{className:"default-cta",children:_.jsxs("div",{className:"default-container",children:[_.jsx("h2",{children:"Ready to Make a Difference?"}),_.jsx("p",{children:"Join thousands of farmers and buyers creating a sustainable future"}),_.jsxs("div",{className:"default-cta-buttons",children:[_.jsx("a",{href:"/signup",className:"default-btn-primary",children:"Sign Up Now"}),_.jsx("a",{href:"/contact",className:"default-btn-secondary",children:"Contact Us"})]})]})}),_.jsx("footer",{className:"default-footer",children:_.jsxs("div",{className:"default-container",children:[_.jsxs("div",{className:"default-footer-content",children:[_.jsxs("div",{className:"default-footer-section",children:[_.jsx("h4",{children:"BlueCarbon"}),_.jsx("p",{children:"Sustainable carbon credit trading platform"})]}),_.jsxs("div",{className:"default-footer-section",children:[_.jsx("h4",{children:"Quick Links"}),_.jsxs("ul",{children:[_.jsx("li",{children:_.jsx("a",{href:"/about",children:"About Us"})}),_.jsx("li",{children:_.jsx("a",{href:"/contact",children:"Contact"})}),_.jsx("li",{children:_.jsx("a",{href:"/dashboard",children:"Dashboard"})})]})]}),_.jsxs("div",{className:"default-footer-section",children:[_.jsx("h4",{children:"Get Started"}),_.jsxs("ul",{children:[_.jsx("li",{children:_.jsx("a",{href:"/login",children:"Sign In"})}),_.jsx("li",{children:_.jsx("a",{href:"/signup",children:"Sign Up"})})]})]})]}),_.jsx("div",{className:"default-footer-bottom",children:_.jsx("p",{children:"© 2025 CarbonLens- team Cryptocoral. All rights reserved."})})]})})]})}function wie(){return _.jsxs("div",{className:"default-dashboard",children:[_.jsx(lS,{}),_.jsx("section",{className:"dashboard-header",children:_.jsxs("div",{className:"dashboard-container",children:[_.jsx("h1",{className:"dashboard-title",children:"BlueCarbon Platform Overview"}),_.jsx("p",{className:"dashboard-subtitle",children:"Explore carbon credit trading opportunities and environmental impact data"})]})}),_.jsx("section",{className:"dashboard-stats",children:_.jsx("div",{className:"dashboard-container",children:_.jsxs("div",{className:"stats-grid",children:[_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"🌱"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("h3",{className:"stat-number",children:"5"}),_.jsx("p",{className:"stat-label",children:"Active Projects"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"💰"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("h3",{className:"stat-number",children:"Rs 120000"}),_.jsx("p",{className:"stat-label",children:"Credits Traded"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"🌍"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("h3",{className:"stat-number",children:"85 T"}),_.jsx("p",{className:"stat-label",children:"CO2 Tons Offset"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"👥"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("h3",{className:"stat-number",children:"20"}),_.jsx("p",{className:"stat-label",children:"Registered Users"})]})]})]})})}),_.jsx("section",{className:"market-overview",children:_.jsxs("div",{className:"dashboard-container",children:[_.jsx("h2",{className:"section-title",children:"Market Overview"}),_.jsxs("div",{className:"market-grid",children:[_.jsxs("div",{className:"market-card",children:[_.jsx("h3",{children:"Recent Projects"}),_.jsxs("div",{className:"project-list",children:[_.jsxs("div",{className:"project-item",children:[_.jsx("span",{className:"project-name",children:"Sustainable Rice Farming"}),_.jsx("span",{className:"project-credits",children:"5 Credits"})]}),_.jsxs("div",{className:"project-item",children:[_.jsx("span",{className:"project-name",children:"Forest Conservation"}),_.jsx("span",{className:"project-credits",children:"18 Credits"})]}),_.jsxs("div",{className:"project-item",children:[_.jsx("span",{className:"project-name",children:"Solar Energy Initiative"}),_.jsx("span",{className:"project-credits",children:"6 Credits"})]})]})]}),_.jsxs("div",{className:"market-card",children:[_.jsx("h3",{children:"Price Trends"}),_.jsxs("div",{className:"price-info",children:[_.jsxs("div",{className:"price-item",children:[_.jsx("span",{className:"price-label",children:"Current Price"}),_.jsx("span",{className:"price-value",children:" ₹15.50/Credit"})]}),_.jsxs("div",{className:"price-item",children:[_.jsx("span",{className:"price-label",children:"24h Change"}),_.jsx("span",{className:"price-value positive",children:"0%"})]}),_.jsxs("div",{className:"price-item",children:[_.jsx("span",{className:"price-label",children:"Volume"}),_.jsx("span",{className:"price-value",children:"1,250 Credits"})]})]})]})]})]})}),_.jsx("section",{className:"dashboard-cta",children:_.jsx("div",{className:"dashboard-container",children:_.jsxs("div",{className:"cta-content",children:[_.jsx("h2",{children:"Ready to Get Started?"}),_.jsx("p",{children:"Join our platform to start trading carbon credits or list your sustainable projects"}),_.jsxs("div",{className:"cta-buttons",children:[_.jsx("a",{href:"/signup",className:"cta-btn primary",children:"Sign Up Now"}),_.jsx("a",{href:"/login",className:"cta-btn secondary",children:"Sign In"})]})]})})})]})}const Eie=()=>{};var cM={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E7=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Sie=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],o=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},S7={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,o=a?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=i>>2,d=(i&3)<<4|o>>4;let p=(o&15)<<2|c>>6,x=c&63;l||(x=64,a||(p=64)),r.push(t[u],t[d],t[p],t[x])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(E7(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Sie(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],o=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||o==null||c==null||d==null)throw new Tie;const p=i<<2|o>>4;if(r.push(p),c!==64){const x=o<<4&240|c>>2;if(r.push(x),d!==64){const y=c<<6&192|d;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Tie extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Cie=function(n){const e=E7(n);return S7.encodeByteArray(e,!0)},j2=function(n){return Cie(n).replace(/\./g,"")},T7=function(n){try{return S7.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aie(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nie=()=>Aie().__FIREBASE_DEFAULTS__,kie=()=>{if(typeof process>"u"||typeof cM>"u")return;const n=cM.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Iie=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&T7(n[1]);return e&&JSON.parse(e)},cS=()=>{try{return Eie()||Nie()||kie()||Iie()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},C7=n=>cS()?.emulatorHosts?.[n],A7=n=>{const e=C7(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},N7=()=>cS()?.config,k7=n=>cS()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rie{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function q3(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I7(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[j2(JSON.stringify(t)),j2(JSON.stringify(a)),""].join(".")}const Py={};function Die(){const n={prod:[],emulator:[]};for(const e of Object.keys(Py))Py[e]?n.emulator.push(e):n.prod.push(e);return n}function $ie(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let uM=!1;function K3(n,e){if(typeof window>"u"||typeof document>"u"||!Sf(window.location.host)||Py[n]===e||Py[n]||uM)return;Py[n]=e;function t(p){return`__firebase__banner__${p}`}const r="__firebase__banner",i=Die().prod.length>0;function a(){const p=document.getElementById(r);p&&p.remove()}function o(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,x){p.setAttribute("width","24"),p.setAttribute("id",x),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{uM=!0,a()},p}function u(p,x){p.setAttribute("id",x),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=$ie(r),x=t("text"),y=document.getElementById(x)||document.createElement("span"),v=t("learnmore"),b=document.getElementById(v)||document.createElement("a"),S=t("preprendIcon"),T=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const C=p.element;o(C),u(b,v);const I=c();l(T,S),C.append(T,y,b,I),document.body.appendChild(C)}i?(y.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Lie(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ia())}function Pie(){const n=cS()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Oie(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Mie(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Fie(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Bie(){const n=Ia();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function zie(){return!Pie()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jie(){try{return typeof indexedDB=="object"}catch{return!1}}function Vie(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uie="FirebaseError";class Ru extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Uie,Object.setPrototypeOf(this,Ru.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,U1.prototype.create)}}class U1{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?Gie(i,r):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new Ru(s,o,r)}}function Gie(n,e){return n.replace(Hie,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Hie=/\{\$([^}]+)}/g;function Wie(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Hp(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(hM(i)&&hM(a)){if(!Hp(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function hM(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G1(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function yy(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function by(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function qie(n,e){const t=new Kie(n,e);return t.subscribe.bind(t)}class Kie{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Xie(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=wN),s.error===void 0&&(s.error=wN),s.complete===void 0&&(s.complete=wN);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Xie(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function wN(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function js(n){return n&&n._delegate?n._delegate:n}class nf{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yie=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Rie;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Qie(e))try{this.getOrInitializeService({instanceIdentifier:vp})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=vp){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=vp){return this.instances.has(e)}getOptions(e=vp){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);r===o&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Zie(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=vp){return this.component?this.component.multipleInstances?e:vp:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Zie(n){return n===vp?void 0:n}function Qie(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jie{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Yie(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Un;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Un||(Un={}));const eae={debug:Un.DEBUG,verbose:Un.VERBOSE,info:Un.INFO,warn:Un.WARN,error:Un.ERROR,silent:Un.SILENT},tae=Un.INFO,nae={[Un.DEBUG]:"log",[Un.VERBOSE]:"log",[Un.INFO]:"info",[Un.WARN]:"warn",[Un.ERROR]:"error"},rae=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=nae[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let X3=class{constructor(e){this.name=e,this._logLevel=tae,this._logHandler=rae,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Un))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?eae[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Un.DEBUG,...e),this._logHandler(this,Un.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Un.VERBOSE,...e),this._logHandler(this,Un.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Un.INFO,...e),this._logHandler(this,Un.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Un.WARN,...e),this._logHandler(this,Un.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Un.ERROR,...e),this._logHandler(this,Un.ERROR,...e)}};const sae=(n,e)=>e.some(t=>n instanceof t);let dM,fM;function iae(){return dM||(dM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aae(){return fM||(fM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const R7=new WeakMap,Vk=new WeakMap,D7=new WeakMap,EN=new WeakMap,Y3=new WeakMap;function oae(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(qd(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&R7.set(t,n)}).catch(()=>{}),Y3.set(e,n),e}function lae(n){if(Vk.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});Vk.set(n,e)}let Uk={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Vk.get(n);if(e==="objectStoreNames")return n.objectStoreNames||D7.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return qd(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function cae(n){Uk=n(Uk)}function uae(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(SN(this),e,...t);return D7.set(r,e.sort?e.sort():[e]),qd(r)}:aae().includes(n)?function(...e){return n.apply(SN(this),e),qd(R7.get(this))}:function(...e){return qd(n.apply(SN(this),e))}}function hae(n){return typeof n=="function"?uae(n):(n instanceof IDBTransaction&&lae(n),sae(n,iae())?new Proxy(n,Uk):n)}function qd(n){if(n instanceof IDBRequest)return oae(n);if(EN.has(n))return EN.get(n);const e=hae(n);return e!==n&&(EN.set(n,e),Y3.set(e,n)),e}const SN=n=>Y3.get(n);function dae(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),o=qd(a);return r&&a.addEventListener("upgradeneeded",l=>{r(qd(a.result),l.oldVersion,l.newVersion,qd(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const fae=["get","getKey","getAll","getAllKeys","count"],pae=["put","add","delete","clear"],TN=new Map;function pM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(TN.get(e))return TN.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=pae.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||fae.includes(t)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),s&&l.done]))[0]};return TN.set(e,i),i}cae(n=>({...n,get:(e,t,r)=>pM(e,t)||n.get(e,t,r),has:(e,t)=>!!pM(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mae{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(gae(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function gae(n){return n.getComponent()?.type==="VERSION"}const Gk="@firebase/app",mM="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh=new X3("@firebase/app"),xae="@firebase/app-compat",yae="@firebase/analytics-compat",bae="@firebase/analytics",vae="@firebase/app-check-compat",_ae="@firebase/app-check",wae="@firebase/auth",Eae="@firebase/auth-compat",Sae="@firebase/database",Tae="@firebase/data-connect",Cae="@firebase/database-compat",Aae="@firebase/functions",Nae="@firebase/functions-compat",kae="@firebase/installations",Iae="@firebase/installations-compat",Rae="@firebase/messaging",Dae="@firebase/messaging-compat",$ae="@firebase/performance",Lae="@firebase/performance-compat",Pae="@firebase/remote-config",Oae="@firebase/remote-config-compat",Mae="@firebase/storage",Fae="@firebase/storage-compat",Bae="@firebase/firestore",zae="@firebase/ai",jae="@firebase/firestore-compat",Vae="firebase",Uae="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hk="[DEFAULT]",Gae={[Gk]:"fire-core",[xae]:"fire-core-compat",[bae]:"fire-analytics",[yae]:"fire-analytics-compat",[_ae]:"fire-app-check",[vae]:"fire-app-check-compat",[wae]:"fire-auth",[Eae]:"fire-auth-compat",[Sae]:"fire-rtdb",[Tae]:"fire-data-connect",[Cae]:"fire-rtdb-compat",[Aae]:"fire-fn",[Nae]:"fire-fn-compat",[kae]:"fire-iid",[Iae]:"fire-iid-compat",[Rae]:"fire-fcm",[Dae]:"fire-fcm-compat",[$ae]:"fire-perf",[Lae]:"fire-perf-compat",[Pae]:"fire-rc",[Oae]:"fire-rc-compat",[Mae]:"fire-gcs",[Fae]:"fire-gcs-compat",[Bae]:"fire-fst",[jae]:"fire-fst-compat",[zae]:"fire-vertex","fire-js":"fire-js",[Vae]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2=new Map,Hae=new Map,Wk=new Map;function gM(n,e){try{n.container.addComponent(e)}catch(t){Eh.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Wp(n){const e=n.name;if(Wk.has(e))return Eh.debug(`There were multiple attempts to register component ${e}.`),!1;Wk.set(e,n);for(const t of V2.values())gM(t,n);for(const t of Hae.values())gM(t,n);return!0}function uS(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ko(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wae={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kd=new U1("app","Firebase",Wae);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qae{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new nf("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Kd.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm=Uae;function $7(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Hk,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Kd.create("bad-app-name",{appName:String(s)});if(t||(t=N7()),!t)throw Kd.create("no-options");const i=V2.get(s);if(i){if(Hp(t,i.options)&&Hp(r,i.config))return i;throw Kd.create("duplicate-app",{appName:s})}const a=new Jie(s);for(const l of Wk.values())a.addComponent(l);const o=new qae(t,r,a);return V2.set(s,o),o}function Z3(n=Hk){const e=V2.get(n);if(!e&&n===Hk&&N7())return $7();if(!e)throw Kd.create("no-app",{appName:n});return e}function nu(n,e,t){let r=Gae[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Eh.warn(a.join(" "));return}Wp(new nf(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kae="firebase-heartbeat-database",Xae=1,Zy="firebase-heartbeat-store";let CN=null;function L7(){return CN||(CN=dae(Kae,Xae,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Zy)}catch(t){console.warn(t)}}}}).catch(n=>{throw Kd.create("idb-open",{originalErrorMessage:n.message})})),CN}async function Yae(n){try{const t=(await L7()).transaction(Zy),r=await t.objectStore(Zy).get(P7(n));return await t.done,r}catch(e){if(e instanceof Ru)Eh.warn(e.message);else{const t=Kd.create("idb-get",{originalErrorMessage:e?.message});Eh.warn(t.message)}}}async function xM(n,e){try{const r=(await L7()).transaction(Zy,"readwrite");await r.objectStore(Zy).put(e,P7(n)),await r.done}catch(t){if(t instanceof Ru)Eh.warn(t.message);else{const r=Kd.create("idb-set",{originalErrorMessage:t?.message});Eh.warn(r.message)}}}function P7(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zae=1024,Qae=30;class Jae{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new toe(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=yM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Qae){const s=noe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Eh.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=yM(),{heartbeatsToSend:t,unsentEntries:r}=eoe(this._heartbeatsCache.heartbeats),s=j2(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Eh.warn(e),""}}}function yM(){return new Date().toISOString().substring(0,10)}function eoe(n,e=Zae){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),bM(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),bM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class toe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jie()?Vie().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Yae(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return xM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return xM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function bM(n){return j2(JSON.stringify({version:2,heartbeats:n})).length}function noe(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function roe(n){Wp(new nf("platform-logger",e=>new mae(e),"PRIVATE")),Wp(new nf("heartbeat",e=>new Jae(e),"PRIVATE")),nu(Gk,mM,n),nu(Gk,mM,"esm2020"),nu("fire-js","")}roe("");var soe="firebase",ioe="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nu(soe,ioe,"app");function O7(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const aoe=O7,M7=new U1("auth","Firebase",O7());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2=new X3("@firebase/auth");function ooe(n,...e){U2.logLevel<=Un.WARN&&U2.warn(`Auth (${Sm}): ${n}`,...e)}function ww(n,...e){U2.logLevel<=Un.ERROR&&U2.error(`Auth (${Sm}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(n,...e){throw Q3(n,...e)}function ru(n,...e){return Q3(n,...e)}function F7(n,e,t){const r={...aoe(),[e]:t};return new U1("auth","Firebase",r).create(e,{appName:n.name})}function xh(n){return F7(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Q3(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return M7.create(n,...e)}function qt(n,e,...t){if(!n)throw Q3(e,...t)}function dh(n){const e="INTERNAL ASSERTION FAILED: "+n;throw ww(e),new Error(e)}function Sh(n,e){n||dh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(){return typeof self<"u"&&self.location?.href||""}function loe(){return vM()==="http:"||vM()==="https:"}function vM(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function coe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(loe()||Mie()||"connection"in navigator)?navigator.onLine:!0}function uoe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(e,t){this.shortDelay=e,this.longDelay=t,Sh(t>e,"Short delay should be less than long delay!"),this.isMobile=Lie()||Fie()}get(){return coe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J3(n,e){Sh(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;dh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;dh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;dh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hoe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const doe=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],foe=new H1(3e4,6e4);function Tf(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Cf(n,e,t,r,s={}){return z7(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const o=G1({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...i};return Oie()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Sf(n.emulatorConfig.host)&&(c.credentials="include"),B7.fetch()(await j7(n,n.config.apiHost,t,o),c)})}async function z7(n,e,t){n._canInitEmulator=!1;const r={...hoe,...e};try{const s=new moe(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw G_(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw G_(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw G_(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw G_(n,"user-disabled",a);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw F7(n,u,c);mc(n,u)}}catch(s){if(s instanceof Ru)throw s;mc(n,"network-request-failed",{message:String(s)})}}async function W1(n,e,t,r,s={}){const i=await Cf(n,e,t,r,s);return"mfaPendingCredential"in i&&mc(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function j7(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?J3(n.config,s):`${n.config.apiScheme}://${s}`;return doe.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function poe(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class moe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ru(this.auth,"network-request-failed")),foe.get())})}}function G_(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=ru(n,e,r);return s.customData._tokenResponse=t,s}function _M(n){return n!==void 0&&n.enterprise!==void 0}class goe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return poe(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function xoe(n,e){return Cf(n,"GET","/v2/recaptchaConfig",Tf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yoe(n,e){return Cf(n,"POST","/v1/accounts:delete",e)}async function G2(n,e){return Cf(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function boe(n,e=!1){const t=js(n),r=await t.getIdToken(e),s=e4(r);qt(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:Oy(AN(s.auth_time)),issuedAtTime:Oy(AN(s.iat)),expirationTime:Oy(AN(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function AN(n){return Number(n)*1e3}function e4(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ww("JWT malformed, contained fewer than 3 sections"),null;try{const s=T7(t);return s?JSON.parse(s):(ww("Failed to decode base64 JWT payload"),null)}catch(s){return ww("Caught error parsing JWT payload as JSON",s?.toString()),null}}function wM(n){const e=e4(n);return qt(e,"internal-error"),qt(typeof e.exp<"u","internal-error"),qt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qy(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ru&&voe(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function voe({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _oe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oy(this.lastLoginAt),this.creationTime=Oy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(n){const e=n.auth,t=await n.getIdToken(),r=await Qy(n,G2(e,{idToken:t}));qt(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?V7(s.providerUserInfo):[],a=Eoe(n.providerData,i),o=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,c=o?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Kk(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(n,u)}async function woe(n){const e=js(n);await H2(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Eoe(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function V7(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Soe(n,e){const t=await z7(n,{},async()=>{const r=G1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await j7(n,s,"/v1/token",`key=${i}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&Sf(n.emulatorConfig.host)&&(l.credentials="include"),B7.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Toe(n,e){return Cf(n,"POST","/v2/accounts:revokeToken",Tf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qt(e.idToken,"internal-error"),qt(typeof e.idToken<"u","internal-error"),qt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):wM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){qt(e.length!==0,"internal-error");const t=wM(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(qt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await Soe(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new q0;return r&&(qt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(qt(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(qt(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new q0,this.toJSON())}_performRefresh(){return dh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(n,e){qt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class oc{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new _oe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Kk(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Qy(this,this.stsTokenManager.getToken(this.auth,e));return qt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return boe(this,e)}reload(){return woe(this)}_assign(e){this!==e&&(qt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new oc({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){qt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await H2(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ko(this.auth.app))return Promise.reject(xh(this.auth));const e=await this.getIdToken();return await Qy(this,yoe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:d,emailVerified:p,isAnonymous:x,providerData:y,stsTokenManager:v}=t;qt(d&&v,e,"internal-error");const b=q0.fromJSON(this.name,v);qt(typeof d=="string",e,"internal-error"),Ad(r,e.name),Ad(s,e.name),qt(typeof p=="boolean",e,"internal-error"),qt(typeof x=="boolean",e,"internal-error"),Ad(i,e.name),Ad(a,e.name),Ad(o,e.name),Ad(l,e.name),Ad(c,e.name),Ad(u,e.name);const S=new oc({uid:d,auth:e,email:s,emailVerified:p,displayName:r,isAnonymous:x,photoURL:a,phoneNumber:i,tenantId:o,stsTokenManager:b,createdAt:c,lastLoginAt:u});return y&&Array.isArray(y)&&(S.providerData=y.map(T=>({...T}))),l&&(S._redirectEventId=l),S}static async _fromIdTokenResponse(e,t,r=!1){const s=new q0;s.updateFromServerResponse(t);const i=new oc({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await H2(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];qt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?V7(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,o=new q0;o.updateFromIdToken(r);const l=new oc({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Kk(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM=new Map;function fh(n){Sh(n instanceof Function,"Expected a class definition");let e=EM.get(n);return e?(Sh(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,EM.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U7{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}U7.type="NONE";const SM=U7;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(n,e,t){return`firebase:${n}:${e}:${t}`}class K0{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ew(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ew("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await G2(this.auth,{idToken:e}).catch(()=>{});return t?oc._fromGetAccountInfoResponse(this.auth,t,e):null}return oc._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new K0(fh(SM),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||fh(SM);const a=Ew(r,e.config.apiKey,e.name);let o=null;for(const c of t)try{const u=await c._get(a);if(u){let d;if(typeof u=="string"){const p=await G2(e,{idToken:u}).catch(()=>{});if(!p)break;d=await oc._fromGetAccountInfoResponse(e,p,u)}else d=oc._fromJSON(e,u);c!==i&&(o=d),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new K0(i,e,r):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new K0(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TM(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(q7(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(G7(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(X7(e))return"Blackberry";if(Y7(e))return"Webos";if(H7(e))return"Safari";if((e.includes("chrome/")||W7(e))&&!e.includes("edge/"))return"Chrome";if(K7(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function G7(n=Ia()){return/firefox\//i.test(n)}function H7(n=Ia()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function W7(n=Ia()){return/crios\//i.test(n)}function q7(n=Ia()){return/iemobile/i.test(n)}function K7(n=Ia()){return/android/i.test(n)}function X7(n=Ia()){return/blackberry/i.test(n)}function Y7(n=Ia()){return/webos/i.test(n)}function t4(n=Ia()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Coe(n=Ia()){return t4(n)&&!!window.navigator?.standalone}function Aoe(){return Bie()&&document.documentMode===10}function Z7(n=Ia()){return t4(n)||K7(n)||Y7(n)||X7(n)||/windows phone/i.test(n)||q7(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q7(n,e=[]){let t;switch(n){case"Browser":t=TM(Ia());break;case"Worker":t=`${TM(Ia())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Sm}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Noe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function koe(n,e={}){return Cf(n,"GET","/v2/passwordPolicy",Tf(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ioe=6;class Roe{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Ioe,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Doe{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new CM(this),this.idTokenSubscription=new CM(this),this.beforeStateQueue=new Noe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=M7,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=fh(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await K0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await G2(this,{idToken:e}),r=await oc._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ko(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!i||i===a)&&o?.user&&(r=o.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return qt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await H2(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=uoe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ko(this.app))return Promise.reject(xh(this));const t=e?js(e):null;return t&&qt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&qt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ko(this.app)?Promise.reject(xh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ko(this.app)?Promise.reject(xh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await koe(this),t=new Roe(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new U1("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Toe(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&fh(e)||this._popupRedirectResolver;qt(t,this,"argument-error"),this.redirectPersistenceManager=await K0.create(this,[fh(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(qt(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Q7(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ko(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ooe(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Tm(n){return js(n)}class CM{constructor(e){this.auth=e,this.observer=null,this.addObserver=qie(t=>this.observer=t)}get next(){return qt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hS={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $oe(n){hS=n}function J7(n){return hS.loadJS(n)}function Loe(){return hS.recaptchaEnterpriseScript}function Poe(){return hS.gapiScript}function Ooe(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Moe{constructor(){this.enterprise=new Foe}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Foe{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Boe="recaptcha-enterprise",ez="NO_RECAPTCHA";class zoe{constructor(e){this.type=Boe,this.auth=Tm(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{xoe(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new goe(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function s(i,a,o){const l=window.grecaptcha;_M(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{a(c)}).catch(()=>{a(ez)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Moe().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{r(this.auth).then(o=>{if(!t&&_M(window.grecaptcha))s(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=Loe();l.length!==0&&(l+=o),J7(l).then(()=>{s(o,i,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function AM(n,e,t,r=!1,s=!1){const i=new zoe(n);let a;if(s)a=ez;else try{a=await i.verify(t)}catch{a=await i.verify(t,!0)}const o={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,c=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Xk(n,e,t,r,s){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await AM(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await AM(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function joe(n,e){const t=uS(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Hp(i,e??{}))return s;mc(s,"already-initialized")}return t.initialize({options:e})}function Voe(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(fh);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Uoe(n,e,t){const r=Tm(n);qt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=tz(e),{host:a,port:o}=Goe(e),l=o===null?"":`:${o}`,c={url:`${i}//${a}${l}/`},u=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){qt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),qt(Hp(c,r.config.emulator)&&Hp(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Sf(a)?(q3(`${i}//${a}${l}`),K3("Auth",!0)):Hoe()}function tz(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Goe(n){const e=tz(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:NM(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:NM(a)}}}function NM(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Hoe(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return dh("not implemented")}_getIdTokenResponse(e){return dh("not implemented")}_linkToIdToken(e,t){return dh("not implemented")}_getReauthenticationResolver(e){return dh("not implemented")}}async function Woe(n,e){return Cf(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qoe(n,e){return W1(n,"POST","/v1/accounts:signInWithPassword",Tf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Koe(n,e){return W1(n,"POST","/v1/accounts:signInWithEmailLink",Tf(n,e))}async function Xoe(n,e){return W1(n,"POST","/v1/accounts:signInWithEmailLink",Tf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy extends n4{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Jy(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Jy(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xk(e,t,"signInWithPassword",qoe);case"emailLink":return Koe(e,{email:this._email,oobCode:this._password});default:mc(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xk(e,r,"signUpPassword",Woe);case"emailLink":return Xoe(e,{idToken:t,email:this._email,oobCode:this._password});default:mc(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X0(n,e){return W1(n,"POST","/v1/accounts:signInWithIdp",Tf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yoe="http://localhost";class qp extends n4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):mc("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new qp(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return X0(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,X0(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,X0(e,t)}buildRequest(){const e={requestUri:Yoe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=G1(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zoe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Qoe(n){const e=yy(by(n)).link,t=e?yy(by(e)).deep_link_id:null,r=yy(by(n)).deep_link_id;return(r?yy(by(r)).link:null)||r||t||e||n}class r4{constructor(e){const t=yy(by(e)),r=t.apiKey??null,s=t.oobCode??null,i=Zoe(t.mode??null);qt(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=Qoe(e);try{return new r4(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(){this.providerId=Mg.PROVIDER_ID}static credential(e,t){return Jy._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=r4.parseLink(t);return qt(r,"argument-error"),Jy._fromEmailAndCode(e,r.code,r.tenantId)}}Mg.PROVIDER_ID="password";Mg.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Mg.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1 extends nz{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d extends q1{constructor(){super("facebook.com")}static credential(e){return qp._fromParams({providerId:$d.PROVIDER_ID,signInMethod:$d.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $d.credentialFromTaggedObject(e)}static credentialFromError(e){return $d.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $d.credential(e.oauthAccessToken)}catch{return null}}}$d.FACEBOOK_SIGN_IN_METHOD="facebook.com";$d.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld extends q1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qp._fromParams({providerId:Ld.PROVIDER_ID,signInMethod:Ld.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ld.credentialFromTaggedObject(e)}static credentialFromError(e){return Ld.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ld.credential(t,r)}catch{return null}}}Ld.GOOGLE_SIGN_IN_METHOD="google.com";Ld.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd extends q1{constructor(){super("github.com")}static credential(e){return qp._fromParams({providerId:Pd.PROVIDER_ID,signInMethod:Pd.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pd.credentialFromTaggedObject(e)}static credentialFromError(e){return Pd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pd.credential(e.oauthAccessToken)}catch{return null}}}Pd.GITHUB_SIGN_IN_METHOD="github.com";Pd.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od extends q1{constructor(){super("twitter.com")}static credential(e,t){return qp._fromParams({providerId:Od.PROVIDER_ID,signInMethod:Od.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Od.credentialFromTaggedObject(e)}static credentialFromError(e){return Od.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Od.credential(t,r)}catch{return null}}}Od.TWITTER_SIGN_IN_METHOD="twitter.com";Od.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Joe(n,e){return W1(n,"POST","/v1/accounts:signUp",Tf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await oc._fromIdTokenResponse(e,r,s),a=kM(r);return new Kp({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=kM(r);return new Kp({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function kM(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2 extends Ru{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,W2.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new W2(e,t,r,s)}}function rz(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?W2._fromErrorAndOperation(n,i,e,r):i})}async function ele(n,e,t=!1){const r=await Qy(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Kp._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tle(n,e,t=!1){const{auth:r}=n;if(Ko(r.app))return Promise.reject(xh(r));const s="reauthenticate";try{const i=await Qy(n,rz(r,s,e,n),t);qt(i.idToken,r,"internal-error");const a=e4(i.idToken);qt(a,r,"internal-error");const{sub:o}=a;return qt(n.uid===o,r,"user-mismatch"),Kp._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&mc(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sz(n,e,t=!1){if(Ko(n.app))return Promise.reject(xh(n));const r="signIn",s=await rz(n,r,e),i=await Kp._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function nle(n,e){return sz(Tm(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iz(n){const e=Tm(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function rle(n,e,t){if(Ko(n.app))return Promise.reject(xh(n));const r=Tm(n),a=await Xk(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Joe).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&iz(n),l}),o=await Kp._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(o.user),o}function sle(n,e,t){return Ko(n.app)?Promise.reject(xh(n)):nle(js(n),Mg.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&iz(n),r})}function ile(n,e,t,r){return js(n).onIdTokenChanged(e,t,r)}function ale(n,e,t){return js(n).beforeAuthStateChanged(e,t)}function s4(n,e,t,r){return js(n).onAuthStateChanged(e,t,r)}const q2="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class az{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(q2,"1"),this.storage.removeItem(q2),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ole=1e3,lle=10;class oz extends az{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Z7(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);Aoe()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,lle):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},ole)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}oz.type="LOCAL";const cle=oz;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lz extends az{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}lz.type="SESSION";const cz=lz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ule(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new dS(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const o=Array.from(a).map(async c=>c(t.origin,i)),l=await ule(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}dS.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i4(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hle{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=i4("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(d){const p=d;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(p.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function su(){return window}function dle(n){su().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uz(){return typeof su().WorkerGlobalScope<"u"&&typeof su().importScripts=="function"}async function fle(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ple(){return navigator?.serviceWorker?.controller||null}function mle(){return uz()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz="firebaseLocalStorageDb",gle=1,K2="firebaseLocalStorage",dz="fbase_key";class K1{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function fS(n,e){return n.transaction([K2],e?"readwrite":"readonly").objectStore(K2)}function xle(){const n=indexedDB.deleteDatabase(hz);return new K1(n).toPromise()}function Yk(){const n=indexedDB.open(hz,gle);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(K2,{keyPath:dz})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(K2)?e(r):(r.close(),await xle(),e(await Yk()))})})}async function IM(n,e,t){const r=fS(n,!0).put({[dz]:e,value:t});return new K1(r).toPromise()}async function yle(n,e){const t=fS(n,!1).get(e),r=await new K1(t).toPromise();return r===void 0?null:r.value}function RM(n,e){const t=fS(n,!0).delete(e);return new K1(t).toPromise()}const ble=800,vle=3;class fz{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Yk(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>vle)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return uz()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dS._getInstance(mle()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await fle(),!this.activeServiceWorker)return;this.sender=new hle(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ple()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yk();return await IM(e,q2,"1"),await RM(e,q2),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>IM(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>yle(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>RM(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=fS(s,!1).getAll();return new K1(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ble)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}fz.type="LOCAL";const _le=fz;new H1(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wle(n,e){return e?fh(e):(qt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4 extends n4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return X0(e,this._buildIdpRequest())}_linkToIdToken(e,t){return X0(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return X0(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ele(n){return sz(n.auth,new a4(n),n.bypassAuthState)}function Sle(n){const{auth:e,user:t}=n;return qt(t,e,"internal-error"),tle(t,new a4(n),n.bypassAuthState)}async function Tle(n){const{auth:e,user:t}=n;return qt(t,e,"internal-error"),ele(t,new a4(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pz{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ele;case"linkViaPopup":case"linkViaRedirect":return Tle;case"reauthViaPopup":case"reauthViaRedirect":return Sle;default:mc(this.auth,"internal-error")}}resolve(e){Sh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Sh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cle=new H1(2e3,1e4);class j0 extends pz{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,j0.currentPopupAction&&j0.currentPopupAction.cancel(),j0.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qt(e,this.auth,"internal-error"),e}async onExecution(){Sh(this.filter.length===1,"Popup operations only handle one event");const e=i4();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ru(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ru(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,j0.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ru(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Cle.get())};e()}}j0.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ale="pendingRedirect",Sw=new Map;class Nle extends pz{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Sw.get(this.auth._key());if(!e){try{const r=await kle(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Sw.set(this.auth._key(),e)}return this.bypassAuthState||Sw.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function kle(n,e){const t=Dle(e),r=Rle(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function Ile(n,e){Sw.set(n._key(),e)}function Rle(n){return fh(n._redirectPersistence)}function Dle(n){return Ew(Ale,n.config.apiKey,n.name)}async function $le(n,e,t=!1){if(Ko(n.app))return Promise.reject(xh(n));const r=Tm(n),s=wle(r,e),a=await new Nle(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lle=600*1e3;class Ple{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ole(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!mz(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ru(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Lle&&this.cachedEventUids.clear(),this.cachedEventUids.has(DM(e))}saveEventToCache(e){this.cachedEventUids.add(DM(e)),this.lastProcessedEventTime=Date.now()}}function DM(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function mz({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Ole(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return mz(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mle(n,e={}){return Cf(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fle=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ble=/^https?/;async function zle(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Mle(n);for(const t of e)try{if(jle(t))return}catch{}mc(n,"unauthorized-domain")}function jle(n){const e=qk(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!Ble.test(t))return!1;if(Fle.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vle=new H1(3e4,6e4);function $M(){const n=su().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Ule(n){return new Promise((e,t)=>{function r(){$M(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$M(),t(ru(n,"network-request-failed"))},timeout:Vle.get()})}if(su().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(su().gapi?.load)r();else{const s=Ooe("iframefcb");return su()[s]=()=>{gapi.load?r():t(ru(n,"network-request-failed"))},J7(`${Poe()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw Tw=null,e})}let Tw=null;function Gle(n){return Tw=Tw||Ule(n),Tw}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hle=new H1(5e3,15e3),Wle="__/auth/iframe",qle="emulator/auth/iframe",Kle={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Xle=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yle(n){const e=n.config;qt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?J3(e,qle):`https://${n.config.authDomain}/${Wle}`,r={apiKey:e.apiKey,appName:n.name,v:Sm},s=Xle.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${G1(r).slice(1)}`}async function Zle(n){const e=await Gle(n),t=su().gapi;return qt(t,n,"internal-error"),e.open({where:document.body,url:Yle(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Kle,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=ru(n,"network-request-failed"),o=su().setTimeout(()=>{i(a)},Hle.get());function l(){su().clearTimeout(o),s(r)}r.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qle={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Jle=500,ece=600,tce="_blank",nce="http://localhost";class LM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rce(n,e,t,r=Jle,s=ece){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...Qle,width:r.toString(),height:s.toString(),top:i,left:a},c=Ia().toLowerCase();t&&(o=W7(c)?tce:t),G7(c)&&(e=e||nce,l.scrollbars="yes");const u=Object.entries(l).reduce((p,[x,y])=>`${p}${x}=${y},`,"");if(Coe(c)&&o!=="_self")return sce(e||"",o),new LM(null);const d=window.open(e||"",o,u);qt(d,n,"popup-blocked");try{d.focus()}catch{}return new LM(d)}function sce(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ice="__/auth/handler",ace="emulator/auth/handler",oce=encodeURIComponent("fac");async function PM(n,e,t,r,s,i){qt(n.config.authDomain,n,"auth-domain-config-required"),qt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Sm,eventId:s};if(e instanceof nz){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Wie(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))a[u]=d}if(e instanceof q1){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(a.scopes=u.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await n._getAppCheckToken(),c=l?`#${oce}=${encodeURIComponent(l)}`:"";return`${lce(n)}?${G1(o).slice(1)}${c}`}function lce({config:n}){return n.emulator?J3(n,ace):`https://${n.authDomain}/${ice}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN="webStorageSupport";class cce{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=cz,this._completeRedirectFn=$le,this._overrideRedirectResult=Ile}async _openPopup(e,t,r,s){Sh(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await PM(e,t,r,qk(),s);return rce(e,i,i4())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await PM(e,t,r,qk(),s);return dle(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Sh(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Zle(e),r=new Ple(e);return t.register("authEvent",s=>(qt(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(NN,{type:NN},s=>{const i=s?.[0]?.[NN];i!==void 0&&t(!!i),mc(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=zle(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Z7()||H7()||t4()}}const uce=cce;var OM="@firebase/auth",MM="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hce{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){qt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dce(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function fce(n){Wp(new nf("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;qt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Q7(n)},c=new Doe(r,s,i,l);return Voe(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Wp(new nf("auth-internal",e=>{const t=Tm(e.getProvider("auth").getImmediate());return(r=>new hce(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),nu(OM,MM,dce(n)),nu(OM,MM,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pce=300,mce=k7("authIdTokenMaxAge")||pce;let FM=null;const gce=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>mce)return;const s=t?.token;FM!==s&&(FM=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function xce(n=Z3()){const e=uS(n,"auth");if(e.isInitialized())return e.getImmediate();const t=joe(n,{popupRedirectResolver:uce,persistence:[_le,cle,cz]}),r=k7("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=gce(i.toString());ale(t,a,()=>a(t.currentUser)),ile(t,o=>a(o))}}const s=C7("auth");return s&&Uoe(t,`http://${s}`),t}function yce(){return document.getElementsByTagName("head")?.[0]??document}$oe({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=ru("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",yce().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});fce("Browser");var BM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xd,gz;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(U,F){function G(){}G.prototype=F.prototype,U.F=F.prototype,U.prototype=new G,U.prototype.constructor=U,U.D=function(V,O,K){for(var P=Array(arguments.length-2),N=2;N<arguments.length;N++)P[N-2]=arguments[N];return F.prototype[O].apply(V,P)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(U,F,G){G||(G=0);const V=Array(16);if(typeof F=="string")for(var O=0;O<16;++O)V[O]=F.charCodeAt(G++)|F.charCodeAt(G++)<<8|F.charCodeAt(G++)<<16|F.charCodeAt(G++)<<24;else for(O=0;O<16;++O)V[O]=F[G++]|F[G++]<<8|F[G++]<<16|F[G++]<<24;F=U.g[0],G=U.g[1],O=U.g[2];let K=U.g[3],P;P=F+(K^G&(O^K))+V[0]+3614090360&4294967295,F=G+(P<<7&4294967295|P>>>25),P=K+(O^F&(G^O))+V[1]+3905402710&4294967295,K=F+(P<<12&4294967295|P>>>20),P=O+(G^K&(F^G))+V[2]+606105819&4294967295,O=K+(P<<17&4294967295|P>>>15),P=G+(F^O&(K^F))+V[3]+3250441966&4294967295,G=O+(P<<22&4294967295|P>>>10),P=F+(K^G&(O^K))+V[4]+4118548399&4294967295,F=G+(P<<7&4294967295|P>>>25),P=K+(O^F&(G^O))+V[5]+1200080426&4294967295,K=F+(P<<12&4294967295|P>>>20),P=O+(G^K&(F^G))+V[6]+2821735955&4294967295,O=K+(P<<17&4294967295|P>>>15),P=G+(F^O&(K^F))+V[7]+4249261313&4294967295,G=O+(P<<22&4294967295|P>>>10),P=F+(K^G&(O^K))+V[8]+1770035416&4294967295,F=G+(P<<7&4294967295|P>>>25),P=K+(O^F&(G^O))+V[9]+2336552879&4294967295,K=F+(P<<12&4294967295|P>>>20),P=O+(G^K&(F^G))+V[10]+4294925233&4294967295,O=K+(P<<17&4294967295|P>>>15),P=G+(F^O&(K^F))+V[11]+2304563134&4294967295,G=O+(P<<22&4294967295|P>>>10),P=F+(K^G&(O^K))+V[12]+1804603682&4294967295,F=G+(P<<7&4294967295|P>>>25),P=K+(O^F&(G^O))+V[13]+4254626195&4294967295,K=F+(P<<12&4294967295|P>>>20),P=O+(G^K&(F^G))+V[14]+2792965006&4294967295,O=K+(P<<17&4294967295|P>>>15),P=G+(F^O&(K^F))+V[15]+1236535329&4294967295,G=O+(P<<22&4294967295|P>>>10),P=F+(O^K&(G^O))+V[1]+4129170786&4294967295,F=G+(P<<5&4294967295|P>>>27),P=K+(G^O&(F^G))+V[6]+3225465664&4294967295,K=F+(P<<9&4294967295|P>>>23),P=O+(F^G&(K^F))+V[11]+643717713&4294967295,O=K+(P<<14&4294967295|P>>>18),P=G+(K^F&(O^K))+V[0]+3921069994&4294967295,G=O+(P<<20&4294967295|P>>>12),P=F+(O^K&(G^O))+V[5]+3593408605&4294967295,F=G+(P<<5&4294967295|P>>>27),P=K+(G^O&(F^G))+V[10]+38016083&4294967295,K=F+(P<<9&4294967295|P>>>23),P=O+(F^G&(K^F))+V[15]+3634488961&4294967295,O=K+(P<<14&4294967295|P>>>18),P=G+(K^F&(O^K))+V[4]+3889429448&4294967295,G=O+(P<<20&4294967295|P>>>12),P=F+(O^K&(G^O))+V[9]+568446438&4294967295,F=G+(P<<5&4294967295|P>>>27),P=K+(G^O&(F^G))+V[14]+3275163606&4294967295,K=F+(P<<9&4294967295|P>>>23),P=O+(F^G&(K^F))+V[3]+4107603335&4294967295,O=K+(P<<14&4294967295|P>>>18),P=G+(K^F&(O^K))+V[8]+1163531501&4294967295,G=O+(P<<20&4294967295|P>>>12),P=F+(O^K&(G^O))+V[13]+2850285829&4294967295,F=G+(P<<5&4294967295|P>>>27),P=K+(G^O&(F^G))+V[2]+4243563512&4294967295,K=F+(P<<9&4294967295|P>>>23),P=O+(F^G&(K^F))+V[7]+1735328473&4294967295,O=K+(P<<14&4294967295|P>>>18),P=G+(K^F&(O^K))+V[12]+2368359562&4294967295,G=O+(P<<20&4294967295|P>>>12),P=F+(G^O^K)+V[5]+4294588738&4294967295,F=G+(P<<4&4294967295|P>>>28),P=K+(F^G^O)+V[8]+2272392833&4294967295,K=F+(P<<11&4294967295|P>>>21),P=O+(K^F^G)+V[11]+1839030562&4294967295,O=K+(P<<16&4294967295|P>>>16),P=G+(O^K^F)+V[14]+4259657740&4294967295,G=O+(P<<23&4294967295|P>>>9),P=F+(G^O^K)+V[1]+2763975236&4294967295,F=G+(P<<4&4294967295|P>>>28),P=K+(F^G^O)+V[4]+1272893353&4294967295,K=F+(P<<11&4294967295|P>>>21),P=O+(K^F^G)+V[7]+4139469664&4294967295,O=K+(P<<16&4294967295|P>>>16),P=G+(O^K^F)+V[10]+3200236656&4294967295,G=O+(P<<23&4294967295|P>>>9),P=F+(G^O^K)+V[13]+681279174&4294967295,F=G+(P<<4&4294967295|P>>>28),P=K+(F^G^O)+V[0]+3936430074&4294967295,K=F+(P<<11&4294967295|P>>>21),P=O+(K^F^G)+V[3]+3572445317&4294967295,O=K+(P<<16&4294967295|P>>>16),P=G+(O^K^F)+V[6]+76029189&4294967295,G=O+(P<<23&4294967295|P>>>9),P=F+(G^O^K)+V[9]+3654602809&4294967295,F=G+(P<<4&4294967295|P>>>28),P=K+(F^G^O)+V[12]+3873151461&4294967295,K=F+(P<<11&4294967295|P>>>21),P=O+(K^F^G)+V[15]+530742520&4294967295,O=K+(P<<16&4294967295|P>>>16),P=G+(O^K^F)+V[2]+3299628645&4294967295,G=O+(P<<23&4294967295|P>>>9),P=F+(O^(G|~K))+V[0]+4096336452&4294967295,F=G+(P<<6&4294967295|P>>>26),P=K+(G^(F|~O))+V[7]+1126891415&4294967295,K=F+(P<<10&4294967295|P>>>22),P=O+(F^(K|~G))+V[14]+2878612391&4294967295,O=K+(P<<15&4294967295|P>>>17),P=G+(K^(O|~F))+V[5]+4237533241&4294967295,G=O+(P<<21&4294967295|P>>>11),P=F+(O^(G|~K))+V[12]+1700485571&4294967295,F=G+(P<<6&4294967295|P>>>26),P=K+(G^(F|~O))+V[3]+2399980690&4294967295,K=F+(P<<10&4294967295|P>>>22),P=O+(F^(K|~G))+V[10]+4293915773&4294967295,O=K+(P<<15&4294967295|P>>>17),P=G+(K^(O|~F))+V[1]+2240044497&4294967295,G=O+(P<<21&4294967295|P>>>11),P=F+(O^(G|~K))+V[8]+1873313359&4294967295,F=G+(P<<6&4294967295|P>>>26),P=K+(G^(F|~O))+V[15]+4264355552&4294967295,K=F+(P<<10&4294967295|P>>>22),P=O+(F^(K|~G))+V[6]+2734768916&4294967295,O=K+(P<<15&4294967295|P>>>17),P=G+(K^(O|~F))+V[13]+1309151649&4294967295,G=O+(P<<21&4294967295|P>>>11),P=F+(O^(G|~K))+V[4]+4149444226&4294967295,F=G+(P<<6&4294967295|P>>>26),P=K+(G^(F|~O))+V[11]+3174756917&4294967295,K=F+(P<<10&4294967295|P>>>22),P=O+(F^(K|~G))+V[2]+718787259&4294967295,O=K+(P<<15&4294967295|P>>>17),P=G+(K^(O|~F))+V[9]+3951481745&4294967295,U.g[0]=U.g[0]+F&4294967295,U.g[1]=U.g[1]+(O+(P<<21&4294967295|P>>>11))&4294967295,U.g[2]=U.g[2]+O&4294967295,U.g[3]=U.g[3]+K&4294967295}r.prototype.v=function(U,F){F===void 0&&(F=U.length);const G=F-this.blockSize,V=this.C;let O=this.h,K=0;for(;K<F;){if(O==0)for(;K<=G;)s(this,U,K),K+=this.blockSize;if(typeof U=="string"){for(;K<F;)if(V[O++]=U.charCodeAt(K++),O==this.blockSize){s(this,V),O=0;break}}else for(;K<F;)if(V[O++]=U[K++],O==this.blockSize){s(this,V),O=0;break}}this.h=O,this.o+=F},r.prototype.A=function(){var U=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);U[0]=128;for(var F=1;F<U.length-8;++F)U[F]=0;F=this.o*8;for(var G=U.length-8;G<U.length;++G)U[G]=F&255,F/=256;for(this.v(U),U=Array(16),F=0,G=0;G<4;++G)for(let V=0;V<32;V+=8)U[F++]=this.g[G]>>>V&255;return U};function i(U,F){var G=o;return Object.prototype.hasOwnProperty.call(G,U)?G[U]:G[U]=F(U)}function a(U,F){this.h=F;const G=[];let V=!0;for(let O=U.length-1;O>=0;O--){const K=U[O]|0;V&&K==F||(G[O]=K,V=!1)}this.g=G}var o={};function l(U){return-128<=U&&U<128?i(U,function(F){return new a([F|0],F<0?-1:0)}):new a([U|0],U<0?-1:0)}function c(U){if(isNaN(U)||!isFinite(U))return d;if(U<0)return b(c(-U));const F=[];let G=1;for(let V=0;U>=G;V++)F[V]=U/G|0,G*=4294967296;return new a(F,0)}function u(U,F){if(U.length==0)throw Error("number format error: empty string");if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(U.charAt(0)=="-")return b(u(U.substring(1),F));if(U.indexOf("-")>=0)throw Error('number format error: interior "-" character');const G=c(Math.pow(F,8));let V=d;for(let K=0;K<U.length;K+=8){var O=Math.min(8,U.length-K);const P=parseInt(U.substring(K,K+O),F);O<8?(O=c(Math.pow(F,O)),V=V.j(O).add(c(P))):(V=V.j(G),V=V.add(c(P)))}return V}var d=l(0),p=l(1),x=l(16777216);n=a.prototype,n.m=function(){if(v(this))return-b(this).m();let U=0,F=1;for(let G=0;G<this.g.length;G++){const V=this.i(G);U+=(V>=0?V:4294967296+V)*F,F*=4294967296}return U},n.toString=function(U){if(U=U||10,U<2||36<U)throw Error("radix out of range: "+U);if(y(this))return"0";if(v(this))return"-"+b(this).toString(U);const F=c(Math.pow(U,6));var G=this;let V="";for(;;){const O=I(G,F).g;G=S(G,O.j(F));let K=((G.g.length>0?G.g[0]:G.h)>>>0).toString(U);if(G=O,y(G))return K+V;for(;K.length<6;)K="0"+K;V=K+V}},n.i=function(U){return U<0?0:U<this.g.length?this.g[U]:this.h};function y(U){if(U.h!=0)return!1;for(let F=0;F<U.g.length;F++)if(U.g[F]!=0)return!1;return!0}function v(U){return U.h==-1}n.l=function(U){return U=S(this,U),v(U)?-1:y(U)?0:1};function b(U){const F=U.g.length,G=[];for(let V=0;V<F;V++)G[V]=~U.g[V];return new a(G,~U.h).add(p)}n.abs=function(){return v(this)?b(this):this},n.add=function(U){const F=Math.max(this.g.length,U.g.length),G=[];let V=0;for(let O=0;O<=F;O++){let K=V+(this.i(O)&65535)+(U.i(O)&65535),P=(K>>>16)+(this.i(O)>>>16)+(U.i(O)>>>16);V=P>>>16,K&=65535,P&=65535,G[O]=P<<16|K}return new a(G,G[G.length-1]&-2147483648?-1:0)};function S(U,F){return U.add(b(F))}n.j=function(U){if(y(this)||y(U))return d;if(v(this))return v(U)?b(this).j(b(U)):b(b(this).j(U));if(v(U))return b(this.j(b(U)));if(this.l(x)<0&&U.l(x)<0)return c(this.m()*U.m());const F=this.g.length+U.g.length,G=[];for(var V=0;V<2*F;V++)G[V]=0;for(V=0;V<this.g.length;V++)for(let O=0;O<U.g.length;O++){const K=this.i(V)>>>16,P=this.i(V)&65535,N=U.i(O)>>>16,M=U.i(O)&65535;G[2*V+2*O]+=P*M,T(G,2*V+2*O),G[2*V+2*O+1]+=K*M,T(G,2*V+2*O+1),G[2*V+2*O+1]+=P*N,T(G,2*V+2*O+1),G[2*V+2*O+2]+=K*N,T(G,2*V+2*O+2)}for(U=0;U<F;U++)G[U]=G[2*U+1]<<16|G[2*U];for(U=F;U<2*F;U++)G[U]=0;return new a(G,0)};function T(U,F){for(;(U[F]&65535)!=U[F];)U[F+1]+=U[F]>>>16,U[F]&=65535,F++}function C(U,F){this.g=U,this.h=F}function I(U,F){if(y(F))throw Error("division by zero");if(y(U))return new C(d,d);if(v(U))return F=I(b(U),F),new C(b(F.g),b(F.h));if(v(F))return F=I(U,b(F)),new C(b(F.g),F.h);if(U.g.length>30){if(v(U)||v(F))throw Error("slowDivide_ only works with positive integers.");for(var G=p,V=F;V.l(U)<=0;)G=$(G),V=$(V);var O=q(G,1),K=q(V,1);for(V=q(V,2),G=q(G,2);!y(V);){var P=K.add(V);P.l(U)<=0&&(O=O.add(G),K=P),V=q(V,1),G=q(G,1)}return F=S(U,O.j(F)),new C(O,F)}for(O=d;U.l(F)>=0;){for(G=Math.max(1,Math.floor(U.m()/F.m())),V=Math.ceil(Math.log(G)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),K=c(G),P=K.j(F);v(P)||P.l(U)>0;)G-=V,K=c(G),P=K.j(F);y(K)&&(K=p),O=O.add(K),U=S(U,P)}return new C(O,U)}n.B=function(U){return I(this,U).h},n.and=function(U){const F=Math.max(this.g.length,U.g.length),G=[];for(let V=0;V<F;V++)G[V]=this.i(V)&U.i(V);return new a(G,this.h&U.h)},n.or=function(U){const F=Math.max(this.g.length,U.g.length),G=[];for(let V=0;V<F;V++)G[V]=this.i(V)|U.i(V);return new a(G,this.h|U.h)},n.xor=function(U){const F=Math.max(this.g.length,U.g.length),G=[];for(let V=0;V<F;V++)G[V]=this.i(V)^U.i(V);return new a(G,this.h^U.h)};function $(U){const F=U.g.length+1,G=[];for(let V=0;V<F;V++)G[V]=U.i(V)<<1|U.i(V-1)>>>31;return new a(G,U.h)}function q(U,F){const G=F>>5;F%=32;const V=U.g.length-G,O=[];for(let K=0;K<V;K++)O[K]=F>0?U.i(K+G)>>>F|U.i(K+G+1)<<32-F:U.i(K+G);return new a(O,U.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,gz=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Xd=a}).apply(typeof BM<"u"?BM:typeof self<"u"?self:typeof window<"u"?window:{});var H_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xz,vy,yz,Cw,Zk,bz,vz,_z;(function(){var n,e=Object.defineProperty;function t(A){A=[typeof globalThis=="object"&&globalThis,A,typeof window=="object"&&window,typeof self=="object"&&self,typeof H_=="object"&&H_];for(var J=0;J<A.length;++J){var se=A[J];if(se&&se.Math==Math)return se}throw Error("Cannot find global object")}var r=t(this);function s(A,J){if(J)e:{var se=r;A=A.split(".");for(var he=0;he<A.length-1;he++){var Ie=A[he];if(!(Ie in se))break e;se=se[Ie]}A=A[A.length-1],he=se[A],J=J(he),J!=he&&J!=null&&e(se,A,{configurable:!0,writable:!0,value:J})}}s("Symbol.dispose",function(A){return A||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(A){return A||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(A){return A||function(J){var se=[],he;for(he in J)Object.prototype.hasOwnProperty.call(J,he)&&se.push([he,J[he]]);return se}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function o(A){var J=typeof A;return J=="object"&&A!=null||J=="function"}function l(A,J,se){return A.call.apply(A.bind,arguments)}function c(A,J,se){return c=l,c.apply(null,arguments)}function u(A,J){var se=Array.prototype.slice.call(arguments,1);return function(){var he=se.slice();return he.push.apply(he,arguments),A.apply(this,he)}}function d(A,J){function se(){}se.prototype=J.prototype,A.Z=J.prototype,A.prototype=new se,A.prototype.constructor=A,A.Ob=function(he,Ie,Oe){for(var it=Array(arguments.length-2),Gt=2;Gt<arguments.length;Gt++)it[Gt-2]=arguments[Gt];return J.prototype[Ie].apply(he,it)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?A=>A&&AsyncContext.Snapshot.wrap(A):A=>A;function x(A){const J=A.length;if(J>0){const se=Array(J);for(let he=0;he<J;he++)se[he]=A[he];return se}return[]}function y(A,J){for(let he=1;he<arguments.length;he++){const Ie=arguments[he];var se=typeof Ie;if(se=se!="object"?se:Ie?Array.isArray(Ie)?"array":se:"null",se=="array"||se=="object"&&typeof Ie.length=="number"){se=A.length||0;const Oe=Ie.length||0;A.length=se+Oe;for(let it=0;it<Oe;it++)A[se+it]=Ie[it]}else A.push(Ie)}}class v{constructor(J,se){this.i=J,this.j=se,this.h=0,this.g=null}get(){let J;return this.h>0?(this.h--,J=this.g,this.g=J.next,J.next=null):J=this.i(),J}}function b(A){a.setTimeout(()=>{throw A},0)}function S(){var A=U;let J=null;return A.g&&(J=A.g,A.g=A.g.next,A.g||(A.h=null),J.next=null),J}class T{constructor(){this.h=this.g=null}add(J,se){const he=C.get();he.set(J,se),this.h?this.h.next=he:this.g=he,this.h=he}}var C=new v(()=>new I,A=>A.reset());class I{constructor(){this.next=this.g=this.h=null}set(J,se){this.h=J,this.g=se,this.next=null}reset(){this.next=this.g=this.h=null}}let $,q=!1,U=new T,F=()=>{const A=Promise.resolve(void 0);$=()=>{A.then(G)}};function G(){for(var A;A=S();){try{A.h.call(A.g)}catch(se){b(se)}var J=C;J.j(A),J.h<100&&(J.h++,A.next=J.g,J.g=A)}q=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(A,J){this.type=A,this.g=this.target=J,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var K=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var A=!1,J=Object.defineProperty({},"passive",{get:function(){A=!0}});try{const se=()=>{};a.addEventListener("test",se,J),a.removeEventListener("test",se,J)}catch{}return A})();function P(A){return/^[\s\xa0]*$/.test(A)}function N(A,J){O.call(this,A?A.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,A&&this.init(A,J)}d(N,O),N.prototype.init=function(A,J){const se=this.type=A.type,he=A.changedTouches&&A.changedTouches.length?A.changedTouches[0]:null;this.target=A.target||A.srcElement,this.g=J,J=A.relatedTarget,J||(se=="mouseover"?J=A.fromElement:se=="mouseout"&&(J=A.toElement)),this.relatedTarget=J,he?(this.clientX=he.clientX!==void 0?he.clientX:he.pageX,this.clientY=he.clientY!==void 0?he.clientY:he.pageY,this.screenX=he.screenX||0,this.screenY=he.screenY||0):(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0),this.button=A.button,this.key=A.key||"",this.ctrlKey=A.ctrlKey,this.altKey=A.altKey,this.shiftKey=A.shiftKey,this.metaKey=A.metaKey,this.pointerId=A.pointerId||0,this.pointerType=A.pointerType,this.state=A.state,this.i=A,A.defaultPrevented&&N.Z.h.call(this)},N.prototype.h=function(){N.Z.h.call(this);const A=this.i;A.preventDefault?A.preventDefault():A.returnValue=!1};var M="closure_listenable_"+(Math.random()*1e6|0),B=0;function Y(A,J,se,he,Ie){this.listener=A,this.proxy=null,this.src=J,this.type=se,this.capture=!!he,this.ha=Ie,this.key=++B,this.da=this.fa=!1}function Z(A){A.da=!0,A.listener=null,A.proxy=null,A.src=null,A.ha=null}function ne(A,J,se){for(const he in A)J.call(se,A[he],he,A)}function Q(A,J){for(const se in A)J.call(void 0,A[se],se,A)}function z(A){const J={};for(const se in A)J[se]=A[se];return J}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(A,J){let se,he;for(let Ie=1;Ie<arguments.length;Ie++){he=arguments[Ie];for(se in he)A[se]=he[se];for(let Oe=0;Oe<D.length;Oe++)se=D[Oe],Object.prototype.hasOwnProperty.call(he,se)&&(A[se]=he[se])}}function re(A){this.src=A,this.g={},this.h=0}re.prototype.add=function(A,J,se,he,Ie){const Oe=A.toString();A=this.g[Oe],A||(A=this.g[Oe]=[],this.h++);const it=ae(A,J,he,Ie);return it>-1?(J=A[it],se||(J.fa=!1)):(J=new Y(J,this.src,Oe,!!he,Ie),J.fa=se,A.push(J)),J};function W(A,J){const se=J.type;if(se in A.g){var he=A.g[se],Ie=Array.prototype.indexOf.call(he,J,void 0),Oe;(Oe=Ie>=0)&&Array.prototype.splice.call(he,Ie,1),Oe&&(Z(J),A.g[se].length==0&&(delete A.g[se],A.h--))}}function ae(A,J,se,he){for(let Ie=0;Ie<A.length;++Ie){const Oe=A[Ie];if(!Oe.da&&Oe.listener==J&&Oe.capture==!!se&&Oe.ha==he)return Ie}return-1}var pe="closure_lm_"+(Math.random()*1e6|0),de={};function ve(A,J,se,he,Ie){if(Array.isArray(J)){for(let Oe=0;Oe<J.length;Oe++)ve(A,J[Oe],se,he,Ie);return null}return se=xt(se),A&&A[M]?A.J(J,se,o(he)?!!he.capture:!1,Ie):Ve(A,J,se,!1,he,Ie)}function Ve(A,J,se,he,Ie,Oe){if(!J)throw Error("Invalid event type");const it=o(Ie)?!!Ie.capture:!!Ie;let Gt=Nt(A);if(Gt||(A[pe]=Gt=new re(A)),se=Gt.add(J,se,he,it,Oe),se.proxy)return se;if(he=ze(),se.proxy=he,he.src=A,he.listener=se,A.addEventListener)K||(Ie=it),Ie===void 0&&(Ie=!1),A.addEventListener(J.toString(),he,Ie);else if(A.attachEvent)A.attachEvent(We(J.toString()),he);else if(A.addListener&&A.removeListener)A.addListener(he);else throw Error("addEventListener and attachEvent are unavailable.");return se}function ze(){function A(se){return J.call(A.src,A.listener,se)}const J=nt;return A}function Ge(A,J,se,he,Ie){if(Array.isArray(J))for(var Oe=0;Oe<J.length;Oe++)Ge(A,J[Oe],se,he,Ie);else he=o(he)?!!he.capture:!!he,se=xt(se),A&&A[M]?(A=A.i,Oe=String(J).toString(),Oe in A.g&&(J=A.g[Oe],se=ae(J,se,he,Ie),se>-1&&(Z(J[se]),Array.prototype.splice.call(J,se,1),J.length==0&&(delete A.g[Oe],A.h--)))):A&&(A=Nt(A))&&(J=A.g[J.toString()],A=-1,J&&(A=ae(J,se,he,Ie)),(se=A>-1?J[A]:null)&&at(se))}function at(A){if(typeof A!="number"&&A&&!A.da){var J=A.src;if(J&&J[M])W(J.i,A);else{var se=A.type,he=A.proxy;J.removeEventListener?J.removeEventListener(se,he,A.capture):J.detachEvent?J.detachEvent(We(se),he):J.addListener&&J.removeListener&&J.removeListener(he),(se=Nt(J))?(W(se,A),se.h==0&&(se.src=null,J[pe]=null)):Z(A)}}}function We(A){return A in de?de[A]:de[A]="on"+A}function nt(A,J){if(A.da)A=!0;else{J=new N(J,this);const se=A.listener,he=A.ha||A.src;A.fa&&at(A),A=se.call(he,J)}return A}function Nt(A){return A=A[pe],A instanceof re?A:null}var ct="__closure_events_fn_"+(Math.random()*1e9>>>0);function xt(A){return typeof A=="function"?A:(A[ct]||(A[ct]=function(J){return A.handleEvent(J)}),A[ct])}function en(){V.call(this),this.i=new re(this),this.M=this,this.G=null}d(en,V),en.prototype[M]=!0,en.prototype.removeEventListener=function(A,J,se,he){Ge(this,A,J,se,he)};function ht(A,J){var se,he=A.G;if(he)for(se=[];he;he=he.G)se.push(he);if(A=A.M,he=J.type||J,typeof J=="string")J=new O(J,A);else if(J instanceof O)J.target=J.target||A;else{var Ie=J;J=new O(he,A),X(J,Ie)}Ie=!0;let Oe,it;if(se)for(it=se.length-1;it>=0;it--)Oe=J.g=se[it],Ie=St(Oe,he,!0,J)&&Ie;if(Oe=J.g=A,Ie=St(Oe,he,!0,J)&&Ie,Ie=St(Oe,he,!1,J)&&Ie,se)for(it=0;it<se.length;it++)Oe=J.g=se[it],Ie=St(Oe,he,!1,J)&&Ie}en.prototype.N=function(){if(en.Z.N.call(this),this.i){var A=this.i;for(const J in A.g){const se=A.g[J];for(let he=0;he<se.length;he++)Z(se[he]);delete A.g[J],A.h--}}this.G=null},en.prototype.J=function(A,J,se,he){return this.i.add(String(A),J,!1,se,he)},en.prototype.K=function(A,J,se,he){return this.i.add(String(A),J,!0,se,he)};function St(A,J,se,he){if(J=A.i.g[String(J)],!J)return!0;J=J.concat();let Ie=!0;for(let Oe=0;Oe<J.length;++Oe){const it=J[Oe];if(it&&!it.da&&it.capture==se){const Gt=it.listener,$n=it.ha||it.src;it.fa&&W(A.i,it),Ie=Gt.call($n,he)!==!1&&Ie}}return Ie&&!he.defaultPrevented}function an(A,J){if(typeof A!="function")if(A&&typeof A.handleEvent=="function")A=c(A.handleEvent,A);else throw Error("Invalid listener argument");return Number(J)>2147483647?-1:a.setTimeout(A,J||0)}function Ot(A){A.g=an(()=>{A.g=null,A.i&&(A.i=!1,Ot(A))},A.l);const J=A.h;A.h=null,A.m.apply(null,J)}class Mt extends V{constructor(J,se){super(),this.m=J,this.l=se,this.h=null,this.i=!1,this.g=null}j(J){this.h=arguments,this.g?this.i=!0:Ot(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wn(A){V.call(this),this.h=A,this.g={}}d(Wn,V);var It=[];function Tt(A){ne(A.g,function(J,se){this.g.hasOwnProperty(se)&&at(J)},A),A.g={}}Wn.prototype.N=function(){Wn.Z.N.call(this),Tt(this)},Wn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nr=a.JSON.stringify,Bt=a.JSON.parse,Cn=class{stringify(A){return a.JSON.stringify(A,void 0)}parse(A){return a.JSON.parse(A,void 0)}};function Br(){}function xn(){}var tn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Wr(){O.call(this,"d")}d(Wr,O);function rn(){O.call(this,"c")}d(rn,O);var hn={},es=null;function Mn(){return es=es||new en}hn.Ia="serverreachability";function qn(A){O.call(this,hn.Ia,A)}d(qn,O);function ms(A){const J=Mn();ht(J,new qn(J))}hn.STAT_EVENT="statevent";function Fn(A,J){O.call(this,hn.STAT_EVENT,A),this.stat=J}d(Fn,O);function Ft(A){const J=Mn();ht(J,new Fn(J,A))}hn.Ja="timingevent";function oa(A,J){O.call(this,hn.Ja,A),this.size=J}d(oa,O);function Rn(A,J){if(typeof A!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){A()},J)}function Dn(){this.g=!0}Dn.prototype.ua=function(){this.g=!1};function yi(A,J,se,he,Ie,Oe){A.info(function(){if(A.g)if(Oe){var it="",Gt=Oe.split("&");for(let hr=0;hr<Gt.length;hr++){var $n=Gt[hr].split("=");if($n.length>1){const ts=$n[0];$n=$n[1];const za=ts.split("_");it=za.length>=2&&za[1]=="type"?it+(ts+"="+$n+"&"):it+(ts+"=redacted&")}}}else it=null;else it=Oe;return"XMLHTTP REQ ("+he+") [attempt "+Ie+"]: "+J+`
`+se+`
`+it})}function Kn(A,J,se,he,Ie,Oe,it){A.info(function(){return"XMLHTTP RESP ("+he+") [ attempt "+Ie+"]: "+J+`
`+se+`
`+Oe+" "+it})}function An(A,J,se,he){A.info(function(){return"XMLHTTP TEXT ("+J+"): "+yn(A,se)+(he?" "+he:"")})}function bi(A,J){A.info(function(){return"TIMEOUT: "+J})}Dn.prototype.info=function(){};function yn(A,J){if(!A.g)return J;if(!J)return null;try{const Oe=JSON.parse(J);if(Oe){for(A=0;A<Oe.length;A++)if(Array.isArray(Oe[A])){var se=Oe[A];if(!(se.length<2)){var he=se[1];if(Array.isArray(he)&&!(he.length<1)){var Ie=he[0];if(Ie!="noop"&&Ie!="stop"&&Ie!="close")for(let it=1;it<he.length;it++)he[it]=""}}}}return nr(Oe)}catch{return J}}var zt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},nn;function Zt(){}d(Zt,Br),Zt.prototype.g=function(){return new XMLHttpRequest},nn=new Zt;function dt(A){return encodeURIComponent(String(A))}function cr(A){var J=1;A=A.split(":");const se=[];for(;J>0&&A.length;)se.push(A.shift()),J--;return A.length&&se.push(A.join(":")),se}function bn(A,J,se,he){this.j=A,this.i=J,this.l=se,this.S=he||1,this.V=new Wn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ri}function ri(){this.i=null,this.g="",this.h=!1}var Xn={},vn={};function ks(A,J,se){A.M=1,A.A=xr(Tr(J)),A.u=se,A.R=!0,mn(A,null)}function mn(A,J){A.F=Date.now(),vi(A),A.B=Tr(A.A);var se=A.B,he=A.S;Array.isArray(he)||(he=[String(he)]),jh(se.i,"t",he),A.C=0,se=A.j.L,A.h=new ri,A.g=zu(A.j,se?J:null,!A.u),A.P>0&&(A.O=new Mt(c(A.Y,A,A.g),A.P)),J=A.V,se=A.g,he=A.ba;var Ie="readystatechange";Array.isArray(Ie)||(Ie&&(It[0]=Ie.toString()),Ie=It);for(let Oe=0;Oe<Ie.length;Oe++){const it=ve(se,Ie[Oe],he||J.handleEvent,!1,J.h||J);if(!it)break;J.g[it.key]=it}J=A.J?z(A.J):{},A.u?(A.v||(A.v="POST"),J["Content-Type"]="application/x-www-form-urlencoded",A.g.ea(A.B,A.v,A.u,J)):(A.v="GET",A.g.ea(A.B,A.v,null,J)),ms(),yi(A.i,A.v,A.B,A.l,A.S,A.u)}bn.prototype.ba=function(A){A=A.target;const J=this.O;J&&Ci(A)==3?J.j():this.Y(A)},bn.prototype.Y=function(A){try{if(A==this.g)e:{const Gt=Ci(this.g),$n=this.g.ya(),hr=this.g.ca();if(!(Gt<3)&&(Gt!=3||this.g&&(this.h.h||this.g.la()||Nc(this.g)))){this.K||Gt!=4||$n==7||($n==8||hr<=0?ms(3):ms(2)),gs(this);var J=this.g.ca();this.X=J;var se=Bn(this);if(this.o=J==200,Kn(this.i,this.v,this.B,this.l,this.S,Gt,J),this.o){if(this.U&&!this.L){t:{if(this.g){var he,Ie=this.g;if((he=Ie.g?Ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(he)){var Oe=he;break t}}Oe=null}if(A=Oe)An(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,il(this,A);else{this.o=!1,this.m=3,Ft(12),si(this),To(this);break e}}if(this.R){A=!0;let ts;for(;!this.K&&this.C<se.length;)if(ts=La(this,se),ts==vn){Gt==4&&(this.m=4,Ft(14),A=!1),An(this.i,this.l,null,"[Incomplete Response]");break}else if(ts==Xn){this.m=4,Ft(15),An(this.i,this.l,se,"[Invalid Chunk]"),A=!1;break}else An(this.i,this.l,ts,null),il(this,ts);if(ur(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||se.length!=0||this.h.h||(this.m=1,Ft(16),A=!1),this.o=this.o&&A,!A)An(this.i,this.l,se,"[Invalid Chunked Response]"),si(this),To(this);else if(se.length>0&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.aa&&!it.P&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+se.length),Kf(it),it.P=!0,Ft(11))}}else An(this.i,this.l,se,null),il(this,se);Gt==4&&si(this),this.o&&!this.K&&(Gt==4?fa(this.j,this):(this.o=!1,vi(this)))}else Ul(this.g),J==400&&se.indexOf("Unknown SID")>0?(this.m=3,Ft(12)):(this.m=0,Ft(13)),si(this),To(this)}}}catch{}finally{}};function Bn(A){if(!ur(A))return A.g.la();const J=Nc(A.g);if(J==="")return"";let se="";const he=J.length,Ie=Ci(A.g)==4;if(!A.h.i){if(typeof TextDecoder>"u")return si(A),To(A),"";A.h.i=new a.TextDecoder}for(let Oe=0;Oe<he;Oe++)A.h.h=!0,se+=A.h.i.decode(J[Oe],{stream:!(Ie&&Oe==he-1)});return J.length=0,A.h.g+=se,A.C=0,A.h.g}function ur(A){return A.g?A.v=="GET"&&A.M!=2&&A.j.Aa:!1}function La(A,J){var se=A.C,he=J.indexOf(`
`,se);return he==-1?vn:(se=Number(J.substring(se,he)),isNaN(se)?Xn:(he+=1,he+se>J.length?vn:(J=J.slice(he,he+se),A.C=he+se,J)))}bn.prototype.cancel=function(){this.K=!0,si(this)};function vi(A){A.T=Date.now()+A.H,Is(A,A.H)}function Is(A,J){if(A.D!=null)throw Error("WatchDog timer not null");A.D=Rn(c(A.aa,A),J)}function gs(A){A.D&&(a.clearTimeout(A.D),A.D=null)}bn.prototype.aa=function(){this.D=null;const A=Date.now();A-this.T>=0?(bi(this.i,this.B),this.M!=2&&(ms(),Ft(17)),si(this),this.m=2,To(this)):Is(this,this.T-A)};function To(A){A.j.I==0||A.K||fa(A.j,A)}function si(A){gs(A);var J=A.O;J&&typeof J.dispose=="function"&&J.dispose(),A.O=null,Tt(A.V),A.g&&(J=A.g,A.g=null,J.abort(),J.dispose())}function il(A,J){try{var se=A.j;if(se.I!=0&&(se.g==A||Pa(se.h,A))){if(!A.L&&Pa(se.h,A)&&se.I==3){try{var he=se.Ba.g.parse(J)}catch{he=null}if(Array.isArray(he)&&he.length==3){var Ie=he;if(Ie[0]==0){e:if(!se.v){if(se.g)if(se.g.F+3e3<A.F)Hh(se),cl(se);else break e;qf(se),Ft(18)}}else se.xa=Ie[1],0<se.xa-se.K&&Ie[2]<37500&&se.F&&se.A==0&&!se.C&&(se.C=Rn(c(se.Va,se),6e3));_i(se.h)<=1&&se.ta&&(se.ta=void 0)}else ul(se,11)}else if((A.L||se.g==A)&&Hh(se),!P(J))for(Ie=se.Ba.g.parse(J),J=0;J<Ie.length;J++){let hr=Ie[J];const ts=hr[0];if(!(ts<=se.K))if(se.K=ts,hr=hr[1],se.I==2)if(hr[0]=="c"){se.M=hr[1],se.ba=hr[2];const za=hr[3];za!=null&&(se.ka=za,se.j.info("VER="+se.ka));const io=hr[4];io!=null&&(se.za=io,se.j.info("SVER="+se.za));const ja=hr[5];ja!=null&&typeof ja=="number"&&ja>0&&(he=1.5*ja,se.O=he,se.j.info("backChannelRequestTimeoutMs_="+he)),he=se;const Do=A.g;if(Do){const $o=Do.g?Do.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($o){var Oe=he.h;Oe.g||$o.indexOf("spdy")==-1&&$o.indexOf("quic")==-1&&$o.indexOf("h2")==-1||(Oe.j=Oe.l,Oe.g=new Set,Oe.h&&(la(Oe,Oe.h),Oe.h=null))}if(he.G){const Xh=Do.g?Do.g.getResponseHeader("X-HTTP-Session-Id"):null;Xh&&(he.wa=Xh,yt(he.J,he.G,Xh))}}se.I=3,se.l&&se.l.ra(),se.aa&&(se.T=Date.now()-A.F,se.j.info("Handshake RTT: "+se.T+"ms")),he=se;var it=A;if(he.na=Xf(he,he.L?he.ba:null,he.W),it.L){ca(he.h,it);var Gt=it,$n=he.O;$n&&(Gt.H=$n),Gt.D&&(gs(Gt),vi(Gt)),he.g=it}else Wf(he);se.i.length>0&&Io(se)}else hr[0]!="stop"&&hr[0]!="close"||ul(se,7);else se.I==3&&(hr[0]=="stop"||hr[0]=="close"?hr[0]=="stop"?ul(se,7):dn(se):hr[0]!="noop"&&se.l&&se.l.qa(hr),se.A=0)}}ms(4)}catch{}}var Lu=class{constructor(A,J){this.g=A,this.map=J}};function Co(A){this.l=A||10,a.PerformanceNavigationTiming?(A=a.performance.getEntriesByType("navigation"),A=A.length>0&&(A[0].nextHopProtocol=="hq"||A[0].nextHopProtocol=="h2")):A=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=A?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ao(A){return A.h?!0:A.g?A.g.size>=A.j:!1}function _i(A){return A.h?1:A.g?A.g.size:0}function Pa(A,J){return A.h?A.h==J:A.g?A.g.has(J):!1}function la(A,J){A.g?A.g.add(J):A.h=J}function ca(A,J){A.h&&A.h==J?A.h=null:A.g&&A.g.has(J)&&A.g.delete(J)}Co.prototype.cancel=function(){if(this.i=No(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const A of this.g.values())A.cancel();this.g.clear()}};function No(A){if(A.h!=null)return A.i.concat(A.h.G);if(A.g!=null&&A.g.size!==0){let J=A.i;for(const se of A.g.values())J=J.concat(se.G);return J}return x(A.i)}var ua=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _n(A,J){if(A){A=A.split("&");for(let se=0;se<A.length;se++){const he=A[se].indexOf("=");let Ie,Oe=null;he>=0?(Ie=A[se].substring(0,he),Oe=A[se].substring(he+1)):Ie=A[se],J(Ie,Oe?decodeURIComponent(Oe.replace(/\+/g," ")):"")}}}function Nn(A){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let J;A instanceof Nn?(this.l=A.l,Oa(this,A.j),this.o=A.o,this.g=A.g,so(this,A.u),this.h=A.h,al(this,Ou(A.i)),this.m=A.m):A&&(J=String(A).match(ua))?(this.l=!1,Oa(this,J[1]||"",!0),this.o=zl(J[2]||""),this.g=zl(J[3]||"",!0),so(this,J[4]),this.h=zl(J[5]||"",!0),al(this,J[6]||"",!0),this.m=zl(J[7]||"")):(this.l=!1,this.i=new Ei(null,this.l))}Nn.prototype.toString=function(){const A=[];var J=this.j;J&&A.push(ls(J,Hf,!0),":");var se=this.g;return(se||J=="file")&&(A.push("//"),(J=this.o)&&A.push(ls(J,Hf,!0),"@"),A.push(dt(se).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),se=this.u,se!=null&&A.push(":",String(se))),(se=this.h)&&(this.g&&se.charAt(0)!="/"&&A.push("/"),A.push(ls(se,se.charAt(0)=="/"?ha:Ec,!0))),(se=this.i.toString())&&A.push("?",se),(se=this.m)&&A.push("#",ls(se,ol)),A.join("")},Nn.prototype.resolve=function(A){const J=Tr(this);let se=!!A.j;se?Oa(J,A.j):se=!!A.o,se?J.o=A.o:se=!!A.g,se?J.g=A.g:se=A.u!=null;var he=A.h;if(se)so(J,A.u);else if(se=!!A.h){if(he.charAt(0)!="/")if(this.g&&!this.h)he="/"+he;else{var Ie=J.h.lastIndexOf("/");Ie!=-1&&(he=J.h.slice(0,Ie+1)+he)}if(Ie=he,Ie==".."||Ie==".")he="";else if(Ie.indexOf("./")!=-1||Ie.indexOf("/.")!=-1){he=Ie.lastIndexOf("/",0)==0,Ie=Ie.split("/");const Oe=[];for(let it=0;it<Ie.length;){const Gt=Ie[it++];Gt=="."?he&&it==Ie.length&&Oe.push(""):Gt==".."?((Oe.length>1||Oe.length==1&&Oe[0]!="")&&Oe.pop(),he&&it==Ie.length&&Oe.push("")):(Oe.push(Gt),he=!0)}he=Oe.join("/")}else he=Ie}return se?J.h=he:se=A.i.toString()!=="",se?al(J,Ou(A.i)):se=!!A.m,se&&(J.m=A.m),J};function Tr(A){return new Nn(A)}function Oa(A,J,se){A.j=se?zl(J,!0):J,A.j&&(A.j=A.j.replace(/:$/,""))}function so(A,J){if(J){if(J=Number(J),isNaN(J)||J<0)throw Error("Bad port number "+J);A.u=J}else A.u=null}function al(A,J,se){J instanceof Ei?(A.i=J,Mu(A.i,A.l)):(se||(J=ls(J,qr)),A.i=new Ei(J,A.l))}function yt(A,J,se){A.i.set(J,se)}function xr(A){return yt(A,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),A}function zl(A,J){return A?J?decodeURI(A.replace(/%25/g,"%2525")):decodeURIComponent(A):""}function ls(A,J,se){return typeof A=="string"?(A=encodeURI(A).replace(J,wi),se&&(A=A.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A):null}function wi(A){return A=A.charCodeAt(0),"%"+(A>>4&15).toString(16)+(A&15).toString(16)}var Hf=/[#\/\?@]/g,Ec=/[#\?:]/g,ha=/[#\?]/g,qr=/[#\?@]/g,ol=/#/g;function Ei(A,J){this.h=this.g=null,this.i=A||null,this.j=!!J}function Ma(A){A.g||(A.g=new Map,A.h=0,A.i&&_n(A.i,function(J,se){A.add(decodeURIComponent(J.replace(/\+/g," ")),se)}))}n=Ei.prototype,n.add=function(A,J){Ma(this),this.i=null,A=Fa(this,A);let se=this.g.get(A);return se||this.g.set(A,se=[]),se.push(J),this.h+=1,this};function Pu(A,J){Ma(A),J=Fa(A,J),A.g.has(J)&&(A.i=null,A.h-=A.g.get(J).length,A.g.delete(J))}function jl(A,J){return Ma(A),J=Fa(A,J),A.g.has(J)}n.forEach=function(A,J){Ma(this),this.g.forEach(function(se,he){se.forEach(function(Ie){A.call(J,Ie,he,this)},this)},this)};function Sc(A,J){Ma(A);let se=[];if(typeof J=="string")jl(A,J)&&(se=se.concat(A.g.get(Fa(A,J))));else for(A=Array.from(A.g.values()),J=0;J<A.length;J++)se=se.concat(A[J]);return se}n.set=function(A,J){return Ma(this),this.i=null,A=Fa(this,A),jl(this,A)&&(this.h-=this.g.get(A).length),this.g.set(A,[J]),this.h+=1,this},n.get=function(A,J){return A?(A=Sc(this,A),A.length>0?String(A[0]):J):J};function jh(A,J,se){Pu(A,J),se.length>0&&(A.i=null,A.g.set(Fa(A,J),x(se)),A.h+=se.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const A=[],J=Array.from(this.g.keys());for(let he=0;he<J.length;he++){var se=J[he];const Ie=dt(se);se=Sc(this,se);for(let Oe=0;Oe<se.length;Oe++){let it=Ie;se[Oe]!==""&&(it+="="+dt(se[Oe])),A.push(it)}}return this.i=A.join("&")};function Ou(A){const J=new Ei;return J.i=A.i,A.g&&(J.g=new Map(A.g),J.h=A.h),J}function Fa(A,J){return J=String(J),A.j&&(J=J.toLowerCase()),J}function Mu(A,J){J&&!A.j&&(Ma(A),A.i=null,A.g.forEach(function(se,he){const Ie=he.toLowerCase();he!=Ie&&(Pu(this,he),jh(this,Ie,se))},A)),A.j=J}function Tc(A,J){const se=new Dn;if(a.Image){const he=new Image;he.onload=u(ii,se,"TestLoadImage: loaded",!0,J,he),he.onerror=u(ii,se,"TestLoadImage: error",!1,J,he),he.onabort=u(ii,se,"TestLoadImage: abort",!1,J,he),he.ontimeout=u(ii,se,"TestLoadImage: timeout",!1,J,he),a.setTimeout(function(){he.ontimeout&&he.ontimeout()},1e4),he.src=A}else J(!1)}function Vl(A,J){const se=new Dn,he=new AbortController,Ie=setTimeout(()=>{he.abort(),ii(se,"TestPingServer: timeout",!1,J)},1e4);fetch(A,{signal:he.signal}).then(Oe=>{clearTimeout(Ie),Oe.ok?ii(se,"TestPingServer: ok",!0,J):ii(se,"TestPingServer: server error",!1,J)}).catch(()=>{clearTimeout(Ie),ii(se,"TestPingServer: error",!1,J)})}function ii(A,J,se,he,Ie){try{Ie&&(Ie.onload=null,Ie.onerror=null,Ie.onabort=null,Ie.ontimeout=null),he(se)}catch{}}function Um(){this.g=new Cn}function Ut(A){this.i=A.Sb||null,this.h=A.ab||!1}d(Ut,Br),Ut.prototype.g=function(){return new Si(this.i,this.h)};function Si(A,J){en.call(this),this.H=A,this.o=J,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(Si,en),n=Si.prototype,n.open=function(A,J){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=A,this.D=J,this.readyState=1,ko(this)},n.send=function(A){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const J={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};A&&(J.body=A),(this.H||a).fetch(new Request(this.D,J)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ti(this)),this.readyState=0},n.Pa=function(A){if(this.g&&(this.l=A,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=A.headers,this.readyState=2,ko(this)),this.g&&(this.readyState=3,ko(this),this.g)))if(this.responseType==="arraybuffer")A.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in A){if(this.j=A.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Yn(this)}else A.text().then(this.Oa.bind(this),this.ga.bind(this))};function Yn(A){A.j.read().then(A.Ma.bind(A)).catch(A.ga.bind(A))}n.Ma=function(A){if(this.g){if(this.o&&A.value)this.response.push(A.value);else if(!this.o){var J=A.value?A.value:new Uint8Array(0);(J=this.B.decode(J,{stream:!A.done}))&&(this.response=this.responseText+=J)}A.done?Ti(this):ko(this),this.readyState==3&&Yn(this)}},n.Oa=function(A){this.g&&(this.response=this.responseText=A,Ti(this))},n.Na=function(A){this.g&&(this.response=A,Ti(this))},n.ga=function(){this.g&&Ti(this)};function Ti(A){A.readyState=4,A.l=null,A.j=null,A.B=null,ko(A)}n.setRequestHeader=function(A,J){this.A.append(A,J)},n.getResponseHeader=function(A){return this.h&&this.h.get(A.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const A=[],J=this.h.entries();for(var se=J.next();!se.done;)se=se.value,A.push(se[0]+": "+se[1]),se=J.next();return A.join(`\r
`)};function ko(A){A.onreadystatechange&&A.onreadystatechange.call(A)}Object.defineProperty(Si.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(A){this.m=A?"include":"same-origin"}});function ll(A){let J="";return ne(A,function(se,he){J+=he,J+=":",J+=se,J+=`\r
`}),J}function da(A,J,se){e:{for(he in se){var he=!1;break e}he=!0}he||(se=ll(se),typeof A=="string"?se!=null&&dt(se):yt(A,J,se))}function rr(A){en.call(this),this.headers=new Map,this.L=A||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(rr,en);var Cc=/^https?$/i,Ac=["POST","PUT"];n=rr.prototype,n.Fa=function(A){this.H=A},n.ea=function(A,J,se,he){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+A);J=J?J.toUpperCase():"GET",this.D=A,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():nn.g(),this.g.onreadystatechange=p(c(this.Ca,this));try{this.B=!0,this.g.open(J,String(A),!0),this.B=!1}catch(Oe){Kr(this,Oe);return}if(A=se||"",se=new Map(this.headers),he)if(Object.getPrototypeOf(he)===Object.prototype)for(var Ie in he)se.set(Ie,he[Ie]);else if(typeof he.keys=="function"&&typeof he.get=="function")for(const Oe of he.keys())se.set(Oe,he.get(Oe));else throw Error("Unknown input type for opt_headers: "+String(he));he=Array.from(se.keys()).find(Oe=>Oe.toLowerCase()=="content-type"),Ie=a.FormData&&A instanceof a.FormData,!(Array.prototype.indexOf.call(Ac,J,void 0)>=0)||he||Ie||se.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Oe,it]of se)this.g.setRequestHeader(Oe,it);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(A),this.v=!1}catch(Oe){Kr(this,Oe)}};function Kr(A,J){A.h=!1,A.g&&(A.j=!0,A.g.abort(),A.j=!1),A.l=J,A.o=5,Ba(A),xs(A)}function Ba(A){A.A||(A.A=!0,ht(A,"complete"),ht(A,"error"))}n.abort=function(A){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=A||7,ht(this,"complete"),ht(this,"abort"),xs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xs(this,!0)),rr.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Vh(this):this.Xa())},n.Xa=function(){Vh(this)};function Vh(A){if(A.h&&typeof i<"u"){if(A.v&&Ci(A)==4)setTimeout(A.Ca.bind(A),0);else if(ht(A,"readystatechange"),Ci(A)==4){A.h=!1;try{const Oe=A.ca();e:switch(Oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var J=!0;break e;default:J=!1}var se;if(!(se=J)){var he;if(he=Oe===0){let it=String(A.D).match(ua)[1]||null;!it&&a.self&&a.self.location&&(it=a.self.location.protocol.slice(0,-1)),he=!Cc.test(it?it.toLowerCase():"")}se=he}if(se)ht(A,"complete"),ht(A,"success");else{A.o=6;try{var Ie=Ci(A)>2?A.g.statusText:""}catch{Ie=""}A.l=Ie+" ["+A.ca()+"]",Ba(A)}}finally{xs(A)}}}}function xs(A,J){if(A.g){A.m&&(clearTimeout(A.m),A.m=null);const se=A.g;A.g=null,J||ht(A,"ready");try{se.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ci(A){return A.g?A.g.readyState:0}n.ca=function(){try{return Ci(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(A){if(this.g){var J=this.g.responseText;return A&&J.indexOf(A)==0&&(J=J.substring(A.length)),Bt(J)}};function Nc(A){try{if(!A.g)return null;if("response"in A.g)return A.g.response;switch(A.F){case"":case"text":return A.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in A.g)return A.g.mozResponseArrayBuffer}return null}catch{return null}}function Ul(A){const J={};A=(A.g&&Ci(A)>=2&&A.g.getAllResponseHeaders()||"").split(`\r
`);for(let he=0;he<A.length;he++){if(P(A[he]))continue;var se=cr(A[he]);const Ie=se[0];if(se=se[1],typeof se!="string")continue;se=se.trim();const Oe=J[Ie]||[];J[Ie]=Oe,Oe.push(se)}Q(J,function(he){return he.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fu(A,J,se){return se&&se.internalChannelParams&&se.internalChannelParams[A]||J}function Bu(A){this.za=0,this.i=[],this.j=new Dn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Fu("failFast",!1,A),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Fu("baseRetryDelayMs",5e3,A),this.Za=Fu("retryDelaySeedMs",1e4,A),this.Ta=Fu("forwardChannelMaxRetries",2,A),this.va=Fu("forwardChannelRequestTimeoutMs",2e4,A),this.ma=A&&A.xmlHttpFactory||void 0,this.Ua=A&&A.Rb||void 0,this.Aa=A&&A.useFetchStreams||!1,this.O=void 0,this.L=A&&A.supportsCrossDomainXhr||!1,this.M="",this.h=new Co(A&&A.concurrentRequestLimit),this.Ba=new Um,this.S=A&&A.fastHandshake||!1,this.R=A&&A.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=A&&A.Pb||!1,A&&A.ua&&this.j.ua(),A&&A.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&A&&A.detectBufferingProxy||!1,this.ia=void 0,A&&A.longPollingTimeout&&A.longPollingTimeout>0&&(this.ia=A.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Bu.prototype,n.ka=8,n.I=1,n.connect=function(A,J,se,he){Ft(0),this.W=A,this.H=J||{},se&&he!==void 0&&(this.H.OSID=se,this.H.OAID=he),this.F=this.X,this.J=Xf(this,null,this.W),Io(this)};function dn(A){if(ai(A),A.I==3){var J=A.V++,se=Tr(A.J);if(yt(se,"SID",A.M),yt(se,"RID",J),yt(se,"TYPE","terminate"),Gl(A,se),J=new bn(A,A.j,J),J.M=2,J.A=xr(Tr(se)),se=!1,a.navigator&&a.navigator.sendBeacon)try{se=a.navigator.sendBeacon(J.A.toString(),"")}catch{}!se&&a.Image&&(new Image().src=J.A,se=!0),se||(J.g=zu(J.j,null),J.g.ea(J.A)),J.F=Date.now(),vi(J)}Ro(A)}function cl(A){A.g&&(Kf(A),A.g.cancel(),A.g=null)}function ai(A){cl(A),A.v&&(a.clearTimeout(A.v),A.v=null),Hh(A),A.h.cancel(),A.m&&(typeof A.m=="number"&&a.clearTimeout(A.m),A.m=null)}function Io(A){if(!Ao(A.h)&&!A.m){A.m=!0;var J=A.Ea;$||F(),q||($(),q=!0),U.add(J,A),A.D=0}}function Gm(A,J){return _i(A.h)>=A.h.j-(A.m?1:0)?!1:A.m?(A.i=J.G.concat(A.i),!0):A.I==1||A.I==2||A.D>=(A.Sa?0:A.Ta)?!1:(A.m=Rn(c(A.Ea,A,J),Wm(A,A.D)),A.D++,!0)}n.Ea=function(A){if(this.m)if(this.m=null,this.I==1){if(!A){this.V=Math.floor(Math.random()*1e5),A=this.V++;const Ie=new bn(this,this.j,A);let Oe=this.o;if(this.U&&(Oe?(Oe=z(Oe),X(Oe,this.U)):Oe=this.U),this.u!==null||this.R||(Ie.J=Oe,Oe=null),this.S)e:{for(var J=0,se=0;se<this.i.length;se++){t:{var he=this.i[se];if("__data__"in he.map&&(he=he.map.__data__,typeof he=="string")){he=he.length;break t}he=void 0}if(he===void 0)break;if(J+=he,J>4096){J=se;break e}if(J===4096||se===this.i.length-1){J=se+1;break e}}J=1e3}else J=1e3;J=Uh(this,Ie,J),se=Tr(this.J),yt(se,"RID",A),yt(se,"CVER",22),this.G&&yt(se,"X-HTTP-Session-Id",this.G),Gl(this,se),Oe&&(this.R?J="headers="+dt(ll(Oe))+"&"+J:this.u&&da(se,this.u,Oe)),la(this.h,Ie),this.Ra&&yt(se,"TYPE","init"),this.S?(yt(se,"$req",J),yt(se,"SID","null"),Ie.U=!0,ks(Ie,se,null)):ks(Ie,se,J),this.I=2}}else this.I==3&&(A?Hm(this,A):this.i.length==0||Ao(this.h)||Hm(this))};function Hm(A,J){var se;J?se=J.l:se=A.V++;const he=Tr(A.J);yt(he,"SID",A.M),yt(he,"RID",se),yt(he,"AID",A.K),Gl(A,he),A.u&&A.o&&da(he,A.u,A.o),se=new bn(A,A.j,se,A.D+1),A.u===null&&(se.J=A.o),J&&(A.i=J.G.concat(A.i)),J=Uh(A,se,1e3),se.H=Math.round(A.va*.5)+Math.round(A.va*.5*Math.random()),la(A.h,se),ks(se,he,J)}function Gl(A,J){A.H&&ne(A.H,function(se,he){yt(J,he,se)}),A.l&&ne({},function(se,he){yt(J,he,se)})}function Uh(A,J,se){se=Math.min(A.i.length,se);const he=A.l?c(A.l.Ka,A.l,A):null;e:{var Ie=A.i;let Gt=-1;for(;;){const $n=["count="+se];Gt==-1?se>0?(Gt=Ie[0].g,$n.push("ofs="+Gt)):Gt=0:$n.push("ofs="+Gt);let hr=!0;for(let ts=0;ts<se;ts++){var Oe=Ie[ts].g;const za=Ie[ts].map;if(Oe-=Gt,Oe<0)Gt=Math.max(0,Ie[ts].g-100),hr=!1;else try{Oe="req"+Oe+"_"||"";try{var it=za instanceof Map?za:Object.entries(za);for(const[io,ja]of it){let Do=ja;o(ja)&&(Do=nr(ja)),$n.push(Oe+io+"="+encodeURIComponent(Do))}}catch(io){throw $n.push(Oe+"type="+encodeURIComponent("_badmap")),io}}catch{he&&he(za)}}if(hr){it=$n.join("&");break e}}it=void 0}return A=A.i.splice(0,se),J.G=A,it}function Wf(A){if(!A.g&&!A.v){A.Y=1;var J=A.Da;$||F(),q||($(),q=!0),U.add(J,A),A.A=0}}function qf(A){return A.g||A.v||A.A>=3?!1:(A.Y++,A.v=Rn(c(A.Da,A),Wm(A,A.A)),A.A++,!0)}n.Da=function(){if(this.v=null,Gh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var A=4*this.T;this.j.info("BP detection timer enabled: "+A),this.B=Rn(c(this.Wa,this),A)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ft(10),cl(this),Gh(this))};function Kf(A){A.B!=null&&(a.clearTimeout(A.B),A.B=null)}function Gh(A){A.g=new bn(A,A.j,"rpc",A.Y),A.u===null&&(A.g.J=A.o),A.g.P=0;var J=Tr(A.na);yt(J,"RID","rpc"),yt(J,"SID",A.M),yt(J,"AID",A.K),yt(J,"CI",A.F?"0":"1"),!A.F&&A.ia&&yt(J,"TO",A.ia),yt(J,"TYPE","xmlhttp"),Gl(A,J),A.u&&A.o&&da(J,A.u,A.o),A.O&&(A.g.H=A.O);var se=A.g;A=A.ba,se.M=1,se.A=xr(Tr(J)),se.u=null,se.R=!0,mn(se,A)}n.Va=function(){this.C!=null&&(this.C=null,cl(this),qf(this),Ft(19))};function Hh(A){A.C!=null&&(a.clearTimeout(A.C),A.C=null)}function fa(A,J){var se=null;if(A.g==J){Hh(A),Kf(A),A.g=null;var he=2}else if(Pa(A.h,J))se=J.G,ca(A.h,J),he=1;else return;if(A.I!=0){if(J.o)if(he==1){se=J.u?J.u.length:0,J=Date.now()-J.F;var Ie=A.D;he=Mn(),ht(he,new oa(he,se)),Io(A)}else Wf(A);else if(Ie=J.m,Ie==3||Ie==0&&J.X>0||!(he==1&&Gm(A,J)||he==2&&qf(A)))switch(se&&se.length>0&&(J=A.h,J.i=J.i.concat(se)),Ie){case 1:ul(A,5);break;case 4:ul(A,10);break;case 3:ul(A,6);break;default:ul(A,2)}}}function Wm(A,J){let se=A.Qa+Math.floor(Math.random()*A.Za);return A.isActive()||(se*=2),se*J}function ul(A,J){if(A.j.info("Error code "+J),J==2){var se=c(A.bb,A),he=A.Ua;const Ie=!he;he=new Nn(he||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Oa(he,"https"),xr(he),Ie?Tc(he.toString(),se):Vl(he.toString(),se)}else Ft(2);A.I=0,A.l&&A.l.pa(J),Ro(A),ai(A)}n.bb=function(A){A?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function Ro(A){if(A.I=0,A.ja=[],A.l){const J=No(A.h);(J.length!=0||A.i.length!=0)&&(y(A.ja,J),y(A.ja,A.i),A.h.i.length=0,x(A.i),A.i.length=0),A.l.oa()}}function Xf(A,J,se){var he=se instanceof Nn?Tr(se):new Nn(se);if(he.g!="")J&&(he.g=J+"."+he.g),so(he,he.u);else{var Ie=a.location;he=Ie.protocol,J=J?J+"."+Ie.hostname:Ie.hostname,Ie=+Ie.port;const Oe=new Nn(null);he&&Oa(Oe,he),J&&(Oe.g=J),Ie&&so(Oe,Ie),se&&(Oe.h=se),he=Oe}return se=A.G,J=A.wa,se&&J&&yt(he,se,J),yt(he,"VER",A.ka),Gl(A,he),he}function zu(A,J,se){if(J&&!A.L)throw Error("Can't create secondary domain capable XhrIo object.");return J=A.Aa&&!A.ma?new rr(new Ut({ab:se})):new rr(A.ma),J.Fa(A.L),J}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wh(){}n=Wh.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function qh(){}qh.prototype.g=function(A,J){return new Ai(A,J)};function Ai(A,J){en.call(this),this.g=new Bu(J),this.l=A,this.h=J&&J.messageUrlParams||null,A=J&&J.messageHeaders||null,J&&J.clientProtocolHeaderRequired&&(A?A["X-Client-Protocol"]="webchannel":A={"X-Client-Protocol":"webchannel"}),this.g.o=A,A=J&&J.initMessageHeaders||null,J&&J.messageContentType&&(A?A["X-WebChannel-Content-Type"]=J.messageContentType:A={"X-WebChannel-Content-Type":J.messageContentType}),J&&J.sa&&(A?A["X-WebChannel-Client-Profile"]=J.sa:A={"X-WebChannel-Client-Profile":J.sa}),this.g.U=A,(A=J&&J.Qb)&&!P(A)&&(this.g.u=A),this.A=J&&J.supportsCrossDomainXhr||!1,this.v=J&&J.sendRawJson||!1,(J=J&&J.httpSessionIdParam)&&!P(J)&&(this.g.G=J,A=this.h,A!==null&&J in A&&(A=this.h,J in A&&delete A[J])),this.j=new kc(this)}d(Ai,en),Ai.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ai.prototype.close=function(){dn(this.g)},Ai.prototype.o=function(A){var J=this.g;if(typeof A=="string"){var se={};se.__data__=A,A=se}else this.v&&(se={},se.__data__=nr(A),A=se);J.i.push(new Lu(J.Ya++,A)),J.I==3&&Io(J)},Ai.prototype.N=function(){this.g.l=null,delete this.j,dn(this.g),delete this.g,Ai.Z.N.call(this)};function Kh(A){Wr.call(this),A.__headers__&&(this.headers=A.__headers__,this.statusCode=A.__status__,delete A.__headers__,delete A.__status__);var J=A.__sm__;if(J){e:{for(const se in J){A=se;break e}A=void 0}(this.i=A)&&(A=this.i,J=J!==null&&A in J?J[A]:void 0),this.data=J}else this.data=A}d(Kh,Wr);function qm(){rn.call(this),this.status=1}d(qm,rn);function kc(A){this.g=A}d(kc,Wh),kc.prototype.ra=function(){ht(this.g,"a")},kc.prototype.qa=function(A){ht(this.g,new Kh(A))},kc.prototype.pa=function(A){ht(this.g,new qm)},kc.prototype.oa=function(){ht(this.g,"b")},qh.prototype.createWebChannel=qh.prototype.g,Ai.prototype.send=Ai.prototype.o,Ai.prototype.open=Ai.prototype.m,Ai.prototype.close=Ai.prototype.close,_z=function(){return new qh},vz=function(){return Mn()},bz=hn,Zk={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},zt.NO_ERROR=0,zt.TIMEOUT=8,zt.HTTP_ERROR=6,Cw=zt,pn.COMPLETE="complete",yz=pn,xn.EventType=tn,tn.OPEN="a",tn.CLOSE="b",tn.ERROR="c",tn.MESSAGE="d",en.prototype.listen=en.prototype.J,vy=xn,rr.prototype.listenOnce=rr.prototype.K,rr.prototype.getLastError=rr.prototype.Ha,rr.prototype.getLastErrorCode=rr.prototype.ya,rr.prototype.getStatus=rr.prototype.ca,rr.prototype.getResponseJson=rr.prototype.La,rr.prototype.getResponseText=rr.prototype.la,rr.prototype.send=rr.prototype.ea,rr.prototype.setWithCredentials=rr.prototype.Fa,xz=rr}).apply(typeof H_<"u"?H_:typeof self<"u"?self:typeof window<"u"?window:{});const zM="@firebase/firestore",jM="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ya.UNAUTHENTICATED=new ya(null),ya.GOOGLE_CREDENTIALS=new ya("google-credentials-uid"),ya.FIRST_PARTY=new ya("first-party-uid"),ya.MOCK_USER=new ya("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fg="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp=new X3("@firebase/firestore");function I0(){return Xp.logLevel}function bt(n,...e){if(Xp.logLevel<=Un.DEBUG){const t=e.map(o4);Xp.debug(`Firestore (${Fg}): ${n}`,...t)}}function Th(n,...e){if(Xp.logLevel<=Un.ERROR){const t=e.map(o4);Xp.error(`Firestore (${Fg}): ${n}`,...t)}}function ug(n,...e){if(Xp.logLevel<=Un.WARN){const t=e.map(o4);Xp.warn(`Firestore (${Fg}): ${n}`,...t)}}function o4(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xt(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,wz(n,r,t)}function wz(n,e,t){let r=`FIRESTORE (${Fg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Th(r),new Error(r)}function vr(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||wz(e,s,r)}function un(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class gt extends Ru{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ez{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class bce{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ya.UNAUTHENTICATED)))}shutdown(){}}class vce{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class _ce{constructor(e){this.t=e,this.currentUser=ya.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){vr(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new yh;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new yh,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},o=l=>{bt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(bt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new yh)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(bt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(vr(typeof r.accessToken=="string",31837,{l:r}),new Ez(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return vr(e===null||typeof e=="string",2055,{h:e}),new ya(e)}}class wce{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=ya.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Ece{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new wce(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ya.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class VM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Sce{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ko(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){vr(this.o===void 0,3512);const r=i=>{i.error!=null&&bt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,bt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{bt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):bt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new VM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(vr(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new VM(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tce(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Tce(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function Gn(n,e){return n<e?-1:n>e?1:0}function Qk(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return kN(s)===kN(i)?Gn(s,i):kN(s)?1:-1}return Gn(n.length,e.length)}const Cce=55296,Ace=57343;function kN(n){const e=n.charCodeAt(0);return e>=Cce&&e<=Ace}function hg(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UM="__name__";class jc{constructor(e,t,r){t===void 0?t=0:t>e.length&&Xt(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Xt(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return jc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof jc?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=jc.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return Gn(e.length,t.length)}static compareSegments(e,t){const r=jc.isNumericId(e),s=jc.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?jc.extractNumericId(e).compare(jc.extractNumericId(t)):Qk(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xd.fromString(e.substring(4,e.length-2))}}class Vr extends jc{construct(e,t,r){return new Vr(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new gt(Xe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new Vr(t)}static emptyPath(){return new Vr([])}}const Nce=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ki extends jc{construct(e,t,r){return new Ki(e,t,r)}static isValidIdentifier(e){return Nce.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ki.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===UM}static keyField(){return new Ki([UM])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new gt(Xe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new gt(Xe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new gt(Xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(r+=o,s++):(i(),s++)}if(i(),a)throw new gt(Xe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ki(t)}static emptyPath(){return new Ki([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.path=e}static fromPath(e){return new Lt(Vr.fromString(e))}static fromName(e){return new Lt(Vr.fromString(e).popFirst(5))}static empty(){return new Lt(Vr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Vr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Vr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Lt(new Vr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sz(n,e,t){if(!t)throw new gt(Xe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function kce(n,e,t,r){if(e===!0&&r===!0)throw new gt(Xe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function GM(n){if(!Lt.isDocumentKey(n))throw new gt(Xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function HM(n){if(Lt.isDocumentKey(n))throw new gt(Xe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Tz(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function pS(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Xt(12329,{type:typeof n})}function gu(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new gt(Xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=pS(n);throw new gt(Xe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(n,e){const t={typeString:n};return e&&(t.value=e),t}function X1(n,e){if(!Tz(n))throw new gt(Xe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new gt(Xe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WM=-62135596800,qM=1e6;class Xr{static now(){return Xr.fromMillis(Date.now())}static fromDate(e){return Xr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*qM);return new Xr(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new gt(Xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new gt(Xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<WM)throw new gt(Xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new gt(Xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/qM}_compareTo(e){return this.seconds===e.seconds?Gn(this.nanoseconds,e.nanoseconds):Gn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Xr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(X1(e,Xr._jsonSchema))return new Xr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-WM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Xr._jsonSchemaVersion="firestore/timestamp/1.0",Xr._jsonSchema={type:Ys("string",Xr._jsonSchemaVersion),seconds:Ys("number"),nanoseconds:Ys("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{static fromTimestamp(e){return new sn(e)}static min(){return new sn(new Xr(0,0))}static max(){return new sn(new Xr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1=-1;function Ice(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=sn.fromTimestamp(r===1e9?new Xr(t+1,0):new Xr(t,r));return new rf(s,Lt.empty(),e)}function Rce(n){return new rf(n.readTime,n.key,e1)}class rf{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new rf(sn.min(),Lt.empty(),e1)}static max(){return new rf(sn.max(),Lt.empty(),e1)}}function Dce(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Lt.comparator(n.documentKey,e.documentKey),t!==0?t:Gn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $ce="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Lce{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bg(n){if(n.code!==Xe.FAILED_PRECONDITION||n.message!==$ce)throw n;bt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Xt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Qe(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Qe?t:Qe.resolve(t)}catch(t){return Qe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Qe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Qe.reject(t)}static resolve(e){return new Qe(((t,r)=>{t(e)}))}static reject(e){return new Qe(((t,r)=>{r(e)}))}static waitFor(e){return new Qe(((t,r)=>{let s=0,i=0,a=!1;e.forEach((o=>{++s,o.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=Qe.resolve(!1);for(const r of e)t=t.next((s=>s?Qe.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new Qe(((r,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next((u=>{a[c]=u,++o,o===i&&r(a)}),(u=>s(u)))}}))}static doWhile(e,t){return new Qe(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function Pce(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function zg(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}mS.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4=-1;function gS(n){return n==null}function X2(n){return n===0&&1/n==-1/0}function Oce(n){return typeof n=="number"&&Number.isInteger(n)&&!X2(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cz="";function Mce(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=KM(e)),e=Fce(n.get(t),e);return KM(e)}function Fce(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case Cz:t+="";break;default:t+=i}}return t}function KM(n){return n+Cz+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Af(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Az(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,t){this.comparator=e,this.root=t||Wi.EMPTY}insert(e,t){return new ps(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wi.BLACK,null,null))}remove(e){return new ps(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new W_(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new W_(this.root,e,this.comparator,!1)}getReverseIterator(){return new W_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new W_(this.root,e,this.comparator,!0)}}class W_{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wi{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Wi.RED,this.left=s??Wi.EMPTY,this.right=i??Wi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Wi(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Wi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Wi.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Xt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Xt(27949);return e+(this.isRed()?0:1)}}Wi.EMPTY=null,Wi.RED=!0,Wi.BLACK=!1;Wi.EMPTY=new class{constructor(){this.size=0}get key(){throw Xt(57766)}get value(){throw Xt(16141)}get color(){throw Xt(16727)}get left(){throw Xt(29726)}get right(){throw Xt(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new Wi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e){this.comparator=e,this.data=new ps(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new YM(this.data.getIterator())}getIteratorFrom(e){return new YM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof gi)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new gi(this.comparator);return t.data=e,t}}class YM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e){this.fields=e,e.sort(Ki.comparator)}static empty(){return new Yo([])}unionWith(e){let t=new gi(Ki.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Yo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hg(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nz extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Nz("Invalid base64 string: "+i):i}})(e);return new Qi(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Qi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Gn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qi.EMPTY_BYTE_STRING=new Qi("");const Bce=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sf(n){if(vr(!!n,39018),typeof n=="string"){let e=0;const t=Bce.exec(n);if(vr(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ms(n.seconds),nanos:Ms(n.nanos)}}function Ms(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function af(n){return typeof n=="string"?Qi.fromBase64String(n):Qi.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kz="server_timestamp",Iz="__type__",Rz="__previous_value__",Dz="__local_write_time__";function u4(n){return(n?.mapValue?.fields||{})[Iz]?.stringValue===kz}function xS(n){const e=n.mapValue.fields[Rz];return u4(e)?xS(e):e}function t1(n){const e=sf(n.mapValue.fields[Dz].timestampValue);return new Xr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zce{constructor(e,t,r,s,i,a,o,l,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const Y2="(default)";class n1{constructor(e,t){this.projectId=e,this.database=t||Y2}static empty(){return new n1("","")}get isDefaultDatabase(){return this.database===Y2}isEqual(e){return e instanceof n1&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z="__type__",jce="__max__",q_={mapValue:{}},Lz="__vector__",Z2="value";function of(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?u4(n)?4:Uce(n)?9007199254740991:Vce(n)?10:11:Xt(28295,{value:n})}function xu(n,e){if(n===e)return!0;const t=of(n);if(t!==of(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return t1(n).isEqual(t1(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=sf(s.timestampValue),o=sf(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return af(s.bytesValue).isEqual(af(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return Ms(s.geoPointValue.latitude)===Ms(i.geoPointValue.latitude)&&Ms(s.geoPointValue.longitude)===Ms(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return Ms(s.integerValue)===Ms(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Ms(s.doubleValue),o=Ms(i.doubleValue);return a===o?X2(a)===X2(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return hg(n.arrayValue.values||[],e.arrayValue.values||[],xu);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(XM(a)!==XM(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!xu(a[l],o[l])))return!1;return!0})(n,e);default:return Xt(52216,{left:n})}}function r1(n,e){return(n.values||[]).find((t=>xu(t,e)))!==void 0}function dg(n,e){if(n===e)return 0;const t=of(n),r=of(e);if(t!==r)return Gn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Gn(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const o=Ms(i.integerValue||i.doubleValue),l=Ms(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return ZM(n.timestampValue,e.timestampValue);case 4:return ZM(t1(n),t1(e));case 5:return Qk(n.stringValue,e.stringValue);case 6:return(function(i,a){const o=af(i),l=af(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=Gn(o[c],l[c]);if(u!==0)return u}return Gn(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const o=Gn(Ms(i.latitude),Ms(a.latitude));return o!==0?o:Gn(Ms(i.longitude),Ms(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return QM(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const o=i.fields||{},l=a.fields||{},c=o[Z2]?.arrayValue,u=l[Z2]?.arrayValue,d=Gn(c?.values?.length||0,u?.values?.length||0);return d!==0?d:QM(c,u)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===q_.mapValue&&a===q_.mapValue)return 0;if(i===q_.mapValue)return 1;if(a===q_.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const p=Qk(l[d],u[d]);if(p!==0)return p;const x=dg(o[l[d]],c[u[d]]);if(x!==0)return x}return Gn(l.length,u.length)})(n.mapValue,e.mapValue);default:throw Xt(23264,{he:t})}}function ZM(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Gn(n,e);const t=sf(n),r=sf(e),s=Gn(t.seconds,r.seconds);return s!==0?s:Gn(t.nanos,r.nanos)}function QM(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=dg(t[s],r[s]);if(i)return i}return Gn(t.length,r.length)}function fg(n){return Jk(n)}function Jk(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=sf(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return af(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Lt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Jk(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Jk(t.fields[a])}`;return s+"}"})(n.mapValue):Xt(61005,{value:n})}function Aw(n){switch(of(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=xS(n);return e?16+Aw(e):16;case 5:return 2*n.stringValue.length;case 6:return af(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+Aw(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return Af(r.fields,((i,a)=>{s+=i.length+Aw(a)})),s})(n.mapValue);default:throw Xt(13486,{value:n})}}function JM(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function eI(n){return!!n&&"integerValue"in n}function h4(n){return!!n&&"arrayValue"in n}function e8(n){return!!n&&"nullValue"in n}function t8(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Nw(n){return!!n&&"mapValue"in n}function Vce(n){return(n?.mapValue?.fields||{})[$z]?.stringValue===Lz}function My(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Af(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=My(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=My(n.arrayValue.values[t]);return e}return{...n}}function Uce(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===jce}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this.value=e}static empty(){return new go({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Nw(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=My(t)}setAll(e){let t=Ki.emptyPath(),r={},s=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=o.popLast()}a?r[o.lastSegment()]=My(a):s.push(o.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Nw(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return xu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Nw(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Af(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new go(My(this.value))}}function Pz(n){const e=[];return Af(n.fields,((t,r)=>{const s=new Ki([t]);if(Nw(r)){const i=Pz(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Yo(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,t,r,s,i,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new va(e,0,sn.min(),sn.min(),sn.min(),go.empty(),0)}static newFoundDocument(e,t,r,s){return new va(e,1,t,sn.min(),r,s,0)}static newNoDocument(e,t){return new va(e,2,t,sn.min(),sn.min(),go.empty(),0)}static newUnknownDocument(e,t){return new va(e,3,t,sn.min(),sn.min(),go.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(sn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=go.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=go.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=sn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof va&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new va(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e,t){this.position=e,this.inclusive=t}}function n8(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=Lt.comparator(Lt.fromName(a.referenceValue),t.key):r=dg(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function r8(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!xu(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(e,t="asc"){this.field=e,this.dir=t}}function Gce(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oz{}class Xs extends Oz{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Wce(e,t,r):t==="array-contains"?new Xce(e,r):t==="in"?new Yce(e,r):t==="not-in"?new Zce(e,r):t==="array-contains-any"?new Qce(e,r):new Xs(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new qce(e,r):new Kce(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(dg(t,this.value)):t!==null&&of(this.value)===of(t)&&this.matchesComparison(dg(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Xt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gc extends Oz{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gc(e,t)}matches(e){return Mz(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Mz(n){return n.op==="and"}function Fz(n){return Hce(n)&&Mz(n)}function Hce(n){for(const e of n.filters)if(e instanceof gc)return!1;return!0}function tI(n){if(n instanceof Xs)return n.field.canonicalString()+n.op.toString()+fg(n.value);if(Fz(n))return n.filters.map((e=>tI(e))).join(",");{const e=n.filters.map((t=>tI(t))).join(",");return`${n.op}(${e})`}}function Bz(n,e){return n instanceof Xs?(function(r,s){return s instanceof Xs&&r.op===s.op&&r.field.isEqual(s.field)&&xu(r.value,s.value)})(n,e):n instanceof gc?(function(r,s){return s instanceof gc&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,o)=>i&&Bz(a,s.filters[o])),!0):!1})(n,e):void Xt(19439)}function zz(n){return n instanceof Xs?(function(t){return`${t.field.canonicalString()} ${t.op} ${fg(t.value)}`})(n):n instanceof gc?(function(t){return t.op.toString()+" {"+t.getFilters().map(zz).join(" ,")+"}"})(n):"Filter"}class Wce extends Xs{constructor(e,t,r){super(e,t,r),this.key=Lt.fromName(r.referenceValue)}matches(e){const t=Lt.comparator(e.key,this.key);return this.matchesComparison(t)}}class qce extends Xs{constructor(e,t){super(e,"in",t),this.keys=jz("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Kce extends Xs{constructor(e,t){super(e,"not-in",t),this.keys=jz("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function jz(n,e){return(e.arrayValue?.values||[]).map((t=>Lt.fromName(t.referenceValue)))}class Xce extends Xs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return h4(t)&&r1(t.arrayValue,this.value)}}class Yce extends Xs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&r1(this.value.arrayValue,t)}}class Zce extends Xs{constructor(e,t){super(e,"not-in",t)}matches(e){if(r1(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!r1(this.value.arrayValue,t)}}class Qce extends Xs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!h4(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>r1(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jce{constructor(e,t=null,r=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}}function s8(n,e=null,t=[],r=[],s=null,i=null,a=null){return new Jce(n,e,t,r,s,i,a)}function d4(n){const e=un(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>tI(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),gS(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>fg(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>fg(r))).join(",")),e.Te=t}return e.Te}function f4(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Gce(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Bz(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!r8(n.startAt,e.startAt)&&r8(n.endAt,e.endAt)}function nI(n){return Lt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,t=null,r=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function eue(n,e,t,r,s,i,a,o){return new Y1(n,e,t,r,s,i,a,o)}function p4(n){return new Y1(n)}function i8(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Vz(n){return n.collectionGroup!==null}function Fy(n){const e=un(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new gi(Ki.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(o=o.add(c.field))}))})),o})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new J2(i,r))})),t.has(Ki.keyField().canonicalString())||e.Ie.push(new J2(Ki.keyField(),r))}return e.Ie}function iu(n){const e=un(n);return e.Ee||(e.Ee=tue(e,Fy(n))),e.Ee}function tue(n,e){if(n.limitType==="F")return s8(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new J2(s.field,i)}));const t=n.endAt?new Q2(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Q2(n.startAt.position,n.startAt.inclusive):null;return s8(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function rI(n,e){const t=n.filters.concat([e]);return new Y1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function sI(n,e,t){return new Y1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function yS(n,e){return f4(iu(n),iu(e))&&n.limitType===e.limitType}function Uz(n){return`${d4(iu(n))}|lt:${n.limitType}`}function R0(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>zz(s))).join(", ")}]`),gS(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>fg(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>fg(s))).join(",")),`Target(${r})`})(iu(n))}; limitType=${n.limitType})`}function bS(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Lt.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of Fy(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,o,l){const c=n8(a,o,l);return a.inclusive?c<=0:c<0})(r.startAt,Fy(r),s)||r.endAt&&!(function(a,o,l){const c=n8(a,o,l);return a.inclusive?c>=0:c>0})(r.endAt,Fy(r),s))})(n,e)}function nue(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Gz(n){return(e,t)=>{let r=!1;for(const s of Fy(n)){const i=rue(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function rue(n,e,t){const r=n.field.isKeyField()?Lt.comparator(e.key,t.key):(function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?dg(l,c):Xt(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Xt(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Af(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return Az(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sue=new ps(Lt.comparator);function Ch(){return sue}const Hz=new ps(Lt.comparator);function _y(...n){let e=Hz;for(const t of n)e=e.insert(t.key,t);return e}function Wz(n){let e=Hz;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function kp(){return By()}function qz(){return By()}function By(){return new Cm((n=>n.toString()),((n,e)=>n.isEqual(e)))}const iue=new ps(Lt.comparator),aue=new gi(Lt.comparator);function Hn(...n){let e=aue;for(const t of n)e=e.add(t);return e}const oue=new gi(Gn);function lue(){return oue}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m4(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:X2(e)?"-0":e}}function Kz(n){return{integerValue:""+n}}function cue(n,e){return Oce(e)?Kz(e):m4(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(){this._=void 0}}function uue(n,e,t){return n instanceof s1?(function(s,i){const a={fields:{[Iz]:{stringValue:kz},[Dz]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&u4(i)&&(i=xS(i)),i&&(a.fields[Rz]=i),{mapValue:a}})(t,e):n instanceof i1?Yz(n,e):n instanceof a1?Zz(n,e):(function(s,i){const a=Xz(s,i),o=a8(a)+a8(s.Ae);return eI(a)&&eI(s.Ae)?Kz(o):m4(s.serializer,o)})(n,e)}function hue(n,e,t){return n instanceof i1?Yz(n,e):n instanceof a1?Zz(n,e):t}function Xz(n,e){return n instanceof eE?(function(r){return eI(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class s1 extends vS{}class i1 extends vS{constructor(e){super(),this.elements=e}}function Yz(n,e){const t=Qz(e);for(const r of n.elements)t.some((s=>xu(s,r)))||t.push(r);return{arrayValue:{values:t}}}class a1 extends vS{constructor(e){super(),this.elements=e}}function Zz(n,e){let t=Qz(e);for(const r of n.elements)t=t.filter((s=>!xu(s,r)));return{arrayValue:{values:t}}}class eE extends vS{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function a8(n){return Ms(n.integerValue||n.doubleValue)}function Qz(n){return h4(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class due{constructor(e,t){this.field=e,this.transform=t}}function fue(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof i1&&s instanceof i1||r instanceof a1&&s instanceof a1?hg(r.elements,s.elements,xu):r instanceof eE&&s instanceof eE?xu(r.Ae,s.Ae):r instanceof s1&&s instanceof s1})(n.transform,e.transform)}class pue{constructor(e,t){this.version=e,this.transformResults=t}}class uc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new uc}static exists(e){return new uc(void 0,e)}static updateTime(e){return new uc(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kw(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class _S{}function Jz(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new tj(n.key,uc.none()):new Z1(n.key,n.data,uc.none());{const t=n.data,r=go.empty();let s=new gi(Ki.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Nf(n.key,r,new Yo(s.toArray()),uc.none())}}function mue(n,e,t){n instanceof Z1?(function(s,i,a){const o=s.value.clone(),l=l8(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof Nf?(function(s,i,a){if(!kw(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=l8(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(ej(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function zy(n,e,t,r){return n instanceof Z1?(function(i,a,o,l){if(!kw(i.precondition,a))return o;const c=i.value.clone(),u=c8(i.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null})(n,e,t,r):n instanceof Nf?(function(i,a,o,l){if(!kw(i.precondition,a))return o;const c=c8(i.fieldTransforms,l,a),u=a.data;return u.setAll(ej(i)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((d=>d.field)))})(n,e,t,r):(function(i,a,o){return kw(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function gue(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Xz(r.transform,s||null);i!=null&&(t===null&&(t=go.empty()),t.set(r.field,i))}return t||null}function o8(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&hg(r,s,((i,a)=>fue(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Z1 extends _S{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Nf extends _S{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ej(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function l8(n,e,t){const r=new Map;vr(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,o=e.data.field(i.field);r.set(i.field,hue(a,o,t[s]))}return r}function c8(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,uue(i,a,e))}return r}class tj extends _S{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xue extends _S{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yue{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&mue(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=zy(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=zy(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=qz();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=t.has(s.key)?null:o;const l=Jz(a,o);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(sn.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Hn())}isEqual(e){return this.batchId===e.batchId&&hg(this.mutations,e.mutations,((t,r)=>o8(t,r)))&&hg(this.baseMutations,e.baseMutations,((t,r)=>o8(t,r)))}}class g4{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){vr(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return iue})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new g4(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bue{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vue{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ws,ir;function _ue(n){switch(n){case Xe.OK:return Xt(64938);case Xe.CANCELLED:case Xe.UNKNOWN:case Xe.DEADLINE_EXCEEDED:case Xe.RESOURCE_EXHAUSTED:case Xe.INTERNAL:case Xe.UNAVAILABLE:case Xe.UNAUTHENTICATED:return!1;case Xe.INVALID_ARGUMENT:case Xe.NOT_FOUND:case Xe.ALREADY_EXISTS:case Xe.PERMISSION_DENIED:case Xe.FAILED_PRECONDITION:case Xe.ABORTED:case Xe.OUT_OF_RANGE:case Xe.UNIMPLEMENTED:case Xe.DATA_LOSS:return!0;default:return Xt(15467,{code:n})}}function nj(n){if(n===void 0)return Th("GRPC error has no .code"),Xe.UNKNOWN;switch(n){case Ws.OK:return Xe.OK;case Ws.CANCELLED:return Xe.CANCELLED;case Ws.UNKNOWN:return Xe.UNKNOWN;case Ws.DEADLINE_EXCEEDED:return Xe.DEADLINE_EXCEEDED;case Ws.RESOURCE_EXHAUSTED:return Xe.RESOURCE_EXHAUSTED;case Ws.INTERNAL:return Xe.INTERNAL;case Ws.UNAVAILABLE:return Xe.UNAVAILABLE;case Ws.UNAUTHENTICATED:return Xe.UNAUTHENTICATED;case Ws.INVALID_ARGUMENT:return Xe.INVALID_ARGUMENT;case Ws.NOT_FOUND:return Xe.NOT_FOUND;case Ws.ALREADY_EXISTS:return Xe.ALREADY_EXISTS;case Ws.PERMISSION_DENIED:return Xe.PERMISSION_DENIED;case Ws.FAILED_PRECONDITION:return Xe.FAILED_PRECONDITION;case Ws.ABORTED:return Xe.ABORTED;case Ws.OUT_OF_RANGE:return Xe.OUT_OF_RANGE;case Ws.UNIMPLEMENTED:return Xe.UNIMPLEMENTED;case Ws.DATA_LOSS:return Xe.DATA_LOSS;default:return Xt(39323,{code:n})}}(ir=Ws||(Ws={}))[ir.OK=0]="OK",ir[ir.CANCELLED=1]="CANCELLED",ir[ir.UNKNOWN=2]="UNKNOWN",ir[ir.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ir[ir.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ir[ir.NOT_FOUND=5]="NOT_FOUND",ir[ir.ALREADY_EXISTS=6]="ALREADY_EXISTS",ir[ir.PERMISSION_DENIED=7]="PERMISSION_DENIED",ir[ir.UNAUTHENTICATED=16]="UNAUTHENTICATED",ir[ir.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ir[ir.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ir[ir.ABORTED=10]="ABORTED",ir[ir.OUT_OF_RANGE=11]="OUT_OF_RANGE",ir[ir.UNIMPLEMENTED=12]="UNIMPLEMENTED",ir[ir.INTERNAL=13]="INTERNAL",ir[ir.UNAVAILABLE=14]="UNAVAILABLE",ir[ir.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wue(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eue=new Xd([4294967295,4294967295],0);function u8(n){const e=wue().encode(n),t=new gz;return t.update(e),new Uint8Array(t.digest())}function h8(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Xd([t,r],0),new Xd([s,i],0)]}class x4{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new wy(`Invalid padding: ${t}`);if(r<0)throw new wy(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new wy(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new wy(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Xd.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(Xd.fromNumber(r)));return s.compare(Eue)===1&&(s=new Xd([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=u8(e),[r,s]=h8(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new x4(i,s,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=u8(e),[r,s]=h8(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class wy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Q1.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new wS(sn.min(),s,new ps(Gn),Ch(),Hn())}}class Q1{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Q1(r,t,Hn(),Hn(),Hn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class rj{constructor(e,t){this.targetId=e,this.Ce=t}}class sj{constructor(e,t,r=Qi.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class d8{constructor(){this.ve=0,this.Fe=f8(),this.Me=Qi.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Hn(),t=Hn(),r=Hn();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Xt(38017,{changeType:i})}})),new Q1(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=f8()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,vr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Sue{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ch(),this.Je=K_(),this.He=K_(),this.Ye=new ps(Gn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Xt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(nI(i))if(r===0){const a=new Lt(i.path);this.et(t,a,va.newNoDocument(a,sn.min()))}else vr(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,o;try{a=af(r).toUint8Array()}catch(l){if(l instanceof Nz)return ug("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new x4(a,s,i)}catch(l){return ug(l instanceof wy?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const o=this.ot(a);if(o){if(i.current&&nI(o.target)){const l=new Lt(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,va.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=Hn();this.He.forEach(((i,a)=>{let o=!0;a.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new wS(e,t,this.Ye,this.je,r);return this.je=Ch(),this.Je=K_(),this.He=K_(),this.Ye=new ps(Gn),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new d8,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new gi(Gn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new gi(Gn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||bt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new d8),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function K_(){return new ps(Lt.comparator)}function f8(){return new ps(Lt.comparator)}const Tue={asc:"ASCENDING",desc:"DESCENDING"},Cue={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Aue={and:"AND",or:"OR"};class Nue{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function iI(n,e){return n.useProto3Json||gS(e)?e:{value:e}}function tE(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ij(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function kue(n,e){return tE(n,e.toTimestamp())}function au(n){return vr(!!n,49232),sn.fromTimestamp((function(t){const r=sf(t);return new Xr(r.seconds,r.nanos)})(n))}function y4(n,e){return aI(n,e).canonicalString()}function aI(n,e){const t=(function(s){return new Vr(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function aj(n){const e=Vr.fromString(n);return vr(hj(e),10190,{key:e.toString()}),e}function oI(n,e){return y4(n.databaseId,e.path)}function IN(n,e){const t=aj(e);if(t.get(1)!==n.databaseId.projectId)throw new gt(Xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new gt(Xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Lt(lj(t))}function oj(n,e){return y4(n.databaseId,e)}function Iue(n){const e=aj(n);return e.length===4?Vr.emptyPath():lj(e)}function lI(n){return new Vr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function lj(n){return vr(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function p8(n,e,t){return{name:oI(n,e),fields:t.value.mapValue.fields}}function Rue(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Xt(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(c,u){return c.useProto3Json?(vr(u===void 0||typeof u=="string",58123),Qi.fromBase64String(u||"")):(vr(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Qi.fromUint8Array(u||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(c){const u=c.code===void 0?Xe.UNKNOWN:nj(c.code);return new gt(u,c.message||"")})(a);t=new sj(r,s,i,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=IN(n,r.document.name),i=au(r.document.updateTime),a=r.document.createTime?au(r.document.createTime):sn.min(),o=new go({mapValue:{fields:r.document.fields}}),l=va.newFoundDocument(s,i,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];t=new Iw(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=IN(n,r.document),i=r.readTime?au(r.readTime):sn.min(),a=va.newNoDocument(s,i),o=r.removedTargetIds||[];t=new Iw([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=IN(n,r.document),i=r.removedTargetIds||[];t=new Iw([],i,s,null)}else{if(!("filter"in e))return Xt(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new vue(s,i),o=r.targetId;t=new rj(o,a)}}return t}function Due(n,e){let t;if(e instanceof Z1)t={update:p8(n,e.key,e.value)};else if(e instanceof tj)t={delete:oI(n,e.key)};else if(e instanceof Nf)t={update:p8(n,e.key,e.data),updateMask:jue(e.fieldMask)};else{if(!(e instanceof xue))return Xt(16599,{Vt:e.type});t={verify:oI(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const o=a.transform;if(o instanceof s1)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof i1)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof a1)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof eE)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Xt(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:kue(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Xt(27497)})(n,e.precondition)),t}function $ue(n,e){return n&&n.length>0?(vr(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?au(s.updateTime):au(i);return a.isEqual(sn.min())&&(a=au(i)),new pue(a,s.transformResults||[])})(t,e)))):[]}function Lue(n,e){return{documents:[oj(n,e.path)]}}function Pue(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=oj(n,s);const i=(function(c){if(c.length!==0)return uj(gc.create(c,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(c){if(c.length!==0)return c.map((u=>(function(p){return{field:D0(p.field),direction:Fue(p.dir)}})(u)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=iI(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:s}}function Oue(n){let e=Iue(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){vr(r===1,65062);const u=t.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];t.where&&(i=(function(d){const p=cj(d);return p instanceof gc&&Fz(p)?p.getFilters():[p]})(t.where));let a=[];t.orderBy&&(a=(function(d){return d.map((p=>(function(y){return new J2($0(y.field),(function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(p)))})(t.orderBy));let o=null;t.limit&&(o=(function(d){let p;return p=typeof d=="object"?d.value:d,gS(p)?null:p})(t.limit));let l=null;t.startAt&&(l=(function(d){const p=!!d.before,x=d.values||[];return new Q2(x,p)})(t.startAt));let c=null;return t.endAt&&(c=(function(d){const p=!d.before,x=d.values||[];return new Q2(x,p)})(t.endAt)),eue(e,s,a,i,o,"F",l,c)}function Mue(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Xt(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function cj(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=$0(t.unaryFilter.field);return Xs.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=$0(t.unaryFilter.field);return Xs.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=$0(t.unaryFilter.field);return Xs.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=$0(t.unaryFilter.field);return Xs.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Xt(61313);default:return Xt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Xs.create($0(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Xt(58110);default:return Xt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gc.create(t.compositeFilter.filters.map((r=>cj(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Xt(1026)}})(t.compositeFilter.op))})(n):Xt(30097,{filter:n})}function Fue(n){return Tue[n]}function Bue(n){return Cue[n]}function zue(n){return Aue[n]}function D0(n){return{fieldPath:n.canonicalString()}}function $0(n){return Ki.fromServerFormat(n.fieldPath)}function uj(n){return n instanceof Xs?(function(t){if(t.op==="=="){if(t8(t.value))return{unaryFilter:{field:D0(t.field),op:"IS_NAN"}};if(e8(t.value))return{unaryFilter:{field:D0(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(t8(t.value))return{unaryFilter:{field:D0(t.field),op:"IS_NOT_NAN"}};if(e8(t.value))return{unaryFilter:{field:D0(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:D0(t.field),op:Bue(t.op),value:t.value}}})(n):n instanceof gc?(function(t){const r=t.getFilters().map((s=>uj(s)));return r.length===1?r[0]:{compositeFilter:{op:zue(t.op),filters:r}}})(n):Xt(54877,{filter:n})}function jue(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function hj(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,t,r,s,i=sn.min(),a=sn.min(),o=Qi.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new zd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vue{constructor(e){this.yt=e}}function Uue(n){const e=Oue({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?sI(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gue{constructor(){this.Cn=new Hue}addToCollectionParentIndex(e,t){return this.Cn.add(t),Qe.resolve()}getCollectionParents(e,t){return Qe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Qe.resolve()}deleteFieldIndex(e,t){return Qe.resolve()}deleteAllFieldIndexes(e){return Qe.resolve()}createTargetIndexes(e,t){return Qe.resolve()}getDocumentsMatchingTarget(e,t){return Qe.resolve(null)}getIndexType(e,t){return Qe.resolve(0)}getFieldIndexes(e,t){return Qe.resolve([])}getNextCollectionGroupToUpdate(e){return Qe.resolve(null)}getMinOffset(e,t){return Qe.resolve(rf.min())}getMinOffsetFromCollectionGroup(e,t){return Qe.resolve(rf.min())}updateCollectionGroup(e,t,r){return Qe.resolve()}updateIndexEntries(e,t){return Qe.resolve()}}class Hue{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new gi(Vr.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new gi(Vr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m8={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},dj=41943040;class po{static withCacheSize(e){return new po(e,po.DEFAULT_COLLECTION_PERCENTILE,po.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */po.DEFAULT_COLLECTION_PERCENTILE=10,po.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,po.DEFAULT=new po(dj,po.DEFAULT_COLLECTION_PERCENTILE,po.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),po.DISABLED=new po(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new pg(0)}static cr(){return new pg(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g8="LruGarbageCollector",Wue=1048576;function x8([n,e],[t,r]){const s=Gn(n,t);return s===0?Gn(e,r):s}class que{constructor(e){this.Ir=e,this.buffer=new gi(x8),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();x8(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Kue{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){bt(g8,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){zg(t)?bt(g8,"Ignoring IndexedDB error during garbage collection: ",t):await Bg(t)}await this.Vr(3e5)}))}}class Xue{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return Qe.resolve(mS.ce);const r=new que(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(bt("LruGarbageCollector","Garbage collection skipped; disabled"),Qe.resolve(m8)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(bt("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),m8):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,o,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(bt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,a=Date.now(),this.nthSequenceNumber(e,s)))).next((d=>(r=d,o=Date.now(),this.removeTargets(e,r,t)))).next((d=>(i=d,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((d=>(c=Date.now(),I0()<=Un.DEBUG&&bt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-u}ms
	Determined least recently used ${s} in `+(o-a)+`ms
	Removed ${i} targets in `+(l-o)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),Qe.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:d}))))}}function Yue(n,e){return new Xue(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zue{constructor(){this.changes=new Cm((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,va.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?Qe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Que{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jue{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&zy(r.mutation,s,Yo.empty(),Xr.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Hn()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Hn()){const s=kp();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=_y();return i.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=kp();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Hn())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,s){let i=Ch();const a=By(),o=(function(){return By()})();return t.forEach(((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Nf)?i=i.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),zy(u.mutation,c,u.mutation.getFieldMask(),Xr.now())):a.set(c.key,Yo.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((c,u)=>a.set(c,u))),t.forEach(((c,u)=>o.set(c,new Que(u,a.get(c)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=By();let s=new ps(((a,o)=>a-o)),i=Hn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let u=r.get(l)||Yo.empty();u=o.applyToLocalView(c,u),r.set(l,u);const d=(s.get(o.batchId)||Hn()).add(l);s=s.insert(o.batchId,d)}))})).next((()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,d=qz();u.forEach((p=>{if(!i.has(p)){const x=Jz(t.get(p),r.get(p));x!==null&&d.set(p,x),i=i.add(p)}})),a.push(this.documentOverlayCache.saveOverlays(e,c,d))}return Qe.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return Lt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Vz(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):Qe.resolve(kp());let o=e1,l=i;return a.next((c=>Qe.forEach(c,((u,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),i.get(u)?Qe.resolve():this.remoteDocumentCache.getEntry(e,u).next((p=>{l=l.insert(u,p)}))))).next((()=>this.populateOverlays(e,c,i))).next((()=>this.computeViews(e,l,c,Hn()))).next((u=>({batchId:o,changes:Wz(u)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Lt(t)).next((r=>{let s=_y();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=_y();return this.indexManager.getCollectionParents(e,i).next((o=>Qe.forEach(o,(l=>{const c=(function(d,p){return new Y1(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next((u=>{u.forEach(((d,p)=>{a=a.insert(d,p)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,va.newInvalidDocument(u)))}));let o=_y();return a.forEach(((l,c)=>{const u=i.get(l);u!==void 0&&zy(u.mutation,c,Yo.empty(),Xr.now()),bS(t,c)&&(o=o.insert(l,c))})),o}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ehe{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Qe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:au(s.createTime)}})(t)),Qe.resolve()}getNamedQuery(e,t){return Qe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:Uue(s.bundledQuery),readTime:au(s.readTime)}})(t)),Qe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class the{constructor(){this.overlays=new ps(Lt.comparator),this.qr=new Map}getOverlay(e,t){return Qe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=kp();return Qe.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),Qe.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),Qe.resolve()}getOverlaysForCollection(e,t,r){const s=kp(),i=t.length+1,a=new Lt(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return Qe.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new ps(((c,u)=>c-u));const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=kp(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=kp(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,u)=>o.set(c,u))),!(o.size()>=s)););return Qe.resolve(o)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new bue(t,r));let i=this.qr.get(t);i===void 0&&(i=Hn(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nhe{constructor(){this.sessionToken=Qi.EMPTY_BYTE_STRING}getSessionToken(e){return Qe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Qe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(){this.Qr=new gi(Di.$r),this.Ur=new gi(Di.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Di(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Di(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new Lt(new Vr([])),r=new Di(t,e),s=new Di(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Lt(new Vr([])),r=new Di(t,e),s=new Di(t,e+1);let i=Hn();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Di(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Di{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Lt.comparator(e.key,t.key)||Gn(e.Yr,t.Yr)}static Kr(e,t){return Gn(e.Yr,t.Yr)||Lt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rhe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new gi(Di.$r)}checkEmpty(e){return Qe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new yue(i,t,r,s);this.mutationQueue.push(a);for(const o of s)this.Zr=this.Zr.add(new Di(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Qe.resolve(a)}lookupMutationBatch(e,t){return Qe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return Qe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Qe.resolve(this.mutationQueue.length===0?c4:this.tr-1)}getAllMutationBatches(e){return Qe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Di(t,0),s=new Di(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const o=this.Xr(a.Yr);i.push(o)})),Qe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new gi(Gn);return t.forEach((s=>{const i=new Di(s,0),a=new Di(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(o=>{r=r.add(o.Yr)}))})),Qe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;Lt.isDocumentKey(i)||(i=i.child(""));const a=new Di(new Lt(i),0);let o=new gi(Gn);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.Yr)),!0)}),a),Qe.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){vr(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return Qe.forEach(t.mutations,(s=>{const i=new Di(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Di(t,0),s=this.Zr.firstAfterOrEqual(r);return Qe.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Qe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class she{constructor(e){this.ri=e,this.docs=(function(){return new ps(Lt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Qe.resolve(r?r.document.mutableCopy():va.newInvalidDocument(t))}getEntries(e,t){let r=Ch();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():va.newInvalidDocument(s))})),Qe.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Ch();const a=t.path,o=new Lt(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Dce(Rce(u),r)<=0||(s.has(u.key)||bS(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return Qe.resolve(i)}getAllFromCollectionGroup(e,t,r,s){Xt(9500)}ii(e,t){return Qe.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new ihe(this)}getSize(e){return Qe.resolve(this.size)}}class ihe extends Zue{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),Qe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ahe{constructor(e){this.persistence=e,this.si=new Cm((t=>d4(t)),f4),this.lastRemoteSnapshotVersion=sn.min(),this.highestTargetId=0,this.oi=0,this._i=new b4,this.targetCount=0,this.ai=pg.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),Qe.resolve()}getLastRemoteSnapshotVersion(e){return Qe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Qe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Qe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),Qe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new pg(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Qe.resolve()}updateTargetData(e,t){return this.Pr(t),Qe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Qe.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)})),Qe.waitFor(i).next((()=>s))}getTargetCount(e){return Qe.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return Qe.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),Qe.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),Qe.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Qe.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return Qe.resolve(r)}containsKey(e,t){return Qe.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(e,t){this.ui={},this.overlays={},this.ci=new mS(0),this.li=!1,this.li=!0,this.hi=new nhe,this.referenceDelegate=e(this),this.Pi=new ahe(this),this.indexManager=new Gue,this.remoteDocumentCache=(function(s){return new she(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new Vue(t),this.Ii=new ehe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new the,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new rhe(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){bt("MemoryPersistence","Starting transaction:",e);const s=new ohe(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return Qe.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class ohe extends Lce{constructor(e){super(),this.currentSequenceNumber=e}}class v4{constructor(e){this.persistence=e,this.Ri=new b4,this.Vi=null}static mi(e){return new v4(e)}get fi(){if(this.Vi)return this.Vi;throw Xt(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),Qe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),Qe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Qe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Qe.forEach(this.fi,(r=>{const s=Lt.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,sn.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Qe.or([()=>Qe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class nE{constructor(e,t){this.persistence=e,this.pi=new Cm((r=>Mce(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=Yue(this,t)}static mi(e,t){return new nE(e,t)}Ei(){}di(e){return Qe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return Qe.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?Qe.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,i.removeEntry(a,sn.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Qe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Qe.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Qe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Qe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Aw(e.data.value)),t}br(e,t,r){return Qe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return Qe.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=Hn(),s=Hn();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new _4(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lhe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class che{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return zie()?8:Pce(Ia())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new lhe;return this.Ss(e,t,a).next((o=>{if(i.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(I0()<=Un.DEBUG&&bt("QueryEngine","SDK will not create cache indexes for query:",R0(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Qe.resolve()):(I0()<=Un.DEBUG&&bt("QueryEngine","Query:",R0(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(I0()<=Un.DEBUG&&bt("QueryEngine","The SDK decides to create cache indexes for query:",R0(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,iu(t))):Qe.resolve())}ys(e,t){if(i8(t))return Qe.resolve(null);let r=iu(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=sI(t,null,"F"),r=iu(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=Hn(...i);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(t,o);return this.Cs(t,c,a,l.readTime)?this.ys(e,sI(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,r,s){return i8(t)||s.isEqual(sn.min())?Qe.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?Qe.resolve(null):(I0()<=Un.DEBUG&&bt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),R0(t)),this.vs(e,a,t,Ice(s,e1)).next((o=>o)))}))}Ds(e,t){let r=new gi(Gz(e));return t.forEach(((s,i)=>{bS(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return I0()<=Un.DEBUG&&bt("QueryEngine","Using full collection scan to execute query:",R0(t)),this.ps.getDocumentsMatchingQuery(e,t,rf.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w4="LocalStore",uhe=3e8;class hhe{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ps(Gn),this.xs=new Cm((i=>d4(i)),f4),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Jue(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function dhe(n,e,t,r){return new hhe(n,e,t,r)}async function pj(n,e){const t=un(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],o=[];let l=Hn();for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:a,addedBatchIds:o})))}))}))}function fhe(n,e){const t=un(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,c,u){const d=c.batch,p=d.keys();let x=Qe.resolve();return p.forEach((y=>{x=x.next((()=>u.getEntry(l,y))).next((v=>{const b=c.docVersions.get(y);vr(b!==null,48541),v.version.compareTo(b)<0&&(d.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))}))})),x.next((()=>o.mutationQueue.removeMutationBatch(l,d)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=Hn();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function mj(n){const e=un(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function phe(n,e){const t=un(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const o=[];e.targetChanges.forEach(((u,d)=>{const p=s.get(d);if(!p)return;o.push(t.Pi.removeMatchingKeys(i,u.removedDocuments,d).next((()=>t.Pi.addMatchingKeys(i,u.addedDocuments,d))));let x=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?x=x.withResumeToken(Qi.EMPTY_BYTE_STRING,sn.min()).withLastLimboFreeSnapshotVersion(sn.min()):u.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(u.resumeToken,r)),s=s.insert(d,x),(function(v,b,S){return v.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=uhe?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0})(p,x,u)&&o.push(t.Pi.updateTargetData(i,x))}));let l=Ch(),c=Hn();if(e.documentUpdates.forEach((u=>{e.resolvedLimboDocuments.has(u)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))})),o.push(mhe(i,a,e.documentUpdates).next((u=>{l=u.ks,c=u.qs}))),!r.isEqual(sn.min())){const u=t.Pi.getLastRemoteSnapshotVersion(i).next((d=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));o.push(u)}return Qe.waitFor(o).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,c))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function mhe(n,e,t){let r=Hn(),s=Hn();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=Ch();return t.forEach(((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(sn.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):bt(w4,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function ghe(n,e){const t=un(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=c4),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function xhe(n,e){const t=un(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,Qe.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new zd(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function cI(n,e,t){const r=un(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!zg(a))throw a;bt(w4,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function y8(n,e,t){const r=un(n);let s=sn.min(),i=Hn();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,c,u){const d=un(l),p=d.xs.get(u);return p!==void 0?Qe.resolve(d.Ms.get(p)):d.Pi.getTargetData(c,u)})(r,a,iu(e)).next((o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:sn.min(),t?i:Hn()))).next((o=>(yhe(r,nue(e),o),{documents:o,Qs:i})))))}function yhe(n,e,t){let r=n.Os.get(e)||sn.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class b8{constructor(){this.activeTargetIds=lue()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bhe{constructor(){this.Mo=new b8,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new b8,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vhe{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v8="ConnectivityMonitor";class _8{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){bt(v8,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){bt(v8,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let X_=null;function uI(){return X_===null?X_=(function(){return 268435456+Math.round(2147483648*Math.random())})():X_++,"0x"+X_.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN="RestConnection",_he={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class whe{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Y2?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=uI(),o=this.zo(e,t.toUriEncodedString());bt(RN,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(o),u=Sf(c);return this.Jo(e,o,l,r,u).then((d=>(bt(RN,`Received RPC '${e}' ${a}: `,d),d)),(d=>{throw ug(RN,`RPC '${e}' ${a} failed with error: `,d,"url: ",o,"request:",r),d}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Fg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=_he[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ehe{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga="WebChannelConnection";class She extends whe{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=uI();return new Promise(((o,l)=>{const c=new xz;c.setWithCredentials(!0),c.listenOnce(yz.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case Cw.NO_ERROR:const d=c.getResponseJson();bt(ga,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(d)),o(d);break;case Cw.TIMEOUT:bt(ga,`RPC '${e}' ${a} timed out`),l(new gt(Xe.DEADLINE_EXCEEDED,"Request time out"));break;case Cw.HTTP_ERROR:const p=c.getStatus();if(bt(ga,`RPC '${e}' ${a} failed with status:`,p,"response text:",c.getResponseText()),p>0){let x=c.getResponseJson();Array.isArray(x)&&(x=x[0]);const y=x?.error;if(y&&y.status&&y.message){const v=(function(S){const T=S.toLowerCase().replace(/_/g,"-");return Object.values(Xe).indexOf(T)>=0?T:Xe.UNKNOWN})(y.status);l(new gt(v,y.message))}else l(new gt(Xe.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new gt(Xe.UNAVAILABLE,"Connection failed."));break;default:Xt(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{bt(ga,`RPC '${e}' ${a} completed.`)}}));const u=JSON.stringify(s);bt(ga,`RPC '${e}' ${a} sending request:`,s),c.send(t,"POST",u,r,15)}))}T_(e,t,r){const s=uI(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=_z(),o=vz(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const u=i.join("");bt(ga,`Creating RPC '${e}' stream ${s}: ${u}`,l);const d=a.createWebChannel(u,l);this.I_(d);let p=!1,x=!1;const y=new Ehe({Yo:b=>{x?bt(ga,`Not sending because RPC '${e}' stream ${s} is closed:`,b):(p||(bt(ga,`Opening RPC '${e}' stream ${s} transport.`),d.open(),p=!0),bt(ga,`RPC '${e}' stream ${s} sending:`,b),d.send(b))},Zo:()=>d.close()}),v=(b,S,T)=>{b.listen(S,(C=>{try{T(C)}catch(I){setTimeout((()=>{throw I}),0)}}))};return v(d,vy.EventType.OPEN,(()=>{x||(bt(ga,`RPC '${e}' stream ${s} transport opened.`),y.o_())})),v(d,vy.EventType.CLOSE,(()=>{x||(x=!0,bt(ga,`RPC '${e}' stream ${s} transport closed`),y.a_(),this.E_(d))})),v(d,vy.EventType.ERROR,(b=>{x||(x=!0,ug(ga,`RPC '${e}' stream ${s} transport errored. Name:`,b.name,"Message:",b.message),y.a_(new gt(Xe.UNAVAILABLE,"The operation could not be completed")))})),v(d,vy.EventType.MESSAGE,(b=>{if(!x){const S=b.data[0];vr(!!S,16349);const T=S,C=T?.error||T[0]?.error;if(C){bt(ga,`RPC '${e}' stream ${s} received error:`,C);const I=C.status;let $=(function(F){const G=Ws[F];if(G!==void 0)return nj(G)})(I),q=C.message;$===void 0&&($=Xe.INTERNAL,q="Unknown error status: "+I+" with message "+C.message),x=!0,y.a_(new gt($,q)),d.close()}else bt(ga,`RPC '${e}' stream ${s} received:`,S),y.u_(S)}})),v(o,bz.STAT_EVENT,(b=>{b.stat===Zk.PROXY?bt(ga,`RPC '${e}' stream ${s} detected buffering proxy`):b.stat===Zk.NOPROXY&&bt(ga,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function DN(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ES(n){return new Nue(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&bt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w8="PersistentStream";class xj{constructor(e,t,r,s,i,a,o,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new gj(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Xe.RESOURCE_EXHAUSTED?(Th(t.toString()),Th("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new gt(Xe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return bt(w8,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(bt(w8,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class The extends xj{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Rue(this.serializer,e),r=(function(i){if(!("targetChange"in i))return sn.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?sn.min():a.readTime?au(a.readTime):sn.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=lI(this.serializer),t.addTarget=(function(i,a){let o;const l=a.target;if(o=nI(l)?{documents:Lue(i,l)}:{query:Pue(i,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=ij(i,a.resumeToken);const c=iI(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(sn.min())>0){o.readTime=tE(i,a.snapshotVersion.toTimestamp());const c=iI(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o})(this.serializer,e);const r=Mue(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=lI(this.serializer),t.removeTarget=e,this.q_(t)}}class Che extends xj{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return vr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,vr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){vr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=$ue(e.writeResults,e.commitTime),r=au(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=lI(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Due(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ahe{}class Nhe extends Ahe{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new gt(Xe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,aI(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===Xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new gt(Xe.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,aI(t,r),s,a,o,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new gt(Xe.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class khe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Th(t),this.aa=!1):bt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="RemoteStore";class Ihe{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{Am(this)&&(bt(Yp,"Restarting streams for network reachability change."),await(async function(l){const c=un(l);c.Ea.add(4),await J1(c),c.Ra.set("Unknown"),c.Ea.delete(4),await SS(c)})(this))}))})),this.Ra=new khe(r,s)}}async function SS(n){if(Am(n))for(const e of n.da)await e(!0)}async function J1(n){for(const e of n.da)await e(!1)}function yj(n,e){const t=un(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),C4(t)?T4(t):jg(t).O_()&&S4(t,e))}function E4(n,e){const t=un(n),r=jg(t);t.Ia.delete(e),r.O_()&&bj(t,e),t.Ia.size===0&&(r.O_()?r.L_():Am(t)&&t.Ra.set("Unknown"))}function S4(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(sn.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}jg(n).Y_(e)}function bj(n,e){n.Va.Ue(e),jg(n).Z_(e)}function T4(n){n.Va=new Sue({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),jg(n).start(),n.Ra.ua()}function C4(n){return Am(n)&&!jg(n).x_()&&n.Ia.size>0}function Am(n){return un(n).Ea.size===0}function vj(n){n.Va=void 0}async function Rhe(n){n.Ra.set("Online")}async function Dhe(n){n.Ia.forEach(((e,t)=>{S4(n,e)}))}async function $he(n,e){vj(n),C4(n)?(n.Ra.ha(e),T4(n)):n.Ra.set("Unknown")}async function Lhe(n,e,t){if(n.Ra.set("Online"),e instanceof sj&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const o of i.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.Ia.delete(o),s.Va.removeTarget(o))})(n,e)}catch(r){bt(Yp,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await rE(n,r)}else if(e instanceof Iw?n.Va.Ze(e):e instanceof rj?n.Va.st(e):n.Va.tt(e),!t.isEqual(sn.min()))try{const r=await mj(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const o=i.Va.Tt(a);return o.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.Ia.get(c);u&&i.Ia.set(c,u.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,c)=>{const u=i.Ia.get(l);if(!u)return;i.Ia.set(l,u.withResumeToken(Qi.EMPTY_BYTE_STRING,u.snapshotVersion)),bj(i,l);const d=new zd(u.target,l,c,u.sequenceNumber);S4(i,d)})),i.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){bt(Yp,"Failed to raise snapshot:",r),await rE(n,r)}}async function rE(n,e,t){if(!zg(e))throw e;n.Ea.add(1),await J1(n),n.Ra.set("Offline"),t||(t=()=>mj(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{bt(Yp,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await SS(n)}))}function _j(n,e){return e().catch((t=>rE(n,t,e)))}async function TS(n){const e=un(n),t=lf(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:c4;for(;Phe(e);)try{const s=await ghe(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,Ohe(e,s)}catch(s){await rE(e,s)}wj(e)&&Ej(e)}function Phe(n){return Am(n)&&n.Ta.length<10}function Ohe(n,e){n.Ta.push(e);const t=lf(n);t.O_()&&t.X_&&t.ea(e.mutations)}function wj(n){return Am(n)&&!lf(n).x_()&&n.Ta.length>0}function Ej(n){lf(n).start()}async function Mhe(n){lf(n).ra()}async function Fhe(n){const e=lf(n);for(const t of n.Ta)e.ea(t.mutations)}async function Bhe(n,e,t){const r=n.Ta.shift(),s=g4.from(r,e,t);await _j(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await TS(n)}async function zhe(n,e){e&&lf(n).X_&&await(async function(r,s){if((function(a){return _ue(a)&&a!==Xe.ABORTED})(s.code)){const i=r.Ta.shift();lf(r).B_(),await _j(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await TS(r)}})(n,e),wj(n)&&Ej(n)}async function E8(n,e){const t=un(n);t.asyncQueue.verifyOperationInProgress(),bt(Yp,"RemoteStore received new credentials");const r=Am(t);t.Ea.add(3),await J1(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await SS(t)}async function jhe(n,e){const t=un(n);e?(t.Ea.delete(2),await SS(t)):e||(t.Ea.add(2),await J1(t),t.Ra.set("Unknown"))}function jg(n){return n.ma||(n.ma=(function(t,r,s){const i=un(t);return i.sa(),new The(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:Rhe.bind(null,n),t_:Dhe.bind(null,n),r_:$he.bind(null,n),H_:Lhe.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),C4(n)?T4(n):n.Ra.set("Unknown")):(await n.ma.stop(),vj(n))}))),n.ma}function lf(n){return n.fa||(n.fa=(function(t,r,s){const i=un(t);return i.sa(),new Che(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Mhe.bind(null,n),r_:zhe.bind(null,n),ta:Fhe.bind(null,n),na:Bhe.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await TS(n)):(await n.fa.stop(),n.Ta.length>0&&(bt(Yp,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new yh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,o=new A4(e,t,a,s,i);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new gt(Xe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function N4(n,e){if(Th("AsyncQueue",`${e}: ${n}`),zg(n))return new gt(Xe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{static emptySet(e){return new Y0(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Lt.comparator(t.key,r.key):(t,r)=>Lt.comparator(t.key,r.key),this.keyedMap=_y(),this.sortedSet=new ps(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Y0)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Y0;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S8{constructor(){this.ga=new ps(Lt.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Xt(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class mg{constructor(e,t,r,s,i,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new mg(e,t,Y0.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yS(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vhe{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Uhe{constructor(){this.queries=T8(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=un(t),i=s.queries;s.queries=T8(),i.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new gt(Xe.ABORTED,"Firestore shutting down"))}}function T8(){return new Cm((n=>Uz(n)),yS)}async function Sj(n,e){const t=un(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new Vhe,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const o=N4(a,`Initialization of query '${R0(e.query)}' failed`);return void e.onError(o)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&k4(t)}async function Tj(n,e){const t=un(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Ghe(n,e){const t=un(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const o of a.Sa)o.Fa(s)&&(r=!0);a.wa=s}}r&&k4(t)}function Hhe(n,e,t){const r=un(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function k4(n){n.Ca.forEach((e=>{e.next()}))}var hI,C8;(C8=hI||(hI={})).Ma="default",C8.Cache="cache";class Cj{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new mg(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=mg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==hI.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.key=e}}class Nj{constructor(e){this.key=e}}class Whe{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Hn(),this.mutatedKeys=Hn(),this.eu=Gz(e),this.tu=new Y0(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new S8,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((u,d)=>{const p=s.get(u),x=bS(this.query,d)?d:null,y=!!p&&this.mutatedKeys.has(p.key),v=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let b=!1;p&&x?p.data.isEqual(x.data)?y!==v&&(r.track({type:3,doc:x}),b=!0):this.su(p,x)||(r.track({type:2,doc:x}),b=!0,(l&&this.eu(x,l)>0||c&&this.eu(x,c)<0)&&(o=!0)):!p&&x?(r.track({type:0,doc:x}),b=!0):p&&!x&&(r.track({type:1,doc:p}),b=!0,(l||c)&&(o=!0)),b&&(x?(a=a.add(x),i=v?i.add(u):i.delete(u)):(a=a.delete(u),i=i.delete(u)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{tu:a,iu:r,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((u,d)=>(function(x,y){const v=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xt(20277,{Rt:b})}};return v(x)-v(y)})(u.type,d.type)||this.eu(u.doc,d.doc))),this.ou(r),s=s??!1;const o=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new mg(this.query,e.tu,i,a,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new S8,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Hn(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new Nj(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new Aj(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Hn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return mg.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const I4="SyncEngine";class qhe{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Khe{constructor(e){this.key=e,this.hu=!1}}class Xhe{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Cm((o=>Uz(o)),yS),this.Iu=new Map,this.Eu=new Set,this.du=new ps(Lt.comparator),this.Au=new Map,this.Ru=new b4,this.Vu={},this.mu=new Map,this.fu=pg.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Yhe(n,e,t=!0){const r=Lj(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await kj(r,e,t,!0),s}async function Zhe(n,e){const t=Lj(n);await kj(t,e,!0,!1)}async function kj(n,e,t,r){const s=await xhe(n.localStore,iu(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let o;return r&&(o=await Qhe(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&yj(n.remoteStore,s),o}async function Qhe(n,e,t,r,s){n.pu=(d,p,x)=>(async function(v,b,S,T){let C=b.view.ru(S);C.Cs&&(C=await y8(v.localStore,b.query,!1).then((({documents:U})=>b.view.ru(U,C))));const I=T&&T.targetChanges.get(b.targetId),$=T&&T.targetMismatches.get(b.targetId)!=null,q=b.view.applyChanges(C,v.isPrimaryClient,I,$);return N8(v,b.targetId,q.au),q.snapshot})(n,d,p,x);const i=await y8(n.localStore,e,!0),a=new Whe(e,i.Qs),o=a.ru(i.documents),l=Q1.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=a.applyChanges(o,n.isPrimaryClient,l);N8(n,t,c.au);const u=new qhe(e,t,a);return n.Tu.set(e,u),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function Jhe(n,e,t){const r=un(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!yS(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await cI(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&E4(r.remoteStore,s.targetId),dI(r,s.targetId)})).catch(Bg)):(dI(r,s.targetId),await cI(r.localStore,s.targetId,!0))}async function ede(n,e){const t=un(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),E4(t.remoteStore,r.targetId))}async function tde(n,e,t){const r=lde(n);try{const s=await(function(a,o){const l=un(a),c=Xr.now(),u=o.reduce(((x,y)=>x.add(y.key)),Hn());let d,p;return l.persistence.runTransaction("Locally write mutations","readwrite",(x=>{let y=Ch(),v=Hn();return l.Ns.getEntries(x,u).next((b=>{y=b,y.forEach(((S,T)=>{T.isValidDocument()||(v=v.add(S))}))})).next((()=>l.localDocuments.getOverlayedDocuments(x,y))).next((b=>{d=b;const S=[];for(const T of o){const C=gue(T,d.get(T.key).overlayedDocument);C!=null&&S.push(new Nf(T.key,C,Pz(C.value.mapValue),uc.exists(!0)))}return l.mutationQueue.addMutationBatch(x,c,S,o)})).next((b=>{p=b;const S=b.applyToLocalDocumentSet(d,v);return l.documentOverlayCache.saveOverlays(x,b.batchId,S)}))})).then((()=>({batchId:p.batchId,changes:Wz(d)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new ps(Gn)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c})(r,s.batchId,t),await eb(r,s.changes),await TS(r.remoteStore)}catch(s){const i=N4(s,"Failed to persist write");t.reject(i)}}async function Ij(n,e){const t=un(n);try{const r=await phe(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(vr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?vr(a.hu,14607):s.removedDocuments.size>0&&(vr(a.hu,42227),a.hu=!1))})),await eb(t,r,e)}catch(r){await Bg(r)}}function A8(n,e,t){const r=un(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const o=a.view.va(e);o.snapshot&&s.push(o.snapshot)})),(function(a,o){const l=un(a);l.onlineState=o;let c=!1;l.queries.forEach(((u,d)=>{for(const p of d.Sa)p.va(o)&&(c=!0)})),c&&k4(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function nde(n,e,t){const r=un(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new ps(Lt.comparator);a=a.insert(i,va.newNoDocument(i,sn.min()));const o=Hn().add(i),l=new wS(sn.min(),new Map,new ps(Gn),a,o);await Ij(r,l),r.du=r.du.remove(i),r.Au.delete(e),R4(r)}else await cI(r.localStore,e,!1).then((()=>dI(r,e,t))).catch(Bg)}async function rde(n,e){const t=un(n),r=e.batch.batchId;try{const s=await fhe(t.localStore,e);Dj(t,r,null),Rj(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await eb(t,s)}catch(s){await Bg(s)}}async function sde(n,e,t){const r=un(n);try{const s=await(function(a,o){const l=un(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next((d=>(vr(d!==null,37113),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u))).next((()=>l.localDocuments.getDocuments(c,u)))}))})(r.localStore,e);Dj(r,e,t),Rj(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await eb(r,s)}catch(s){await Bg(s)}}function Rj(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Dj(n,e,t){const r=un(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function dI(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||$j(n,r)}))}function $j(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(E4(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),R4(n))}function N8(n,e,t){for(const r of t)r instanceof Aj?(n.Ru.addReference(r.key,e),ide(n,r)):r instanceof Nj?(bt(I4,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||$j(n,r.key)):Xt(19791,{wu:r})}function ide(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(bt(I4,"New document in limbo: "+t),n.Eu.add(r),R4(n))}function R4(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Lt(Vr.fromString(e)),r=n.fu.next();n.Au.set(r,new Khe(t)),n.du=n.du.insert(t,r),yj(n.remoteStore,new zd(iu(p4(t.path)),r,"TargetPurposeLimboResolution",mS.ce))}}async function eb(n,e,t){const r=un(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((c=>{if((c||t)&&r.isPrimaryClient){const u=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){s.push(c);const u=_4.As(l.targetId,c);i.push(u)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,c){const u=un(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>Qe.forEach(c,(p=>Qe.forEach(p.Es,(x=>u.persistence.referenceDelegate.addReference(d,p.targetId,x))).next((()=>Qe.forEach(p.ds,(x=>u.persistence.referenceDelegate.removeReference(d,p.targetId,x)))))))))}catch(d){if(!zg(d))throw d;bt(w4,"Failed to update sequence numbers: "+d)}for(const d of c){const p=d.targetId;if(!d.fromCache){const x=u.Ms.get(p),y=x.snapshotVersion,v=x.withLastLimboFreeSnapshotVersion(y);u.Ms=u.Ms.insert(p,v)}}})(r.localStore,i))}async function ade(n,e){const t=un(n);if(!t.currentUser.isEqual(e)){bt(I4,"User change. New user:",e.toKey());const r=await pj(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((o=>{o.forEach((l=>{l.reject(new gt(Xe.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await eb(t,r.Ls)}}function ode(n,e){const t=un(n),r=t.Au.get(e);if(r&&r.hu)return Hn().add(r.key);{let s=Hn();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const o=t.Tu.get(a);s=s.unionWith(o.view.nu)}return s}}function Lj(n){const e=un(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ij.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ode.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nde.bind(null,e),e.Pu.H_=Ghe.bind(null,e.eventManager),e.Pu.yu=Hhe.bind(null,e.eventManager),e}function lde(n){const e=un(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rde.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sde.bind(null,e),e}class sE{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ES(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return dhe(this.persistence,new che,e.initialUser,this.serializer)}Cu(e){return new fj(v4.mi,this.serializer)}Du(e){return new bhe}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sE.provider={build:()=>new sE};class cde extends sE{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){vr(this.persistence.referenceDelegate instanceof nE,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Kue(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?po.withCacheSize(this.cacheSizeBytes):po.DEFAULT;return new fj((r=>nE.mi(r,t)),this.serializer)}}class fI{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>A8(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ade.bind(null,this.syncEngine),await jhe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Uhe})()}createDatastore(e){const t=ES(e.databaseInfo.databaseId),r=(function(i){return new She(i)})(e.databaseInfo);return(function(i,a,o,l){return new Nhe(i,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,o){return new Ihe(r,s,i,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>A8(this.syncEngine,t,0)),(function(){return _8.v()?new _8:new vhe})())}createSyncEngine(e,t){return(function(s,i,a,o,l,c,u){const d=new Xhe(s,i,a,o,l,c);return u&&(d.gu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=un(t);bt(Yp,"RemoteStore shutting down."),r.Ea.add(5),await J1(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}fI.provider={build:()=>new fI};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Th("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="FirestoreClient";class ude{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=ya.UNAUTHENTICATED,this.clientId=l4.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{bt(cf,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(bt(cf,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new yh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=N4(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function $N(n,e){n.asyncQueue.verifyOperationInProgress(),bt(cf,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await pj(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function k8(n,e){n.asyncQueue.verifyOperationInProgress();const t=await hde(n);bt(cf,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>E8(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>E8(e.remoteStore,s))),n._onlineComponents=e}async function hde(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){bt(cf,"Using user provided OfflineComponentProvider");try{await $N(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===Xe.FAILED_PRECONDITION||s.code===Xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;ug("Error using user provided cache. Falling back to memory cache: "+t),await $N(n,new sE)}}else bt(cf,"Using default OfflineComponentProvider"),await $N(n,new cde(void 0));return n._offlineComponents}async function Oj(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(bt(cf,"Using user provided OnlineComponentProvider"),await k8(n,n._uninitializedComponentsProvider._online)):(bt(cf,"Using default OnlineComponentProvider"),await k8(n,new fI))),n._onlineComponents}function dde(n){return Oj(n).then((e=>e.syncEngine))}async function Mj(n){const e=await Oj(n),t=e.eventManager;return t.onListen=Yhe.bind(null,e.syncEngine),t.onUnlisten=Jhe.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Zhe.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ede.bind(null,e.syncEngine),t}function fde(n,e,t={}){const r=new yh;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,o,l,c){const u=new Pj({next:p=>{u.Nu(),a.enqueueAndForget((()=>Tj(i,d)));const x=p.docs.has(o);!x&&p.fromCache?c.reject(new gt(Xe.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&p.fromCache&&l&&l.source==="server"?c.reject(new gt(Xe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),d=new Cj(p4(o.path),u,{includeMetadataChanges:!0,qa:!0});return Sj(i,d)})(await Mj(n),n.asyncQueue,e,t,r))),r.promise}function pde(n,e,t={}){const r=new yh;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,o,l,c){const u=new Pj({next:p=>{u.Nu(),a.enqueueAndForget((()=>Tj(i,d))),p.fromCache&&l.source==="server"?c.reject(new gt(Xe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),d=new Cj(o,u,{includeMetadataChanges:!0,qa:!0});return Sj(i,d)})(await Mj(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I8=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj="firestore.googleapis.com",R8=!0;class D8{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new gt(Xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Bj,this.ssl=R8}else this.host=e.host,this.ssl=e.ssl??R8;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=dj;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Wue)throw new gt(Xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kce("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Fj(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new gt(Xe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new gt(Xe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new gt(Xe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class CS{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new D8({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new gt(Xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new gt(Xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new D8(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new bce;switch(r.type){case"firstParty":return new Ece(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new gt(Xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=I8.get(t);r&&(bt("ComponentProvider","Removing Datastore"),I8.delete(t),r.terminate())})(this),Promise.resolve()}}function mde(n,e,t,r={}){n=gu(n,CS);const s=Sf(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;s&&(q3(`https://${o}`),K3("Firestore",!0)),i.host!==Bj&&i.host!==o&&ug("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:o,ssl:s,emulatorOptions:r};if(!Hp(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=ya.MOCK_USER;else{c=I7(r.mockUserToken,n._app?.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new gt(Xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new ya(d)}n._authCredentials=new vce(new Ez(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Vg(this.firestore,e,this._query)}}class Bs{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Bs(this.firestore,e,this._key)}toJSON(){return{type:Bs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(X1(t,Bs._jsonSchema))return new Bs(e,r||null,new Lt(Vr.fromString(t.referencePath)))}}Bs._jsonSchemaVersion="firestore/documentReference/1.0",Bs._jsonSchema={type:Ys("string",Bs._jsonSchemaVersion),referencePath:Ys("string")};class Yd extends Vg{constructor(e,t,r){super(e,t,p4(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Bs(this.firestore,null,new Lt(e))}withConverter(e){return new Yd(this.firestore,e,this._path)}}function uf(n,e,...t){if(n=js(n),Sz("collection","path",e),n instanceof CS){const r=Vr.fromString(e,...t);return HM(r),new Yd(n,null,r)}{if(!(n instanceof Bs||n instanceof Yd))throw new gt(Xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Vr.fromString(e,...t));return HM(r),new Yd(n.firestore,null,r)}}function yu(n,e,...t){if(n=js(n),arguments.length===1&&(e=l4.newId()),Sz("doc","path",e),n instanceof CS){const r=Vr.fromString(e,...t);return GM(r),new Bs(n,null,new Lt(r))}{if(!(n instanceof Bs||n instanceof Yd))throw new gt(Xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Vr.fromString(e,...t));return GM(r),new Bs(n.firestore,n instanceof Yd?n.converter:null,new Lt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $8="AsyncQueue";class L8{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new gj(this,"async_queue_retry"),this._c=()=>{const r=DN();r&&bt($8,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=DN();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=DN();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new yh;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!zg(e))throw e;bt($8,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Th("INTERNAL UNHANDLED ERROR: ",P8(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=A4.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&Xt(47125,{Pc:P8(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function P8(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ug extends CS{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new L8,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new L8(e),this._firestoreClient=void 0,await e}}}function gde(n,e){const t=typeof n=="object"?n:Z3(),r=typeof n=="string"?n:Y2,s=uS(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=A7("firestore");i&&mde(s,...i)}return s}function D4(n){if(n._terminated)throw new gt(Xe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||xde(n),n._firestoreClient}function xde(n){const e=n._freezeSettings(),t=(function(s,i,a,o){return new zce(s,i,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,Fj(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new ude(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Tl(Qi.fromBase64String(e))}catch(t){throw new gt(Xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Tl(Qi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Tl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(X1(e,Tl._jsonSchema))return Tl.fromBase64String(e.bytes)}}Tl._jsonSchemaVersion="firestore/bytes/1.0",Tl._jsonSchema={type:Ys("string",Tl._jsonSchemaVersion),bytes:Ys("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new gt(Xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ki(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new gt(Xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new gt(Xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Gn(this._lat,e._lat)||Gn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ou._jsonSchemaVersion}}static fromJSON(e){if(X1(e,ou._jsonSchema))return new ou(e.latitude,e.longitude)}}ou._jsonSchemaVersion="firestore/geoPoint/1.0",ou._jsonSchema={type:Ys("string",ou._jsonSchemaVersion),latitude:Ys("number"),longitude:Ys("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:lu._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(X1(e,lu._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new lu(e.vectorValues);throw new gt(Xe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}lu._jsonSchemaVersion="firestore/vectorValue/1.0",lu._jsonSchema={type:Ys("string",lu._jsonSchemaVersion),vectorValues:Ys("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yde=/^__.*__$/;class bde{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Nf(e,this.data,this.fieldMask,t,this.fieldTransforms):new Z1(e,this.data,t,this.fieldTransforms)}}class zj{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Nf(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function jj(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xt(40011,{Ac:n})}}class $4{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new $4({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return iE(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(jj(this.Ac)&&yde.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class vde{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ES(e)}Cc(e,t,r,s=!1){return new $4({Ac:e,methodName:t,Dc:r,path:Ki.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function kS(n){const e=n._freezeSettings(),t=ES(n._databaseId);return new vde(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Vj(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);P4("Data must be an object, but it was:",a,r);const o=Uj(r,a);let l,c;if(i.merge)l=new Yo(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const u=[];for(const d of i.mergeFields){const p=pI(e,d,t);if(!a.contains(p))throw new gt(Xe.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);Hj(u,p)||u.push(p)}l=new Yo(u),c=a.fieldTransforms.filter((d=>l.covers(d.field)))}else l=null,c=a.fieldTransforms;return new bde(new go(o),l,c)}class IS extends NS{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof IS}}class L4 extends NS{_toFieldTransform(e){return new due(e.path,new s1)}isEqual(e){return e instanceof L4}}function _de(n,e,t,r){const s=n.Cc(1,e,t);P4("Data must be an object, but it was:",s,r);const i=[],a=go.empty();Af(r,((l,c)=>{const u=O4(e,l,t);c=js(c);const d=s.yc(u);if(c instanceof IS)i.push(u);else{const p=tb(c,d);p!=null&&(i.push(u),a.set(u,p))}}));const o=new Yo(i);return new zj(a,o,s.fieldTransforms)}function wde(n,e,t,r,s,i){const a=n.Cc(1,e,t),o=[pI(e,r,t)],l=[s];if(i.length%2!=0)throw new gt(Xe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)o.push(pI(e,i[p])),l.push(i[p+1]);const c=[],u=go.empty();for(let p=o.length-1;p>=0;--p)if(!Hj(c,o[p])){const x=o[p];let y=l[p];y=js(y);const v=a.yc(x);if(y instanceof IS)c.push(x);else{const b=tb(y,v);b!=null&&(c.push(x),u.set(x,b))}}const d=new Yo(c);return new zj(u,d,a.fieldTransforms)}function Ede(n,e,t,r=!1){return tb(t,n.Cc(r?4:3,e))}function tb(n,e){if(Gj(n=js(n)))return P4("Unsupported field value:",e,n),Uj(n,e);if(n instanceof NS)return(function(r,s){if(!jj(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const o of r){let l=tb(o,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=js(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return cue(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Xr.fromDate(r);return{timestampValue:tE(s.serializer,i)}}if(r instanceof Xr){const i=new Xr(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:tE(s.serializer,i)}}if(r instanceof ou)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Tl)return{bytesValue:ij(s.serializer,r._byteString)};if(r instanceof Bs){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:y4(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof lu)return(function(a,o){return{mapValue:{fields:{[$z]:{stringValue:Lz},[Z2]:{arrayValue:{values:a.toArray().map((c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return m4(o.serializer,c)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${pS(r)}`)})(n,e)}function Uj(n,e){const t={};return Az(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Af(n,((r,s)=>{const i=tb(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function Gj(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Xr||n instanceof ou||n instanceof Tl||n instanceof Bs||n instanceof NS||n instanceof lu)}function P4(n,e,t){if(!Gj(t)||!Tz(t)){const r=pS(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function pI(n,e,t){if((e=js(e))instanceof AS)return e._internalPath;if(typeof e=="string")return O4(n,e);throw iE("Field path arguments must be of type string or ",n,!1,void 0,t)}const Sde=new RegExp("[~\\*/\\[\\]]");function O4(n,e,t){if(e.search(Sde)>=0)throw iE(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new AS(...e.split("."))._internalPath}catch{throw iE(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function iE(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new gt(Xe.INVALID_ARGUMENT,o+n+l)}function Hj(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Bs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Tde(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(M4("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Tde extends Wj{data(){return super.data()}}function M4(n,e){return typeof e=="string"?O4(n,e):e instanceof AS?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cde(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new gt(Xe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class F4{}class Ade extends F4{}function V0(n,e,...t){let r=[];e instanceof F4&&r.push(e),r=r.concat(t),(function(i){const a=i.filter((l=>l instanceof B4)).length,o=i.filter((l=>l instanceof RS)).length;if(a>1||a>0&&o>0)throw new gt(Xe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class RS extends Ade{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new RS(e,t,r)}_apply(e){const t=this._parse(e);return qj(e._query,t),new Vg(e.firestore,e.converter,rI(e._query,t))}_parse(e){const t=kS(e.firestore);return(function(i,a,o,l,c,u,d){let p;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new gt(Xe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){M8(d,u);const y=[];for(const v of d)y.push(O8(l,i,v));p={arrayValue:{values:y}}}else p=O8(l,i,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||M8(d,u),p=Ede(o,a,d,u==="in"||u==="not-in");return Xs.create(c,u,p)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function U0(n,e,t){const r=e,s=M4("where",n);return RS._create(s,r,t)}class B4 extends F4{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new B4(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:gc.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)qj(a,l),a=rI(a,l)})(e._query,t),new Vg(e.firestore,e.converter,rI(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function O8(n,e,t){if(typeof(t=js(t))=="string"){if(t==="")throw new gt(Xe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vz(e)&&t.indexOf("/")!==-1)throw new gt(Xe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Vr.fromString(t));if(!Lt.isDocumentKey(r))throw new gt(Xe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return JM(n,new Lt(r))}if(t instanceof Bs)return JM(n,t._key);throw new gt(Xe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${pS(t)}.`)}function M8(n,e){if(!Array.isArray(n)||n.length===0)throw new gt(Xe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qj(n,e){const t=(function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new gt(Xe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new gt(Xe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Nde{convertValue(e,t="none"){switch(of(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ms(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(af(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Xt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Af(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[Z2].arrayValue?.values?.map((r=>Ms(r.doubleValue)));return new lu(t)}convertGeoPoint(e){return new ou(Ms(e.latitude),Ms(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=xS(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(t1(e));default:return null}}convertTimestamp(e){const t=sf(e);return new Xr(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Vr.fromString(e);vr(hj(r),9688,{name:e});const s=new n1(r.get(1),r.get(3)),i=new Lt(r.popFirst(5));return s.isEqual(t)||Th(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kj(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Ey{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Lp extends Wj{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(M4("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new gt(Xe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Lp._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Lp._jsonSchemaVersion="firestore/documentSnapshot/1.0",Lp._jsonSchema={type:Ys("string",Lp._jsonSchemaVersion),bundleSource:Ys("string","DocumentSnapshot"),bundleName:Ys("string"),bundle:Ys("string")};class Rw extends Lp{data(e={}){return super.data(e)}}class Z0{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Ey(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Rw(this._firestore,this._userDataWriter,r.key,r,new Ey(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new gt(Xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((o=>{const l=new Rw(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Ey(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((o=>i||o.type!==3)).map((o=>{const l=new Rw(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Ey(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:kde(o.type),doc:l,oldIndex:c,newIndex:u}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new gt(Xe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Z0._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=l4.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function kde(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xt(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(n){n=gu(n,Bs);const e=gu(n.firestore,Ug);return fde(D4(e),n._key).then((t=>Ide(e,n,t)))}Z0._jsonSchemaVersion="firestore/querySnapshot/1.0",Z0._jsonSchema={type:Ys("string",Z0._jsonSchemaVersion),bundleSource:Ys("string","QuerySnapshot"),bundleName:Ys("string"),bundle:Ys("string")};class Xj extends Nde{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Bs(this.firestore,null,t)}}function lh(n){n=gu(n,Vg);const e=gu(n.firestore,Ug),t=D4(e),r=new Xj(e);return Cde(n._query),pde(t,n._query).then((s=>new Z0(e,r,n,s)))}function Yj(n,e,t){n=gu(n,Bs);const r=gu(n.firestore,Ug),s=Kj(n.converter,e,t);return z4(r,[Vj(kS(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,uc.none())])}function G0(n,e,t,...r){n=gu(n,Bs);const s=gu(n.firestore,Ug),i=kS(s);let a;return a=typeof(e=js(e))=="string"||e instanceof AS?wde(i,"updateDoc",n._key,e,t,r):_de(i,"updateDoc",n._key,e),z4(s,[a.toMutation(n._key,uc.exists(!0))])}function Zj(n,e){const t=gu(n.firestore,Ug),r=yu(n),s=Kj(n.converter,e);return z4(t,[Vj(kS(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,uc.exists(!1))]).then((()=>r))}function z4(n,e){return(function(r,s){const i=new yh;return r.asyncQueue.enqueueAndForget((async()=>tde(await dde(r),s,i))),i.promise})(D4(n),e)}function Ide(n,e,t){const r=t.docs.get(e._key),s=new Xj(n);return new Lp(n,s,e._key,r,new Ey(t.hasPendingWrites,t.fromCache),e.converter)}function Qj(){return new L4("serverTimestamp")}(function(e,t=!0){(function(s){Fg=s})(Sm),Wp(new nf("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),o=new Ug(new _ce(r.getProvider("auth-internal")),new Sce(a,r.getProvider("app-check-internal")),(function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new gt(Xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new n1(c.options.projectId,u)})(a,s),a);return i={useFetchStreams:t,...i},o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),nu(zM,jM,e),nu(zM,jM,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj="firebasestorage.googleapis.com",eV="storageBucket",Rde=120*1e3,Dde=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Ru{constructor(e,t,r=0){super(LN(e),`Firebase Storage: ${t} (${LN(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ts.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return LN(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ws;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ws||(ws={}));function LN(n){return"storage/"+n}function j4(){const n="An unknown error occurred, please check the error payload for server response.";return new Ts(ws.UNKNOWN,n)}function $de(n){return new Ts(ws.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Lde(n){return new Ts(ws.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Pde(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ts(ws.UNAUTHENTICATED,n)}function Ode(){return new Ts(ws.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Mde(n){return new Ts(ws.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Fde(){return new Ts(ws.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Bde(){return new Ts(ws.CANCELED,"User canceled the upload/download.")}function zde(n){return new Ts(ws.INVALID_URL,"Invalid URL '"+n+"'.")}function jde(n){return new Ts(ws.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Vde(){return new Ts(ws.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+eV+"' property when initializing the app?")}function Ude(){return new Ts(ws.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Gde(){return new Ts(ws.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Hde(n){return new Ts(ws.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function mI(n){return new Ts(ws.INVALID_ARGUMENT,n)}function tV(){return new Ts(ws.APP_DELETED,"The Firebase app was deleted.")}function Wde(n){return new Ts(ws.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function jy(n,e){return new Ts(ws.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function ay(n){throw new Ts(ws.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Zo.makeFromUrl(e,t)}catch{return new Zo(e,"")}if(r.path==="")return r;throw jde(e)}static makeFromUrl(e,t){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+s+a,"i"),l={bucket:1,path:3};function c(I){I.path_=decodeURIComponent(I.path)}const u="v[A-Za-z0-9_]+",d=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",x=new RegExp(`^https?://${d}/${u}/b/${s}/o${p}`,"i"),y={bucket:1,path:3},v=t===Jj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,b="([^?#]*)",S=new RegExp(`^https?://${v}/${s}/${b}`,"i"),C=[{regex:o,indices:l,postModify:i},{regex:x,indices:y,postModify:c},{regex:S,indices:{bucket:1,path:2},postModify:c}];for(let I=0;I<C.length;I++){const $=C[I],q=$.regex.exec(e);if(q){const U=q[$.indices.bucket];let F=q[$.indices.path];F||(F=""),r=new Zo(U,F),$.postModify(r);break}}if(r==null)throw zde(e);return r}}class qde{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kde(n,e,t){let r=1,s=null,i=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...b){c||(c=!0,e.apply(null,b))}function d(b){s=setTimeout(()=>{s=null,n(x,l())},b)}function p(){i&&clearTimeout(i)}function x(b,...S){if(c){p();return}if(b){p(),u.call(null,b,...S);return}if(l()||a){p(),u.call(null,b,...S);return}r<64&&(r*=2);let C;o===1?(o=2,C=0):C=(r+Math.random())*1e3,d(C)}let y=!1;function v(b){y||(y=!0,p(),!c&&(s!==null?(b||(o=2),clearTimeout(s),d(0)):b||(o=1)))}return d(0),i=setTimeout(()=>{a=!0,v(!0)},t),v}function Xde(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yde(n){return n!==void 0}function Zde(n){return typeof n=="object"&&!Array.isArray(n)}function V4(n){return typeof n=="string"||n instanceof String}function F8(n){return U4()&&n instanceof Blob}function U4(){return typeof Blob<"u"}function B8(n,e,t,r){if(r<e)throw mI(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw mI(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G4(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function nV(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const s=e(r)+"="+e(n[r]);t=t+s+"&"}return t=t.slice(0,-1),t}var Pp;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Pp||(Pp={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qde(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jde{constructor(e,t,r,s,i,a,o,l,c,u,d,p=!0,x=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=d,this.retry=p,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,v)=>{this.resolve_=y,this.reject_=v,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Y_(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===Pp.NO_ERROR,l=i.getStatus();if(!o||Qde(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===Pp.ABORT;r(!1,new Y_(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Y_(c,i))})},t=(r,s)=>{const i=this.resolve_,a=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Yde(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=j4();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(s.canceled){const l=this.appDelete_?tV():Bde();a(l)}else{const l=Fde();a(l)}};this.canceled_?t(!1,new Y_(!1,null,!0)):this.backoffId_=Kde(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Xde(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Y_{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function efe(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function tfe(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function nfe(n,e){e&&(n["X-Firebase-GMPID"]=e)}function rfe(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function sfe(n,e,t,r,s,i,a=!0,o=!1){const l=nV(n.urlParams),c=n.url+l,u=Object.assign({},n.headers);return nfe(u,e),efe(u,t),tfe(u,i),rfe(u,r),new Jde(c,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,a,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ife(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function afe(...n){const e=ife();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(U4())return new Blob(n);throw new Ts(ws.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function ofe(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lfe(n){if(typeof atob>"u")throw Hde("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zc={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class PN{constructor(e,t){this.data=e,this.contentType=t||null}}function cfe(n,e){switch(n){case Zc.RAW:return new PN(rV(e));case Zc.BASE64:case Zc.BASE64URL:return new PN(sV(n,e));case Zc.DATA_URL:return new PN(hfe(e),dfe(e))}throw j4()}function rV(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=r,a=n.charCodeAt(++t);r=65536|(i&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function ufe(n){let e;try{e=decodeURIComponent(n)}catch{throw jy(Zc.DATA_URL,"Malformed data URL.")}return rV(e)}function sV(n,e){switch(n){case Zc.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw jy(n,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Zc.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw jy(n,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=lfe(e)}catch(s){throw s.message.includes("polyfill")?s:jy(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}class iV{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw jy(Zc.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=ffe(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function hfe(n){const e=new iV(n);return e.base64?sV(Zc.BASE64,e.rest):ufe(e.rest)}function dfe(n){return new iV(n).contentType}function ffe(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,t){let r=0,s="";F8(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(F8(this.data_)){const r=this.data_,s=ofe(r,e,t);return s===null?null:new Md(s)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Md(r,!0)}}static getBlob(...e){if(U4()){const t=e.map(r=>r instanceof Md?r.data_:r);return new Md(afe.apply(null,t))}else{const t=e.map(a=>V4(a)?cfe(Zc.RAW,a).data:a.data_);let r=0;t.forEach(a=>{r+=a.byteLength});const s=new Uint8Array(r);let i=0;return t.forEach(a=>{for(let o=0;o<a.length;o++)s[i++]=a[o]}),new Md(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aV(n){let e;try{e=JSON.parse(n)}catch{return null}return Zde(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pfe(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function mfe(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function oV(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gfe(n,e){return e}class Ka{constructor(e,t,r,s){this.server=e,this.local=t||e,this.writable=!!r,this.xform=s||gfe}}let Z_=null;function xfe(n){return!V4(n)||n.length<2?n:oV(n)}function lV(){if(Z_)return Z_;const n=[];n.push(new Ka("bucket")),n.push(new Ka("generation")),n.push(new Ka("metageneration")),n.push(new Ka("name","fullPath",!0));function e(i,a){return xfe(a)}const t=new Ka("name");t.xform=e,n.push(t);function r(i,a){return a!==void 0?Number(a):a}const s=new Ka("size");return s.xform=r,n.push(s),n.push(new Ka("timeCreated")),n.push(new Ka("updated")),n.push(new Ka("md5Hash",null,!0)),n.push(new Ka("cacheControl",null,!0)),n.push(new Ka("contentDisposition",null,!0)),n.push(new Ka("contentEncoding",null,!0)),n.push(new Ka("contentLanguage",null,!0)),n.push(new Ka("contentType",null,!0)),n.push(new Ka("metadata","customMetadata",!0)),Z_=n,Z_}function yfe(n,e){function t(){const r=n.bucket,s=n.fullPath,i=new Zo(r,s);return e._makeStorageReference(i)}Object.defineProperty(n,"ref",{get:t})}function bfe(n,e,t){const r={};r.type="file";const s=t.length;for(let i=0;i<s;i++){const a=t[i];r[a.local]=a.xform(r,e[a.server])}return yfe(r,n),r}function cV(n,e,t){const r=aV(e);return r===null?null:bfe(n,r,t)}function vfe(n,e,t,r){const s=aV(e);if(s===null||!V4(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(c=>{const u=n.bucket,d=n.fullPath,p="/b/"+a(u)+"/o/"+a(d),x=G4(p,t,r),y=nV({alt:"media",token:c});return x+y})[0]}function _fe(n,e){const t={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(t[i.server]=n[i.local])}return JSON.stringify(t)}class uV{constructor(e,t,r,s){this.url=e,this.method=t,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hV(n){if(!n)throw j4()}function wfe(n,e){function t(r,s){const i=cV(n,s,e);return hV(i!==null),i}return t}function Efe(n,e){function t(r,s){const i=cV(n,s,e);return hV(i!==null),vfe(i,s,n.host,n._protocol)}return t}function dV(n){function e(t,r){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=Ode():s=Pde():t.getStatus()===402?s=Lde(n.bucket):t.getStatus()===403?s=Mde(n.path):s=r,s.status=t.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Sfe(n){const e=dV(n);function t(r,s){let i=e(r,s);return r.getStatus()===404&&(i=$de(n.path)),i.serverResponse=s.serverResponse,i}return t}function Tfe(n,e,t){const r=e.fullServerUrl(),s=G4(r,n.host,n._protocol),i="GET",a=n.maxOperationRetryTime,o=new uV(s,i,Efe(n,t),a);return o.errorHandler=Sfe(e),o}function Cfe(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Afe(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=Cfe(null,e)),r}function Nfe(n,e,t,r,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let C="";for(let I=0;I<2;I++)C=C+Math.random().toString().slice(2);return C}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const c=Afe(e,r,s),u=_fe(c,t),d="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,p=`\r
--`+l+"--",x=Md.getBlob(d,r,p);if(x===null)throw Ude();const y={name:c.fullPath},v=G4(i,n.host,n._protocol),b="POST",S=n.maxUploadRetryTime,T=new uV(v,b,wfe(n,t),S);return T.urlParams=y,T.headers=a,T.body=x.uploadData(),T.errorHandler=dV(e),T}class kfe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Pp.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Pp.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Pp.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,s,i){if(this.sent_)throw ay("cannot .send() more than once");if(Sf(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ay("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ay("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ay("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ay("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Ife extends kfe{initXhr(){this.xhr_.responseType="text"}}function fV(){return new Ife}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e,t){this._service=e,t instanceof Zo?this._location=t:this._location=Zo.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Zp(e,t)}get root(){const e=new Zo(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return oV(this._location.path)}get storage(){return this._service}get parent(){const e=pfe(this._location.path);if(e===null)return null;const t=new Zo(this._location.bucket,e);return new Zp(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Wde(e)}}function Rfe(n,e,t){n._throwIfRoot("uploadBytes");const r=Nfe(n.storage,n._location,lV(),new Md(e,!0),t);return n.storage.makeRequestWithTokens(r,fV).then(s=>({metadata:s,ref:n}))}function Dfe(n){n._throwIfRoot("getDownloadURL");const e=Tfe(n.storage,n._location,lV());return n.storage.makeRequestWithTokens(e,fV).then(t=>{if(t===null)throw Gde();return t})}function $fe(n,e){const t=mfe(n._location.path,e),r=new Zo(n._location.bucket,t);return new Zp(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lfe(n){return/^[A-Za-z]+:\/\//.test(n)}function Pfe(n,e){return new Zp(n,e)}function pV(n,e){if(n instanceof H4){const t=n;if(t._bucket==null)throw Vde();const r=new Zp(t,t._bucket);return e!=null?pV(r,e):r}else return e!==void 0?$fe(n,e):n}function Ofe(n,e){if(e&&Lfe(e)){if(n instanceof H4)return Pfe(n,e);throw mI("To use ref(service, url), the first argument must be a Storage instance.")}else return pV(n,e)}function z8(n,e){const t=e?.[eV];return t==null?null:Zo.makeFromBucketSpec(t,n)}function Mfe(n,e,t,r={}){n.host=`${e}:${t}`;const s=Sf(e);s&&(q3(`https://${n.host}/b`),K3("Storage",!0)),n._isUsingEmulator=!0,n._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:I7(i,n.app.options.projectId))}class H4{constructor(e,t,r,s,i,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=a,this._bucket=null,this._host=Jj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Rde,this._maxUploadRetryTime=Dde,this._requests=new Set,s!=null?this._bucket=Zo.makeFromBucketSpec(s,this._host):this._bucket=z8(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Zo.makeFromBucketSpec(this._url,e):this._bucket=z8(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){B8("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){B8("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ko(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Zp(this,e)}_makeRequest(e,t,r,s,i=!0){if(this._deleted)return new qde(tV());{const a=sfe(e,this._appId,r,s,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,s).getPromise()}}const j8="@firebase/storage",V8="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mV="storage";function Dw(n,e,t){return n=js(n),Rfe(n,e,t)}function $w(n){return n=js(n),Dfe(n)}function Lw(n,e){return n=js(n),Ofe(n,e)}function gV(n=Z3(),e){n=js(n);const r=uS(n,mV).getImmediate({identifier:e}),s=A7("storage");return s&&Ffe(r,...s),r}function Ffe(n,e,t,r={}){Mfe(n,e,t,r)}function Bfe(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new H4(t,r,s,e,Sm)}function zfe(){Wp(new nf(mV,Bfe,"PUBLIC").setMultipleInstances(!0)),nu(j8,V8,""),nu(j8,V8,"esm2020")}zfe();const jfe={apiKey:"AIzaSyDkc9f6Sr4Kq8s9MtwWK9k3i217Gjk9PBg",authDomain:"blue-3b61a.firebaseapp.com",projectId:"blue-3b61a",storageBucket:"blue-3b61a.firebasestorage.app",messagingSenderId:"55986917972",appId:"1:55986917972:web:70e7efc4452a1aab7393c1",measurementId:"G-22BEHR5BE0"},W4=$7(jfe),hf=xce(W4),Xi=gde(W4),ON=gV(W4);function Vfe(){const[n,e]=Se.useState(""),[t,r]=Se.useState(""),[s,i]=Se.useState(!1),a=j1(),o=async()=>{try{i(!0);const c=(await sle(hf,n,t)).user.uid,u=await DS(yu(Xi,"users",c));if(u.exists()){const{role:d}=u.data();localStorage.setItem("userRole",d),localStorage.setItem("userEmail",n),a(`/${d}`)}else alert("No role found for this user!")}catch(l){alert("Login failed: "+l.message)}finally{i(!1)}};return _.jsxs("div",{className:"login-container",children:[_.jsxs("div",{className:"login-card",children:[_.jsx("div",{className:"profile-icon",children:"👨🏻‍💼"}),_.jsx("h2",{className:"login-title",children:"Login"}),_.jsx("input",{type:"email",placeholder:"Email ID",className:"login-input",value:n,onChange:l=>e(l.target.value)}),_.jsx("input",{type:"password",placeholder:"Password",className:"login-input",value:t,onChange:l=>r(l.target.value)}),_.jsx("button",{onClick:o,className:"login-btn",disabled:s,children:s?"Logging in...":"LOGIN"}),s&&_.jsx("div",{className:"spinner"})," ",_.jsxs("div",{className:"auth-link",children:["Don't have an account? ",_.jsx(Dt,{to:"/signup",children:"Sign Up"})]})]}),_.jsx("div",{className:"back",children:_.jsx("a",{href:"./",children:_.jsx("button",{children:"❮ Back to Home"})})})]})}function Ufe(){const[n,e]=Se.useState(""),[t,r]=Se.useState(""),[s,i]=Se.useState(""),[a,o]=Se.useState(""),[l,c]=Se.useState(""),[u,d]=Se.useState(!1),p=j1(),x=async()=>{if(!l){alert("Please select a role!");return}if(s!==a){alert("Passwords don't match!");return}if(!n||!t||!s){alert("Please fill all fields!");return}try{d(!0);const v=(await rle(hf,t,s)).user.uid;await Yj(yu(Xi,"users",v),{name:n,email:t,role:l,createdAt:new Date}),alert("Account created successfully!"),p("/login")}catch(y){alert("Signup failed: "+y.message)}finally{d(!1)}};return _.jsxs("div",{className:"login-container",children:[_.jsxs("div",{className:"login-card",children:[_.jsx("div",{className:"profile-icon",children:"👨🏻‍💼"}),_.jsx("h2",{className:"login-title",children:"Create Account"}),_.jsx("input",{type:"text",placeholder:"Full Name",className:"login-input",value:n,onChange:y=>e(y.target.value)}),_.jsx("input",{type:"email",placeholder:"Email ID",className:"login-input",value:t,onChange:y=>r(y.target.value)}),_.jsx("input",{type:"password",placeholder:"Password",className:"login-input",value:s,onChange:y=>i(y.target.value)}),_.jsx("input",{type:"password",placeholder:"Confirm Password",className:"login-input",value:a,onChange:y=>o(y.target.value)}),_.jsxs("div",{className:"role-buttons",children:[_.jsx("button",{onClick:()=>c("farmer"),className:l==="farmer"?"active":"",children:"🌾 Farmer"}),_.jsx("button",{onClick:()=>c("buyer"),className:l==="buyer"?"active":"",children:"🛒 Buyer"}),_.jsx("button",{onClick:()=>c("admin"),className:l==="admin"?"active":"",children:"🛡️ Admin"})]}),_.jsx("button",{onClick:x,className:"login-btn",disabled:u,children:u?"Creating Account...":"CREATE ACCOUNT"}),u&&_.jsx("div",{className:"spinner"})," ",_.jsxs("div",{className:"auth-link",children:["Already have an account? ",_.jsx(Dt,{to:"/login",children:"Sign In"})]})]}),_.jsx("div",{className:"back",children:_.jsx("a",{href:"./",children:_.jsx("button",{children:" ❮ Back to Home "})})})]})}const Gfe="/assets/farmer-vBGYqOLb.jpg";function Hfe(){return _.jsxs("div",{className:"home-container",children:[_.jsxs("div",{className:"hero-section hero-farmer",children:[_.jsx("div",{className:"hero-background",children:_.jsx("img",{src:Gfe,alt:"farmer.jpg"})}),_.jsxs("div",{className:"hero-content",children:[_.jsx("div",{className:"hero-badge",children:"🌾 Farmer Portal"}),_.jsx("h1",{className:"hero-title",children:"Protecting Blue Carbon Ecosystems"}),_.jsx("p",{className:"hero-subtitle",children:"Monitor, report, and verify  carbon projects with transparent blockchain technology and community-driven impact tracking."}),_.jsxs("div",{className:"hero-actions",children:[_.jsx(Dt,{to:"/add-project",className:"btn-hero-primary",children:"Start New Project"}),_.jsx(Dt,{to:"/mrv-dashboard",className:"btn-hero-secondary",children:"View Dashboard"})]})]})]}),_.jsxs("div",{className:"dashboard-grid",children:[_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"🌱"}),_.jsx("h3",{children:"My Projects"}),_.jsx("p",{children:"View and manage your carbon sequestration projects"}),_.jsx(Dt,{to:"/add-project",className:"card-button",children:"Add New Project"})]}),_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"📊"}),_.jsx("h3",{children:"MRV Dashboard"}),_.jsx("p",{children:"Monitor, Report, and Verify your carbon credits"}),_.jsx(Dt,{to:"/mrv-dashboard",className:"card-button",children:"View Dashboard"})]}),_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"💰"}),_.jsx("h3",{children:"Marketplace"}),_.jsx("p",{children:"Sell your verified carbon credits"}),_.jsx(Dt,{to:"/marketplace",className:"card-button",children:"Go to Market"})]}),_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"📈"}),_.jsx("h3",{children:"Analytics"}),_.jsx("p",{children:"Track your environmental and financial impact"}),_.jsx(Dt,{to:"/analytics",className:"card-button",children:"View Analytics"})]})]}),_.jsxs("div",{className:"recent-activity",children:[_.jsx("h2",{children:"Recent Activity"}),_.jsxs("div",{className:"activity-list",children:[_.jsxs("div",{className:"activity-item",children:[_.jsx("span",{className:"activity-icon",children:"✅"}),_.jsx("span",{children:'Project "Mangrove Restoration" verified'}),_.jsx("span",{className:"activity-time",children:"2 hours ago"})]}),_.jsxs("div",{className:"activity-item",children:[_.jsx("span",{className:"activity-icon",children:"💰"}),_.jsx("span",{children:"Sold 150 carbon credits"}),_.jsx("span",{className:"activity-time",children:"1 day ago"})]}),_.jsxs("div",{className:"activity-item",children:[_.jsx("span",{className:"activity-icon",children:"📊"}),_.jsx("span",{children:"Monthly MRV report submitted"}),_.jsx("span",{className:"activity-time",children:"3 days ago"})]})]})]}),_.jsxs("footer",{className:"footer",children:[_.jsxs("p",{children:["© ",new Date().getFullYear()," BlueCarbon Farmers. All rights reserved."]}),_.jsxs("div",{className:"footer-links",children:[_.jsx(Dt,{to:"/about",children:"About"}),_.jsx(Dt,{to:"/contact",children:"Contact"}),_.jsx(Dt,{to:"/privacy",children:"Privacy Policy"})]})]})]})}const Wfe="/assets/admin-DCDuZu97.png";function qfe(){const[n,e]=Se.useState({activeProjects:0,pendingProjects:0,totalCreditsGenerated:0,totalFarmers:0,totalBuyers:0});return Se.useEffect(()=>{(async()=>{try{const r=uf(Xi,"projects"),s=uf(Xi,"users"),i=await lh(V0(r,U0("status","==","verified"))),a=await lh(V0(r,U0("status","==","pending")));let o=0;(await lh(r)).forEach(d=>{const p=d.data();o+=parseFloat(p.creditsGenerated||0)});const c=await lh(V0(s,U0("role","==","farmer"))),u=await lh(V0(s,U0("role","==","buyer")));e({activeProjects:i.size,pendingProjects:a.size,totalCreditsGenerated:o,totalFarmers:c.size,totalBuyers:u.size})}catch(r){console.error("Error fetching stats:",r)}})()},[]),_.jsxs("div",{className:"home-container",children:[_.jsxs("div",{className:"hero-section hero-admin",style:{height:"50vh",minHeight:"50vh",maxHeight:"50vh",backgroundImage:`url(${Wfe})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[_.jsx("div",{className:"admin-admin",children:_.jsx("h1",{children:"Welcome to the Admin Site."})}),_.jsx("div",{className:"hero-content",children:_.jsx("div",{className:"hero-actions",children:_.jsx(Dt,{to:"/project-verification",className:"btn-hero-primary",children:"Review Projects"})})})]}),_.jsxs("div",{className:"dashboard-grid",children:[_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"✅"}),_.jsx("h3",{children:"Project Verification"}),_.jsx("p",{children:"Review and approve carbon credit projects"}),_.jsx(Dt,{to:"/project-verification",className:"card-button",children:"Review Projects"})]}),_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"📊"}),_.jsx("h3",{children:"Platform Analytics"}),_.jsx("p",{children:"Monitor platform performance and transactions"}),_.jsx(Dt,{to:"/platform-analytics",className:"card-button",children:"View Analytics"})]}),_.jsxs("div",{className:"dashboard-card",children:[_.jsx("div",{className:"card-icon",children:"⚙️"}),_.jsx("h3",{children:"System Settings"}),_.jsx("p",{children:"Configure platform settings and parameters"}),_.jsx(Dt,{to:"/system-settings",className:"card-button",children:"Settings"})]})]}),_.jsxs("div",{className:"admin-stats",children:[_.jsx("h2",{children:"Platform Overview"}),_.jsxs("div",{className:"stats-grid",children:[_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:n.activeProjects}),_.jsx("div",{className:"stat-label",children:"Verified Projects"})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:n.totalFarmers}),_.jsx("div",{className:"stat-label",children:"Registered Farmers"})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:n.totalBuyers}),_.jsx("div",{className:"stat-label",children:"Active Buyers"})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:n.totalCreditsGenerated}),_.jsx("div",{className:"stat-label",children:"Credits Generated"})]})]})]}),_.jsxs("div",{className:"pending-actions",children:[_.jsx("h2",{children:"Pending Actions"}),_.jsx("div",{className:"action-list",children:_.jsxs("div",{className:`action-item ${n.pendingProjects>0?"urgent":""}`,children:[_.jsx("span",{className:"action-icon",children:"⚠️"}),_.jsxs("span",{children:[n.pendingProjects," projects awaiting verification"]}),_.jsx(Dt,{to:"/project-verification",className:"action-link",children:"Review"})]})})]})]})}function Kfe(){const[n,e]=Se.useState({firstName:"",lastName:"",email:"",phone:"",organization:"",role:"",location:"",bio:"",profileImage:null}),[t,r]=Se.useState(!0),s=j1();Se.useEffect(()=>{const l=s4(hf,async c=>{if(c){const u=yu(Xi,"users",c.uid),d=await DS(u);d.exists()?e({...d.data(),profileImage:null}):e(p=>({...p,email:c.email}))}r(!1)});return()=>l()},[]);const i=l=>{const{name:c,value:u}=l.target;e(d=>({...d,[c]:u}))},a=l=>{const c=l.target.files[0];c&&e(u=>({...u,profileImage:c}))},o=async l=>{l.preventDefault();try{const c=hf.currentUser;if(!c)return alert("You must be signed in to save profile.");let u=n.profileImageUrl||"";const d=n.profileImage;if(d instanceof File){const p=gV(),x=Lw(p,`profiles/${c.uid}_${Date.now()}`);await Dw(x,d),u=await $w(x)}await Yj(yu(Xi,"users",c.uid),{...n,profileImageUrl:u,profileImage:null,updatedAt:Qj(),email:c.email},{merge:!0}),alert("Profile saved successfully!"),s(`/${n.role||"dashboard"}`)}catch(c){console.error("Profile save error:",c),alert("Error saving profile: "+c.message)}};return t?_.jsx("p",{children:"Loading..."}):_.jsxs("div",{className:"profile-container",children:[_.jsxs("div",{className:"profile-header",children:[_.jsx("h1",{className:"profile-title",children:"🔧 Build Your Profile"}),_.jsx("p",{className:"profile-subtitle",children:"Complete your profile to get the most out of the platform"})]}),_.jsxs("form",{className:"profile-form",onSubmit:o,children:[_.jsxs("div",{className:"form-section",children:[_.jsx("h3",{children:"Personal Information"}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"firstName",children:"First Name *"}),_.jsx("input",{type:"text",id:"firstName",name:"firstName",value:n.firstName,onChange:i,required:!0,placeholder:"Enter your first name"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),_.jsx("input",{type:"text",id:"lastName",name:"lastName",value:n.lastName,onChange:i,required:!0,placeholder:"Enter your last name"})]})]}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"email",children:"Email Address *"}),_.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:i,required:!0,placeholder:"Enter your email"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"phone",children:"Phone Number"}),_.jsx("input",{type:"tel",id:"phone",name:"phone",value:n.phone,onChange:i,placeholder:"Enter your phone number"})]})]})]}),_.jsxs("div",{className:"form-section",children:[_.jsx("h3",{children:"Professional Information"}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"organization",children:"Organization"}),_.jsx("input",{type:"text",id:"organization",name:"organization",value:n.organization,onChange:i,placeholder:"Company/Organization name"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"role",children:"Role *"}),_.jsxs("select",{id:"role",name:"role",value:n.role,onChange:i,required:!0,children:[_.jsx("option",{value:"",children:"Select your role"}),_.jsx("option",{value:"farmer",children:"Farmer"}),_.jsx("option",{value:"buyer",children:"Buyer"}),_.jsx("option",{value:"admin",children:"Admin"}),_.jsx("option",{value:"verifier",children:"Verifier"})]})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"location",children:"Location"}),_.jsx("input",{type:"text",id:"location",name:"location",value:n.location,onChange:i,placeholder:"City, Country"})]})]}),_.jsxs("div",{className:"form-section",children:[_.jsx("h3",{children:"Additional Information"}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"profileImage",children:"Profile Image"}),_.jsx("input",{type:"file",id:"profileImage",name:"profileImage",accept:"image/*",onChange:a,className:"file-input"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"bio",children:"Bio"}),_.jsx("textarea",{id:"bio",name:"bio",value:n.bio,onChange:i,placeholder:"Tell us about yourself...",rows:"4"})]})]}),_.jsxs("div",{className:"form-actions",children:[_.jsx("button",{type:"submit",className:"btn-primary",children:"Save Profile"}),_.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>s(`/${n.role||"dashboard"}`),children:"Skip for Now"})]})]})]})}function U8(){const[n,e]=Se.useState(null),[t,r]=Se.useState(!0),s=j1();Se.useEffect(()=>{const a=s4(hf,async o=>{if(o){const l=yu(Xi,"users",o.uid),c=await DS(l);c.exists()&&e(c.data())}r(!1)});return()=>a()},[]);const i=()=>s("/profile-form");return t?_.jsx("p",{children:"Loading..."}):n?_.jsxs("div",{className:"profile-display-container",children:[_.jsxs("div",{className:"profile-header-section",children:[_.jsx("div",{className:"profile-cover",children:_.jsx("div",{className:"profile-avatar",children:n.profileImageUrl?_.jsx("img",{src:n.profileImageUrl,alt:"Profile"}):_.jsxs("div",{className:"avatar-placeholder",children:[n.firstName?.charAt(0),n.lastName?.charAt(0)]})})}),_.jsxs("div",{className:"profile-info",children:[_.jsxs("div",{className:"profile-name-section",children:[_.jsxs("h1",{children:[n.firstName," ",n.lastName]}),_.jsx("p",{children:n.role}),_.jsxs("p",{children:["📍 ",n.location]})]}),_.jsxs("div",{className:"profile-actions",children:[_.jsx("button",{onClick:i,className:"btn-edit",children:"✏️ Edit Profile"}),_.jsx("button",{className:"btn-connect",children:"🤝 Connect"}),_.jsx("button",{className:"btn-message",children:"💬 Message"})]})]})]}),_.jsxs("div",{className:"profile-content",children:[_.jsxs("div",{className:"profile-card",children:[_.jsx("h3",{children:"About"}),_.jsx("p",{children:n.bio||"No bio available"})]}),_.jsxs("div",{className:"profile-card",children:[_.jsx("h3",{children:"Contact Information"}),_.jsxs("p",{children:["📧 ",n.email]}),n.phone&&_.jsxs("p",{children:["📱 ",n.phone]})]}),_.jsxs("div",{className:"profile-card",children:[_.jsx("h3",{children:"Professional Information"}),_.jsxs("p",{children:["🏢 ",n.organization]}),_.jsxs("p",{children:["Role: ",n.role]})]})]})]}):_.jsx("div",{className:"profile-display-container",children:_.jsxs("div",{className:"no-profile",children:[_.jsx("h2",{children:"No Profile Found"}),_.jsx("p",{children:"Please complete your profile first."}),_.jsx("button",{onClick:()=>s("/profile-form"),className:"btn-primary",children:"Create Profile"})]})})}var Sy={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var Xfe=Sy.exports,G8;function Yfe(){return G8||(G8=1,(function(n,e){(function(t,r){r(e)})(Xfe,(function(t){var r="1.9.4";function s(m){var w,k,H,ee;for(k=1,H=arguments.length;k<H;k++){ee=arguments[k];for(w in ee)m[w]=ee[w]}return m}var i=Object.create||(function(){function m(){}return function(w){return m.prototype=w,new m}})();function a(m,w){var k=Array.prototype.slice;if(m.bind)return m.bind.apply(m,k.call(arguments,1));var H=k.call(arguments,2);return function(){return m.apply(w,H.length?H.concat(k.call(arguments)):arguments)}}var o=0;function l(m){return"_leaflet_id"in m||(m._leaflet_id=++o),m._leaflet_id}function c(m,w,k){var H,ee,oe,ge;return ge=function(){H=!1,ee&&(oe.apply(k,ee),ee=!1)},oe=function(){H?ee=arguments:(m.apply(k,arguments),setTimeout(ge,w),H=!0)},oe}function u(m,w,k){var H=w[1],ee=w[0],oe=H-ee;return m===H&&k?m:((m-ee)%oe+oe)%oe+ee}function d(){return!1}function p(m,w){if(w===!1)return m;var k=Math.pow(10,w===void 0?6:w);return Math.round(m*k)/k}function x(m){return m.trim?m.trim():m.replace(/^\s+|\s+$/g,"")}function y(m){return x(m).split(/\s+/)}function v(m,w){Object.prototype.hasOwnProperty.call(m,"options")||(m.options=m.options?i(m.options):{});for(var k in w)m.options[k]=w[k];return m.options}function b(m,w,k){var H=[];for(var ee in m)H.push(encodeURIComponent(k?ee.toUpperCase():ee)+"="+encodeURIComponent(m[ee]));return(!w||w.indexOf("?")===-1?"?":"&")+H.join("&")}var S=/\{ *([\w_ -]+) *\}/g;function T(m,w){return m.replace(S,function(k,H){var ee=w[H];if(ee===void 0)throw new Error("No value provided for variable "+k);return typeof ee=="function"&&(ee=ee(w)),ee})}var C=Array.isArray||function(m){return Object.prototype.toString.call(m)==="[object Array]"};function I(m,w){for(var k=0;k<m.length;k++)if(m[k]===w)return k;return-1}var $="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function q(m){return window["webkit"+m]||window["moz"+m]||window["ms"+m]}var U=0;function F(m){var w=+new Date,k=Math.max(0,16-(w-U));return U=w+k,window.setTimeout(m,k)}var G=window.requestAnimationFrame||q("RequestAnimationFrame")||F,V=window.cancelAnimationFrame||q("CancelAnimationFrame")||q("CancelRequestAnimationFrame")||function(m){window.clearTimeout(m)};function O(m,w,k){if(k&&G===F)m.call(w);else return G.call(window,a(m,w))}function K(m){m&&V.call(window,m)}var P={__proto__:null,extend:s,create:i,bind:a,get lastId(){return o},stamp:l,throttle:c,wrapNum:u,falseFn:d,formatNum:p,trim:x,splitWords:y,setOptions:v,getParamString:b,template:T,isArray:C,indexOf:I,emptyImageUrl:$,requestFn:G,cancelFn:V,requestAnimFrame:O,cancelAnimFrame:K};function N(){}N.extend=function(m){var w=function(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},k=w.__super__=this.prototype,H=i(k);H.constructor=w,w.prototype=H;for(var ee in this)Object.prototype.hasOwnProperty.call(this,ee)&&ee!=="prototype"&&ee!=="__super__"&&(w[ee]=this[ee]);return m.statics&&s(w,m.statics),m.includes&&(M(m.includes),s.apply(null,[H].concat(m.includes))),s(H,m),delete H.statics,delete H.includes,H.options&&(H.options=k.options?i(k.options):{},s(H.options,m.options)),H._initHooks=[],H.callInitHooks=function(){if(!this._initHooksCalled){k.callInitHooks&&k.callInitHooks.call(this),this._initHooksCalled=!0;for(var oe=0,ge=H._initHooks.length;oe<ge;oe++)H._initHooks[oe].call(this)}},w},N.include=function(m){var w=this.prototype.options;return s(this.prototype,m),m.options&&(this.prototype.options=w,this.mergeOptions(m.options)),this},N.mergeOptions=function(m){return s(this.prototype.options,m),this},N.addInitHook=function(m){var w=Array.prototype.slice.call(arguments,1),k=typeof m=="function"?m:function(){this[m].apply(this,w)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(k),this};function M(m){if(!(typeof L>"u"||!L||!L.Mixin)){m=C(m)?m:[m];for(var w=0;w<m.length;w++)m[w]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var B={on:function(m,w,k){if(typeof m=="object")for(var H in m)this._on(H,m[H],w);else{m=y(m);for(var ee=0,oe=m.length;ee<oe;ee++)this._on(m[ee],w,k)}return this},off:function(m,w,k){if(!arguments.length)delete this._events;else if(typeof m=="object")for(var H in m)this._off(H,m[H],w);else{m=y(m);for(var ee=arguments.length===1,oe=0,ge=m.length;oe<ge;oe++)ee?this._off(m[oe]):this._off(m[oe],w,k)}return this},_on:function(m,w,k,H){if(typeof w!="function"){console.warn("wrong listener type: "+typeof w);return}if(this._listens(m,w,k)===!1){k===this&&(k=void 0);var ee={fn:w,ctx:k};H&&(ee.once=!0),this._events=this._events||{},this._events[m]=this._events[m]||[],this._events[m].push(ee)}},_off:function(m,w,k){var H,ee,oe;if(this._events&&(H=this._events[m],!!H)){if(arguments.length===1){if(this._firingCount)for(ee=0,oe=H.length;ee<oe;ee++)H[ee].fn=d;delete this._events[m];return}if(typeof w!="function"){console.warn("wrong listener type: "+typeof w);return}var ge=this._listens(m,w,k);if(ge!==!1){var ke=H[ge];this._firingCount&&(ke.fn=d,this._events[m]=H=H.slice()),H.splice(ge,1)}}},fire:function(m,w,k){if(!this.listens(m,k))return this;var H=s({},w,{type:m,target:this,sourceTarget:w&&w.sourceTarget||this});if(this._events){var ee=this._events[m];if(ee){this._firingCount=this._firingCount+1||1;for(var oe=0,ge=ee.length;oe<ge;oe++){var ke=ee[oe],Be=ke.fn;ke.once&&this.off(m,Be,ke.ctx),Be.call(ke.ctx||this,H)}this._firingCount--}}return k&&this._propagateEvent(H),this},listens:function(m,w,k,H){typeof m!="string"&&console.warn('"string" type argument expected');var ee=w;typeof w!="function"&&(H=!!w,ee=void 0,k=void 0);var oe=this._events&&this._events[m];if(oe&&oe.length&&this._listens(m,ee,k)!==!1)return!0;if(H){for(var ge in this._eventParents)if(this._eventParents[ge].listens(m,w,k,H))return!0}return!1},_listens:function(m,w,k){if(!this._events)return!1;var H=this._events[m]||[];if(!w)return!!H.length;k===this&&(k=void 0);for(var ee=0,oe=H.length;ee<oe;ee++)if(H[ee].fn===w&&H[ee].ctx===k)return ee;return!1},once:function(m,w,k){if(typeof m=="object")for(var H in m)this._on(H,m[H],w,!0);else{m=y(m);for(var ee=0,oe=m.length;ee<oe;ee++)this._on(m[ee],w,k,!0)}return this},addEventParent:function(m){return this._eventParents=this._eventParents||{},this._eventParents[l(m)]=m,this},removeEventParent:function(m){return this._eventParents&&delete this._eventParents[l(m)],this},_propagateEvent:function(m){for(var w in this._eventParents)this._eventParents[w].fire(m.type,s({layer:m.target,propagatedFrom:m.target},m),!0)}};B.addEventListener=B.on,B.removeEventListener=B.clearAllEventListeners=B.off,B.addOneTimeEventListener=B.once,B.fireEvent=B.fire,B.hasEventListeners=B.listens;var Y=N.extend(B);function Z(m,w,k){this.x=k?Math.round(m):m,this.y=k?Math.round(w):w}var ne=Math.trunc||function(m){return m>0?Math.floor(m):Math.ceil(m)};Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(m){return this.clone()._add(Q(m))},_add:function(m){return this.x+=m.x,this.y+=m.y,this},subtract:function(m){return this.clone()._subtract(Q(m))},_subtract:function(m){return this.x-=m.x,this.y-=m.y,this},divideBy:function(m){return this.clone()._divideBy(m)},_divideBy:function(m){return this.x/=m,this.y/=m,this},multiplyBy:function(m){return this.clone()._multiplyBy(m)},_multiplyBy:function(m){return this.x*=m,this.y*=m,this},scaleBy:function(m){return new Z(this.x*m.x,this.y*m.y)},unscaleBy:function(m){return new Z(this.x/m.x,this.y/m.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ne(this.x),this.y=ne(this.y),this},distanceTo:function(m){m=Q(m);var w=m.x-this.x,k=m.y-this.y;return Math.sqrt(w*w+k*k)},equals:function(m){return m=Q(m),m.x===this.x&&m.y===this.y},contains:function(m){return m=Q(m),Math.abs(m.x)<=Math.abs(this.x)&&Math.abs(m.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function Q(m,w,k){return m instanceof Z?m:C(m)?new Z(m[0],m[1]):m==null?m:typeof m=="object"&&"x"in m&&"y"in m?new Z(m.x,m.y):new Z(m,w,k)}function z(m,w){if(m)for(var k=w?[m,w]:m,H=0,ee=k.length;H<ee;H++)this.extend(k[H])}z.prototype={extend:function(m){var w,k;if(!m)return this;if(m instanceof Z||typeof m[0]=="number"||"x"in m)w=k=Q(m);else if(m=D(m),w=m.min,k=m.max,!w||!k)return this;return!this.min&&!this.max?(this.min=w.clone(),this.max=k.clone()):(this.min.x=Math.min(w.x,this.min.x),this.max.x=Math.max(k.x,this.max.x),this.min.y=Math.min(w.y,this.min.y),this.max.y=Math.max(k.y,this.max.y)),this},getCenter:function(m){return Q((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,m)},getBottomLeft:function(){return Q(this.min.x,this.max.y)},getTopRight:function(){return Q(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(m){var w,k;return typeof m[0]=="number"||m instanceof Z?m=Q(m):m=D(m),m instanceof z?(w=m.min,k=m.max):w=k=m,w.x>=this.min.x&&k.x<=this.max.x&&w.y>=this.min.y&&k.y<=this.max.y},intersects:function(m){m=D(m);var w=this.min,k=this.max,H=m.min,ee=m.max,oe=ee.x>=w.x&&H.x<=k.x,ge=ee.y>=w.y&&H.y<=k.y;return oe&&ge},overlaps:function(m){m=D(m);var w=this.min,k=this.max,H=m.min,ee=m.max,oe=ee.x>w.x&&H.x<k.x,ge=ee.y>w.y&&H.y<k.y;return oe&&ge},isValid:function(){return!!(this.min&&this.max)},pad:function(m){var w=this.min,k=this.max,H=Math.abs(w.x-k.x)*m,ee=Math.abs(w.y-k.y)*m;return D(Q(w.x-H,w.y-ee),Q(k.x+H,k.y+ee))},equals:function(m){return m?(m=D(m),this.min.equals(m.getTopLeft())&&this.max.equals(m.getBottomRight())):!1}};function D(m,w){return!m||m instanceof z?m:new z(m,w)}function X(m,w){if(m)for(var k=w?[m,w]:m,H=0,ee=k.length;H<ee;H++)this.extend(k[H])}X.prototype={extend:function(m){var w=this._southWest,k=this._northEast,H,ee;if(m instanceof W)H=m,ee=m;else if(m instanceof X){if(H=m._southWest,ee=m._northEast,!H||!ee)return this}else return m?this.extend(ae(m)||re(m)):this;return!w&&!k?(this._southWest=new W(H.lat,H.lng),this._northEast=new W(ee.lat,ee.lng)):(w.lat=Math.min(H.lat,w.lat),w.lng=Math.min(H.lng,w.lng),k.lat=Math.max(ee.lat,k.lat),k.lng=Math.max(ee.lng,k.lng)),this},pad:function(m){var w=this._southWest,k=this._northEast,H=Math.abs(w.lat-k.lat)*m,ee=Math.abs(w.lng-k.lng)*m;return new X(new W(w.lat-H,w.lng-ee),new W(k.lat+H,k.lng+ee))},getCenter:function(){return new W((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new W(this.getNorth(),this.getWest())},getSouthEast:function(){return new W(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(m){typeof m[0]=="number"||m instanceof W||"lat"in m?m=ae(m):m=re(m);var w=this._southWest,k=this._northEast,H,ee;return m instanceof X?(H=m.getSouthWest(),ee=m.getNorthEast()):H=ee=m,H.lat>=w.lat&&ee.lat<=k.lat&&H.lng>=w.lng&&ee.lng<=k.lng},intersects:function(m){m=re(m);var w=this._southWest,k=this._northEast,H=m.getSouthWest(),ee=m.getNorthEast(),oe=ee.lat>=w.lat&&H.lat<=k.lat,ge=ee.lng>=w.lng&&H.lng<=k.lng;return oe&&ge},overlaps:function(m){m=re(m);var w=this._southWest,k=this._northEast,H=m.getSouthWest(),ee=m.getNorthEast(),oe=ee.lat>w.lat&&H.lat<k.lat,ge=ee.lng>w.lng&&H.lng<k.lng;return oe&&ge},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(m,w){return m?(m=re(m),this._southWest.equals(m.getSouthWest(),w)&&this._northEast.equals(m.getNorthEast(),w)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function re(m,w){return m instanceof X?m:new X(m,w)}function W(m,w,k){if(isNaN(m)||isNaN(w))throw new Error("Invalid LatLng object: ("+m+", "+w+")");this.lat=+m,this.lng=+w,k!==void 0&&(this.alt=+k)}W.prototype={equals:function(m,w){if(!m)return!1;m=ae(m);var k=Math.max(Math.abs(this.lat-m.lat),Math.abs(this.lng-m.lng));return k<=(w===void 0?1e-9:w)},toString:function(m){return"LatLng("+p(this.lat,m)+", "+p(this.lng,m)+")"},distanceTo:function(m){return de.distance(this,ae(m))},wrap:function(){return de.wrapLatLng(this)},toBounds:function(m){var w=180*m/40075017,k=w/Math.cos(Math.PI/180*this.lat);return re([this.lat-w,this.lng-k],[this.lat+w,this.lng+k])},clone:function(){return new W(this.lat,this.lng,this.alt)}};function ae(m,w,k){return m instanceof W?m:C(m)&&typeof m[0]!="object"?m.length===3?new W(m[0],m[1],m[2]):m.length===2?new W(m[0],m[1]):null:m==null?m:typeof m=="object"&&"lat"in m?new W(m.lat,"lng"in m?m.lng:m.lon,m.alt):w===void 0?null:new W(m,w,k)}var pe={latLngToPoint:function(m,w){var k=this.projection.project(m),H=this.scale(w);return this.transformation._transform(k,H)},pointToLatLng:function(m,w){var k=this.scale(w),H=this.transformation.untransform(m,k);return this.projection.unproject(H)},project:function(m){return this.projection.project(m)},unproject:function(m){return this.projection.unproject(m)},scale:function(m){return 256*Math.pow(2,m)},zoom:function(m){return Math.log(m/256)/Math.LN2},getProjectedBounds:function(m){if(this.infinite)return null;var w=this.projection.bounds,k=this.scale(m),H=this.transformation.transform(w.min,k),ee=this.transformation.transform(w.max,k);return new z(H,ee)},infinite:!1,wrapLatLng:function(m){var w=this.wrapLng?u(m.lng,this.wrapLng,!0):m.lng,k=this.wrapLat?u(m.lat,this.wrapLat,!0):m.lat,H=m.alt;return new W(k,w,H)},wrapLatLngBounds:function(m){var w=m.getCenter(),k=this.wrapLatLng(w),H=w.lat-k.lat,ee=w.lng-k.lng;if(H===0&&ee===0)return m;var oe=m.getSouthWest(),ge=m.getNorthEast(),ke=new W(oe.lat-H,oe.lng-ee),Be=new W(ge.lat-H,ge.lng-ee);return new X(ke,Be)}},de=s({},pe,{wrapLng:[-180,180],R:6371e3,distance:function(m,w){var k=Math.PI/180,H=m.lat*k,ee=w.lat*k,oe=Math.sin((w.lat-m.lat)*k/2),ge=Math.sin((w.lng-m.lng)*k/2),ke=oe*oe+Math.cos(H)*Math.cos(ee)*ge*ge,Be=2*Math.atan2(Math.sqrt(ke),Math.sqrt(1-ke));return this.R*Be}}),ve=6378137,Ve={R:ve,MAX_LATITUDE:85.0511287798,project:function(m){var w=Math.PI/180,k=this.MAX_LATITUDE,H=Math.max(Math.min(k,m.lat),-k),ee=Math.sin(H*w);return new Z(this.R*m.lng*w,this.R*Math.log((1+ee)/(1-ee))/2)},unproject:function(m){var w=180/Math.PI;return new W((2*Math.atan(Math.exp(m.y/this.R))-Math.PI/2)*w,m.x*w/this.R)},bounds:(function(){var m=ve*Math.PI;return new z([-m,-m],[m,m])})()};function ze(m,w,k,H){if(C(m)){this._a=m[0],this._b=m[1],this._c=m[2],this._d=m[3];return}this._a=m,this._b=w,this._c=k,this._d=H}ze.prototype={transform:function(m,w){return this._transform(m.clone(),w)},_transform:function(m,w){return w=w||1,m.x=w*(this._a*m.x+this._b),m.y=w*(this._c*m.y+this._d),m},untransform:function(m,w){return w=w||1,new Z((m.x/w-this._b)/this._a,(m.y/w-this._d)/this._c)}};function Ge(m,w,k,H){return new ze(m,w,k,H)}var at=s({},de,{code:"EPSG:3857",projection:Ve,transformation:(function(){var m=.5/(Math.PI*Ve.R);return Ge(m,.5,-m,.5)})()}),We=s({},at,{code:"EPSG:900913"});function nt(m){return document.createElementNS("http://www.w3.org/2000/svg",m)}function Nt(m,w){var k="",H,ee,oe,ge,ke,Be;for(H=0,oe=m.length;H<oe;H++){for(ke=m[H],ee=0,ge=ke.length;ee<ge;ee++)Be=ke[ee],k+=(ee?"L":"M")+Be.x+" "+Be.y;k+=w?dt.svg?"z":"x":""}return k||"M0 0"}var ct=document.documentElement.style,xt="ActiveXObject"in window,en=xt&&!document.addEventListener,ht="msLaunchUri"in navigator&&!("documentMode"in document),St=Zt("webkit"),an=Zt("android"),Ot=Zt("android 2")||Zt("android 3"),Mt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Wn=an&&Zt("Google")&&Mt<537&&!("AudioNode"in window),It=!!window.opera,Tt=!ht&&Zt("chrome"),nr=Zt("gecko")&&!St&&!It&&!xt,Bt=!Tt&&Zt("safari"),Cn=Zt("phantom"),Br="OTransition"in ct,xn=navigator.platform.indexOf("Win")===0,tn=xt&&"transition"in ct,Wr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ot,rn="MozPerspective"in ct,hn=!window.L_DISABLE_3D&&(tn||Wr||rn)&&!Br&&!Cn,es=typeof orientation<"u"||Zt("mobile"),Mn=es&&St,qn=es&&Wr,ms=!window.PointerEvent&&window.MSPointerEvent,Fn=!!(window.PointerEvent||ms),Ft="ontouchstart"in window||!!window.TouchEvent,oa=!window.L_NO_TOUCH&&(Ft||Fn),Rn=es&&It,Dn=es&&nr,yi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Kn=(function(){var m=!1;try{var w=Object.defineProperty({},"passive",{get:function(){m=!0}});window.addEventListener("testPassiveEventSupport",d,w),window.removeEventListener("testPassiveEventSupport",d,w)}catch{}return m})(),An=(function(){return!!document.createElement("canvas").getContext})(),bi=!!(document.createElementNS&&nt("svg").createSVGRect),yn=!!bi&&(function(){var m=document.createElement("div");return m.innerHTML="<svg/>",(m.firstChild&&m.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),zt=!bi&&(function(){try{var m=document.createElement("div");m.innerHTML='<v:shape adj="1"/>';var w=m.firstChild;return w.style.behavior="url(#default#VML)",w&&typeof w.adj=="object"}catch{return!1}})(),pn=navigator.platform.indexOf("Mac")===0,nn=navigator.platform.indexOf("Linux")===0;function Zt(m){return navigator.userAgent.toLowerCase().indexOf(m)>=0}var dt={ie:xt,ielt9:en,edge:ht,webkit:St,android:an,android23:Ot,androidStock:Wn,opera:It,chrome:Tt,gecko:nr,safari:Bt,phantom:Cn,opera12:Br,win:xn,ie3d:tn,webkit3d:Wr,gecko3d:rn,any3d:hn,mobile:es,mobileWebkit:Mn,mobileWebkit3d:qn,msPointer:ms,pointer:Fn,touch:oa,touchNative:Ft,mobileOpera:Rn,mobileGecko:Dn,retina:yi,passiveEvents:Kn,canvas:An,svg:bi,vml:zt,inlineSvg:yn,mac:pn,linux:nn},cr=dt.msPointer?"MSPointerDown":"pointerdown",bn=dt.msPointer?"MSPointerMove":"pointermove",ri=dt.msPointer?"MSPointerUp":"pointerup",Xn=dt.msPointer?"MSPointerCancel":"pointercancel",vn={touchstart:cr,touchmove:bn,touchend:ri,touchcancel:Xn},ks={touchstart:il,touchmove:si,touchend:si,touchcancel:si},mn={},Bn=!1;function ur(m,w,k){return w==="touchstart"&&To(),ks[w]?(k=ks[w].bind(this,k),m.addEventListener(vn[w],k,!1),k):(console.warn("wrong event specified:",w),d)}function La(m,w,k){if(!vn[w]){console.warn("wrong event specified:",w);return}m.removeEventListener(vn[w],k,!1)}function vi(m){mn[m.pointerId]=m}function Is(m){mn[m.pointerId]&&(mn[m.pointerId]=m)}function gs(m){delete mn[m.pointerId]}function To(){Bn||(document.addEventListener(cr,vi,!0),document.addEventListener(bn,Is,!0),document.addEventListener(ri,gs,!0),document.addEventListener(Xn,gs,!0),Bn=!0)}function si(m,w){if(w.pointerType!==(w.MSPOINTER_TYPE_MOUSE||"mouse")){w.touches=[];for(var k in mn)w.touches.push(mn[k]);w.changedTouches=[w],m(w)}}function il(m,w){w.MSPOINTER_TYPE_TOUCH&&w.pointerType===w.MSPOINTER_TYPE_TOUCH&&Kr(w),si(m,w)}function Lu(m){var w={},k,H;for(H in m)k=m[H],w[H]=k&&k.bind?k.bind(m):k;return m=w,w.type="dblclick",w.detail=2,w.isTrusted=!1,w._simulated=!0,w}var Co=200;function Ao(m,w){m.addEventListener("dblclick",w);var k=0,H;function ee(oe){if(oe.detail!==1){H=oe.detail;return}if(!(oe.pointerType==="mouse"||oe.sourceCapabilities&&!oe.sourceCapabilities.firesTouchEvents)){var ge=Vh(oe);if(!(ge.some(function(Be){return Be instanceof HTMLLabelElement&&Be.attributes.for})&&!ge.some(function(Be){return Be instanceof HTMLInputElement||Be instanceof HTMLSelectElement}))){var ke=Date.now();ke-k<=Co?(H++,H===2&&w(Lu(oe))):H=1,k=ke}}}return m.addEventListener("click",ee),{dblclick:w,simDblclick:ee}}function _i(m,w){m.removeEventListener("dblclick",w.dblclick),m.removeEventListener("click",w.simDblclick)}var Pa=Ec(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),la=Ec(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ca=la==="webkitTransition"||la==="OTransition"?la+"End":"transitionend";function No(m){return typeof m=="string"?document.getElementById(m):m}function ua(m,w){var k=m.style[w]||m.currentStyle&&m.currentStyle[w];if((!k||k==="auto")&&document.defaultView){var H=document.defaultView.getComputedStyle(m,null);k=H?H[w]:null}return k==="auto"?null:k}function _n(m,w,k){var H=document.createElement(m);return H.className=w||"",k&&k.appendChild(H),H}function Nn(m){var w=m.parentNode;w&&w.removeChild(m)}function Tr(m){for(;m.firstChild;)m.removeChild(m.firstChild)}function Oa(m){var w=m.parentNode;w&&w.lastChild!==m&&w.appendChild(m)}function so(m){var w=m.parentNode;w&&w.firstChild!==m&&w.insertBefore(m,w.firstChild)}function al(m,w){if(m.classList!==void 0)return m.classList.contains(w);var k=ls(m);return k.length>0&&new RegExp("(^|\\s)"+w+"(\\s|$)").test(k)}function yt(m,w){if(m.classList!==void 0)for(var k=y(w),H=0,ee=k.length;H<ee;H++)m.classList.add(k[H]);else if(!al(m,w)){var oe=ls(m);zl(m,(oe?oe+" ":"")+w)}}function xr(m,w){m.classList!==void 0?m.classList.remove(w):zl(m,x((" "+ls(m)+" ").replace(" "+w+" "," ")))}function zl(m,w){m.className.baseVal===void 0?m.className=w:m.className.baseVal=w}function ls(m){return m.correspondingElement&&(m=m.correspondingElement),m.className.baseVal===void 0?m.className:m.className.baseVal}function wi(m,w){"opacity"in m.style?m.style.opacity=w:"filter"in m.style&&Hf(m,w)}function Hf(m,w){var k=!1,H="DXImageTransform.Microsoft.Alpha";try{k=m.filters.item(H)}catch{if(w===1)return}w=Math.round(w*100),k?(k.Enabled=w!==100,k.Opacity=w):m.style.filter+=" progid:"+H+"(opacity="+w+")"}function Ec(m){for(var w=document.documentElement.style,k=0;k<m.length;k++)if(m[k]in w)return m[k];return!1}function ha(m,w,k){var H=w||new Z(0,0);m.style[Pa]=(dt.ie3d?"translate("+H.x+"px,"+H.y+"px)":"translate3d("+H.x+"px,"+H.y+"px,0)")+(k?" scale("+k+")":"")}function qr(m,w){m._leaflet_pos=w,dt.any3d?ha(m,w):(m.style.left=w.x+"px",m.style.top=w.y+"px")}function ol(m){return m._leaflet_pos||new Z(0,0)}var Ei,Ma,Pu;if("onselectstart"in document)Ei=function(){Ut(window,"selectstart",Kr)},Ma=function(){Yn(window,"selectstart",Kr)};else{var jl=Ec(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ei=function(){if(jl){var m=document.documentElement.style;Pu=m[jl],m[jl]="none"}},Ma=function(){jl&&(document.documentElement.style[jl]=Pu,Pu=void 0)}}function Sc(){Ut(window,"dragstart",Kr)}function jh(){Yn(window,"dragstart",Kr)}var Ou,Fa;function Mu(m){for(;m.tabIndex===-1;)m=m.parentNode;m.style&&(Tc(),Ou=m,Fa=m.style.outlineStyle,m.style.outlineStyle="none",Ut(window,"keydown",Tc))}function Tc(){Ou&&(Ou.style.outlineStyle=Fa,Ou=void 0,Fa=void 0,Yn(window,"keydown",Tc))}function Vl(m){do m=m.parentNode;while((!m.offsetWidth||!m.offsetHeight)&&m!==document.body);return m}function ii(m){var w=m.getBoundingClientRect();return{x:w.width/m.offsetWidth||1,y:w.height/m.offsetHeight||1,boundingClientRect:w}}var Um={__proto__:null,TRANSFORM:Pa,TRANSITION:la,TRANSITION_END:ca,get:No,getStyle:ua,create:_n,remove:Nn,empty:Tr,toFront:Oa,toBack:so,hasClass:al,addClass:yt,removeClass:xr,setClass:zl,getClass:ls,setOpacity:wi,testProp:Ec,setTransform:ha,setPosition:qr,getPosition:ol,get disableTextSelection(){return Ei},get enableTextSelection(){return Ma},disableImageDrag:Sc,enableImageDrag:jh,preventOutline:Mu,restoreOutline:Tc,getSizedParentNode:Vl,getScale:ii};function Ut(m,w,k,H){if(w&&typeof w=="object")for(var ee in w)ll(m,ee,w[ee],k);else{w=y(w);for(var oe=0,ge=w.length;oe<ge;oe++)ll(m,w[oe],k,H)}return this}var Si="_leaflet_events";function Yn(m,w,k,H){if(arguments.length===1)Ti(m),delete m[Si];else if(w&&typeof w=="object")for(var ee in w)da(m,ee,w[ee],k);else if(w=y(w),arguments.length===2)Ti(m,function(ke){return I(w,ke)!==-1});else for(var oe=0,ge=w.length;oe<ge;oe++)da(m,w[oe],k,H);return this}function Ti(m,w){for(var k in m[Si]){var H=k.split(/\d/)[0];(!w||w(H))&&da(m,H,null,null,k)}}var ko={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ll(m,w,k,H){var ee=w+l(k)+(H?"_"+l(H):"");if(m[Si]&&m[Si][ee])return this;var oe=function(ke){return k.call(H||m,ke||window.event)},ge=oe;!dt.touchNative&&dt.pointer&&w.indexOf("touch")===0?oe=ur(m,w,oe):dt.touch&&w==="dblclick"?oe=Ao(m,oe):"addEventListener"in m?w==="touchstart"||w==="touchmove"||w==="wheel"||w==="mousewheel"?m.addEventListener(ko[w]||w,oe,dt.passiveEvents?{passive:!1}:!1):w==="mouseenter"||w==="mouseleave"?(oe=function(ke){ke=ke||window.event,Ul(m,ke)&&ge(ke)},m.addEventListener(ko[w],oe,!1)):m.addEventListener(w,ge,!1):m.attachEvent("on"+w,oe),m[Si]=m[Si]||{},m[Si][ee]=oe}function da(m,w,k,H,ee){ee=ee||w+l(k)+(H?"_"+l(H):"");var oe=m[Si]&&m[Si][ee];if(!oe)return this;!dt.touchNative&&dt.pointer&&w.indexOf("touch")===0?La(m,w,oe):dt.touch&&w==="dblclick"?_i(m,oe):"removeEventListener"in m?m.removeEventListener(ko[w]||w,oe,!1):m.detachEvent("on"+w,oe),m[Si][ee]=null}function rr(m){return m.stopPropagation?m.stopPropagation():m.originalEvent?m.originalEvent._stopped=!0:m.cancelBubble=!0,this}function Cc(m){return ll(m,"wheel",rr),this}function Ac(m){return Ut(m,"mousedown touchstart dblclick contextmenu",rr),m._leaflet_disable_click=!0,this}function Kr(m){return m.preventDefault?m.preventDefault():m.returnValue=!1,this}function Ba(m){return Kr(m),rr(m),this}function Vh(m){if(m.composedPath)return m.composedPath();for(var w=[],k=m.target;k;)w.push(k),k=k.parentNode;return w}function xs(m,w){if(!w)return new Z(m.clientX,m.clientY);var k=ii(w),H=k.boundingClientRect;return new Z((m.clientX-H.left)/k.x-w.clientLeft,(m.clientY-H.top)/k.y-w.clientTop)}var Ci=dt.linux&&dt.chrome?window.devicePixelRatio:dt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Nc(m){return dt.edge?m.wheelDeltaY/2:m.deltaY&&m.deltaMode===0?-m.deltaY/Ci:m.deltaY&&m.deltaMode===1?-m.deltaY*20:m.deltaY&&m.deltaMode===2?-m.deltaY*60:m.deltaX||m.deltaZ?0:m.wheelDelta?(m.wheelDeltaY||m.wheelDelta)/2:m.detail&&Math.abs(m.detail)<32765?-m.detail*20:m.detail?m.detail/-32765*60:0}function Ul(m,w){var k=w.relatedTarget;if(!k)return!0;try{for(;k&&k!==m;)k=k.parentNode}catch{return!1}return k!==m}var Fu={__proto__:null,on:Ut,off:Yn,stopPropagation:rr,disableScrollPropagation:Cc,disableClickPropagation:Ac,preventDefault:Kr,stop:Ba,getPropagationPath:Vh,getMousePosition:xs,getWheelDelta:Nc,isExternalTarget:Ul,addListener:Ut,removeListener:Yn},Bu=Y.extend({run:function(m,w,k,H){this.stop(),this._el=m,this._inProgress=!0,this._duration=k||.25,this._easeOutPower=1/Math.max(H||.5,.2),this._startPos=ol(m),this._offset=w.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(m){var w=+new Date-this._startTime,k=this._duration*1e3;w<k?this._runFrame(this._easeOut(w/k),m):(this._runFrame(1),this._complete())},_runFrame:function(m,w){var k=this._startPos.add(this._offset.multiplyBy(m));w&&k._round(),qr(this._el,k),this.fire("step")},_complete:function(){K(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(m){return 1-Math.pow(1-m,this._easeOutPower)}}),dn=Y.extend({options:{crs:at,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(m,w){w=v(this,w),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(m),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),w.maxBounds&&this.setMaxBounds(w.maxBounds),w.zoom!==void 0&&(this._zoom=this._limitZoom(w.zoom)),w.center&&w.zoom!==void 0&&this.setView(ae(w.center),w.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=la&&dt.any3d&&!dt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ut(this._proxy,ca,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(m,w,k){if(w=w===void 0?this._zoom:this._limitZoom(w),m=this._limitCenter(ae(m),w,this.options.maxBounds),k=k||{},this._stop(),this._loaded&&!k.reset&&k!==!0){k.animate!==void 0&&(k.zoom=s({animate:k.animate},k.zoom),k.pan=s({animate:k.animate,duration:k.duration},k.pan));var H=this._zoom!==w?this._tryAnimatedZoom&&this._tryAnimatedZoom(m,w,k.zoom):this._tryAnimatedPan(m,k.pan);if(H)return clearTimeout(this._sizeTimer),this}return this._resetView(m,w,k.pan&&k.pan.noMoveStart),this},setZoom:function(m,w){return this._loaded?this.setView(this.getCenter(),m,{zoom:w}):(this._zoom=m,this)},zoomIn:function(m,w){return m=m||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+m,w)},zoomOut:function(m,w){return m=m||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-m,w)},setZoomAround:function(m,w,k){var H=this.getZoomScale(w),ee=this.getSize().divideBy(2),oe=m instanceof Z?m:this.latLngToContainerPoint(m),ge=oe.subtract(ee).multiplyBy(1-1/H),ke=this.containerPointToLatLng(ee.add(ge));return this.setView(ke,w,{zoom:k})},_getBoundsCenterZoom:function(m,w){w=w||{},m=m.getBounds?m.getBounds():re(m);var k=Q(w.paddingTopLeft||w.padding||[0,0]),H=Q(w.paddingBottomRight||w.padding||[0,0]),ee=this.getBoundsZoom(m,!1,k.add(H));if(ee=typeof w.maxZoom=="number"?Math.min(w.maxZoom,ee):ee,ee===1/0)return{center:m.getCenter(),zoom:ee};var oe=H.subtract(k).divideBy(2),ge=this.project(m.getSouthWest(),ee),ke=this.project(m.getNorthEast(),ee),Be=this.unproject(ge.add(ke).divideBy(2).add(oe),ee);return{center:Be,zoom:ee}},fitBounds:function(m,w){if(m=re(m),!m.isValid())throw new Error("Bounds are not valid.");var k=this._getBoundsCenterZoom(m,w);return this.setView(k.center,k.zoom,w)},fitWorld:function(m){return this.fitBounds([[-90,-180],[90,180]],m)},panTo:function(m,w){return this.setView(m,this._zoom,{pan:w})},panBy:function(m,w){if(m=Q(m).round(),w=w||{},!m.x&&!m.y)return this.fire("moveend");if(w.animate!==!0&&!this.getSize().contains(m))return this._resetView(this.unproject(this.project(this.getCenter()).add(m)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Bu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),w.noMoveStart||this.fire("movestart"),w.animate!==!1){yt(this._mapPane,"leaflet-pan-anim");var k=this._getMapPanePos().subtract(m).round();this._panAnim.run(this._mapPane,k,w.duration||.25,w.easeLinearity)}else this._rawPanBy(m),this.fire("move").fire("moveend");return this},flyTo:function(m,w,k){if(k=k||{},k.animate===!1||!dt.any3d)return this.setView(m,w,k);this._stop();var H=this.project(this.getCenter()),ee=this.project(m),oe=this.getSize(),ge=this._zoom;m=ae(m),w=w===void 0?ge:w;var ke=Math.max(oe.x,oe.y),Be=ke*this.getZoomScale(ge,w),Je=ee.distanceTo(H)||1,ft=1.42,vt=ft*ft;function At(ns){var fl=ns?-1:1,ql=ns?Be:ke,$c=Be*Be-ke*ke+fl*vt*vt*Je*Je,Kl=2*ql*vt*Je,op=$c/Kl,n0=Math.sqrt(op*op+1)-op,lp=n0<1e-9?-18:Math.log(n0);return lp}function Qt(ns){return(Math.exp(ns)-Math.exp(-ns))/2}function zr(ns){return(Math.exp(ns)+Math.exp(-ns))/2}function cs(ns){return Qt(ns)/zr(ns)}var Ni=At(0);function ao(ns){return ke*(zr(Ni)/zr(Ni+ft*ns))}function qv(ns){return ke*(zr(Ni)*cs(Ni+ft*ns)-Qt(Ni))/vt}function Kv(ns){return 1-Math.pow(1-ns,1.5)}var ap=Date.now(),id=(At(1)-Ni)/ft,Xv=k.duration?1e3*k.duration:1e3*id*.8;function ad(){var ns=(Date.now()-ap)/Xv,fl=Kv(ns)*id;ns<=1?(this._flyToFrame=O(ad,this),this._move(this.unproject(H.add(ee.subtract(H).multiplyBy(qv(fl)/Je)),ge),this.getScaleZoom(ke/ao(fl),ge),{flyTo:!0})):this._move(m,w)._moveEnd(!0)}return this._moveStart(!0,k.noMoveStart),ad.call(this),this},flyToBounds:function(m,w){var k=this._getBoundsCenterZoom(m,w);return this.flyTo(k.center,k.zoom,w)},setMaxBounds:function(m){return m=re(m),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),m.isValid()?(this.options.maxBounds=m,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(m){var w=this.options.minZoom;return this.options.minZoom=m,this._loaded&&w!==m&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(m):this},setMaxZoom:function(m){var w=this.options.maxZoom;return this.options.maxZoom=m,this._loaded&&w!==m&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(m):this},panInsideBounds:function(m,w){this._enforcingBounds=!0;var k=this.getCenter(),H=this._limitCenter(k,this._zoom,re(m));return k.equals(H)||this.panTo(H,w),this._enforcingBounds=!1,this},panInside:function(m,w){w=w||{};var k=Q(w.paddingTopLeft||w.padding||[0,0]),H=Q(w.paddingBottomRight||w.padding||[0,0]),ee=this.project(this.getCenter()),oe=this.project(m),ge=this.getPixelBounds(),ke=D([ge.min.add(k),ge.max.subtract(H)]),Be=ke.getSize();if(!ke.contains(oe)){this._enforcingBounds=!0;var Je=oe.subtract(ke.getCenter()),ft=ke.extend(oe).getSize().subtract(Be);ee.x+=Je.x<0?-ft.x:ft.x,ee.y+=Je.y<0?-ft.y:ft.y,this.panTo(this.unproject(ee),w),this._enforcingBounds=!1}return this},invalidateSize:function(m){if(!this._loaded)return this;m=s({animate:!1,pan:!0},m===!0?{animate:!0}:m);var w=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var k=this.getSize(),H=w.divideBy(2).round(),ee=k.divideBy(2).round(),oe=H.subtract(ee);return!oe.x&&!oe.y?this:(m.animate&&m.pan?this.panBy(oe):(m.pan&&this._rawPanBy(oe),this.fire("move"),m.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:w,newSize:k}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(m){if(m=this._locateOptions=s({timeout:1e4,watch:!1},m),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var w=a(this._handleGeolocationResponse,this),k=a(this._handleGeolocationError,this);return m.watch?this._locationWatchId=navigator.geolocation.watchPosition(w,k,m):navigator.geolocation.getCurrentPosition(w,k,m),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(m){if(this._container._leaflet_id){var w=m.code,k=m.message||(w===1?"permission denied":w===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:w,message:"Geolocation error: "+k+"."})}},_handleGeolocationResponse:function(m){if(this._container._leaflet_id){var w=m.coords.latitude,k=m.coords.longitude,H=new W(w,k),ee=H.toBounds(m.coords.accuracy*2),oe=this._locateOptions;if(oe.setView){var ge=this.getBoundsZoom(ee);this.setView(H,oe.maxZoom?Math.min(ge,oe.maxZoom):ge)}var ke={latlng:H,bounds:ee,timestamp:m.timestamp};for(var Be in m.coords)typeof m.coords[Be]=="number"&&(ke[Be]=m.coords[Be]);this.fire("locationfound",ke)}},addHandler:function(m,w){if(!w)return this;var k=this[m]=new w(this);return this._handlers.push(k),this.options[m]&&k.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Nn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(K(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var m;for(m in this._layers)this._layers[m].remove();for(m in this._panes)Nn(this._panes[m]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(m,w){var k="leaflet-pane"+(m?" leaflet-"+m.replace("Pane","")+"-pane":""),H=_n("div",k,w||this._mapPane);return m&&(this._panes[m]=H),H},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var m=this.getPixelBounds(),w=this.unproject(m.getBottomLeft()),k=this.unproject(m.getTopRight());return new X(w,k)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(m,w,k){m=re(m),k=Q(k||[0,0]);var H=this.getZoom()||0,ee=this.getMinZoom(),oe=this.getMaxZoom(),ge=m.getNorthWest(),ke=m.getSouthEast(),Be=this.getSize().subtract(k),Je=D(this.project(ke,H),this.project(ge,H)).getSize(),ft=dt.any3d?this.options.zoomSnap:1,vt=Be.x/Je.x,At=Be.y/Je.y,Qt=w?Math.max(vt,At):Math.min(vt,At);return H=this.getScaleZoom(Qt,H),ft&&(H=Math.round(H/(ft/100))*(ft/100),H=w?Math.ceil(H/ft)*ft:Math.floor(H/ft)*ft),Math.max(ee,Math.min(oe,H))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(m,w){var k=this._getTopLeftPoint(m,w);return new z(k,k.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(m){return this.options.crs.getProjectedBounds(m===void 0?this.getZoom():m)},getPane:function(m){return typeof m=="string"?this._panes[m]:m},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(m,w){var k=this.options.crs;return w=w===void 0?this._zoom:w,k.scale(m)/k.scale(w)},getScaleZoom:function(m,w){var k=this.options.crs;w=w===void 0?this._zoom:w;var H=k.zoom(m*k.scale(w));return isNaN(H)?1/0:H},project:function(m,w){return w=w===void 0?this._zoom:w,this.options.crs.latLngToPoint(ae(m),w)},unproject:function(m,w){return w=w===void 0?this._zoom:w,this.options.crs.pointToLatLng(Q(m),w)},layerPointToLatLng:function(m){var w=Q(m).add(this.getPixelOrigin());return this.unproject(w)},latLngToLayerPoint:function(m){var w=this.project(ae(m))._round();return w._subtract(this.getPixelOrigin())},wrapLatLng:function(m){return this.options.crs.wrapLatLng(ae(m))},wrapLatLngBounds:function(m){return this.options.crs.wrapLatLngBounds(re(m))},distance:function(m,w){return this.options.crs.distance(ae(m),ae(w))},containerPointToLayerPoint:function(m){return Q(m).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(m){return Q(m).add(this._getMapPanePos())},containerPointToLatLng:function(m){var w=this.containerPointToLayerPoint(Q(m));return this.layerPointToLatLng(w)},latLngToContainerPoint:function(m){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ae(m)))},mouseEventToContainerPoint:function(m){return xs(m,this._container)},mouseEventToLayerPoint:function(m){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(m))},mouseEventToLatLng:function(m){return this.layerPointToLatLng(this.mouseEventToLayerPoint(m))},_initContainer:function(m){var w=this._container=No(m);if(w){if(w._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ut(w,"scroll",this._onScroll,this),this._containerId=l(w)},_initLayout:function(){var m=this._container;this._fadeAnimated=this.options.fadeAnimation&&dt.any3d,yt(m,"leaflet-container"+(dt.touch?" leaflet-touch":"")+(dt.retina?" leaflet-retina":"")+(dt.ielt9?" leaflet-oldie":"")+(dt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var w=ua(m,"position");w!=="absolute"&&w!=="relative"&&w!=="fixed"&&w!=="sticky"&&(m.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var m=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),qr(this._mapPane,new Z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(yt(m.markerPane,"leaflet-zoom-hide"),yt(m.shadowPane,"leaflet-zoom-hide"))},_resetView:function(m,w,k){qr(this._mapPane,new Z(0,0));var H=!this._loaded;this._loaded=!0,w=this._limitZoom(w),this.fire("viewprereset");var ee=this._zoom!==w;this._moveStart(ee,k)._move(m,w)._moveEnd(ee),this.fire("viewreset"),H&&this.fire("load")},_moveStart:function(m,w){return m&&this.fire("zoomstart"),w||this.fire("movestart"),this},_move:function(m,w,k,H){w===void 0&&(w=this._zoom);var ee=this._zoom!==w;return this._zoom=w,this._lastCenter=m,this._pixelOrigin=this._getNewPixelOrigin(m),H?k&&k.pinch&&this.fire("zoom",k):((ee||k&&k.pinch)&&this.fire("zoom",k),this.fire("move",k)),this},_moveEnd:function(m){return m&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return K(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(m){qr(this._mapPane,this._getMapPanePos().subtract(m))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(m){this._targets={},this._targets[l(this._container)]=this;var w=m?Yn:Ut;w(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&w(window,"resize",this._onResize,this),dt.any3d&&this.options.transform3DLimit&&(m?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){K(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var m=this._getMapPanePos();Math.max(Math.abs(m.x),Math.abs(m.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(m,w){for(var k=[],H,ee=w==="mouseout"||w==="mouseover",oe=m.target||m.srcElement,ge=!1;oe;){if(H=this._targets[l(oe)],H&&(w==="click"||w==="preclick")&&this._draggableMoved(H)){ge=!0;break}if(H&&H.listens(w,!0)&&(ee&&!Ul(oe,m)||(k.push(H),ee))||oe===this._container)break;oe=oe.parentNode}return!k.length&&!ge&&!ee&&this.listens(w,!0)&&(k=[this]),k},_isClickDisabled:function(m){for(;m&&m!==this._container;){if(m._leaflet_disable_click)return!0;m=m.parentNode}},_handleDOMEvent:function(m){var w=m.target||m.srcElement;if(!(!this._loaded||w._leaflet_disable_events||m.type==="click"&&this._isClickDisabled(w))){var k=m.type;k==="mousedown"&&Mu(w),this._fireDOMEvent(m,k)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(m,w,k){if(m.type==="click"){var H=s({},m);H.type="preclick",this._fireDOMEvent(H,H.type,k)}var ee=this._findEventTargets(m,w);if(k){for(var oe=[],ge=0;ge<k.length;ge++)k[ge].listens(w,!0)&&oe.push(k[ge]);ee=oe.concat(ee)}if(ee.length){w==="contextmenu"&&Kr(m);var ke=ee[0],Be={originalEvent:m};if(m.type!=="keypress"&&m.type!=="keydown"&&m.type!=="keyup"){var Je=ke.getLatLng&&(!ke._radius||ke._radius<=10);Be.containerPoint=Je?this.latLngToContainerPoint(ke.getLatLng()):this.mouseEventToContainerPoint(m),Be.layerPoint=this.containerPointToLayerPoint(Be.containerPoint),Be.latlng=Je?ke.getLatLng():this.layerPointToLatLng(Be.layerPoint)}for(ge=0;ge<ee.length;ge++)if(ee[ge].fire(w,Be,!0),Be.originalEvent._stopped||ee[ge].options.bubblingMouseEvents===!1&&I(this._mouseEvents,w)!==-1)return}},_draggableMoved:function(m){return m=m.dragging&&m.dragging.enabled()?m:this,m.dragging&&m.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var m=0,w=this._handlers.length;m<w;m++)this._handlers[m].disable()},whenReady:function(m,w){return this._loaded?m.call(w||this,{target:this}):this.on("load",m,w),this},_getMapPanePos:function(){return ol(this._mapPane)||new Z(0,0)},_moved:function(){var m=this._getMapPanePos();return m&&!m.equals([0,0])},_getTopLeftPoint:function(m,w){var k=m&&w!==void 0?this._getNewPixelOrigin(m,w):this.getPixelOrigin();return k.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(m,w){var k=this.getSize()._divideBy(2);return this.project(m,w)._subtract(k)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(m,w,k){var H=this._getNewPixelOrigin(k,w);return this.project(m,w)._subtract(H)},_latLngBoundsToNewLayerBounds:function(m,w,k){var H=this._getNewPixelOrigin(k,w);return D([this.project(m.getSouthWest(),w)._subtract(H),this.project(m.getNorthWest(),w)._subtract(H),this.project(m.getSouthEast(),w)._subtract(H),this.project(m.getNorthEast(),w)._subtract(H)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(m){return this.latLngToLayerPoint(m).subtract(this._getCenterLayerPoint())},_limitCenter:function(m,w,k){if(!k)return m;var H=this.project(m,w),ee=this.getSize().divideBy(2),oe=new z(H.subtract(ee),H.add(ee)),ge=this._getBoundsOffset(oe,k,w);return Math.abs(ge.x)<=1&&Math.abs(ge.y)<=1?m:this.unproject(H.add(ge),w)},_limitOffset:function(m,w){if(!w)return m;var k=this.getPixelBounds(),H=new z(k.min.add(m),k.max.add(m));return m.add(this._getBoundsOffset(H,w))},_getBoundsOffset:function(m,w,k){var H=D(this.project(w.getNorthEast(),k),this.project(w.getSouthWest(),k)),ee=H.min.subtract(m.min),oe=H.max.subtract(m.max),ge=this._rebound(ee.x,-oe.x),ke=this._rebound(ee.y,-oe.y);return new Z(ge,ke)},_rebound:function(m,w){return m+w>0?Math.round(m-w)/2:Math.max(0,Math.ceil(m))-Math.max(0,Math.floor(w))},_limitZoom:function(m){var w=this.getMinZoom(),k=this.getMaxZoom(),H=dt.any3d?this.options.zoomSnap:1;return H&&(m=Math.round(m/H)*H),Math.max(w,Math.min(k,m))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){xr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(m,w){var k=this._getCenterOffset(m)._trunc();return(w&&w.animate)!==!0&&!this.getSize().contains(k)?!1:(this.panBy(k,w),!0)},_createAnimProxy:function(){var m=this._proxy=_n("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(m),this.on("zoomanim",function(w){var k=Pa,H=this._proxy.style[k];ha(this._proxy,this.project(w.center,w.zoom),this.getZoomScale(w.zoom,1)),H===this._proxy.style[k]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Nn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var m=this.getCenter(),w=this.getZoom();ha(this._proxy,this.project(m,w),this.getZoomScale(w,1))},_catchTransitionEnd:function(m){this._animatingZoom&&m.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(m,w,k){if(this._animatingZoom)return!0;if(k=k||{},!this._zoomAnimated||k.animate===!1||this._nothingToAnimate()||Math.abs(w-this._zoom)>this.options.zoomAnimationThreshold)return!1;var H=this.getZoomScale(w),ee=this._getCenterOffset(m)._divideBy(1-1/H);return k.animate!==!0&&!this.getSize().contains(ee)?!1:(O(function(){this._moveStart(!0,k.noMoveStart||!1)._animateZoom(m,w,!0)},this),!0)},_animateZoom:function(m,w,k,H){this._mapPane&&(k&&(this._animatingZoom=!0,this._animateToCenter=m,this._animateToZoom=w,yt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:m,zoom:w,noUpdate:H}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&xr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function cl(m,w){return new dn(m,w)}var ai=N.extend({options:{position:"topright"},initialize:function(m){v(this,m)},getPosition:function(){return this.options.position},setPosition:function(m){var w=this._map;return w&&w.removeControl(this),this.options.position=m,w&&w.addControl(this),this},getContainer:function(){return this._container},addTo:function(m){this.remove(),this._map=m;var w=this._container=this.onAdd(m),k=this.getPosition(),H=m._controlCorners[k];return yt(w,"leaflet-control"),k.indexOf("bottom")!==-1?H.insertBefore(w,H.firstChild):H.appendChild(w),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Nn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(m){this._map&&m&&m.screenX>0&&m.screenY>0&&this._map.getContainer().focus()}}),Io=function(m){return new ai(m)};dn.include({addControl:function(m){return m.addTo(this),this},removeControl:function(m){return m.remove(),this},_initControlPos:function(){var m=this._controlCorners={},w="leaflet-",k=this._controlContainer=_n("div",w+"control-container",this._container);function H(ee,oe){var ge=w+ee+" "+w+oe;m[ee+oe]=_n("div",ge,k)}H("top","left"),H("top","right"),H("bottom","left"),H("bottom","right")},_clearControlPos:function(){for(var m in this._controlCorners)Nn(this._controlCorners[m]);Nn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Gm=ai.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(m,w,k,H){return k<H?-1:H<k?1:0}},initialize:function(m,w,k){v(this,k),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var H in m)this._addLayer(m[H],H);for(H in w)this._addLayer(w[H],H,!0)},onAdd:function(m){this._initLayout(),this._update(),this._map=m,m.on("zoomend",this._checkDisabledLayers,this);for(var w=0;w<this._layers.length;w++)this._layers[w].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(m){return ai.prototype.addTo.call(this,m),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var m=0;m<this._layers.length;m++)this._layers[m].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(m,w){return this._addLayer(m,w),this._map?this._update():this},addOverlay:function(m,w){return this._addLayer(m,w,!0),this._map?this._update():this},removeLayer:function(m){m.off("add remove",this._onLayerChange,this);var w=this._getLayer(l(m));return w&&this._layers.splice(this._layers.indexOf(w),1),this._map?this._update():this},expand:function(){yt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var m=this._map.getSize().y-(this._container.offsetTop+50);return m<this._section.clientHeight?(yt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=m+"px"):xr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return xr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var m="leaflet-control-layers",w=this._container=_n("div",m),k=this.options.collapsed;w.setAttribute("aria-haspopup",!0),Ac(w),Cc(w);var H=this._section=_n("section",m+"-list");k&&(this._map.on("click",this.collapse,this),Ut(w,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var ee=this._layersLink=_n("a",m+"-toggle",w);ee.href="#",ee.title="Layers",ee.setAttribute("role","button"),Ut(ee,{keydown:function(oe){oe.keyCode===13&&this._expandSafely()},click:function(oe){Kr(oe),this._expandSafely()}},this),k||this.expand(),this._baseLayersList=_n("div",m+"-base",H),this._separator=_n("div",m+"-separator",H),this._overlaysList=_n("div",m+"-overlays",H),w.appendChild(H)},_getLayer:function(m){for(var w=0;w<this._layers.length;w++)if(this._layers[w]&&l(this._layers[w].layer)===m)return this._layers[w]},_addLayer:function(m,w,k){this._map&&m.on("add remove",this._onLayerChange,this),this._layers.push({layer:m,name:w,overlay:k}),this.options.sortLayers&&this._layers.sort(a(function(H,ee){return this.options.sortFunction(H.layer,ee.layer,H.name,ee.name)},this)),this.options.autoZIndex&&m.setZIndex&&(this._lastZIndex++,m.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Tr(this._baseLayersList),Tr(this._overlaysList),this._layerControlInputs=[];var m,w,k,H,ee=0;for(k=0;k<this._layers.length;k++)H=this._layers[k],this._addItem(H),w=w||H.overlay,m=m||!H.overlay,ee+=H.overlay?0:1;return this.options.hideSingleBase&&(m=m&&ee>1,this._baseLayersList.style.display=m?"":"none"),this._separator.style.display=w&&m?"":"none",this},_onLayerChange:function(m){this._handlingClick||this._update();var w=this._getLayer(l(m.target)),k=w.overlay?m.type==="add"?"overlayadd":"overlayremove":m.type==="add"?"baselayerchange":null;k&&this._map.fire(k,w)},_createRadioElement:function(m,w){var k='<input type="radio" class="leaflet-control-layers-selector" name="'+m+'"'+(w?' checked="checked"':"")+"/>",H=document.createElement("div");return H.innerHTML=k,H.firstChild},_addItem:function(m){var w=document.createElement("label"),k=this._map.hasLayer(m.layer),H;m.overlay?(H=document.createElement("input"),H.type="checkbox",H.className="leaflet-control-layers-selector",H.defaultChecked=k):H=this._createRadioElement("leaflet-base-layers_"+l(this),k),this._layerControlInputs.push(H),H.layerId=l(m.layer),Ut(H,"click",this._onInputClick,this);var ee=document.createElement("span");ee.innerHTML=" "+m.name;var oe=document.createElement("span");w.appendChild(oe),oe.appendChild(H),oe.appendChild(ee);var ge=m.overlay?this._overlaysList:this._baseLayersList;return ge.appendChild(w),this._checkDisabledLayers(),w},_onInputClick:function(){if(!this._preventClick){var m=this._layerControlInputs,w,k,H=[],ee=[];this._handlingClick=!0;for(var oe=m.length-1;oe>=0;oe--)w=m[oe],k=this._getLayer(w.layerId).layer,w.checked?H.push(k):w.checked||ee.push(k);for(oe=0;oe<ee.length;oe++)this._map.hasLayer(ee[oe])&&this._map.removeLayer(ee[oe]);for(oe=0;oe<H.length;oe++)this._map.hasLayer(H[oe])||this._map.addLayer(H[oe]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var m=this._layerControlInputs,w,k,H=this._map.getZoom(),ee=m.length-1;ee>=0;ee--)w=m[ee],k=this._getLayer(w.layerId).layer,w.disabled=k.options.minZoom!==void 0&&H<k.options.minZoom||k.options.maxZoom!==void 0&&H>k.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var m=this._section;this._preventClick=!0,Ut(m,"click",Kr),this.expand();var w=this;setTimeout(function(){Yn(m,"click",Kr),w._preventClick=!1})}}),Hm=function(m,w,k){return new Gm(m,w,k)},Gl=ai.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(m){var w="leaflet-control-zoom",k=_n("div",w+" leaflet-bar"),H=this.options;return this._zoomInButton=this._createButton(H.zoomInText,H.zoomInTitle,w+"-in",k,this._zoomIn),this._zoomOutButton=this._createButton(H.zoomOutText,H.zoomOutTitle,w+"-out",k,this._zoomOut),this._updateDisabled(),m.on("zoomend zoomlevelschange",this._updateDisabled,this),k},onRemove:function(m){m.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(m){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(m.shiftKey?3:1))},_zoomOut:function(m){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(m.shiftKey?3:1))},_createButton:function(m,w,k,H,ee){var oe=_n("a",k,H);return oe.innerHTML=m,oe.href="#",oe.title=w,oe.setAttribute("role","button"),oe.setAttribute("aria-label",w),Ac(oe),Ut(oe,"click",Ba),Ut(oe,"click",ee,this),Ut(oe,"click",this._refocusOnMap,this),oe},_updateDisabled:function(){var m=this._map,w="leaflet-disabled";xr(this._zoomInButton,w),xr(this._zoomOutButton,w),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||m._zoom===m.getMinZoom())&&(yt(this._zoomOutButton,w),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||m._zoom===m.getMaxZoom())&&(yt(this._zoomInButton,w),this._zoomInButton.setAttribute("aria-disabled","true"))}});dn.mergeOptions({zoomControl:!0}),dn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Gl,this.addControl(this.zoomControl))});var Uh=function(m){return new Gl(m)},Wf=ai.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(m){var w="leaflet-control-scale",k=_n("div",w),H=this.options;return this._addScales(H,w+"-line",k),m.on(H.updateWhenIdle?"moveend":"move",this._update,this),m.whenReady(this._update,this),k},onRemove:function(m){m.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(m,w,k){m.metric&&(this._mScale=_n("div",w,k)),m.imperial&&(this._iScale=_n("div",w,k))},_update:function(){var m=this._map,w=m.getSize().y/2,k=m.distance(m.containerPointToLatLng([0,w]),m.containerPointToLatLng([this.options.maxWidth,w]));this._updateScales(k)},_updateScales:function(m){this.options.metric&&m&&this._updateMetric(m),this.options.imperial&&m&&this._updateImperial(m)},_updateMetric:function(m){var w=this._getRoundNum(m),k=w<1e3?w+" m":w/1e3+" km";this._updateScale(this._mScale,k,w/m)},_updateImperial:function(m){var w=m*3.2808399,k,H,ee;w>5280?(k=w/5280,H=this._getRoundNum(k),this._updateScale(this._iScale,H+" mi",H/k)):(ee=this._getRoundNum(w),this._updateScale(this._iScale,ee+" ft",ee/w))},_updateScale:function(m,w,k){m.style.width=Math.round(this.options.maxWidth*k)+"px",m.innerHTML=w},_getRoundNum:function(m){var w=Math.pow(10,(Math.floor(m)+"").length-1),k=m/w;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:1,w*k}}),qf=function(m){return new Wf(m)},Kf='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Gh=ai.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(dt.inlineSvg?Kf+" ":"")+"Leaflet</a>"},initialize:function(m){v(this,m),this._attributions={}},onAdd:function(m){m.attributionControl=this,this._container=_n("div","leaflet-control-attribution"),Ac(this._container);for(var w in m._layers)m._layers[w].getAttribution&&this.addAttribution(m._layers[w].getAttribution());return this._update(),m.on("layeradd",this._addAttribution,this),this._container},onRemove:function(m){m.off("layeradd",this._addAttribution,this)},_addAttribution:function(m){m.layer.getAttribution&&(this.addAttribution(m.layer.getAttribution()),m.layer.once("remove",function(){this.removeAttribution(m.layer.getAttribution())},this))},setPrefix:function(m){return this.options.prefix=m,this._update(),this},addAttribution:function(m){return m?(this._attributions[m]||(this._attributions[m]=0),this._attributions[m]++,this._update(),this):this},removeAttribution:function(m){return m?(this._attributions[m]&&(this._attributions[m]--,this._update()),this):this},_update:function(){if(this._map){var m=[];for(var w in this._attributions)this._attributions[w]&&m.push(w);var k=[];this.options.prefix&&k.push(this.options.prefix),m.length&&k.push(m.join(", ")),this._container.innerHTML=k.join(' <span aria-hidden="true">|</span> ')}}});dn.mergeOptions({attributionControl:!0}),dn.addInitHook(function(){this.options.attributionControl&&new Gh().addTo(this)});var Hh=function(m){return new Gh(m)};ai.Layers=Gm,ai.Zoom=Gl,ai.Scale=Wf,ai.Attribution=Gh,Io.layers=Hm,Io.zoom=Uh,Io.scale=qf,Io.attribution=Hh;var fa=N.extend({initialize:function(m){this._map=m},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});fa.addTo=function(m,w){return m.addHandler(w,this),this};var Wm={Events:B},ul=dt.touch?"touchstart mousedown":"mousedown",Ro=Y.extend({options:{clickTolerance:3},initialize:function(m,w,k,H){v(this,H),this._element=m,this._dragStartTarget=w||m,this._preventOutline=k},enable:function(){this._enabled||(Ut(this._dragStartTarget,ul,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ro._dragging===this&&this.finishDrag(!0),Yn(this._dragStartTarget,ul,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(m){if(this._enabled&&(this._moved=!1,!al(this._element,"leaflet-zoom-anim"))){if(m.touches&&m.touches.length!==1){Ro._dragging===this&&this.finishDrag();return}if(!(Ro._dragging||m.shiftKey||m.which!==1&&m.button!==1&&!m.touches)&&(Ro._dragging=this,this._preventOutline&&Mu(this._element),Sc(),Ei(),!this._moving)){this.fire("down");var w=m.touches?m.touches[0]:m,k=Vl(this._element);this._startPoint=new Z(w.clientX,w.clientY),this._startPos=ol(this._element),this._parentScale=ii(k);var H=m.type==="mousedown";Ut(document,H?"mousemove":"touchmove",this._onMove,this),Ut(document,H?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(m){if(this._enabled){if(m.touches&&m.touches.length>1){this._moved=!0;return}var w=m.touches&&m.touches.length===1?m.touches[0]:m,k=new Z(w.clientX,w.clientY)._subtract(this._startPoint);!k.x&&!k.y||Math.abs(k.x)+Math.abs(k.y)<this.options.clickTolerance||(k.x/=this._parentScale.x,k.y/=this._parentScale.y,Kr(m),this._moved||(this.fire("dragstart"),this._moved=!0,yt(document.body,"leaflet-dragging"),this._lastTarget=m.target||m.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),yt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(k),this._moving=!0,this._lastEvent=m,this._updatePosition())}},_updatePosition:function(){var m={originalEvent:this._lastEvent};this.fire("predrag",m),qr(this._element,this._newPos),this.fire("drag",m)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(m){xr(document.body,"leaflet-dragging"),this._lastTarget&&(xr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Yn(document,"mousemove touchmove",this._onMove,this),Yn(document,"mouseup touchend touchcancel",this._onUp,this),jh(),Ma();var w=this._moved&&this._moving;this._moving=!1,Ro._dragging=!1,w&&this.fire("dragend",{noInertia:m,distance:this._newPos.distanceTo(this._startPos)})}});function Xf(m,w,k){var H,ee=[1,4,2,8],oe,ge,ke,Be,Je,ft,vt,At;for(oe=0,ft=m.length;oe<ft;oe++)m[oe]._code=Oe(m[oe],w);for(ke=0;ke<4;ke++){for(vt=ee[ke],H=[],oe=0,ft=m.length,ge=ft-1;oe<ft;ge=oe++)Be=m[oe],Je=m[ge],Be._code&vt?Je._code&vt||(At=Ie(Je,Be,vt,w,k),At._code=Oe(At,w),H.push(At)):(Je._code&vt&&(At=Ie(Je,Be,vt,w,k),At._code=Oe(At,w),H.push(At)),H.push(Be));m=H}return m}function zu(m,w){var k,H,ee,oe,ge,ke,Be,Je,ft;if(!m||m.length===0)throw new Error("latlngs not passed");$n(m)||(console.warn("latlngs are not flat! Only the first ring will be used"),m=m[0]);var vt=ae([0,0]),At=re(m),Qt=At.getNorthWest().distanceTo(At.getSouthWest())*At.getNorthEast().distanceTo(At.getNorthWest());Qt<1700&&(vt=Wh(m));var zr=m.length,cs=[];for(k=0;k<zr;k++){var Ni=ae(m[k]);cs.push(w.project(ae([Ni.lat-vt.lat,Ni.lng-vt.lng])))}for(ke=Be=Je=0,k=0,H=zr-1;k<zr;H=k++)ee=cs[k],oe=cs[H],ge=ee.y*oe.x-oe.y*ee.x,Be+=(ee.x+oe.x)*ge,Je+=(ee.y+oe.y)*ge,ke+=ge*3;ke===0?ft=cs[0]:ft=[Be/ke,Je/ke];var ao=w.unproject(Q(ft));return ae([ao.lat+vt.lat,ao.lng+vt.lng])}function Wh(m){for(var w=0,k=0,H=0,ee=0;ee<m.length;ee++){var oe=ae(m[ee]);w+=oe.lat,k+=oe.lng,H++}return ae([w/H,k/H])}var qh={__proto__:null,clipPolygon:Xf,polygonCenter:zu,centroid:Wh};function Ai(m,w){if(!w||!m.length)return m.slice();var k=w*w;return m=J(m,k),m=kc(m,k),m}function Kh(m,w,k){return Math.sqrt(Gt(m,w,k,!0))}function qm(m,w,k){return Gt(m,w,k)}function kc(m,w){var k=m.length,H=typeof Uint8Array<"u"?Uint8Array:Array,ee=new H(k);ee[0]=ee[k-1]=1,A(m,ee,w,0,k-1);var oe,ge=[];for(oe=0;oe<k;oe++)ee[oe]&&ge.push(m[oe]);return ge}function A(m,w,k,H,ee){var oe=0,ge,ke,Be;for(ke=H+1;ke<=ee-1;ke++)Be=Gt(m[ke],m[H],m[ee],!0),Be>oe&&(ge=ke,oe=Be);oe>k&&(w[ge]=1,A(m,w,k,H,ge),A(m,w,k,ge,ee))}function J(m,w){for(var k=[m[0]],H=1,ee=0,oe=m.length;H<oe;H++)it(m[H],m[ee])>w&&(k.push(m[H]),ee=H);return ee<oe-1&&k.push(m[oe-1]),k}var se;function he(m,w,k,H,ee){var oe=H?se:Oe(m,k),ge=Oe(w,k),ke,Be,Je;for(se=ge;;){if(!(oe|ge))return[m,w];if(oe&ge)return!1;ke=oe||ge,Be=Ie(m,w,ke,k,ee),Je=Oe(Be,k),ke===oe?(m=Be,oe=Je):(w=Be,ge=Je)}}function Ie(m,w,k,H,ee){var oe=w.x-m.x,ge=w.y-m.y,ke=H.min,Be=H.max,Je,ft;return k&8?(Je=m.x+oe*(Be.y-m.y)/ge,ft=Be.y):k&4?(Je=m.x+oe*(ke.y-m.y)/ge,ft=ke.y):k&2?(Je=Be.x,ft=m.y+ge*(Be.x-m.x)/oe):k&1&&(Je=ke.x,ft=m.y+ge*(ke.x-m.x)/oe),new Z(Je,ft,ee)}function Oe(m,w){var k=0;return m.x<w.min.x?k|=1:m.x>w.max.x&&(k|=2),m.y<w.min.y?k|=4:m.y>w.max.y&&(k|=8),k}function it(m,w){var k=w.x-m.x,H=w.y-m.y;return k*k+H*H}function Gt(m,w,k,H){var ee=w.x,oe=w.y,ge=k.x-ee,ke=k.y-oe,Be=ge*ge+ke*ke,Je;return Be>0&&(Je=((m.x-ee)*ge+(m.y-oe)*ke)/Be,Je>1?(ee=k.x,oe=k.y):Je>0&&(ee+=ge*Je,oe+=ke*Je)),ge=m.x-ee,ke=m.y-oe,H?ge*ge+ke*ke:new Z(ee,oe)}function $n(m){return!C(m[0])||typeof m[0][0]!="object"&&typeof m[0][0]<"u"}function hr(m){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),$n(m)}function ts(m,w){var k,H,ee,oe,ge,ke,Be,Je;if(!m||m.length===0)throw new Error("latlngs not passed");$n(m)||(console.warn("latlngs are not flat! Only the first ring will be used"),m=m[0]);var ft=ae([0,0]),vt=re(m),At=vt.getNorthWest().distanceTo(vt.getSouthWest())*vt.getNorthEast().distanceTo(vt.getNorthWest());At<1700&&(ft=Wh(m));var Qt=m.length,zr=[];for(k=0;k<Qt;k++){var cs=ae(m[k]);zr.push(w.project(ae([cs.lat-ft.lat,cs.lng-ft.lng])))}for(k=0,H=0;k<Qt-1;k++)H+=zr[k].distanceTo(zr[k+1])/2;if(H===0)Je=zr[0];else for(k=0,oe=0;k<Qt-1;k++)if(ge=zr[k],ke=zr[k+1],ee=ge.distanceTo(ke),oe+=ee,oe>H){Be=(oe-H)/ee,Je=[ke.x-Be*(ke.x-ge.x),ke.y-Be*(ke.y-ge.y)];break}var Ni=w.unproject(Q(Je));return ae([Ni.lat+ft.lat,Ni.lng+ft.lng])}var za={__proto__:null,simplify:Ai,pointToSegmentDistance:Kh,closestPointOnSegment:qm,clipSegment:he,_getEdgeIntersection:Ie,_getBitCode:Oe,_sqClosestPointOnSegment:Gt,isFlat:$n,_flat:hr,polylineCenter:ts},io={project:function(m){return new Z(m.lng,m.lat)},unproject:function(m){return new W(m.y,m.x)},bounds:new z([-180,-90],[180,90])},ja={R:6378137,R_MINOR:6356752314245179e-9,bounds:new z([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(m){var w=Math.PI/180,k=this.R,H=m.lat*w,ee=this.R_MINOR/k,oe=Math.sqrt(1-ee*ee),ge=oe*Math.sin(H),ke=Math.tan(Math.PI/4-H/2)/Math.pow((1-ge)/(1+ge),oe/2);return H=-k*Math.log(Math.max(ke,1e-10)),new Z(m.lng*w*k,H)},unproject:function(m){for(var w=180/Math.PI,k=this.R,H=this.R_MINOR/k,ee=Math.sqrt(1-H*H),oe=Math.exp(-m.y/k),ge=Math.PI/2-2*Math.atan(oe),ke=0,Be=.1,Je;ke<15&&Math.abs(Be)>1e-7;ke++)Je=ee*Math.sin(ge),Je=Math.pow((1-Je)/(1+Je),ee/2),Be=Math.PI/2-2*Math.atan(oe*Je)-ge,ge+=Be;return new W(ge*w,m.x*w/k)}},Do={__proto__:null,LonLat:io,Mercator:ja,SphericalMercator:Ve},$o=s({},de,{code:"EPSG:3395",projection:ja,transformation:(function(){var m=.5/(Math.PI*ja.R);return Ge(m,.5,-m,.5)})()}),Xh=s({},de,{code:"EPSG:4326",projection:io,transformation:Ge(1/180,1,-1/180,.5)}),MC=s({},pe,{projection:io,transformation:Ge(1,0,-1,0),scale:function(m){return Math.pow(2,m)},zoom:function(m){return Math.log(m)/Math.LN2},distance:function(m,w){var k=w.lng-m.lng,H=w.lat-m.lat;return Math.sqrt(k*k+H*H)},infinite:!0});pe.Earth=de,pe.EPSG3395=$o,pe.EPSG3857=at,pe.EPSG900913=We,pe.EPSG4326=Xh,pe.Simple=MC;var Lo=Y.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(m){return m.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(m){return m&&m.removeLayer(this),this},getPane:function(m){return this._map.getPane(m?this.options[m]||m:this.options.pane)},addInteractiveTarget:function(m){return this._map._targets[l(m)]=this,this},removeInteractiveTarget:function(m){return delete this._map._targets[l(m)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(m){var w=m.target;if(w.hasLayer(this)){if(this._map=w,this._zoomAnimated=w._zoomAnimated,this.getEvents){var k=this.getEvents();w.on(k,this),this.once("remove",function(){w.off(k,this)},this)}this.onAdd(w),this.fire("add"),w.fire("layeradd",{layer:this})}}});dn.include({addLayer:function(m){if(!m._layerAdd)throw new Error("The provided object is not a Layer.");var w=l(m);return this._layers[w]?this:(this._layers[w]=m,m._mapToAdd=this,m.beforeAdd&&m.beforeAdd(this),this.whenReady(m._layerAdd,m),this)},removeLayer:function(m){var w=l(m);return this._layers[w]?(this._loaded&&m.onRemove(this),delete this._layers[w],this._loaded&&(this.fire("layerremove",{layer:m}),m.fire("remove")),m._map=m._mapToAdd=null,this):this},hasLayer:function(m){return l(m)in this._layers},eachLayer:function(m,w){for(var k in this._layers)m.call(w,this._layers[k]);return this},_addLayers:function(m){m=m?C(m)?m:[m]:[];for(var w=0,k=m.length;w<k;w++)this.addLayer(m[w])},_addZoomLimit:function(m){(!isNaN(m.options.maxZoom)||!isNaN(m.options.minZoom))&&(this._zoomBoundLayers[l(m)]=m,this._updateZoomLevels())},_removeZoomLimit:function(m){var w=l(m);this._zoomBoundLayers[w]&&(delete this._zoomBoundLayers[w],this._updateZoomLevels())},_updateZoomLevels:function(){var m=1/0,w=-1/0,k=this._getZoomSpan();for(var H in this._zoomBoundLayers){var ee=this._zoomBoundLayers[H].options;m=ee.minZoom===void 0?m:Math.min(m,ee.minZoom),w=ee.maxZoom===void 0?w:Math.max(w,ee.maxZoom)}this._layersMaxZoom=w===-1/0?void 0:w,this._layersMinZoom=m===1/0?void 0:m,k!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ju=Lo.extend({initialize:function(m,w){v(this,w),this._layers={};var k,H;if(m)for(k=0,H=m.length;k<H;k++)this.addLayer(m[k])},addLayer:function(m){var w=this.getLayerId(m);return this._layers[w]=m,this._map&&this._map.addLayer(m),this},removeLayer:function(m){var w=m in this._layers?m:this.getLayerId(m);return this._map&&this._layers[w]&&this._map.removeLayer(this._layers[w]),delete this._layers[w],this},hasLayer:function(m){var w=typeof m=="number"?m:this.getLayerId(m);return w in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(m){var w=Array.prototype.slice.call(arguments,1),k,H;for(k in this._layers)H=this._layers[k],H[m]&&H[m].apply(H,w);return this},onAdd:function(m){this.eachLayer(m.addLayer,m)},onRemove:function(m){this.eachLayer(m.removeLayer,m)},eachLayer:function(m,w){for(var k in this._layers)m.call(w,this._layers[k]);return this},getLayer:function(m){return this._layers[m]},getLayers:function(){var m=[];return this.eachLayer(m.push,m),m},setZIndex:function(m){return this.invoke("setZIndex",m)},getLayerId:function(m){return l(m)}}),zv=function(m,w){return new ju(m,w)},Va=ju.extend({addLayer:function(m){return this.hasLayer(m)?this:(m.addEventParent(this),ju.prototype.addLayer.call(this,m),this.fire("layeradd",{layer:m}))},removeLayer:function(m){return this.hasLayer(m)?(m in this._layers&&(m=this._layers[m]),m.removeEventParent(this),ju.prototype.removeLayer.call(this,m),this.fire("layerremove",{layer:m})):this},setStyle:function(m){return this.invoke("setStyle",m)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var m=new X;for(var w in this._layers){var k=this._layers[w];m.extend(k.getBounds?k.getBounds():k.getLatLng())}return m}}),Yf=function(m,w){return new Va(m,w)},Yh=N.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(m){v(this,m)},createIcon:function(m){return this._createIcon("icon",m)},createShadow:function(m){return this._createIcon("shadow",m)},_createIcon:function(m,w){var k=this._getIconUrl(m);if(!k){if(m==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var H=this._createImg(k,w&&w.tagName==="IMG"?w:null);return this._setIconStyles(H,m),(this.options.crossOrigin||this.options.crossOrigin==="")&&(H.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),H},_setIconStyles:function(m,w){var k=this.options,H=k[w+"Size"];typeof H=="number"&&(H=[H,H]);var ee=Q(H),oe=Q(w==="shadow"&&k.shadowAnchor||k.iconAnchor||ee&&ee.divideBy(2,!0));m.className="leaflet-marker-"+w+" "+(k.className||""),oe&&(m.style.marginLeft=-oe.x+"px",m.style.marginTop=-oe.y+"px"),ee&&(m.style.width=ee.x+"px",m.style.height=ee.y+"px")},_createImg:function(m,w){return w=w||document.createElement("img"),w.src=m,w},_getIconUrl:function(m){return dt.retina&&this.options[m+"RetinaUrl"]||this.options[m+"Url"]}});function Km(m){return new Yh(m)}var Zh=Yh.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(m){return typeof Zh.imagePath!="string"&&(Zh.imagePath=this._detectIconPath()),(this.options.imagePath||Zh.imagePath)+Yh.prototype._getIconUrl.call(this,m)},_stripUrl:function(m){var w=function(k,H,ee){var oe=H.exec(k);return oe&&oe[ee]};return m=w(m,/^url\((['"])?(.+)\1\)$/,2),m&&w(m,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var m=_n("div","leaflet-default-icon-path",document.body),w=ua(m,"background-image")||ua(m,"backgroundImage");if(document.body.removeChild(m),w=this._stripUrl(w),w)return w;var k=document.querySelector('link[href$="leaflet.css"]');return k?k.href.substring(0,k.href.length-11-1):""}}),xx=fa.extend({initialize:function(m){this._marker=m},addHooks:function(){var m=this._marker._icon;this._draggable||(this._draggable=new Ro(m,m,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),yt(m,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&xr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(m){var w=this._marker,k=w._map,H=this._marker.options.autoPanSpeed,ee=this._marker.options.autoPanPadding,oe=ol(w._icon),ge=k.getPixelBounds(),ke=k.getPixelOrigin(),Be=D(ge.min._subtract(ke).add(ee),ge.max._subtract(ke).subtract(ee));if(!Be.contains(oe)){var Je=Q((Math.max(Be.max.x,oe.x)-Be.max.x)/(ge.max.x-Be.max.x)-(Math.min(Be.min.x,oe.x)-Be.min.x)/(ge.min.x-Be.min.x),(Math.max(Be.max.y,oe.y)-Be.max.y)/(ge.max.y-Be.max.y)-(Math.min(Be.min.y,oe.y)-Be.min.y)/(ge.min.y-Be.min.y)).multiplyBy(H);k.panBy(Je,{animate:!1}),this._draggable._newPos._add(Je),this._draggable._startPos._add(Je),qr(w._icon,this._draggable._newPos),this._onDrag(m),this._panRequest=O(this._adjustPan.bind(this,m))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(m){this._marker.options.autoPan&&(K(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,m)))},_onDrag:function(m){var w=this._marker,k=w._shadow,H=ol(w._icon),ee=w._map.layerPointToLatLng(H);k&&qr(k,H),w._latlng=ee,m.latlng=ee,m.oldLatLng=this._oldLatLng,w.fire("move",m).fire("drag",m)},_onDragEnd:function(m){K(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",m)}}),Qh=Lo.extend({options:{icon:new Zh,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(m,w){v(this,w),this._latlng=ae(m)},onAdd:function(m){this._zoomAnimated=this._zoomAnimated&&m.options.markerZoomAnimation,this._zoomAnimated&&m.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(m){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&m.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(m){var w=this._latlng;return this._latlng=ae(m),this.update(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},setZIndexOffset:function(m){return this.options.zIndexOffset=m,this.update()},getIcon:function(){return this.options.icon},setIcon:function(m){return this.options.icon=m,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var m=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(m)}return this},_initIcon:function(){var m=this.options,w="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),k=m.icon.createIcon(this._icon),H=!1;k!==this._icon&&(this._icon&&this._removeIcon(),H=!0,m.title&&(k.title=m.title),k.tagName==="IMG"&&(k.alt=m.alt||"")),yt(k,w),m.keyboard&&(k.tabIndex="0",k.setAttribute("role","button")),this._icon=k,m.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ut(k,"focus",this._panOnFocus,this);var ee=m.icon.createShadow(this._shadow),oe=!1;ee!==this._shadow&&(this._removeShadow(),oe=!0),ee&&(yt(ee,w),ee.alt=""),this._shadow=ee,m.opacity<1&&this._updateOpacity(),H&&this.getPane().appendChild(this._icon),this._initInteraction(),ee&&oe&&this.getPane(m.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Yn(this._icon,"focus",this._panOnFocus,this),Nn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Nn(this._shadow),this._shadow=null},_setPos:function(m){this._icon&&qr(this._icon,m),this._shadow&&qr(this._shadow,m),this._zIndex=m.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(m){this._icon&&(this._icon.style.zIndex=this._zIndex+m)},_animateZoom:function(m){var w=this._map._latLngToNewLayerPoint(this._latlng,m.zoom,m.center).round();this._setPos(w)},_initInteraction:function(){if(this.options.interactive&&(yt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),xx)){var m=this.options.draggable;this.dragging&&(m=this.dragging.enabled(),this.dragging.disable()),this.dragging=new xx(this),m&&this.dragging.enable()}},setOpacity:function(m){return this.options.opacity=m,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var m=this.options.opacity;this._icon&&wi(this._icon,m),this._shadow&&wi(this._shadow,m)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var m=this._map;if(m){var w=this.options.icon.options,k=w.iconSize?Q(w.iconSize):Q(0,0),H=w.iconAnchor?Q(w.iconAnchor):Q(0,0);m.panInside(this._latlng,{paddingTopLeft:H,paddingBottomRight:k.subtract(H)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function yx(m,w){return new Qh(m,w)}var Hl=Lo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(m){this._renderer=m.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(m){return v(this,m),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&m&&Object.prototype.hasOwnProperty.call(m,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Zf=Hl.extend({options:{fill:!0,radius:10},initialize:function(m,w){v(this,w),this._latlng=ae(m),this._radius=this.options.radius},setLatLng:function(m){var w=this._latlng;return this._latlng=ae(m),this.redraw(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(m){return this.options.radius=this._radius=m,this.redraw()},getRadius:function(){return this._radius},setStyle:function(m){var w=m&&m.radius||this._radius;return Hl.prototype.setStyle.call(this,m),this.setRadius(w),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var m=this._radius,w=this._radiusY||m,k=this._clickTolerance(),H=[m+k,w+k];this._pxBounds=new z(this._point.subtract(H),this._point.add(H))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(m){return m.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function jv(m,w){return new Zf(m,w)}var bx=Zf.extend({initialize:function(m,w,k){if(typeof w=="number"&&(w=s({},k,{radius:w})),v(this,w),this._latlng=ae(m),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(m){return this._mRadius=m,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var m=[this._radius,this._radiusY||this._radius];return new X(this._map.layerPointToLatLng(this._point.subtract(m)),this._map.layerPointToLatLng(this._point.add(m)))},setStyle:Hl.prototype.setStyle,_project:function(){var m=this._latlng.lng,w=this._latlng.lat,k=this._map,H=k.options.crs;if(H.distance===de.distance){var ee=Math.PI/180,oe=this._mRadius/de.R/ee,ge=k.project([w+oe,m]),ke=k.project([w-oe,m]),Be=ge.add(ke).divideBy(2),Je=k.unproject(Be).lat,ft=Math.acos((Math.cos(oe*ee)-Math.sin(w*ee)*Math.sin(Je*ee))/(Math.cos(w*ee)*Math.cos(Je*ee)))/ee;(isNaN(ft)||ft===0)&&(ft=oe/Math.cos(Math.PI/180*w)),this._point=Be.subtract(k.getPixelOrigin()),this._radius=isNaN(ft)?0:Be.x-k.project([Je,m-ft]).x,this._radiusY=Be.y-ge.y}else{var vt=H.unproject(H.project(this._latlng).subtract([this._mRadius,0]));this._point=k.latLngToLayerPoint(this._latlng),this._radius=this._point.x-k.latLngToLayerPoint(vt).x}this._updateBounds()}});function FC(m,w,k){return new bx(m,w,k)}var Wl=Hl.extend({options:{smoothFactor:1,noClip:!1},initialize:function(m,w){v(this,w),this._setLatLngs(m)},getLatLngs:function(){return this._latlngs},setLatLngs:function(m){return this._setLatLngs(m),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(m){for(var w=1/0,k=null,H=Gt,ee,oe,ge=0,ke=this._parts.length;ge<ke;ge++)for(var Be=this._parts[ge],Je=1,ft=Be.length;Je<ft;Je++){ee=Be[Je-1],oe=Be[Je];var vt=H(m,ee,oe,!0);vt<w&&(w=vt,k=H(m,ee,oe))}return k&&(k.distance=Math.sqrt(w)),k},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ts(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(m,w){return w=w||this._defaultShape(),m=ae(m),w.push(m),this._bounds.extend(m),this.redraw()},_setLatLngs:function(m){this._bounds=new X,this._latlngs=this._convertLatLngs(m)},_defaultShape:function(){return $n(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(m){for(var w=[],k=$n(m),H=0,ee=m.length;H<ee;H++)k?(w[H]=ae(m[H]),this._bounds.extend(w[H])):w[H]=this._convertLatLngs(m[H]);return w},_project:function(){var m=new z;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,m),this._bounds.isValid()&&m.isValid()&&(this._rawPxBounds=m,this._updateBounds())},_updateBounds:function(){var m=this._clickTolerance(),w=new Z(m,m);this._rawPxBounds&&(this._pxBounds=new z([this._rawPxBounds.min.subtract(w),this._rawPxBounds.max.add(w)]))},_projectLatlngs:function(m,w,k){var H=m[0]instanceof W,ee=m.length,oe,ge;if(H){for(ge=[],oe=0;oe<ee;oe++)ge[oe]=this._map.latLngToLayerPoint(m[oe]),k.extend(ge[oe]);w.push(ge)}else for(oe=0;oe<ee;oe++)this._projectLatlngs(m[oe],w,k)},_clipPoints:function(){var m=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(m))){if(this.options.noClip){this._parts=this._rings;return}var w=this._parts,k,H,ee,oe,ge,ke,Be;for(k=0,ee=0,oe=this._rings.length;k<oe;k++)for(Be=this._rings[k],H=0,ge=Be.length;H<ge-1;H++)ke=he(Be[H],Be[H+1],m,H,!0),ke&&(w[ee]=w[ee]||[],w[ee].push(ke[0]),(ke[1]!==Be[H+1]||H===ge-2)&&(w[ee].push(ke[1]),ee++))}},_simplifyPoints:function(){for(var m=this._parts,w=this.options.smoothFactor,k=0,H=m.length;k<H;k++)m[k]=Ai(m[k],w)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(m,w){var k,H,ee,oe,ge,ke,Be=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(m))return!1;for(k=0,oe=this._parts.length;k<oe;k++)for(ke=this._parts[k],H=0,ge=ke.length,ee=ge-1;H<ge;ee=H++)if(!(!w&&H===0)&&Kh(m,ke[ee],ke[H])<=Be)return!0;return!1}});function BC(m,w){return new Wl(m,w)}Wl._flat=hr;var Jh=Wl.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(m){var w=Wl.prototype._convertLatLngs.call(this,m),k=w.length;return k>=2&&w[0]instanceof W&&w[0].equals(w[k-1])&&w.pop(),w},_setLatLngs:function(m){Wl.prototype._setLatLngs.call(this,m),$n(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return $n(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var m=this._renderer._bounds,w=this.options.weight,k=new Z(w,w);if(m=new z(m.min.subtract(k),m.max.add(k)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(m))){if(this.options.noClip){this._parts=this._rings;return}for(var H=0,ee=this._rings.length,oe;H<ee;H++)oe=Xf(this._rings[H],m,!0),oe.length&&this._parts.push(oe)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(m){var w=!1,k,H,ee,oe,ge,ke,Be,Je;if(!this._pxBounds||!this._pxBounds.contains(m))return!1;for(oe=0,Be=this._parts.length;oe<Be;oe++)for(k=this._parts[oe],ge=0,Je=k.length,ke=Je-1;ge<Je;ke=ge++)H=k[ge],ee=k[ke],H.y>m.y!=ee.y>m.y&&m.x<(ee.x-H.x)*(m.y-H.y)/(ee.y-H.y)+H.x&&(w=!w);return w||Wl.prototype._containsPoint.call(this,m,!0)}});function Ua(m,w){return new Jh(m,w)}var Ga=Va.extend({initialize:function(m,w){v(this,w),this._layers={},m&&this.addData(m)},addData:function(m){var w=C(m)?m:m.features,k,H,ee;if(w){for(k=0,H=w.length;k<H;k++)ee=w[k],(ee.geometries||ee.geometry||ee.features||ee.coordinates)&&this.addData(ee);return this}var oe=this.options;if(oe.filter&&!oe.filter(m))return this;var ge=Qf(m,oe);return ge?(ge.feature=ed(m),ge.defaultOptions=ge.options,this.resetStyle(ge),oe.onEachFeature&&oe.onEachFeature(m,ge),this.addLayer(ge)):this},resetStyle:function(m){return m===void 0?this.eachLayer(this.resetStyle,this):(m.options=s({},m.defaultOptions),this._setLayerStyle(m,this.options.style),this)},setStyle:function(m){return this.eachLayer(function(w){this._setLayerStyle(w,m)},this)},_setLayerStyle:function(m,w){m.setStyle&&(typeof w=="function"&&(w=w(m.feature)),m.setStyle(w))}});function Qf(m,w){var k=m.type==="Feature"?m.geometry:m,H=k?k.coordinates:null,ee=[],oe=w&&w.pointToLayer,ge=w&&w.coordsToLatLng||Xm,ke,Be,Je,ft;if(!H&&!k)return null;switch(k.type){case"Point":return ke=ge(H),vx(oe,m,ke,w);case"MultiPoint":for(Je=0,ft=H.length;Je<ft;Je++)ke=ge(H[Je]),ee.push(vx(oe,m,ke,w));return new Va(ee);case"LineString":case"MultiLineString":return Be=Jf(H,k.type==="LineString"?0:1,ge),new Wl(Be,w);case"Polygon":case"MultiPolygon":return Be=Jf(H,k.type==="Polygon"?1:2,ge),new Jh(Be,w);case"GeometryCollection":for(Je=0,ft=k.geometries.length;Je<ft;Je++){var vt=Qf({geometry:k.geometries[Je],type:"Feature",properties:m.properties},w);vt&&ee.push(vt)}return new Va(ee);case"FeatureCollection":for(Je=0,ft=k.features.length;Je<ft;Je++){var At=Qf(k.features[Je],w);At&&ee.push(At)}return new Va(ee);default:throw new Error("Invalid GeoJSON object.")}}function vx(m,w,k,H){return m?m(w,k):new Qh(k,H&&H.markersInheritOptions&&H)}function Xm(m){return new W(m[1],m[0],m[2])}function Jf(m,w,k){for(var H=[],ee=0,oe=m.length,ge;ee<oe;ee++)ge=w?Jf(m[ee],w-1,k):(k||Xm)(m[ee]),H.push(ge);return H}function ep(m,w){return m=ae(m),m.alt!==void 0?[p(m.lng,w),p(m.lat,w),p(m.alt,w)]:[p(m.lng,w),p(m.lat,w)]}function Ym(m,w,k,H){for(var ee=[],oe=0,ge=m.length;oe<ge;oe++)ee.push(w?Ym(m[oe],$n(m[oe])?0:w-1,k,H):ep(m[oe],H));return!w&&k&&ee.length>0&&ee.push(ee[0].slice()),ee}function Po(m,w){return m.feature?s({},m.feature,{geometry:w}):ed(w)}function ed(m){return m.type==="Feature"||m.type==="FeatureCollection"?m:{type:"Feature",properties:{},geometry:m}}var Vu={toGeoJSON:function(m){return Po(this,{type:"Point",coordinates:ep(this.getLatLng(),m)})}};Qh.include(Vu),bx.include(Vu),Zf.include(Vu),Wl.include({toGeoJSON:function(m){var w=!$n(this._latlngs),k=Ym(this._latlngs,w?1:0,!1,m);return Po(this,{type:(w?"Multi":"")+"LineString",coordinates:k})}}),Jh.include({toGeoJSON:function(m){var w=!$n(this._latlngs),k=w&&!$n(this._latlngs[0]),H=Ym(this._latlngs,k?2:w?1:0,!0,m);return w||(H=[H]),Po(this,{type:(k?"Multi":"")+"Polygon",coordinates:H})}}),ju.include({toMultiPoint:function(m){var w=[];return this.eachLayer(function(k){w.push(k.toGeoJSON(m).geometry.coordinates)}),Po(this,{type:"MultiPoint",coordinates:w})},toGeoJSON:function(m){var w=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(w==="MultiPoint")return this.toMultiPoint(m);var k=w==="GeometryCollection",H=[];return this.eachLayer(function(ee){if(ee.toGeoJSON){var oe=ee.toGeoJSON(m);if(k)H.push(oe.geometry);else{var ge=ed(oe);ge.type==="FeatureCollection"?H.push.apply(H,ge.features):H.push(ge)}}}),k?Po(this,{geometries:H,type:"GeometryCollection"}):{type:"FeatureCollection",features:H}}});function Zm(m,w){return new Ga(m,w)}var Vv=Zm,hl=Lo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(m,w,k){this._url=m,this._bounds=re(w),v(this,k)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(yt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Nn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(m){return this.options.opacity=m,this._image&&this._updateOpacity(),this},setStyle:function(m){return m.opacity&&this.setOpacity(m.opacity),this},bringToFront:function(){return this._map&&Oa(this._image),this},bringToBack:function(){return this._map&&so(this._image),this},setUrl:function(m){return this._url=m,this._image&&(this._image.src=m),this},setBounds:function(m){return this._bounds=re(m),this._map&&this._reset(),this},getEvents:function(){var m={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(m.zoomanim=this._animateZoom),m},setZIndex:function(m){return this.options.zIndex=m,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var m=this._url.tagName==="IMG",w=this._image=m?this._url:_n("img");if(yt(w,"leaflet-image-layer"),this._zoomAnimated&&yt(w,"leaflet-zoom-animated"),this.options.className&&yt(w,this.options.className),w.onselectstart=d,w.onmousemove=d,w.onload=a(this.fire,this,"load"),w.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),m){this._url=w.src;return}w.src=this._url,w.alt=this.options.alt},_animateZoom:function(m){var w=this._map.getZoomScale(m.zoom),k=this._map._latLngBoundsToNewLayerBounds(this._bounds,m.zoom,m.center).min;ha(this._image,k,w)},_reset:function(){var m=this._image,w=new z(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),k=w.getSize();qr(m,w.min),m.style.width=k.x+"px",m.style.height=k.y+"px"},_updateOpacity:function(){wi(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var m=this.options.errorOverlayUrl;m&&this._url!==m&&(this._url=m,this._image.src=m)},getCenter:function(){return this._bounds.getCenter()}}),td=function(m,w,k){return new hl(m,w,k)},Qm=hl.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var m=this._url.tagName==="VIDEO",w=this._image=m?this._url:_n("video");if(yt(w,"leaflet-image-layer"),this._zoomAnimated&&yt(w,"leaflet-zoom-animated"),this.options.className&&yt(w,this.options.className),w.onselectstart=d,w.onmousemove=d,w.onloadeddata=a(this.fire,this,"load"),m){for(var k=w.getElementsByTagName("source"),H=[],ee=0;ee<k.length;ee++)H.push(k[ee].src);this._url=k.length>0?H:[w.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(w.style,"objectFit")&&(w.style.objectFit="fill"),w.autoplay=!!this.options.autoplay,w.loop=!!this.options.loop,w.muted=!!this.options.muted,w.playsInline=!!this.options.playsInline;for(var oe=0;oe<this._url.length;oe++){var ge=_n("source");ge.src=this._url[oe],w.appendChild(ge)}}});function Uv(m,w,k){return new Qm(m,w,k)}var Ic=hl.extend({_initImage:function(){var m=this._image=this._url;yt(m,"leaflet-image-layer"),this._zoomAnimated&&yt(m,"leaflet-zoom-animated"),this.options.className&&yt(m,this.options.className),m.onselectstart=d,m.onmousemove=d}});function Gv(m,w,k){return new Ic(m,w,k)}var Oo=Lo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(m,w){m&&(m instanceof W||C(m))?(this._latlng=ae(m),v(this,w)):(v(this,m),this._source=w),this.options.content&&(this._content=this.options.content)},openOn:function(m){return m=arguments.length?m:this._source._map,m.hasLayer(this)||m.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(m){return this._map?this.close():(arguments.length?this._source=m:m=this._source,this._prepareOpen(),this.openOn(m._map)),this},onAdd:function(m){this._zoomAnimated=m._zoomAnimated,this._container||this._initLayout(),m._fadeAnimated&&wi(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),m._fadeAnimated&&wi(this._container,1),this.bringToFront(),this.options.interactive&&(yt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(m){m._fadeAnimated?(wi(this._container,0),this._removeTimeout=setTimeout(a(Nn,void 0,this._container),200)):Nn(this._container),this.options.interactive&&(xr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(m){return this._latlng=ae(m),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(m){return this._content=m,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var m={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(m.zoomanim=this._animateZoom),m},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Oa(this._container),this},bringToBack:function(){return this._map&&so(this._container),this},_prepareOpen:function(m){var w=this._source;if(!w._map)return!1;if(w instanceof Va){w=null;var k=this._source._layers;for(var H in k)if(k[H]._map){w=k[H];break}if(!w)return!1;this._source=w}if(!m)if(w.getCenter)m=w.getCenter();else if(w.getLatLng)m=w.getLatLng();else if(w.getBounds)m=w.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(m),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var m=this._contentNode,w=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof w=="string")m.innerHTML=w;else{for(;m.hasChildNodes();)m.removeChild(m.firstChild);m.appendChild(w)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var m=this._map.latLngToLayerPoint(this._latlng),w=Q(this.options.offset),k=this._getAnchor();this._zoomAnimated?qr(this._container,m.add(k)):w=w.add(m).add(k);var H=this._containerBottom=-w.y,ee=this._containerLeft=-Math.round(this._containerWidth/2)+w.x;this._container.style.bottom=H+"px",this._container.style.left=ee+"px"}},_getAnchor:function(){return[0,0]}});dn.include({_initOverlay:function(m,w,k,H){var ee=w;return ee instanceof m||(ee=new m(H).setContent(w)),k&&ee.setLatLng(k),ee}}),Lo.include({_initOverlay:function(m,w,k,H){var ee=k;return ee instanceof m?(v(ee,H),ee._source=this):(ee=w&&!H?w:new m(H,this),ee.setContent(k)),ee}});var tp=Oo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(m){return m=arguments.length?m:this._source._map,!m.hasLayer(this)&&m._popup&&m._popup.options.autoClose&&m.removeLayer(m._popup),m._popup=this,Oo.prototype.openOn.call(this,m)},onAdd:function(m){Oo.prototype.onAdd.call(this,m),m.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Hl||this._source.on("preclick",rr))},onRemove:function(m){Oo.prototype.onRemove.call(this,m),m.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Hl||this._source.off("preclick",rr))},getEvents:function(){var m=Oo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(m.preclick=this.close),this.options.keepInView&&(m.moveend=this._adjustPan),m},_initLayout:function(){var m="leaflet-popup",w=this._container=_n("div",m+" "+(this.options.className||"")+" leaflet-zoom-animated"),k=this._wrapper=_n("div",m+"-content-wrapper",w);if(this._contentNode=_n("div",m+"-content",k),Ac(w),Cc(this._contentNode),Ut(w,"contextmenu",rr),this._tipContainer=_n("div",m+"-tip-container",w),this._tip=_n("div",m+"-tip",this._tipContainer),this.options.closeButton){var H=this._closeButton=_n("a",m+"-close-button",w);H.setAttribute("role","button"),H.setAttribute("aria-label","Close popup"),H.href="#close",H.innerHTML='<span aria-hidden="true">&#215;</span>',Ut(H,"click",function(ee){Kr(ee),this.close()},this)}},_updateLayout:function(){var m=this._contentNode,w=m.style;w.width="",w.whiteSpace="nowrap";var k=m.offsetWidth;k=Math.min(k,this.options.maxWidth),k=Math.max(k,this.options.minWidth),w.width=k+1+"px",w.whiteSpace="",w.height="";var H=m.offsetHeight,ee=this.options.maxHeight,oe="leaflet-popup-scrolled";ee&&H>ee?(w.height=ee+"px",yt(m,oe)):xr(m,oe),this._containerWidth=this._container.offsetWidth},_animateZoom:function(m){var w=this._map._latLngToNewLayerPoint(this._latlng,m.zoom,m.center),k=this._getAnchor();qr(this._container,w.add(k))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var m=this._map,w=parseInt(ua(this._container,"marginBottom"),10)||0,k=this._container.offsetHeight+w,H=this._containerWidth,ee=new Z(this._containerLeft,-k-this._containerBottom);ee._add(ol(this._container));var oe=m.layerPointToContainerPoint(ee),ge=Q(this.options.autoPanPadding),ke=Q(this.options.autoPanPaddingTopLeft||ge),Be=Q(this.options.autoPanPaddingBottomRight||ge),Je=m.getSize(),ft=0,vt=0;oe.x+H+Be.x>Je.x&&(ft=oe.x+H-Je.x+Be.x),oe.x-ft-ke.x<0&&(ft=oe.x-ke.x),oe.y+k+Be.y>Je.y&&(vt=oe.y+k-Je.y+Be.y),oe.y-vt-ke.y<0&&(vt=oe.y-ke.y),(ft||vt)&&(this.options.keepInView&&(this._autopanning=!0),m.fire("autopanstart").panBy([ft,vt]))}},_getAnchor:function(){return Q(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),zC=function(m,w){return new tp(m,w)};dn.mergeOptions({closePopupOnClick:!0}),dn.include({openPopup:function(m,w,k){return this._initOverlay(tp,m,w,k).openOn(this),this},closePopup:function(m){return m=arguments.length?m:this._popup,m&&m.close(),this}}),Lo.include({bindPopup:function(m,w){return this._popup=this._initOverlay(tp,this._popup,m,w),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(m){return this._popup&&(this instanceof Va||(this._popup._source=this),this._popup._prepareOpen(m||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(m){return this._popup&&this._popup.setContent(m),this},getPopup:function(){return this._popup},_openPopup:function(m){if(!(!this._popup||!this._map)){Ba(m);var w=m.layer||m.target;if(this._popup._source===w&&!(w instanceof Hl)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(m.latlng);return}this._popup._source=w,this.openPopup(m.latlng)}},_movePopup:function(m){this._popup.setLatLng(m.latlng)},_onKeyPress:function(m){m.originalEvent.keyCode===13&&this._openPopup(m)}});var Jm=Oo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(m){Oo.prototype.onAdd.call(this,m),this.setOpacity(this.options.opacity),m.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(m){Oo.prototype.onRemove.call(this,m),m.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var m=Oo.prototype.getEvents.call(this);return this.options.permanent||(m.preclick=this.close),m},_initLayout:function(){var m="leaflet-tooltip",w=m+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=_n("div",w),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(m){var w,k,H=this._map,ee=this._container,oe=H.latLngToContainerPoint(H.getCenter()),ge=H.layerPointToContainerPoint(m),ke=this.options.direction,Be=ee.offsetWidth,Je=ee.offsetHeight,ft=Q(this.options.offset),vt=this._getAnchor();ke==="top"?(w=Be/2,k=Je):ke==="bottom"?(w=Be/2,k=0):ke==="center"?(w=Be/2,k=Je/2):ke==="right"?(w=0,k=Je/2):ke==="left"?(w=Be,k=Je/2):ge.x<oe.x?(ke="right",w=0,k=Je/2):(ke="left",w=Be+(ft.x+vt.x)*2,k=Je/2),m=m.subtract(Q(w,k,!0)).add(ft).add(vt),xr(ee,"leaflet-tooltip-right"),xr(ee,"leaflet-tooltip-left"),xr(ee,"leaflet-tooltip-top"),xr(ee,"leaflet-tooltip-bottom"),yt(ee,"leaflet-tooltip-"+ke),qr(ee,m)},_updatePosition:function(){var m=this._map.latLngToLayerPoint(this._latlng);this._setPosition(m)},setOpacity:function(m){this.options.opacity=m,this._container&&wi(this._container,m)},_animateZoom:function(m){var w=this._map._latLngToNewLayerPoint(this._latlng,m.zoom,m.center);this._setPosition(w)},_getAnchor:function(){return Q(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),jC=function(m,w){return new Jm(m,w)};dn.include({openTooltip:function(m,w,k){return this._initOverlay(Jm,m,w,k).openOn(this),this},closeTooltip:function(m){return m.close(),this}}),Lo.include({bindTooltip:function(m,w){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Jm,this._tooltip,m,w),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(m){if(!(!m&&this._tooltipHandlersAdded)){var w=m?"off":"on",k={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?k.add=this._openTooltip:(k.mouseover=this._openTooltip,k.mouseout=this.closeTooltip,k.click=this._openTooltip,this._map?this._addFocusListeners():k.add=this._addFocusListeners),this._tooltip.options.sticky&&(k.mousemove=this._moveTooltip),this[w](k),this._tooltipHandlersAdded=!m}},openTooltip:function(m){return this._tooltip&&(this instanceof Va||(this._tooltip._source=this),this._tooltip._prepareOpen(m)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(m){return this._tooltip&&this._tooltip.setContent(m),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(m){var w=typeof m.getElement=="function"&&m.getElement();w&&(Ut(w,"focus",function(){this._tooltip._source=m,this.openTooltip()},this),Ut(w,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(m){var w=typeof m.getElement=="function"&&m.getElement();w&&w.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(m){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var w=this;this._map.once("moveend",function(){w._openOnceFlag=!1,w._openTooltip(m)});return}this._tooltip._source=m.layer||m.target,this.openTooltip(this._tooltip.options.sticky?m.latlng:void 0)}},_moveTooltip:function(m){var w=m.latlng,k,H;this._tooltip.options.sticky&&m.originalEvent&&(k=this._map.mouseEventToContainerPoint(m.originalEvent),H=this._map.containerPointToLayerPoint(k),w=this._map.layerPointToLatLng(H)),this._tooltip.setLatLng(w)}});var _x=Yh.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(m){var w=m&&m.tagName==="DIV"?m:document.createElement("div"),k=this.options;if(k.html instanceof Element?(Tr(w),w.appendChild(k.html)):w.innerHTML=k.html!==!1?k.html:"",k.bgPos){var H=Q(k.bgPos);w.style.backgroundPosition=-H.x+"px "+-H.y+"px"}return this._setIconStyles(w,"icon"),w},createShadow:function(){return null}});function Hv(m){return new _x(m)}Yh.Default=Zh;var Uu=Lo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:dt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(m){v(this,m)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(m){m._addZoomLimit(this)},onRemove:function(m){this._removeAllTiles(),Nn(this._container),m._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Oa(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(so(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(m){return this.options.opacity=m,this._updateOpacity(),this},setZIndex:function(m){return this.options.zIndex=m,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var m=this._clampZoom(this._map.getZoom());m!==this._tileZoom&&(this._tileZoom=m,this._updateLevels()),this._update()}return this},getEvents:function(){var m={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=c(this._onMoveEnd,this.options.updateInterval,this)),m.move=this._onMove),this._zoomAnimated&&(m.zoomanim=this._animateZoom),m},createTile:function(){return document.createElement("div")},getTileSize:function(){var m=this.options.tileSize;return m instanceof Z?m:new Z(m,m)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(m){for(var w=this.getPane().children,k=-m(-1/0,1/0),H=0,ee=w.length,oe;H<ee;H++)oe=w[H].style.zIndex,w[H]!==this._container&&oe&&(k=m(k,+oe));isFinite(k)&&(this.options.zIndex=k+m(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!dt.ielt9){wi(this._container,this.options.opacity);var m=+new Date,w=!1,k=!1;for(var H in this._tiles){var ee=this._tiles[H];if(!(!ee.current||!ee.loaded)){var oe=Math.min(1,(m-ee.loaded)/200);wi(ee.el,oe),oe<1?w=!0:(ee.active?k=!0:this._onOpaqueTile(ee),ee.active=!0)}}k&&!this._noPrune&&this._pruneTiles(),w&&(K(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:d,_initContainer:function(){this._container||(this._container=_n("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var m=this._tileZoom,w=this.options.maxZoom;if(m!==void 0){for(var k in this._levels)k=Number(k),this._levels[k].el.children.length||k===m?(this._levels[k].el.style.zIndex=w-Math.abs(m-k),this._onUpdateLevel(k)):(Nn(this._levels[k].el),this._removeTilesAtZoom(k),this._onRemoveLevel(k),delete this._levels[k]);var H=this._levels[m],ee=this._map;return H||(H=this._levels[m]={},H.el=_n("div","leaflet-tile-container leaflet-zoom-animated",this._container),H.el.style.zIndex=w,H.origin=ee.project(ee.unproject(ee.getPixelOrigin()),m).round(),H.zoom=m,this._setZoomTransform(H,ee.getCenter(),ee.getZoom()),d(H.el.offsetWidth),this._onCreateLevel(H)),this._level=H,H}},_onUpdateLevel:d,_onRemoveLevel:d,_onCreateLevel:d,_pruneTiles:function(){if(this._map){var m,w,k=this._map.getZoom();if(k>this.options.maxZoom||k<this.options.minZoom){this._removeAllTiles();return}for(m in this._tiles)w=this._tiles[m],w.retain=w.current;for(m in this._tiles)if(w=this._tiles[m],w.current&&!w.active){var H=w.coords;this._retainParent(H.x,H.y,H.z,H.z-5)||this._retainChildren(H.x,H.y,H.z,H.z+2)}for(m in this._tiles)this._tiles[m].retain||this._removeTile(m)}},_removeTilesAtZoom:function(m){for(var w in this._tiles)this._tiles[w].coords.z===m&&this._removeTile(w)},_removeAllTiles:function(){for(var m in this._tiles)this._removeTile(m)},_invalidateAll:function(){for(var m in this._levels)Nn(this._levels[m].el),this._onRemoveLevel(Number(m)),delete this._levels[m];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(m,w,k,H){var ee=Math.floor(m/2),oe=Math.floor(w/2),ge=k-1,ke=new Z(+ee,+oe);ke.z=+ge;var Be=this._tileCoordsToKey(ke),Je=this._tiles[Be];return Je&&Je.active?(Je.retain=!0,!0):(Je&&Je.loaded&&(Je.retain=!0),ge>H?this._retainParent(ee,oe,ge,H):!1)},_retainChildren:function(m,w,k,H){for(var ee=2*m;ee<2*m+2;ee++)for(var oe=2*w;oe<2*w+2;oe++){var ge=new Z(ee,oe);ge.z=k+1;var ke=this._tileCoordsToKey(ge),Be=this._tiles[ke];if(Be&&Be.active){Be.retain=!0;continue}else Be&&Be.loaded&&(Be.retain=!0);k+1<H&&this._retainChildren(ee,oe,k+1,H)}},_resetView:function(m){var w=m&&(m.pinch||m.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),w,w)},_animateZoom:function(m){this._setView(m.center,m.zoom,!0,m.noUpdate)},_clampZoom:function(m){var w=this.options;return w.minNativeZoom!==void 0&&m<w.minNativeZoom?w.minNativeZoom:w.maxNativeZoom!==void 0&&w.maxNativeZoom<m?w.maxNativeZoom:m},_setView:function(m,w,k,H){var ee=Math.round(w);this.options.maxZoom!==void 0&&ee>this.options.maxZoom||this.options.minZoom!==void 0&&ee<this.options.minZoom?ee=void 0:ee=this._clampZoom(ee);var oe=this.options.updateWhenZooming&&ee!==this._tileZoom;(!H||oe)&&(this._tileZoom=ee,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),ee!==void 0&&this._update(m),k||this._pruneTiles(),this._noPrune=!!k),this._setZoomTransforms(m,w)},_setZoomTransforms:function(m,w){for(var k in this._levels)this._setZoomTransform(this._levels[k],m,w)},_setZoomTransform:function(m,w,k){var H=this._map.getZoomScale(k,m.zoom),ee=m.origin.multiplyBy(H).subtract(this._map._getNewPixelOrigin(w,k)).round();dt.any3d?ha(m.el,ee,H):qr(m.el,ee)},_resetGrid:function(){var m=this._map,w=m.options.crs,k=this._tileSize=this.getTileSize(),H=this._tileZoom,ee=this._map.getPixelWorldBounds(this._tileZoom);ee&&(this._globalTileRange=this._pxBoundsToTileRange(ee)),this._wrapX=w.wrapLng&&!this.options.noWrap&&[Math.floor(m.project([0,w.wrapLng[0]],H).x/k.x),Math.ceil(m.project([0,w.wrapLng[1]],H).x/k.y)],this._wrapY=w.wrapLat&&!this.options.noWrap&&[Math.floor(m.project([w.wrapLat[0],0],H).y/k.x),Math.ceil(m.project([w.wrapLat[1],0],H).y/k.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(m){var w=this._map,k=w._animatingZoom?Math.max(w._animateToZoom,w.getZoom()):w.getZoom(),H=w.getZoomScale(k,this._tileZoom),ee=w.project(m,this._tileZoom).floor(),oe=w.getSize().divideBy(H*2);return new z(ee.subtract(oe),ee.add(oe))},_update:function(m){var w=this._map;if(w){var k=this._clampZoom(w.getZoom());if(m===void 0&&(m=w.getCenter()),this._tileZoom!==void 0){var H=this._getTiledPixelBounds(m),ee=this._pxBoundsToTileRange(H),oe=ee.getCenter(),ge=[],ke=this.options.keepBuffer,Be=new z(ee.getBottomLeft().subtract([ke,-ke]),ee.getTopRight().add([ke,-ke]));if(!(isFinite(ee.min.x)&&isFinite(ee.min.y)&&isFinite(ee.max.x)&&isFinite(ee.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Je in this._tiles){var ft=this._tiles[Je].coords;(ft.z!==this._tileZoom||!Be.contains(new Z(ft.x,ft.y)))&&(this._tiles[Je].current=!1)}if(Math.abs(k-this._tileZoom)>1){this._setView(m,k);return}for(var vt=ee.min.y;vt<=ee.max.y;vt++)for(var At=ee.min.x;At<=ee.max.x;At++){var Qt=new Z(At,vt);if(Qt.z=this._tileZoom,!!this._isValidTile(Qt)){var zr=this._tiles[this._tileCoordsToKey(Qt)];zr?zr.current=!0:ge.push(Qt)}}if(ge.sort(function(Ni,ao){return Ni.distanceTo(oe)-ao.distanceTo(oe)}),ge.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var cs=document.createDocumentFragment();for(At=0;At<ge.length;At++)this._addTile(ge[At],cs);this._level.el.appendChild(cs)}}}},_isValidTile:function(m){var w=this._map.options.crs;if(!w.infinite){var k=this._globalTileRange;if(!w.wrapLng&&(m.x<k.min.x||m.x>k.max.x)||!w.wrapLat&&(m.y<k.min.y||m.y>k.max.y))return!1}if(!this.options.bounds)return!0;var H=this._tileCoordsToBounds(m);return re(this.options.bounds).overlaps(H)},_keyToBounds:function(m){return this._tileCoordsToBounds(this._keyToTileCoords(m))},_tileCoordsToNwSe:function(m){var w=this._map,k=this.getTileSize(),H=m.scaleBy(k),ee=H.add(k),oe=w.unproject(H,m.z),ge=w.unproject(ee,m.z);return[oe,ge]},_tileCoordsToBounds:function(m){var w=this._tileCoordsToNwSe(m),k=new X(w[0],w[1]);return this.options.noWrap||(k=this._map.wrapLatLngBounds(k)),k},_tileCoordsToKey:function(m){return m.x+":"+m.y+":"+m.z},_keyToTileCoords:function(m){var w=m.split(":"),k=new Z(+w[0],+w[1]);return k.z=+w[2],k},_removeTile:function(m){var w=this._tiles[m];w&&(Nn(w.el),delete this._tiles[m],this.fire("tileunload",{tile:w.el,coords:this._keyToTileCoords(m)}))},_initTile:function(m){yt(m,"leaflet-tile");var w=this.getTileSize();m.style.width=w.x+"px",m.style.height=w.y+"px",m.onselectstart=d,m.onmousemove=d,dt.ielt9&&this.options.opacity<1&&wi(m,this.options.opacity)},_addTile:function(m,w){var k=this._getTilePos(m),H=this._tileCoordsToKey(m),ee=this.createTile(this._wrapCoords(m),a(this._tileReady,this,m));this._initTile(ee),this.createTile.length<2&&O(a(this._tileReady,this,m,null,ee)),qr(ee,k),this._tiles[H]={el:ee,coords:m,current:!0},w.appendChild(ee),this.fire("tileloadstart",{tile:ee,coords:m})},_tileReady:function(m,w,k){w&&this.fire("tileerror",{error:w,tile:k,coords:m});var H=this._tileCoordsToKey(m);k=this._tiles[H],k&&(k.loaded=+new Date,this._map._fadeAnimated?(wi(k.el,0),K(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(k.active=!0,this._pruneTiles()),w||(yt(k.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:k.el,coords:m})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),dt.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(m){return m.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(m){var w=new Z(this._wrapX?u(m.x,this._wrapX):m.x,this._wrapY?u(m.y,this._wrapY):m.y);return w.z=m.z,w},_pxBoundsToTileRange:function(m){var w=this.getTileSize();return new z(m.min.unscaleBy(w).floor(),m.max.unscaleBy(w).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var m in this._tiles)if(!this._tiles[m].loaded)return!1;return!0}});function Mo(m){return new Uu(m)}var Gu=Uu.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(m,w){this._url=m,w=v(this,w),w.detectRetina&&dt.retina&&w.maxZoom>0?(w.tileSize=Math.floor(w.tileSize/2),w.zoomReverse?(w.zoomOffset--,w.minZoom=Math.min(w.maxZoom,w.minZoom+1)):(w.zoomOffset++,w.maxZoom=Math.max(w.minZoom,w.maxZoom-1)),w.minZoom=Math.max(0,w.minZoom)):w.zoomReverse?w.minZoom=Math.min(w.maxZoom,w.minZoom):w.maxZoom=Math.max(w.minZoom,w.maxZoom),typeof w.subdomains=="string"&&(w.subdomains=w.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(m,w){return this._url===m&&w===void 0&&(w=!0),this._url=m,w||this.redraw(),this},createTile:function(m,w){var k=document.createElement("img");return Ut(k,"load",a(this._tileOnLoad,this,w,k)),Ut(k,"error",a(this._tileOnError,this,w,k)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(k.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(k.referrerPolicy=this.options.referrerPolicy),k.alt="",k.src=this.getTileUrl(m),k},getTileUrl:function(m){var w={r:dt.retina?"@2x":"",s:this._getSubdomain(m),x:m.x,y:m.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var k=this._globalTileRange.max.y-m.y;this.options.tms&&(w.y=k),w["-y"]=k}return T(this._url,s(w,this.options))},_tileOnLoad:function(m,w){dt.ielt9?setTimeout(a(m,this,null,w),0):m(null,w)},_tileOnError:function(m,w,k){var H=this.options.errorTileUrl;H&&w.getAttribute("src")!==H&&(w.src=H),m(k,w)},_onTileRemove:function(m){m.tile.onload=null},_getZoomForUrl:function(){var m=this._tileZoom,w=this.options.maxZoom,k=this.options.zoomReverse,H=this.options.zoomOffset;return k&&(m=w-m),m+H},_getSubdomain:function(m){var w=Math.abs(m.x+m.y)%this.options.subdomains.length;return this.options.subdomains[w]},_abortLoading:function(){var m,w;for(m in this._tiles)if(this._tiles[m].coords.z!==this._tileZoom&&(w=this._tiles[m].el,w.onload=d,w.onerror=d,!w.complete)){w.src=$;var k=this._tiles[m].coords;Nn(w),delete this._tiles[m],this.fire("tileabort",{tile:w,coords:k})}},_removeTile:function(m){var w=this._tiles[m];if(w)return w.el.setAttribute("src",$),Uu.prototype._removeTile.call(this,m)},_tileReady:function(m,w,k){if(!(!this._map||k&&k.getAttribute("src")===$))return Uu.prototype._tileReady.call(this,m,w,k)}});function Ha(m,w){return new Gu(m,w)}var Wa=Gu.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(m,w){this._url=m;var k=s({},this.defaultWmsParams);for(var H in w)H in this.options||(k[H]=w[H]);w=v(this,w);var ee=w.detectRetina&&dt.retina?2:1,oe=this.getTileSize();k.width=oe.x*ee,k.height=oe.y*ee,this.wmsParams=k},onAdd:function(m){this._crs=this.options.crs||m.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var w=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[w]=this._crs.code,Gu.prototype.onAdd.call(this,m)},getTileUrl:function(m){var w=this._tileCoordsToNwSe(m),k=this._crs,H=D(k.project(w[0]),k.project(w[1])),ee=H.min,oe=H.max,ge=(this._wmsVersion>=1.3&&this._crs===Xh?[ee.y,ee.x,oe.y,oe.x]:[ee.x,ee.y,oe.x,oe.y]).join(","),ke=Gu.prototype.getTileUrl.call(this,m);return ke+b(this.wmsParams,ke,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ge},setParams:function(m,w){return s(this.wmsParams,m),w||this.redraw(),this}});function nd(m,w){return new Wa(m,w)}Gu.WMS=Wa,Ha.wms=nd;var Fo=Lo.extend({options:{padding:.1},initialize:function(m){v(this,m),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),yt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var m={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(m.zoomanim=this._onAnimZoom),m},_onAnimZoom:function(m){this._updateTransform(m.center,m.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(m,w){var k=this._map.getZoomScale(w,this._zoom),H=this._map.getSize().multiplyBy(.5+this.options.padding),ee=this._map.project(this._center,w),oe=H.multiplyBy(-k).add(ee).subtract(this._map._getNewPixelOrigin(m,w));dt.any3d?ha(this._container,oe,k):qr(this._container,oe)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var m in this._layers)this._layers[m]._reset()},_onZoomEnd:function(){for(var m in this._layers)this._layers[m]._project()},_updatePaths:function(){for(var m in this._layers)this._layers[m]._update()},_update:function(){var m=this.options.padding,w=this._map.getSize(),k=this._map.containerPointToLayerPoint(w.multiplyBy(-m)).round();this._bounds=new z(k,k.add(w.multiplyBy(1+m*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),np=Fo.extend({options:{tolerance:0},getEvents:function(){var m=Fo.prototype.getEvents.call(this);return m.viewprereset=this._onViewPreReset,m},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Fo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var m=this._container=document.createElement("canvas");Ut(m,"mousemove",this._onMouseMove,this),Ut(m,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ut(m,"mouseout",this._handleMouseOut,this),m._leaflet_disable_events=!0,this._ctx=m.getContext("2d")},_destroyContainer:function(){K(this._redrawRequest),delete this._ctx,Nn(this._container),Yn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var m;this._redrawBounds=null;for(var w in this._layers)m=this._layers[w],m._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Fo.prototype._update.call(this);var m=this._bounds,w=this._container,k=m.getSize(),H=dt.retina?2:1;qr(w,m.min),w.width=H*k.x,w.height=H*k.y,w.style.width=k.x+"px",w.style.height=k.y+"px",dt.retina&&this._ctx.scale(2,2),this._ctx.translate(-m.min.x,-m.min.y),this.fire("update")}},_reset:function(){Fo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(m){this._updateDashArray(m),this._layers[l(m)]=m;var w=m._order={layer:m,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=w),this._drawLast=w,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(m){this._requestRedraw(m)},_removePath:function(m){var w=m._order,k=w.next,H=w.prev;k?k.prev=H:this._drawLast=H,H?H.next=k:this._drawFirst=k,delete m._order,delete this._layers[l(m)],this._requestRedraw(m)},_updatePath:function(m){this._extendRedrawBounds(m),m._project(),m._update(),this._requestRedraw(m)},_updateStyle:function(m){this._updateDashArray(m),this._requestRedraw(m)},_updateDashArray:function(m){if(typeof m.options.dashArray=="string"){var w=m.options.dashArray.split(/[, ]+/),k=[],H,ee;for(ee=0;ee<w.length;ee++){if(H=Number(w[ee]),isNaN(H))return;k.push(H)}m.options._dashArray=k}else m.options._dashArray=m.options.dashArray},_requestRedraw:function(m){this._map&&(this._extendRedrawBounds(m),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(m){if(m._pxBounds){var w=(m.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new z,this._redrawBounds.extend(m._pxBounds.min.subtract([w,w])),this._redrawBounds.extend(m._pxBounds.max.add([w,w]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var m=this._redrawBounds;if(m){var w=m.getSize();this._ctx.clearRect(m.min.x,m.min.y,w.x,w.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var m,w=this._redrawBounds;if(this._ctx.save(),w){var k=w.getSize();this._ctx.beginPath(),this._ctx.rect(w.min.x,w.min.y,k.x,k.y),this._ctx.clip()}this._drawing=!0;for(var H=this._drawFirst;H;H=H.next)m=H.layer,(!w||m._pxBounds&&m._pxBounds.intersects(w))&&m._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(m,w){if(this._drawing){var k,H,ee,oe,ge=m._parts,ke=ge.length,Be=this._ctx;if(ke){for(Be.beginPath(),k=0;k<ke;k++){for(H=0,ee=ge[k].length;H<ee;H++)oe=ge[k][H],Be[H?"lineTo":"moveTo"](oe.x,oe.y);w&&Be.closePath()}this._fillStroke(Be,m)}}},_updateCircle:function(m){if(!(!this._drawing||m._empty())){var w=m._point,k=this._ctx,H=Math.max(Math.round(m._radius),1),ee=(Math.max(Math.round(m._radiusY),1)||H)/H;ee!==1&&(k.save(),k.scale(1,ee)),k.beginPath(),k.arc(w.x,w.y/ee,H,0,Math.PI*2,!1),ee!==1&&k.restore(),this._fillStroke(k,m)}},_fillStroke:function(m,w){var k=w.options;k.fill&&(m.globalAlpha=k.fillOpacity,m.fillStyle=k.fillColor||k.color,m.fill(k.fillRule||"evenodd")),k.stroke&&k.weight!==0&&(m.setLineDash&&m.setLineDash(w.options&&w.options._dashArray||[]),m.globalAlpha=k.opacity,m.lineWidth=k.weight,m.strokeStyle=k.color,m.lineCap=k.lineCap,m.lineJoin=k.lineJoin,m.stroke())},_onClick:function(m){for(var w=this._map.mouseEventToLayerPoint(m),k,H,ee=this._drawFirst;ee;ee=ee.next)k=ee.layer,k.options.interactive&&k._containsPoint(w)&&(!(m.type==="click"||m.type==="preclick")||!this._map._draggableMoved(k))&&(H=k);this._fireEvent(H?[H]:!1,m)},_onMouseMove:function(m){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var w=this._map.mouseEventToLayerPoint(m);this._handleMouseHover(m,w)}},_handleMouseOut:function(m){var w=this._hoveredLayer;w&&(xr(this._container,"leaflet-interactive"),this._fireEvent([w],m,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(m,w){if(!this._mouseHoverThrottled){for(var k,H,ee=this._drawFirst;ee;ee=ee.next)k=ee.layer,k.options.interactive&&k._containsPoint(w)&&(H=k);H!==this._hoveredLayer&&(this._handleMouseOut(m),H&&(yt(this._container,"leaflet-interactive"),this._fireEvent([H],m,"mouseover"),this._hoveredLayer=H)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,m),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(m,w,k){this._map._fireDOMEvent(w,k||w.type,m)},_bringToFront:function(m){var w=m._order;if(w){var k=w.next,H=w.prev;if(k)k.prev=H;else return;H?H.next=k:k&&(this._drawFirst=k),w.prev=this._drawLast,this._drawLast.next=w,w.next=null,this._drawLast=w,this._requestRedraw(m)}},_bringToBack:function(m){var w=m._order;if(w){var k=w.next,H=w.prev;if(H)H.next=k;else return;k?k.prev=H:H&&(this._drawLast=H),w.prev=null,w.next=this._drawFirst,this._drawFirst.prev=w,this._drawFirst=w,this._requestRedraw(m)}}});function rp(m){return dt.canvas?new np(m):null}var Hu=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(m){return document.createElement("<lvml:"+m+' class="lvml">')}}catch{}return function(m){return document.createElement("<"+m+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),rd={_initContainer:function(){this._container=_n("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Fo.prototype._update.call(this),this.fire("update"))},_initPath:function(m){var w=m._container=Hu("shape");yt(w,"leaflet-vml-shape "+(this.options.className||"")),w.coordsize="1 1",m._path=Hu("path"),w.appendChild(m._path),this._updateStyle(m),this._layers[l(m)]=m},_addPath:function(m){var w=m._container;this._container.appendChild(w),m.options.interactive&&m.addInteractiveTarget(w)},_removePath:function(m){var w=m._container;Nn(w),m.removeInteractiveTarget(w),delete this._layers[l(m)]},_updateStyle:function(m){var w=m._stroke,k=m._fill,H=m.options,ee=m._container;ee.stroked=!!H.stroke,ee.filled=!!H.fill,H.stroke?(w||(w=m._stroke=Hu("stroke")),ee.appendChild(w),w.weight=H.weight+"px",w.color=H.color,w.opacity=H.opacity,H.dashArray?w.dashStyle=C(H.dashArray)?H.dashArray.join(" "):H.dashArray.replace(/( *, *)/g," "):w.dashStyle="",w.endcap=H.lineCap.replace("butt","flat"),w.joinstyle=H.lineJoin):w&&(ee.removeChild(w),m._stroke=null),H.fill?(k||(k=m._fill=Hu("fill")),ee.appendChild(k),k.color=H.fillColor||H.color,k.opacity=H.fillOpacity):k&&(ee.removeChild(k),m._fill=null)},_updateCircle:function(m){var w=m._point.round(),k=Math.round(m._radius),H=Math.round(m._radiusY||k);this._setPath(m,m._empty()?"M0 0":"AL "+w.x+","+w.y+" "+k+","+H+" 0,"+65535*360)},_setPath:function(m,w){m._path.v=w},_bringToFront:function(m){Oa(m._container)},_bringToBack:function(m){so(m._container)}},sp=dt.vml?Hu:nt,Rc=Fo.extend({_initContainer:function(){this._container=sp("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=sp("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Nn(this._container),Yn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Fo.prototype._update.call(this);var m=this._bounds,w=m.getSize(),k=this._container;(!this._svgSize||!this._svgSize.equals(w))&&(this._svgSize=w,k.setAttribute("width",w.x),k.setAttribute("height",w.y)),qr(k,m.min),k.setAttribute("viewBox",[m.min.x,m.min.y,w.x,w.y].join(" ")),this.fire("update")}},_initPath:function(m){var w=m._path=sp("path");m.options.className&&yt(w,m.options.className),m.options.interactive&&yt(w,"leaflet-interactive"),this._updateStyle(m),this._layers[l(m)]=m},_addPath:function(m){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(m._path),m.addInteractiveTarget(m._path)},_removePath:function(m){Nn(m._path),m.removeInteractiveTarget(m._path),delete this._layers[l(m)]},_updatePath:function(m){m._project(),m._update()},_updateStyle:function(m){var w=m._path,k=m.options;w&&(k.stroke?(w.setAttribute("stroke",k.color),w.setAttribute("stroke-opacity",k.opacity),w.setAttribute("stroke-width",k.weight),w.setAttribute("stroke-linecap",k.lineCap),w.setAttribute("stroke-linejoin",k.lineJoin),k.dashArray?w.setAttribute("stroke-dasharray",k.dashArray):w.removeAttribute("stroke-dasharray"),k.dashOffset?w.setAttribute("stroke-dashoffset",k.dashOffset):w.removeAttribute("stroke-dashoffset")):w.setAttribute("stroke","none"),k.fill?(w.setAttribute("fill",k.fillColor||k.color),w.setAttribute("fill-opacity",k.fillOpacity),w.setAttribute("fill-rule",k.fillRule||"evenodd")):w.setAttribute("fill","none"))},_updatePoly:function(m,w){this._setPath(m,Nt(m._parts,w))},_updateCircle:function(m){var w=m._point,k=Math.max(Math.round(m._radius),1),H=Math.max(Math.round(m._radiusY),1)||k,ee="a"+k+","+H+" 0 1,0 ",oe=m._empty()?"M0 0":"M"+(w.x-k)+","+w.y+ee+k*2+",0 "+ee+-k*2+",0 ";this._setPath(m,oe)},_setPath:function(m,w){m._path.setAttribute("d",w)},_bringToFront:function(m){Oa(m._path)},_bringToBack:function(m){so(m._path)}});dt.vml&&Rc.include(rd);function Wu(m){return dt.svg||dt.vml?new Rc(m):null}dn.include({getRenderer:function(m){var w=m.options.renderer||this._getPaneRenderer(m.options.pane)||this.options.renderer||this._renderer;return w||(w=this._renderer=this._createRenderer()),this.hasLayer(w)||this.addLayer(w),w},_getPaneRenderer:function(m){if(m==="overlayPane"||m===void 0)return!1;var w=this._paneRenderers[m];return w===void 0&&(w=this._createRenderer({pane:m}),this._paneRenderers[m]=w),w},_createRenderer:function(m){return this.options.preferCanvas&&rp(m)||Wu(m)}});var Wv=Jh.extend({initialize:function(m,w){Jh.prototype.initialize.call(this,this._boundsToLatLngs(m),w)},setBounds:function(m){return this.setLatLngs(this._boundsToLatLngs(m))},_boundsToLatLngs:function(m){return m=re(m),[m.getSouthWest(),m.getNorthWest(),m.getNorthEast(),m.getSouthEast()]}});function qa(m,w){return new Wv(m,w)}Rc.create=sp,Rc.pointsToPath=Nt,Ga.geometryToLayer=Qf,Ga.coordsToLatLng=Xm,Ga.coordsToLatLngs=Jf,Ga.latLngToCoords=ep,Ga.latLngsToCoords=Ym,Ga.getFeature=Po,Ga.asFeature=ed,dn.mergeOptions({boxZoom:!0});var e0=fa.extend({initialize:function(m){this._map=m,this._container=m._container,this._pane=m._panes.overlayPane,this._resetStateTimeout=0,m.on("unload",this._destroy,this)},addHooks:function(){Ut(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Yn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Nn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(m){if(!m.shiftKey||m.which!==1&&m.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ei(),Sc(),this._startPoint=this._map.mouseEventToContainerPoint(m),Ut(document,{contextmenu:Ba,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(m){this._moved||(this._moved=!0,this._box=_n("div","leaflet-zoom-box",this._container),yt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(m);var w=new z(this._point,this._startPoint),k=w.getSize();qr(this._box,w.min),this._box.style.width=k.x+"px",this._box.style.height=k.y+"px"},_finish:function(){this._moved&&(Nn(this._box),xr(this._container,"leaflet-crosshair")),Ma(),jh(),Yn(document,{contextmenu:Ba,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(m){if(!(m.which!==1&&m.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var w=new X(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(w).fire("boxzoomend",{boxZoomBounds:w})}},_onKeyDown:function(m){m.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});dn.addInitHook("addHandler","boxZoom",e0),dn.mergeOptions({doubleClickZoom:!0});var dl=fa.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(m){var w=this._map,k=w.getZoom(),H=w.options.zoomDelta,ee=m.originalEvent.shiftKey?k-H:k+H;w.options.doubleClickZoom==="center"?w.setZoom(ee):w.setZoomAround(m.containerPoint,ee)}});dn.addInitHook("addHandler","doubleClickZoom",dl),dn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var wx=fa.extend({addHooks:function(){if(!this._draggable){var m=this._map;this._draggable=new Ro(m._mapPane,m._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),m.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),m.on("zoomend",this._onZoomEnd,this),m.whenReady(this._onZoomEnd,this))}yt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){xr(this._map._container,"leaflet-grab"),xr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var m=this._map;if(m._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var w=re(this._map.options.maxBounds);this._offsetLimit=D(this._map.latLngToContainerPoint(w.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(w.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;m.fire("movestart").fire("dragstart"),m.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(m){if(this._map.options.inertia){var w=this._lastTime=+new Date,k=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(k),this._times.push(w),this._prunePositions(w)}this._map.fire("move",m).fire("drag",m)},_prunePositions:function(m){for(;this._positions.length>1&&m-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var m=this._map.getSize().divideBy(2),w=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=w.subtract(m).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(m,w){return m-(m-w)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var m=this._draggable._newPos.subtract(this._draggable._startPos),w=this._offsetLimit;m.x<w.min.x&&(m.x=this._viscousLimit(m.x,w.min.x)),m.y<w.min.y&&(m.y=this._viscousLimit(m.y,w.min.y)),m.x>w.max.x&&(m.x=this._viscousLimit(m.x,w.max.x)),m.y>w.max.y&&(m.y=this._viscousLimit(m.y,w.max.y)),this._draggable._newPos=this._draggable._startPos.add(m)}},_onPreDragWrap:function(){var m=this._worldWidth,w=Math.round(m/2),k=this._initialWorldOffset,H=this._draggable._newPos.x,ee=(H-w+k)%m+w-k,oe=(H+w+k)%m-w-k,ge=Math.abs(ee+k)<Math.abs(oe+k)?ee:oe;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ge},_onDragEnd:function(m){var w=this._map,k=w.options,H=!k.inertia||m.noInertia||this._times.length<2;if(w.fire("dragend",m),H)w.fire("moveend");else{this._prunePositions(+new Date);var ee=this._lastPos.subtract(this._positions[0]),oe=(this._lastTime-this._times[0])/1e3,ge=k.easeLinearity,ke=ee.multiplyBy(ge/oe),Be=ke.distanceTo([0,0]),Je=Math.min(k.inertiaMaxSpeed,Be),ft=ke.multiplyBy(Je/Be),vt=Je/(k.inertiaDeceleration*ge),At=ft.multiplyBy(-vt/2).round();!At.x&&!At.y?w.fire("moveend"):(At=w._limitOffset(At,w.options.maxBounds),O(function(){w.panBy(At,{duration:vt,easeLinearity:ge,noMoveStart:!0,animate:!0})}))}}});dn.addInitHook("addHandler","dragging",wx),dn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ip=fa.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(m){this._map=m,this._setPanDelta(m.options.keyboardPanDelta),this._setZoomDelta(m.options.zoomDelta)},addHooks:function(){var m=this._map._container;m.tabIndex<=0&&(m.tabIndex="0"),Ut(m,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Yn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var m=document.body,w=document.documentElement,k=m.scrollTop||w.scrollTop,H=m.scrollLeft||w.scrollLeft;this._map._container.focus(),window.scrollTo(H,k)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(m){var w=this._panKeys={},k=this.keyCodes,H,ee;for(H=0,ee=k.left.length;H<ee;H++)w[k.left[H]]=[-1*m,0];for(H=0,ee=k.right.length;H<ee;H++)w[k.right[H]]=[m,0];for(H=0,ee=k.down.length;H<ee;H++)w[k.down[H]]=[0,m];for(H=0,ee=k.up.length;H<ee;H++)w[k.up[H]]=[0,-1*m]},_setZoomDelta:function(m){var w=this._zoomKeys={},k=this.keyCodes,H,ee;for(H=0,ee=k.zoomIn.length;H<ee;H++)w[k.zoomIn[H]]=m;for(H=0,ee=k.zoomOut.length;H<ee;H++)w[k.zoomOut[H]]=-m},_addHooks:function(){Ut(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Yn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(m){if(!(m.altKey||m.ctrlKey||m.metaKey)){var w=m.keyCode,k=this._map,H;if(w in this._panKeys){if(!k._panAnim||!k._panAnim._inProgress)if(H=this._panKeys[w],m.shiftKey&&(H=Q(H).multiplyBy(3)),k.options.maxBounds&&(H=k._limitOffset(Q(H),k.options.maxBounds)),k.options.worldCopyJump){var ee=k.wrapLatLng(k.unproject(k.project(k.getCenter()).add(H)));k.panTo(ee)}else k.panBy(H)}else if(w in this._zoomKeys)k.setZoom(k.getZoom()+(m.shiftKey?3:1)*this._zoomKeys[w]);else if(w===27&&k._popup&&k._popup.options.closeOnEscapeKey)k.closePopup();else return;Ba(m)}}});dn.addInitHook("addHandler","keyboard",ip),dn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Dc=fa.extend({addHooks:function(){Ut(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Yn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(m){var w=Nc(m),k=this._map.options.wheelDebounceTime;this._delta+=w,this._lastMousePos=this._map.mouseEventToContainerPoint(m),this._startTime||(this._startTime=+new Date);var H=Math.max(k-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),H),Ba(m)},_performZoom:function(){var m=this._map,w=m.getZoom(),k=this._map.options.zoomSnap||0;m._stop();var H=this._delta/(this._map.options.wheelPxPerZoomLevel*4),ee=4*Math.log(2/(1+Math.exp(-Math.abs(H))))/Math.LN2,oe=k?Math.ceil(ee/k)*k:ee,ge=m._limitZoom(w+(this._delta>0?oe:-oe))-w;this._delta=0,this._startTime=null,ge&&(m.options.scrollWheelZoom==="center"?m.setZoom(w+ge):m.setZoomAround(this._lastMousePos,w+ge))}});dn.addInitHook("addHandler","scrollWheelZoom",Dc);var Ex=600;dn.mergeOptions({tapHold:dt.touchNative&&dt.safari&&dt.mobile,tapTolerance:15});var t0=fa.extend({addHooks:function(){Ut(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Yn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(m){if(clearTimeout(this._holdTimeout),m.touches.length===1){var w=m.touches[0];this._startPos=this._newPos=new Z(w.clientX,w.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(Ut(document,"touchend",Kr),Ut(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",w))},this),Ex),Ut(document,"touchend touchcancel contextmenu",this._cancel,this),Ut(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function m(){Yn(document,"touchend",Kr),Yn(document,"touchend touchcancel",m)},_cancel:function(){clearTimeout(this._holdTimeout),Yn(document,"touchend touchcancel contextmenu",this._cancel,this),Yn(document,"touchmove",this._onMove,this)},_onMove:function(m){var w=m.touches[0];this._newPos=new Z(w.clientX,w.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(m,w){var k=new MouseEvent(m,{bubbles:!0,cancelable:!0,view:window,screenX:w.screenX,screenY:w.screenY,clientX:w.clientX,clientY:w.clientY});k._simulated=!0,w.target.dispatchEvent(k)}});dn.addInitHook("addHandler","tapHold",t0),dn.mergeOptions({touchZoom:dt.touch,bounceAtZoomLimits:!0});var qu=fa.extend({addHooks:function(){yt(this._map._container,"leaflet-touch-zoom"),Ut(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){xr(this._map._container,"leaflet-touch-zoom"),Yn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(m){var w=this._map;if(!(!m.touches||m.touches.length!==2||w._animatingZoom||this._zooming)){var k=w.mouseEventToContainerPoint(m.touches[0]),H=w.mouseEventToContainerPoint(m.touches[1]);this._centerPoint=w.getSize()._divideBy(2),this._startLatLng=w.containerPointToLatLng(this._centerPoint),w.options.touchZoom!=="center"&&(this._pinchStartLatLng=w.containerPointToLatLng(k.add(H)._divideBy(2))),this._startDist=k.distanceTo(H),this._startZoom=w.getZoom(),this._moved=!1,this._zooming=!0,w._stop(),Ut(document,"touchmove",this._onTouchMove,this),Ut(document,"touchend touchcancel",this._onTouchEnd,this),Kr(m)}},_onTouchMove:function(m){if(!(!m.touches||m.touches.length!==2||!this._zooming)){var w=this._map,k=w.mouseEventToContainerPoint(m.touches[0]),H=w.mouseEventToContainerPoint(m.touches[1]),ee=k.distanceTo(H)/this._startDist;if(this._zoom=w.getScaleZoom(ee,this._startZoom),!w.options.bounceAtZoomLimits&&(this._zoom<w.getMinZoom()&&ee<1||this._zoom>w.getMaxZoom()&&ee>1)&&(this._zoom=w._limitZoom(this._zoom)),w.options.touchZoom==="center"){if(this._center=this._startLatLng,ee===1)return}else{var oe=k._add(H)._divideBy(2)._subtract(this._centerPoint);if(ee===1&&oe.x===0&&oe.y===0)return;this._center=w.unproject(w.project(this._pinchStartLatLng,this._zoom).subtract(oe),this._zoom)}this._moved||(w._moveStart(!0,!1),this._moved=!0),K(this._animRequest);var ge=a(w._move,w,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(ge,this,!0),Kr(m)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,K(this._animRequest),Yn(document,"touchmove",this._onTouchMove,this),Yn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});dn.addInitHook("addHandler","touchZoom",qu),dn.BoxZoom=e0,dn.DoubleClickZoom=dl,dn.Drag=wx,dn.Keyboard=ip,dn.ScrollWheelZoom=Dc,dn.TapHold=t0,dn.TouchZoom=qu,t.Bounds=z,t.Browser=dt,t.CRS=pe,t.Canvas=np,t.Circle=bx,t.CircleMarker=Zf,t.Class=N,t.Control=ai,t.DivIcon=_x,t.DivOverlay=Oo,t.DomEvent=Fu,t.DomUtil=Um,t.Draggable=Ro,t.Evented=Y,t.FeatureGroup=Va,t.GeoJSON=Ga,t.GridLayer=Uu,t.Handler=fa,t.Icon=Yh,t.ImageOverlay=hl,t.LatLng=W,t.LatLngBounds=X,t.Layer=Lo,t.LayerGroup=ju,t.LineUtil=za,t.Map=dn,t.Marker=Qh,t.Mixin=Wm,t.Path=Hl,t.Point=Z,t.PolyUtil=qh,t.Polygon=Jh,t.Polyline=Wl,t.Popup=tp,t.PosAnimation=Bu,t.Projection=Do,t.Rectangle=Wv,t.Renderer=Fo,t.SVG=Rc,t.SVGOverlay=Ic,t.TileLayer=Gu,t.Tooltip=Jm,t.Transformation=ze,t.Util=P,t.VideoOverlay=Qm,t.bind=a,t.bounds=D,t.canvas=rp,t.circle=FC,t.circleMarker=jv,t.control=Io,t.divIcon=Hv,t.extend=s,t.featureGroup=Yf,t.geoJSON=Zm,t.geoJson=Vv,t.gridLayer=Mo,t.icon=Km,t.imageOverlay=td,t.latLng=ae,t.latLngBounds=re,t.layerGroup=zv,t.map=cl,t.marker=yx,t.point=Q,t.polygon=Ua,t.polyline=BC,t.popup=zC,t.rectangle=qa,t.setOptions=v,t.stamp=l,t.svg=Wu,t.svgOverlay=Gv,t.tileLayer=Ha,t.tooltip=jC,t.transformation=Ge,t.version=r,t.videoOverlay=Uv;var sd=window.L;t.noConflict=function(){return window.L=sd,this},window.L=t}))})(Sy,Sy.exports)),Sy.exports}var Zfe=Yfe();const Bc=ku(Zfe);(function(n,e,t){function r(s,i){for(;(s=s.parentElement)&&!s.classList.contains(i););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,i){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),i=this._poly,a=i.getLatLngs(),o=a.splice(-1,1)[0];this._poly.setLatLngs(a),this._markerGroup.removeLayer(s),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(o,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent),a=this._map.layerPointToLatLng(i);this._currentLatLng=a,this._updateTooltip(a),this._updateGuide(i),this._mouseMarker.setLatLng(a),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var i=s.originalEvent,a=i.clientX,o=i.clientY;this._startPoint.call(this,a,o)}},_startPoint:function(s,i){this._mouseDownOrigin=L.point(s,i)},_onMouseUp:function(s){var i=s.originalEvent,a=i.clientX,o=i.clientY;this._endPoint.call(this,a,o,s),this._clickHandled=null},_endPoint:function(s,i,a){if(this._mouseDownOrigin){var o=L.point(s,i).distanceTo(this._mouseDownOrigin),l=this._calculateFinishDistance(a.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(a.latlng),this._finishShape()):l<10&&L.Browser.touch?this._finishShape():Math.abs(o)<9*(n.devicePixelRatio||1)&&this.addVertex(a.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var i,a,o=s.originalEvent;!o.touches||!o.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=o.touches[0].clientX,a=o.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,a),this._endPoint.call(this,i,a,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var i;if(this._markers.length>0){var a;if(this.type===L.Draw.Polyline.TYPE)a=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;a=this._markers[0]}var o=this._map.latLngToContainerPoint(a.getLatLng()),l=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),c=this._map.latLngToContainerPoint(l.getLatLng());i=o.distanceTo(c)}else i=1/0;return i},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var i=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(s){var i=this._markers?this._markers.length:0;i>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),s))},_updateTooltip:function(s){var i=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(s,i){var a,o,l,c=Math.floor(Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2))),u=this.options.guidelineDistance,d=this.options.maxGuideLineLength,p=c>d?c-d:u;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));p<c;p+=this.options.guidelineDistance)a=p/c,o={x:Math.floor(s.x*(1-a)+a*i.x),y:Math.floor(s.y*(1-a)+a*i.y)},l=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),l.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(l,o)},_updateGuideColor:function(s){if(this._guidesContainer)for(var i=0,a=this._guidesContainer.childNodes.length;i<a;i++)this._guidesContainer.childNodes[i].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,i,a=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=a?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),s},_updateRunningMeasure:function(s,i){var a,o,l=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(a=l-(i?2:1),o=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[a].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[a].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=o*(i?1:-1))},_getMeasurementString:function(){var s,i=this._currentLatLng,a=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?a&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(a)*(this.options.factor||1):this._measurementRunningTotal||0:a&&i?this._measurementRunningTotal+this._map.distance(i,a)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,i){L.Draw.Polyline.prototype.initialize.call(this,s,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,i;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:s,subtext:i}},_getMeasurementString:function(){var s=this._area,i="";return s||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(i+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,i){var a;!this.options.allowIntersection&&this.options.showArea&&(a=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(a)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,i)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),e.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),e.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!r(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,i,a,o=L.Draw.SimpleShape.prototype._getTooltipText.call(this),l=this._shape,c=this.options.showArea;return l&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(s),a=c?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:o.text,subtext:a}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(s);else var i=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var i,a=s.latlng,o=this.options.showRadius,l=this.options.metric;if(this._tooltip.updatePosition(a),this._isDrawing){this._drawShape(a),i=this._shape.getRadius().toFixed(1);var c="";o&&(c=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,l,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:c})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,i){this._marker=s,L.setOptions(this,i)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,i){var a=parseInt(s.style.marginTop,10)-i,o=parseInt(s.style.marginLeft,10)-i;s.style.marginTop=a+"px",s.style.marginLeft=o+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var i=0;i<this._verticesHandlers.length;i++)s(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,i,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this._latlngs=i,L.setOptions(this,a)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,i=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),i&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(a){L.DomUtil.removeClass(i,a)}),s.options.editing.className.split(" ").forEach(function(a){L.DomUtil.addClass(i,a)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,i=s._path;i&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(a){L.DomUtil.removeClass(i,a)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(a){L.DomUtil.addClass(i,a)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,i,a,o,l=this._defaultShape();for(s=0,a=l.length;s<a;s++)o=this._createMarker(l[s],s),o.on("click",this._onMarkerClick,this),o.on("contextmenu",this._onContextMenu,this),this._markers.push(o);var c,u;for(s=0,i=a-1;s<a;i=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(c=this._markers[i],u=this._markers[s],this._createMiddleMarker(c,u),this._updatePrevNext(c,u))},_createMarker:function(s,i){var a=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return a._origLatLng=s,a._index=i,a.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(a),a},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),i=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),i},_removeMarker:function(s){var i=s._index;this._markerGroup.removeLayer(s),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var i=s.target,a=this._poly,o=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),a.options.poly){var l=a._map._editTooltip;if(!a.options.poly.allowIntersection&&a.intersects()){L.extend(i._origLatLng,o),i.setLatLng(o);var c=a.options.color;a.setStyle({color:this.options.drawError.color}),l&&l.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){a.setStyle({color:c}),l&&l.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var u=this._poly.getLatLngs();this._poly._convertLatLngs(u,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,a=s.target;this._defaultShape().length<i||(this._removeMarker(a),this._updatePrevNext(a._prev,a._next),a._middleLeft&&this._markerGroup.removeLayer(a._middleLeft),a._middleRight&&this._markerGroup.removeLayer(a._middleRight),a._prev&&a._next?this._createMiddleMarker(a._prev,a._next):a._prev?a._next||(a._prev._middleRight=null):a._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var i=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),a=this._map.layerPointToLatLng(i),o=s.target;L.extend(o._origLatLng,a),o._middleLeft&&o._middleLeft.setLatLng(this._getMiddleLatLng(o._prev,o)),o._middleRight&&o._middleRight.setLatLng(this._getMiddleLatLng(o,o._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,i){this._markerGroup.eachLayer(function(a){a._index>s&&(a._index+=i)})},_createMiddleMarker:function(s,i){var a,o,l,c=this._getMiddleLatLng(s,i),u=this._createMarker(c);u.setOpacity(.6),s._middleRight=i._middleLeft=u,o=function(){u.off("touchmove",o,this);var d=i._index;u._index=d,u.off("click",a,this).on("click",this._onMarkerClick,this),c.lat=u.getLatLng().lat,c.lng=u.getLatLng().lng,this._spliceLatLngs(d,0,c),this._markers.splice(d,0,u),u.setOpacity(1),this._updateIndexes(d,1),i._index++,this._updatePrevNext(s,u),this._updatePrevNext(u,i),this._poly.fire("editstart")},l=function(){u.off("dragstart",o,this),u.off("dragend",l,this),u.off("touchmove",o,this),this._createMiddleMarker(s,u),this._createMiddleMarker(u,i)},a=function(){o.call(this),l.call(this),this._fireEdit()},u.on("click",a,this).on("dragstart",o,this).on("dragend",l,this).on("touchmove",o,this),this._markerGroup.addLayer(u)},_updatePrevNext:function(s,i){s&&(s._next=i),i&&(i._prev=s)},_getMiddleLatLng:function(s,i){var a=this._poly._map,o=a.project(s.getLatLng()),l=a.project(i.getLatLng());return a.unproject(o._add(l)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,i)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var i=0,a=this._resizeMarkers.length;i<a;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,i){var a=new L.Marker.Touch(s,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(a),this._markerGroup.addLayer(a),a},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var i=s.target,a=i.getLatLng();i===this._moveMarker?this._move(a):this._resize(a),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var i=this._getCorners(),a=s.target,o=a._cornerIndex;a.setOpacity(0),this._oppositeCorner=i[(o+2)%4],this._toggleCornerMarkers(0,o)}this._shape.fire("editstart")},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),a=this._map.layerPointToLatLng(i);return s.target===this._moveMarker?this._move(a):this._resize(a),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),i=s.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var i=0,a=s.length;i<a;i++)this._resizeMarkers.push(this._createMarker(s[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var i=this._getCorners(),a=s.target,o=a._cornerIndex;this._oppositeCorner=i[(o+2)%4],this._toggleCornerMarkers(0,o)},_onMarkerDragEnd:function(s){var i,a,o=s.target;o===this._moveMarker&&(i=this._shape.getBounds(),a=i.getCenter(),o.setLatLng(a)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var i,a=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),o=this._shape.getBounds(),l=o.getCenter(),c=[],u=0,d=a.length;u<d;u++)i=[a[u].lat-l.lat,a[u].lng-l.lng],c.push([s.lat+i[0],s.lng+i[1]]);this._shape.setLatLngs(c),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var i;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var i=0,a=this._resizeMarkers.length;i<a;i++)this._resizeMarkers[i].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),i=0,a=this._resizeMarkers.length;i<a;i++)this._resizeMarkers[i].setLatLng(s[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),i=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var i=this._shape._radius*Math.cos(Math.PI/4),a=this._map.project(s);return this._map.unproject([a.x+i,a.y-i])},_resize:function(s){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(s):radius=this._map.distance(i,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,i){var a={};if(s.touches!==void 0){if(!s.touches.length)return;a=s.touches[0]}else if(s.pointerType!=="touch"||(a=s,!this._filterClick(s)))return;var o=this._map.mouseEventToContainerPoint(a),l=this._map.mouseEventToLayerPoint(a),c=this._map.layerPointToLatLng(l);this._map.fire(i,{latlng:c,layerPoint:l,containerPoint:o,pageX:a.pageX,pageY:a.pageY,originalEvent:s})},_filterClick:function(s){var i=s.timeStamp||s.originalEvent.timeStamp,a=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return a&&a>100&&a<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(s,i)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=n.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var a=s.indexOf("rv:");return parseInt(s.substring(a+3,s.indexOf(".",a)),10)}var o=s.indexOf("Edge/");return o>0&&parseInt(s.substring(o+5,s.indexOf(".",o)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var a=0;a<i.length;a++)L.DomEvent.on(s,i[a],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=n.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var a=s.indexOf("rv:");return parseInt(s.substring(a+3,s.indexOf(".",a)),10)}var o=s.indexOf("Edge/");return o>0&&parseInt(s.substring(o+5,s.indexOf(".",o)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var i=[],a=0,o=s.length;a<o;a++)Array.isArray(s[a])?i.push(L.LatLngUtil.cloneLatLngs(s[a])):i.push(this.cloneLatLng(s[a]));return i},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var a,o,l=i.length,c=0,u=Math.PI/180;if(l>2){for(var d=0;d<l;d++)a=i[d],o=i[(d+1)%l],c+=(o.lng-a.lng)*u*(2+Math.sin(a.lat*u)+Math.sin(o.lat*u));c=6378137*c*6378137/2}return Math.abs(c)},formattedNumber:function(i,a){var o=parseFloat(i).toFixed(a),l=L.drawLocal.format&&L.drawLocal.format.numeric,c=l&&l.delimiters,u=c&&c.thousands,d=c&&c.decimal;if(u||d){var p=o.split(".");o=u?p[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+u):p[0],d=d||".",p.length>1&&(o=o+d+p[1])}return o},readableArea:function(i,a,u){var l,c,u=L.Util.extend({},s,u);return a?(c=["ha","m"],type=typeof a,type==="string"?c=[a]:type!=="boolean"&&(c=a),l=i>=1e6&&c.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,u.km)+" km²":i>=1e4&&c.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,u.ha)+" ha":L.GeometryUtil.formattedNumber(i,u.m)+" m²"):(i/=.836127,l=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,u.mi)+" mi²":i>=4840?L.GeometryUtil.formattedNumber(i/4840,u.ac)+" acres":L.GeometryUtil.formattedNumber(i,u.yd)+" yd²"),l},readableDistance:function(i,a,o,l,d){var u,d=L.Util.extend({},s,d);switch(a?typeof a=="string"?a:"metric":o?"feet":l?"nauticalMile":"yards"){case"metric":u=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,d.km)+" km":L.GeometryUtil.formattedNumber(i,d.m)+" m";break;case"feet":i*=3.28083,u=L.GeometryUtil.formattedNumber(i,d.ft)+" ft";break;case"nauticalMile":i*=.53996,u=L.GeometryUtil.formattedNumber(i/1e3,d.nm)+" nm";break;case"yards":default:i*=1.09361,u=i>1760?L.GeometryUtil.formattedNumber(i/1760,d.mi)+" miles":L.GeometryUtil.formattedNumber(i,d.yd)+" yd"}return u},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,i,a,o){return this._checkCounterclockwise(s,a,o)!==this._checkCounterclockwise(i,a,o)&&this._checkCounterclockwise(s,i,a)!==this._checkCounterclockwise(s,i,o)},_checkCounterclockwise:function(s,i,a){return(a.y-s.y)*(i.x-s.x)>(i.y-s.y)*(a.x-s.x)}}),L.Polyline.include({intersects:function(){var s,i,a,o=this._getProjectedPoints(),l=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=l-1;s>=3;s--)if(i=o[s-1],a=o[s],this._lineSegmentsIntersectsRange(i,a,s-2))return!0;return!1},newLatLngIntersects:function(s,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),i)},newPointIntersects:function(s,i){var a=this._getProjectedPoints(),o=a?a.length:0,l=a?a[o-1]:null,c=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(l,s,c,i?1:0)},_tooFewPointsForIntersection:function(s){var i=this._getProjectedPoints(),a=i?i.length:0;return a+=s||0,!i||a<=3},_lineSegmentsIntersectsRange:function(s,i,a,o){var l,c,u=this._getProjectedPoints();o=o||0;for(var d=a;d>o;d--)if(l=u[d-1],c=u[d],L.LineUtil.segmentsIntersect(s,i,l,c))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],i=this._defaultShape(),a=0;a<i.length;a++)s.push(this._map.latLngToLayerPoint(i[a]));return s}}),L.Polygon.include({intersects:function(){var s,i,a,o,l=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=l.length,i=l[0],a=l[s-1],o=s-2,this._lineSegmentsIntersectsRange(a,i,o,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var i,a=L.DomUtil.create("div","leaflet-draw"),o=!1;for(var l in this._toolbars)this._toolbars.hasOwnProperty(l)&&(i=this._toolbars[l].addToolbar(s))&&(o||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),o=!0),a.appendChild(i));return a},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(s)},_toolbarEnabled:function(s){var i=s.target;for(var a in this._toolbars)this._toolbars[a]!==i&&this._toolbars[a].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var i,a=L.DomUtil.create("div","leaflet-draw-section"),o=0,l=this._toolbarClass||"",c=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,i=0;i<c.length;i++)c[i].enabled&&this._initModeHandler(c[i].handler,this._toolbarContainer,o++,l,c[i].title);if(o)return this._lastButtonIndex=--o,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),a.appendChild(this._toolbarContainer),a.appendChild(this._actionsContainer),a},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,a=this._actionButtons.length;i<a;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,i,a,o,l){var c=s.type;this._modes[c]={},this._modes[c].handler=s,this._modes[c].button=this._createButton({type:c,title:l,className:o+"-"+c,container:i,callback:this._modes[c].handler.enable,context:this._modes[c].handler}),this._modes[c].buttonIndex=a,this._modes[c].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!n.MSStream},_createButton:function(s){var i=L.DomUtil.create("a",s.className||"",s.container),a=L.DomUtil.create("span","sr-only",s.container);i.href="#",i.appendChild(a),s.title&&(i.title=s.title,a.innerHTML=s.title),s.text&&(i.innerHTML=s.text,a.innerHTML=s.text);var o=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,o,s.callback,s.context),i},_disposeButton:function(s,i){var a=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,a,i)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var i,a,o,l,c=this._actionsContainer,u=this.getActions(s),d=u.length;for(a=0,o=this._actionButtons.length;a<o;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback);for(this._actionButtons=[];c.firstChild;)c.removeChild(c.firstChild);for(var p=0;p<d;p++)"enabled"in u[p]&&!u[p].enabled||(i=L.DomUtil.create("li","",c),l=this._createButton({title:u[p].title,text:u[p].text,container:i,callback:u[p].callback,context:u[p].context}),this._actionButtons.push({button:l,callback:u[p].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,i=this._lastButtonIndex,a=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=a+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var i=this._map.latLngToLayerPoint(s),a=this._container;return this._container&&(this._visible&&(a.style.visibility="inherit"),L.DomUtil.setPosition(a,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var i in this.options)this.options.hasOwnProperty(i)&&s[i]&&(s[i]=L.extend({},this.options[i],s[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var i in this._modes)this._modes.hasOwnProperty(i)&&s.hasOwnProperty(i)&&this._modes[i].handler.setOptions(s[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(s){var i=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,i=this.options.featureGroup,a=i.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,a?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",a?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,a?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",a?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(s.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var i=L.Util.stamp(s);this._uneditedLayerProps[i]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var i=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[i].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[i].latlng),s.setRadius(this._uneditedLayerProps[i].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[i].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var i,a,o=s.layer||s.target||s;this._backupLayer(o),this.options.poly&&(a=L.Util.extend({},this.options.poly),o.options.poly=a),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=o.options.color,i.fillColor=o.options.fillColor),o.options.original=L.extend({},o.options),o.options.editing=i),o instanceof L.Marker?(o.editing&&o.editing.enable(),o.dragging.enable(),o.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):o.editing.enable()},_disableLayerEdit:function(s){var i=s.layer||s.target||s;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(s){var i=s.originalEvent.changedTouches[0],a=this._map.mouseEventToLayerPoint(i),o=this._map.layerPointToLatLng(a);s.target.setLatLng(o)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var i=s.layer||s.target||s;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(s){var i=s.layer||s.target||s;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);var H8=63710088e-1;function Qfe(n,e){var t,r,s,i,a,o,l,c,u,d,p=0,x=n.type==="FeatureCollection",y=n.type==="Feature",v=x?n.features.length:1;for(t=0;t<v;t++){for(o=x?n.features[t].geometry:y?n.geometry:n,c=x?n.features[t].properties:y?n.properties:{},u=x?n.features[t].bbox:y?n.bbox:void 0,d=x?n.features[t].id:y?n.id:void 0,l=o?o.type==="GeometryCollection":!1,a=l?o.geometries.length:1,s=0;s<a;s++){if(i=l?o.geometries[s]:o,i===null){if(e(null,p,c,u,d)===!1)return!1;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(i,p,c,u,d)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<i.geometries.length;r++)if(e(i.geometries[r],p,c,u,d)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}p++}}function Jfe(n,e,t){var r=t;return Qfe(n,function(s,i,a,o,l){i===0&&t===void 0?r=s:r=e(r,s,i,a,o,l)}),r}function epe(n){return Jfe(n,(e,t)=>e+tpe(t),0)}function tpe(n){let e=0,t;switch(n.type){case"Polygon":return W8(n.coordinates);case"MultiPolygon":for(t=0;t<n.coordinates.length;t++)e+=W8(n.coordinates[t]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function W8(n){let e=0;if(n&&n.length>0){e+=Math.abs(q8(n[0]));for(let t=1;t<n.length;t++)e-=Math.abs(q8(n[t]))}return e}var npe=H8*H8/2,MN=Math.PI/180;function q8(n){const e=n.length-1;if(e<=2)return 0;let t=0,r=0;for(;r<e;){const s=n[r],i=n[r+1===e?0:r+1],a=n[r+2>=e?(r+2)%e:r+2],o=s[0]*MN,l=i[1]*MN,c=a[0]*MN;t+=(c-o)*Math.sin(l),r++}return t*npe}var rpe="2.0.3",spe=[].slice,ipe={};function gI(n){if(!(n>=1))throw new Error;this._size=n,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}gI.prototype=yV.prototype={constructor:gI,defer:function(n){if(typeof n!="function"||this._call)throw new Error;if(this._error!=null)return this;var e=spe.call(arguments,1);return e.push(n),++this._waiting,this._tasks.push(e),xV(this),this},abort:function(){return this._error==null&&q4(this,new Error("abort")),this},await:function(n){if(typeof n!="function"||this._call)throw new Error;return this._call=function(e,t){n.apply(null,[e].concat(t))},aE(this),this},awaitAll:function(n){if(typeof n!="function"||this._call)throw new Error;return this._call=n,aE(this),this}};function xV(n){if(!n._start)try{ape(n)}catch(e){n._tasks[n._ended+n._active-1]&&q4(n,e)}}function ape(n){for(;n._start=n._waiting&&n._active<n._size;){var e=n._ended+n._active,t=n._tasks[e],r=t.length-1,s=t[r];t[r]=ope(n,e),--n._waiting,++n._active,t=s.apply(null,t),n._tasks[e]&&(n._tasks[e]=t||ipe)}}function ope(n,e){return function(t,r){n._tasks[e]&&(--n._active,++n._ended,n._tasks[e]=null,n._error==null&&(t!=null?q4(n,t):(n._data[e]=r,n._waiting?xV(n):aE(n))))}}function q4(n,e){var t=n._tasks.length,r;for(n._error=e,n._data=void 0,n._waiting=NaN;--t>=0;)if((r=n._tasks[t])&&(n._tasks[t]=null,r.abort))try{r.abort()}catch{}n._active=NaN,aE(n)}function aE(n){!n._active&&n._call&&n._call(n._error,n._data)}function yV(n){return new gI(arguments.length?+n:1/0)}const lpe=Object.freeze(Object.defineProperty({__proto__:null,queue:yV,version:rpe},Symbol.toStringTag,{value:"Module"})),cpe=a7(lpe);var FN,K8;function upe(){if(K8)return FN;K8=1;var n=cpe.queue,e=+new Date;return FN=function(r,s){var i=!!L.mapbox,a=r.getSize(),o=new n(1),l=document.createElement("canvas");l.width=a.x,l.height=a.y;var c=l.getContext("2d"),u=document.createElement("canvas");u.width=1,u.height=1;var d=u.getContext("2d");if(d.fillStyle="rgba(0,0,0,0)",d.fillRect(0,0,1,1),r.eachLayer(x),r.eachLayer(v),r._pathRoot)o.defer(C,r._pathRoot);else if(r._panes){var p=r._panes.overlayPane.getElementsByTagName("canvas").item(0);p&&o.defer(C,p)}r.eachLayer(y),o.awaitAll(S);function x(F){F instanceof L.TileLayer?o.defer(T,F):F._heat&&o.defer(C,F._canvas)}function y(F){F instanceof L.Marker&&F.options.icon instanceof L.Icon&&o.defer(I,F)}function v(F){L.esri&&F instanceof L.esri.DynamicMapLayer&&o.defer($,F)}function b(){s(null,l)}function S(F,G){if(F)throw F;G.forEach(function(V){V&&V.canvas&&c.drawImage(V.canvas,0,0)}),b()}function T(F,G){var V=L.TileLayer.Canvas&&F instanceof L.TileLayer.Canvas,O=document.createElement("canvas");O.width=a.x,O.height=a.y;var K=O.getContext("2d"),P=r.getPixelBounds(),N=r.getZoom(),M=F.options.tileSize;if(N>F.options.maxZoom||N<F.options.minZoom||i&&F instanceof L.mapbox.tileLayer&&!F.options.tiles)return G();var B=L.bounds(P.min.divideBy(M)._floor(),P.max.divideBy(M)._floor()),Y=[],Z,ne,Q=new n(1);for(Z=B.min.y;Z<=B.max.y;Z++)for(ne=B.min.x;ne<=B.max.x;ne++)Y.push(new L.Point(ne,Z));Y.forEach(function(W){var ae=W.clone();F._adjustTilePoint&&F._adjustTilePoint(W);var pe=ae.scaleBy(new L.Point(M,M)).subtract(P.min);if(W.y>=0)if(V){var de=F._tiles[W.x+":"+W.y];Q.defer(z,de,pe,M)}else{var ve=q(F.getTileUrl(W));Q.defer(D,ve,pe,M)}}),Q.awaitAll(X);function z(W,ae,pe,de){de(null,{img:W,pos:ae,size:pe})}function D(W,ae,pe,de){var ve=new Image;ve.crossOrigin="",ve.onload=function(){de(null,{img:this,pos:ae,size:pe})},ve.onerror=function(Ve){F.options.errorTileUrl!=""&&Ve.target.errorCheck===void 0?(Ve.target.errorCheck=!0,Ve.target.src=F.options.errorTileUrl):de(null,{img:u,pos:ae,size:pe})},ve.src=W}function X(W,ae){ae.forEach(re),G(null,{canvas:O})}function re(W){K.drawImage(W.img,Math.floor(W.pos.x),Math.floor(W.pos.y),W.size,W.size)}}function C(F,G){var V=r.getPixelBounds(),O=r.getPixelOrigin(),K=document.createElement("canvas");K.width=a.x,K.height=a.y;var P=K.getContext("2d"),N=L.DomUtil.getPosition(F).subtract(V.min).add(O);try{P.drawImage(F,N.x,N.y,K.width-N.x*2,K.height-N.y*2),G(null,{canvas:K})}catch{console.error("Element could not be drawn on canvas",F)}}function I(F,G){var V=document.createElement("canvas"),O=V.getContext("2d"),K=r.getPixelBounds(),P=new L.Point(K.min.x,K.min.y),N=r.project(F.getLatLng()),M=/^data\:/.test(F._icon.src),B=M?F._icon.src:q(F._icon.src),Y=new Image,Z=F.options.icon.options,ne=Z.iconSize,Q=N.subtract(P),z=L.point(Z.iconAnchor||ne&&ne.divideBy(2,!0));ne instanceof L.Point&&(ne=[ne.x,ne.y]);var D=Math.round(Q.x-ne[0]+z.x),X=Math.round(Q.y-z.y);V.width=a.x,V.height=a.y,Y.crossOrigin="",Y.onload=function(){O.drawImage(this,D,X,ne[0],ne[1]),G(null,{canvas:V})},Y.src=B,M&&Y.onload()}function $(F,G){var V=document.createElement("canvas");V.width=a.x,V.height=a.y;var O=V.getContext("2d"),K=new Image;K.crossOrigin="",K.src=q(F._currentImage._image.src),K.onload=function(){O.drawImage(K,0,0),G(null,{canvas:V})}}function q(F){return U(F)||F.indexOf("mapbox.com/styles/v1")!==-1?F:F+(F.match(/\?/)?"&":"?")+"cache="+e}function U(F){var G=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i;return!!F.match(G)}},FN}var hpe=upe();const dpe=ku(hpe),fpe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",ppe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";Bc.Icon.Default.mergeOptions({iconUrl:fpe,shadowUrl:ppe});function mpe({onDataCapture:n}){const e=Se.useRef(null),t=Se.useRef(null),r=Se.useRef(null),s=Se.useRef(null),i=Se.useRef(null),a=Se.useRef(null),[o,l]=Se.useState(null),[c,u]=Se.useState(null),[d,p]=Se.useState(null),[x,y]=Se.useState(null),[v,b]=Se.useState(null);Se.useEffect(()=>{n&&n({gpsCoords:o,capturedImg:c,satImg:x,measuredArea:v})},[o,c,x,v]),Se.useEffect(()=>{if(e.current)return;const U="https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",F=Bc.map(t.current,{zoomControl:!0}).setView([20,0],2);Bc.tileLayer(U,{maxZoom:19,attribution:"Tiles © Esri"}).addTo(F);const G=new Bc.FeatureGroup().addTo(F);r.current=G;const V=new Bc.Control.Draw({edit:{featureGroup:G},draw:{polygon:!0,rectangle:!0,circle:!0,marker:!1,polyline:!1}});F.addControl(V),F.on(Bc.Draw.Event.CREATED,O=>{const K=O.layer;G.addLayer(K),$(K)}),e.current={map:F}},[]);async function S(){try{const U=await navigator.mediaDevices.getUserMedia({video:!0});s.current.srcObject=U}catch(U){alert("Camera access denied: "+U.message)}}function T(){if(!s.current)return;const U=i.current,F=U.getContext("2d");U.width=s.current.videoWidth,U.height=s.current.videoHeight,F.drawImage(s.current,0,0),navigator.geolocation&&navigator.geolocation.getCurrentPosition(G=>{const V=G.coords.latitude,O=G.coords.longitude;l({lat:V,lon:O}),F.fillStyle="red",F.font="24px Arial",F.fillText(`Lat: ${V.toFixed(6)}, Lon: ${O.toFixed(6)}`,20,40),u(U.toDataURL("image/png"));const{map:K}=e.current;K.setView([V,O],18),Bc.marker([V,O]).addTo(K).bindPopup("Photo GPS point").openPopup()},()=>u(U.toDataURL("image/png")))}function C(U){const F=U.target.files[0];if(!F)return;const G=new FileReader;G.onload=V=>p(V.target.result),G.readAsDataURL(F)}function I(){const{map:U}=e.current;dpe(U,(F,G)=>{if(F)return alert("Map capture failed: "+F.message);const V=[];if(r.current.eachLayer(P=>{if(P instanceof Bc.Polygon||P instanceof Bc.Rectangle){const N=P.getLatLngs()[0];V.push(N.map(M=>U.latLngToContainerPoint(M)))}}),V.length===0)return y(G.toDataURL("image/png"));const O=document.createElement("canvas");O.width=G.width,O.height=G.height;const K=O.getContext("2d");K.drawImage(G,0,0),K.globalCompositeOperation="destination-in",K.beginPath(),V.forEach(P=>{K.moveTo(P[0].x,P[0].y),P.forEach(N=>K.lineTo(N.x,N.y)),K.closePath()}),K.fill(),y(O.toDataURL("image/png"))})}function $(U){const F=U.toGeoJSON();let G=0;F.geometry.type==="Polygon"?G=epe(F):U instanceof Bc.Circle&&(G=Math.PI*U.getRadius()**2),b(G)}function q(U){return U?U>=1e6?(U/1e6).toFixed(4)+" km²":U>=1e4?(U/1e4).toFixed(2)+" ha":Math.round(U)+" m²":"-"}return _.jsxs("div",{className:"verifier-root",children:[_.jsx("header",{children:_.jsx("h1",{children:"📷 Map & Photo Capture"})}),_.jsxs("main",{className:"verifier-main",children:[_.jsxs("section",{className:"verifier-section",children:[_.jsx("h3",{children:"Camera Capture"}),_.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,className:"verifier-video"}),_.jsx("canvas",{ref:i,className:"hidden-canvas"}),_.jsxs("div",{className:"verifier-buttons",children:[_.jsx("button",{type:"button",onClick:S,children:"Start Camera"}),_.jsx("button",{type:"button",onClick:T,children:"Capture Photo"})]}),c&&_.jsxs("div",{children:[_.jsx("h4",{children:"Captured Image with Location:"}),_.jsx("img",{ref:a,src:c,alt:"Captured",className:"verifier-img"})]}),_.jsx("h3",{children:"Upload Image"}),_.jsx("input",{type:"file",accept:"image/*",onChange:C}),d&&_.jsx("img",{src:d,alt:"Uploaded",className:"verifier-img"}),_.jsx("h3",{children:"Satellite Map Capture"}),_.jsx("button",{type:"button",onClick:I,children:"Capture Map View"}),x&&_.jsx("img",{src:x,alt:"Satellite",className:"verifier-img"}),_.jsxs("h4",{children:["Measured Area: ",q(v)]})]}),_.jsxs("section",{className:"verifier-map-section",children:[_.jsx("h3",{children:"Map"}),_.jsx("div",{ref:t,className:"verifier-map"})]})]})]})}function gpe(){const[n,e]=Se.useState({projectName:"",projectType:"",location:"",area:"",description:"",expectedCredits:"",timeline:"",methodology:"",coordinates:"",documents:null,capturedPhoto:null,satImage:null}),t=a=>{const{name:o,value:l}=a.target;e(c=>({...c,[o]:l}))},r=a=>{const o=a.target.files;e(l=>({...l,documents:o}))},s=a=>{e(o=>({...o,coordinates:a.gpsCoords?`${a.gpsCoords.lat}, ${a.gpsCoords.lon}`:o.coordinates,capturedPhoto:a.capturedImg||o.capturedPhoto,satImage:a.satImg||o.satImage,area:a.measuredArea?(a.measuredArea/1e4).toFixed(2):o.area}))},i=async a=>{a.preventDefault();try{const o=hf.currentUser;if(!o){alert("You must be logged in to submit a project.");return}let l=[];if(n.documents)for(let d=0;d<n.documents.length;d++){const p=n.documents[d],x=Lw(ON,`projects/${o.uid}/${Date.now()}_${p.name}`);await Dw(x,p),l.push(await $w(x))}let c=null;if(n.capturedPhoto){const d=await fetch(n.capturedPhoto).then(x=>x.blob()),p=Lw(ON,`projects/${o.uid}/photo_${Date.now()}.png`);await Dw(p,d),c=await $w(p)}let u=null;if(n.satImage){const d=await fetch(n.satImage).then(x=>x.blob()),p=Lw(ON,`projects/${o.uid}/satellite_${Date.now()}.png`);await Dw(p,d),u=await $w(p)}await Zj(uf(Xi,"projects"),{...n,documents:l,capturedPhoto:c,satImage:u,userId:o.uid,status:"pending",numericId:Date.now(),creditsGenerated:0,farmerWalletAddress:null,farmerWalletPrivateKey:null,createdAt:Qj()}),alert("Project submitted successfully!"),e({projectName:"",projectType:"",location:"",area:"",description:"",expectedCredits:"",timeline:"",methodology:"",coordinates:"",documents:null,capturedPhoto:null,satImage:null})}catch(o){console.error("Error adding project: ",o),alert("Failed to submit project. Check console for details.")}};return _.jsxs("div",{className:"page-container",children:[_.jsxs("div",{className:"page-header",children:[_.jsx("h1",{className:"page-title",children:"🌱 Add New Project"}),_.jsx("p",{className:"page-subtitle",children:"Submit your blue carbon project for verification and credit generation"})]}),_.jsxs("form",{className:"project-form",onSubmit:i,children:[_.jsxs("div",{className:"form-section",children:[_.jsx("h3",{children:"Project Information"}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"projectName",children:"Project Name *"}),_.jsx("input",{type:"text",id:"projectName",name:"projectName",value:n.projectName,onChange:t,required:!0,placeholder:"Enter project name"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"projectType",children:"Project Type *"}),_.jsxs("select",{id:"projectType",name:"projectType",value:n.projectType,onChange:t,required:!0,children:[_.jsx("option",{value:"",children:"Select project type"}),_.jsx("option",{value:"mangrove",children:"Mangrove Restoration"}),_.jsx("option",{value:"seagrass",children:"Seagrass Conservation"}),_.jsx("option",{value:"saltmarsh",children:"Salt Marsh Restoration"}),_.jsx("option",{value:"oyster",children:"Oyster Reef Restoration"}),_.jsx("option",{value:"kelp",children:"Kelp Forest Conservation"})]})]})]}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"location",children:"Location *"}),_.jsx("input",{type:"text",id:"location",name:"location",value:n.location,onChange:t,required:!0,placeholder:"City, State, Country"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"area",children:"Project Area (hectares) *"}),_.jsx("input",{type:"number",id:"area",name:"area",value:n.area,onChange:t,required:!0,placeholder:"Enter area in hectares"})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"coordinates",children:"GPS Coordinates"}),_.jsx("input",{type:"text",id:"coordinates",name:"coordinates",value:n.coordinates,onChange:t,placeholder:"Latitude, Longitude"})]})]}),_.jsxs("div",{className:"form-section",children:[_.jsx("h3",{children:"Project Details"}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"description",children:"Project Description *"}),_.jsx("textarea",{id:"description",name:"description",value:n.description,onChange:t,required:!0,placeholder:"Describe your project objectives, methods, and expected environmental impact...",rows:"4"})]}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"expectedCredits",children:"Expected Carbon Credits"}),_.jsx("input",{type:"number",id:"expectedCredits",name:"expectedCredits",value:n.expectedCredits,onChange:t,placeholder:"Estimated credits per year"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"timeline",children:"Project Timeline *"}),_.jsxs("select",{id:"timeline",name:"timeline",value:n.timeline,onChange:t,required:!0,children:[_.jsx("option",{value:"",children:"Select timeline"}),_.jsx("option",{value:"1-year",children:"1 Year"}),_.jsx("option",{value:"2-years",children:"2 Years"}),_.jsx("option",{value:"3-years",children:"3 Years"}),_.jsx("option",{value:"5-years",children:"5 Years"}),_.jsx("option",{value:"10-years",children:"10+ Years"})]})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"methodology",children:"Methodology *"}),_.jsxs("select",{id:"methodology",name:"methodology",value:n.methodology,onChange:t,required:!0,children:[_.jsx("option",{value:"",children:"Select methodology"}),_.jsx("option",{value:"vcs",children:"Verified Carbon Standard (VCS)"}),_.jsx("option",{value:"gold-standard",children:"Gold Standard"}),_.jsx("option",{value:"plan-vivo",children:"Plan Vivo"}),_.jsx("option",{value:"climate-action",children:"Climate Action Reserve"})]})]})]}),_.jsxs("div",{className:"form-section",children:[_.jsx("h3",{children:"Supporting Documents"}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"documents",children:"Upload Documents"}),_.jsx("input",{type:"file",id:"documents",name:"documents",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.png",onChange:r,className:"file-input"}),_.jsx("small",{className:"form-help",children:"Upload project plans, environmental assessments, permits, etc."})]})]}),_.jsxs("div",{className:"form-section",children:[_.jsx("h3",{children:"Satellite & AI Verification"}),_.jsx(mpe,{onDataCapture:s})]}),_.jsx("div",{className:"form-section",children:_.jsx("button",{type:"submit",className:"submit-button",children:"Submit Project"})})]})]})}var Pw={exports:{}};const xpe={},ype=Object.freeze(Object.defineProperty({__proto__:null,default:xpe},Symbol.toStringTag,{value:"Module"})),K4=a7(ype);var bpe=Pw.exports,X8;function vpe(){return X8||(X8=1,(function(n){(function(e,t){function r(P,N){if(!P)throw new Error(N||"Assertion failed")}function s(P,N){P.super_=N;var M=function(){};M.prototype=N.prototype,P.prototype=new M,P.prototype.constructor=P}function i(P,N,M){if(i.isBN(P))return P;this.negative=0,this.words=null,this.length=0,this.red=null,P!==null&&((N==="le"||N==="be")&&(M=N,N=10),this._init(P||0,N||10,M||"be"))}typeof e=="object"?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;var a;try{typeof window<"u"&&typeof window.Buffer<"u"?a=window.Buffer:a=K4.Buffer}catch{}i.isBN=function(N){return N instanceof i?!0:N!==null&&typeof N=="object"&&N.constructor.wordSize===i.wordSize&&Array.isArray(N.words)},i.max=function(N,M){return N.cmp(M)>0?N:M},i.min=function(N,M){return N.cmp(M)<0?N:M},i.prototype._init=function(N,M,B){if(typeof N=="number")return this._initNumber(N,M,B);if(typeof N=="object")return this._initArray(N,M,B);M==="hex"&&(M=16),r(M===(M|0)&&M>=2&&M<=36),N=N.toString().replace(/\s+/g,"");var Y=0;N[0]==="-"&&(Y++,this.negative=1),Y<N.length&&(M===16?this._parseHex(N,Y,B):(this._parseBase(N,M,Y),B==="le"&&this._initArray(this.toArray(),M,B)))},i.prototype._initNumber=function(N,M,B){N<0&&(this.negative=1,N=-N),N<67108864?(this.words=[N&67108863],this.length=1):N<4503599627370496?(this.words=[N&67108863,N/67108864&67108863],this.length=2):(r(N<9007199254740992),this.words=[N&67108863,N/67108864&67108863,1],this.length=3),B==="le"&&this._initArray(this.toArray(),M,B)},i.prototype._initArray=function(N,M,B){if(r(typeof N.length=="number"),N.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(N.length/3),this.words=new Array(this.length);for(var Y=0;Y<this.length;Y++)this.words[Y]=0;var Z,ne,Q=0;if(B==="be")for(Y=N.length-1,Z=0;Y>=0;Y-=3)ne=N[Y]|N[Y-1]<<8|N[Y-2]<<16,this.words[Z]|=ne<<Q&67108863,this.words[Z+1]=ne>>>26-Q&67108863,Q+=24,Q>=26&&(Q-=26,Z++);else if(B==="le")for(Y=0,Z=0;Y<N.length;Y+=3)ne=N[Y]|N[Y+1]<<8|N[Y+2]<<16,this.words[Z]|=ne<<Q&67108863,this.words[Z+1]=ne>>>26-Q&67108863,Q+=24,Q>=26&&(Q-=26,Z++);return this._strip()};function o(P,N){var M=P.charCodeAt(N);if(M>=48&&M<=57)return M-48;if(M>=65&&M<=70)return M-55;if(M>=97&&M<=102)return M-87;r(!1,"Invalid character in "+P)}function l(P,N,M){var B=o(P,M);return M-1>=N&&(B|=o(P,M-1)<<4),B}i.prototype._parseHex=function(N,M,B){this.length=Math.ceil((N.length-M)/6),this.words=new Array(this.length);for(var Y=0;Y<this.length;Y++)this.words[Y]=0;var Z=0,ne=0,Q;if(B==="be")for(Y=N.length-1;Y>=M;Y-=2)Q=l(N,M,Y)<<Z,this.words[ne]|=Q&67108863,Z>=18?(Z-=18,ne+=1,this.words[ne]|=Q>>>26):Z+=8;else{var z=N.length-M;for(Y=z%2===0?M+1:M;Y<N.length;Y+=2)Q=l(N,M,Y)<<Z,this.words[ne]|=Q&67108863,Z>=18?(Z-=18,ne+=1,this.words[ne]|=Q>>>26):Z+=8}this._strip()};function c(P,N,M,B){for(var Y=0,Z=0,ne=Math.min(P.length,M),Q=N;Q<ne;Q++){var z=P.charCodeAt(Q)-48;Y*=B,z>=49?Z=z-49+10:z>=17?Z=z-17+10:Z=z,r(z>=0&&Z<B,"Invalid character"),Y+=Z}return Y}i.prototype._parseBase=function(N,M,B){this.words=[0],this.length=1;for(var Y=0,Z=1;Z<=67108863;Z*=M)Y++;Y--,Z=Z/M|0;for(var ne=N.length-B,Q=ne%Y,z=Math.min(ne,ne-Q)+B,D=0,X=B;X<z;X+=Y)D=c(N,X,X+Y,M),this.imuln(Z),this.words[0]+D<67108864?this.words[0]+=D:this._iaddn(D);if(Q!==0){var re=1;for(D=c(N,X,N.length,M),X=0;X<Q;X++)re*=M;this.imuln(re),this.words[0]+D<67108864?this.words[0]+=D:this._iaddn(D)}this._strip()},i.prototype.copy=function(N){N.words=new Array(this.length);for(var M=0;M<this.length;M++)N.words[M]=this.words[M];N.length=this.length,N.negative=this.negative,N.red=this.red};function u(P,N){P.words=N.words,P.length=N.length,P.negative=N.negative,P.red=N.red}if(i.prototype._move=function(N){u(N,this)},i.prototype.clone=function(){var N=new i(null);return this.copy(N),N},i.prototype._expand=function(N){for(;this.length<N;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=d}catch{i.prototype.inspect=d}else i.prototype.inspect=d;function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(N,M){N=N||10,M=M|0||1;var B;if(N===16||N==="hex"){B="";for(var Y=0,Z=0,ne=0;ne<this.length;ne++){var Q=this.words[ne],z=((Q<<Y|Z)&16777215).toString(16);Z=Q>>>24-Y&16777215,Y+=2,Y>=26&&(Y-=26,ne--),Z!==0||ne!==this.length-1?B=p[6-z.length]+z+B:B=z+B}for(Z!==0&&(B=Z.toString(16)+B);B.length%M!==0;)B="0"+B;return this.negative!==0&&(B="-"+B),B}if(N===(N|0)&&N>=2&&N<=36){var D=x[N],X=y[N];B="";var re=this.clone();for(re.negative=0;!re.isZero();){var W=re.modrn(X).toString(N);re=re.idivn(X),re.isZero()?B=W+B:B=p[D-W.length]+W+B}for(this.isZero()&&(B="0"+B);B.length%M!==0;)B="0"+B;return this.negative!==0&&(B="-"+B),B}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var N=this.words[0];return this.length===2?N+=this.words[1]*67108864:this.length===3&&this.words[2]===1?N+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-N:N},i.prototype.toJSON=function(){return this.toString(16,2)},a&&(i.prototype.toBuffer=function(N,M){return this.toArrayLike(a,N,M)}),i.prototype.toArray=function(N,M){return this.toArrayLike(Array,N,M)};var v=function(N,M){return N.allocUnsafe?N.allocUnsafe(M):new N(M)};i.prototype.toArrayLike=function(N,M,B){this._strip();var Y=this.byteLength(),Z=B||Math.max(1,Y);r(Y<=Z,"byte array longer than desired length"),r(Z>0,"Requested array length <= 0");var ne=v(N,Z),Q=M==="le"?"LE":"BE";return this["_toArrayLike"+Q](ne,Y),ne},i.prototype._toArrayLikeLE=function(N,M){for(var B=0,Y=0,Z=0,ne=0;Z<this.length;Z++){var Q=this.words[Z]<<ne|Y;N[B++]=Q&255,B<N.length&&(N[B++]=Q>>8&255),B<N.length&&(N[B++]=Q>>16&255),ne===6?(B<N.length&&(N[B++]=Q>>24&255),Y=0,ne=0):(Y=Q>>>24,ne+=2)}if(B<N.length)for(N[B++]=Y;B<N.length;)N[B++]=0},i.prototype._toArrayLikeBE=function(N,M){for(var B=N.length-1,Y=0,Z=0,ne=0;Z<this.length;Z++){var Q=this.words[Z]<<ne|Y;N[B--]=Q&255,B>=0&&(N[B--]=Q>>8&255),B>=0&&(N[B--]=Q>>16&255),ne===6?(B>=0&&(N[B--]=Q>>24&255),Y=0,ne=0):(Y=Q>>>24,ne+=2)}if(B>=0)for(N[B--]=Y;B>=0;)N[B--]=0},Math.clz32?i.prototype._countBits=function(N){return 32-Math.clz32(N)}:i.prototype._countBits=function(N){var M=N,B=0;return M>=4096&&(B+=13,M>>>=13),M>=64&&(B+=7,M>>>=7),M>=8&&(B+=4,M>>>=4),M>=2&&(B+=2,M>>>=2),B+M},i.prototype._zeroBits=function(N){if(N===0)return 26;var M=N,B=0;return(M&8191)===0&&(B+=13,M>>>=13),(M&127)===0&&(B+=7,M>>>=7),(M&15)===0&&(B+=4,M>>>=4),(M&3)===0&&(B+=2,M>>>=2),(M&1)===0&&B++,B},i.prototype.bitLength=function(){var N=this.words[this.length-1],M=this._countBits(N);return(this.length-1)*26+M};function b(P){for(var N=new Array(P.bitLength()),M=0;M<N.length;M++){var B=M/26|0,Y=M%26;N[M]=P.words[B]>>>Y&1}return N}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var N=0,M=0;M<this.length;M++){var B=this._zeroBits(this.words[M]);if(N+=B,B!==26)break}return N},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(N){return this.negative!==0?this.abs().inotn(N).iaddn(1):this.clone()},i.prototype.fromTwos=function(N){return this.testn(N-1)?this.notn(N).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(N){for(;this.length<N.length;)this.words[this.length++]=0;for(var M=0;M<N.length;M++)this.words[M]=this.words[M]|N.words[M];return this._strip()},i.prototype.ior=function(N){return r((this.negative|N.negative)===0),this.iuor(N)},i.prototype.or=function(N){return this.length>N.length?this.clone().ior(N):N.clone().ior(this)},i.prototype.uor=function(N){return this.length>N.length?this.clone().iuor(N):N.clone().iuor(this)},i.prototype.iuand=function(N){var M;this.length>N.length?M=N:M=this;for(var B=0;B<M.length;B++)this.words[B]=this.words[B]&N.words[B];return this.length=M.length,this._strip()},i.prototype.iand=function(N){return r((this.negative|N.negative)===0),this.iuand(N)},i.prototype.and=function(N){return this.length>N.length?this.clone().iand(N):N.clone().iand(this)},i.prototype.uand=function(N){return this.length>N.length?this.clone().iuand(N):N.clone().iuand(this)},i.prototype.iuxor=function(N){var M,B;this.length>N.length?(M=this,B=N):(M=N,B=this);for(var Y=0;Y<B.length;Y++)this.words[Y]=M.words[Y]^B.words[Y];if(this!==M)for(;Y<M.length;Y++)this.words[Y]=M.words[Y];return this.length=M.length,this._strip()},i.prototype.ixor=function(N){return r((this.negative|N.negative)===0),this.iuxor(N)},i.prototype.xor=function(N){return this.length>N.length?this.clone().ixor(N):N.clone().ixor(this)},i.prototype.uxor=function(N){return this.length>N.length?this.clone().iuxor(N):N.clone().iuxor(this)},i.prototype.inotn=function(N){r(typeof N=="number"&&N>=0);var M=Math.ceil(N/26)|0,B=N%26;this._expand(M),B>0&&M--;for(var Y=0;Y<M;Y++)this.words[Y]=~this.words[Y]&67108863;return B>0&&(this.words[Y]=~this.words[Y]&67108863>>26-B),this._strip()},i.prototype.notn=function(N){return this.clone().inotn(N)},i.prototype.setn=function(N,M){r(typeof N=="number"&&N>=0);var B=N/26|0,Y=N%26;return this._expand(B+1),M?this.words[B]=this.words[B]|1<<Y:this.words[B]=this.words[B]&~(1<<Y),this._strip()},i.prototype.iadd=function(N){var M;if(this.negative!==0&&N.negative===0)return this.negative=0,M=this.isub(N),this.negative^=1,this._normSign();if(this.negative===0&&N.negative!==0)return N.negative=0,M=this.isub(N),N.negative=1,M._normSign();var B,Y;this.length>N.length?(B=this,Y=N):(B=N,Y=this);for(var Z=0,ne=0;ne<Y.length;ne++)M=(B.words[ne]|0)+(Y.words[ne]|0)+Z,this.words[ne]=M&67108863,Z=M>>>26;for(;Z!==0&&ne<B.length;ne++)M=(B.words[ne]|0)+Z,this.words[ne]=M&67108863,Z=M>>>26;if(this.length=B.length,Z!==0)this.words[this.length]=Z,this.length++;else if(B!==this)for(;ne<B.length;ne++)this.words[ne]=B.words[ne];return this},i.prototype.add=function(N){var M;return N.negative!==0&&this.negative===0?(N.negative=0,M=this.sub(N),N.negative^=1,M):N.negative===0&&this.negative!==0?(this.negative=0,M=N.sub(this),this.negative=1,M):this.length>N.length?this.clone().iadd(N):N.clone().iadd(this)},i.prototype.isub=function(N){if(N.negative!==0){N.negative=0;var M=this.iadd(N);return N.negative=1,M._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(N),this.negative=1,this._normSign();var B=this.cmp(N);if(B===0)return this.negative=0,this.length=1,this.words[0]=0,this;var Y,Z;B>0?(Y=this,Z=N):(Y=N,Z=this);for(var ne=0,Q=0;Q<Z.length;Q++)M=(Y.words[Q]|0)-(Z.words[Q]|0)+ne,ne=M>>26,this.words[Q]=M&67108863;for(;ne!==0&&Q<Y.length;Q++)M=(Y.words[Q]|0)+ne,ne=M>>26,this.words[Q]=M&67108863;if(ne===0&&Q<Y.length&&Y!==this)for(;Q<Y.length;Q++)this.words[Q]=Y.words[Q];return this.length=Math.max(this.length,Q),Y!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(N){return this.clone().isub(N)};function S(P,N,M){M.negative=N.negative^P.negative;var B=P.length+N.length|0;M.length=B,B=B-1|0;var Y=P.words[0]|0,Z=N.words[0]|0,ne=Y*Z,Q=ne&67108863,z=ne/67108864|0;M.words[0]=Q;for(var D=1;D<B;D++){for(var X=z>>>26,re=z&67108863,W=Math.min(D,N.length-1),ae=Math.max(0,D-P.length+1);ae<=W;ae++){var pe=D-ae|0;Y=P.words[pe]|0,Z=N.words[ae]|0,ne=Y*Z+re,X+=ne/67108864|0,re=ne&67108863}M.words[D]=re|0,z=X|0}return z!==0?M.words[D]=z|0:M.length--,M._strip()}var T=function(N,M,B){var Y=N.words,Z=M.words,ne=B.words,Q=0,z,D,X,re=Y[0]|0,W=re&8191,ae=re>>>13,pe=Y[1]|0,de=pe&8191,ve=pe>>>13,Ve=Y[2]|0,ze=Ve&8191,Ge=Ve>>>13,at=Y[3]|0,We=at&8191,nt=at>>>13,Nt=Y[4]|0,ct=Nt&8191,xt=Nt>>>13,en=Y[5]|0,ht=en&8191,St=en>>>13,an=Y[6]|0,Ot=an&8191,Mt=an>>>13,Wn=Y[7]|0,It=Wn&8191,Tt=Wn>>>13,nr=Y[8]|0,Bt=nr&8191,Cn=nr>>>13,Br=Y[9]|0,xn=Br&8191,tn=Br>>>13,Wr=Z[0]|0,rn=Wr&8191,hn=Wr>>>13,es=Z[1]|0,Mn=es&8191,qn=es>>>13,ms=Z[2]|0,Fn=ms&8191,Ft=ms>>>13,oa=Z[3]|0,Rn=oa&8191,Dn=oa>>>13,yi=Z[4]|0,Kn=yi&8191,An=yi>>>13,bi=Z[5]|0,yn=bi&8191,zt=bi>>>13,pn=Z[6]|0,nn=pn&8191,Zt=pn>>>13,dt=Z[7]|0,cr=dt&8191,bn=dt>>>13,ri=Z[8]|0,Xn=ri&8191,vn=ri>>>13,ks=Z[9]|0,mn=ks&8191,Bn=ks>>>13;B.negative=N.negative^M.negative,B.length=19,z=Math.imul(W,rn),D=Math.imul(W,hn),D=D+Math.imul(ae,rn)|0,X=Math.imul(ae,hn);var ur=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(ur>>>26)|0,ur&=67108863,z=Math.imul(de,rn),D=Math.imul(de,hn),D=D+Math.imul(ve,rn)|0,X=Math.imul(ve,hn),z=z+Math.imul(W,Mn)|0,D=D+Math.imul(W,qn)|0,D=D+Math.imul(ae,Mn)|0,X=X+Math.imul(ae,qn)|0;var La=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(La>>>26)|0,La&=67108863,z=Math.imul(ze,rn),D=Math.imul(ze,hn),D=D+Math.imul(Ge,rn)|0,X=Math.imul(Ge,hn),z=z+Math.imul(de,Mn)|0,D=D+Math.imul(de,qn)|0,D=D+Math.imul(ve,Mn)|0,X=X+Math.imul(ve,qn)|0,z=z+Math.imul(W,Fn)|0,D=D+Math.imul(W,Ft)|0,D=D+Math.imul(ae,Fn)|0,X=X+Math.imul(ae,Ft)|0;var vi=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(vi>>>26)|0,vi&=67108863,z=Math.imul(We,rn),D=Math.imul(We,hn),D=D+Math.imul(nt,rn)|0,X=Math.imul(nt,hn),z=z+Math.imul(ze,Mn)|0,D=D+Math.imul(ze,qn)|0,D=D+Math.imul(Ge,Mn)|0,X=X+Math.imul(Ge,qn)|0,z=z+Math.imul(de,Fn)|0,D=D+Math.imul(de,Ft)|0,D=D+Math.imul(ve,Fn)|0,X=X+Math.imul(ve,Ft)|0,z=z+Math.imul(W,Rn)|0,D=D+Math.imul(W,Dn)|0,D=D+Math.imul(ae,Rn)|0,X=X+Math.imul(ae,Dn)|0;var Is=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(Is>>>26)|0,Is&=67108863,z=Math.imul(ct,rn),D=Math.imul(ct,hn),D=D+Math.imul(xt,rn)|0,X=Math.imul(xt,hn),z=z+Math.imul(We,Mn)|0,D=D+Math.imul(We,qn)|0,D=D+Math.imul(nt,Mn)|0,X=X+Math.imul(nt,qn)|0,z=z+Math.imul(ze,Fn)|0,D=D+Math.imul(ze,Ft)|0,D=D+Math.imul(Ge,Fn)|0,X=X+Math.imul(Ge,Ft)|0,z=z+Math.imul(de,Rn)|0,D=D+Math.imul(de,Dn)|0,D=D+Math.imul(ve,Rn)|0,X=X+Math.imul(ve,Dn)|0,z=z+Math.imul(W,Kn)|0,D=D+Math.imul(W,An)|0,D=D+Math.imul(ae,Kn)|0,X=X+Math.imul(ae,An)|0;var gs=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(gs>>>26)|0,gs&=67108863,z=Math.imul(ht,rn),D=Math.imul(ht,hn),D=D+Math.imul(St,rn)|0,X=Math.imul(St,hn),z=z+Math.imul(ct,Mn)|0,D=D+Math.imul(ct,qn)|0,D=D+Math.imul(xt,Mn)|0,X=X+Math.imul(xt,qn)|0,z=z+Math.imul(We,Fn)|0,D=D+Math.imul(We,Ft)|0,D=D+Math.imul(nt,Fn)|0,X=X+Math.imul(nt,Ft)|0,z=z+Math.imul(ze,Rn)|0,D=D+Math.imul(ze,Dn)|0,D=D+Math.imul(Ge,Rn)|0,X=X+Math.imul(Ge,Dn)|0,z=z+Math.imul(de,Kn)|0,D=D+Math.imul(de,An)|0,D=D+Math.imul(ve,Kn)|0,X=X+Math.imul(ve,An)|0,z=z+Math.imul(W,yn)|0,D=D+Math.imul(W,zt)|0,D=D+Math.imul(ae,yn)|0,X=X+Math.imul(ae,zt)|0;var To=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(To>>>26)|0,To&=67108863,z=Math.imul(Ot,rn),D=Math.imul(Ot,hn),D=D+Math.imul(Mt,rn)|0,X=Math.imul(Mt,hn),z=z+Math.imul(ht,Mn)|0,D=D+Math.imul(ht,qn)|0,D=D+Math.imul(St,Mn)|0,X=X+Math.imul(St,qn)|0,z=z+Math.imul(ct,Fn)|0,D=D+Math.imul(ct,Ft)|0,D=D+Math.imul(xt,Fn)|0,X=X+Math.imul(xt,Ft)|0,z=z+Math.imul(We,Rn)|0,D=D+Math.imul(We,Dn)|0,D=D+Math.imul(nt,Rn)|0,X=X+Math.imul(nt,Dn)|0,z=z+Math.imul(ze,Kn)|0,D=D+Math.imul(ze,An)|0,D=D+Math.imul(Ge,Kn)|0,X=X+Math.imul(Ge,An)|0,z=z+Math.imul(de,yn)|0,D=D+Math.imul(de,zt)|0,D=D+Math.imul(ve,yn)|0,X=X+Math.imul(ve,zt)|0,z=z+Math.imul(W,nn)|0,D=D+Math.imul(W,Zt)|0,D=D+Math.imul(ae,nn)|0,X=X+Math.imul(ae,Zt)|0;var si=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(si>>>26)|0,si&=67108863,z=Math.imul(It,rn),D=Math.imul(It,hn),D=D+Math.imul(Tt,rn)|0,X=Math.imul(Tt,hn),z=z+Math.imul(Ot,Mn)|0,D=D+Math.imul(Ot,qn)|0,D=D+Math.imul(Mt,Mn)|0,X=X+Math.imul(Mt,qn)|0,z=z+Math.imul(ht,Fn)|0,D=D+Math.imul(ht,Ft)|0,D=D+Math.imul(St,Fn)|0,X=X+Math.imul(St,Ft)|0,z=z+Math.imul(ct,Rn)|0,D=D+Math.imul(ct,Dn)|0,D=D+Math.imul(xt,Rn)|0,X=X+Math.imul(xt,Dn)|0,z=z+Math.imul(We,Kn)|0,D=D+Math.imul(We,An)|0,D=D+Math.imul(nt,Kn)|0,X=X+Math.imul(nt,An)|0,z=z+Math.imul(ze,yn)|0,D=D+Math.imul(ze,zt)|0,D=D+Math.imul(Ge,yn)|0,X=X+Math.imul(Ge,zt)|0,z=z+Math.imul(de,nn)|0,D=D+Math.imul(de,Zt)|0,D=D+Math.imul(ve,nn)|0,X=X+Math.imul(ve,Zt)|0,z=z+Math.imul(W,cr)|0,D=D+Math.imul(W,bn)|0,D=D+Math.imul(ae,cr)|0,X=X+Math.imul(ae,bn)|0;var il=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(il>>>26)|0,il&=67108863,z=Math.imul(Bt,rn),D=Math.imul(Bt,hn),D=D+Math.imul(Cn,rn)|0,X=Math.imul(Cn,hn),z=z+Math.imul(It,Mn)|0,D=D+Math.imul(It,qn)|0,D=D+Math.imul(Tt,Mn)|0,X=X+Math.imul(Tt,qn)|0,z=z+Math.imul(Ot,Fn)|0,D=D+Math.imul(Ot,Ft)|0,D=D+Math.imul(Mt,Fn)|0,X=X+Math.imul(Mt,Ft)|0,z=z+Math.imul(ht,Rn)|0,D=D+Math.imul(ht,Dn)|0,D=D+Math.imul(St,Rn)|0,X=X+Math.imul(St,Dn)|0,z=z+Math.imul(ct,Kn)|0,D=D+Math.imul(ct,An)|0,D=D+Math.imul(xt,Kn)|0,X=X+Math.imul(xt,An)|0,z=z+Math.imul(We,yn)|0,D=D+Math.imul(We,zt)|0,D=D+Math.imul(nt,yn)|0,X=X+Math.imul(nt,zt)|0,z=z+Math.imul(ze,nn)|0,D=D+Math.imul(ze,Zt)|0,D=D+Math.imul(Ge,nn)|0,X=X+Math.imul(Ge,Zt)|0,z=z+Math.imul(de,cr)|0,D=D+Math.imul(de,bn)|0,D=D+Math.imul(ve,cr)|0,X=X+Math.imul(ve,bn)|0,z=z+Math.imul(W,Xn)|0,D=D+Math.imul(W,vn)|0,D=D+Math.imul(ae,Xn)|0,X=X+Math.imul(ae,vn)|0;var Lu=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(Lu>>>26)|0,Lu&=67108863,z=Math.imul(xn,rn),D=Math.imul(xn,hn),D=D+Math.imul(tn,rn)|0,X=Math.imul(tn,hn),z=z+Math.imul(Bt,Mn)|0,D=D+Math.imul(Bt,qn)|0,D=D+Math.imul(Cn,Mn)|0,X=X+Math.imul(Cn,qn)|0,z=z+Math.imul(It,Fn)|0,D=D+Math.imul(It,Ft)|0,D=D+Math.imul(Tt,Fn)|0,X=X+Math.imul(Tt,Ft)|0,z=z+Math.imul(Ot,Rn)|0,D=D+Math.imul(Ot,Dn)|0,D=D+Math.imul(Mt,Rn)|0,X=X+Math.imul(Mt,Dn)|0,z=z+Math.imul(ht,Kn)|0,D=D+Math.imul(ht,An)|0,D=D+Math.imul(St,Kn)|0,X=X+Math.imul(St,An)|0,z=z+Math.imul(ct,yn)|0,D=D+Math.imul(ct,zt)|0,D=D+Math.imul(xt,yn)|0,X=X+Math.imul(xt,zt)|0,z=z+Math.imul(We,nn)|0,D=D+Math.imul(We,Zt)|0,D=D+Math.imul(nt,nn)|0,X=X+Math.imul(nt,Zt)|0,z=z+Math.imul(ze,cr)|0,D=D+Math.imul(ze,bn)|0,D=D+Math.imul(Ge,cr)|0,X=X+Math.imul(Ge,bn)|0,z=z+Math.imul(de,Xn)|0,D=D+Math.imul(de,vn)|0,D=D+Math.imul(ve,Xn)|0,X=X+Math.imul(ve,vn)|0,z=z+Math.imul(W,mn)|0,D=D+Math.imul(W,Bn)|0,D=D+Math.imul(ae,mn)|0,X=X+Math.imul(ae,Bn)|0;var Co=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(Co>>>26)|0,Co&=67108863,z=Math.imul(xn,Mn),D=Math.imul(xn,qn),D=D+Math.imul(tn,Mn)|0,X=Math.imul(tn,qn),z=z+Math.imul(Bt,Fn)|0,D=D+Math.imul(Bt,Ft)|0,D=D+Math.imul(Cn,Fn)|0,X=X+Math.imul(Cn,Ft)|0,z=z+Math.imul(It,Rn)|0,D=D+Math.imul(It,Dn)|0,D=D+Math.imul(Tt,Rn)|0,X=X+Math.imul(Tt,Dn)|0,z=z+Math.imul(Ot,Kn)|0,D=D+Math.imul(Ot,An)|0,D=D+Math.imul(Mt,Kn)|0,X=X+Math.imul(Mt,An)|0,z=z+Math.imul(ht,yn)|0,D=D+Math.imul(ht,zt)|0,D=D+Math.imul(St,yn)|0,X=X+Math.imul(St,zt)|0,z=z+Math.imul(ct,nn)|0,D=D+Math.imul(ct,Zt)|0,D=D+Math.imul(xt,nn)|0,X=X+Math.imul(xt,Zt)|0,z=z+Math.imul(We,cr)|0,D=D+Math.imul(We,bn)|0,D=D+Math.imul(nt,cr)|0,X=X+Math.imul(nt,bn)|0,z=z+Math.imul(ze,Xn)|0,D=D+Math.imul(ze,vn)|0,D=D+Math.imul(Ge,Xn)|0,X=X+Math.imul(Ge,vn)|0,z=z+Math.imul(de,mn)|0,D=D+Math.imul(de,Bn)|0,D=D+Math.imul(ve,mn)|0,X=X+Math.imul(ve,Bn)|0;var Ao=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(Ao>>>26)|0,Ao&=67108863,z=Math.imul(xn,Fn),D=Math.imul(xn,Ft),D=D+Math.imul(tn,Fn)|0,X=Math.imul(tn,Ft),z=z+Math.imul(Bt,Rn)|0,D=D+Math.imul(Bt,Dn)|0,D=D+Math.imul(Cn,Rn)|0,X=X+Math.imul(Cn,Dn)|0,z=z+Math.imul(It,Kn)|0,D=D+Math.imul(It,An)|0,D=D+Math.imul(Tt,Kn)|0,X=X+Math.imul(Tt,An)|0,z=z+Math.imul(Ot,yn)|0,D=D+Math.imul(Ot,zt)|0,D=D+Math.imul(Mt,yn)|0,X=X+Math.imul(Mt,zt)|0,z=z+Math.imul(ht,nn)|0,D=D+Math.imul(ht,Zt)|0,D=D+Math.imul(St,nn)|0,X=X+Math.imul(St,Zt)|0,z=z+Math.imul(ct,cr)|0,D=D+Math.imul(ct,bn)|0,D=D+Math.imul(xt,cr)|0,X=X+Math.imul(xt,bn)|0,z=z+Math.imul(We,Xn)|0,D=D+Math.imul(We,vn)|0,D=D+Math.imul(nt,Xn)|0,X=X+Math.imul(nt,vn)|0,z=z+Math.imul(ze,mn)|0,D=D+Math.imul(ze,Bn)|0,D=D+Math.imul(Ge,mn)|0,X=X+Math.imul(Ge,Bn)|0;var _i=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(_i>>>26)|0,_i&=67108863,z=Math.imul(xn,Rn),D=Math.imul(xn,Dn),D=D+Math.imul(tn,Rn)|0,X=Math.imul(tn,Dn),z=z+Math.imul(Bt,Kn)|0,D=D+Math.imul(Bt,An)|0,D=D+Math.imul(Cn,Kn)|0,X=X+Math.imul(Cn,An)|0,z=z+Math.imul(It,yn)|0,D=D+Math.imul(It,zt)|0,D=D+Math.imul(Tt,yn)|0,X=X+Math.imul(Tt,zt)|0,z=z+Math.imul(Ot,nn)|0,D=D+Math.imul(Ot,Zt)|0,D=D+Math.imul(Mt,nn)|0,X=X+Math.imul(Mt,Zt)|0,z=z+Math.imul(ht,cr)|0,D=D+Math.imul(ht,bn)|0,D=D+Math.imul(St,cr)|0,X=X+Math.imul(St,bn)|0,z=z+Math.imul(ct,Xn)|0,D=D+Math.imul(ct,vn)|0,D=D+Math.imul(xt,Xn)|0,X=X+Math.imul(xt,vn)|0,z=z+Math.imul(We,mn)|0,D=D+Math.imul(We,Bn)|0,D=D+Math.imul(nt,mn)|0,X=X+Math.imul(nt,Bn)|0;var Pa=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(Pa>>>26)|0,Pa&=67108863,z=Math.imul(xn,Kn),D=Math.imul(xn,An),D=D+Math.imul(tn,Kn)|0,X=Math.imul(tn,An),z=z+Math.imul(Bt,yn)|0,D=D+Math.imul(Bt,zt)|0,D=D+Math.imul(Cn,yn)|0,X=X+Math.imul(Cn,zt)|0,z=z+Math.imul(It,nn)|0,D=D+Math.imul(It,Zt)|0,D=D+Math.imul(Tt,nn)|0,X=X+Math.imul(Tt,Zt)|0,z=z+Math.imul(Ot,cr)|0,D=D+Math.imul(Ot,bn)|0,D=D+Math.imul(Mt,cr)|0,X=X+Math.imul(Mt,bn)|0,z=z+Math.imul(ht,Xn)|0,D=D+Math.imul(ht,vn)|0,D=D+Math.imul(St,Xn)|0,X=X+Math.imul(St,vn)|0,z=z+Math.imul(ct,mn)|0,D=D+Math.imul(ct,Bn)|0,D=D+Math.imul(xt,mn)|0,X=X+Math.imul(xt,Bn)|0;var la=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(la>>>26)|0,la&=67108863,z=Math.imul(xn,yn),D=Math.imul(xn,zt),D=D+Math.imul(tn,yn)|0,X=Math.imul(tn,zt),z=z+Math.imul(Bt,nn)|0,D=D+Math.imul(Bt,Zt)|0,D=D+Math.imul(Cn,nn)|0,X=X+Math.imul(Cn,Zt)|0,z=z+Math.imul(It,cr)|0,D=D+Math.imul(It,bn)|0,D=D+Math.imul(Tt,cr)|0,X=X+Math.imul(Tt,bn)|0,z=z+Math.imul(Ot,Xn)|0,D=D+Math.imul(Ot,vn)|0,D=D+Math.imul(Mt,Xn)|0,X=X+Math.imul(Mt,vn)|0,z=z+Math.imul(ht,mn)|0,D=D+Math.imul(ht,Bn)|0,D=D+Math.imul(St,mn)|0,X=X+Math.imul(St,Bn)|0;var ca=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(ca>>>26)|0,ca&=67108863,z=Math.imul(xn,nn),D=Math.imul(xn,Zt),D=D+Math.imul(tn,nn)|0,X=Math.imul(tn,Zt),z=z+Math.imul(Bt,cr)|0,D=D+Math.imul(Bt,bn)|0,D=D+Math.imul(Cn,cr)|0,X=X+Math.imul(Cn,bn)|0,z=z+Math.imul(It,Xn)|0,D=D+Math.imul(It,vn)|0,D=D+Math.imul(Tt,Xn)|0,X=X+Math.imul(Tt,vn)|0,z=z+Math.imul(Ot,mn)|0,D=D+Math.imul(Ot,Bn)|0,D=D+Math.imul(Mt,mn)|0,X=X+Math.imul(Mt,Bn)|0;var No=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(No>>>26)|0,No&=67108863,z=Math.imul(xn,cr),D=Math.imul(xn,bn),D=D+Math.imul(tn,cr)|0,X=Math.imul(tn,bn),z=z+Math.imul(Bt,Xn)|0,D=D+Math.imul(Bt,vn)|0,D=D+Math.imul(Cn,Xn)|0,X=X+Math.imul(Cn,vn)|0,z=z+Math.imul(It,mn)|0,D=D+Math.imul(It,Bn)|0,D=D+Math.imul(Tt,mn)|0,X=X+Math.imul(Tt,Bn)|0;var ua=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(ua>>>26)|0,ua&=67108863,z=Math.imul(xn,Xn),D=Math.imul(xn,vn),D=D+Math.imul(tn,Xn)|0,X=Math.imul(tn,vn),z=z+Math.imul(Bt,mn)|0,D=D+Math.imul(Bt,Bn)|0,D=D+Math.imul(Cn,mn)|0,X=X+Math.imul(Cn,Bn)|0;var _n=(Q+z|0)+((D&8191)<<13)|0;Q=(X+(D>>>13)|0)+(_n>>>26)|0,_n&=67108863,z=Math.imul(xn,mn),D=Math.imul(xn,Bn),D=D+Math.imul(tn,mn)|0,X=Math.imul(tn,Bn);var Nn=(Q+z|0)+((D&8191)<<13)|0;return Q=(X+(D>>>13)|0)+(Nn>>>26)|0,Nn&=67108863,ne[0]=ur,ne[1]=La,ne[2]=vi,ne[3]=Is,ne[4]=gs,ne[5]=To,ne[6]=si,ne[7]=il,ne[8]=Lu,ne[9]=Co,ne[10]=Ao,ne[11]=_i,ne[12]=Pa,ne[13]=la,ne[14]=ca,ne[15]=No,ne[16]=ua,ne[17]=_n,ne[18]=Nn,Q!==0&&(ne[19]=Q,B.length++),B};Math.imul||(T=S);function C(P,N,M){M.negative=N.negative^P.negative,M.length=P.length+N.length;for(var B=0,Y=0,Z=0;Z<M.length-1;Z++){var ne=Y;Y=0;for(var Q=B&67108863,z=Math.min(Z,N.length-1),D=Math.max(0,Z-P.length+1);D<=z;D++){var X=Z-D,re=P.words[X]|0,W=N.words[D]|0,ae=re*W,pe=ae&67108863;ne=ne+(ae/67108864|0)|0,pe=pe+Q|0,Q=pe&67108863,ne=ne+(pe>>>26)|0,Y+=ne>>>26,ne&=67108863}M.words[Z]=Q,B=ne,ne=Y}return B!==0?M.words[Z]=B:M.length--,M._strip()}function I(P,N,M){return C(P,N,M)}i.prototype.mulTo=function(N,M){var B,Y=this.length+N.length;return this.length===10&&N.length===10?B=T(this,N,M):Y<63?B=S(this,N,M):Y<1024?B=C(this,N,M):B=I(this,N,M),B},i.prototype.mul=function(N){var M=new i(null);return M.words=new Array(this.length+N.length),this.mulTo(N,M)},i.prototype.mulf=function(N){var M=new i(null);return M.words=new Array(this.length+N.length),I(this,N,M)},i.prototype.imul=function(N){return this.clone().mulTo(N,this)},i.prototype.imuln=function(N){var M=N<0;M&&(N=-N),r(typeof N=="number"),r(N<67108864);for(var B=0,Y=0;Y<this.length;Y++){var Z=(this.words[Y]|0)*N,ne=(Z&67108863)+(B&67108863);B>>=26,B+=Z/67108864|0,B+=ne>>>26,this.words[Y]=ne&67108863}return B!==0&&(this.words[Y]=B,this.length++),this.length=N===0?1:this.length,M?this.ineg():this},i.prototype.muln=function(N){return this.clone().imuln(N)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(N){var M=b(N);if(M.length===0)return new i(1);for(var B=this,Y=0;Y<M.length&&M[Y]===0;Y++,B=B.sqr());if(++Y<M.length)for(var Z=B.sqr();Y<M.length;Y++,Z=Z.sqr())M[Y]!==0&&(B=B.mul(Z));return B},i.prototype.iushln=function(N){r(typeof N=="number"&&N>=0);var M=N%26,B=(N-M)/26,Y=67108863>>>26-M<<26-M,Z;if(M!==0){var ne=0;for(Z=0;Z<this.length;Z++){var Q=this.words[Z]&Y,z=(this.words[Z]|0)-Q<<M;this.words[Z]=z|ne,ne=Q>>>26-M}ne&&(this.words[Z]=ne,this.length++)}if(B!==0){for(Z=this.length-1;Z>=0;Z--)this.words[Z+B]=this.words[Z];for(Z=0;Z<B;Z++)this.words[Z]=0;this.length+=B}return this._strip()},i.prototype.ishln=function(N){return r(this.negative===0),this.iushln(N)},i.prototype.iushrn=function(N,M,B){r(typeof N=="number"&&N>=0);var Y;M?Y=(M-M%26)/26:Y=0;var Z=N%26,ne=Math.min((N-Z)/26,this.length),Q=67108863^67108863>>>Z<<Z,z=B;if(Y-=ne,Y=Math.max(0,Y),z){for(var D=0;D<ne;D++)z.words[D]=this.words[D];z.length=ne}if(ne!==0)if(this.length>ne)for(this.length-=ne,D=0;D<this.length;D++)this.words[D]=this.words[D+ne];else this.words[0]=0,this.length=1;var X=0;for(D=this.length-1;D>=0&&(X!==0||D>=Y);D--){var re=this.words[D]|0;this.words[D]=X<<26-Z|re>>>Z,X=re&Q}return z&&X!==0&&(z.words[z.length++]=X),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(N,M,B){return r(this.negative===0),this.iushrn(N,M,B)},i.prototype.shln=function(N){return this.clone().ishln(N)},i.prototype.ushln=function(N){return this.clone().iushln(N)},i.prototype.shrn=function(N){return this.clone().ishrn(N)},i.prototype.ushrn=function(N){return this.clone().iushrn(N)},i.prototype.testn=function(N){r(typeof N=="number"&&N>=0);var M=N%26,B=(N-M)/26,Y=1<<M;if(this.length<=B)return!1;var Z=this.words[B];return!!(Z&Y)},i.prototype.imaskn=function(N){r(typeof N=="number"&&N>=0);var M=N%26,B=(N-M)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=B)return this;if(M!==0&&B++,this.length=Math.min(B,this.length),M!==0){var Y=67108863^67108863>>>M<<M;this.words[this.length-1]&=Y}return this._strip()},i.prototype.maskn=function(N){return this.clone().imaskn(N)},i.prototype.iaddn=function(N){return r(typeof N=="number"),r(N<67108864),N<0?this.isubn(-N):this.negative!==0?this.length===1&&(this.words[0]|0)<=N?(this.words[0]=N-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(N),this.negative=1,this):this._iaddn(N)},i.prototype._iaddn=function(N){this.words[0]+=N;for(var M=0;M<this.length&&this.words[M]>=67108864;M++)this.words[M]-=67108864,M===this.length-1?this.words[M+1]=1:this.words[M+1]++;return this.length=Math.max(this.length,M+1),this},i.prototype.isubn=function(N){if(r(typeof N=="number"),r(N<67108864),N<0)return this.iaddn(-N);if(this.negative!==0)return this.negative=0,this.iaddn(N),this.negative=1,this;if(this.words[0]-=N,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var M=0;M<this.length&&this.words[M]<0;M++)this.words[M]+=67108864,this.words[M+1]-=1;return this._strip()},i.prototype.addn=function(N){return this.clone().iaddn(N)},i.prototype.subn=function(N){return this.clone().isubn(N)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(N,M,B){var Y=N.length+B,Z;this._expand(Y);var ne,Q=0;for(Z=0;Z<N.length;Z++){ne=(this.words[Z+B]|0)+Q;var z=(N.words[Z]|0)*M;ne-=z&67108863,Q=(ne>>26)-(z/67108864|0),this.words[Z+B]=ne&67108863}for(;Z<this.length-B;Z++)ne=(this.words[Z+B]|0)+Q,Q=ne>>26,this.words[Z+B]=ne&67108863;if(Q===0)return this._strip();for(r(Q===-1),Q=0,Z=0;Z<this.length;Z++)ne=-(this.words[Z]|0)+Q,Q=ne>>26,this.words[Z]=ne&67108863;return this.negative=1,this._strip()},i.prototype._wordDiv=function(N,M){var B=this.length-N.length,Y=this.clone(),Z=N,ne=Z.words[Z.length-1]|0,Q=this._countBits(ne);B=26-Q,B!==0&&(Z=Z.ushln(B),Y.iushln(B),ne=Z.words[Z.length-1]|0);var z=Y.length-Z.length,D;if(M!=="mod"){D=new i(null),D.length=z+1,D.words=new Array(D.length);for(var X=0;X<D.length;X++)D.words[X]=0}var re=Y.clone()._ishlnsubmul(Z,1,z);re.negative===0&&(Y=re,D&&(D.words[z]=1));for(var W=z-1;W>=0;W--){var ae=(Y.words[Z.length+W]|0)*67108864+(Y.words[Z.length+W-1]|0);for(ae=Math.min(ae/ne|0,67108863),Y._ishlnsubmul(Z,ae,W);Y.negative!==0;)ae--,Y.negative=0,Y._ishlnsubmul(Z,1,W),Y.isZero()||(Y.negative^=1);D&&(D.words[W]=ae)}return D&&D._strip(),Y._strip(),M!=="div"&&B!==0&&Y.iushrn(B),{div:D||null,mod:Y}},i.prototype.divmod=function(N,M,B){if(r(!N.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var Y,Z,ne;return this.negative!==0&&N.negative===0?(ne=this.neg().divmod(N,M),M!=="mod"&&(Y=ne.div.neg()),M!=="div"&&(Z=ne.mod.neg(),B&&Z.negative!==0&&Z.iadd(N)),{div:Y,mod:Z}):this.negative===0&&N.negative!==0?(ne=this.divmod(N.neg(),M),M!=="mod"&&(Y=ne.div.neg()),{div:Y,mod:ne.mod}):(this.negative&N.negative)!==0?(ne=this.neg().divmod(N.neg(),M),M!=="div"&&(Z=ne.mod.neg(),B&&Z.negative!==0&&Z.isub(N)),{div:ne.div,mod:Z}):N.length>this.length||this.cmp(N)<0?{div:new i(0),mod:this}:N.length===1?M==="div"?{div:this.divn(N.words[0]),mod:null}:M==="mod"?{div:null,mod:new i(this.modrn(N.words[0]))}:{div:this.divn(N.words[0]),mod:new i(this.modrn(N.words[0]))}:this._wordDiv(N,M)},i.prototype.div=function(N){return this.divmod(N,"div",!1).div},i.prototype.mod=function(N){return this.divmod(N,"mod",!1).mod},i.prototype.umod=function(N){return this.divmod(N,"mod",!0).mod},i.prototype.divRound=function(N){var M=this.divmod(N);if(M.mod.isZero())return M.div;var B=M.div.negative!==0?M.mod.isub(N):M.mod,Y=N.ushrn(1),Z=N.andln(1),ne=B.cmp(Y);return ne<0||Z===1&&ne===0?M.div:M.div.negative!==0?M.div.isubn(1):M.div.iaddn(1)},i.prototype.modrn=function(N){var M=N<0;M&&(N=-N),r(N<=67108863);for(var B=(1<<26)%N,Y=0,Z=this.length-1;Z>=0;Z--)Y=(B*Y+(this.words[Z]|0))%N;return M?-Y:Y},i.prototype.modn=function(N){return this.modrn(N)},i.prototype.idivn=function(N){var M=N<0;M&&(N=-N),r(N<=67108863);for(var B=0,Y=this.length-1;Y>=0;Y--){var Z=(this.words[Y]|0)+B*67108864;this.words[Y]=Z/N|0,B=Z%N}return this._strip(),M?this.ineg():this},i.prototype.divn=function(N){return this.clone().idivn(N)},i.prototype.egcd=function(N){r(N.negative===0),r(!N.isZero());var M=this,B=N.clone();M.negative!==0?M=M.umod(N):M=M.clone();for(var Y=new i(1),Z=new i(0),ne=new i(0),Q=new i(1),z=0;M.isEven()&&B.isEven();)M.iushrn(1),B.iushrn(1),++z;for(var D=B.clone(),X=M.clone();!M.isZero();){for(var re=0,W=1;(M.words[0]&W)===0&&re<26;++re,W<<=1);if(re>0)for(M.iushrn(re);re-- >0;)(Y.isOdd()||Z.isOdd())&&(Y.iadd(D),Z.isub(X)),Y.iushrn(1),Z.iushrn(1);for(var ae=0,pe=1;(B.words[0]&pe)===0&&ae<26;++ae,pe<<=1);if(ae>0)for(B.iushrn(ae);ae-- >0;)(ne.isOdd()||Q.isOdd())&&(ne.iadd(D),Q.isub(X)),ne.iushrn(1),Q.iushrn(1);M.cmp(B)>=0?(M.isub(B),Y.isub(ne),Z.isub(Q)):(B.isub(M),ne.isub(Y),Q.isub(Z))}return{a:ne,b:Q,gcd:B.iushln(z)}},i.prototype._invmp=function(N){r(N.negative===0),r(!N.isZero());var M=this,B=N.clone();M.negative!==0?M=M.umod(N):M=M.clone();for(var Y=new i(1),Z=new i(0),ne=B.clone();M.cmpn(1)>0&&B.cmpn(1)>0;){for(var Q=0,z=1;(M.words[0]&z)===0&&Q<26;++Q,z<<=1);if(Q>0)for(M.iushrn(Q);Q-- >0;)Y.isOdd()&&Y.iadd(ne),Y.iushrn(1);for(var D=0,X=1;(B.words[0]&X)===0&&D<26;++D,X<<=1);if(D>0)for(B.iushrn(D);D-- >0;)Z.isOdd()&&Z.iadd(ne),Z.iushrn(1);M.cmp(B)>=0?(M.isub(B),Y.isub(Z)):(B.isub(M),Z.isub(Y))}var re;return M.cmpn(1)===0?re=Y:re=Z,re.cmpn(0)<0&&re.iadd(N),re},i.prototype.gcd=function(N){if(this.isZero())return N.abs();if(N.isZero())return this.abs();var M=this.clone(),B=N.clone();M.negative=0,B.negative=0;for(var Y=0;M.isEven()&&B.isEven();Y++)M.iushrn(1),B.iushrn(1);do{for(;M.isEven();)M.iushrn(1);for(;B.isEven();)B.iushrn(1);var Z=M.cmp(B);if(Z<0){var ne=M;M=B,B=ne}else if(Z===0||B.cmpn(1)===0)break;M.isub(B)}while(!0);return B.iushln(Y)},i.prototype.invm=function(N){return this.egcd(N).a.umod(N)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(N){return this.words[0]&N},i.prototype.bincn=function(N){r(typeof N=="number");var M=N%26,B=(N-M)/26,Y=1<<M;if(this.length<=B)return this._expand(B+1),this.words[B]|=Y,this;for(var Z=Y,ne=B;Z!==0&&ne<this.length;ne++){var Q=this.words[ne]|0;Q+=Z,Z=Q>>>26,Q&=67108863,this.words[ne]=Q}return Z!==0&&(this.words[ne]=Z,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(N){var M=N<0;if(this.negative!==0&&!M)return-1;if(this.negative===0&&M)return 1;this._strip();var B;if(this.length>1)B=1;else{M&&(N=-N),r(N<=67108863,"Number is too big");var Y=this.words[0]|0;B=Y===N?0:Y<N?-1:1}return this.negative!==0?-B|0:B},i.prototype.cmp=function(N){if(this.negative!==0&&N.negative===0)return-1;if(this.negative===0&&N.negative!==0)return 1;var M=this.ucmp(N);return this.negative!==0?-M|0:M},i.prototype.ucmp=function(N){if(this.length>N.length)return 1;if(this.length<N.length)return-1;for(var M=0,B=this.length-1;B>=0;B--){var Y=this.words[B]|0,Z=N.words[B]|0;if(Y!==Z){Y<Z?M=-1:Y>Z&&(M=1);break}}return M},i.prototype.gtn=function(N){return this.cmpn(N)===1},i.prototype.gt=function(N){return this.cmp(N)===1},i.prototype.gten=function(N){return this.cmpn(N)>=0},i.prototype.gte=function(N){return this.cmp(N)>=0},i.prototype.ltn=function(N){return this.cmpn(N)===-1},i.prototype.lt=function(N){return this.cmp(N)===-1},i.prototype.lten=function(N){return this.cmpn(N)<=0},i.prototype.lte=function(N){return this.cmp(N)<=0},i.prototype.eqn=function(N){return this.cmpn(N)===0},i.prototype.eq=function(N){return this.cmp(N)===0},i.red=function(N){return new O(N)},i.prototype.toRed=function(N){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),N.convertTo(this)._forceRed(N)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(N){return this.red=N,this},i.prototype.forceRed=function(N){return r(!this.red,"Already a number in reduction context"),this._forceRed(N)},i.prototype.redAdd=function(N){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,N)},i.prototype.redIAdd=function(N){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,N)},i.prototype.redSub=function(N){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,N)},i.prototype.redISub=function(N){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,N)},i.prototype.redShl=function(N){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,N)},i.prototype.redMul=function(N){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,N),this.red.mul(this,N)},i.prototype.redIMul=function(N){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,N),this.red.imul(this,N)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(N){return r(this.red&&!N.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,N)};var $={k256:null,p224:null,p192:null,p25519:null};function q(P,N){this.name=P,this.p=new i(N,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}q.prototype._tmp=function(){var N=new i(null);return N.words=new Array(Math.ceil(this.n/13)),N},q.prototype.ireduce=function(N){var M=N,B;do this.split(M,this.tmp),M=this.imulK(M),M=M.iadd(this.tmp),B=M.bitLength();while(B>this.n);var Y=B<this.n?-1:M.ucmp(this.p);return Y===0?(M.words[0]=0,M.length=1):Y>0?M.isub(this.p):M.strip!==void 0?M.strip():M._strip(),M},q.prototype.split=function(N,M){N.iushrn(this.n,0,M)},q.prototype.imulK=function(N){return N.imul(this.k)};function U(){q.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(U,q),U.prototype.split=function(N,M){for(var B=4194303,Y=Math.min(N.length,9),Z=0;Z<Y;Z++)M.words[Z]=N.words[Z];if(M.length=Y,N.length<=9){N.words[0]=0,N.length=1;return}var ne=N.words[9];for(M.words[M.length++]=ne&B,Z=10;Z<N.length;Z++){var Q=N.words[Z]|0;N.words[Z-10]=(Q&B)<<4|ne>>>22,ne=Q}ne>>>=22,N.words[Z-10]=ne,ne===0&&N.length>10?N.length-=10:N.length-=9},U.prototype.imulK=function(N){N.words[N.length]=0,N.words[N.length+1]=0,N.length+=2;for(var M=0,B=0;B<N.length;B++){var Y=N.words[B]|0;M+=Y*977,N.words[B]=M&67108863,M=Y*64+(M/67108864|0)}return N.words[N.length-1]===0&&(N.length--,N.words[N.length-1]===0&&N.length--),N};function F(){q.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(F,q);function G(){q.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(G,q);function V(){q.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(V,q),V.prototype.imulK=function(N){for(var M=0,B=0;B<N.length;B++){var Y=(N.words[B]|0)*19+M,Z=Y&67108863;Y>>>=26,N.words[B]=Z,M=Y}return M!==0&&(N.words[N.length++]=M),N},i._prime=function(N){if($[N])return $[N];var M;if(N==="k256")M=new U;else if(N==="p224")M=new F;else if(N==="p192")M=new G;else if(N==="p25519")M=new V;else throw new Error("Unknown prime "+N);return $[N]=M,M};function O(P){if(typeof P=="string"){var N=i._prime(P);this.m=N.p,this.prime=N}else r(P.gtn(1),"modulus must be greater than 1"),this.m=P,this.prime=null}O.prototype._verify1=function(N){r(N.negative===0,"red works only with positives"),r(N.red,"red works only with red numbers")},O.prototype._verify2=function(N,M){r((N.negative|M.negative)===0,"red works only with positives"),r(N.red&&N.red===M.red,"red works only with red numbers")},O.prototype.imod=function(N){return this.prime?this.prime.ireduce(N)._forceRed(this):(u(N,N.umod(this.m)._forceRed(this)),N)},O.prototype.neg=function(N){return N.isZero()?N.clone():this.m.sub(N)._forceRed(this)},O.prototype.add=function(N,M){this._verify2(N,M);var B=N.add(M);return B.cmp(this.m)>=0&&B.isub(this.m),B._forceRed(this)},O.prototype.iadd=function(N,M){this._verify2(N,M);var B=N.iadd(M);return B.cmp(this.m)>=0&&B.isub(this.m),B},O.prototype.sub=function(N,M){this._verify2(N,M);var B=N.sub(M);return B.cmpn(0)<0&&B.iadd(this.m),B._forceRed(this)},O.prototype.isub=function(N,M){this._verify2(N,M);var B=N.isub(M);return B.cmpn(0)<0&&B.iadd(this.m),B},O.prototype.shl=function(N,M){return this._verify1(N),this.imod(N.ushln(M))},O.prototype.imul=function(N,M){return this._verify2(N,M),this.imod(N.imul(M))},O.prototype.mul=function(N,M){return this._verify2(N,M),this.imod(N.mul(M))},O.prototype.isqr=function(N){return this.imul(N,N.clone())},O.prototype.sqr=function(N){return this.mul(N,N)},O.prototype.sqrt=function(N){if(N.isZero())return N.clone();var M=this.m.andln(3);if(r(M%2===1),M===3){var B=this.m.add(new i(1)).iushrn(2);return this.pow(N,B)}for(var Y=this.m.subn(1),Z=0;!Y.isZero()&&Y.andln(1)===0;)Z++,Y.iushrn(1);r(!Y.isZero());var ne=new i(1).toRed(this),Q=ne.redNeg(),z=this.m.subn(1).iushrn(1),D=this.m.bitLength();for(D=new i(2*D*D).toRed(this);this.pow(D,z).cmp(Q)!==0;)D.redIAdd(Q);for(var X=this.pow(D,Y),re=this.pow(N,Y.addn(1).iushrn(1)),W=this.pow(N,Y),ae=Z;W.cmp(ne)!==0;){for(var pe=W,de=0;pe.cmp(ne)!==0;de++)pe=pe.redSqr();r(de<ae);var ve=this.pow(X,new i(1).iushln(ae-de-1));re=re.redMul(ve),X=ve.redSqr(),W=W.redMul(X),ae=de}return re},O.prototype.invm=function(N){var M=N._invmp(this.m);return M.negative!==0?(M.negative=0,this.imod(M).redNeg()):this.imod(M)},O.prototype.pow=function(N,M){if(M.isZero())return new i(1).toRed(this);if(M.cmpn(1)===0)return N.clone();var B=4,Y=new Array(1<<B);Y[0]=new i(1).toRed(this),Y[1]=N;for(var Z=2;Z<Y.length;Z++)Y[Z]=this.mul(Y[Z-1],N);var ne=Y[0],Q=0,z=0,D=M.bitLength()%26;for(D===0&&(D=26),Z=M.length-1;Z>=0;Z--){for(var X=M.words[Z],re=D-1;re>=0;re--){var W=X>>re&1;if(ne!==Y[0]&&(ne=this.sqr(ne)),W===0&&Q===0){z=0;continue}Q<<=1,Q|=W,z++,!(z!==B&&(Z!==0||re!==0))&&(ne=this.mul(ne,Y[Q]),z=0,Q=0)}D=26}return ne},O.prototype.convertTo=function(N){var M=N.umod(this.m);return M===N?M.clone():M},O.prototype.convertFrom=function(N){var M=N.clone();return M.red=null,M},i.mont=function(N){return new K(N)};function K(P){O.call(this,P),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(K,O),K.prototype.convertTo=function(N){return this.imod(N.ushln(this.shift))},K.prototype.convertFrom=function(N){var M=this.imod(N.mul(this.rinv));return M.red=null,M},K.prototype.imul=function(N,M){if(N.isZero()||M.isZero())return N.words[0]=0,N.length=1,N;var B=N.imul(M),Y=B.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Z=B.isub(Y).iushrn(this.shift),ne=Z;return Z.cmp(this.m)>=0?ne=Z.isub(this.m):Z.cmpn(0)<0&&(ne=Z.iadd(this.m)),ne._forceRed(this)},K.prototype.mul=function(N,M){if(N.isZero()||M.isZero())return new i(0)._forceRed(this);var B=N.mul(M),Y=B.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Z=B.isub(Y).iushrn(this.shift),ne=Z;return Z.cmp(this.m)>=0?ne=Z.isub(this.m):Z.cmpn(0)<0&&(ne=Z.iadd(this.m)),ne._forceRed(this)},K.prototype.invm=function(N){var M=this.imod(N._invmp(this.m).mul(this.r2));return M._forceRed(this)}})(n,bpe)})(Pw)),Pw.exports}var _pe=vpe();const Jt=ku(_pe),wpe="logger/5.8.0";let Y8=!1,Z8=!1;const Ow={debug:1,default:2,info:2,warning:3,error:4,off:5};let Q8=Ow.default,BN=null;function Epe(){try{const n=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{n.push(e)}}),n.length)throw new Error("missing "+n.join(", "));if("é".normalize("NFD")!=="é")throw new Error("broken implementation")}catch(n){return n.message}return null}const J8=Epe();var xI;(function(n){n.DEBUG="DEBUG",n.INFO="INFO",n.WARNING="WARNING",n.ERROR="ERROR",n.OFF="OFF"})(xI||(xI={}));var nc;(function(n){n.UNKNOWN_ERROR="UNKNOWN_ERROR",n.NOT_IMPLEMENTED="NOT_IMPLEMENTED",n.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",n.NETWORK_ERROR="NETWORK_ERROR",n.SERVER_ERROR="SERVER_ERROR",n.TIMEOUT="TIMEOUT",n.BUFFER_OVERRUN="BUFFER_OVERRUN",n.NUMERIC_FAULT="NUMERIC_FAULT",n.MISSING_NEW="MISSING_NEW",n.INVALID_ARGUMENT="INVALID_ARGUMENT",n.MISSING_ARGUMENT="MISSING_ARGUMENT",n.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",n.CALL_EXCEPTION="CALL_EXCEPTION",n.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",n.NONCE_EXPIRED="NONCE_EXPIRED",n.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",n.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",n.TRANSACTION_REPLACED="TRANSACTION_REPLACED",n.ACTION_REJECTED="ACTION_REJECTED"})(nc||(nc={}));const e5="0123456789abcdef";let Le=class ci{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const r=e.toLowerCase();Ow[r]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(Q8>Ow[r])&&console.log.apply(console,t)}debug(...e){this._log(ci.levels.DEBUG,e)}info(...e){this._log(ci.levels.INFO,e)}warn(...e){this._log(ci.levels.WARNING,e)}makeError(e,t,r){if(Z8)return this.makeError("censored error",t,{});t||(t=ci.errors.UNKNOWN_ERROR),r||(r={});const s=[];Object.keys(r).forEach(l=>{const c=r[l];try{if(c instanceof Uint8Array){let u="";for(let d=0;d<c.length;d++)u+=e5[c[d]>>4],u+=e5[c[d]&15];s.push(l+"=Uint8Array(0x"+u+")")}else s.push(l+"="+JSON.stringify(c))}catch{s.push(l+"="+JSON.stringify(r[l].toString()))}}),s.push(`code=${t}`),s.push(`version=${this.version}`);const i=e;let a="";switch(t){case nc.NUMERIC_FAULT:{a="NUMERIC_FAULT";const l=e;switch(l){case"overflow":case"underflow":case"division-by-zero":a+="-"+l;break;case"negative-power":case"negative-width":a+="-unsupported";break;case"unbound-bitwise-result":a+="-unbound-result";break}break}case nc.CALL_EXCEPTION:case nc.INSUFFICIENT_FUNDS:case nc.MISSING_NEW:case nc.NONCE_EXPIRED:case nc.REPLACEMENT_UNDERPRICED:case nc.TRANSACTION_REPLACED:case nc.UNPREDICTABLE_GAS_LIMIT:a=t;break}a&&(e+=" [ See: https://links.ethers.org/v5-errors-"+a+" ]"),s.length&&(e+=" ("+s.join(", ")+")");const o=new Error(e);return o.reason=i,o.code=t,Object.keys(r).forEach(function(l){o[l]=r[l]}),o}throwError(e,t,r){throw this.makeError(e,t,r)}throwArgumentError(e,t,r){return this.throwError(e,ci.errors.INVALID_ARGUMENT,{argument:t,value:r})}assert(e,t,r,s){e||this.throwError(t,r,s)}assertArgument(e,t,r,s){e||this.throwArgumentError(t,r,s)}checkNormalize(e){J8&&this.throwError("platform missing String.prototype.normalize",ci.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:J8})}checkSafeUint53(e,t){typeof e=="number"&&(t==null&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,ci.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,ci.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,r){r?r=": "+r:r="",e<t&&this.throwError("missing argument"+r,ci.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+r,ci.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||e==null)&&this.throwError("missing new",ci.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",ci.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",ci.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return BN||(BN=new ci(wpe)),BN}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",ci.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),Y8){if(!e)return;this.globalLogger().throwError("error censorship permanent",ci.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Z8=!!e,Y8=!!t}static setLogLevel(e){const t=Ow[e.toLowerCase()];if(t==null){ci.globalLogger().warn("invalid log level - "+e);return}Q8=t}static from(e){return new ci(e)}};Le.errors=nc;Le.levels=xI;const Spe="bytes/5.8.0",bs=new Le(Spe);function bV(n){return!!n.toHexString}function Q0(n){return n.slice||(n.slice=function(){const e=Array.prototype.slice.call(arguments);return Q0(new Uint8Array(Array.prototype.slice.apply(n,e)))}),n}function $S(n){return lr(n)&&!(n.length%2)||Gg(n)}function t5(n){return typeof n=="number"&&n==n&&n%1===0}function Gg(n){if(n==null)return!1;if(n.constructor===Uint8Array)return!0;if(typeof n=="string"||!t5(n.length)||n.length<0)return!1;for(let e=0;e<n.length;e++){const t=n[e];if(!t5(t)||t<0||t>=256)return!1}return!0}function rt(n,e){if(e||(e={}),typeof n=="number"){bs.checkSafeUint53(n,"invalid arrayify value");const t=[];for(;n;)t.unshift(n&255),n=parseInt(String(n/256));return t.length===0&&t.push(0),Q0(new Uint8Array(t))}if(e.allowMissingPrefix&&typeof n=="string"&&n.substring(0,2)!=="0x"&&(n="0x"+n),bV(n)&&(n=n.toHexString()),lr(n)){let t=n.substring(2);t.length%2&&(e.hexPad==="left"?t="0"+t:e.hexPad==="right"?t+="0":bs.throwArgumentError("hex data is odd-length","value",n));const r=[];for(let s=0;s<t.length;s+=2)r.push(parseInt(t.substring(s,s+2),16));return Q0(new Uint8Array(r))}return Gg(n)?Q0(new Uint8Array(n)):bs.throwArgumentError("invalid arrayify value","value",n)}function zs(n){const e=n.map(s=>rt(s)),t=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(t);return e.reduce((s,i)=>(r.set(i,s),s+i.length),0),Q0(r)}function bh(n){let e=rt(n);if(e.length===0)return e;let t=0;for(;t<e.length&&e[t]===0;)t++;return t&&(e=e.slice(t)),e}function Tpe(n,e){n=rt(n),n.length>e&&bs.throwArgumentError("value out of range","value",arguments[0]);const t=new Uint8Array(e);return t.set(n,e-n.length),Q0(t)}function lr(n,e){return!(typeof n!="string"||!n.match(/^0x[0-9A-Fa-f]*$/)||e&&n.length!==2+2*e)}const zN="0123456789abcdef";function ot(n,e){if(e||(e={}),typeof n=="number"){bs.checkSafeUint53(n,"invalid hexlify value");let t="";for(;n;)t=zN[n&15]+t,n=Math.floor(n/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if(typeof n=="bigint")return n=n.toString(16),n.length%2?"0x0"+n:"0x"+n;if(e.allowMissingPrefix&&typeof n=="string"&&n.substring(0,2)!=="0x"&&(n="0x"+n),bV(n))return n.toHexString();if(lr(n))return n.length%2&&(e.hexPad==="left"?n="0x0"+n.substring(2):e.hexPad==="right"?n+="0":bs.throwArgumentError("hex data is odd-length","value",n)),n.toLowerCase();if(Gg(n)){let t="0x";for(let r=0;r<n.length;r++){let s=n[r];t+=zN[(s&240)>>4]+zN[s&15]}return t}return bs.throwArgumentError("invalid hexlify value","value",n)}function Qp(n){if(typeof n!="string")n=ot(n);else if(!lr(n)||n.length%2)return null;return(n.length-2)/2}function ui(n,e,t){return typeof n!="string"?n=ot(n):(!lr(n)||n.length%2)&&bs.throwArgumentError("invalid hexData","value",n),e=2+2*e,t!=null?"0x"+n.substring(e,2+2*t):"0x"+n.substring(e)}function xo(n){let e="0x";return n.forEach(t=>{e+=ot(t).substring(2)}),e}function X4(n){const e=Cpe(ot(n,{hexPad:"left"}));return e==="0x"?"0x0":e}function Cpe(n){typeof n!="string"&&(n=ot(n)),lr(n)||bs.throwArgumentError("invalid hex string","value",n),n=n.substring(2);let e=0;for(;e<n.length&&n[e]==="0";)e++;return"0x"+n.substring(e)}function Gr(n,e){for(typeof n!="string"?n=ot(n):lr(n)||bs.throwArgumentError("invalid hex string","value",n),n.length>2*e+2&&bs.throwArgumentError("value out of range","value",arguments[1]);n.length<2*e+2;)n="0x0"+n.substring(2);return n}function Hg(n){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if($S(n)){let t=rt(n);t.length===64?(e.v=27+(t[32]>>7),t[32]&=127,e.r=ot(t.slice(0,32)),e.s=ot(t.slice(32,64))):t.length===65?(e.r=ot(t.slice(0,32)),e.s=ot(t.slice(32,64)),e.v=t[64]):bs.throwArgumentError("invalid signature string","signature",n),e.v<27&&(e.v===0||e.v===1?e.v+=27:bs.throwArgumentError("signature invalid v byte","signature",n)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(t[32]|=128),e._vs=ot(t.slice(32,64))}else{if(e.r=n.r,e.s=n.s,e.v=n.v,e.recoveryParam=n.recoveryParam,e._vs=n._vs,e._vs!=null){const s=Tpe(rt(e._vs),32);e._vs=ot(s);const i=s[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=i:e.recoveryParam!==i&&bs.throwArgumentError("signature recoveryParam mismatch _vs","signature",n),s[0]&=127;const a=ot(s);e.s==null?e.s=a:e.s!==a&&bs.throwArgumentError("signature v mismatch _vs","signature",n)}if(e.recoveryParam==null)e.v==null?bs.throwArgumentError("signature missing v and recoveryParam","signature",n):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const s=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==s&&bs.throwArgumentError("signature recoveryParam mismatch v","signature",n)}e.r==null||!lr(e.r)?bs.throwArgumentError("signature missing or invalid r","signature",n):e.r=Gr(e.r,32),e.s==null||!lr(e.s)?bs.throwArgumentError("signature missing or invalid s","signature",n):e.s=Gr(e.s,32);const t=rt(e.s);t[0]>=128&&bs.throwArgumentError("signature s out of range","signature",n),e.recoveryParam&&(t[0]|=128);const r=ot(t);e._vs&&(lr(e._vs)||bs.throwArgumentError("signature invalid _vs","signature",n),e._vs=Gr(e._vs,32)),e._vs==null?e._vs=r:e._vs!==r&&bs.throwArgumentError("signature _vs mismatch v and s","signature",n)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}function n5(n){return n=Hg(n),ot(zs([n.r,n.s,n.recoveryParam?"0x1c":"0x1b"]))}const vV="bignumber/5.8.0";var oE=Jt.BN;const rh=new Le(vV),jN={},r5=9007199254740991;function Ape(n){return n!=null&&(st.isBigNumber(n)||typeof n=="number"&&n%1===0||typeof n=="string"&&!!n.match(/^-?[0-9]+$/)||lr(n)||typeof n=="bigint"||Gg(n))}let s5=!1;class st{constructor(e,t){e!==jN&&rh.throwError("cannot call constructor directly; use BigNumber.from",Le.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=t,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return uo(Vn(this).fromTwos(e))}toTwos(e){return uo(Vn(this).toTwos(e))}abs(){return this._hex[0]==="-"?st.from(this._hex.substring(1)):this}add(e){return uo(Vn(this).add(Vn(e)))}sub(e){return uo(Vn(this).sub(Vn(e)))}div(e){return st.from(e).isZero()&&xl("division-by-zero","div"),uo(Vn(this).div(Vn(e)))}mul(e){return uo(Vn(this).mul(Vn(e)))}mod(e){const t=Vn(e);return t.isNeg()&&xl("division-by-zero","mod"),uo(Vn(this).umod(t))}pow(e){const t=Vn(e);return t.isNeg()&&xl("negative-power","pow"),uo(Vn(this).pow(t))}and(e){const t=Vn(e);return(this.isNegative()||t.isNeg())&&xl("unbound-bitwise-result","and"),uo(Vn(this).and(t))}or(e){const t=Vn(e);return(this.isNegative()||t.isNeg())&&xl("unbound-bitwise-result","or"),uo(Vn(this).or(t))}xor(e){const t=Vn(e);return(this.isNegative()||t.isNeg())&&xl("unbound-bitwise-result","xor"),uo(Vn(this).xor(t))}mask(e){return(this.isNegative()||e<0)&&xl("negative-width","mask"),uo(Vn(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&xl("negative-width","shl"),uo(Vn(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&xl("negative-width","shr"),uo(Vn(this).shrn(e))}eq(e){return Vn(this).eq(Vn(e))}lt(e){return Vn(this).lt(Vn(e))}lte(e){return Vn(this).lte(Vn(e))}gt(e){return Vn(this).gt(Vn(e))}gte(e){return Vn(this).gte(Vn(e))}isNegative(){return this._hex[0]==="-"}isZero(){return Vn(this).isZero()}toNumber(){try{return Vn(this).toNumber()}catch{xl("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return rh.throwError("this platform does not support BigInt",Le.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?s5||(s5=!0,rh.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?rh.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",Le.errors.UNEXPECTED_ARGUMENT,{}):rh.throwError("BigNumber.toString does not accept parameters",Le.errors.UNEXPECTED_ARGUMENT,{})),Vn(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof st)return e;if(typeof e=="string")return e.match(/^-?0x[0-9a-f]+$/i)?new st(jN,o1(e)):e.match(/^-?[0-9]+$/)?new st(jN,o1(new oE(e))):rh.throwArgumentError("invalid BigNumber string","value",e);if(typeof e=="number")return e%1&&xl("underflow","BigNumber.from",e),(e>=r5||e<=-r5)&&xl("overflow","BigNumber.from",e),st.from(String(e));const t=e;if(typeof t=="bigint")return st.from(t.toString());if(Gg(t))return st.from(ot(t));if(t)if(t.toHexString){const r=t.toHexString();if(typeof r=="string")return st.from(r)}else{let r=t._hex;if(r==null&&t.type==="BigNumber"&&(r=t.hex),typeof r=="string"&&(lr(r)||r[0]==="-"&&lr(r.substring(1))))return st.from(r)}return rh.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!!(e&&e._isBigNumber)}}function o1(n){if(typeof n!="string")return o1(n.toString(16));if(n[0]==="-")return n=n.substring(1),n[0]==="-"&&rh.throwArgumentError("invalid hex","value",n),n=o1(n),n==="0x00"?n:"-"+n;if(n.substring(0,2)!=="0x"&&(n="0x"+n),n==="0x")return"0x00";for(n.length%2&&(n="0x0"+n.substring(2));n.length>4&&n.substring(0,4)==="0x00";)n="0x"+n.substring(4);return n}function uo(n){return st.from(o1(n))}function Vn(n){const e=st.from(n).toHexString();return e[0]==="-"?new oE("-"+e.substring(3),16):new oE(e.substring(2),16)}function xl(n,e,t){const r={fault:n,operation:e};return t!=null&&(r.value=t),rh.throwError(n,Le.errors.NUMERIC_FAULT,r)}function Npe(n){return new oE(n,36).toString(16)}const Ja=new Le(vV),Vy={},_V=st.from(0),wV=st.from(-1);function EV(n,e,t,r){const s={fault:e,operation:t};return r!==void 0&&(s.value=r),Ja.throwError(n,Le.errors.NUMERIC_FAULT,s)}let Uy="0";for(;Uy.length<256;)Uy+=Uy;function Y4(n){if(typeof n!="number")try{n=st.from(n).toNumber()}catch{}return typeof n=="number"&&n>=0&&n<=256&&!(n%1)?"1"+Uy.substring(0,n):Ja.throwArgumentError("invalid decimal size","decimals",n)}function Mw(n,e){e==null&&(e=0);const t=Y4(e);n=st.from(n);const r=n.lt(_V);r&&(n=n.mul(wV));let s=n.mod(t).toString();for(;s.length<t.length-1;)s="0"+s;s=s.match(/^([0-9]*[1-9]|0)(0*)/)[1];const i=n.div(t).toString();return t.length===1?n=i:n=i+"."+s,r&&(n="-"+n),n}function nh(n,e){e==null&&(e=0);const t=Y4(e);(typeof n!="string"||!n.match(/^-?[0-9.]+$/))&&Ja.throwArgumentError("invalid decimal value","value",n);const r=n.substring(0,1)==="-";r&&(n=n.substring(1)),n==="."&&Ja.throwArgumentError("missing value","value",n);const s=n.split(".");s.length>2&&Ja.throwArgumentError("too many decimal points","value",n);let i=s[0],a=s[1];for(i||(i="0"),a||(a="0");a[a.length-1]==="0";)a=a.substring(0,a.length-1);for(a.length>t.length-1&&EV("fractional component exceeds decimals","underflow","parseFixed"),a===""&&(a="0");a.length<t.length-1;)a+="0";const o=st.from(i),l=st.from(a);let c=o.mul(t).add(l);return r&&(c=c.mul(wV)),c}class J0{constructor(e,t,r,s){e!==Vy&&Ja.throwError("cannot use FixedFormat constructor; use FixedFormat.from",Le.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=t,this.width=r,this.decimals=s,this.name=(t?"":"u")+"fixed"+String(r)+"x"+String(s),this._multiplier=Y4(s),Object.freeze(this)}static from(e){if(e instanceof J0)return e;typeof e=="number"&&(e=`fixed128x${e}`);let t=!0,r=128,s=18;if(typeof e=="string"){if(e!=="fixed")if(e==="ufixed")t=!1;else{const i=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);i||Ja.throwArgumentError("invalid fixed format","format",e),t=i[1]!=="u",r=parseInt(i[2]),s=parseInt(i[3])}}else if(e){const i=(a,o,l)=>e[a]==null?l:(typeof e[a]!==o&&Ja.throwArgumentError("invalid fixed format ("+a+" not "+o+")","format."+a,e[a]),e[a]);t=i("signed","boolean",t),r=i("width","number",r),s=i("decimals","number",s)}return r%8&&Ja.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",r),s>80&&Ja.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",s),new J0(Vy,t,r,s)}}class Hi{constructor(e,t,r,s){e!==Vy&&Ja.throwError("cannot use FixedNumber constructor; use FixedNumber.from",Le.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=s,this._hex=t,this._value=r,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(e){this.format.name!==e.format.name&&Ja.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",e)}addUnsafe(e){this._checkFormat(e);const t=nh(this._value,this.format.decimals),r=nh(e._value,e.format.decimals);return Hi.fromValue(t.add(r),this.format.decimals,this.format)}subUnsafe(e){this._checkFormat(e);const t=nh(this._value,this.format.decimals),r=nh(e._value,e.format.decimals);return Hi.fromValue(t.sub(r),this.format.decimals,this.format)}mulUnsafe(e){this._checkFormat(e);const t=nh(this._value,this.format.decimals),r=nh(e._value,e.format.decimals);return Hi.fromValue(t.mul(r).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(e){this._checkFormat(e);const t=nh(this._value,this.format.decimals),r=nh(e._value,e.format.decimals);return Hi.fromValue(t.mul(this.format._multiplier).div(r),this.format.decimals,this.format)}floor(){const e=this.toString().split(".");e.length===1&&e.push("0");let t=Hi.from(e[0],this.format);const r=!e[1].match(/^(0*)$/);return this.isNegative()&&r&&(t=t.subUnsafe(i5.toFormat(t.format))),t}ceiling(){const e=this.toString().split(".");e.length===1&&e.push("0");let t=Hi.from(e[0],this.format);const r=!e[1].match(/^(0*)$/);return!this.isNegative()&&r&&(t=t.addUnsafe(i5.toFormat(t.format))),t}round(e){e==null&&(e=0);const t=this.toString().split(".");if(t.length===1&&t.push("0"),(e<0||e>80||e%1)&&Ja.throwArgumentError("invalid decimal count","decimals",e),t[1].length<=e)return this;const r=Hi.from("1"+Uy.substring(0,e),this.format),s=kpe.toFormat(this.format);return this.mulUnsafe(r).addUnsafe(s).floor().divUnsafe(r)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(e){if(e==null)return this._hex;e%8&&Ja.throwArgumentError("invalid byte width","width",e);const t=st.from(this._hex).fromTwos(this.format.width).toTwos(e).toHexString();return Gr(t,e/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return Hi.fromString(this._value,e)}static fromValue(e,t,r){return r==null&&t!=null&&!Ape(t)&&(r=t,t=null),t==null&&(t=0),r==null&&(r="fixed"),Hi.fromString(Mw(e,t),J0.from(r))}static fromString(e,t){t==null&&(t="fixed");const r=J0.from(t),s=nh(e,r.decimals);!r.signed&&s.lt(_V)&&EV("unsigned value cannot be negative","overflow","value",e);let i=null;r.signed?i=s.toTwos(r.width).toHexString():(i=s.toHexString(),i=Gr(i,r.width/8));const a=Mw(s,r.decimals);return new Hi(Vy,i,a,r)}static fromBytes(e,t){t==null&&(t="fixed");const r=J0.from(t);if(rt(e).length>r.width/8)throw new Error("overflow");let s=st.from(e);r.signed&&(s=s.fromTwos(r.width));const i=s.toTwos((r.signed?0:1)+r.width).toHexString(),a=Mw(s,r.decimals);return new Hi(Vy,i,a,r)}static from(e,t){if(typeof e=="string")return Hi.fromString(e,t);if(Gg(e))return Hi.fromBytes(e,t);try{return Hi.fromValue(e,0,t)}catch(r){if(r.code!==Le.errors.INVALID_ARGUMENT)throw r}return Ja.throwArgumentError("invalid FixedNumber value","value",e)}static isFixedNumber(e){return!!(e&&e._isFixedNumber)}}const i5=Hi.from(1),kpe=Hi.from("0.5"),Ipe="properties/5.8.0";var Rpe=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const lE=new Le(Ipe);function Ke(n,e,t){Object.defineProperty(n,e,{enumerable:!0,value:t,writable:!1})}function Qc(n,e){for(let t=0;t<32;t++){if(n[e])return n[e];if(!n.prototype||typeof n.prototype!="object")break;n=Object.getPrototypeOf(n.prototype).constructor}return null}function Ls(n){return Rpe(this,void 0,void 0,function*(){const e=Object.keys(n).map(r=>{const s=n[r];return Promise.resolve(s).then(i=>({key:r,value:i}))});return(yield Promise.all(e)).reduce((r,s)=>(r[s.key]=s.value,r),{})})}function SV(n,e){(!n||typeof n!="object")&&lE.throwArgumentError("invalid object","object",n),Object.keys(n).forEach(t=>{e[t]||lE.throwArgumentError("invalid object key - "+t,"transaction:"+t,n)})}function pi(n){const e={};for(const t in n)e[t]=n[t];return e}const Dpe={bigint:!0,boolean:!0,function:!0,number:!0,string:!0};function TV(n){if(n==null||Dpe[typeof n])return!0;if(Array.isArray(n)||typeof n=="object"){if(!Object.isFrozen(n))return!1;const e=Object.keys(n);for(let t=0;t<e.length;t++){let r=null;try{r=n[e[t]]}catch{continue}if(!TV(r))return!1}return!0}return lE.throwArgumentError(`Cannot deepCopy ${typeof n}`,"object",n)}function $pe(n){if(TV(n))return n;if(Array.isArray(n))return Object.freeze(n.map(e=>Ah(e)));if(typeof n=="object"){const e={};for(const t in n){const r=n[t];r!==void 0&&Ke(e,t,Ah(r))}return e}return lE.throwArgumentError(`Cannot deepCopy ${typeof n}`,"object",n)}function Ah(n){return $pe(n)}class Nm{constructor(e){for(const t in e)this[t]=Ah(e[t])}}const nb="abi/5.8.0",Zn=new Le(nb),Jp={};let a5={calldata:!0,memory:!0,storage:!0},Lpe={calldata:!0,memory:!0};function Q_(n,e){if(n==="bytes"||n==="string"){if(a5[e])return!0}else if(n==="address"){if(e==="payable")return!0}else if((n.indexOf("[")>=0||n==="tuple")&&Lpe[e])return!0;return(a5[e]||e==="payable")&&Zn.throwArgumentError("invalid modifier","name",e),!1}function Ppe(n,e){let t=n;function r(o){Zn.throwArgumentError(`unexpected character at position ${o}`,"param",n)}n=n.replace(/\s/g," ");function s(o){let l={type:"",name:"",parent:o,state:{allowType:!0}};return e&&(l.indexed=!1),l}let i={type:"",name:"",state:{allowType:!0}},a=i;for(let o=0;o<n.length;o++){let l=n[o];switch(l){case"(":a.state.allowType&&a.type===""?a.type="tuple":a.state.allowParams||r(o),a.state.allowType=!1,a.type=L0(a.type),a.components=[s(a)],a=a.components[0];break;case")":delete a.state,a.name==="indexed"&&(e||r(o),a.indexed=!0,a.name=""),Q_(a.type,a.name)&&(a.name=""),a.type=L0(a.type);let c=a;a=a.parent,a||r(o),delete c.parent,a.state.allowParams=!1,a.state.allowName=!0,a.state.allowArray=!0;break;case",":delete a.state,a.name==="indexed"&&(e||r(o),a.indexed=!0,a.name=""),Q_(a.type,a.name)&&(a.name=""),a.type=L0(a.type);let u=s(a.parent);a.parent.components.push(u),delete a.parent,a=u;break;case" ":a.state.allowType&&a.type!==""&&(a.type=L0(a.type),delete a.state.allowType,a.state.allowName=!0,a.state.allowParams=!0),a.state.allowName&&a.name!==""&&(a.name==="indexed"?(e||r(o),a.indexed&&r(o),a.indexed=!0,a.name=""):Q_(a.type,a.name)?a.name="":a.state.allowName=!1);break;case"[":a.state.allowArray||r(o),a.type+=l,a.state.allowArray=!1,a.state.allowName=!1,a.state.readArray=!0;break;case"]":a.state.readArray||r(o),a.type+=l,a.state.readArray=!1,a.state.allowArray=!0,a.state.allowName=!0;break;default:a.state.allowType?(a.type+=l,a.state.allowParams=!0,a.state.allowArray=!0):a.state.allowName?(a.name+=l,delete a.state.allowArray):a.state.readArray?a.type+=l:r(o)}}return a.parent&&Zn.throwArgumentError("unexpected eof","param",n),delete i.state,a.name==="indexed"?(e||r(t.length-7),a.indexed&&r(t.length-7),a.indexed=!0,a.name=""):Q_(a.type,a.name)&&(a.name=""),i.type=L0(i.type),i}function Fw(n,e){for(let t in e)Ke(n,t,e[t])}const pr=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),Ope=new RegExp(/^(.*)\[([0-9]*)\]$/);class $i{constructor(e,t){e!==Jp&&Zn.throwError("use fromString",Le.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),Fw(this,t);let r=this.type.match(Ope);r?Fw(this,{arrayLength:parseInt(r[2]||"-1"),arrayChildren:$i.fromObject({type:r[1],components:this.components}),baseType:"array"}):Fw(this,{arrayLength:null,arrayChildren:null,baseType:this.components!=null?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}format(e){if(e||(e=pr.sighash),pr[e]||Zn.throwArgumentError("invalid format type","format",e),e===pr.json){let r={type:this.baseType==="tuple"?"tuple":this.type,name:this.name||void 0};return typeof this.indexed=="boolean"&&(r.indexed=this.indexed),this.components&&(r.components=this.components.map(s=>JSON.parse(s.format(e)))),JSON.stringify(r)}let t="";return this.baseType==="array"?(t+=this.arrayChildren.format(e),t+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):this.baseType==="tuple"?(e!==pr.sighash&&(t+=this.type),t+="("+this.components.map(r=>r.format(e)).join(e===pr.full?", ":",")+")"):t+=this.type,e!==pr.sighash&&(this.indexed===!0&&(t+=" indexed"),e===pr.full&&this.name&&(t+=" "+this.name)),t}static from(e,t){return typeof e=="string"?$i.fromString(e,t):$i.fromObject(e)}static fromObject(e){return $i.isParamType(e)?e:new $i(Jp,{name:e.name||null,type:L0(e.type),indexed:e.indexed==null?null:!!e.indexed,components:e.components?e.components.map($i.fromObject):null})}static fromString(e,t){function r(s){return $i.fromObject({name:s.name,type:s.type,indexed:s.indexed,components:s.components})}return r(Ppe(e,!!t))}static isParamType(e){return!!(e!=null&&e._isParamType)}}function l1(n,e){return Fpe(n).map(t=>$i.fromString(t,e))}class ph{constructor(e,t){e!==Jp&&Zn.throwError("use a static from method",Le.errors.UNSUPPORTED_OPERATION,{operation:"new Fragment()"}),Fw(this,t),this._isFragment=!0,Object.freeze(this)}static from(e){return ph.isFragment(e)?e:typeof e=="string"?ph.fromString(e):ph.fromObject(e)}static fromObject(e){if(ph.isFragment(e))return e;switch(e.type){case"function":return Yc.fromObject(e);case"event":return ch.fromObject(e);case"constructor":return Xc.fromObject(e);case"error":return Fd.fromObject(e);case"fallback":case"receive":return null}return Zn.throwArgumentError("invalid fragment object","value",e)}static fromString(e){return e=e.replace(/\s/g," "),e=e.replace(/\(/g," (").replace(/\)/g,") ").replace(/\s+/g," "),e=e.trim(),e.split(" ")[0]==="event"?ch.fromString(e.substring(5).trim()):e.split(" ")[0]==="function"?Yc.fromString(e.substring(8).trim()):e.split("(")[0].trim()==="constructor"?Xc.fromString(e.trim()):e.split(" ")[0]==="error"?Fd.fromString(e.substring(5).trim()):Zn.throwArgumentError("unsupported fragment","value",e)}static isFragment(e){return!!(e&&e._isFragment)}}class ch extends ph{format(e){if(e||(e=pr.sighash),pr[e]||Zn.throwArgumentError("invalid format type","format",e),e===pr.json)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});let t="";return e!==pr.sighash&&(t+="event "),t+=this.name+"("+this.inputs.map(r=>r.format(e)).join(e===pr.full?", ":",")+") ",e!==pr.sighash&&this.anonymous&&(t+="anonymous "),t.trim()}static from(e){return typeof e=="string"?ch.fromString(e):ch.fromObject(e)}static fromObject(e){if(ch.isEventFragment(e))return e;e.type!=="event"&&Zn.throwArgumentError("invalid event object","value",e);const t={name:c1(e.name),anonymous:e.anonymous,inputs:e.inputs?e.inputs.map($i.fromObject):[],type:"event"};return new ch(Jp,t)}static fromString(e){let t=e.match(u1);t||Zn.throwArgumentError("invalid event string","value",e);let r=!1;return t[3].split(" ").forEach(s=>{switch(s.trim()){case"anonymous":r=!0;break;case"":break;default:Zn.warn("unknown modifier: "+s)}}),ch.fromObject({name:t[1].trim(),anonymous:r,inputs:l1(t[2],!0),type:"event"})}static isEventFragment(e){return e&&e._isFragment&&e.type==="event"}}function CV(n,e){e.gas=null;let t=n.split("@");return t.length!==1?(t.length>2&&Zn.throwArgumentError("invalid human-readable ABI signature","value",n),t[1].match(/^[0-9]+$/)||Zn.throwArgumentError("invalid human-readable ABI signature gas","value",n),e.gas=st.from(t[1]),t[0]):n}function AV(n,e){e.constant=!1,e.payable=!1,e.stateMutability="nonpayable",n.split(" ").forEach(t=>{switch(t.trim()){case"constant":e.constant=!0;break;case"payable":e.payable=!0,e.stateMutability="payable";break;case"nonpayable":e.payable=!1,e.stateMutability="nonpayable";break;case"pure":e.constant=!0,e.stateMutability="pure";break;case"view":e.constant=!0,e.stateMutability="view";break;case"external":case"public":case"":break;default:console.log("unknown modifier: "+t)}})}function NV(n){let e={constant:!1,payable:!0,stateMutability:"payable"};return n.stateMutability!=null?(e.stateMutability=n.stateMutability,e.constant=e.stateMutability==="view"||e.stateMutability==="pure",n.constant!=null&&!!n.constant!==e.constant&&Zn.throwArgumentError("cannot have constant function with mutability "+e.stateMutability,"value",n),e.payable=e.stateMutability==="payable",n.payable!=null&&!!n.payable!==e.payable&&Zn.throwArgumentError("cannot have payable function with mutability "+e.stateMutability,"value",n)):n.payable!=null?(e.payable=!!n.payable,n.constant==null&&!e.payable&&n.type!=="constructor"&&Zn.throwArgumentError("unable to determine stateMutability","value",n),e.constant=!!n.constant,e.constant?e.stateMutability="view":e.stateMutability=e.payable?"payable":"nonpayable",e.payable&&e.constant&&Zn.throwArgumentError("cannot have constant payable function","value",n)):n.constant!=null?(e.constant=!!n.constant,e.payable=!e.constant,e.stateMutability=e.constant?"view":"payable"):n.type!=="constructor"&&Zn.throwArgumentError("unable to determine stateMutability","value",n),e}class Xc extends ph{format(e){if(e||(e=pr.sighash),pr[e]||Zn.throwArgumentError("invalid format type","format",e),e===pr.json)return JSON.stringify({type:"constructor",stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});e===pr.sighash&&Zn.throwError("cannot format a constructor for sighash",Le.errors.UNSUPPORTED_OPERATION,{operation:"format(sighash)"});let t="constructor("+this.inputs.map(r=>r.format(e)).join(e===pr.full?", ":",")+") ";return this.stateMutability&&this.stateMutability!=="nonpayable"&&(t+=this.stateMutability+" "),t.trim()}static from(e){return typeof e=="string"?Xc.fromString(e):Xc.fromObject(e)}static fromObject(e){if(Xc.isConstructorFragment(e))return e;e.type!=="constructor"&&Zn.throwArgumentError("invalid constructor object","value",e);let t=NV(e);t.constant&&Zn.throwArgumentError("constructor cannot be constant","value",e);const r={name:null,type:e.type,inputs:e.inputs?e.inputs.map($i.fromObject):[],payable:t.payable,stateMutability:t.stateMutability,gas:e.gas?st.from(e.gas):null};return new Xc(Jp,r)}static fromString(e){let t={type:"constructor"};e=CV(e,t);let r=e.match(u1);return(!r||r[1].trim()!=="constructor")&&Zn.throwArgumentError("invalid constructor string","value",e),t.inputs=l1(r[2].trim(),!1),AV(r[3].trim(),t),Xc.fromObject(t)}static isConstructorFragment(e){return e&&e._isFragment&&e.type==="constructor"}}class Yc extends Xc{format(e){if(e||(e=pr.sighash),pr[e]||Zn.throwArgumentError("invalid format type","format",e),e===pr.json)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(r=>JSON.parse(r.format(e))),outputs:this.outputs.map(r=>JSON.parse(r.format(e)))});let t="";return e!==pr.sighash&&(t+="function "),t+=this.name+"("+this.inputs.map(r=>r.format(e)).join(e===pr.full?", ":",")+") ",e!==pr.sighash&&(this.stateMutability?this.stateMutability!=="nonpayable"&&(t+=this.stateMutability+" "):this.constant&&(t+="view "),this.outputs&&this.outputs.length&&(t+="returns ("+this.outputs.map(r=>r.format(e)).join(", ")+") "),this.gas!=null&&(t+="@"+this.gas.toString()+" ")),t.trim()}static from(e){return typeof e=="string"?Yc.fromString(e):Yc.fromObject(e)}static fromObject(e){if(Yc.isFunctionFragment(e))return e;e.type!=="function"&&Zn.throwArgumentError("invalid function object","value",e);let t=NV(e);const r={type:e.type,name:c1(e.name),constant:t.constant,inputs:e.inputs?e.inputs.map($i.fromObject):[],outputs:e.outputs?e.outputs.map($i.fromObject):[],payable:t.payable,stateMutability:t.stateMutability,gas:e.gas?st.from(e.gas):null};return new Yc(Jp,r)}static fromString(e){let t={type:"function"};e=CV(e,t);let r=e.split(" returns ");r.length>2&&Zn.throwArgumentError("invalid function string","value",e);let s=r[0].match(u1);if(s||Zn.throwArgumentError("invalid function signature","value",e),t.name=s[1].trim(),t.name&&c1(t.name),t.inputs=l1(s[2],!1),AV(s[3].trim(),t),r.length>1){let i=r[1].match(u1);(i[1].trim()!=""||i[3].trim()!="")&&Zn.throwArgumentError("unexpected tokens","value",e),t.outputs=l1(i[2],!1)}else t.outputs=[];return Yc.fromObject(t)}static isFunctionFragment(e){return e&&e._isFragment&&e.type==="function"}}function o5(n){const e=n.format();return(e==="Error(string)"||e==="Panic(uint256)")&&Zn.throwArgumentError(`cannot specify user defined ${e} error`,"fragment",n),n}class Fd extends ph{format(e){if(e||(e=pr.sighash),pr[e]||Zn.throwArgumentError("invalid format type","format",e),e===pr.json)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});let t="";return e!==pr.sighash&&(t+="error "),t+=this.name+"("+this.inputs.map(r=>r.format(e)).join(e===pr.full?", ":",")+") ",t.trim()}static from(e){return typeof e=="string"?Fd.fromString(e):Fd.fromObject(e)}static fromObject(e){if(Fd.isErrorFragment(e))return e;e.type!=="error"&&Zn.throwArgumentError("invalid error object","value",e);const t={type:e.type,name:c1(e.name),inputs:e.inputs?e.inputs.map($i.fromObject):[]};return o5(new Fd(Jp,t))}static fromString(e){let t={type:"error"},r=e.match(u1);return r||Zn.throwArgumentError("invalid error signature","value",e),t.name=r[1].trim(),t.name&&c1(t.name),t.inputs=l1(r[2],!1),o5(Fd.fromObject(t))}static isErrorFragment(e){return e&&e._isFragment&&e.type==="error"}}function L0(n){return n.match(/^uint($|[^1-9])/)?n="uint256"+n.substring(4):n.match(/^int($|[^1-9])/)&&(n="int256"+n.substring(3)),n}const Mpe=new RegExp("^[a-zA-Z$_][a-zA-Z0-9$_]*$");function c1(n){return(!n||!n.match(Mpe))&&Zn.throwArgumentError(`invalid identifier "${n}"`,"value",n),n}const u1=new RegExp("^([^)(]*)\\((.*)\\)([^)(]*)$");function Fpe(n){n=n.trim();let e=[],t="",r=0;for(let s=0;s<n.length;s++){let i=n[s];i===","&&r===0?(e.push(t),t=""):(t+=i,i==="("?r++:i===")"&&(r--,r===-1&&Zn.throwArgumentError("unbalanced parenthesis","value",n)))}return t&&e.push(t),e}const Z4=new Le(nb);function Bpe(n){const e=[],t=function(r,s){if(Array.isArray(s))for(let i in s){const a=r.slice();a.push(i);try{t(a,s[i])}catch(o){e.push({path:a,error:o})}}};return t([],n),e}class Lh{constructor(e,t,r,s){this.name=e,this.type=t,this.localName=r,this.dynamic=s}_throwError(e,t){Z4.throwArgumentError(e,this.localName,t)}}class yI{constructor(e){Ke(this,"wordSize",e||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(e)}get data(){return xo(this._data)}get length(){return this._dataLength}_writeData(e){return this._data.push(e),this._dataLength+=e.length,e.length}appendWriter(e){return this._writeData(zs(e._data))}writeBytes(e){let t=rt(e);const r=t.length%this.wordSize;return r&&(t=zs([t,this._padding.slice(r)])),this._writeData(t)}_getValue(e){let t=rt(st.from(e));return t.length>this.wordSize&&Z4.throwError("value out-of-bounds",Le.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:t.length}),t.length%this.wordSize&&(t=zs([this._padding.slice(t.length%this.wordSize),t])),t}writeValue(e){return this._writeData(this._getValue(e))}writeUpdatableValue(){const e=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,t=>{this._data[e]=this._getValue(t)}}}class cE{constructor(e,t,r,s){Ke(this,"_data",rt(e)),Ke(this,"wordSize",t||32),Ke(this,"_coerceFunc",r),Ke(this,"allowLoose",s),this._offset=0}get data(){return ot(this._data)}get consumed(){return this._offset}static coerce(e,t){let r=e.match("^u?int([0-9]+)$");return r&&parseInt(r[1])<=48&&(t=t.toNumber()),t}coerce(e,t){return this._coerceFunc?this._coerceFunc(e,t):cE.coerce(e,t)}_peekBytes(e,t,r){let s=Math.ceil(t/this.wordSize)*this.wordSize;return this._offset+s>this._data.length&&(this.allowLoose&&r&&this._offset+t<=this._data.length?s=t:Z4.throwError("data out-of-bounds",Le.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+s})),this._data.slice(this._offset,this._offset+s)}subReader(e){return new cE(this._data.slice(this._offset+e),this.wordSize,this._coerceFunc,this.allowLoose)}readBytes(e,t){let r=this._peekBytes(0,e,!!t);return this._offset+=r.length,r.slice(0,e)}readValue(){return st.from(this.readBytes(this.wordSize))}}var VN={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */var l5;function zpe(){return l5||(l5=1,(function(n){(function(){var e="input is invalid type",t="finalize already called",r=typeof window=="object",s=r?window:{};s.JS_SHA3_NO_WINDOW&&(r=!1);var i=!r&&typeof self=="object",a=!s.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;a?s=bw:i&&(s=self);var o=!s.JS_SHA3_NO_COMMON_JS&&!0&&n.exports,l=!s.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",c="0123456789abcdef".split(""),u=[31,7936,2031616,520093696],d=[4,1024,262144,67108864],p=[1,256,65536,16777216],x=[6,1536,393216,100663296],y=[0,8,16,24],v=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],b=[224,256,384,512],S=[128,256],T=["hex","buffer","arrayBuffer","array","digest"],C={128:168,256:136};(s.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(W){return Object.prototype.toString.call(W)==="[object Array]"}),l&&(s.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(W){return typeof W=="object"&&W.buffer&&W.buffer.constructor===ArrayBuffer});for(var I=function(W,ae,pe){return function(de){return new D(W,ae,W).update(de)[pe]()}},$=function(W,ae,pe){return function(de,ve){return new D(W,ae,ve).update(de)[pe]()}},q=function(W,ae,pe){return function(de,ve,Ve,ze){return N["cshake"+W].update(de,ve,Ve,ze)[pe]()}},U=function(W,ae,pe){return function(de,ve,Ve,ze){return N["kmac"+W].update(de,ve,Ve,ze)[pe]()}},F=function(W,ae,pe,de){for(var ve=0;ve<T.length;++ve){var Ve=T[ve];W[Ve]=ae(pe,de,Ve)}return W},G=function(W,ae){var pe=I(W,ae,"hex");return pe.create=function(){return new D(W,ae,W)},pe.update=function(de){return pe.create().update(de)},F(pe,I,W,ae)},V=function(W,ae){var pe=$(W,ae,"hex");return pe.create=function(de){return new D(W,ae,de)},pe.update=function(de,ve){return pe.create(ve).update(de)},F(pe,$,W,ae)},O=function(W,ae){var pe=C[W],de=q(W,ae,"hex");return de.create=function(ve,Ve,ze){return!Ve&&!ze?N["shake"+W].create(ve):new D(W,ae,ve).bytepad([Ve,ze],pe)},de.update=function(ve,Ve,ze,Ge){return de.create(Ve,ze,Ge).update(ve)},F(de,q,W,ae)},K=function(W,ae){var pe=C[W],de=U(W,ae,"hex");return de.create=function(ve,Ve,ze){return new X(W,ae,Ve).bytepad(["KMAC",ze],pe).bytepad([ve],pe)},de.update=function(ve,Ve,ze,Ge){return de.create(ve,ze,Ge).update(Ve)},F(de,U,W,ae)},P=[{name:"keccak",padding:p,bits:b,createMethod:G},{name:"sha3",padding:x,bits:b,createMethod:G},{name:"shake",padding:u,bits:S,createMethod:V},{name:"cshake",padding:d,bits:S,createMethod:O},{name:"kmac",padding:d,bits:S,createMethod:K}],N={},M=[],B=0;B<P.length;++B)for(var Y=P[B],Z=Y.bits,ne=0;ne<Z.length;++ne){var Q=Y.name+"_"+Z[ne];if(M.push(Q),N[Q]=Y.createMethod(Z[ne],Y.padding),Y.name!=="sha3"){var z=Y.name+Z[ne];M.push(z),N[z]=N[Q]}}function D(W,ae,pe){this.blocks=[],this.s=[],this.padding=ae,this.outputBits=pe,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(W<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=pe>>5,this.extraBytes=(pe&31)>>3;for(var de=0;de<50;++de)this.s[de]=0}D.prototype.update=function(W){if(this.finalized)throw new Error(t);var ae,pe=typeof W;if(pe!=="string"){if(pe==="object"){if(W===null)throw new Error(e);if(l&&W.constructor===ArrayBuffer)W=new Uint8Array(W);else if(!Array.isArray(W)&&(!l||!ArrayBuffer.isView(W)))throw new Error(e)}else throw new Error(e);ae=!0}for(var de=this.blocks,ve=this.byteCount,Ve=W.length,ze=this.blockCount,Ge=0,at=this.s,We,nt;Ge<Ve;){if(this.reset)for(this.reset=!1,de[0]=this.block,We=1;We<ze+1;++We)de[We]=0;if(ae)for(We=this.start;Ge<Ve&&We<ve;++Ge)de[We>>2]|=W[Ge]<<y[We++&3];else for(We=this.start;Ge<Ve&&We<ve;++Ge)nt=W.charCodeAt(Ge),nt<128?de[We>>2]|=nt<<y[We++&3]:nt<2048?(de[We>>2]|=(192|nt>>6)<<y[We++&3],de[We>>2]|=(128|nt&63)<<y[We++&3]):nt<55296||nt>=57344?(de[We>>2]|=(224|nt>>12)<<y[We++&3],de[We>>2]|=(128|nt>>6&63)<<y[We++&3],de[We>>2]|=(128|nt&63)<<y[We++&3]):(nt=65536+((nt&1023)<<10|W.charCodeAt(++Ge)&1023),de[We>>2]|=(240|nt>>18)<<y[We++&3],de[We>>2]|=(128|nt>>12&63)<<y[We++&3],de[We>>2]|=(128|nt>>6&63)<<y[We++&3],de[We>>2]|=(128|nt&63)<<y[We++&3]);if(this.lastByteIndex=We,We>=ve){for(this.start=We-ve,this.block=de[ze],We=0;We<ze;++We)at[We]^=de[We];re(at),this.reset=!0}else this.start=We}return this},D.prototype.encode=function(W,ae){var pe=W&255,de=1,ve=[pe];for(W=W>>8,pe=W&255;pe>0;)ve.unshift(pe),W=W>>8,pe=W&255,++de;return ae?ve.push(de):ve.unshift(de),this.update(ve),ve.length},D.prototype.encodeString=function(W){var ae,pe=typeof W;if(pe!=="string"){if(pe==="object"){if(W===null)throw new Error(e);if(l&&W.constructor===ArrayBuffer)W=new Uint8Array(W);else if(!Array.isArray(W)&&(!l||!ArrayBuffer.isView(W)))throw new Error(e)}else throw new Error(e);ae=!0}var de=0,ve=W.length;if(ae)de=ve;else for(var Ve=0;Ve<W.length;++Ve){var ze=W.charCodeAt(Ve);ze<128?de+=1:ze<2048?de+=2:ze<55296||ze>=57344?de+=3:(ze=65536+((ze&1023)<<10|W.charCodeAt(++Ve)&1023),de+=4)}return de+=this.encode(de*8),this.update(W),de},D.prototype.bytepad=function(W,ae){for(var pe=this.encode(ae),de=0;de<W.length;++de)pe+=this.encodeString(W[de]);var ve=ae-pe%ae,Ve=[];return Ve.length=ve,this.update(Ve),this},D.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var W=this.blocks,ae=this.lastByteIndex,pe=this.blockCount,de=this.s;if(W[ae>>2]|=this.padding[ae&3],this.lastByteIndex===this.byteCount)for(W[0]=W[pe],ae=1;ae<pe+1;++ae)W[ae]=0;for(W[pe-1]|=2147483648,ae=0;ae<pe;++ae)de[ae]^=W[ae];re(de)}},D.prototype.toString=D.prototype.hex=function(){this.finalize();for(var W=this.blockCount,ae=this.s,pe=this.outputBlocks,de=this.extraBytes,ve=0,Ve=0,ze="",Ge;Ve<pe;){for(ve=0;ve<W&&Ve<pe;++ve,++Ve)Ge=ae[ve],ze+=c[Ge>>4&15]+c[Ge&15]+c[Ge>>12&15]+c[Ge>>8&15]+c[Ge>>20&15]+c[Ge>>16&15]+c[Ge>>28&15]+c[Ge>>24&15];Ve%W===0&&(re(ae),ve=0)}return de&&(Ge=ae[ve],ze+=c[Ge>>4&15]+c[Ge&15],de>1&&(ze+=c[Ge>>12&15]+c[Ge>>8&15]),de>2&&(ze+=c[Ge>>20&15]+c[Ge>>16&15])),ze},D.prototype.arrayBuffer=function(){this.finalize();var W=this.blockCount,ae=this.s,pe=this.outputBlocks,de=this.extraBytes,ve=0,Ve=0,ze=this.outputBits>>3,Ge;de?Ge=new ArrayBuffer(pe+1<<2):Ge=new ArrayBuffer(ze);for(var at=new Uint32Array(Ge);Ve<pe;){for(ve=0;ve<W&&Ve<pe;++ve,++Ve)at[Ve]=ae[ve];Ve%W===0&&re(ae)}return de&&(at[ve]=ae[ve],Ge=Ge.slice(0,ze)),Ge},D.prototype.buffer=D.prototype.arrayBuffer,D.prototype.digest=D.prototype.array=function(){this.finalize();for(var W=this.blockCount,ae=this.s,pe=this.outputBlocks,de=this.extraBytes,ve=0,Ve=0,ze=[],Ge,at;Ve<pe;){for(ve=0;ve<W&&Ve<pe;++ve,++Ve)Ge=Ve<<2,at=ae[ve],ze[Ge]=at&255,ze[Ge+1]=at>>8&255,ze[Ge+2]=at>>16&255,ze[Ge+3]=at>>24&255;Ve%W===0&&re(ae)}return de&&(Ge=Ve<<2,at=ae[ve],ze[Ge]=at&255,de>1&&(ze[Ge+1]=at>>8&255),de>2&&(ze[Ge+2]=at>>16&255)),ze};function X(W,ae,pe){D.call(this,W,ae,pe)}X.prototype=new D,X.prototype.finalize=function(){return this.encode(this.outputBits,!0),D.prototype.finalize.call(this)};var re=function(W){var ae,pe,de,ve,Ve,ze,Ge,at,We,nt,Nt,ct,xt,en,ht,St,an,Ot,Mt,Wn,It,Tt,nr,Bt,Cn,Br,xn,tn,Wr,rn,hn,es,Mn,qn,ms,Fn,Ft,oa,Rn,Dn,yi,Kn,An,bi,yn,zt,pn,nn,Zt,dt,cr,bn,ri,Xn,vn,ks,mn,Bn,ur,La,vi,Is,gs;for(de=0;de<48;de+=2)ve=W[0]^W[10]^W[20]^W[30]^W[40],Ve=W[1]^W[11]^W[21]^W[31]^W[41],ze=W[2]^W[12]^W[22]^W[32]^W[42],Ge=W[3]^W[13]^W[23]^W[33]^W[43],at=W[4]^W[14]^W[24]^W[34]^W[44],We=W[5]^W[15]^W[25]^W[35]^W[45],nt=W[6]^W[16]^W[26]^W[36]^W[46],Nt=W[7]^W[17]^W[27]^W[37]^W[47],ct=W[8]^W[18]^W[28]^W[38]^W[48],xt=W[9]^W[19]^W[29]^W[39]^W[49],ae=ct^(ze<<1|Ge>>>31),pe=xt^(Ge<<1|ze>>>31),W[0]^=ae,W[1]^=pe,W[10]^=ae,W[11]^=pe,W[20]^=ae,W[21]^=pe,W[30]^=ae,W[31]^=pe,W[40]^=ae,W[41]^=pe,ae=ve^(at<<1|We>>>31),pe=Ve^(We<<1|at>>>31),W[2]^=ae,W[3]^=pe,W[12]^=ae,W[13]^=pe,W[22]^=ae,W[23]^=pe,W[32]^=ae,W[33]^=pe,W[42]^=ae,W[43]^=pe,ae=ze^(nt<<1|Nt>>>31),pe=Ge^(Nt<<1|nt>>>31),W[4]^=ae,W[5]^=pe,W[14]^=ae,W[15]^=pe,W[24]^=ae,W[25]^=pe,W[34]^=ae,W[35]^=pe,W[44]^=ae,W[45]^=pe,ae=at^(ct<<1|xt>>>31),pe=We^(xt<<1|ct>>>31),W[6]^=ae,W[7]^=pe,W[16]^=ae,W[17]^=pe,W[26]^=ae,W[27]^=pe,W[36]^=ae,W[37]^=pe,W[46]^=ae,W[47]^=pe,ae=nt^(ve<<1|Ve>>>31),pe=Nt^(Ve<<1|ve>>>31),W[8]^=ae,W[9]^=pe,W[18]^=ae,W[19]^=pe,W[28]^=ae,W[29]^=pe,W[38]^=ae,W[39]^=pe,W[48]^=ae,W[49]^=pe,en=W[0],ht=W[1],zt=W[11]<<4|W[10]>>>28,pn=W[10]<<4|W[11]>>>28,tn=W[20]<<3|W[21]>>>29,Wr=W[21]<<3|W[20]>>>29,La=W[31]<<9|W[30]>>>23,vi=W[30]<<9|W[31]>>>23,Kn=W[40]<<18|W[41]>>>14,An=W[41]<<18|W[40]>>>14,qn=W[2]<<1|W[3]>>>31,ms=W[3]<<1|W[2]>>>31,St=W[13]<<12|W[12]>>>20,an=W[12]<<12|W[13]>>>20,nn=W[22]<<10|W[23]>>>22,Zt=W[23]<<10|W[22]>>>22,rn=W[33]<<13|W[32]>>>19,hn=W[32]<<13|W[33]>>>19,Is=W[42]<<2|W[43]>>>30,gs=W[43]<<2|W[42]>>>30,Xn=W[5]<<30|W[4]>>>2,vn=W[4]<<30|W[5]>>>2,Fn=W[14]<<6|W[15]>>>26,Ft=W[15]<<6|W[14]>>>26,Ot=W[25]<<11|W[24]>>>21,Mt=W[24]<<11|W[25]>>>21,dt=W[34]<<15|W[35]>>>17,cr=W[35]<<15|W[34]>>>17,es=W[45]<<29|W[44]>>>3,Mn=W[44]<<29|W[45]>>>3,Bt=W[6]<<28|W[7]>>>4,Cn=W[7]<<28|W[6]>>>4,ks=W[17]<<23|W[16]>>>9,mn=W[16]<<23|W[17]>>>9,oa=W[26]<<25|W[27]>>>7,Rn=W[27]<<25|W[26]>>>7,Wn=W[36]<<21|W[37]>>>11,It=W[37]<<21|W[36]>>>11,bn=W[47]<<24|W[46]>>>8,ri=W[46]<<24|W[47]>>>8,bi=W[8]<<27|W[9]>>>5,yn=W[9]<<27|W[8]>>>5,Br=W[18]<<20|W[19]>>>12,xn=W[19]<<20|W[18]>>>12,Bn=W[29]<<7|W[28]>>>25,ur=W[28]<<7|W[29]>>>25,Dn=W[38]<<8|W[39]>>>24,yi=W[39]<<8|W[38]>>>24,Tt=W[48]<<14|W[49]>>>18,nr=W[49]<<14|W[48]>>>18,W[0]=en^~St&Ot,W[1]=ht^~an&Mt,W[10]=Bt^~Br&tn,W[11]=Cn^~xn&Wr,W[20]=qn^~Fn&oa,W[21]=ms^~Ft&Rn,W[30]=bi^~zt&nn,W[31]=yn^~pn&Zt,W[40]=Xn^~ks&Bn,W[41]=vn^~mn&ur,W[2]=St^~Ot&Wn,W[3]=an^~Mt&It,W[12]=Br^~tn&rn,W[13]=xn^~Wr&hn,W[22]=Fn^~oa&Dn,W[23]=Ft^~Rn&yi,W[32]=zt^~nn&dt,W[33]=pn^~Zt&cr,W[42]=ks^~Bn&La,W[43]=mn^~ur&vi,W[4]=Ot^~Wn&Tt,W[5]=Mt^~It&nr,W[14]=tn^~rn&es,W[15]=Wr^~hn&Mn,W[24]=oa^~Dn&Kn,W[25]=Rn^~yi&An,W[34]=nn^~dt&bn,W[35]=Zt^~cr&ri,W[44]=Bn^~La&Is,W[45]=ur^~vi&gs,W[6]=Wn^~Tt&en,W[7]=It^~nr&ht,W[16]=rn^~es&Bt,W[17]=hn^~Mn&Cn,W[26]=Dn^~Kn&qn,W[27]=yi^~An&ms,W[36]=dt^~bn&bi,W[37]=cr^~ri&yn,W[46]=La^~Is&Xn,W[47]=vi^~gs&vn,W[8]=Tt^~en&St,W[9]=nr^~ht&an,W[18]=es^~Bt&Br,W[19]=Mn^~Cn&xn,W[28]=Kn^~qn&Fn,W[29]=An^~ms&Ft,W[38]=bn^~bi&zt,W[39]=ri^~yn&pn,W[48]=Is^~Xn&ks,W[49]=gs^~vn&mn,W[0]^=v[de],W[1]^=v[de+1]};if(o)n.exports=N;else for(B=0;B<M.length;++B)s[M[B]]=N[M[B]]})()})(VN)),VN.exports}var jpe=zpe();const Vpe=ku(jpe);function Yr(n){return"0x"+Vpe.keccak_256(rt(n))}const Upe="rlp/5.8.0",Vc=new Le(Upe);function c5(n){const e=[];for(;n;)e.unshift(n&255),n>>=8;return e}function u5(n,e,t){let r=0;for(let s=0;s<t;s++)r=r*256+n[e+s];return r}function kV(n){if(Array.isArray(n)){let r=[];if(n.forEach(function(i){r=r.concat(kV(i))}),r.length<=55)return r.unshift(192+r.length),r;const s=c5(r.length);return s.unshift(247+s.length),s.concat(r)}$S(n)||Vc.throwArgumentError("RLP object must be BytesLike","object",n);const e=Array.prototype.slice.call(rt(n));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=c5(e.length);return t.unshift(183+t.length),t.concat(e)}function gg(n){return ot(kV(n))}function h5(n,e,t,r){const s=[];for(;t<e+1+r;){const i=IV(n,t);s.push(i.result),t+=i.consumed,t>e+1+r&&Vc.throwError("child data too short",Le.errors.BUFFER_OVERRUN,{})}return{consumed:1+r,result:s}}function IV(n,e){if(n.length===0&&Vc.throwError("data too short",Le.errors.BUFFER_OVERRUN,{}),n[e]>=248){const t=n[e]-247;e+1+t>n.length&&Vc.throwError("data short segment too short",Le.errors.BUFFER_OVERRUN,{});const r=u5(n,e+1,t);return e+1+t+r>n.length&&Vc.throwError("data long segment too short",Le.errors.BUFFER_OVERRUN,{}),h5(n,e,e+1+t,t+r)}else if(n[e]>=192){const t=n[e]-192;return e+1+t>n.length&&Vc.throwError("data array too short",Le.errors.BUFFER_OVERRUN,{}),h5(n,e,e+1,t)}else if(n[e]>=184){const t=n[e]-183;e+1+t>n.length&&Vc.throwError("data array too short",Le.errors.BUFFER_OVERRUN,{});const r=u5(n,e+1,t);e+1+t+r>n.length&&Vc.throwError("data array too short",Le.errors.BUFFER_OVERRUN,{});const s=ot(n.slice(e+1+t,e+1+t+r));return{consumed:1+t+r,result:s}}else if(n[e]>=128){const t=n[e]-128;e+1+t>n.length&&Vc.throwError("data too short",Le.errors.BUFFER_OVERRUN,{});const r=ot(n.slice(e+1,e+1+t));return{consumed:1+t,result:r}}return{consumed:1,result:ot(n[e])}}function Q4(n){const e=rt(n),t=IV(e,0);return t.consumed!==e.length&&Vc.throwArgumentError("invalid rlp data","data",n),t.result}const Gpe="address/5.8.0",H0=new Le(Gpe);function d5(n){lr(n,20)||H0.throwArgumentError("invalid address","address",n),n=n.toLowerCase();const e=n.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const r=rt(Yr(t));for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(r[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const Hpe=9007199254740991;function Wpe(n){return Math.log10?Math.log10(n):Math.log(n)/Math.LN10}const J4={};for(let n=0;n<10;n++)J4[String(n)]=String(n);for(let n=0;n<26;n++)J4[String.fromCharCode(65+n)]=String(10+n);const f5=Math.floor(Wpe(Hpe));function qpe(n){n=n.toUpperCase(),n=n.substring(4)+n.substring(0,2)+"00";let e=n.split("").map(r=>J4[r]).join("");for(;e.length>=f5;){let r=e.substring(0,f5);e=parseInt(r,10)%97+e.substring(r.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}function Es(n){let e=null;if(typeof n!="string"&&H0.throwArgumentError("invalid address","address",n),n.match(/^(0x)?[0-9a-fA-F]{40}$/))n.substring(0,2)!=="0x"&&(n="0x"+n),e=d5(n),n.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==n&&H0.throwArgumentError("bad address checksum","address",n);else if(n.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(n.substring(2,4)!==qpe(n)&&H0.throwArgumentError("bad icap checksum","address",n),e=Npe(n.substring(4));e.length<40;)e="0"+e;e=d5("0x"+e)}else H0.throwArgumentError("invalid address","address",n);return e}function RV(n){let e=null;try{e=Es(n.from)}catch{H0.throwArgumentError("missing from address","transaction",n)}const t=bh(rt(st.from(n.nonce).toHexString()));return Es(ui(Yr(gg([e,t])),12))}class Kpe extends Lh{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){try{t=Es(t)}catch(r){this._throwError(r.message,t)}return e.writeValue(t)}decode(e){return Es(Gr(e.readValue().toHexString(),20))}}class Xpe extends Lh{constructor(e){super(e.name,e.type,void 0,e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,t){return this.coder.encode(e,t)}decode(e){return this.coder.decode(e)}}const W0=new Le(nb);function DV(n,e,t){let r=null;if(Array.isArray(t))r=t;else if(t&&typeof t=="object"){let l={};r=e.map(c=>{const u=c.localName;return u||W0.throwError("cannot encode object for signature with missing names",Le.errors.INVALID_ARGUMENT,{argument:"values",coder:c,value:t}),l[u]&&W0.throwError("cannot encode object for signature with duplicate names",Le.errors.INVALID_ARGUMENT,{argument:"values",coder:c,value:t}),l[u]=!0,t[u]})}else W0.throwArgumentError("invalid tuple value","tuple",t);e.length!==r.length&&W0.throwArgumentError("types/value length mismatch","tuple",t);let s=new yI(n.wordSize),i=new yI(n.wordSize),a=[];e.forEach((l,c)=>{let u=r[c];if(l.dynamic){let d=i.length;l.encode(i,u);let p=s.writeUpdatableValue();a.push(x=>{p(x+d)})}else l.encode(s,u)}),a.forEach(l=>{l(s.length)});let o=n.appendWriter(s);return o+=n.appendWriter(i),o}function $V(n,e){let t=[],r=n.subReader(0);e.forEach(i=>{let a=null;if(i.dynamic){let o=n.readValue(),l=r.subReader(o.toNumber());try{a=i.decode(l)}catch(c){if(c.code===Le.errors.BUFFER_OVERRUN)throw c;a=c,a.baseType=i.name,a.name=i.localName,a.type=i.type}}else try{a=i.decode(n)}catch(o){if(o.code===Le.errors.BUFFER_OVERRUN)throw o;a=o,a.baseType=i.name,a.name=i.localName,a.type=i.type}a!=null&&t.push(a)});const s=e.reduce((i,a)=>{const o=a.localName;return o&&(i[o]||(i[o]=0),i[o]++),i},{});e.forEach((i,a)=>{let o=i.localName;if(!o||s[o]!==1||(o==="length"&&(o="_length"),t[o]!=null))return;const l=t[a];l instanceof Error?Object.defineProperty(t,o,{enumerable:!0,get:()=>{throw l}}):t[o]=l});for(let i=0;i<t.length;i++){const a=t[i];a instanceof Error&&Object.defineProperty(t,i,{enumerable:!0,get:()=>{throw a}})}return Object.freeze(t)}class Ype extends Lh{constructor(e,t,r){const s=e.type+"["+(t>=0?t:"")+"]",i=t===-1||e.dynamic;super("array",s,r,i),this.coder=e,this.length=t}defaultValue(){const e=this.coder.defaultValue(),t=[];for(let r=0;r<this.length;r++)t.push(e);return t}encode(e,t){Array.isArray(t)||this._throwError("expected array value",t);let r=this.length;r===-1&&(r=t.length,e.writeValue(t.length)),W0.checkArgumentCount(t.length,r,"coder array"+(this.localName?" "+this.localName:""));let s=[];for(let i=0;i<t.length;i++)s.push(this.coder);return DV(e,s,t)}decode(e){let t=this.length;t===-1&&(t=e.readValue().toNumber(),t*32>e._data.length&&W0.throwError("insufficient data length",Le.errors.BUFFER_OVERRUN,{length:e._data.length,count:t}));let r=[];for(let s=0;s<t;s++)r.push(new Xpe(this.coder));return e.coerce(this.name,$V(e,r))}}class Zpe extends Lh{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){return e.writeValue(t?1:0)}decode(e){return e.coerce(this.type,!e.readValue().isZero())}}class LV extends Lh{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=rt(t);let r=e.writeValue(t.length);return r+=e.writeBytes(t),r}decode(e){return e.readBytes(e.readValue().toNumber(),!0)}}class Qpe extends LV{constructor(e){super("bytes",e)}decode(e){return e.coerce(this.name,ot(super.decode(e)))}}class Jpe extends Lh{constructor(e,t){let r="bytes"+String(e);super(r,r,t,!1),this.size=e}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(e,t){let r=rt(t);return r.length!==this.size&&this._throwError("incorrect data length",t),e.writeBytes(r)}decode(e){return e.coerce(this.name,ot(e.readBytes(this.size)))}}class eme extends Lh{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes([])}decode(e){return e.readBytes(0),e.coerce(this.name,null)}}const tme="0x0000000000000000000000000000000000000000",nme=st.from(-1),PV=st.from(0),rme=st.from(1),sme=st.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),ime="0x0000000000000000000000000000000000000000000000000000000000000000";class ame extends Lh{constructor(e,t,r){const s=(t?"int":"uint")+e*8;super(s,s,r,!1),this.size=e,this.signed=t}defaultValue(){return 0}encode(e,t){let r=st.from(t),s=sme.mask(e.wordSize*8);if(this.signed){let i=s.mask(this.size*8-1);(r.gt(i)||r.lt(i.add(rme).mul(nme)))&&this._throwError("value out-of-bounds",t)}else(r.lt(PV)||r.gt(s.mask(this.size*8)))&&this._throwError("value out-of-bounds",t);return r=r.toTwos(this.size*8).mask(this.size*8),this.signed&&(r=r.fromTwos(this.size*8).toTwos(8*e.wordSize)),e.writeValue(r)}decode(e){let t=e.readValue().mask(this.size*8);return this.signed&&(t=t.fromTwos(this.size*8)),e.coerce(this.name,t)}}const ome="strings/5.8.0",OV=new Le(ome);var df;(function(n){n.current="",n.NFC="NFC",n.NFD="NFD",n.NFKC="NFKC",n.NFKD="NFKD"})(df||(df={}));var Wo;(function(n){n.UNEXPECTED_CONTINUE="unexpected continuation byte",n.BAD_PREFIX="bad codepoint prefix",n.OVERRUN="string overrun",n.MISSING_CONTINUE="missing continuation byte",n.OUT_OF_RANGE="out of UTF-8 range",n.UTF16_SURROGATE="UTF-16 surrogate",n.OVERLONG="overlong representation"})(Wo||(Wo={}));function lme(n,e,t,r,s){return OV.throwArgumentError(`invalid codepoint at offset ${e}; ${n}`,"bytes",t)}function MV(n,e,t,r,s){if(n===Wo.BAD_PREFIX||n===Wo.UNEXPECTED_CONTINUE){let i=0;for(let a=e+1;a<t.length&&t[a]>>6===2;a++)i++;return i}return n===Wo.OVERRUN?t.length-e-1:0}function cme(n,e,t,r,s){return n===Wo.OVERLONG?(r.push(s),0):(r.push(65533),MV(n,e,t))}const ume=Object.freeze({error:lme,ignore:MV,replace:cme});function FV(n,e){e==null&&(e=ume.error),n=rt(n);const t=[];let r=0;for(;r<n.length;){const s=n[r++];if(s>>7===0){t.push(s);continue}let i=null,a=null;if((s&224)===192)i=1,a=127;else if((s&240)===224)i=2,a=2047;else if((s&248)===240)i=3,a=65535;else{(s&192)===128?r+=e(Wo.UNEXPECTED_CONTINUE,r-1,n,t):r+=e(Wo.BAD_PREFIX,r-1,n,t);continue}if(r-1+i>=n.length){r+=e(Wo.OVERRUN,r-1,n,t);continue}let o=s&(1<<8-i-1)-1;for(let l=0;l<i;l++){let c=n[r];if((c&192)!=128){r+=e(Wo.MISSING_CONTINUE,r,n,t),o=null;break}o=o<<6|c&63,r++}if(o!==null){if(o>1114111){r+=e(Wo.OUT_OF_RANGE,r-1-i,n,t,o);continue}if(o>=55296&&o<=57343){r+=e(Wo.UTF16_SURROGATE,r-1-i,n,t,o);continue}if(o<=a){r+=e(Wo.OVERLONG,r-1-i,n,t,o);continue}t.push(o)}}return t}function Pi(n,e=df.current){e!=df.current&&(OV.checkNormalize(),n=n.normalize(e));let t=[];for(let r=0;r<n.length;r++){const s=n.charCodeAt(r);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){r++;const i=n.charCodeAt(r);if(r>=n.length||(i&64512)!==56320)throw new Error("invalid utf-8 string");const a=65536+((s&1023)<<10)+(i&1023);t.push(a>>18|240),t.push(a>>12&63|128),t.push(a>>6&63|128),t.push(a&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return rt(t)}function hme(n){return n.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function rb(n,e){return hme(FV(n,e))}function dme(n,e=df.current){return FV(Pi(n,e))}class fme extends LV{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Pi(t))}decode(e){return rb(super.decode(e))}}class J_ extends Lh{constructor(e,t){let r=!1;const s=[];e.forEach(a=>{a.dynamic&&(r=!0),s.push(a.type)});const i="tuple("+s.join(",")+")";super("tuple",i,t,r),this.coders=e}defaultValue(){const e=[];this.coders.forEach(r=>{e.push(r.defaultValue())});const t=this.coders.reduce((r,s)=>{const i=s.localName;return i&&(r[i]||(r[i]=0),r[i]++),r},{});return this.coders.forEach((r,s)=>{let i=r.localName;!i||t[i]!==1||(i==="length"&&(i="_length"),e[i]==null&&(e[i]=e[s]))}),Object.freeze(e)}encode(e,t){return DV(e,this.coders,t)}decode(e){return e.coerce(this.name,$V(e,this.coders))}}const ew=new Le(nb),pme=new RegExp(/^bytes([0-9]*)$/),mme=new RegExp(/^(u?int)([0-9]*)$/);class gme{constructor(e){Ke(this,"coerceFunc",e||null)}_getCoder(e){switch(e.baseType){case"address":return new Kpe(e.name);case"bool":return new Zpe(e.name);case"string":return new fme(e.name);case"bytes":return new Qpe(e.name);case"array":return new Ype(this._getCoder(e.arrayChildren),e.arrayLength,e.name);case"tuple":return new J_((e.components||[]).map(r=>this._getCoder(r)),e.name);case"":return new eme(e.name)}let t=e.type.match(mme);if(t){let r=parseInt(t[2]||"256");return(r===0||r>256||r%8!==0)&&ew.throwArgumentError("invalid "+t[1]+" bit length","param",e),new ame(r/8,t[1]==="int",e.name)}if(t=e.type.match(pme),t){let r=parseInt(t[1]);return(r===0||r>32)&&ew.throwArgumentError("invalid bytes length","param",e),new Jpe(r,e.name)}return ew.throwArgumentError("invalid type","type",e.type)}_getWordSize(){return 32}_getReader(e,t){return new cE(e,this._getWordSize(),this.coerceFunc,t)}_getWriter(){return new yI(this._getWordSize())}getDefaultValue(e){const t=e.map(s=>this._getCoder($i.from(s)));return new J_(t,"_").defaultValue()}encode(e,t){e.length!==t.length&&ew.throwError("types/values length mismatch",Le.errors.INVALID_ARGUMENT,{count:{types:e.length,values:t.length},value:{types:e,values:t}});const r=e.map(a=>this._getCoder($i.from(a))),s=new J_(r,"_"),i=this._getWriter();return s.encode(i,t),i.data}decode(e,t,r){const s=e.map(a=>this._getCoder($i.from(a)));return new J_(s,"_").decode(this._getReader(rt(t),r))}}const xme=new gme;function Ip(n){return Yr(Pi(n))}const BV="hash/5.8.0";function zV(n){n=atob(n);const e=[];for(let t=0;t<n.length;t++)e.push(n.charCodeAt(t));return rt(e)}function jV(n){n=rt(n);let e="";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return btoa(e)}function VV(n,e){e==null&&(e=1);const t=[],r=t.forEach,s=function(i,a){r.call(i,function(o){a>0&&Array.isArray(o)?s(o,a-1):t.push(o)})};return s(n,e),t}function yme(n){const e={};for(let t=0;t<n.length;t++){const r=n[t];e[r[0]]=r[1]}return e}function bme(n){let e=0;function t(){return n[e++]<<8|n[e++]}let r=t(),s=1,i=[0,1];for(let $=1;$<r;$++)i.push(s+=t());let a=t(),o=e;e+=a;let l=0,c=0;function u(){return l==0&&(c=c<<8|n[e++],l=8),c>>--l&1}const d=31,p=Math.pow(2,d),x=p>>>1,y=x>>1,v=p-1;let b=0;for(let $=0;$<d;$++)b=b<<1|u();let S=[],T=0,C=p;for(;;){let $=Math.floor(((b-T+1)*s-1)/C),q=0,U=r;for(;U-q>1;){let V=q+U>>>1;$<i[V]?U=V:q=V}if(q==0)break;S.push(q);let F=T+Math.floor(C*i[q]/s),G=T+Math.floor(C*i[q+1]/s)-1;for(;((F^G)&x)==0;)b=b<<1&v|u(),F=F<<1&v,G=G<<1&v|1;for(;F&~G&y;)b=b&x|b<<1&v>>>1|u(),F=F<<1^x,G=(G^x)<<1|x|1;T=F,C=1+G-F}let I=r-4;return S.map($=>{switch($-I){case 3:return I+65792+(n[o++]<<16|n[o++]<<8|n[o++]);case 2:return I+256+(n[o++]<<8|n[o++]);case 1:return I+n[o++];default:return $-1}})}function vme(n){let e=0;return()=>n[e++]}function _me(n){return vme(bme(n))}function wme(n){return n&1?~n>>1:n>>1}function Eme(n,e){let t=Array(n);for(let r=0;r<n;r++)t[r]=1+e();return t}function p5(n,e){let t=Array(n);for(let r=0,s=-1;r<n;r++)t[r]=s+=1+e();return t}function Sme(n,e){let t=Array(n);for(let r=0,s=0;r<n;r++)t[r]=s+=wme(e());return t}function uE(n,e){let t=p5(n(),n),r=n(),s=p5(r,n),i=Eme(r,n);for(let a=0;a<r;a++)for(let o=0;o<i[a];o++)t.push(s[a]+o);return e?t.map(a=>e[a]):t}function Tme(n){let e=[];for(;;){let t=n();if(t==0)break;e.push(Ame(t,n))}for(;;){let t=n()-1;if(t<0)break;e.push(Nme(t,n))}return yme(VV(e))}function Cme(n){let e=[];for(;;){let t=n();if(t==0)break;e.push(t)}return e}function UV(n,e,t){let r=Array(n).fill(void 0).map(()=>[]);for(let s=0;s<e;s++)Sme(n,t).forEach((i,a)=>r[a].push(i));return r}function Ame(n,e){let t=1+e(),r=e(),s=Cme(e),i=UV(s.length,1+n,e);return VV(i.map((a,o)=>{const l=a[0],c=a.slice(1);return Array(s[o]).fill(void 0).map((u,d)=>{let p=d*r;return[l+d*t,c.map(x=>x+p)]})}))}function Nme(n,e){let t=1+e();return UV(t,1+n,e).map(s=>[s[0],s.slice(1)])}function kme(n){let e=uE(n).sort((r,s)=>r-s);return t();function t(){let r=[];for(;;){let c=uE(n,e);if(c.length==0)break;r.push({set:new Set(c),node:t()})}r.sort((c,u)=>u.set.size-c.set.size);let s=n(),i=s%3;s=s/3|0;let a=!!(s&1);s>>=1;let o=s==1,l=s==2;return{branches:r,valid:i,fe0f:a,save:o,check:l}}}function Ime(){return _me(zV("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const LS=Ime(),Rme=new Set(uE(LS)),Dme=new Set(uE(LS)),$me=Tme(LS),Lme=kme(LS),m5=45,g5=95;function GV(n){return dme(n)}function Pme(n){return n.filter(e=>e!=65039)}function HV(n){for(let e of n.split(".")){let t=GV(e);try{for(let r=t.lastIndexOf(g5)-1;r>=0;r--)if(t[r]!==g5)throw new Error("underscore only allowed at start");if(t.length>=4&&t.every(r=>r<128)&&t[2]===m5&&t[3]===m5)throw new Error("invalid label extension")}catch(r){throw new Error(`Invalid label "${e}": ${r.message}`)}}return n}function Ome(n){return HV(Mme(n,Pme))}function Mme(n,e){let t=GV(n).reverse(),r=[];for(;t.length;){let s=Bme(t);if(s){r.push(...e(s));continue}let i=t.pop();if(Rme.has(i)){r.push(i);continue}if(Dme.has(i))continue;let a=$me[i];if(a){r.push(...a);continue}throw new Error(`Disallowed codepoint: 0x${i.toString(16).toUpperCase()}`)}return HV(Fme(String.fromCodePoint(...r)))}function Fme(n){return n.normalize("NFC")}function Bme(n,e){var t;let r=Lme,s,i,a=[],o=n.length;for(;o;){let l=n[--o];if(r=(t=r.branches.find(c=>c.set.has(l)))===null||t===void 0?void 0:t.node,!r)break;if(r.save)i=l;else if(r.check&&l===i)break;a.push(l),r.fe0f&&(a.push(65039),o>0&&n[o-1]==65039&&o--),r.valid&&(s=a.slice(),r.valid==2&&s.splice(1,1),n.length=o)}return s}const zme=new Le(BV),WV=new Uint8Array(32);WV.fill(0);function x5(n){if(n.length===0)throw new Error("invalid ENS name; empty component");return n}function qV(n){const e=Pi(Ome(n)),t=[];if(n.length===0)return t;let r=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(x5(e.slice(r,s))),r=s+1);if(r>=e.length)throw new Error("invalid ENS name; empty component");return t.push(x5(e.slice(r))),t}function Bw(n){typeof n!="string"&&zme.throwArgumentError("invalid ENS name; not a string","name",n);let e=WV;const t=qV(n);for(;t.length;)e=Yr(zs([e,Yr(t.pop())]));return ot(e)}function jme(n){return ot(zs(qV(n).map(e=>{if(e.length>63)throw new Error("invalid DNS encoded entry; length exceeds 63 bytes");const t=new Uint8Array(e.length+1);return t.set(e,1),t[0]=t.length-1,t})))+"00"}const Vme=`Ethereum Signed Message:
`;function Ume(n){return typeof n=="string"&&(n=Pi(n)),Yr(zs([Pi(Vme),Pi(String(n.length)),n]))}var Gme=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const ds=new Le(BV),KV=new Uint8Array(32);KV.fill(0);const Hme=st.from(-1),XV=st.from(0),YV=st.from(1),Wme=st.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function qme(n){const e=rt(n),t=e.length%32;return t?xo([e,KV.slice(t)]):ot(e)}const Kme=Gr(YV.toHexString(),32),Xme=Gr(XV.toHexString(),32),y5={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},UN=["name","version","chainId","verifyingContract","salt"];function b5(n){return function(e){return typeof e!="string"&&ds.throwArgumentError(`invalid domain value for ${JSON.stringify(n)}`,`domain.${n}`,e),e}}const Yme={name:b5("name"),version:b5("version"),chainId:function(n){try{return st.from(n).toString()}catch{}return ds.throwArgumentError('invalid domain value for "chainId"',"domain.chainId",n)},verifyingContract:function(n){try{return Es(n).toLowerCase()}catch{}return ds.throwArgumentError('invalid domain value "verifyingContract"',"domain.verifyingContract",n)},salt:function(n){try{const e=rt(n);if(e.length!==32)throw new Error("bad length");return ot(e)}catch{}return ds.throwArgumentError('invalid domain value "salt"',"domain.salt",n)}};function GN(n){{const e=n.match(/^(u?)int(\d*)$/);if(e){const t=e[1]==="",r=parseInt(e[2]||"256");(r%8!==0||r>256||e[2]&&e[2]!==String(r))&&ds.throwArgumentError("invalid numeric width","type",n);const s=Wme.mask(t?r-1:r),i=t?s.add(YV).mul(Hme):XV;return function(a){const o=st.from(a);return(o.lt(i)||o.gt(s))&&ds.throwArgumentError(`value out-of-bounds for ${n}`,"value",a),Gr(o.toTwos(256).toHexString(),32)}}}{const e=n.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return(t===0||t>32||e[1]!==String(t))&&ds.throwArgumentError("invalid bytes width","type",n),function(r){return rt(r).length!==t&&ds.throwArgumentError(`invalid length for ${n}`,"value",r),qme(r)}}}switch(n){case"address":return function(e){return Gr(Es(e),32)};case"bool":return function(e){return e?Kme:Xme};case"bytes":return function(e){return Yr(e)};case"string":return function(e){return Ip(e)}}return null}function v5(n,e){return`${n}(${e.map(({name:t,type:r})=>r+" "+t).join(",")})`}class Xa{constructor(e){Ke(this,"types",Object.freeze(Ah(e))),Ke(this,"_encoderCache",{}),Ke(this,"_types",{});const t={},r={},s={};Object.keys(e).forEach(o=>{t[o]={},r[o]=[],s[o]={}});for(const o in e){const l={};e[o].forEach(c=>{l[c.name]&&ds.throwArgumentError(`duplicate variable name ${JSON.stringify(c.name)} in ${JSON.stringify(o)}`,"types",e),l[c.name]=!0;const u=c.type.match(/^([^\x5b]*)(\x5b|$)/)[1];u===o&&ds.throwArgumentError(`circular type reference to ${JSON.stringify(u)}`,"types",e),!GN(u)&&(r[u]||ds.throwArgumentError(`unknown type ${JSON.stringify(u)}`,"types",e),r[u].push(o),t[o][u]=!0)})}const i=Object.keys(r).filter(o=>r[o].length===0);i.length===0?ds.throwArgumentError("missing primary type","types",e):i.length>1&&ds.throwArgumentError(`ambiguous primary types or unused types: ${i.map(o=>JSON.stringify(o)).join(", ")}`,"types",e),Ke(this,"primaryType",i[0]);function a(o,l){l[o]&&ds.throwArgumentError(`circular type reference to ${JSON.stringify(o)}`,"types",e),l[o]=!0,Object.keys(t[o]).forEach(c=>{r[c]&&(a(c,l),Object.keys(l).forEach(u=>{s[u][c]=!0}))}),delete l[o]}a(this.primaryType,{});for(const o in s){const l=Object.keys(s[o]);l.sort(),this._types[o]=v5(o,e[o])+l.map(c=>v5(c,e[c])).join("")}}getEncoder(e){let t=this._encoderCache[e];return t||(t=this._encoderCache[e]=this._getEncoder(e)),t}_getEncoder(e){{const s=GN(e);if(s)return s}const t=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(t){const s=t[1],i=this.getEncoder(s),a=parseInt(t[3]);return o=>{a>=0&&o.length!==a&&ds.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",o);let l=o.map(i);return this._types[s]&&(l=l.map(Yr)),Yr(xo(l))}}const r=this.types[e];if(r){const s=Ip(this._types[e]);return i=>{const a=r.map(({name:o,type:l})=>{const c=this.getEncoder(l)(i[o]);return this._types[l]?Yr(c):c});return a.unshift(s),xo(a)}}return ds.throwArgumentError(`unknown type: ${e}`,"type",e)}encodeType(e){const t=this._types[e];return t||ds.throwArgumentError(`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return Yr(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,r){if(GN(e))return r(e,t);const s=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(s){const a=s[1],o=parseInt(s[3]);return o>=0&&t.length!==o&&ds.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",t),t.map(l=>this._visit(a,l,r))}const i=this.types[e];return i?i.reduce((a,{name:o,type:l})=>(a[o]=this._visit(l,t[o],r),a),{}):ds.throwArgumentError(`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new Xa(e)}static getPrimaryType(e){return Xa.from(e).primaryType}static hashStruct(e,t,r){return Xa.from(t).hashStruct(e,r)}static hashDomain(e){const t=[];for(const r in e){const s=y5[r];s||ds.throwArgumentError(`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),t.push({name:r,type:s})}return t.sort((r,s)=>UN.indexOf(r.name)-UN.indexOf(s.name)),Xa.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,r){return xo(["0x1901",Xa.hashDomain(e),Xa.from(t).hash(r)])}static hash(e,t,r){return Yr(Xa.encode(e,t,r))}static resolveNames(e,t,r,s){return Gme(this,void 0,void 0,function*(){e=pi(e);const i={};e.verifyingContract&&!lr(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const a=Xa.from(t);a.visit(r,(o,l)=>(o==="address"&&!lr(l,20)&&(i[l]="0x"),l));for(const o in i)i[o]=yield s(o);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),r=a.visit(r,(o,l)=>o==="address"&&i[l]?i[l]:l),{domain:e,value:r}})}static getPayload(e,t,r){Xa.hashDomain(e);const s={},i=[];UN.forEach(l=>{const c=e[l];c!=null&&(s[l]=Yme[l](c),i.push({name:l,type:y5[l]}))});const a=Xa.from(t),o=pi(t);return o.EIP712Domain?ds.throwArgumentError("types must not contain EIP712Domain type","types.EIP712Domain",t):o.EIP712Domain=i,a.encode(r),{types:o,domain:s,primaryType:a.primaryType,message:a.visit(r,(l,c)=>{if(l.match(/^bytes(\d*)/))return ot(rt(c));if(l.match(/^u?int/))return st.from(c).toString();switch(l){case"address":return c.toLowerCase();case"bool":return!!c;case"string":return typeof c!="string"&&ds.throwArgumentError("invalid string","value",c),c}return ds.throwArgumentError("unsupported type","type",l)})}}}const hs=new Le(nb);class Zme extends Nm{}class Qme extends Nm{}class Jme extends Nm{}class bI extends Nm{static isIndexed(e){return!!(e&&e._isIndexed)}}const e0e={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:!0},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"]}};function _5(n,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${n}`);return t.error=e,t}class w5{constructor(e){let t=[];typeof e=="string"?t=JSON.parse(e):t=e,Ke(this,"fragments",t.map(r=>ph.from(r)).filter(r=>r!=null)),Ke(this,"_abiCoder",Qc(new.target,"getAbiCoder")()),Ke(this,"functions",{}),Ke(this,"errors",{}),Ke(this,"events",{}),Ke(this,"structs",{}),this.fragments.forEach(r=>{let s=null;switch(r.type){case"constructor":if(this.deploy){hs.warn("duplicate definition - constructor");return}Ke(this,"deploy",r);return;case"function":s=this.functions;break;case"event":s=this.events;break;case"error":s=this.errors;break;default:return}let i=r.format();if(s[i]){hs.warn("duplicate definition - "+i);return}s[i]=r}),this.deploy||Ke(this,"deploy",Xc.from({payable:!1,type:"constructor"})),Ke(this,"_isInterface",!0)}format(e){e||(e=pr.full),e===pr.sighash&&hs.throwArgumentError("interface does not support formatting sighash","format",e);const t=this.fragments.map(r=>r.format(e));return e===pr.json?JSON.stringify(t.map(r=>JSON.parse(r))):t}static getAbiCoder(){return xme}static getAddress(e){return Es(e)}static getSighash(e){return ui(Ip(e.format()),0,4)}static getEventTopic(e){return Ip(e.format())}getFunction(e){if(lr(e)){for(const r in this.functions)if(e===this.getSighash(r))return this.functions[r];hs.throwArgumentError("no matching function","sighash",e)}if(e.indexOf("(")===-1){const r=e.trim(),s=Object.keys(this.functions).filter(i=>i.split("(")[0]===r);return s.length===0?hs.throwArgumentError("no matching function","name",r):s.length>1&&hs.throwArgumentError("multiple matching functions","name",r),this.functions[s[0]]}const t=this.functions[Yc.fromString(e).format()];return t||hs.throwArgumentError("no matching function","signature",e),t}getEvent(e){if(lr(e)){const r=e.toLowerCase();for(const s in this.events)if(r===this.getEventTopic(s))return this.events[s];hs.throwArgumentError("no matching event","topichash",r)}if(e.indexOf("(")===-1){const r=e.trim(),s=Object.keys(this.events).filter(i=>i.split("(")[0]===r);return s.length===0?hs.throwArgumentError("no matching event","name",r):s.length>1&&hs.throwArgumentError("multiple matching events","name",r),this.events[s[0]]}const t=this.events[ch.fromString(e).format()];return t||hs.throwArgumentError("no matching event","signature",e),t}getError(e){if(lr(e)){const r=Qc(this.constructor,"getSighash");for(const s in this.errors){const i=this.errors[s];if(e===r(i))return this.errors[s]}hs.throwArgumentError("no matching error","sighash",e)}if(e.indexOf("(")===-1){const r=e.trim(),s=Object.keys(this.errors).filter(i=>i.split("(")[0]===r);return s.length===0?hs.throwArgumentError("no matching error","name",r):s.length>1&&hs.throwArgumentError("multiple matching errors","name",r),this.errors[s[0]]}const t=this.errors[Yc.fromString(e).format()];return t||hs.throwArgumentError("no matching error","signature",e),t}getSighash(e){if(typeof e=="string")try{e=this.getFunction(e)}catch(t){try{e=this.getError(e)}catch{throw t}}return Qc(this.constructor,"getSighash")(e)}getEventTopic(e){return typeof e=="string"&&(e=this.getEvent(e)),Qc(this.constructor,"getEventTopic")(e)}_decodeParams(e,t){return this._abiCoder.decode(e,t)}_encodeParams(e,t){return this._abiCoder.encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){typeof e=="string"&&(e=this.getError(e));const r=rt(t);return ot(r.slice(0,4))!==this.getSighash(e)&&hs.throwArgumentError(`data signature does not match error ${e.name}.`,"data",ot(r)),this._decodeParams(e.inputs,r.slice(4))}encodeErrorResult(e,t){return typeof e=="string"&&(e=this.getError(e)),ot(zs([this.getSighash(e),this._encodeParams(e.inputs,t||[])]))}decodeFunctionData(e,t){typeof e=="string"&&(e=this.getFunction(e));const r=rt(t);return ot(r.slice(0,4))!==this.getSighash(e)&&hs.throwArgumentError(`data signature does not match function ${e.name}.`,"data",ot(r)),this._decodeParams(e.inputs,r.slice(4))}encodeFunctionData(e,t){return typeof e=="string"&&(e=this.getFunction(e)),ot(zs([this.getSighash(e),this._encodeParams(e.inputs,t||[])]))}decodeFunctionResult(e,t){typeof e=="string"&&(e=this.getFunction(e));let r=rt(t),s=null,i="",a=null,o=null,l=null;switch(r.length%this._abiCoder._getWordSize()){case 0:try{return this._abiCoder.decode(e.outputs,r)}catch{}break;case 4:{const c=ot(r.slice(0,4)),u=e0e[c];if(u)a=this._abiCoder.decode(u.inputs,r.slice(4)),o=u.name,l=u.signature,u.reason&&(s=a[0]),o==="Error"?i=`; VM Exception while processing transaction: reverted with reason string ${JSON.stringify(a[0])}`:o==="Panic"&&(i=`; VM Exception while processing transaction: reverted with panic code ${a[0]}`);else try{const d=this.getError(c);a=this._abiCoder.decode(d.inputs,r.slice(4)),o=d.name,l=d.format()}catch{}break}}return hs.throwError("call revert exception"+i,Le.errors.CALL_EXCEPTION,{method:e.format(),data:ot(t),errorArgs:a,errorName:o,errorSignature:l,reason:s})}encodeFunctionResult(e,t){return typeof e=="string"&&(e=this.getFunction(e)),ot(this._abiCoder.encode(e.outputs,t||[]))}encodeFilterTopics(e,t){typeof e=="string"&&(e=this.getEvent(e)),t.length>e.inputs.length&&hs.throwError("too many arguments for "+e.format(),Le.errors.UNEXPECTED_ARGUMENT,{argument:"values",value:t});let r=[];e.anonymous||r.push(this.getEventTopic(e));const s=(i,a)=>i.type==="string"?Ip(a):i.type==="bytes"?Yr(ot(a)):(i.type==="bool"&&typeof a=="boolean"&&(a=a?"0x01":"0x00"),i.type.match(/^u?int/)&&(a=st.from(a).toHexString()),i.type==="address"&&this._abiCoder.encode(["address"],[a]),Gr(ot(a),32));for(t.forEach((i,a)=>{let o=e.inputs[a];if(!o.indexed){i!=null&&hs.throwArgumentError("cannot filter non-indexed parameters; must be null","contract."+o.name,i);return}i==null?r.push(null):o.baseType==="array"||o.baseType==="tuple"?hs.throwArgumentError("filtering with tuples or arrays not supported","contract."+o.name,i):Array.isArray(i)?r.push(i.map(l=>s(o,l))):r.push(s(o,i))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,t){typeof e=="string"&&(e=this.getEvent(e));const r=[],s=[],i=[];return e.anonymous||r.push(this.getEventTopic(e)),t.length!==e.inputs.length&&hs.throwArgumentError("event arguments/values mismatch","values",t),e.inputs.forEach((a,o)=>{const l=t[o];if(a.indexed)if(a.type==="string")r.push(Ip(l));else if(a.type==="bytes")r.push(Yr(l));else{if(a.baseType==="tuple"||a.baseType==="array")throw new Error("not implemented");r.push(this._abiCoder.encode([a.type],[l]))}else s.push(a),i.push(l)}),{data:this._abiCoder.encode(s,i),topics:r}}decodeEventLog(e,t,r){if(typeof e=="string"&&(e=this.getEvent(e)),r!=null&&!e.anonymous){let p=this.getEventTopic(e);(!lr(r[0],32)||r[0].toLowerCase()!==p)&&hs.throwError("fragment/topic mismatch",Le.errors.INVALID_ARGUMENT,{argument:"topics[0]",expected:p,value:r[0]}),r=r.slice(1)}let s=[],i=[],a=[];e.inputs.forEach((p,x)=>{p.indexed?p.type==="string"||p.type==="bytes"||p.baseType==="tuple"||p.baseType==="array"?(s.push($i.fromObject({type:"bytes32",name:p.name})),a.push(!0)):(s.push(p),a.push(!1)):(i.push(p),a.push(!1))});let o=r!=null?this._abiCoder.decode(s,zs(r)):null,l=this._abiCoder.decode(i,t,!0),c=[],u=0,d=0;e.inputs.forEach((p,x)=>{if(p.indexed)if(o==null)c[x]=new bI({_isIndexed:!0,hash:null});else if(a[x])c[x]=new bI({_isIndexed:!0,hash:o[d++]});else try{c[x]=o[d++]}catch(y){c[x]=y}else try{c[x]=l[u++]}catch(y){c[x]=y}if(p.name&&c[p.name]==null){const y=c[x];y instanceof Error?Object.defineProperty(c,p.name,{enumerable:!0,get:()=>{throw _5(`property ${JSON.stringify(p.name)}`,y)}}):c[p.name]=y}});for(let p=0;p<c.length;p++){const x=c[p];x instanceof Error&&Object.defineProperty(c,p,{enumerable:!0,get:()=>{throw _5(`index ${p}`,x)}})}return Object.freeze(c)}parseTransaction(e){let t=this.getFunction(e.data.substring(0,10).toLowerCase());return t?new Qme({args:this._abiCoder.decode(t.inputs,"0x"+e.data.substring(10)),functionFragment:t,name:t.name,signature:t.format(),sighash:this.getSighash(t),value:st.from(e.value||"0")}):null}parseLog(e){let t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new Zme({eventFragment:t,name:t.name,signature:t.format(),topic:this.getEventTopic(t),args:this.decodeEventLog(t,e.data,e.topics)})}parseError(e){const t=ot(e);let r=this.getError(t.substring(0,10).toLowerCase());return r?new Jme({args:this._abiCoder.decode(r.inputs,"0x"+t.substring(10)),errorFragment:r,name:r.name,signature:r.format(),sighash:this.getSighash(r)}):null}static isInterface(e){return!!(e&&e._isInterface)}}const t0e="abstract-provider/5.8.0";var n0e=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const r0e=new Le(t0e);class s0e extends Nm{static isForkEvent(e){return!!(e&&e._isForkEvent)}}class sb{constructor(){r0e.checkAbstract(new.target,sb),Ke(this,"_isProvider",!0)}getFeeData(){return n0e(this,void 0,void 0,function*(){const{block:e,gasPrice:t}=yield Ls({block:this.getBlock("latest"),gasPrice:this.getGasPrice().catch(a=>null)});let r=null,s=null,i=null;return e&&e.baseFeePerGas&&(r=e.baseFeePerGas,i=st.from("1500000000"),s=e.baseFeePerGas.mul(2).add(i)),{lastBaseFeePerGas:r,maxFeePerGas:s,maxPriorityFeePerGas:i,gasPrice:t}})}addListener(e,t){return this.on(e,t)}removeListener(e,t){return this.off(e,t)}static isProvider(e){return!!(e&&e._isProvider)}}const i0e="abstract-signer/5.8.0";var Zl=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const vl=new Le(i0e),a0e=["accessList","ccipReadEnabled","chainId","customData","data","from","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce","to","type","value"],o0e=[Le.errors.INSUFFICIENT_FUNDS,Le.errors.NONCE_EXPIRED,Le.errors.REPLACEMENT_UNDERPRICED];class Wg{constructor(){vl.checkAbstract(new.target,Wg),Ke(this,"_isSigner",!0)}getBalance(e){return Zl(this,void 0,void 0,function*(){return this._checkProvider("getBalance"),yield this.provider.getBalance(this.getAddress(),e)})}getTransactionCount(e){return Zl(this,void 0,void 0,function*(){return this._checkProvider("getTransactionCount"),yield this.provider.getTransactionCount(this.getAddress(),e)})}estimateGas(e){return Zl(this,void 0,void 0,function*(){this._checkProvider("estimateGas");const t=yield Ls(this.checkTransaction(e));return yield this.provider.estimateGas(t)})}call(e,t){return Zl(this,void 0,void 0,function*(){this._checkProvider("call");const r=yield Ls(this.checkTransaction(e));return yield this.provider.call(r,t)})}sendTransaction(e){return Zl(this,void 0,void 0,function*(){this._checkProvider("sendTransaction");const t=yield this.populateTransaction(e),r=yield this.signTransaction(t);return yield this.provider.sendTransaction(r)})}getChainId(){return Zl(this,void 0,void 0,function*(){return this._checkProvider("getChainId"),(yield this.provider.getNetwork()).chainId})}getGasPrice(){return Zl(this,void 0,void 0,function*(){return this._checkProvider("getGasPrice"),yield this.provider.getGasPrice()})}getFeeData(){return Zl(this,void 0,void 0,function*(){return this._checkProvider("getFeeData"),yield this.provider.getFeeData()})}resolveName(e){return Zl(this,void 0,void 0,function*(){return this._checkProvider("resolveName"),yield this.provider.resolveName(e)})}checkTransaction(e){for(const r in e)a0e.indexOf(r)===-1&&vl.throwArgumentError("invalid transaction key: "+r,"transaction",e);const t=pi(e);return t.from==null?t.from=this.getAddress():t.from=Promise.all([Promise.resolve(t.from),this.getAddress()]).then(r=>(r[0].toLowerCase()!==r[1].toLowerCase()&&vl.throwArgumentError("from address mismatch","transaction",e),r[0])),t}populateTransaction(e){return Zl(this,void 0,void 0,function*(){const t=yield Ls(this.checkTransaction(e));t.to!=null&&(t.to=Promise.resolve(t.to).then(s=>Zl(this,void 0,void 0,function*(){if(s==null)return null;const i=yield this.resolveName(s);return i==null&&vl.throwArgumentError("provided ENS name resolves to null","tx.to",s),i})),t.to.catch(s=>{}));const r=t.maxFeePerGas!=null||t.maxPriorityFeePerGas!=null;if(t.gasPrice!=null&&(t.type===2||r)?vl.throwArgumentError("eip-1559 transaction do not support gasPrice","transaction",e):(t.type===0||t.type===1)&&r&&vl.throwArgumentError("pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","transaction",e),(t.type===2||t.type==null)&&t.maxFeePerGas!=null&&t.maxPriorityFeePerGas!=null)t.type=2;else if(t.type===0||t.type===1)t.gasPrice==null&&(t.gasPrice=this.getGasPrice());else{const s=yield this.getFeeData();if(t.type==null)if(s.maxFeePerGas!=null&&s.maxPriorityFeePerGas!=null)if(t.type=2,t.gasPrice!=null){const i=t.gasPrice;delete t.gasPrice,t.maxFeePerGas=i,t.maxPriorityFeePerGas=i}else t.maxFeePerGas==null&&(t.maxFeePerGas=s.maxFeePerGas),t.maxPriorityFeePerGas==null&&(t.maxPriorityFeePerGas=s.maxPriorityFeePerGas);else s.gasPrice!=null?(r&&vl.throwError("network does not support EIP-1559",Le.errors.UNSUPPORTED_OPERATION,{operation:"populateTransaction"}),t.gasPrice==null&&(t.gasPrice=s.gasPrice),t.type=0):vl.throwError("failed to get consistent fee data",Le.errors.UNSUPPORTED_OPERATION,{operation:"signer.getFeeData"});else t.type===2&&(t.maxFeePerGas==null&&(t.maxFeePerGas=s.maxFeePerGas),t.maxPriorityFeePerGas==null&&(t.maxPriorityFeePerGas=s.maxPriorityFeePerGas))}return t.nonce==null&&(t.nonce=this.getTransactionCount("pending")),t.gasLimit==null&&(t.gasLimit=this.estimateGas(t).catch(s=>{if(o0e.indexOf(s.code)>=0)throw s;return vl.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Le.errors.UNPREDICTABLE_GAS_LIMIT,{error:s,tx:t})})),t.chainId==null?t.chainId=this.getChainId():t.chainId=Promise.all([Promise.resolve(t.chainId),this.getChainId()]).then(s=>(s[1]!==0&&s[0]!==s[1]&&vl.throwArgumentError("chainId address mismatch","transaction",e),s[0])),yield Ls(t)})}_checkProvider(e){this.provider||vl.throwError("missing provider",Le.errors.UNSUPPORTED_OPERATION,{operation:e||"_checkProvider"})}static isSigner(e){return!!(e&&e._isSigner)}}class eR extends Wg{constructor(e,t){super(),Ke(this,"address",e),Ke(this,"provider",t||null)}getAddress(){return Promise.resolve(this.address)}_fail(e,t){return Promise.resolve().then(()=>{vl.throwError(e,Le.errors.UNSUPPORTED_OPERATION,{operation:t})})}signMessage(e){return this._fail("VoidSigner cannot sign messages","signMessage")}signTransaction(e){return this._fail("VoidSigner cannot sign transactions","signTransaction")}_signTypedData(e,t,r){return this._fail("VoidSigner cannot sign typed data","signTypedData")}connect(e){return new eR(this.address,e)}}var HN={},kr={},WN,E5;function ib(){if(E5)return WN;E5=1,WN=n;function n(e,t){if(!e)throw new Error(t||"Assertion failed")}return n.equal=function(t,r,s){if(t!=r)throw new Error(s||"Assertion failed: "+t+" != "+r)},WN}var tw={exports:{}},S5;function l0e(){return S5||(S5=1,typeof Object.create=="function"?tw.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:tw.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}),tw.exports}var T5;function Du(){if(T5)return kr;T5=1;var n=ib(),e=l0e();kr.inherits=e;function t(K,P){return(K.charCodeAt(P)&64512)!==55296||P<0||P+1>=K.length?!1:(K.charCodeAt(P+1)&64512)===56320}function r(K,P){if(Array.isArray(K))return K.slice();if(!K)return[];var N=[];if(typeof K=="string")if(P){if(P==="hex")for(K=K.replace(/[^a-z0-9]+/ig,""),K.length%2!==0&&(K="0"+K),B=0;B<K.length;B+=2)N.push(parseInt(K[B]+K[B+1],16))}else for(var M=0,B=0;B<K.length;B++){var Y=K.charCodeAt(B);Y<128?N[M++]=Y:Y<2048?(N[M++]=Y>>6|192,N[M++]=Y&63|128):t(K,B)?(Y=65536+((Y&1023)<<10)+(K.charCodeAt(++B)&1023),N[M++]=Y>>18|240,N[M++]=Y>>12&63|128,N[M++]=Y>>6&63|128,N[M++]=Y&63|128):(N[M++]=Y>>12|224,N[M++]=Y>>6&63|128,N[M++]=Y&63|128)}else for(B=0;B<K.length;B++)N[B]=K[B]|0;return N}kr.toArray=r;function s(K){for(var P="",N=0;N<K.length;N++)P+=o(K[N].toString(16));return P}kr.toHex=s;function i(K){var P=K>>>24|K>>>8&65280|K<<8&16711680|(K&255)<<24;return P>>>0}kr.htonl=i;function a(K,P){for(var N="",M=0;M<K.length;M++){var B=K[M];P==="little"&&(B=i(B)),N+=l(B.toString(16))}return N}kr.toHex32=a;function o(K){return K.length===1?"0"+K:K}kr.zero2=o;function l(K){return K.length===7?"0"+K:K.length===6?"00"+K:K.length===5?"000"+K:K.length===4?"0000"+K:K.length===3?"00000"+K:K.length===2?"000000"+K:K.length===1?"0000000"+K:K}kr.zero8=l;function c(K,P,N,M){var B=N-P;n(B%4===0);for(var Y=new Array(B/4),Z=0,ne=P;Z<Y.length;Z++,ne+=4){var Q;M==="big"?Q=K[ne]<<24|K[ne+1]<<16|K[ne+2]<<8|K[ne+3]:Q=K[ne+3]<<24|K[ne+2]<<16|K[ne+1]<<8|K[ne],Y[Z]=Q>>>0}return Y}kr.join32=c;function u(K,P){for(var N=new Array(K.length*4),M=0,B=0;M<K.length;M++,B+=4){var Y=K[M];P==="big"?(N[B]=Y>>>24,N[B+1]=Y>>>16&255,N[B+2]=Y>>>8&255,N[B+3]=Y&255):(N[B+3]=Y>>>24,N[B+2]=Y>>>16&255,N[B+1]=Y>>>8&255,N[B]=Y&255)}return N}kr.split32=u;function d(K,P){return K>>>P|K<<32-P}kr.rotr32=d;function p(K,P){return K<<P|K>>>32-P}kr.rotl32=p;function x(K,P){return K+P>>>0}kr.sum32=x;function y(K,P,N){return K+P+N>>>0}kr.sum32_3=y;function v(K,P,N,M){return K+P+N+M>>>0}kr.sum32_4=v;function b(K,P,N,M,B){return K+P+N+M+B>>>0}kr.sum32_5=b;function S(K,P,N,M){var B=K[P],Y=K[P+1],Z=M+Y>>>0,ne=(Z<M?1:0)+N+B;K[P]=ne>>>0,K[P+1]=Z}kr.sum64=S;function T(K,P,N,M){var B=P+M>>>0,Y=(B<P?1:0)+K+N;return Y>>>0}kr.sum64_hi=T;function C(K,P,N,M){var B=P+M;return B>>>0}kr.sum64_lo=C;function I(K,P,N,M,B,Y,Z,ne){var Q=0,z=P;z=z+M>>>0,Q+=z<P?1:0,z=z+Y>>>0,Q+=z<Y?1:0,z=z+ne>>>0,Q+=z<ne?1:0;var D=K+N+B+Z+Q;return D>>>0}kr.sum64_4_hi=I;function $(K,P,N,M,B,Y,Z,ne){var Q=P+M+Y+ne;return Q>>>0}kr.sum64_4_lo=$;function q(K,P,N,M,B,Y,Z,ne,Q,z){var D=0,X=P;X=X+M>>>0,D+=X<P?1:0,X=X+Y>>>0,D+=X<Y?1:0,X=X+ne>>>0,D+=X<ne?1:0,X=X+z>>>0,D+=X<z?1:0;var re=K+N+B+Z+Q+D;return re>>>0}kr.sum64_5_hi=q;function U(K,P,N,M,B,Y,Z,ne,Q,z){var D=P+M+Y+ne+z;return D>>>0}kr.sum64_5_lo=U;function F(K,P,N){var M=P<<32-N|K>>>N;return M>>>0}kr.rotr64_hi=F;function G(K,P,N){var M=K<<32-N|P>>>N;return M>>>0}kr.rotr64_lo=G;function V(K,P,N){return K>>>N}kr.shr64_hi=V;function O(K,P,N){var M=K<<32-N|P>>>N;return M>>>0}return kr.shr64_lo=O,kr}var qN={},C5;function ab(){if(C5)return qN;C5=1;var n=Du(),e=ib();function t(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return qN.BlockHash=t,t.prototype.update=function(s,i){if(s=n.toArray(s,i),this.pending?this.pending=this.pending.concat(s):this.pending=s,this.pendingTotal+=s.length,this.pending.length>=this._delta8){s=this.pending;var a=s.length%this._delta8;this.pending=s.slice(s.length-a,s.length),this.pending.length===0&&(this.pending=null),s=n.join32(s,0,s.length-a,this.endian);for(var o=0;o<s.length;o+=this._delta32)this._update(s,o,o+this._delta32)}return this},t.prototype.digest=function(s){return this.update(this._pad()),e(this.pending===null),this._digest(s)},t.prototype._pad=function(){var s=this.pendingTotal,i=this._delta8,a=i-(s+this.padLength)%i,o=new Array(a+this.padLength);o[0]=128;for(var l=1;l<a;l++)o[l]=0;if(s<<=3,this.endian==="big"){for(var c=8;c<this.padLength;c++)o[l++]=0;o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=s>>>24&255,o[l++]=s>>>16&255,o[l++]=s>>>8&255,o[l++]=s&255}else for(o[l++]=s&255,o[l++]=s>>>8&255,o[l++]=s>>>16&255,o[l++]=s>>>24&255,o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0,c=8;c<this.padLength;c++)o[l++]=0;return o},qN}var gp={},Fc={},A5;function ZV(){if(A5)return Fc;A5=1;var n=Du(),e=n.rotr32;function t(u,d,p,x){if(u===0)return r(d,p,x);if(u===1||u===3)return i(d,p,x);if(u===2)return s(d,p,x)}Fc.ft_1=t;function r(u,d,p){return u&d^~u&p}Fc.ch32=r;function s(u,d,p){return u&d^u&p^d&p}Fc.maj32=s;function i(u,d,p){return u^d^p}Fc.p32=i;function a(u){return e(u,2)^e(u,13)^e(u,22)}Fc.s0_256=a;function o(u){return e(u,6)^e(u,11)^e(u,25)}Fc.s1_256=o;function l(u){return e(u,7)^e(u,18)^u>>>3}Fc.g0_256=l;function c(u){return e(u,17)^e(u,19)^u>>>10}return Fc.g1_256=c,Fc}var KN,N5;function c0e(){if(N5)return KN;N5=1;var n=Du(),e=ab(),t=ZV(),r=n.rotl32,s=n.sum32,i=n.sum32_5,a=t.ft_1,o=e.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];function c(){if(!(this instanceof c))return new c;o.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return n.inherits(c,o),KN=c,c.blockSize=512,c.outSize=160,c.hmacStrength=80,c.padLength=64,c.prototype._update=function(d,p){for(var x=this.W,y=0;y<16;y++)x[y]=d[p+y];for(;y<x.length;y++)x[y]=r(x[y-3]^x[y-8]^x[y-14]^x[y-16],1);var v=this.h[0],b=this.h[1],S=this.h[2],T=this.h[3],C=this.h[4];for(y=0;y<x.length;y++){var I=~~(y/20),$=i(r(v,5),a(I,b,S,T),C,x[y],l[I]);C=T,T=S,S=r(b,30),b=v,v=$}this.h[0]=s(this.h[0],v),this.h[1]=s(this.h[1],b),this.h[2]=s(this.h[2],S),this.h[3]=s(this.h[3],T),this.h[4]=s(this.h[4],C)},c.prototype._digest=function(d){return d==="hex"?n.toHex32(this.h,"big"):n.split32(this.h,"big")},KN}var XN,k5;function QV(){if(k5)return XN;k5=1;var n=Du(),e=ab(),t=ZV(),r=ib(),s=n.sum32,i=n.sum32_4,a=n.sum32_5,o=t.ch32,l=t.maj32,c=t.s0_256,u=t.s1_256,d=t.g0_256,p=t.g1_256,x=e.BlockHash,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function v(){if(!(this instanceof v))return new v;x.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=y,this.W=new Array(64)}return n.inherits(v,x),XN=v,v.blockSize=512,v.outSize=256,v.hmacStrength=192,v.padLength=64,v.prototype._update=function(S,T){for(var C=this.W,I=0;I<16;I++)C[I]=S[T+I];for(;I<C.length;I++)C[I]=i(p(C[I-2]),C[I-7],d(C[I-15]),C[I-16]);var $=this.h[0],q=this.h[1],U=this.h[2],F=this.h[3],G=this.h[4],V=this.h[5],O=this.h[6],K=this.h[7];for(r(this.k.length===C.length),I=0;I<C.length;I++){var P=a(K,u(G),o(G,V,O),this.k[I],C[I]),N=s(c($),l($,q,U));K=O,O=V,V=G,G=s(F,P),F=U,U=q,q=$,$=s(P,N)}this.h[0]=s(this.h[0],$),this.h[1]=s(this.h[1],q),this.h[2]=s(this.h[2],U),this.h[3]=s(this.h[3],F),this.h[4]=s(this.h[4],G),this.h[5]=s(this.h[5],V),this.h[6]=s(this.h[6],O),this.h[7]=s(this.h[7],K)},v.prototype._digest=function(S){return S==="hex"?n.toHex32(this.h,"big"):n.split32(this.h,"big")},XN}var YN,I5;function u0e(){if(I5)return YN;I5=1;var n=Du(),e=QV();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return n.inherits(t,e),YN=t,t.blockSize=512,t.outSize=224,t.hmacStrength=192,t.padLength=64,t.prototype._digest=function(s){return s==="hex"?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")},YN}var ZN,R5;function JV(){if(R5)return ZN;R5=1;var n=Du(),e=ab(),t=ib(),r=n.rotr64_hi,s=n.rotr64_lo,i=n.shr64_hi,a=n.shr64_lo,o=n.sum64,l=n.sum64_hi,c=n.sum64_lo,u=n.sum64_4_hi,d=n.sum64_4_lo,p=n.sum64_5_hi,x=n.sum64_5_lo,y=e.BlockHash,v=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function b(){if(!(this instanceof b))return new b;y.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=v,this.W=new Array(160)}n.inherits(b,y),ZN=b,b.blockSize=1024,b.outSize=512,b.hmacStrength=192,b.padLength=128,b.prototype._prepareBlock=function(N,M){for(var B=this.W,Y=0;Y<32;Y++)B[Y]=N[M+Y];for(;Y<B.length;Y+=2){var Z=O(B[Y-4],B[Y-3]),ne=K(B[Y-4],B[Y-3]),Q=B[Y-14],z=B[Y-13],D=G(B[Y-30],B[Y-29]),X=V(B[Y-30],B[Y-29]),re=B[Y-32],W=B[Y-31];B[Y]=u(Z,ne,Q,z,D,X,re,W),B[Y+1]=d(Z,ne,Q,z,D,X,re,W)}},b.prototype._update=function(N,M){this._prepareBlock(N,M);var B=this.W,Y=this.h[0],Z=this.h[1],ne=this.h[2],Q=this.h[3],z=this.h[4],D=this.h[5],X=this.h[6],re=this.h[7],W=this.h[8],ae=this.h[9],pe=this.h[10],de=this.h[11],ve=this.h[12],Ve=this.h[13],ze=this.h[14],Ge=this.h[15];t(this.k.length===B.length);for(var at=0;at<B.length;at+=2){var We=ze,nt=Ge,Nt=U(W,ae),ct=F(W,ae),xt=S(W,ae,pe,de,ve),en=T(W,ae,pe,de,ve,Ve),ht=this.k[at],St=this.k[at+1],an=B[at],Ot=B[at+1],Mt=p(We,nt,Nt,ct,xt,en,ht,St,an,Ot),Wn=x(We,nt,Nt,ct,xt,en,ht,St,an,Ot);We=$(Y,Z),nt=q(Y,Z),Nt=C(Y,Z,ne,Q,z),ct=I(Y,Z,ne,Q,z,D);var It=l(We,nt,Nt,ct),Tt=c(We,nt,Nt,ct);ze=ve,Ge=Ve,ve=pe,Ve=de,pe=W,de=ae,W=l(X,re,Mt,Wn),ae=c(re,re,Mt,Wn),X=z,re=D,z=ne,D=Q,ne=Y,Q=Z,Y=l(Mt,Wn,It,Tt),Z=c(Mt,Wn,It,Tt)}o(this.h,0,Y,Z),o(this.h,2,ne,Q),o(this.h,4,z,D),o(this.h,6,X,re),o(this.h,8,W,ae),o(this.h,10,pe,de),o(this.h,12,ve,Ve),o(this.h,14,ze,Ge)},b.prototype._digest=function(N){return N==="hex"?n.toHex32(this.h,"big"):n.split32(this.h,"big")};function S(P,N,M,B,Y){var Z=P&M^~P&Y;return Z<0&&(Z+=4294967296),Z}function T(P,N,M,B,Y,Z){var ne=N&B^~N&Z;return ne<0&&(ne+=4294967296),ne}function C(P,N,M,B,Y){var Z=P&M^P&Y^M&Y;return Z<0&&(Z+=4294967296),Z}function I(P,N,M,B,Y,Z){var ne=N&B^N&Z^B&Z;return ne<0&&(ne+=4294967296),ne}function $(P,N){var M=r(P,N,28),B=r(N,P,2),Y=r(N,P,7),Z=M^B^Y;return Z<0&&(Z+=4294967296),Z}function q(P,N){var M=s(P,N,28),B=s(N,P,2),Y=s(N,P,7),Z=M^B^Y;return Z<0&&(Z+=4294967296),Z}function U(P,N){var M=r(P,N,14),B=r(P,N,18),Y=r(N,P,9),Z=M^B^Y;return Z<0&&(Z+=4294967296),Z}function F(P,N){var M=s(P,N,14),B=s(P,N,18),Y=s(N,P,9),Z=M^B^Y;return Z<0&&(Z+=4294967296),Z}function G(P,N){var M=r(P,N,1),B=r(P,N,8),Y=i(P,N,7),Z=M^B^Y;return Z<0&&(Z+=4294967296),Z}function V(P,N){var M=s(P,N,1),B=s(P,N,8),Y=a(P,N,7),Z=M^B^Y;return Z<0&&(Z+=4294967296),Z}function O(P,N){var M=r(P,N,19),B=r(N,P,29),Y=i(P,N,6),Z=M^B^Y;return Z<0&&(Z+=4294967296),Z}function K(P,N){var M=s(P,N,19),B=s(N,P,29),Y=a(P,N,6),Z=M^B^Y;return Z<0&&(Z+=4294967296),Z}return ZN}var QN,D5;function h0e(){if(D5)return QN;D5=1;var n=Du(),e=JV();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return n.inherits(t,e),QN=t,t.blockSize=1024,t.outSize=384,t.hmacStrength=192,t.padLength=128,t.prototype._digest=function(s){return s==="hex"?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")},QN}var $5;function d0e(){return $5||($5=1,gp.sha1=c0e(),gp.sha224=u0e(),gp.sha256=QV(),gp.sha384=h0e(),gp.sha512=JV()),gp}var JN={},L5;function f0e(){if(L5)return JN;L5=1;var n=Du(),e=ab(),t=n.rotl32,r=n.sum32,s=n.sum32_3,i=n.sum32_4,a=e.BlockHash;function o(){if(!(this instanceof o))return new o;a.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}n.inherits(o,a),JN.ripemd160=o,o.blockSize=512,o.outSize=160,o.hmacStrength=192,o.padLength=64,o.prototype._update=function(b,S){for(var T=this.h[0],C=this.h[1],I=this.h[2],$=this.h[3],q=this.h[4],U=T,F=C,G=I,V=$,O=q,K=0;K<80;K++){var P=r(t(i(T,l(K,C,I,$),b[d[K]+S],c(K)),x[K]),q);T=q,q=$,$=t(I,10),I=C,C=P,P=r(t(i(U,l(79-K,F,G,V),b[p[K]+S],u(K)),y[K]),O),U=O,O=V,V=t(G,10),G=F,F=P}P=s(this.h[1],I,V),this.h[1]=s(this.h[2],$,O),this.h[2]=s(this.h[3],q,U),this.h[3]=s(this.h[4],T,F),this.h[4]=s(this.h[0],C,G),this.h[0]=P},o.prototype._digest=function(b){return b==="hex"?n.toHex32(this.h,"little"):n.split32(this.h,"little")};function l(v,b,S,T){return v<=15?b^S^T:v<=31?b&S|~b&T:v<=47?(b|~S)^T:v<=63?b&T|S&~T:b^(S|~T)}function c(v){return v<=15?0:v<=31?1518500249:v<=47?1859775393:v<=63?2400959708:2840853838}function u(v){return v<=15?1352829926:v<=31?1548603684:v<=47?1836072691:v<=63?2053994217:0}var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],x=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return JN}var ek,P5;function p0e(){if(P5)return ek;P5=1;var n=Du(),e=ib();function t(r,s,i){if(!(this instanceof t))return new t(r,s,i);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(s,i))}return ek=t,t.prototype._init=function(s){s.length>this.blockSize&&(s=new this.Hash().update(s).digest()),e(s.length<=this.blockSize);for(var i=s.length;i<this.blockSize;i++)s.push(0);for(i=0;i<s.length;i++)s[i]^=54;for(this.inner=new this.Hash().update(s),i=0;i<s.length;i++)s[i]^=106;this.outer=new this.Hash().update(s)},t.prototype.update=function(s,i){return this.inner.update(s,i),this},t.prototype.digest=function(s){return this.outer.update(this.inner.digest()),this.outer.digest(s)},ek}var O5;function m0e(){return O5||(O5=1,(function(n){var e=n;e.utils=Du(),e.common=ab(),e.sha=d0e(),e.ripemd=f0e(),e.hmac=p0e(),e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(HN)),HN}var g0e=m0e();const Ho=ku(g0e);function qg(n,e,t){return t={path:e,exports:{},require:function(r,s){return x0e(r,s??t.path)}},n(t,t.exports),t.exports}function x0e(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var tR=eU;function eU(n,e){if(!n)throw new Error(e||"Assertion failed")}eU.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)};var lc=qg(function(n,e){var t=e;function r(a,o){if(Array.isArray(a))return a.slice();if(!a)return[];var l=[];if(typeof a!="string"){for(var c=0;c<a.length;c++)l[c]=a[c]|0;return l}if(o==="hex"){a=a.replace(/[^a-z0-9]+/ig,""),a.length%2!==0&&(a="0"+a);for(var c=0;c<a.length;c+=2)l.push(parseInt(a[c]+a[c+1],16))}else for(var c=0;c<a.length;c++){var u=a.charCodeAt(c),d=u>>8,p=u&255;d?l.push(d,p):l.push(p)}return l}t.toArray=r;function s(a){return a.length===1?"0"+a:a}t.zero2=s;function i(a){for(var o="",l=0;l<a.length;l++)o+=s(a[l].toString(16));return o}t.toHex=i,t.encode=function(o,l){return l==="hex"?i(o):o}}),nl=qg(function(n,e){var t=e;t.assert=tR,t.toArray=lc.toArray,t.zero2=lc.zero2,t.toHex=lc.toHex,t.encode=lc.encode;function r(l,c,u){var d=new Array(Math.max(l.bitLength(),u)+1),p;for(p=0;p<d.length;p+=1)d[p]=0;var x=1<<c+1,y=l.clone();for(p=0;p<d.length;p++){var v,b=y.andln(x-1);y.isOdd()?(b>(x>>1)-1?v=(x>>1)-b:v=b,y.isubn(v)):v=0,d[p]=v,y.iushrn(1)}return d}t.getNAF=r;function s(l,c){var u=[[],[]];l=l.clone(),c=c.clone();for(var d=0,p=0,x;l.cmpn(-d)>0||c.cmpn(-p)>0;){var y=l.andln(3)+d&3,v=c.andln(3)+p&3;y===3&&(y=-1),v===3&&(v=-1);var b;(y&1)===0?b=0:(x=l.andln(7)+d&7,(x===3||x===5)&&v===2?b=-y:b=y),u[0].push(b);var S;(v&1)===0?S=0:(x=c.andln(7)+p&7,(x===3||x===5)&&y===2?S=-v:S=v),u[1].push(S),2*d===b+1&&(d=1-d),2*p===S+1&&(p=1-p),l.iushrn(1),c.iushrn(1)}return u}t.getJSF=s;function i(l,c,u){var d="_"+c;l.prototype[c]=function(){return this[d]!==void 0?this[d]:this[d]=u.call(this)}}t.cachedProperty=i;function a(l){return typeof l=="string"?t.toArray(l,"hex"):l}t.parseBytes=a;function o(l){return new Jt(l,"hex","le")}t.intFromLE=o}),hE=nl.getNAF,y0e=nl.getJSF,dE=nl.assert;function kf(n,e){this.type=n,this.p=new Jt(e.p,16),this.red=e.prime?Jt.red(e.prime):Jt.mont(this.p),this.zero=new Jt(0).toRed(this.red),this.one=new Jt(1).toRed(this.red),this.two=new Jt(2).toRed(this.red),this.n=e.n&&new Jt(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var km=kf;kf.prototype.point=function(){throw new Error("Not implemented")};kf.prototype.validate=function(){throw new Error("Not implemented")};kf.prototype._fixedNafMul=function(e,t){dE(e.precomputed);var r=e._getDoubles(),s=hE(t,1,this._bitLength),i=(1<<r.step+1)-(r.step%2===0?2:1);i/=3;var a=[],o,l;for(o=0;o<s.length;o+=r.step){l=0;for(var c=o+r.step-1;c>=o;c--)l=(l<<1)+s[c];a.push(l)}for(var u=this.jpoint(null,null,null),d=this.jpoint(null,null,null),p=i;p>0;p--){for(o=0;o<a.length;o++)l=a[o],l===p?d=d.mixedAdd(r.points[o]):l===-p&&(d=d.mixedAdd(r.points[o].neg()));u=u.add(d)}return u.toP()};kf.prototype._wnafMul=function(e,t){var r=4,s=e._getNAFPoints(r);r=s.wnd;for(var i=s.points,a=hE(t,r,this._bitLength),o=this.jpoint(null,null,null),l=a.length-1;l>=0;l--){for(var c=0;l>=0&&a[l]===0;l--)c++;if(l>=0&&c++,o=o.dblp(c),l<0)break;var u=a[l];dE(u!==0),e.type==="affine"?u>0?o=o.mixedAdd(i[u-1>>1]):o=o.mixedAdd(i[-u-1>>1].neg()):u>0?o=o.add(i[u-1>>1]):o=o.add(i[-u-1>>1].neg())}return e.type==="affine"?o.toP():o};kf.prototype._wnafMulAdd=function(e,t,r,s,i){var a=this._wnafT1,o=this._wnafT2,l=this._wnafT3,c=0,u,d,p;for(u=0;u<s;u++){p=t[u];var x=p._getNAFPoints(e);a[u]=x.wnd,o[u]=x.points}for(u=s-1;u>=1;u-=2){var y=u-1,v=u;if(a[y]!==1||a[v]!==1){l[y]=hE(r[y],a[y],this._bitLength),l[v]=hE(r[v],a[v],this._bitLength),c=Math.max(l[y].length,c),c=Math.max(l[v].length,c);continue}var b=[t[y],null,null,t[v]];t[y].y.cmp(t[v].y)===0?(b[1]=t[y].add(t[v]),b[2]=t[y].toJ().mixedAdd(t[v].neg())):t[y].y.cmp(t[v].y.redNeg())===0?(b[1]=t[y].toJ().mixedAdd(t[v]),b[2]=t[y].add(t[v].neg())):(b[1]=t[y].toJ().mixedAdd(t[v]),b[2]=t[y].toJ().mixedAdd(t[v].neg()));var S=[-3,-1,-5,-7,0,7,5,1,3],T=y0e(r[y],r[v]);for(c=Math.max(T[0].length,c),l[y]=new Array(c),l[v]=new Array(c),d=0;d<c;d++){var C=T[0][d]|0,I=T[1][d]|0;l[y][d]=S[(C+1)*3+(I+1)],l[v][d]=0,o[y]=b}}var $=this.jpoint(null,null,null),q=this._wnafT4;for(u=c;u>=0;u--){for(var U=0;u>=0;){var F=!0;for(d=0;d<s;d++)q[d]=l[d][u]|0,q[d]!==0&&(F=!1);if(!F)break;U++,u--}if(u>=0&&U++,$=$.dblp(U),u<0)break;for(d=0;d<s;d++){var G=q[d];G!==0&&(G>0?p=o[d][G-1>>1]:G<0&&(p=o[d][-G-1>>1].neg()),p.type==="affine"?$=$.mixedAdd(p):$=$.add(p))}}for(u=0;u<s;u++)o[u]=null;return i?$:$.toP()};function Ll(n,e){this.curve=n,this.type=e,this.precomputed=null}kf.BasePoint=Ll;Ll.prototype.eq=function(){throw new Error("Not implemented")};Ll.prototype.validate=function(){return this.curve.validate(this)};kf.prototype.decodePoint=function(e,t){e=nl.toArray(e,t);var r=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*r){e[0]===6?dE(e[e.length-1]%2===0):e[0]===7&&dE(e[e.length-1]%2===1);var s=this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));return s}else if((e[0]===2||e[0]===3)&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),e[0]===3);throw new Error("Unknown point format")};Ll.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Ll.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))};Ll.prototype.encode=function(e,t){return nl.encode(this._encode(t),e)};Ll.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};Ll.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};Ll.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],s=this,i=0;i<t;i+=e){for(var a=0;a<e;a++)s=s.dbl();r.push(s)}return{step:e,points:r}};Ll.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,s=r===1?null:this.dbl(),i=1;i<r;i++)t[i]=t[i-1].add(s);return{wnd:e,points:t}};Ll.prototype._getBeta=function(){return null};Ll.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t};var nR=qg(function(n){typeof Object.create=="function"?n.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(t,r){if(r){t.super_=r;var s=function(){};s.prototype=r.prototype,t.prototype=new s,t.prototype.constructor=t}}}),b0e=nl.assert;function Pl(n){km.call(this,"short",n),this.a=new Jt(n.a,16).toRed(this.red),this.b=new Jt(n.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(n),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}nR(Pl,km);var v0e=Pl;Pl.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,r;if(e.beta)t=new Jt(e.beta,16).toRed(this.red);else{var s=this._getEndoRoots(this.p);t=s[0].cmp(s[1])<0?s[0]:s[1],t=t.toRed(this.red)}if(e.lambda)r=new Jt(e.lambda,16);else{var i=this._getEndoRoots(this.n);this.g.mul(i[0]).x.cmp(this.g.x.redMul(t))===0?r=i[0]:(r=i[1],b0e(this.g.mul(r).x.cmp(this.g.x.redMul(t))===0))}var a;return e.basis?a=e.basis.map(function(o){return{a:new Jt(o.a,16),b:new Jt(o.b,16)}}):a=this._getEndoBasis(r),{beta:t,lambda:r,basis:a}}};Pl.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:Jt.mont(e),r=new Jt(2).toRed(t).redInvm(),s=r.redNeg(),i=new Jt(3).toRed(t).redNeg().redSqrt().redMul(r),a=s.redAdd(i).fromRed(),o=s.redSub(i).fromRed();return[a,o]};Pl.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),r=e,s=this.n.clone(),i=new Jt(1),a=new Jt(0),o=new Jt(0),l=new Jt(1),c,u,d,p,x,y,v,b=0,S,T;r.cmpn(0)!==0;){var C=s.div(r);S=s.sub(C.mul(r)),T=o.sub(C.mul(i));var I=l.sub(C.mul(a));if(!d&&S.cmp(t)<0)c=v.neg(),u=i,d=S.neg(),p=T;else if(d&&++b===2)break;v=S,s=r,r=S,o=i,i=T,l=a,a=I}x=S.neg(),y=T;var $=d.sqr().add(p.sqr()),q=x.sqr().add(y.sqr());return q.cmp($)>=0&&(x=c,y=u),d.negative&&(d=d.neg(),p=p.neg()),x.negative&&(x=x.neg(),y=y.neg()),[{a:d,b:p},{a:x,b:y}]};Pl.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],s=t[1],i=s.b.mul(e).divRound(this.n),a=r.b.neg().mul(e).divRound(this.n),o=i.mul(r.a),l=a.mul(s.a),c=i.mul(r.b),u=a.mul(s.b),d=e.sub(o).sub(l),p=c.add(u).neg();return{k1:d,k2:p}};Pl.prototype.pointFromX=function(e,t){e=new Jt(e,16),e.red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),s=r.redSqrt();if(s.redSqr().redSub(r).cmp(this.zero)!==0)throw new Error("invalid point");var i=s.fromRed().isOdd();return(t&&!i||!t&&i)&&(s=s.redNeg()),this.point(e,s)};Pl.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,s=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(s).redIAdd(this.b);return r.redSqr().redISub(i).cmpn(0)===0};Pl.prototype._endoWnafMulAdd=function(e,t,r){for(var s=this._endoWnafT1,i=this._endoWnafT2,a=0;a<e.length;a++){var o=this._endoSplit(t[a]),l=e[a],c=l._getBeta();o.k1.negative&&(o.k1.ineg(),l=l.neg(!0)),o.k2.negative&&(o.k2.ineg(),c=c.neg(!0)),s[a*2]=l,s[a*2+1]=c,i[a*2]=o.k1,i[a*2+1]=o.k2}for(var u=this._wnafMulAdd(1,s,i,a*2,r),d=0;d<a*2;d++)s[d]=null,i[d]=null;return u};function Mi(n,e,t,r){km.BasePoint.call(this,n,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Jt(e,16),this.y=new Jt(t,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}nR(Mi,km.BasePoint);Pl.prototype.point=function(e,t,r){return new Mi(this,e,t,r)};Pl.prototype.pointFromJSON=function(e,t){return Mi.fromJSON(this,e,t)};Mi.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,s=function(i){return r.point(i.x.redMul(r.endo.beta),i.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(s)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(s)}}}return t}};Mi.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Mi.fromJSON=function(e,t,r){typeof t=="string"&&(t=JSON.parse(t));var s=e.point(t[0],t[1],r);if(!t[2])return s;function i(o){return e.point(o[0],o[1],r)}var a=t[2];return s.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[s].concat(a.doubles.points.map(i))},naf:a.naf&&{wnd:a.naf.wnd,points:[s].concat(a.naf.points.map(i))}},s};Mi.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Mi.prototype.isInfinity=function(){return this.inf};Mi.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),s=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,s)};Mi.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),s=e.redInvm(),i=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(s),a=i.redSqr().redISub(this.x.redAdd(this.x)),o=i.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,o)};Mi.prototype.getX=function(){return this.x.fromRed()};Mi.prototype.getY=function(){return this.y.fromRed()};Mi.prototype.mul=function(e){return e=new Jt(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Mi.prototype.mulAdd=function(e,t,r){var s=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(s,i):this.curve._wnafMulAdd(1,s,i,2)};Mi.prototype.jmulAdd=function(e,t,r){var s=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(s,i,!0):this.curve._wnafMulAdd(1,s,i,2,!0)};Mi.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Mi.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,s=function(i){return i.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(s)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(s)}}}return t};Mi.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function na(n,e,t,r){km.BasePoint.call(this,n,"jacobian"),e===null&&t===null&&r===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Jt(0)):(this.x=new Jt(e,16),this.y=new Jt(t,16),this.z=new Jt(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}nR(na,km.BasePoint);Pl.prototype.jpoint=function(e,t,r){return new na(this,e,t,r)};na.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),s=this.y.redMul(t).redMul(e);return this.curve.point(r,s)};na.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};na.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),s=this.x.redMul(t),i=e.x.redMul(r),a=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(r.redMul(this.z)),l=s.redSub(i),c=a.redSub(o);if(l.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=l.redSqr(),d=u.redMul(l),p=s.redMul(u),x=c.redSqr().redIAdd(d).redISub(p).redISub(p),y=c.redMul(p.redISub(x)).redISub(a.redMul(d)),v=this.z.redMul(e.z).redMul(l);return this.curve.jpoint(x,y,v)};na.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,s=e.x.redMul(t),i=this.y,a=e.y.redMul(t).redMul(this.z),o=r.redSub(s),l=i.redSub(a);if(o.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var c=o.redSqr(),u=c.redMul(o),d=r.redMul(c),p=l.redSqr().redIAdd(u).redISub(d).redISub(d),x=l.redMul(d.redISub(p)).redISub(i.redMul(u)),y=this.z.redMul(o);return this.curve.jpoint(p,x,y)};na.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var r=this;for(t=0;t<e;t++)r=r.dbl();return r}var s=this.curve.a,i=this.curve.tinv,a=this.x,o=this.y,l=this.z,c=l.redSqr().redSqr(),u=o.redAdd(o);for(t=0;t<e;t++){var d=a.redSqr(),p=u.redSqr(),x=p.redSqr(),y=d.redAdd(d).redIAdd(d).redIAdd(s.redMul(c)),v=a.redMul(p),b=y.redSqr().redISub(v.redAdd(v)),S=v.redISub(b),T=y.redMul(S);T=T.redIAdd(T).redISub(x);var C=u.redMul(l);t+1<e&&(c=c.redMul(x)),a=b,l=C,u=T}return this.curve.jpoint(a,u.redMul(i),l)};na.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};na.prototype._zeroDbl=function(){var e,t,r;if(this.zOne){var s=this.x.redSqr(),i=this.y.redSqr(),a=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(s).redISub(a);o=o.redIAdd(o);var l=s.redAdd(s).redIAdd(s),c=l.redSqr().redISub(o).redISub(o),u=a.redIAdd(a);u=u.redIAdd(u),u=u.redIAdd(u),e=c,t=l.redMul(o.redISub(c)).redISub(u),r=this.y.redAdd(this.y)}else{var d=this.x.redSqr(),p=this.y.redSqr(),x=p.redSqr(),y=this.x.redAdd(p).redSqr().redISub(d).redISub(x);y=y.redIAdd(y);var v=d.redAdd(d).redIAdd(d),b=v.redSqr(),S=x.redIAdd(x);S=S.redIAdd(S),S=S.redIAdd(S),e=b.redISub(y).redISub(y),t=v.redMul(y.redISub(e)).redISub(S),r=this.y.redMul(this.z),r=r.redIAdd(r)}return this.curve.jpoint(e,t,r)};na.prototype._threeDbl=function(){var e,t,r;if(this.zOne){var s=this.x.redSqr(),i=this.y.redSqr(),a=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(s).redISub(a);o=o.redIAdd(o);var l=s.redAdd(s).redIAdd(s).redIAdd(this.curve.a),c=l.redSqr().redISub(o).redISub(o);e=c;var u=a.redIAdd(a);u=u.redIAdd(u),u=u.redIAdd(u),t=l.redMul(o.redISub(c)).redISub(u),r=this.y.redAdd(this.y)}else{var d=this.z.redSqr(),p=this.y.redSqr(),x=this.x.redMul(p),y=this.x.redSub(d).redMul(this.x.redAdd(d));y=y.redAdd(y).redIAdd(y);var v=x.redIAdd(x);v=v.redIAdd(v);var b=v.redAdd(v);e=y.redSqr().redISub(b),r=this.y.redAdd(this.z).redSqr().redISub(p).redISub(d);var S=p.redSqr();S=S.redIAdd(S),S=S.redIAdd(S),S=S.redIAdd(S),t=y.redMul(v.redISub(e)).redISub(S)}return this.curve.jpoint(e,t,r)};na.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,s=this.z,i=s.redSqr().redSqr(),a=t.redSqr(),o=r.redSqr(),l=a.redAdd(a).redIAdd(a).redIAdd(e.redMul(i)),c=t.redAdd(t);c=c.redIAdd(c);var u=c.redMul(o),d=l.redSqr().redISub(u.redAdd(u)),p=u.redISub(d),x=o.redSqr();x=x.redIAdd(x),x=x.redIAdd(x),x=x.redIAdd(x);var y=l.redMul(p).redISub(x),v=r.redAdd(r).redMul(s);return this.curve.jpoint(d,y,v)};na.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),s=t.redSqr(),i=e.redAdd(e).redIAdd(e),a=i.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(s);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(a);var l=o.redSqr(),c=s.redIAdd(s);c=c.redIAdd(c),c=c.redIAdd(c),c=c.redIAdd(c);var u=i.redIAdd(o).redSqr().redISub(a).redISub(l).redISub(c),d=t.redMul(u);d=d.redIAdd(d),d=d.redIAdd(d);var p=this.x.redMul(l).redISub(d);p=p.redIAdd(p),p=p.redIAdd(p);var x=this.y.redMul(u.redMul(c.redISub(u)).redISub(o.redMul(l)));x=x.redIAdd(x),x=x.redIAdd(x),x=x.redIAdd(x);var y=this.z.redAdd(o).redSqr().redISub(r).redISub(l);return this.curve.jpoint(p,x,y)};na.prototype.mul=function(e,t){return e=new Jt(e,t),this.curve._wnafMul(this,e)};na.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var s=t.redMul(this.z),i=r.redMul(e.z);return this.y.redMul(i).redISub(e.y.redMul(s)).cmpn(0)===0};na.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(r)===0)return!0;for(var s=e.clone(),i=this.curve.redN.redMul(t);;){if(s.iadd(this.curve.n),s.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};na.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};na.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var zw=qg(function(n,e){var t=e;t.base=km,t.short=v0e,t.mont=null,t.edwards=null}),jw=qg(function(n,e){var t=e,r=nl.assert;function s(o){o.type==="short"?this.curve=new zw.short(o):o.type==="edwards"?this.curve=new zw.edwards(o):this.curve=new zw.mont(o),this.g=this.curve.g,this.n=this.curve.n,this.hash=o.hash,r(this.g.validate(),"Invalid curve"),r(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=s;function i(o,l){Object.defineProperty(t,o,{configurable:!0,enumerable:!0,get:function(){var c=new s(l);return Object.defineProperty(t,o,{configurable:!0,enumerable:!0,value:c}),c}})}i("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Ho.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),i("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Ho.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),i("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Ho.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),i("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Ho.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),i("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Ho.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),i("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ho.sha256,gRed:!1,g:["9"]}),i("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ho.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var a;try{a=null.crash()}catch{a=void 0}i("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Ho.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",a]})});function ff(n){if(!(this instanceof ff))return new ff(n);this.hash=n.hash,this.predResist=!!n.predResist,this.outLen=this.hash.outSize,this.minEntropy=n.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=lc.toArray(n.entropy,n.entropyEnc||"hex"),t=lc.toArray(n.nonce,n.nonceEnc||"hex"),r=lc.toArray(n.pers,n.persEnc||"hex");tR(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,r)}var tU=ff;ff.prototype._init=function(e,t,r){var s=e.concat(t).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(s),this._reseed=1,this.reseedInterval=281474976710656};ff.prototype._hmac=function(){return new Ho.hmac(this.hash,this.K)};ff.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};ff.prototype.reseed=function(e,t,r,s){typeof t!="string"&&(s=r,r=t,t=null),e=lc.toArray(e,t),r=lc.toArray(r,s),tR(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1};ff.prototype.generate=function(e,t,r,s){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(s=r,r=t,t=null),r&&(r=lc.toArray(r,s||"hex"),this._update(r));for(var i=[];i.length<e;)this.V=this._hmac().update(this.V).digest(),i=i.concat(this.V);var a=i.slice(0,e);return this._update(r),this._reseed++,lc.encode(a,t)};var vI=nl.assert;function Na(n,e){this.ec=n,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var rR=Na;Na.fromPublic=function(e,t,r){return t instanceof Na?t:new Na(e,{pub:t,pubEnc:r})};Na.fromPrivate=function(e,t,r){return t instanceof Na?t:new Na(e,{priv:t,privEnc:r})};Na.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Na.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};Na.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};Na.prototype._importPrivate=function(e,t){this.priv=new Jt(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};Na.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?vI(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&vI(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};Na.prototype.derive=function(e){return e.validate()||vI(e.validate(),"public point not validated"),e.mul(this.priv).getX()};Na.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)};Na.prototype.verify=function(e,t,r){return this.ec.verify(e,t,this,void 0,r)};Na.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var _0e=nl.assert;function PS(n,e){if(n instanceof PS)return n;this._importDER(n,e)||(_0e(n.r&&n.s,"Signature without r or s"),this.r=new Jt(n.r,16),this.s=new Jt(n.s,16),n.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=n.recoveryParam)}var OS=PS;function w0e(){this.place=0}function tk(n,e){var t=n[e.place++];if(!(t&128))return t;var r=t&15;if(r===0||r>4||n[e.place]===0)return!1;for(var s=0,i=0,a=e.place;i<r;i++,a++)s<<=8,s|=n[a],s>>>=0;return s<=127?!1:(e.place=a,s)}function M5(n){for(var e=0,t=n.length-1;!n[e]&&!(n[e+1]&128)&&e<t;)e++;return e===0?n:n.slice(e)}PS.prototype._importDER=function(e,t){e=nl.toArray(e,t);var r=new w0e;if(e[r.place++]!==48)return!1;var s=tk(e,r);if(s===!1||s+r.place!==e.length||e[r.place++]!==2)return!1;var i=tk(e,r);if(i===!1||(e[r.place]&128)!==0)return!1;var a=e.slice(r.place,i+r.place);if(r.place+=i,e[r.place++]!==2)return!1;var o=tk(e,r);if(o===!1||e.length!==o+r.place||(e[r.place]&128)!==0)return!1;var l=e.slice(r.place,o+r.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(l[0]===0)if(l[1]&128)l=l.slice(1);else return!1;return this.r=new Jt(a),this.s=new Jt(l),this.recoveryParam=null,!0};function nk(n,e){if(e<128){n.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(n.push(t|128);--t;)n.push(e>>>(t<<3)&255);n.push(e)}PS.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),r[0]&128&&(r=[0].concat(r)),t=M5(t),r=M5(r);!r[0]&&!(r[1]&128);)r=r.slice(1);var s=[2];nk(s,t.length),s=s.concat(t),s.push(2),nk(s,r.length);var i=s.concat(r),a=[48];return nk(a,i.length),a=a.concat(i),nl.encode(a,e)};var E0e=(function(){throw new Error("unsupported")}),Ep=nl.assert;function Rl(n){if(!(this instanceof Rl))return new Rl(n);typeof n=="string"&&(Ep(Object.prototype.hasOwnProperty.call(jw,n),"Unknown curve "+n),n=jw[n]),n instanceof jw.PresetCurve&&(n={curve:n}),this.curve=n.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=n.curve.g,this.g.precompute(n.curve.n.bitLength()+1),this.hash=n.hash||n.curve.hash}var S0e=Rl;Rl.prototype.keyPair=function(e){return new rR(this,e)};Rl.prototype.keyFromPrivate=function(e,t){return rR.fromPrivate(this,e,t)};Rl.prototype.keyFromPublic=function(e,t){return rR.fromPublic(this,e,t)};Rl.prototype.genKeyPair=function(e){e||(e={});for(var t=new tU({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||E0e(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),s=this.n.sub(new Jt(2));;){var i=new Jt(t.generate(r));if(!(i.cmp(s)>0))return i.iaddn(1),this.keyFromPrivate(i)}};Rl.prototype._truncateToN=function(e,t,r){var s;if(Jt.isBN(e)||typeof e=="number")e=new Jt(e,16),s=e.byteLength();else if(typeof e=="object")s=e.length,e=new Jt(e,16);else{var i=e.toString();s=i.length+1>>>1,e=new Jt(i,16)}typeof r!="number"&&(r=s*8);var a=r-this.n.bitLength();return a>0&&(e=e.ushrn(a)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};Rl.prototype.sign=function(e,t,r,s){if(typeof r=="object"&&(s=r,r=null),s||(s={}),typeof e!="string"&&typeof e!="number"&&!Jt.isBN(e)){Ep(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),Ep(e.length>>>0===e.length);for(var i=0;i<e.length;i++)Ep((e[i]&255)===e[i])}t=this.keyFromPrivate(t,r),e=this._truncateToN(e,!1,s.msgBitLength),Ep(!e.isNeg(),"Can not sign a negative message");var a=this.n.byteLength(),o=t.getPrivate().toArray("be",a),l=e.toArray("be",a);Ep(new Jt(l).eq(e),"Can not sign message");for(var c=new tU({hash:this.hash,entropy:o,nonce:l,pers:s.pers,persEnc:s.persEnc||"utf8"}),u=this.n.sub(new Jt(1)),d=0;;d++){var p=s.k?s.k(d):new Jt(c.generate(this.n.byteLength()));if(p=this._truncateToN(p,!0),!(p.cmpn(1)<=0||p.cmp(u)>=0)){var x=this.g.mul(p);if(!x.isInfinity()){var y=x.getX(),v=y.umod(this.n);if(v.cmpn(0)!==0){var b=p.invm(this.n).mul(v.mul(t.getPrivate()).iadd(e));if(b=b.umod(this.n),b.cmpn(0)!==0){var S=(x.getY().isOdd()?1:0)|(y.cmp(v)!==0?2:0);return s.canonical&&b.cmp(this.nh)>0&&(b=this.n.sub(b),S^=1),new OS({r:v,s:b,recoveryParam:S})}}}}}};Rl.prototype.verify=function(e,t,r,s,i){i||(i={}),e=this._truncateToN(e,!1,i.msgBitLength),r=this.keyFromPublic(r,s),t=new OS(t,"hex");var a=t.r,o=t.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var l=o.invm(this.n),c=l.mul(e).umod(this.n),u=l.mul(a).umod(this.n),d;return this.curve._maxwellTrick?(d=this.g.jmulAdd(c,r.getPublic(),u),d.isInfinity()?!1:d.eqXToP(a)):(d=this.g.mulAdd(c,r.getPublic(),u),d.isInfinity()?!1:d.getX().umod(this.n).cmp(a)===0)};Rl.prototype.recoverPubKey=function(n,e,t,r){Ep((3&t)===t,"The recovery param is more than two bits"),e=new OS(e,r);var s=this.n,i=new Jt(n),a=e.r,o=e.s,l=t&1,c=t>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&c)throw new Error("Unable to find sencond key candinate");c?a=this.curve.pointFromX(a.add(this.curve.n),l):a=this.curve.pointFromX(a,l);var u=e.r.invm(s),d=s.sub(i).mul(u).umod(s),p=o.mul(u).umod(s);return this.g.mulAdd(d,a,p)};Rl.prototype.getKeyRecoveryParam=function(n,e,t,r){if(e=new OS(e,r),e.recoveryParam!==null)return e.recoveryParam;for(var s=0;s<4;s++){var i;try{i=this.recoverPubKey(n,e,s)}catch{continue}if(i.eq(t))return s}throw new Error("Unable to find valid recovery factor")};var T0e=qg(function(n,e){var t=e;t.version="6.6.1",t.utils=nl,t.rand=(function(){throw new Error("unsupported")}),t.curve=zw,t.curves=jw,t.ec=S0e,t.eddsa=null}),C0e=T0e.ec;const A0e="signing-key/5.8.0",_I=new Le(A0e);let rk=null;function Rd(){return rk||(rk=new C0e("secp256k1")),rk}class eg{constructor(e){Ke(this,"curve","secp256k1"),Ke(this,"privateKey",ot(e)),Qp(this.privateKey)!==32&&_I.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const t=Rd().keyFromPrivate(rt(this.privateKey));Ke(this,"publicKey","0x"+t.getPublic(!1,"hex")),Ke(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),Ke(this,"_isSigningKey",!0)}_addPoint(e){const t=Rd().keyFromPublic(rt(this.publicKey)),r=Rd().keyFromPublic(rt(e));return"0x"+t.pub.add(r.pub).encodeCompressed("hex")}signDigest(e){const t=Rd().keyFromPrivate(rt(this.privateKey)),r=rt(e);r.length!==32&&_I.throwArgumentError("bad digest length","digest",e);const s=t.sign(r,{canonical:!0});return Hg({recoveryParam:s.recoveryParam,r:Gr("0x"+s.r.toString(16),32),s:Gr("0x"+s.s.toString(16),32)})}computeSharedSecret(e){const t=Rd().keyFromPrivate(rt(this.privateKey)),r=Rd().keyFromPublic(rt(nU(e)));return Gr("0x"+t.derive(r.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function N0e(n,e){const t=Hg(e),r={r:rt(t.r),s:rt(t.s)};return"0x"+Rd().recoverPubKey(rt(n),r,t.recoveryParam).encode("hex",!1)}function nU(n,e){const t=rt(n);return t.length===32?new eg(t).publicKey:t.length===33?"0x"+Rd().keyFromPublic(t).getPublic(!1,"hex"):t.length===65?ot(t):_I.throwArgumentError("invalid public or private key","key","[REDACTED]")}const k0e="transactions/5.8.0",Sa=new Le(k0e);var F5;(function(n){n[n.legacy=0]="legacy",n[n.eip2930=1]="eip2930",n[n.eip1559=2]="eip1559"})(F5||(F5={}));function sR(n){return n==="0x"?null:Es(n)}function _a(n){return n==="0x"?PV:st.from(n)}const I0e=[{name:"nonce",maxLength:32,numeric:!0},{name:"gasPrice",maxLength:32,numeric:!0},{name:"gasLimit",maxLength:32,numeric:!0},{name:"to",length:20},{name:"value",maxLength:32,numeric:!0},{name:"data"}],R0e={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,type:!0,value:!0};function Op(n){const e=nU(n);return Es(ui(Yr(ui(e,1)),12))}function rU(n,e){return Op(N0e(rt(n),e))}function qo(n,e){const t=bh(st.from(n).toHexString());return t.length>32&&Sa.throwArgumentError("invalid length for "+e,"transaction:"+e,n),t}function sk(n,e){return{address:Es(n),storageKeys:(e||[]).map((t,r)=>(Qp(t)!==32&&Sa.throwArgumentError("invalid access list storageKey",`accessList[${n}:${r}]`,t),t.toLowerCase()))}}function Kg(n){if(Array.isArray(n))return n.map((t,r)=>Array.isArray(t)?(t.length>2&&Sa.throwArgumentError("access list expected to be [ address, storageKeys[] ]",`value[${r}]`,t),sk(t[0],t[1])):sk(t.address,t.storageKeys));const e=Object.keys(n).map(t=>{const r=n[t].reduce((s,i)=>(s[i]=!0,s),{});return sk(t,Object.keys(r).sort())});return e.sort((t,r)=>t.address.localeCompare(r.address)),e}function sU(n){return Kg(n).map(e=>[e.address,e.storageKeys])}function iU(n,e){if(n.gasPrice!=null){const r=st.from(n.gasPrice),s=st.from(n.maxFeePerGas||0);r.eq(s)||Sa.throwArgumentError("mismatch EIP-1559 gasPrice != maxFeePerGas","tx",{gasPrice:r,maxFeePerGas:s})}const t=[qo(n.chainId||0,"chainId"),qo(n.nonce||0,"nonce"),qo(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),qo(n.maxFeePerGas||0,"maxFeePerGas"),qo(n.gasLimit||0,"gasLimit"),n.to!=null?Es(n.to):"0x",qo(n.value||0,"value"),n.data||"0x",sU(n.accessList||[])];if(e){const r=Hg(e);t.push(qo(r.recoveryParam,"recoveryParam")),t.push(bh(r.r)),t.push(bh(r.s))}return xo(["0x02",gg(t)])}function aU(n,e){const t=[qo(n.chainId||0,"chainId"),qo(n.nonce||0,"nonce"),qo(n.gasPrice||0,"gasPrice"),qo(n.gasLimit||0,"gasLimit"),n.to!=null?Es(n.to):"0x",qo(n.value||0,"value"),n.data||"0x",sU(n.accessList||[])];if(e){const r=Hg(e);t.push(qo(r.recoveryParam,"recoveryParam")),t.push(bh(r.r)),t.push(bh(r.s))}return xo(["0x01",gg(t)])}function D0e(n,e){SV(n,R0e);const t=[];I0e.forEach(function(a){let o=n[a.name]||[];const l={};a.numeric&&(l.hexPad="left"),o=rt(ot(o,l)),a.length&&o.length!==a.length&&o.length>0&&Sa.throwArgumentError("invalid length for "+a.name,"transaction:"+a.name,o),a.maxLength&&(o=bh(o),o.length>a.maxLength&&Sa.throwArgumentError("invalid length for "+a.name,"transaction:"+a.name,o)),t.push(ot(o))});let r=0;if(n.chainId!=null?(r=n.chainId,typeof r!="number"&&Sa.throwArgumentError("invalid transaction.chainId","transaction",n)):e&&!$S(e)&&e.v>28&&(r=Math.floor((e.v-35)/2)),r!==0&&(t.push(ot(r)),t.push("0x"),t.push("0x")),!e)return gg(t);const s=Hg(e);let i=27+s.recoveryParam;return r!==0?(t.pop(),t.pop(),t.pop(),i+=r*2+8,s.v>28&&s.v!==i&&Sa.throwArgumentError("transaction.chainId/signature.v mismatch","signature",e)):s.v!==i&&Sa.throwArgumentError("transaction.chainId/signature.v mismatch","signature",e),t.push(ot(i)),t.push(bh(rt(s.r))),t.push(bh(rt(s.s))),gg(t)}function B5(n,e){if(n.type==null||n.type===0)return n.accessList!=null&&Sa.throwArgumentError("untyped transactions do not support accessList; include type: 1","transaction",n),D0e(n,e);switch(n.type){case 1:return aU(n,e);case 2:return iU(n,e)}return Sa.throwError(`unsupported transaction type: ${n.type}`,Le.errors.UNSUPPORTED_OPERATION,{operation:"serializeTransaction",transactionType:n.type})}function oU(n,e,t){try{const r=_a(e[0]).toNumber();if(r!==0&&r!==1)throw new Error("bad recid");n.v=r}catch{Sa.throwArgumentError("invalid v for transaction type: 1","v",e[0])}n.r=Gr(e[1],32),n.s=Gr(e[2],32);try{const r=Yr(t(n));n.from=rU(r,{r:n.r,s:n.s,recoveryParam:n.v})}catch{}}function $0e(n){const e=Q4(n.slice(1));e.length!==9&&e.length!==12&&Sa.throwArgumentError("invalid component count for transaction type: 2","payload",ot(n));const t=_a(e[2]),r=_a(e[3]),s={type:2,chainId:_a(e[0]).toNumber(),nonce:_a(e[1]).toNumber(),maxPriorityFeePerGas:t,maxFeePerGas:r,gasPrice:null,gasLimit:_a(e[4]),to:sR(e[5]),value:_a(e[6]),data:e[7],accessList:Kg(e[8])};return e.length===9||(s.hash=Yr(n),oU(s,e.slice(9),iU)),s}function L0e(n){const e=Q4(n.slice(1));e.length!==8&&e.length!==11&&Sa.throwArgumentError("invalid component count for transaction type: 1","payload",ot(n));const t={type:1,chainId:_a(e[0]).toNumber(),nonce:_a(e[1]).toNumber(),gasPrice:_a(e[2]),gasLimit:_a(e[3]),to:sR(e[4]),value:_a(e[5]),data:e[6],accessList:Kg(e[7])};return e.length===8||(t.hash=Yr(n),oU(t,e.slice(8),aU)),t}function P0e(n){const e=Q4(n);e.length!==9&&e.length!==6&&Sa.throwArgumentError("invalid raw transaction","rawTransaction",n);const t={nonce:_a(e[0]).toNumber(),gasPrice:_a(e[1]),gasLimit:_a(e[2]),to:sR(e[3]),value:_a(e[4]),data:e[5],chainId:0};if(e.length===6)return t;try{t.v=st.from(e[6]).toNumber()}catch{return t}if(t.r=Gr(e[7],32),t.s=Gr(e[8],32),st.from(t.r).isZero()&&st.from(t.s).isZero())t.chainId=t.v,t.v=0;else{t.chainId=Math.floor((t.v-35)/2),t.chainId<0&&(t.chainId=0);let r=t.v-27;const s=e.slice(0,6);t.chainId!==0&&(s.push(ot(t.chainId)),s.push("0x"),s.push("0x"),r-=t.chainId*2+8);const i=Yr(gg(s));try{t.from=rU(i,{r:ot(t.r),s:ot(t.s),recoveryParam:r})}catch{}t.hash=Yr(n)}return t.type=null,t}function O0e(n){const e=rt(n);if(e[0]>127)return P0e(e);switch(e[0]){case 1:return L0e(e);case 2:return $0e(e)}return Sa.throwError(`unsupported transaction type: ${e[0]}`,Le.errors.UNSUPPORTED_OPERATION,{operation:"parseTransaction",transactionType:e[0]})}const M0e="contracts/5.8.0";var em=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const Ps=new Le(M0e);function fE(n,e){return em(this,void 0,void 0,function*(){const t=yield e;typeof t!="string"&&Ps.throwArgumentError("invalid address or ENS name","name",t);try{return Es(t)}catch{}n||Ps.throwError("a provider or signer is needed to resolve ENS names",Le.errors.UNSUPPORTED_OPERATION,{operation:"resolveName"});const r=yield n.resolveName(t);return r==null&&Ps.throwArgumentError("resolver or addr is not configured for ENS name","name",t),r})}function Vw(n,e,t){return em(this,void 0,void 0,function*(){return Array.isArray(t)?yield Promise.all(t.map((r,s)=>Vw(n,Array.isArray(e)?e[s]:e[r.name],r))):t.type==="address"?yield fE(n,e):t.type==="tuple"?yield Vw(n,e,t.components):t.baseType==="array"?Array.isArray(e)?yield Promise.all(e.map(r=>Vw(n,r,t.arrayChildren))):Promise.reject(Ps.makeError("invalid value for array",Le.errors.INVALID_ARGUMENT,{argument:"value",value:e})):e})}function MS(n,e,t){return em(this,void 0,void 0,function*(){let r={};t.length===e.inputs.length+1&&typeof t[t.length-1]=="object"&&(r=pi(t.pop())),Ps.checkArgumentCount(t.length,e.inputs.length,"passed to contract"),n.signer?r.from?r.from=Ls({override:fE(n.signer,r.from),signer:n.signer.getAddress()}).then(c=>em(this,void 0,void 0,function*(){return Es(c.signer)!==c.override&&Ps.throwError("Contract with a Signer cannot override from",Le.errors.UNSUPPORTED_OPERATION,{operation:"overrides.from"}),c.override})):r.from=n.signer.getAddress():r.from&&(r.from=fE(n.provider,r.from));const s=yield Ls({args:Vw(n.signer||n.provider,t,e.inputs),address:n.resolvedAddress,overrides:Ls(r)||{}}),i=n.interface.encodeFunctionData(e,s.args),a={data:i,to:s.address},o=s.overrides;if(o.nonce!=null&&(a.nonce=st.from(o.nonce).toNumber()),o.gasLimit!=null&&(a.gasLimit=st.from(o.gasLimit)),o.gasPrice!=null&&(a.gasPrice=st.from(o.gasPrice)),o.maxFeePerGas!=null&&(a.maxFeePerGas=st.from(o.maxFeePerGas)),o.maxPriorityFeePerGas!=null&&(a.maxPriorityFeePerGas=st.from(o.maxPriorityFeePerGas)),o.from!=null&&(a.from=o.from),o.type!=null&&(a.type=o.type),o.accessList!=null&&(a.accessList=Kg(o.accessList)),a.gasLimit==null&&e.gas!=null){let c=21e3;const u=rt(i);for(let d=0;d<u.length;d++)c+=4,u[d]&&(c+=64);a.gasLimit=st.from(e.gas).add(c)}if(o.value){const c=st.from(o.value);!c.isZero()&&!e.payable&&Ps.throwError("non-payable method cannot override value",Le.errors.UNSUPPORTED_OPERATION,{operation:"overrides.value",value:r.value}),a.value=c}o.customData&&(a.customData=pi(o.customData)),o.ccipReadEnabled&&(a.ccipReadEnabled=!!o.ccipReadEnabled),delete r.nonce,delete r.gasLimit,delete r.gasPrice,delete r.from,delete r.value,delete r.type,delete r.accessList,delete r.maxFeePerGas,delete r.maxPriorityFeePerGas,delete r.customData,delete r.ccipReadEnabled;const l=Object.keys(r).filter(c=>r[c]!=null);return l.length&&Ps.throwError(`cannot override ${l.map(c=>JSON.stringify(c)).join(",")}`,Le.errors.UNSUPPORTED_OPERATION,{operation:"overrides",overrides:l}),a})}function F0e(n,e){return function(...t){return MS(n,e,t)}}function B0e(n,e){const t=n.signer||n.provider;return function(...r){return em(this,void 0,void 0,function*(){t||Ps.throwError("estimate require a provider or signer",Le.errors.UNSUPPORTED_OPERATION,{operation:"estimateGas"});const s=yield MS(n,e,r);return yield t.estimateGas(s)})}}function z0e(n,e){const t=e.wait.bind(e);e.wait=r=>t(r).then(s=>(s.events=s.logs.map(i=>{let a=Ah(i),o=null;try{o=n.interface.parseLog(i)}catch{}return o&&(a.args=o.args,a.decode=(l,c)=>n.interface.decodeEventLog(o.eventFragment,l,c),a.event=o.name,a.eventSignature=o.signature),a.removeListener=()=>n.provider,a.getBlock=()=>n.provider.getBlock(s.blockHash),a.getTransaction=()=>n.provider.getTransaction(s.transactionHash),a.getTransactionReceipt=()=>Promise.resolve(s),a}),s))}function lU(n,e,t){const r=n.signer||n.provider;return function(...s){return em(this,void 0,void 0,function*(){let i;if(s.length===e.inputs.length+1&&typeof s[s.length-1]=="object"){const l=pi(s.pop());l.blockTag!=null&&(i=yield l.blockTag),delete l.blockTag,s.push(l)}n.deployTransaction!=null&&(yield n._deployed(i));const a=yield MS(n,e,s),o=yield r.call(a,i);try{let l=n.interface.decodeFunctionResult(e,o);return t&&e.outputs.length===1&&(l=l[0]),l}catch(l){throw l.code===Le.errors.CALL_EXCEPTION&&(l.address=n.address,l.args=s,l.transaction=a),l}})}}function j0e(n,e){return function(...t){return em(this,void 0,void 0,function*(){n.signer||Ps.throwError("sending a transaction requires a signer",Le.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction"}),n.deployTransaction!=null&&(yield n._deployed());const r=yield MS(n,e,t),s=yield n.signer.sendTransaction(r);return z0e(n,s),s})}}function z5(n,e,t){return e.constant?lU(n,e,t):j0e(n,e)}function cU(n){return n.address&&(n.topics==null||n.topics.length===0)?"*":(n.address||"*")+"@"+(n.topics?n.topics.map(e=>Array.isArray(e)?e.join("|"):e).join(":"):"")}class h1{constructor(e,t){Ke(this,"tag",e),Ke(this,"filter",t),this._listeners=[]}addListener(e,t){this._listeners.push({listener:e,once:t})}removeListener(e){let t=!1;this._listeners=this._listeners.filter(r=>t||r.listener!==e?!0:(t=!0,!1))}removeAllListeners(){this._listeners=[]}listeners(){return this._listeners.map(e=>e.listener)}listenerCount(){return this._listeners.length}run(e){const t=this.listenerCount();return this._listeners=this._listeners.filter(r=>{const s=e.slice();return setTimeout(()=>{r.listener.apply(this,s)},0),!r.once}),t}prepareEvent(e){}getEmit(e){return[e]}}class V0e extends h1{constructor(){super("error",null)}}class j5 extends h1{constructor(e,t,r,s){const i={address:e};let a=t.getEventTopic(r);s?(a!==s[0]&&Ps.throwArgumentError("topic mismatch","topics",s),i.topics=s.slice()):i.topics=[a],super(cU(i),i),Ke(this,"address",e),Ke(this,"interface",t),Ke(this,"fragment",r)}prepareEvent(e){super.prepareEvent(e),e.event=this.fragment.name,e.eventSignature=this.fragment.format(),e.decode=(t,r)=>this.interface.decodeEventLog(this.fragment,t,r);try{e.args=this.interface.decodeEventLog(this.fragment,e.data,e.topics)}catch(t){e.args=null,e.decodeError=t}}getEmit(e){const t=Bpe(e.args);if(t.length)throw t[0].error;const r=(e.args||[]).slice();return r.push(e),r}}class V5 extends h1{constructor(e,t){super("*",{address:e}),Ke(this,"address",e),Ke(this,"interface",t)}prepareEvent(e){super.prepareEvent(e);try{const t=this.interface.parseLog(e);e.event=t.name,e.eventSignature=t.signature,e.decode=(r,s)=>this.interface.decodeEventLog(t.eventFragment,r,s),e.args=t.args}catch{}}}class U0e{constructor(e,t,r){Ke(this,"interface",Qc(new.target,"getInterface")(t)),r==null?(Ke(this,"provider",null),Ke(this,"signer",null)):Wg.isSigner(r)?(Ke(this,"provider",r.provider||null),Ke(this,"signer",r)):sb.isProvider(r)?(Ke(this,"provider",r),Ke(this,"signer",null)):Ps.throwArgumentError("invalid signer or provider","signerOrProvider",r),Ke(this,"callStatic",{}),Ke(this,"estimateGas",{}),Ke(this,"functions",{}),Ke(this,"populateTransaction",{}),Ke(this,"filters",{});{const a={};Object.keys(this.interface.events).forEach(o=>{const l=this.interface.events[o];Ke(this.filters,o,(...c)=>({address:this.address,topics:this.interface.encodeFilterTopics(l,c)})),a[l.name]||(a[l.name]=[]),a[l.name].push(o)}),Object.keys(a).forEach(o=>{const l=a[o];l.length===1?Ke(this.filters,o,this.filters[l[0]]):Ps.warn(`Duplicate definition of ${o} (${l.join(", ")})`)})}if(Ke(this,"_runningEvents",{}),Ke(this,"_wrappedEmits",{}),e==null&&Ps.throwArgumentError("invalid contract address or ENS name","addressOrName",e),Ke(this,"address",e),this.provider)Ke(this,"resolvedAddress",fE(this.provider,e));else try{Ke(this,"resolvedAddress",Promise.resolve(Es(e)))}catch{Ps.throwError("provider is required to use ENS name as contract address",Le.errors.UNSUPPORTED_OPERATION,{operation:"new Contract"})}this.resolvedAddress.catch(a=>{});const s={},i={};Object.keys(this.interface.functions).forEach(a=>{const o=this.interface.functions[a];if(i[a]){Ps.warn(`Duplicate ABI entry for ${JSON.stringify(a)}`);return}i[a]=!0;{const l=o.name;s[`%${l}`]||(s[`%${l}`]=[]),s[`%${l}`].push(a)}this[a]==null&&Ke(this,a,z5(this,o,!0)),this.functions[a]==null&&Ke(this.functions,a,z5(this,o,!1)),this.callStatic[a]==null&&Ke(this.callStatic,a,lU(this,o,!0)),this.populateTransaction[a]==null&&Ke(this.populateTransaction,a,F0e(this,o)),this.estimateGas[a]==null&&Ke(this.estimateGas,a,B0e(this,o))}),Object.keys(s).forEach(a=>{const o=s[a];if(o.length>1)return;a=a.substring(1);const l=o[0];try{this[a]==null&&Ke(this,a,this[l])}catch{}this.functions[a]==null&&Ke(this.functions,a,this.functions[l]),this.callStatic[a]==null&&Ke(this.callStatic,a,this.callStatic[l]),this.populateTransaction[a]==null&&Ke(this.populateTransaction,a,this.populateTransaction[l]),this.estimateGas[a]==null&&Ke(this.estimateGas,a,this.estimateGas[l])})}static getContractAddress(e){return RV(e)}static getInterface(e){return w5.isInterface(e)?e:new w5(e)}deployed(){return this._deployed()}_deployed(e){return this._deployedPromise||(this.deployTransaction?this._deployedPromise=this.deployTransaction.wait().then(()=>this):this._deployedPromise=this.provider.getCode(this.address,e).then(t=>(t==="0x"&&Ps.throwError("contract not deployed",Le.errors.UNSUPPORTED_OPERATION,{contractAddress:this.address,operation:"getDeployed"}),this))),this._deployedPromise}fallback(e){this.signer||Ps.throwError("sending a transactions require a signer",Le.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction(fallback)"});const t=pi(e||{});return["from","to"].forEach(function(r){t[r]!=null&&Ps.throwError("cannot override "+r,Le.errors.UNSUPPORTED_OPERATION,{operation:r})}),t.to=this.resolvedAddress,this.deployed().then(()=>this.signer.sendTransaction(t))}connect(e){typeof e=="string"&&(e=new eR(e,this.provider));const t=new this.constructor(this.address,this.interface,e);return this.deployTransaction&&Ke(t,"deployTransaction",this.deployTransaction),t}attach(e){return new this.constructor(e,this.interface,this.signer||this.provider)}static isIndexed(e){return bI.isIndexed(e)}_normalizeRunningEvent(e){return this._runningEvents[e.tag]?this._runningEvents[e.tag]:e}_getRunningEvent(e){if(typeof e=="string"){if(e==="error")return this._normalizeRunningEvent(new V0e);if(e==="event")return this._normalizeRunningEvent(new h1("event",null));if(e==="*")return this._normalizeRunningEvent(new V5(this.address,this.interface));const t=this.interface.getEvent(e);return this._normalizeRunningEvent(new j5(this.address,this.interface,t))}if(e.topics&&e.topics.length>0){try{const r=e.topics[0];if(typeof r!="string")throw new Error("invalid topic");const s=this.interface.getEvent(r);return this._normalizeRunningEvent(new j5(this.address,this.interface,s,e.topics))}catch{}const t={address:this.address,topics:e.topics};return this._normalizeRunningEvent(new h1(cU(t),t))}return this._normalizeRunningEvent(new V5(this.address,this.interface))}_checkRunningEvents(e){if(e.listenerCount()===0){delete this._runningEvents[e.tag];const t=this._wrappedEmits[e.tag];t&&e.filter&&(this.provider.off(e.filter,t),delete this._wrappedEmits[e.tag])}}_wrapEvent(e,t,r){const s=Ah(t);return s.removeListener=()=>{r&&(e.removeListener(r),this._checkRunningEvents(e))},s.getBlock=()=>this.provider.getBlock(t.blockHash),s.getTransaction=()=>this.provider.getTransaction(t.transactionHash),s.getTransactionReceipt=()=>this.provider.getTransactionReceipt(t.transactionHash),e.prepareEvent(s),s}_addEventListener(e,t,r){if(this.provider||Ps.throwError("events require a provider or a signer with a provider",Le.errors.UNSUPPORTED_OPERATION,{operation:"once"}),e.addListener(t,r),this._runningEvents[e.tag]=e,!this._wrappedEmits[e.tag]){const s=i=>{let a=this._wrapEvent(e,i,t);if(a.decodeError==null)try{const o=e.getEmit(a);this.emit(e.filter,...o)}catch(o){a.decodeError=o.error}e.filter!=null&&this.emit("event",a),a.decodeError!=null&&this.emit("error",a.decodeError,a)};this._wrappedEmits[e.tag]=s,e.filter!=null&&this.provider.on(e.filter,s)}}queryFilter(e,t,r){const s=this._getRunningEvent(e),i=pi(s.filter);return typeof t=="string"&&lr(t,32)?(r!=null&&Ps.throwArgumentError("cannot specify toBlock with blockhash","toBlock",r),i.blockHash=t):(i.fromBlock=t??0,i.toBlock=r??"latest"),this.provider.getLogs(i).then(a=>a.map(o=>this._wrapEvent(s,o,null)))}on(e,t){return this._addEventListener(this._getRunningEvent(e),t,!1),this}once(e,t){return this._addEventListener(this._getRunningEvent(e),t,!0),this}emit(e,...t){if(!this.provider)return!1;const r=this._getRunningEvent(e),s=r.run(t)>0;return this._checkRunningEvents(r),s}listenerCount(e){return this.provider?e==null?Object.keys(this._runningEvents).reduce((t,r)=>t+this._runningEvents[r].listenerCount(),0):this._getRunningEvent(e).listenerCount():0}listeners(e){if(!this.provider)return[];if(e==null){const t=[];for(let r in this._runningEvents)this._runningEvents[r].listeners().forEach(s=>{t.push(s)});return t}return this._getRunningEvent(e).listeners()}removeAllListeners(e){if(!this.provider)return this;if(e==null){for(const r in this._runningEvents){const s=this._runningEvents[r];s.removeAllListeners(),this._checkRunningEvents(s)}return this}const t=this._getRunningEvent(e);return t.removeAllListeners(),this._checkRunningEvents(t),this}off(e,t){if(!this.provider)return this;const r=this._getRunningEvent(e);return r.removeListener(t),this._checkRunningEvents(r),this}removeListener(e,t){return this.off(e,t)}}class G0e extends U0e{}class uU{constructor(e){Ke(this,"alphabet",e),Ke(this,"base",e.length),Ke(this,"_alphabetMap",{}),Ke(this,"_leader",e.charAt(0));for(let t=0;t<e.length;t++)this._alphabetMap[e.charAt(t)]=t}encode(e){let t=rt(e);if(t.length===0)return"";let r=[0];for(let i=0;i<t.length;++i){let a=t[i];for(let o=0;o<r.length;++o)a+=r[o]<<8,r[o]=a%this.base,a=a/this.base|0;for(;a>0;)r.push(a%this.base),a=a/this.base|0}let s="";for(let i=0;t[i]===0&&i<t.length-1;++i)s+=this._leader;for(let i=r.length-1;i>=0;--i)s+=this.alphabet[r[i]];return s}decode(e){if(typeof e!="string")throw new TypeError("Expected String");let t=[];if(e.length===0)return new Uint8Array(t);t.push(0);for(let r=0;r<e.length;r++){let s=this._alphabetMap[e[r]];if(s===void 0)throw new Error("Non-base"+this.base+" character");let i=s;for(let a=0;a<t.length;++a)i+=t[a]*this.base,t[a]=i&255,i>>=8;for(;i>0;)t.push(i&255),i>>=8}for(let r=0;e[r]===this._leader&&r<e.length-1;++r)t.push(0);return rt(new Uint8Array(t.reverse()))}}new uU("abcdefghijklmnopqrstuvwxyz234567");const d1=new uU("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");var f1;(function(n){n.sha256="sha256",n.sha512="sha512"})(f1||(f1={}));const H0e="sha2/5.8.0",W0e=new Le(H0e);function q0e(n){return"0x"+Ho.ripemd160().update(rt(n)).digest("hex")}function tm(n){return"0x"+Ho.sha256().update(rt(n)).digest("hex")}function pE(n,e,t){return f1[n]||W0e.throwError("unsupported algorithm "+n,Le.errors.UNSUPPORTED_OPERATION,{operation:"hmac",algorithm:n}),"0x"+Ho.hmac(Ho[n],rt(e)).update(rt(t)).digest("hex")}function iR(n,e,t,r,s){n=rt(n),e=rt(e);let i,a=1;const o=new Uint8Array(r),l=new Uint8Array(e.length+4);l.set(e);let c,u;for(let d=1;d<=a;d++){l[e.length]=d>>24&255,l[e.length+1]=d>>16&255,l[e.length+2]=d>>8&255,l[e.length+3]=d&255;let p=rt(pE(s,n,l));i||(i=p.length,u=new Uint8Array(i),a=Math.ceil(r/i),c=r-(a-1)*i),u.set(p);for(let v=1;v<t;v++){p=rt(pE(s,n,p));for(let b=0;b<i;b++)u[b]^=p[b]}const x=(d-1)*i,y=d===a?c:i;o.set(rt(u).slice(0,y),x)}return ot(o)}const K0e="wordlists/5.8.0",X0e=new Le(K0e);class ob{constructor(e){X0e.checkAbstract(new.target,ob),Ke(this,"locale",e)}split(e){return e.toLowerCase().split(/ +/g)}join(e){return e.join(" ")}static check(e){const t=[];for(let r=0;r<2048;r++){const s=e.getWord(r);if(r!==e.getWordIndex(s))return"0x";t.push(s)}return Ip(t.join(`
`)+`
`)}static register(e,t){t||(t=e.locale)}}const Y0e="AbandonAbilityAbleAboutAboveAbsentAbsorbAbstractAbsurdAbuseAccessAccidentAccountAccuseAchieveAcidAcousticAcquireAcrossActActionActorActressActualAdaptAddAddictAddressAdjustAdmitAdultAdvanceAdviceAerobicAffairAffordAfraidAgainAgeAgentAgreeAheadAimAirAirportAisleAlarmAlbumAlcoholAlertAlienAllAlleyAllowAlmostAloneAlphaAlreadyAlsoAlterAlwaysAmateurAmazingAmongAmountAmusedAnalystAnchorAncientAngerAngleAngryAnimalAnkleAnnounceAnnualAnotherAnswerAntennaAntiqueAnxietyAnyApartApologyAppearAppleApproveAprilArchArcticAreaArenaArgueArmArmedArmorArmyAroundArrangeArrestArriveArrowArtArtefactArtistArtworkAskAspectAssaultAssetAssistAssumeAsthmaAthleteAtomAttackAttendAttitudeAttractAuctionAuditAugustAuntAuthorAutoAutumnAverageAvocadoAvoidAwakeAwareAwayAwesomeAwfulAwkwardAxisBabyBachelorBaconBadgeBagBalanceBalconyBallBambooBananaBannerBarBarelyBargainBarrelBaseBasicBasketBattleBeachBeanBeautyBecauseBecomeBeefBeforeBeginBehaveBehindBelieveBelowBeltBenchBenefitBestBetrayBetterBetweenBeyondBicycleBidBikeBindBiologyBirdBirthBitterBlackBladeBlameBlanketBlastBleakBlessBlindBloodBlossomBlouseBlueBlurBlushBoardBoatBodyBoilBombBoneBonusBookBoostBorderBoringBorrowBossBottomBounceBoxBoyBracketBrainBrandBrassBraveBreadBreezeBrickBridgeBriefBrightBringBriskBroccoliBrokenBronzeBroomBrotherBrownBrushBubbleBuddyBudgetBuffaloBuildBulbBulkBulletBundleBunkerBurdenBurgerBurstBusBusinessBusyButterBuyerBuzzCabbageCabinCableCactusCageCakeCallCalmCameraCampCanCanalCancelCandyCannonCanoeCanvasCanyonCapableCapitalCaptainCarCarbonCardCargoCarpetCarryCartCaseCashCasinoCastleCasualCatCatalogCatchCategoryCattleCaughtCauseCautionCaveCeilingCeleryCementCensusCenturyCerealCertainChairChalkChampionChangeChaosChapterChargeChaseChatCheapCheckCheeseChefCherryChestChickenChiefChildChimneyChoiceChooseChronicChuckleChunkChurnCigarCinnamonCircleCitizenCityCivilClaimClapClarifyClawClayCleanClerkCleverClickClientCliffClimbClinicClipClockClogCloseClothCloudClownClubClumpClusterClutchCoachCoastCoconutCodeCoffeeCoilCoinCollectColorColumnCombineComeComfortComicCommonCompanyConcertConductConfirmCongressConnectConsiderControlConvinceCookCoolCopperCopyCoralCoreCornCorrectCostCottonCouchCountryCoupleCourseCousinCoverCoyoteCrackCradleCraftCramCraneCrashCraterCrawlCrazyCreamCreditCreekCrewCricketCrimeCrispCriticCropCrossCrouchCrowdCrucialCruelCruiseCrumbleCrunchCrushCryCrystalCubeCultureCupCupboardCuriousCurrentCurtainCurveCushionCustomCuteCycleDadDamageDampDanceDangerDaringDashDaughterDawnDayDealDebateDebrisDecadeDecemberDecideDeclineDecorateDecreaseDeerDefenseDefineDefyDegreeDelayDeliverDemandDemiseDenialDentistDenyDepartDependDepositDepthDeputyDeriveDescribeDesertDesignDeskDespairDestroyDetailDetectDevelopDeviceDevoteDiagramDialDiamondDiaryDiceDieselDietDifferDigitalDignityDilemmaDinnerDinosaurDirectDirtDisagreeDiscoverDiseaseDishDismissDisorderDisplayDistanceDivertDivideDivorceDizzyDoctorDocumentDogDollDolphinDomainDonateDonkeyDonorDoorDoseDoubleDoveDraftDragonDramaDrasticDrawDreamDressDriftDrillDrinkDripDriveDropDrumDryDuckDumbDuneDuringDustDutchDutyDwarfDynamicEagerEagleEarlyEarnEarthEasilyEastEasyEchoEcologyEconomyEdgeEditEducateEffortEggEightEitherElbowElderElectricElegantElementElephantElevatorEliteElseEmbarkEmbodyEmbraceEmergeEmotionEmployEmpowerEmptyEnableEnactEndEndlessEndorseEnemyEnergyEnforceEngageEngineEnhanceEnjoyEnlistEnoughEnrichEnrollEnsureEnterEntireEntryEnvelopeEpisodeEqualEquipEraEraseErodeErosionErrorEruptEscapeEssayEssenceEstateEternalEthicsEvidenceEvilEvokeEvolveExactExampleExcessExchangeExciteExcludeExcuseExecuteExerciseExhaustExhibitExileExistExitExoticExpandExpectExpireExplainExposeExpressExtendExtraEyeEyebrowFabricFaceFacultyFadeFaintFaithFallFalseFameFamilyFamousFanFancyFantasyFarmFashionFatFatalFatherFatigueFaultFavoriteFeatureFebruaryFederalFeeFeedFeelFemaleFenceFestivalFetchFeverFewFiberFictionFieldFigureFileFilmFilterFinalFindFineFingerFinishFireFirmFirstFiscalFishFitFitnessFixFlagFlameFlashFlatFlavorFleeFlightFlipFloatFlockFloorFlowerFluidFlushFlyFoamFocusFogFoilFoldFollowFoodFootForceForestForgetForkFortuneForumForwardFossilFosterFoundFoxFragileFrameFrequentFreshFriendFringeFrogFrontFrostFrownFrozenFruitFuelFunFunnyFurnaceFuryFutureGadgetGainGalaxyGalleryGameGapGarageGarbageGardenGarlicGarmentGasGaspGateGatherGaugeGazeGeneralGeniusGenreGentleGenuineGestureGhostGiantGiftGiggleGingerGiraffeGirlGiveGladGlanceGlareGlassGlideGlimpseGlobeGloomGloryGloveGlowGlueGoatGoddessGoldGoodGooseGorillaGospelGossipGovernGownGrabGraceGrainGrantGrapeGrassGravityGreatGreenGridGriefGritGroceryGroupGrowGruntGuardGuessGuideGuiltGuitarGunGymHabitHairHalfHammerHamsterHandHappyHarborHardHarshHarvestHatHaveHawkHazardHeadHealthHeartHeavyHedgehogHeightHelloHelmetHelpHenHeroHiddenHighHillHintHipHireHistoryHobbyHockeyHoldHoleHolidayHollowHomeHoneyHoodHopeHornHorrorHorseHospitalHostHotelHourHoverHubHugeHumanHumbleHumorHundredHungryHuntHurdleHurryHurtHusbandHybridIceIconIdeaIdentifyIdleIgnoreIllIllegalIllnessImageImitateImmenseImmuneImpactImposeImproveImpulseInchIncludeIncomeIncreaseIndexIndicateIndoorIndustryInfantInflictInformInhaleInheritInitialInjectInjuryInmateInnerInnocentInputInquiryInsaneInsectInsideInspireInstallIntactInterestIntoInvestInviteInvolveIronIslandIsolateIssueItemIvoryJacketJaguarJarJazzJealousJeansJellyJewelJobJoinJokeJourneyJoyJudgeJuiceJumpJungleJuniorJunkJustKangarooKeenKeepKetchupKeyKickKidKidneyKindKingdomKissKitKitchenKiteKittenKiwiKneeKnifeKnockKnowLabLabelLaborLadderLadyLakeLampLanguageLaptopLargeLaterLatinLaughLaundryLavaLawLawnLawsuitLayerLazyLeaderLeafLearnLeaveLectureLeftLegLegalLegendLeisureLemonLendLengthLensLeopardLessonLetterLevelLiarLibertyLibraryLicenseLifeLiftLightLikeLimbLimitLinkLionLiquidListLittleLiveLizardLoadLoanLobsterLocalLockLogicLonelyLongLoopLotteryLoudLoungeLoveLoyalLuckyLuggageLumberLunarLunchLuxuryLyricsMachineMadMagicMagnetMaidMailMainMajorMakeMammalManManageMandateMangoMansionManualMapleMarbleMarchMarginMarineMarketMarriageMaskMassMasterMatchMaterialMathMatrixMatterMaximumMazeMeadowMeanMeasureMeatMechanicMedalMediaMelodyMeltMemberMemoryMentionMenuMercyMergeMeritMerryMeshMessageMetalMethodMiddleMidnightMilkMillionMimicMindMinimumMinorMinuteMiracleMirrorMiseryMissMistakeMixMixedMixtureMobileModelModifyMomMomentMonitorMonkeyMonsterMonthMoonMoralMoreMorningMosquitoMotherMotionMotorMountainMouseMoveMovieMuchMuffinMuleMultiplyMuscleMuseumMushroomMusicMustMutualMyselfMysteryMythNaiveNameNapkinNarrowNastyNationNatureNearNeckNeedNegativeNeglectNeitherNephewNerveNestNetNetworkNeutralNeverNewsNextNiceNightNobleNoiseNomineeNoodleNormalNorthNoseNotableNoteNothingNoticeNovelNowNuclearNumberNurseNutOakObeyObjectObligeObscureObserveObtainObviousOccurOceanOctoberOdorOffOfferOfficeOftenOilOkayOldOliveOlympicOmitOnceOneOnionOnlineOnlyOpenOperaOpinionOpposeOptionOrangeOrbitOrchardOrderOrdinaryOrganOrientOriginalOrphanOstrichOtherOutdoorOuterOutputOutsideOvalOvenOverOwnOwnerOxygenOysterOzonePactPaddlePagePairPalacePalmPandaPanelPanicPantherPaperParadeParentParkParrotPartyPassPatchPathPatientPatrolPatternPausePavePaymentPeacePeanutPearPeasantPelicanPenPenaltyPencilPeoplePepperPerfectPermitPersonPetPhonePhotoPhrasePhysicalPianoPicnicPicturePiecePigPigeonPillPilotPinkPioneerPipePistolPitchPizzaPlacePlanetPlasticPlatePlayPleasePledgePluckPlugPlungePoemPoetPointPolarPolePolicePondPonyPoolPopularPortionPositionPossiblePostPotatoPotteryPovertyPowderPowerPracticePraisePredictPreferPreparePresentPrettyPreventPricePridePrimaryPrintPriorityPrisonPrivatePrizeProblemProcessProduceProfitProgramProjectPromoteProofPropertyProsperProtectProudProvidePublicPuddingPullPulpPulsePumpkinPunchPupilPuppyPurchasePurityPurposePursePushPutPuzzlePyramidQualityQuantumQuarterQuestionQuickQuitQuizQuoteRabbitRaccoonRaceRackRadarRadioRailRainRaiseRallyRampRanchRandomRangeRapidRareRateRatherRavenRawRazorReadyRealReasonRebelRebuildRecallReceiveRecipeRecordRecycleReduceReflectReformRefuseRegionRegretRegularRejectRelaxReleaseReliefRelyRemainRememberRemindRemoveRenderRenewRentReopenRepairRepeatReplaceReportRequireRescueResembleResistResourceResponseResultRetireRetreatReturnReunionRevealReviewRewardRhythmRibRibbonRiceRichRideRidgeRifleRightRigidRingRiotRippleRiskRitualRivalRiverRoadRoastRobotRobustRocketRomanceRoofRookieRoomRoseRotateRoughRoundRouteRoyalRubberRudeRugRuleRunRunwayRuralSadSaddleSadnessSafeSailSaladSalmonSalonSaltSaluteSameSampleSandSatisfySatoshiSauceSausageSaveSayScaleScanScareScatterSceneSchemeSchoolScienceScissorsScorpionScoutScrapScreenScriptScrubSeaSearchSeasonSeatSecondSecretSectionSecuritySeedSeekSegmentSelectSellSeminarSeniorSenseSentenceSeriesServiceSessionSettleSetupSevenShadowShaftShallowShareShedShellSheriffShieldShiftShineShipShiverShockShoeShootShopShortShoulderShoveShrimpShrugShuffleShySiblingSickSideSiegeSightSignSilentSilkSillySilverSimilarSimpleSinceSingSirenSisterSituateSixSizeSkateSketchSkiSkillSkinSkirtSkullSlabSlamSleepSlenderSliceSlideSlightSlimSloganSlotSlowSlushSmallSmartSmileSmokeSmoothSnackSnakeSnapSniffSnowSoapSoccerSocialSockSodaSoftSolarSoldierSolidSolutionSolveSomeoneSongSoonSorrySortSoulSoundSoupSourceSouthSpaceSpareSpatialSpawnSpeakSpecialSpeedSpellSpendSphereSpiceSpiderSpikeSpinSpiritSplitSpoilSponsorSpoonSportSpotSpraySpreadSpringSpySquareSqueezeSquirrelStableStadiumStaffStageStairsStampStandStartStateStaySteakSteelStemStepStereoStickStillStingStockStomachStoneStoolStoryStoveStrategyStreetStrikeStrongStruggleStudentStuffStumbleStyleSubjectSubmitSubwaySuccessSuchSuddenSufferSugarSuggestSuitSummerSunSunnySunsetSuperSupplySupremeSureSurfaceSurgeSurpriseSurroundSurveySuspectSustainSwallowSwampSwapSwarmSwearSweetSwiftSwimSwingSwitchSwordSymbolSymptomSyrupSystemTableTackleTagTailTalentTalkTankTapeTargetTaskTasteTattooTaxiTeachTeamTellTenTenantTennisTentTermTestTextThankThatThemeThenTheoryThereTheyThingThisThoughtThreeThriveThrowThumbThunderTicketTideTigerTiltTimberTimeTinyTipTiredTissueTitleToastTobaccoTodayToddlerToeTogetherToiletTokenTomatoTomorrowToneTongueTonightToolToothTopTopicToppleTorchTornadoTortoiseTossTotalTouristTowardTowerTownToyTrackTradeTrafficTragicTrainTransferTrapTrashTravelTrayTreatTreeTrendTrialTribeTrickTriggerTrimTripTrophyTroubleTruckTrueTrulyTrumpetTrustTruthTryTubeTuitionTumbleTunaTunnelTurkeyTurnTurtleTwelveTwentyTwiceTwinTwistTwoTypeTypicalUglyUmbrellaUnableUnawareUncleUncoverUnderUndoUnfairUnfoldUnhappyUniformUniqueUnitUniverseUnknownUnlockUntilUnusualUnveilUpdateUpgradeUpholdUponUpperUpsetUrbanUrgeUsageUseUsedUsefulUselessUsualUtilityVacantVacuumVagueValidValleyValveVanVanishVaporVariousVastVaultVehicleVelvetVendorVentureVenueVerbVerifyVersionVeryVesselVeteranViableVibrantViciousVictoryVideoViewVillageVintageViolinVirtualVirusVisaVisitVisualVitalVividVocalVoiceVoidVolcanoVolumeVoteVoyageWageWagonWaitWalkWallWalnutWantWarfareWarmWarriorWashWaspWasteWaterWaveWayWealthWeaponWearWeaselWeatherWebWeddingWeekendWeirdWelcomeWestWetWhaleWhatWheatWheelWhenWhereWhipWhisperWideWidthWifeWildWillWinWindowWineWingWinkWinnerWinterWireWisdomWiseWishWitnessWolfWomanWonderWoodWoolWordWorkWorldWorryWorthWrapWreckWrestleWristWriteWrongYardYearYellowYouYoungYouthZebraZeroZoneZoo";let Gy=null;function U5(n){if(Gy==null&&(Gy=Y0e.replace(/([A-Z])/g," $1").toLowerCase().substring(1).split(" "),ob.check(n)!=="0x3c8acc1e7b08d8e76f9fda015ef48dc8c710a73cb7e0f77b2c18a9b5a7adde60"))throw Gy=null,new Error("BIP39 Wordlist for en (English) FAILED")}class Z0e extends ob{constructor(){super("en")}getWord(e){return U5(this),Gy[e]}getWordIndex(e){return U5(this),Gy.indexOf(e)}}const hU=new Z0e;ob.register(hU);const G5={en:hU},Q0e="hdnode/5.8.0",mE=new Le(Q0e),J0e=st.from("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ege=Pi("Bitcoin seed"),oy=2147483648;function dU(n){return(1<<n)-1<<8-n}function tge(n){return(1<<n)-1}function nw(n){return Gr(ot(n),32)}function H5(n){return d1.encode(zs([n,ui(tm(tm(n)),0,4)]))}function aR(n){if(n==null)return G5.en;if(typeof n=="string"){const e=G5[n];return e==null&&mE.throwArgumentError("unknown locale","wordlist",n),e}return n}const S0={},p1="m/44'/60'/0'/0/0";class Sl{constructor(e,t,r,s,i,a,o,l){if(e!==S0)throw new Error("HDNode constructor cannot be called directly");if(t){const c=new eg(t);Ke(this,"privateKey",c.privateKey),Ke(this,"publicKey",c.compressedPublicKey)}else Ke(this,"privateKey",null),Ke(this,"publicKey",ot(r));Ke(this,"parentFingerprint",s),Ke(this,"fingerprint",ui(q0e(tm(this.publicKey)),0,4)),Ke(this,"address",Op(this.publicKey)),Ke(this,"chainCode",i),Ke(this,"index",a),Ke(this,"depth",o),l==null?(Ke(this,"mnemonic",null),Ke(this,"path",null)):typeof l=="string"?(Ke(this,"mnemonic",null),Ke(this,"path",l)):(Ke(this,"mnemonic",l),Ke(this,"path",l.path))}get extendedKey(){if(this.depth>=256)throw new Error("Depth too large!");return H5(zs([this.privateKey!=null?"0x0488ADE4":"0x0488B21E",ot(this.depth),this.parentFingerprint,Gr(ot(this.index),4),this.chainCode,this.privateKey!=null?zs(["0x00",this.privateKey]):this.publicKey]))}neuter(){return new Sl(S0,null,this.publicKey,this.parentFingerprint,this.chainCode,this.index,this.depth,this.path)}_derive(e){if(e>4294967295)throw new Error("invalid index - "+String(e));let t=this.path;t&&(t+="/"+(e&~oy));const r=new Uint8Array(37);if(e&oy){if(!this.privateKey)throw new Error("cannot derive child of neutered node");r.set(rt(this.privateKey),1),t&&(t+="'")}else r.set(rt(this.publicKey));for(let d=24;d>=0;d-=8)r[33+(d>>3)]=e>>24-d&255;const s=rt(pE(f1.sha512,this.chainCode,r)),i=s.slice(0,32),a=s.slice(32);let o=null,l=null;this.privateKey?o=nw(st.from(i).add(this.privateKey).mod(J0e)):l=new eg(ot(i))._addPoint(this.publicKey);let c=t;const u=this.mnemonic;return u&&(c=Object.freeze({phrase:u.phrase,path:t,locale:u.locale||"en"})),new Sl(S0,o,l,this.fingerprint,nw(a),e,this.depth+1,c)}derivePath(e){const t=e.split("/");if(t.length===0||t[0]==="m"&&this.depth!==0)throw new Error("invalid path - "+e);t[0]==="m"&&t.shift();let r=this;for(let s=0;s<t.length;s++){const i=t[s];if(i.match(/^[0-9]+'$/)){const a=parseInt(i.substring(0,i.length-1));if(a>=oy)throw new Error("invalid path index - "+i);r=r._derive(oy+a)}else if(i.match(/^[0-9]+$/)){const a=parseInt(i);if(a>=oy)throw new Error("invalid path index - "+i);r=r._derive(a)}else throw new Error("invalid path component - "+i)}return r}static _fromSeed(e,t){const r=rt(e);if(r.length<16||r.length>64)throw new Error("invalid seed");const s=rt(pE(f1.sha512,ege,r));return new Sl(S0,nw(s.slice(0,32)),null,"0x00000000",nw(s.slice(32)),0,0,t)}static fromMnemonic(e,t,r){return r=aR(r),e=oR(fU(e,r),r),Sl._fromSeed(nge(e,t),{phrase:e,path:"m",locale:r.locale})}static fromSeed(e){return Sl._fromSeed(e,null)}static fromExtendedKey(e){const t=d1.decode(e);(t.length!==82||H5(t.slice(0,78))!==e)&&mE.throwArgumentError("invalid extended key","extendedKey","[REDACTED]");const r=t[4],s=ot(t.slice(5,9)),i=parseInt(ot(t.slice(9,13)).substring(2),16),a=ot(t.slice(13,45)),o=t.slice(45,78);switch(ot(t.slice(0,4))){case"0x0488b21e":case"0x043587cf":return new Sl(S0,null,ot(o),s,a,i,r,null);case"0x0488ade4":case"0x04358394 ":if(o[0]!==0)break;return new Sl(S0,ot(o.slice(1)),null,s,a,i,r,null)}return mE.throwArgumentError("invalid extended key","extendedKey","[REDACTED]")}}function nge(n,e){e||(e="");const t=Pi("mnemonic"+e,df.NFKD);return iR(Pi(n,df.NFKD),t,2048,64,"sha512")}function fU(n,e){e=aR(e),mE.checkNormalize();const t=e.split(n);if(t.length%3!==0)throw new Error("invalid mnemonic");const r=rt(new Uint8Array(Math.ceil(11*t.length/8)));let s=0;for(let c=0;c<t.length;c++){let u=e.getWordIndex(t[c].normalize("NFKD"));if(u===-1)throw new Error("invalid mnemonic");for(let d=0;d<11;d++)u&1<<10-d&&(r[s>>3]|=1<<7-s%8),s++}const i=32*t.length/3,a=t.length/3,o=dU(a);if((rt(tm(r.slice(0,i/8)))[0]&o)!==(r[r.length-1]&o))throw new Error("invalid checksum");return ot(r.slice(0,i/8))}function oR(n,e){if(e=aR(e),n=rt(n),n.length%4!==0||n.length<16||n.length>32)throw new Error("invalid entropy");const t=[0];let r=11;for(let a=0;a<n.length;a++)r>8?(t[t.length-1]<<=8,t[t.length-1]|=n[a],r-=8):(t[t.length-1]<<=r,t[t.length-1]|=n[a]>>8-r,t.push(n[a]&tge(8-r)),r+=3);const s=n.length/4,i=rt(tm(n))[0]&dU(s);return t[t.length-1]<<=s,t[t.length-1]|=i>>8-s,e.join(t.map(a=>e.getWord(a)))}const rge="random/5.8.0",wI=new Le(rge);function sge(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const W5=sge();let Uw=W5.crypto||W5.msCrypto;(!Uw||!Uw.getRandomValues)&&(wI.warn("WARNING: Missing strong random number source"),Uw={getRandomValues:function(n){return wI.throwError("no secure random source avaialble",Le.errors.UNSUPPORTED_OPERATION,{operation:"crypto.getRandomValues"})}});function Ty(n){(n<=0||n>1024||n%1||n!=n)&&wI.throwArgumentError("invalid length","length",n);const e=new Uint8Array(n);return Uw.getRandomValues(e),rt(e)}var ik={exports:{}},q5;function ige(){return q5||(q5=1,(function(n,e){(function(t){function r(z){return parseInt(z)===z}function s(z){if(!r(z.length))return!1;for(var D=0;D<z.length;D++)if(!r(z[D])||z[D]<0||z[D]>255)return!1;return!0}function i(z,D){if(z.buffer&&ArrayBuffer.isView(z)&&z.name==="Uint8Array")return D&&(z.slice?z=z.slice():z=Array.prototype.slice.call(z)),z;if(Array.isArray(z)){if(!s(z))throw new Error("Array contains invalid value: "+z);return new Uint8Array(z)}if(r(z.length)&&s(z))return new Uint8Array(z);throw new Error("unsupported array-like object")}function a(z){return new Uint8Array(z)}function o(z,D,X,re,W){(re!=null||W!=null)&&(z.slice?z=z.slice(re,W):z=Array.prototype.slice.call(z,re,W)),D.set(z,X)}var l=(function(){function z(X){var re=[],W=0;for(X=encodeURI(X);W<X.length;){var ae=X.charCodeAt(W++);ae===37?(re.push(parseInt(X.substr(W,2),16)),W+=2):re.push(ae)}return i(re)}function D(X){for(var re=[],W=0;W<X.length;){var ae=X[W];ae<128?(re.push(String.fromCharCode(ae)),W++):ae>191&&ae<224?(re.push(String.fromCharCode((ae&31)<<6|X[W+1]&63)),W+=2):(re.push(String.fromCharCode((ae&15)<<12|(X[W+1]&63)<<6|X[W+2]&63)),W+=3)}return re.join("")}return{toBytes:z,fromBytes:D}})(),c=(function(){function z(re){for(var W=[],ae=0;ae<re.length;ae+=2)W.push(parseInt(re.substr(ae,2),16));return W}var D="0123456789abcdef";function X(re){for(var W=[],ae=0;ae<re.length;ae++){var pe=re[ae];W.push(D[(pe&240)>>4]+D[pe&15])}return W.join("")}return{toBytes:z,fromBytes:X}})(),u={16:10,24:12,32:14},d=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],p=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],x=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],y=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],v=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],b=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],S=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],T=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],C=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],I=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],$=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],q=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],U=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],F=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],G=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function V(z){for(var D=[],X=0;X<z.length;X+=4)D.push(z[X]<<24|z[X+1]<<16|z[X+2]<<8|z[X+3]);return D}var O=function(z){if(!(this instanceof O))throw Error("AES must be instanitated with `new`");Object.defineProperty(this,"key",{value:i(z,!0)}),this._prepare()};O.prototype._prepare=function(){var z=u[this.key.length];if(z==null)throw new Error("invalid key size (must be 16, 24 or 32 bytes)");this._Ke=[],this._Kd=[];for(var D=0;D<=z;D++)this._Ke.push([0,0,0,0]),this._Kd.push([0,0,0,0]);for(var X=(z+1)*4,re=this.key.length/4,W=V(this.key),ae,D=0;D<re;D++)ae=D>>2,this._Ke[ae][D%4]=W[D],this._Kd[z-ae][D%4]=W[D];for(var pe=0,de=re,ve;de<X;){if(ve=W[re-1],W[0]^=p[ve>>16&255]<<24^p[ve>>8&255]<<16^p[ve&255]<<8^p[ve>>24&255]^d[pe]<<24,pe+=1,re!=8)for(var D=1;D<re;D++)W[D]^=W[D-1];else{for(var D=1;D<re/2;D++)W[D]^=W[D-1];ve=W[re/2-1],W[re/2]^=p[ve&255]^p[ve>>8&255]<<8^p[ve>>16&255]<<16^p[ve>>24&255]<<24;for(var D=re/2+1;D<re;D++)W[D]^=W[D-1]}for(var D=0,Ve,ze;D<re&&de<X;)Ve=de>>2,ze=de%4,this._Ke[Ve][ze]=W[D],this._Kd[z-Ve][ze]=W[D++],de++}for(var Ve=1;Ve<z;Ve++)for(var ze=0;ze<4;ze++)ve=this._Kd[Ve][ze],this._Kd[Ve][ze]=q[ve>>24&255]^U[ve>>16&255]^F[ve>>8&255]^G[ve&255]},O.prototype.encrypt=function(z){if(z.length!=16)throw new Error("invalid plaintext size (must be 16 bytes)");for(var D=this._Ke.length-1,X=[0,0,0,0],re=V(z),W=0;W<4;W++)re[W]^=this._Ke[0][W];for(var ae=1;ae<D;ae++){for(var W=0;W<4;W++)X[W]=y[re[W]>>24&255]^v[re[(W+1)%4]>>16&255]^b[re[(W+2)%4]>>8&255]^S[re[(W+3)%4]&255]^this._Ke[ae][W];re=X.slice()}for(var pe=a(16),de,W=0;W<4;W++)de=this._Ke[D][W],pe[4*W]=(p[re[W]>>24&255]^de>>24)&255,pe[4*W+1]=(p[re[(W+1)%4]>>16&255]^de>>16)&255,pe[4*W+2]=(p[re[(W+2)%4]>>8&255]^de>>8)&255,pe[4*W+3]=(p[re[(W+3)%4]&255]^de)&255;return pe},O.prototype.decrypt=function(z){if(z.length!=16)throw new Error("invalid ciphertext size (must be 16 bytes)");for(var D=this._Kd.length-1,X=[0,0,0,0],re=V(z),W=0;W<4;W++)re[W]^=this._Kd[0][W];for(var ae=1;ae<D;ae++){for(var W=0;W<4;W++)X[W]=T[re[W]>>24&255]^C[re[(W+3)%4]>>16&255]^I[re[(W+2)%4]>>8&255]^$[re[(W+1)%4]&255]^this._Kd[ae][W];re=X.slice()}for(var pe=a(16),de,W=0;W<4;W++)de=this._Kd[D][W],pe[4*W]=(x[re[W]>>24&255]^de>>24)&255,pe[4*W+1]=(x[re[(W+3)%4]>>16&255]^de>>16)&255,pe[4*W+2]=(x[re[(W+2)%4]>>8&255]^de>>8)&255,pe[4*W+3]=(x[re[(W+1)%4]&255]^de)&255;return pe};var K=function(z){if(!(this instanceof K))throw Error("AES must be instanitated with `new`");this.description="Electronic Code Block",this.name="ecb",this._aes=new O(z)};K.prototype.encrypt=function(z){if(z=i(z),z.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var D=a(z.length),X=a(16),re=0;re<z.length;re+=16)o(z,X,0,re,re+16),X=this._aes.encrypt(X),o(X,D,re);return D},K.prototype.decrypt=function(z){if(z=i(z),z.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var D=a(z.length),X=a(16),re=0;re<z.length;re+=16)o(z,X,0,re,re+16),X=this._aes.decrypt(X),o(X,D,re);return D};var P=function(z,D){if(!(this instanceof P))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Block Chaining",this.name="cbc",!D)D=a(16);else if(D.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastCipherblock=i(D,!0),this._aes=new O(z)};P.prototype.encrypt=function(z){if(z=i(z),z.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var D=a(z.length),X=a(16),re=0;re<z.length;re+=16){o(z,X,0,re,re+16);for(var W=0;W<16;W++)X[W]^=this._lastCipherblock[W];this._lastCipherblock=this._aes.encrypt(X),o(this._lastCipherblock,D,re)}return D},P.prototype.decrypt=function(z){if(z=i(z),z.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var D=a(z.length),X=a(16),re=0;re<z.length;re+=16){o(z,X,0,re,re+16),X=this._aes.decrypt(X);for(var W=0;W<16;W++)D[re+W]=X[W]^this._lastCipherblock[W];o(z,this._lastCipherblock,0,re,re+16)}return D};var N=function(z,D,X){if(!(this instanceof N))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Feedback",this.name="cfb",!D)D=a(16);else if(D.length!=16)throw new Error("invalid initialation vector size (must be 16 size)");X||(X=1),this.segmentSize=X,this._shiftRegister=i(D,!0),this._aes=new O(z)};N.prototype.encrypt=function(z){if(z.length%this.segmentSize!=0)throw new Error("invalid plaintext size (must be segmentSize bytes)");for(var D=i(z,!0),X,re=0;re<D.length;re+=this.segmentSize){X=this._aes.encrypt(this._shiftRegister);for(var W=0;W<this.segmentSize;W++)D[re+W]^=X[W];o(this._shiftRegister,this._shiftRegister,0,this.segmentSize),o(D,this._shiftRegister,16-this.segmentSize,re,re+this.segmentSize)}return D},N.prototype.decrypt=function(z){if(z.length%this.segmentSize!=0)throw new Error("invalid ciphertext size (must be segmentSize bytes)");for(var D=i(z,!0),X,re=0;re<D.length;re+=this.segmentSize){X=this._aes.encrypt(this._shiftRegister);for(var W=0;W<this.segmentSize;W++)D[re+W]^=X[W];o(this._shiftRegister,this._shiftRegister,0,this.segmentSize),o(z,this._shiftRegister,16-this.segmentSize,re,re+this.segmentSize)}return D};var M=function(z,D){if(!(this instanceof M))throw Error("AES must be instanitated with `new`");if(this.description="Output Feedback",this.name="ofb",!D)D=a(16);else if(D.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastPrecipher=i(D,!0),this._lastPrecipherIndex=16,this._aes=new O(z)};M.prototype.encrypt=function(z){for(var D=i(z,!0),X=0;X<D.length;X++)this._lastPrecipherIndex===16&&(this._lastPrecipher=this._aes.encrypt(this._lastPrecipher),this._lastPrecipherIndex=0),D[X]^=this._lastPrecipher[this._lastPrecipherIndex++];return D},M.prototype.decrypt=M.prototype.encrypt;var B=function(z){if(!(this instanceof B))throw Error("Counter must be instanitated with `new`");z!==0&&!z&&(z=1),typeof z=="number"?(this._counter=a(16),this.setValue(z)):this.setBytes(z)};B.prototype.setValue=function(z){if(typeof z!="number"||parseInt(z)!=z)throw new Error("invalid counter value (must be an integer)");for(var D=15;D>=0;--D)this._counter[D]=z%256,z=z>>8},B.prototype.setBytes=function(z){if(z=i(z,!0),z.length!=16)throw new Error("invalid counter bytes size (must be 16 bytes)");this._counter=z},B.prototype.increment=function(){for(var z=15;z>=0;z--)if(this._counter[z]===255)this._counter[z]=0;else{this._counter[z]++;break}};var Y=function(z,D){if(!(this instanceof Y))throw Error("AES must be instanitated with `new`");this.description="Counter",this.name="ctr",D instanceof B||(D=new B(D)),this._counter=D,this._remainingCounter=null,this._remainingCounterIndex=16,this._aes=new O(z)};Y.prototype.encrypt=function(z){for(var D=i(z,!0),X=0;X<D.length;X++)this._remainingCounterIndex===16&&(this._remainingCounter=this._aes.encrypt(this._counter._counter),this._remainingCounterIndex=0,this._counter.increment()),D[X]^=this._remainingCounter[this._remainingCounterIndex++];return D},Y.prototype.decrypt=Y.prototype.encrypt;function Z(z){z=i(z,!0);var D=16-z.length%16,X=a(z.length+D);o(z,X);for(var re=z.length;re<X.length;re++)X[re]=D;return X}function ne(z){if(z=i(z,!0),z.length<16)throw new Error("PKCS#7 invalid length");var D=z[z.length-1];if(D>16)throw new Error("PKCS#7 padding byte out of range");for(var X=z.length-D,re=0;re<D;re++)if(z[X+re]!==D)throw new Error("PKCS#7 invalid padding byte");var W=a(X);return o(z,W,0,0,X),W}var Q={AES:O,Counter:B,ModeOfOperation:{ecb:K,cbc:P,cfb:N,ofb:M,ctr:Y},utils:{hex:c,utf8:l},padding:{pkcs7:{pad:Z,strip:ne}},_arrayTest:{coerceArray:i,createArray:a,copyArray:o}};n.exports=Q})()})(ik)),ik.exports}var age=ige();const Jc=ku(age),pU="json-wallets/5.8.0";function Mp(n){return typeof n=="string"&&n.substring(0,2)!=="0x"&&(n="0x"+n),rt(n)}function ly(n,e){for(n=String(n);n.length<e;)n="0"+n;return n}function lR(n){return typeof n=="string"?Pi(n,df.NFKC):rt(n)}function Os(n,e){let t=n;const r=e.toLowerCase().split("/");for(let s=0;s<r.length;s++){let i=null;for(const a in t)if(a.toLowerCase()===r[s]){i=t[a];break}if(i===null)return null;t=i}return t}function oge(n){const e=rt(n);e[6]=e[6]&15|64,e[8]=e[8]&63|128;const t=ot(e);return[t.substring(2,10),t.substring(10,14),t.substring(14,18),t.substring(18,22),t.substring(22,34)].join("-")}const lge=new Le(pU);class cge extends Nm{isCrowdsaleAccount(e){return!!(e&&e._isCrowdsaleAccount)}}function mU(n,e){const t=JSON.parse(n);e=lR(e);const r=Es(Os(t,"ethaddr")),s=Mp(Os(t,"encseed"));(!s||s.length%16!==0)&&lge.throwArgumentError("invalid encseed","json",n);const i=rt(iR(e,e,2e3,32,"sha256")).slice(0,16),a=s.slice(0,16),o=s.slice(16),l=new Jc.ModeOfOperation.cbc(i,a),c=Jc.padding.pkcs7.strip(rt(l.decrypt(o)));let u="";for(let x=0;x<c.length;x++)u+=String.fromCharCode(c[x]);const d=Pi(u),p=Yr(d);return new cge({_isCrowdsaleAccount:!0,address:r,privateKey:p})}function gU(n){let e=null;try{e=JSON.parse(n)}catch{return!1}return e.encseed&&e.ethaddr}function xU(n){let e=null;try{e=JSON.parse(n)}catch{return!1}return!(!e.version||parseInt(e.version)!==e.version||parseInt(e.version)!==3)}var ak={exports:{}},K5;function uge(){return K5||(K5=1,(function(n,e){(function(t){function s(v){const b=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);let S=1779033703,T=3144134277,C=1013904242,I=2773480762,$=1359893119,q=2600822924,U=528734635,F=1541459225;const G=new Uint32Array(64);function V(Y){let Z=0,ne=Y.length;for(;ne>=64;){let Q=S,z=T,D=C,X=I,re=$,W=q,ae=U,pe=F,de,ve,Ve,ze,Ge;for(ve=0;ve<16;ve++)Ve=Z+ve*4,G[ve]=(Y[Ve]&255)<<24|(Y[Ve+1]&255)<<16|(Y[Ve+2]&255)<<8|Y[Ve+3]&255;for(ve=16;ve<64;ve++)de=G[ve-2],ze=(de>>>17|de<<15)^(de>>>19|de<<13)^de>>>10,de=G[ve-15],Ge=(de>>>7|de<<25)^(de>>>18|de<<14)^de>>>3,G[ve]=(ze+G[ve-7]|0)+(Ge+G[ve-16]|0)|0;for(ve=0;ve<64;ve++)ze=(((re>>>6|re<<26)^(re>>>11|re<<21)^(re>>>25|re<<7))+(re&W^~re&ae)|0)+(pe+(b[ve]+G[ve]|0)|0)|0,Ge=((Q>>>2|Q<<30)^(Q>>>13|Q<<19)^(Q>>>22|Q<<10))+(Q&z^Q&D^z&D)|0,pe=ae,ae=W,W=re,re=X+ze|0,X=D,D=z,z=Q,Q=ze+Ge|0;S=S+Q|0,T=T+z|0,C=C+D|0,I=I+X|0,$=$+re|0,q=q+W|0,U=U+ae|0,F=F+pe|0,Z+=64,ne-=64}}V(v);let O,K=v.length%64,P=v.length/536870912|0,N=v.length<<3,M=K<56?56:120,B=v.slice(v.length-K,v.length);for(B.push(128),O=K+1;O<M;O++)B.push(0);return B.push(P>>>24&255),B.push(P>>>16&255),B.push(P>>>8&255),B.push(P>>>0&255),B.push(N>>>24&255),B.push(N>>>16&255),B.push(N>>>8&255),B.push(N>>>0&255),V(B),[S>>>24&255,S>>>16&255,S>>>8&255,S>>>0&255,T>>>24&255,T>>>16&255,T>>>8&255,T>>>0&255,C>>>24&255,C>>>16&255,C>>>8&255,C>>>0&255,I>>>24&255,I>>>16&255,I>>>8&255,I>>>0&255,$>>>24&255,$>>>16&255,$>>>8&255,$>>>0&255,q>>>24&255,q>>>16&255,q>>>8&255,q>>>0&255,U>>>24&255,U>>>16&255,U>>>8&255,U>>>0&255,F>>>24&255,F>>>16&255,F>>>8&255,F>>>0&255]}function i(v,b,S){v=v.length<=64?v:s(v);const T=64+b.length+4,C=new Array(T),I=new Array(64);let $,q=[];for($=0;$<64;$++)C[$]=54;for($=0;$<v.length;$++)C[$]^=v[$];for($=0;$<b.length;$++)C[64+$]=b[$];for($=T-4;$<T;$++)C[$]=0;for($=0;$<64;$++)I[$]=92;for($=0;$<v.length;$++)I[$]^=v[$];function U(){for(let F=T-1;F>=T-4;F--){if(C[F]++,C[F]<=255)return;C[F]=0}}for(;S>=32;)U(),q=q.concat(s(I.concat(s(C)))),S-=32;return S>0&&(U(),q=q.concat(s(I.concat(s(C))).slice(0,S))),q}function a(v,b,S,T,C){let I;for(u(v,(2*S-1)*16,C,0,16),I=0;I<2*S;I++)c(v,I*16,C,16),l(C,T),u(C,0,v,b+I*16,16);for(I=0;I<S;I++)u(v,b+I*2*16,v,I*16,16);for(I=0;I<S;I++)u(v,b+(I*2+1)*16,v,(I+S)*16,16)}function o(v,b){return v<<b|v>>>32-b}function l(v,b){u(v,0,b,0,16);for(let S=8;S>0;S-=2)b[4]^=o(b[0]+b[12],7),b[8]^=o(b[4]+b[0],9),b[12]^=o(b[8]+b[4],13),b[0]^=o(b[12]+b[8],18),b[9]^=o(b[5]+b[1],7),b[13]^=o(b[9]+b[5],9),b[1]^=o(b[13]+b[9],13),b[5]^=o(b[1]+b[13],18),b[14]^=o(b[10]+b[6],7),b[2]^=o(b[14]+b[10],9),b[6]^=o(b[2]+b[14],13),b[10]^=o(b[6]+b[2],18),b[3]^=o(b[15]+b[11],7),b[7]^=o(b[3]+b[15],9),b[11]^=o(b[7]+b[3],13),b[15]^=o(b[11]+b[7],18),b[1]^=o(b[0]+b[3],7),b[2]^=o(b[1]+b[0],9),b[3]^=o(b[2]+b[1],13),b[0]^=o(b[3]+b[2],18),b[6]^=o(b[5]+b[4],7),b[7]^=o(b[6]+b[5],9),b[4]^=o(b[7]+b[6],13),b[5]^=o(b[4]+b[7],18),b[11]^=o(b[10]+b[9],7),b[8]^=o(b[11]+b[10],9),b[9]^=o(b[8]+b[11],13),b[10]^=o(b[9]+b[8],18),b[12]^=o(b[15]+b[14],7),b[13]^=o(b[12]+b[15],9),b[14]^=o(b[13]+b[12],13),b[15]^=o(b[14]+b[13],18);for(let S=0;S<16;++S)v[S]+=b[S]}function c(v,b,S,T){for(let C=0;C<T;C++)S[C]^=v[b+C]}function u(v,b,S,T,C){for(;C--;)S[T++]=v[b++]}function d(v){if(!v||typeof v.length!="number")return!1;for(let b=0;b<v.length;b++){const S=v[b];if(typeof S!="number"||S%1||S<0||S>=256)return!1}return!0}function p(v,b){if(typeof v!="number"||v%1)throw new Error("invalid "+b);return v}function x(v,b,S,T,C,I,$){if(S=p(S,"N"),T=p(T,"r"),C=p(C,"p"),I=p(I,"dkLen"),S===0||(S&S-1)!==0)throw new Error("N must be power of 2");if(S>2147483647/128/T)throw new Error("N too large");if(T>2147483647/128/C)throw new Error("r too large");if(!d(v))throw new Error("password must be an array or buffer");if(v=Array.prototype.slice.call(v),!d(b))throw new Error("salt must be an array or buffer");b=Array.prototype.slice.call(b);let q=i(v,b,C*128*T);const U=new Uint32Array(C*32*T);for(let re=0;re<U.length;re++){const W=re*4;U[re]=(q[W+3]&255)<<24|(q[W+2]&255)<<16|(q[W+1]&255)<<8|(q[W+0]&255)<<0}const F=new Uint32Array(64*T),G=new Uint32Array(32*T*S),V=32*T,O=new Uint32Array(16),K=new Uint32Array(16),P=C*S*2;let N=0,M=null,B=!1,Y=0,Z=0,ne,Q;const z=$?parseInt(1e3/T):4294967295,D=typeof setImmediate<"u"?setImmediate:setTimeout,X=function(){if(B)return $(new Error("cancelled"),N/P);let re;switch(Y){case 0:Q=Z*32*T,u(U,Q,F,0,V),Y=1,ne=0;case 1:re=S-ne,re>z&&(re=z);for(let ae=0;ae<re;ae++)u(F,0,G,(ne+ae)*V,V),a(F,V,T,O,K);if(ne+=re,N+=re,$){const ae=parseInt(1e3*N/P);if(ae!==M){if(B=$(null,N/P),B)break;M=ae}}if(ne<S)break;ne=0,Y=2;case 2:re=S-ne,re>z&&(re=z);for(let ae=0;ae<re;ae++){const pe=(2*T-1)*16,de=F[pe]&S-1;c(G,de*V,F,V),a(F,V,T,O,K)}if(ne+=re,N+=re,$){const ae=parseInt(1e3*N/P);if(ae!==M){if(B=$(null,N/P),B)break;M=ae}}if(ne<S)break;if(u(F,0,U,Q,V),Z++,Z<C){Y=0;break}q=[];for(let ae=0;ae<U.length;ae++)q.push(U[ae]>>0&255),q.push(U[ae]>>8&255),q.push(U[ae]>>16&255),q.push(U[ae]>>24&255);const W=i(v,q,I);return $&&$(null,1,W),W}$&&D(X)};if(!$)for(;;){const re=X();if(re!=null)return re}X()}const y={scrypt:function(v,b,S,T,C,I,$){return new Promise(function(q,U){let F=0;$&&$(0),x(v,b,S,T,C,I,function(G,V,O){if(G)U(G);else if(O)$&&F!==1&&$(1),q(new Uint8Array(O));else if($&&V!==F)return F=V,$(V)})})},syncScrypt:function(v,b,S,T,C,I){return new Uint8Array(x(v,b,S,T,C,I))}};n.exports=y})()})(ak)),ak.exports}var hge=uge();const cR=ku(hge);var dge=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const EI=new Le(pU);function X5(n){return n!=null&&n.mnemonic&&n.mnemonic.phrase}class fge extends Nm{isKeystoreAccount(e){return!!(e&&e._isKeystoreAccount)}}function pge(n,e,t){if(Os(n,"crypto/cipher")==="aes-128-ctr"){const s=Mp(Os(n,"crypto/cipherparams/iv")),i=new Jc.Counter(s),a=new Jc.ModeOfOperation.ctr(e,i);return rt(a.decrypt(t))}return null}function yU(n,e){const t=Mp(Os(n,"crypto/ciphertext"));if(ot(Yr(zs([e.slice(16,32),t]))).substring(2)!==Os(n,"crypto/mac").toLowerCase())throw new Error("invalid password");const s=pge(n,e.slice(0,16),t);s||EI.throwError("unsupported cipher",Le.errors.UNSUPPORTED_OPERATION,{operation:"decrypt"});const i=e.slice(32,64),a=Op(s);if(n.address){let l=n.address.toLowerCase();if(l.substring(0,2)!=="0x"&&(l="0x"+l),Es(l)!==a)throw new Error("address mismatch")}const o={_isKeystoreAccount:!0,address:a,privateKey:ot(s)};if(Os(n,"x-ethers/version")==="0.1"){const l=Mp(Os(n,"x-ethers/mnemonicCiphertext")),c=Mp(Os(n,"x-ethers/mnemonicCounter")),u=new Jc.Counter(c),d=new Jc.ModeOfOperation.ctr(i,u),p=Os(n,"x-ethers/path")||p1,x=Os(n,"x-ethers/locale")||"en",y=rt(d.decrypt(l));try{const v=oR(y,x),b=Sl.fromMnemonic(v,null,x).derivePath(p);if(b.privateKey!=o.privateKey)throw new Error("mnemonic mismatch");o.mnemonic=b.mnemonic}catch(v){if(v.code!==Le.errors.INVALID_ARGUMENT||v.argument!=="wordlist")throw v}}return new fge(o)}function bU(n,e,t,r,s){return rt(iR(n,e,t,r,s))}function mge(n,e,t,r,s){return Promise.resolve(bU(n,e,t,r,s))}function vU(n,e,t,r,s){const i=lR(e),a=Os(n,"crypto/kdf");if(a&&typeof a=="string"){const o=function(l,c){return EI.throwArgumentError("invalid key-derivation function parameters",l,c)};if(a.toLowerCase()==="scrypt"){const l=Mp(Os(n,"crypto/kdfparams/salt")),c=parseInt(Os(n,"crypto/kdfparams/n")),u=parseInt(Os(n,"crypto/kdfparams/r")),d=parseInt(Os(n,"crypto/kdfparams/p"));(!c||!u||!d)&&o("kdf",a),(c&c-1)!==0&&o("N",c);const p=parseInt(Os(n,"crypto/kdfparams/dklen"));return p!==32&&o("dklen",p),r(i,l,c,u,d,64,s)}else if(a.toLowerCase()==="pbkdf2"){const l=Mp(Os(n,"crypto/kdfparams/salt"));let c=null;const u=Os(n,"crypto/kdfparams/prf");u==="hmac-sha256"?c="sha256":u==="hmac-sha512"?c="sha512":o("prf",u);const d=parseInt(Os(n,"crypto/kdfparams/c")),p=parseInt(Os(n,"crypto/kdfparams/dklen"));return p!==32&&o("dklen",p),t(i,l,d,p,c)}}return EI.throwArgumentError("unsupported key-derivation function","kdf",a)}function gge(n,e){const t=JSON.parse(n),r=vU(t,e,bU,cR.syncScrypt);return yU(t,r)}function xge(n,e,t){return dge(this,void 0,void 0,function*(){const r=JSON.parse(n),s=yield vU(r,e,mge,cR.scrypt,t);return yU(r,s)})}function yge(n,e,t,r){try{if(Es(n.address)!==Op(n.privateKey))throw new Error("address/privateKey mismatch");if(X5(n)){const b=n.mnemonic;if(Sl.fromMnemonic(b.phrase,null,b.locale).derivePath(b.path||p1).privateKey!=n.privateKey)throw new Error("mnemonic mismatch")}}catch(b){return Promise.reject(b)}typeof t=="function"&&!r&&(r=t,t={}),t||(t={});const s=rt(n.privateKey),i=lR(e);let a=null,o=null,l=null;if(X5(n)){const b=n.mnemonic;a=rt(fU(b.phrase,b.locale||"en")),o=b.path||p1,l=b.locale||"en"}let c=t.client;c||(c="ethers.js");let u=null;t.salt?u=rt(t.salt):u=Ty(32);let d=null;if(t.iv){if(d=rt(t.iv),d.length!==16)throw new Error("invalid iv")}else d=Ty(16);let p=null;if(t.uuid){if(p=rt(t.uuid),p.length!==16)throw new Error("invalid uuid")}else p=Ty(16);let x=1<<17,y=8,v=1;return t.scrypt&&(t.scrypt.N&&(x=t.scrypt.N),t.scrypt.r&&(y=t.scrypt.r),t.scrypt.p&&(v=t.scrypt.p)),cR.scrypt(i,u,x,y,v,64,r).then(b=>{b=rt(b);const S=b.slice(0,16),T=b.slice(16,32),C=b.slice(32,64),I=new Jc.Counter(d),$=new Jc.ModeOfOperation.ctr(S,I),q=rt($.encrypt(s)),U=Yr(zs([T,q])),F={address:n.address.substring(2).toLowerCase(),id:oge(p),version:3,crypto:{cipher:"aes-128-ctr",cipherparams:{iv:ot(d).substring(2)},ciphertext:ot(q).substring(2),kdf:"scrypt",kdfparams:{salt:ot(u).substring(2),n:x,dklen:32,p:v,r:y},mac:U.substring(2)}};if(a){const G=Ty(16),V=new Jc.Counter(G),O=new Jc.ModeOfOperation.ctr(C,V),K=rt(O.encrypt(a)),P=new Date,N=P.getUTCFullYear()+"-"+ly(P.getUTCMonth()+1,2)+"-"+ly(P.getUTCDate(),2)+"T"+ly(P.getUTCHours(),2)+"-"+ly(P.getUTCMinutes(),2)+"-"+ly(P.getUTCSeconds(),2)+".0Z";F["x-ethers"]={client:c,gethFilename:"UTC--"+N+"--"+F.address,mnemonicCounter:ot(G).substring(2),mnemonicCiphertext:ot(K).substring(2),path:o,locale:l,version:"0.1"}}return JSON.stringify(F)})}function bge(n,e,t){if(gU(n)){t&&t(0);const r=mU(n,e);return t&&t(1),Promise.resolve(r)}return xU(n)?xge(n,e,t):Promise.reject(new Error("invalid JSON wallet"))}function vge(n,e){if(gU(n))return mU(n,e);if(xU(n))return gge(n,e);throw new Error("invalid JSON wallet")}const _ge="wallet/5.8.0";var Y5=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const T0=new Le(_ge);function wge(n){return n!=null&&lr(n.privateKey,32)&&n.address!=null}function Ege(n){const e=n.mnemonic;return e&&e.phrase}class Sp extends Wg{constructor(e,t){if(super(),wge(e)){const r=new eg(e.privateKey);if(Ke(this,"_signingKey",()=>r),Ke(this,"address",Op(this.publicKey)),this.address!==Es(e.address)&&T0.throwArgumentError("privateKey/address mismatch","privateKey","[REDACTED]"),Ege(e)){const s=e.mnemonic;Ke(this,"_mnemonic",()=>({phrase:s.phrase,path:s.path||p1,locale:s.locale||"en"}));const i=this.mnemonic,a=Sl.fromMnemonic(i.phrase,null,i.locale).derivePath(i.path);Op(a.privateKey)!==this.address&&T0.throwArgumentError("mnemonic/address mismatch","privateKey","[REDACTED]")}else Ke(this,"_mnemonic",()=>null)}else{if(eg.isSigningKey(e))e.curve!=="secp256k1"&&T0.throwArgumentError("unsupported curve; must be secp256k1","privateKey","[REDACTED]"),Ke(this,"_signingKey",()=>e);else{typeof e=="string"&&e.match(/^[0-9a-f]*$/i)&&e.length===64&&(e="0x"+e);const r=new eg(e);Ke(this,"_signingKey",()=>r)}Ke(this,"_mnemonic",()=>null),Ke(this,"address",Op(this.publicKey))}t&&!sb.isProvider(t)&&T0.throwArgumentError("invalid provider","provider",t),Ke(this,"provider",t||null)}get mnemonic(){return this._mnemonic()}get privateKey(){return this._signingKey().privateKey}get publicKey(){return this._signingKey().publicKey}getAddress(){return Promise.resolve(this.address)}connect(e){return new Sp(this,e)}signTransaction(e){return Ls(e).then(t=>{t.from!=null&&(Es(t.from)!==this.address&&T0.throwArgumentError("transaction from address mismatch","transaction.from",e.from),delete t.from);const r=this._signingKey().signDigest(Yr(B5(t)));return B5(t,r)})}signMessage(e){return Y5(this,void 0,void 0,function*(){return n5(this._signingKey().signDigest(Ume(e)))})}_signTypedData(e,t,r){return Y5(this,void 0,void 0,function*(){const s=yield Xa.resolveNames(e,t,r,i=>(this.provider==null&&T0.throwError("cannot resolve ENS names without a provider",Le.errors.UNSUPPORTED_OPERATION,{operation:"resolveName",value:i}),this.provider.resolveName(i)));return n5(this._signingKey().signDigest(Xa.hash(s.domain,t,s.value)))})}encrypt(e,t,r){if(typeof t=="function"&&!r&&(r=t,t={}),r&&typeof r!="function")throw new Error("invalid callback");return t||(t={}),yge(this,e,t,r)}static createRandom(e){let t=Ty(16);e||(e={}),e.extraEntropy&&(t=rt(ui(Yr(zs([t,e.extraEntropy])),0,16)));const r=oR(t,e.locale);return Sp.fromMnemonic(r,e.path,e.locale)}static fromEncryptedJson(e,t,r){return bge(e,t,r).then(s=>new Sp(s))}static fromEncryptedJsonSync(e,t){return new Sp(vge(e,t))}static fromMnemonic(e,t,r){return t||(t=p1),new Sp(Sl.fromMnemonic(e,null,r).derivePath(t))}}const Sge="networks/5.8.0",Z5=new Le(Sge);function Tge(n){return n&&typeof n.renetwork=="function"}function rc(n){const e=function(t,r){r==null&&(r={});const s=[];if(t.InfuraProvider&&r.infura!=="-")try{s.push(new t.InfuraProvider(n,r.infura))}catch{}if(t.EtherscanProvider&&r.etherscan!=="-")try{s.push(new t.EtherscanProvider(n,r.etherscan))}catch{}if(t.AlchemyProvider&&r.alchemy!=="-")try{s.push(new t.AlchemyProvider(n,r.alchemy))}catch{}if(t.PocketProvider&&r.pocket!=="-"){const i=["goerli","ropsten","rinkeby","sepolia"];try{const a=new t.PocketProvider(n,r.pocket);a.network&&i.indexOf(a.network.name)===-1&&s.push(a)}catch{}}if(t.CloudflareProvider&&r.cloudflare!=="-")try{s.push(new t.CloudflareProvider(n))}catch{}if(t.AnkrProvider&&r.ankr!=="-")try{const i=["ropsten"],a=new t.AnkrProvider(n,r.ankr);a.network&&i.indexOf(a.network.name)===-1&&s.push(a)}catch{}if(t.QuickNodeProvider&&r.quicknode!=="-")try{s.push(new t.QuickNodeProvider(n,r.quicknode))}catch{}if(s.length===0)return null;if(t.FallbackProvider){let i=1;return r.quorum!=null?i=r.quorum:n==="homestead"&&(i=2),new t.FallbackProvider(s,i)}return s[0]};return e.renetwork=function(t){return rc(t)},e}function gE(n,e){const t=function(r,s){return r.JsonRpcProvider?new r.JsonRpcProvider(n,e):null};return t.renetwork=function(r){return gE(n,r)},t}const Q5={chainId:1,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"homestead",_defaultProvider:rc("homestead")},J5={chainId:3,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"ropsten",_defaultProvider:rc("ropsten")},eF={chainId:63,name:"classicMordor",_defaultProvider:gE("https://www.ethercluster.com/mordor","classicMordor")},rw={unspecified:{chainId:0,name:"unspecified"},homestead:Q5,mainnet:Q5,morden:{chainId:2,name:"morden"},ropsten:J5,testnet:J5,rinkeby:{chainId:4,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"rinkeby",_defaultProvider:rc("rinkeby")},kovan:{chainId:42,name:"kovan",_defaultProvider:rc("kovan")},goerli:{chainId:5,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"goerli",_defaultProvider:rc("goerli")},kintsugi:{chainId:1337702,name:"kintsugi"},sepolia:{chainId:11155111,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"sepolia",_defaultProvider:rc("sepolia")},holesky:{chainId:17e3,name:"holesky",_defaultProvider:rc("holesky")},classic:{chainId:61,name:"classic",_defaultProvider:gE("https://www.ethercluster.com/etc","classic")},classicMorden:{chainId:62,name:"classicMorden"},classicMordor:eF,classicTestnet:eF,classicKotti:{chainId:6,name:"classicKotti",_defaultProvider:gE("https://www.ethercluster.com/kotti","classicKotti")},xdai:{chainId:100,name:"xdai"},matic:{chainId:137,name:"matic",_defaultProvider:rc("matic")},maticmum:{chainId:80001,name:"maticmum",_defaultProvider:rc("maticmum")},optimism:{chainId:10,name:"optimism",_defaultProvider:rc("optimism")},"optimism-kovan":{chainId:69,name:"optimism-kovan"},"optimism-goerli":{chainId:420,name:"optimism-goerli"},"optimism-sepolia":{chainId:11155420,name:"optimism-sepolia"},arbitrum:{chainId:42161,name:"arbitrum"},"arbitrum-rinkeby":{chainId:421611,name:"arbitrum-rinkeby"},"arbitrum-goerli":{chainId:421613,name:"arbitrum-goerli"},"arbitrum-sepolia":{chainId:421614,name:"arbitrum-sepolia"},bnb:{chainId:56,name:"bnb"},bnbt:{chainId:97,name:"bnbt"}};function Cge(n){if(n==null)return null;if(typeof n=="number"){for(const r in rw){const s=rw[r];if(s.chainId===n)return{name:s.name,chainId:s.chainId,ensAddress:s.ensAddress||null,_defaultProvider:s._defaultProvider||null}}return{chainId:n,name:"unknown"}}if(typeof n=="string"){const r=rw[n];return r==null?null:{name:r.name,chainId:r.chainId,ensAddress:r.ensAddress,_defaultProvider:r._defaultProvider||null}}const e=rw[n.name];if(!e)return typeof n.chainId!="number"&&Z5.throwArgumentError("invalid network chainId","network",n),n;n.chainId!==0&&n.chainId!==e.chainId&&Z5.throwArgumentError("network chainId mismatch","network",n);let t=n._defaultProvider||null;return t==null&&e._defaultProvider&&(Tge(e._defaultProvider)?t=e._defaultProvider.renetwork(n):t=e._defaultProvider),{name:n.name,chainId:e.chainId,ensAddress:n.ensAddress||e.ensAddress||null,_defaultProvider:t}}const Age="web/5.8.0";var Nge=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};function kge(n,e){return Nge(this,void 0,void 0,function*(){e==null&&(e={});const t={method:e.method||"GET",headers:e.headers||{},body:e.body||void 0};if(e.skipFetchSetup!==!0&&(t.mode="cors",t.cache="no-cache",t.credentials="same-origin",t.redirect="follow",t.referrer="client"),e.fetchOptions!=null){const a=e.fetchOptions;a.mode&&(t.mode=a.mode),a.cache&&(t.cache=a.cache),a.credentials&&(t.credentials=a.credentials),a.redirect&&(t.redirect=a.redirect),a.referrer&&(t.referrer=a.referrer)}const r=yield fetch(n,t),s=yield r.arrayBuffer(),i={};return r.headers.forEach?r.headers.forEach((a,o)=>{i[o.toLowerCase()]=a}):r.headers.keys().forEach(a=>{i[a.toLowerCase()]=r.headers.get(a)}),{headers:i,statusCode:r.status,statusMessage:r.statusText,body:rt(new Uint8Array(s))}})}var Ige=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const Jl=new Le(Age);function tF(n){return new Promise(e=>{setTimeout(e,n)})}function Nd(n,e){if(n==null)return null;if(typeof n=="string")return n;if($S(n)){if(e&&(e.split("/")[0]==="text"||e.split(";")[0].trim()==="application/json"))try{return rb(n)}catch{}return ot(n)}return n}function Rge(n){return Pi(n.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function Dge(n,e,t){const r=typeof n=="object"&&n.throttleLimit!=null?n.throttleLimit:12;Jl.assertArgument(r>0&&r%1===0,"invalid connection throttle limit","connection.throttleLimit",r);const s=typeof n=="object"?n.throttleCallback:null,i=typeof n=="object"&&typeof n.throttleSlotInterval=="number"?n.throttleSlotInterval:100;Jl.assertArgument(i>0&&i%1===0,"invalid connection throttle slot interval","connection.throttleSlotInterval",i);const a=typeof n=="object"?!!n.errorPassThrough:!1,o={};let l=null;const c={method:"GET"};let u=!1,d=120*1e3;if(typeof n=="string")l=n;else if(typeof n=="object"){if((n==null||n.url==null)&&Jl.throwArgumentError("missing URL","connection.url",n),l=n.url,typeof n.timeout=="number"&&n.timeout>0&&(d=n.timeout),n.headers)for(const S in n.headers)o[S.toLowerCase()]={key:S,value:String(n.headers[S])},["if-none-match","if-modified-since"].indexOf(S.toLowerCase())>=0&&(u=!0);if(c.allowGzip=!!n.allowGzip,n.user!=null&&n.password!=null){l.substring(0,6)!=="https:"&&n.allowInsecureAuthentication!==!0&&Jl.throwError("basic authentication requires a secure https url",Le.errors.INVALID_ARGUMENT,{argument:"url",url:l,user:n.user,password:"[REDACTED]"});const S=n.user+":"+n.password;o.authorization={key:"Authorization",value:"Basic "+jV(Pi(S))}}n.skipFetchSetup!=null&&(c.skipFetchSetup=!!n.skipFetchSetup),n.fetchOptions!=null&&(c.fetchOptions=pi(n.fetchOptions))}const p=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),x=l?l.match(p):null;if(x)try{const S={statusCode:200,statusMessage:"OK",headers:{"content-type":x[1]||"text/plain"},body:x[2]?zV(x[3]):Rge(x[3])};let T=S.body;return t&&(T=t(S.body,S)),Promise.resolve(T)}catch(S){Jl.throwError("processing response error",Le.errors.SERVER_ERROR,{body:Nd(x[1],x[2]),error:S,requestBody:null,requestMethod:"GET",url:l})}e&&(c.method="POST",c.body=e,o["content-type"]==null&&(o["content-type"]={key:"Content-Type",value:"application/octet-stream"}),o["content-length"]==null&&(o["content-length"]={key:"Content-Length",value:String(e.length)}));const y={};Object.keys(o).forEach(S=>{const T=o[S];y[T.key]=T.value}),c.headers=y;const v=(function(){let S=null;return{promise:new Promise(function(I,$){d&&(S=setTimeout(()=>{S!=null&&(S=null,$(Jl.makeError("timeout",Le.errors.TIMEOUT,{requestBody:Nd(c.body,y["content-type"]),requestMethod:c.method,timeout:d,url:l})))},d))}),cancel:function(){S!=null&&(clearTimeout(S),S=null)}}})(),b=(function(){return Ige(this,void 0,void 0,function*(){for(let S=0;S<r;S++){let T=null;try{if(T=yield kge(l,c),S<r){if(T.statusCode===301||T.statusCode===302){const I=T.headers.location||"";if(c.method==="GET"&&I.match(/^https:/)){l=T.headers.location;continue}}else if(T.statusCode===429){let I=!0;if(s&&(I=yield s(S,l)),I){let $=0;const q=T.headers["retry-after"];typeof q=="string"&&q.match(/^[1-9][0-9]*$/)?$=parseInt(q)*1e3:$=i*parseInt(String(Math.random()*Math.pow(2,S))),yield tF($);continue}}}}catch(I){T=I.response,T==null&&(v.cancel(),Jl.throwError("missing response",Le.errors.SERVER_ERROR,{requestBody:Nd(c.body,y["content-type"]),requestMethod:c.method,serverError:I,url:l}))}let C=T.body;if(u&&T.statusCode===304?C=null:!a&&(T.statusCode<200||T.statusCode>=300)&&(v.cancel(),Jl.throwError("bad response",Le.errors.SERVER_ERROR,{status:T.statusCode,headers:T.headers,body:Nd(C,T.headers?T.headers["content-type"]:null),requestBody:Nd(c.body,y["content-type"]),requestMethod:c.method,url:l})),t)try{const I=yield t(C,T);return v.cancel(),I}catch(I){if(I.throttleRetry&&S<r){let $=!0;if(s&&($=yield s(S,l)),$){const q=i*parseInt(String(Math.random()*Math.pow(2,S)));yield tF(q);continue}}v.cancel(),Jl.throwError("processing response error",Le.errors.SERVER_ERROR,{body:Nd(C,T.headers?T.headers["content-type"]:null),error:I,requestBody:Nd(c.body,y["content-type"]),requestMethod:c.method,url:l})}return v.cancel(),C}return Jl.throwError("failed response",Le.errors.SERVER_ERROR,{requestBody:Nd(c.body,y["content-type"]),requestMethod:c.method,url:l})})})();return Promise.race([v.promise,b])}function uR(n,e,t){let r=(i,a)=>{let o=null;if(i!=null)try{o=JSON.parse(rb(i))}catch(l){Jl.throwError("invalid JSON",Le.errors.SERVER_ERROR,{body:i,error:l})}return t&&(o=t(o,a)),o},s=null;if(e!=null){s=Pi(e);const i=typeof n=="string"?{url:n}:pi(n);i.headers?Object.keys(i.headers).filter(o=>o.toLowerCase()==="content-type").length!==0||(i.headers=pi(i.headers),i.headers["content-type"]="application/json"):i.headers={"content-type":"application/json"},n=i}return Dge(n,s,r)}function Cy(n,e){return e||(e={}),e=pi(e),e.floor==null&&(e.floor=0),e.ceiling==null&&(e.ceiling=1e4),e.interval==null&&(e.interval=250),new Promise(function(t,r){let s=null,i=!1;const a=()=>i?!1:(i=!0,s&&clearTimeout(s),!0);e.timeout&&(s=setTimeout(()=>{a()&&r(new Error("timeout"))},e.timeout));const o=e.retryLimit;let l=0;function c(){return n().then(function(u){if(u!==void 0)a()&&t(u);else if(e.oncePoll)e.oncePoll.once("poll",c);else if(e.onceBlock)e.onceBlock.once("block",c);else if(!i){if(l++,l>o){a()&&r(new Error("retry limit reached"));return}let d=e.interval*parseInt(String(Math.random()*Math.pow(2,l)));d<e.floor&&(d=e.floor),d>e.ceiling&&(d=e.ceiling),setTimeout(c,d)}return null},function(u){a()&&r(u)})}c()})}var ok,nF;function $ge(){if(nF)return ok;nF=1;for(var n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",e={},t=0;t<n.length;t++){var r=n.charAt(t);if(e[r]!==void 0)throw new TypeError(r+" is ambiguous");e[r]=t}function s(v){var b=v>>25;return(v&33554431)<<5^-(b>>0&1)&996825010^-(b>>1&1)&642813549^-(b>>2&1)&513874426^-(b>>3&1)&1027748829^-(b>>4&1)&705979059}function i(v){for(var b=1,S=0;S<v.length;++S){var T=v.charCodeAt(S);if(T<33||T>126)return"Invalid prefix ("+v+")";b=s(b)^T>>5}for(b=s(b),S=0;S<v.length;++S){var C=v.charCodeAt(S);b=s(b)^C&31}return b}function a(v,b,S){if(S=S||90,v.length+7+b.length>S)throw new TypeError("Exceeds length limit");v=v.toLowerCase();var T=i(v);if(typeof T=="string")throw new Error(T);for(var C=v+"1",I=0;I<b.length;++I){var $=b[I];if($>>5!==0)throw new Error("Non 5-bit word");T=s(T)^$,C+=n.charAt($)}for(I=0;I<6;++I)T=s(T);for(T^=1,I=0;I<6;++I){var q=T>>(5-I)*5&31;C+=n.charAt(q)}return C}function o(v,b){if(b=b||90,v.length<8)return v+" too short";if(v.length>b)return"Exceeds length limit";var S=v.toLowerCase(),T=v.toUpperCase();if(v!==S&&v!==T)return"Mixed-case string "+v;v=S;var C=v.lastIndexOf("1");if(C===-1)return"No separator character for "+v;if(C===0)return"Missing prefix for "+v;var I=v.slice(0,C),$=v.slice(C+1);if($.length<6)return"Data too short";var q=i(I);if(typeof q=="string")return q;for(var U=[],F=0;F<$.length;++F){var G=$.charAt(F),V=e[G];if(V===void 0)return"Unknown character "+G;q=s(q)^V,!(F+6>=$.length)&&U.push(V)}return q!==1?"Invalid checksum for "+v:{prefix:I,words:U}}function l(){var v=o.apply(null,arguments);if(typeof v=="object")return v}function c(v){var b=o.apply(null,arguments);if(typeof b=="object")return b;throw new Error(b)}function u(v,b,S,T){for(var C=0,I=0,$=(1<<S)-1,q=[],U=0;U<v.length;++U)for(C=C<<b|v[U],I+=b;I>=S;)I-=S,q.push(C>>I&$);if(T)I>0&&q.push(C<<S-I&$);else{if(I>=b)return"Excess padding";if(C<<S-I&$)return"Non-zero padding"}return q}function d(v){var b=u(v,8,5,!0);if(Array.isArray(b))return b}function p(v){var b=u(v,8,5,!0);if(Array.isArray(b))return b;throw new Error(b)}function x(v){var b=u(v,5,8,!1);if(Array.isArray(b))return b}function y(v){var b=u(v,5,8,!1);if(Array.isArray(b))return b;throw new Error(b)}return ok={decodeUnsafe:l,decode:c,encode:a,toWordsUnsafe:d,toWords:p,fromWordsUnsafe:x,fromWords:y},ok}var Lge=$ge();const rF=ku(Lge),FS="providers/5.8.0",cy=new Le(FS);class Ct{constructor(){this.formats=this.getDefaultFormats()}getDefaultFormats(){const e={},t=this.address.bind(this),r=this.bigNumber.bind(this),s=this.blockTag.bind(this),i=this.data.bind(this),a=this.hash.bind(this),o=this.hex.bind(this),l=this.number.bind(this),c=this.type.bind(this),u=d=>this.data(d,!0);return e.transaction={hash:a,type:c,accessList:Ct.allowNull(this.accessList.bind(this),null),blockHash:Ct.allowNull(a,null),blockNumber:Ct.allowNull(l,null),transactionIndex:Ct.allowNull(l,null),confirmations:Ct.allowNull(l,null),from:t,gasPrice:Ct.allowNull(r),maxPriorityFeePerGas:Ct.allowNull(r),maxFeePerGas:Ct.allowNull(r),gasLimit:r,to:Ct.allowNull(t,null),value:r,nonce:l,data:i,r:Ct.allowNull(this.uint256),s:Ct.allowNull(this.uint256),v:Ct.allowNull(l),creates:Ct.allowNull(t,null),raw:Ct.allowNull(i)},e.transactionRequest={from:Ct.allowNull(t),nonce:Ct.allowNull(l),gasLimit:Ct.allowNull(r),gasPrice:Ct.allowNull(r),maxPriorityFeePerGas:Ct.allowNull(r),maxFeePerGas:Ct.allowNull(r),to:Ct.allowNull(t),value:Ct.allowNull(r),data:Ct.allowNull(u),type:Ct.allowNull(l),accessList:Ct.allowNull(this.accessList.bind(this),null)},e.receiptLog={transactionIndex:l,blockNumber:l,transactionHash:a,address:t,topics:Ct.arrayOf(a),data:i,logIndex:l,blockHash:a},e.receipt={to:Ct.allowNull(this.address,null),from:Ct.allowNull(this.address,null),contractAddress:Ct.allowNull(t,null),transactionIndex:l,root:Ct.allowNull(o),gasUsed:r,logsBloom:Ct.allowNull(i),blockHash:a,transactionHash:a,logs:Ct.arrayOf(this.receiptLog.bind(this)),blockNumber:l,confirmations:Ct.allowNull(l,null),cumulativeGasUsed:r,effectiveGasPrice:Ct.allowNull(r),status:Ct.allowNull(l),type:c},e.block={hash:Ct.allowNull(a),parentHash:a,number:l,timestamp:l,nonce:Ct.allowNull(o),difficulty:this.difficulty.bind(this),gasLimit:r,gasUsed:r,miner:Ct.allowNull(t),extraData:i,transactions:Ct.allowNull(Ct.arrayOf(a)),baseFeePerGas:Ct.allowNull(r)},e.blockWithTransactions=pi(e.block),e.blockWithTransactions.transactions=Ct.allowNull(Ct.arrayOf(this.transactionResponse.bind(this))),e.filter={fromBlock:Ct.allowNull(s,void 0),toBlock:Ct.allowNull(s,void 0),blockHash:Ct.allowNull(a,void 0),address:Ct.allowNull(t,void 0),topics:Ct.allowNull(this.topics.bind(this),void 0)},e.filterLog={blockNumber:Ct.allowNull(l),blockHash:Ct.allowNull(a),transactionIndex:l,removed:Ct.allowNull(this.boolean.bind(this)),address:t,data:Ct.allowFalsish(i,"0x"),topics:Ct.arrayOf(a),transactionHash:a,logIndex:l},e}accessList(e){return Kg(e||[])}number(e){return e==="0x"?0:st.from(e).toNumber()}type(e){return e==="0x"||e==null?0:st.from(e).toNumber()}bigNumber(e){return st.from(e)}boolean(e){if(typeof e=="boolean")return e;if(typeof e=="string"){if(e=e.toLowerCase(),e==="true")return!0;if(e==="false")return!1}throw new Error("invalid boolean - "+e)}hex(e,t){return typeof e=="string"&&(!t&&e.substring(0,2)!=="0x"&&(e="0x"+e),lr(e))?e.toLowerCase():cy.throwArgumentError("invalid hash","value",e)}data(e,t){const r=this.hex(e,t);if(r.length%2!==0)throw new Error("invalid data; odd-length - "+e);return r}address(e){return Es(e)}callAddress(e){if(!lr(e,32))return null;const t=Es(ui(e,12));return t===tme?null:t}contractAddress(e){return RV(e)}blockTag(e){if(e==null)return"latest";if(e==="earliest")return"0x0";switch(e){case"earliest":return"0x0";case"latest":case"pending":case"safe":case"finalized":return e}if(typeof e=="number"||lr(e))return X4(e);throw new Error("invalid blockTag")}hash(e,t){const r=this.hex(e,t);return Qp(r)!==32?cy.throwArgumentError("invalid hash","value",e):r}difficulty(e){if(e==null)return null;const t=st.from(e);try{return t.toNumber()}catch{}return null}uint256(e){if(!lr(e))throw new Error("invalid uint256");return Gr(e,32)}_block(e,t){e.author!=null&&e.miner==null&&(e.miner=e.author);const r=e._difficulty!=null?e._difficulty:e.difficulty,s=Ct.check(t,e);return s._difficulty=r==null?null:st.from(r),s}block(e){return this._block(e,this.formats.block)}blockWithTransactions(e){return this._block(e,this.formats.blockWithTransactions)}transactionRequest(e){return Ct.check(this.formats.transactionRequest,e)}transactionResponse(e){e.gas!=null&&e.gasLimit==null&&(e.gasLimit=e.gas),e.to&&st.from(e.to).isZero()&&(e.to="0x0000000000000000000000000000000000000000"),e.input!=null&&e.data==null&&(e.data=e.input),e.to==null&&e.creates==null&&(e.creates=this.contractAddress(e)),(e.type===1||e.type===2)&&e.accessList==null&&(e.accessList=[]);const t=Ct.check(this.formats.transaction,e);if(e.chainId!=null){let r=e.chainId;lr(r)&&(r=st.from(r).toNumber()),t.chainId=r}else{let r=e.networkId;r==null&&t.v==null&&(r=e.chainId),lr(r)&&(r=st.from(r).toNumber()),typeof r!="number"&&t.v!=null&&(r=(t.v-35)/2,r<0&&(r=0),r=parseInt(r)),typeof r!="number"&&(r=0),t.chainId=r}return t.blockHash&&t.blockHash.replace(/0/g,"")==="x"&&(t.blockHash=null),t}transaction(e){return O0e(e)}receiptLog(e){return Ct.check(this.formats.receiptLog,e)}receipt(e){const t=Ct.check(this.formats.receipt,e);if(t.root!=null)if(t.root.length<=4){const r=st.from(t.root).toNumber();r===0||r===1?(t.status!=null&&t.status!==r&&cy.throwArgumentError("alt-root-status/status mismatch","value",{root:t.root,status:t.status}),t.status=r,delete t.root):cy.throwArgumentError("invalid alt-root-status","value.root",t.root)}else t.root.length!==66&&cy.throwArgumentError("invalid root hash","value.root",t.root);return t.status!=null&&(t.byzantium=!0),t}topics(e){return Array.isArray(e)?e.map(t=>this.topics(t)):e!=null?this.hash(e,!0):null}filter(e){return Ct.check(this.formats.filter,e)}filterLog(e){return Ct.check(this.formats.filterLog,e)}static check(e,t){const r={};for(const s in e)try{const i=e[s](t[s]);i!==void 0&&(r[s]=i)}catch(i){throw i.checkKey=s,i.checkValue=t[s],i}return r}static allowNull(e,t){return(function(r){return r==null?t:e(r)})}static allowFalsish(e,t){return(function(r){return r?e(r):t})}static arrayOf(e){return(function(t){if(!Array.isArray(t))throw new Error("not an array");const r=[];return t.forEach(function(s){r.push(e(s))}),r})}}var on=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const Pn=new Le(FS),Pge=10;function sF(n){return n==null?"null":(Qp(n)!==32&&Pn.throwArgumentError("invalid topic","topic",n),n.toLowerCase())}function iF(n){for(n=n.slice();n.length>0&&n[n.length-1]==null;)n.pop();return n.map(e=>{if(Array.isArray(e)){const t={};e.forEach(s=>{t[sF(s)]=!0});const r=Object.keys(t);return r.sort(),r.join("|")}else return sF(e)}).join("&")}function Oge(n){return n===""?[]:n.split(/&/g).map(e=>{if(e==="")return[];const t=e.split("|").map(r=>r==="null"?null:r);return t.length===1?t[0]:t})}function C0(n){if(typeof n=="string"){if(n=n.toLowerCase(),Qp(n)===32)return"tx:"+n;if(n.indexOf(":")===-1)return n}else{if(Array.isArray(n))return"filter:*:"+iF(n);if(s0e.isForkEvent(n))throw Pn.warn("not implemented"),new Error("not implemented");if(n&&typeof n=="object")return"filter:"+(n.address||"*")+":"+iF(n.topics||[])}throw new Error("invalid event - "+n)}function uy(){return new Date().getTime()}function aF(n){return new Promise(e=>{setTimeout(e,n)})}const Mge=["block","network","pending","poll"];let Fge=class{constructor(e,t,r){Ke(this,"tag",e),Ke(this,"listener",t),Ke(this,"once",r),this._lastBlockNumber=-2,this._inflight=!1}get event(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter}return this.tag}get type(){return this.tag.split(":")[0]}get hash(){const e=this.tag.split(":");return e[0]!=="tx"?null:e[1]}get filter(){const e=this.tag.split(":");if(e[0]!=="filter")return null;const t=e[1],r=Oge(e[2]),s={};return r.length>0&&(s.topics=r),t&&t!=="*"&&(s.address=t),s}pollable(){return this.tag.indexOf(":")>=0||Mge.indexOf(this.tag)>=0}};const Bge={0:{symbol:"btc",p2pkh:0,p2sh:5,prefix:"bc"},2:{symbol:"ltc",p2pkh:48,p2sh:50,prefix:"ltc"},3:{symbol:"doge",p2pkh:30,p2sh:22},60:{symbol:"eth",ilk:"eth"},61:{symbol:"etc",ilk:"eth"},700:{symbol:"xdai",ilk:"eth"}};function lk(n){return Gr(st.from(n).toHexString(),32)}function oF(n){return d1.encode(zs([n,ui(tm(tm(n)),0,4)]))}const _U=new RegExp("^(ipfs)://(.*)$","i"),lF=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),_U,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];function Gw(n,e){try{return rb(m1(n,e))}catch{}return null}function m1(n,e){if(n==="0x")return null;const t=st.from(ui(n,e,e+32)).toNumber(),r=st.from(ui(n,t,t+32)).toNumber();return ui(n,t+32,t+32+r)}function ck(n){return n.match(/^ipfs:\/\/ipfs\//i)?n=n.substring(12):n.match(/^ipfs:\/\//i)?n=n.substring(7):Pn.throwArgumentError("unsupported IPFS format","link",n),`https://gateway.ipfs.io/ipfs/${n}`}function cF(n){const e=rt(n);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function zge(n){if(n.length%32===0)return n;const e=new Uint8Array(Math.ceil(n.length/32)*32);return e.set(n),e}function wU(n){const e=[];let t=0;for(let r=0;r<n.length;r++)e.push(null),t+=32;for(let r=0;r<n.length;r++){const s=rt(n[r]);e[r]=cF(t),e.push(cF(s.length)),e.push(zge(s)),t+=32+Math.ceil(s.length/32)*32}return xo(e)}class uF{constructor(e,t,r,s){Ke(this,"provider",e),Ke(this,"name",r),Ke(this,"address",e.formatter.address(t)),Ke(this,"_resolvedAddress",s)}supportsWildcard(){return this._supportsEip2544||(this._supportsEip2544=this.provider.call({to:this.address,data:"0x01ffc9a79061b92300000000000000000000000000000000000000000000000000000000"}).then(e=>st.from(e).eq(1)).catch(e=>{if(e.code===Le.errors.CALL_EXCEPTION)return!1;throw this._supportsEip2544=null,e})),this._supportsEip2544}_fetch(e,t){return on(this,void 0,void 0,function*(){const r={to:this.address,ccipReadEnabled:!0,data:xo([e,Bw(this.name),t||"0x"])};let s=!1;(yield this.supportsWildcard())&&(s=!0,r.data=xo(["0x9061b923",wU([jme(this.name),r.data])]));try{let i=yield this.provider.call(r);return rt(i).length%32===4&&Pn.throwError("resolver threw error",Le.errors.CALL_EXCEPTION,{transaction:r,data:i}),s&&(i=m1(i,0)),i}catch(i){if(i.code===Le.errors.CALL_EXCEPTION)return null;throw i}})}_fetchBytes(e,t){return on(this,void 0,void 0,function*(){const r=yield this._fetch(e,t);return r!=null?m1(r,0):null})}_getAddress(e,t){const r=Bge[String(e)];if(r==null&&Pn.throwError(`unsupported coin type: ${e}`,Le.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${e})`}),r.ilk==="eth")return this.provider.formatter.address(t);const s=rt(t);if(r.p2pkh!=null){const i=t.match(/^0x76a9([0-9a-f][0-9a-f])([0-9a-f]*)88ac$/);if(i){const a=parseInt(i[1],16);if(i[2].length===a*2&&a>=1&&a<=75)return oF(zs([[r.p2pkh],"0x"+i[2]]))}}if(r.p2sh!=null){const i=t.match(/^0xa9([0-9a-f][0-9a-f])([0-9a-f]*)87$/);if(i){const a=parseInt(i[1],16);if(i[2].length===a*2&&a>=1&&a<=75)return oF(zs([[r.p2sh],"0x"+i[2]]))}}if(r.prefix!=null){const i=s[1];let a=s[0];if(a===0?i!==20&&i!==32&&(a=-1):a=-1,a>=0&&s.length===2+i&&i>=1&&i<=75){const o=rF.toWords(s.slice(2));return o.unshift(a),rF.encode(r.prefix,o)}}return null}getAddress(e){return on(this,void 0,void 0,function*(){if(e==null&&(e=60),e===60)try{const s=yield this._fetch("0x3b3b57de");return s==="0x"||s===ime?null:this.provider.formatter.callAddress(s)}catch(s){if(s.code===Le.errors.CALL_EXCEPTION)return null;throw s}const t=yield this._fetchBytes("0xf1cb7e06",lk(e));if(t==null||t==="0x")return null;const r=this._getAddress(e,t);return r==null&&Pn.throwError("invalid or unsupported coin data",Le.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${e})`,coinType:e,data:t}),r})}getAvatar(){return on(this,void 0,void 0,function*(){const e=[{type:"name",content:this.name}];try{const t=yield this.getText("avatar");if(t==null)return null;for(let r=0;r<lF.length;r++){const s=t.match(lF[r]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":return e.push({type:"url",content:t}),{linkage:e,url:t};case"data":return e.push({type:"data",content:t}),{linkage:e,url:t};case"ipfs":return e.push({type:"ipfs",content:t}),{linkage:e,url:ck(t)};case"erc721":case"erc1155":{const a=i==="erc721"?"0xc87b56dd":"0x0e89341c";e.push({type:i,content:t});const o=this._resolvedAddress||(yield this.getAddress()),l=(s[2]||"").split("/");if(l.length!==2)return null;const c=yield this.provider.formatter.address(l[0]),u=Gr(st.from(l[1]).toHexString(),32);if(i==="erc721"){const v=this.provider.formatter.callAddress(yield this.provider.call({to:c,data:xo(["0x6352211e",u])}));if(o!==v)return null;e.push({type:"owner",content:v})}else if(i==="erc1155"){const v=st.from(yield this.provider.call({to:c,data:xo(["0x00fdd58e",Gr(o,32),u])}));if(v.isZero())return null;e.push({type:"balance",content:v.toString()})}const d={to:this.provider.formatter.address(l[0]),data:xo([a,u])};let p=Gw(yield this.provider.call(d),0);if(p==null)return null;e.push({type:"metadata-url-base",content:p}),i==="erc1155"&&(p=p.replace("{id}",u.substring(2)),e.push({type:"metadata-url-expanded",content:p})),p.match(/^ipfs:/i)&&(p=ck(p)),e.push({type:"metadata-url",content:p});const x=yield uR(p);if(!x)return null;e.push({type:"metadata",content:JSON.stringify(x)});let y=x.image;if(typeof y!="string")return null;if(!y.match(/^(https:\/\/|data:)/i)){if(y.match(_U)==null)return null;e.push({type:"url-ipfs",content:y}),y=ck(y)}return e.push({type:"url",content:y}),{linkage:e,url:y}}}}}catch{}return null})}getContentHash(){return on(this,void 0,void 0,function*(){const e=yield this._fetchBytes("0xbc1c58d1");if(e==null||e==="0x")return null;const t=e.match(/^0xe3010170(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const a=parseInt(t[3],16);if(t[4].length===a*2)return"ipfs://"+d1.encode("0x"+t[1])}const r=e.match(/^0xe5010172(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(r){const a=parseInt(r[3],16);if(r[4].length===a*2)return"ipns://"+d1.encode("0x"+r[1])}const s=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(s&&s[1].length===64)return"bzz://"+s[1];const i=e.match(/^0x90b2c605([0-9a-f]*)$/);if(i&&i[1].length===68){const a={"=":"","+":"-","/":"_"};return"sia://"+jV("0x"+i[1]).replace(/[=+\/]/g,l=>a[l])}return Pn.throwError("invalid or unsupported content hash data",Le.errors.UNSUPPORTED_OPERATION,{operation:"getContentHash()",data:e})})}getText(e){return on(this,void 0,void 0,function*(){let t=Pi(e);t=zs([lk(64),lk(t.length),t]),t.length%32!==0&&(t=zs([t,Gr("0x",32-e.length%32)]));const r=yield this._fetchBytes("0x59d1d43c",ot(t));return r==null||r==="0x"?null:rb(r)})}}let uk=null,jge=1;class Vge extends sb{constructor(e){if(super(),this._events=[],this._emitted={block:-2},this.disableCcipRead=!1,this.formatter=new.target.getFormatter(),Ke(this,"anyNetwork",e==="any"),this.anyNetwork&&(e=this.detectNetwork()),e instanceof Promise)this._networkPromise=e,e.catch(t=>{}),this._ready().catch(t=>{});else{const t=Qc(new.target,"getNetwork")(e);t?(Ke(this,"_network",t),this.emit("network",t,null)):Pn.throwArgumentError("invalid network","network",e)}this._maxInternalBlockNumber=-1024,this._lastBlockNumber=-2,this._maxFilterBlockRange=10,this._pollingInterval=4e3,this._fastQueryDate=0}_ready(){return on(this,void 0,void 0,function*(){if(this._network==null){let e=null;if(this._networkPromise)try{e=yield this._networkPromise}catch{}e==null&&(e=yield this.detectNetwork()),e||Pn.throwError("no network detected",Le.errors.UNKNOWN_ERROR,{}),this._network==null&&(this.anyNetwork?this._network=e:Ke(this,"_network",e),this.emit("network",e,null))}return this._network})}get ready(){return Cy(()=>this._ready().then(e=>e,e=>{if(!(e.code===Le.errors.NETWORK_ERROR&&e.event==="noNetwork"))throw e}))}static getFormatter(){return uk==null&&(uk=new Ct),uk}static getNetwork(e){return Cge(e??"homestead")}ccipReadFetch(e,t,r){return on(this,void 0,void 0,function*(){if(this.disableCcipRead||r.length===0)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),a=[];for(let o=0;o<r.length;o++){const l=r[o],c=l.replace("{sender}",s).replace("{data}",i),u=l.indexOf("{data}")>=0?null:JSON.stringify({data:i,sender:s}),d=yield uR({url:c,errorPassThrough:!0},u,(x,y)=>(x.status=y.statusCode,x));if(d.data)return d.data;const p=d.message||"unknown error";if(d.status>=400&&d.status<500)return Pn.throwError(`response not found during CCIP fetch: ${p}`,Le.errors.SERVER_ERROR,{url:l,errorMessage:p});a.push(p)}return Pn.throwError(`error encountered during CCIP fetch: ${a.map(o=>JSON.stringify(o)).join(", ")}`,Le.errors.SERVER_ERROR,{urls:r,errorMessages:a})})}_getInternalBlockNumber(e){return on(this,void 0,void 0,function*(){if(yield this._ready(),e>0)for(;this._internalBlockNumber;){const s=this._internalBlockNumber;try{const i=yield s;if(uy()-i.respTime<=e)return i.blockNumber;break}catch{if(this._internalBlockNumber===s)break}}const t=uy(),r=Ls({blockNumber:this.perform("getBlockNumber",{}),networkError:this.getNetwork().then(s=>null,s=>s)}).then(({blockNumber:s,networkError:i})=>{if(i)throw this._internalBlockNumber===r&&(this._internalBlockNumber=null),i;const a=uy();return s=st.from(s).toNumber(),s<this._maxInternalBlockNumber&&(s=this._maxInternalBlockNumber),this._maxInternalBlockNumber=s,this._setFastBlockNumber(s),{blockNumber:s,reqTime:t,respTime:a}});return this._internalBlockNumber=r,r.catch(s=>{this._internalBlockNumber===r&&(this._internalBlockNumber=null)}),(yield r).blockNumber})}poll(){return on(this,void 0,void 0,function*(){const e=jge++,t=[];let r=null;try{r=yield this._getInternalBlockNumber(100+this.pollingInterval/2)}catch(s){this.emit("error",s);return}if(this._setFastBlockNumber(r),this.emit("poll",e,r),r===this._lastBlockNumber){this.emit("didPoll",e);return}if(this._emitted.block===-2&&(this._emitted.block=r-1),Math.abs(this._emitted.block-r)>1e3)Pn.warn(`network block skew detected; skipping block events (emitted=${this._emitted.block} blockNumber${r})`),this.emit("error",Pn.makeError("network block skew detected",Le.errors.NETWORK_ERROR,{blockNumber:r,event:"blockSkew",previousBlockNumber:this._emitted.block})),this.emit("block",r);else for(let s=this._emitted.block+1;s<=r;s++)this.emit("block",s);this._emitted.block!==r&&(this._emitted.block=r,Object.keys(this._emitted).forEach(s=>{if(s==="block")return;const i=this._emitted[s];i!=="pending"&&r-i>12&&delete this._emitted[s]})),this._lastBlockNumber===-2&&(this._lastBlockNumber=r-1),this._events.forEach(s=>{switch(s.type){case"tx":{const i=s.hash;let a=this.getTransactionReceipt(i).then(o=>(!o||o.blockNumber==null||(this._emitted["t:"+i]=o.blockNumber,this.emit(i,o)),null)).catch(o=>{this.emit("error",o)});t.push(a);break}case"filter":{if(!s._inflight){s._inflight=!0,s._lastBlockNumber===-2&&(s._lastBlockNumber=r-1);const i=s.filter;i.fromBlock=s._lastBlockNumber+1,i.toBlock=r;const a=i.toBlock-this._maxFilterBlockRange;a>i.fromBlock&&(i.fromBlock=a),i.fromBlock<0&&(i.fromBlock=0);const o=this.getLogs(i).then(l=>{s._inflight=!1,l.length!==0&&l.forEach(c=>{c.blockNumber>s._lastBlockNumber&&(s._lastBlockNumber=c.blockNumber),this._emitted["b:"+c.blockHash]=c.blockNumber,this._emitted["t:"+c.transactionHash]=c.blockNumber,this.emit(i,c)})}).catch(l=>{this.emit("error",l),s._inflight=!1});t.push(o)}break}}}),this._lastBlockNumber=r,Promise.all(t).then(()=>{this.emit("didPoll",e)}).catch(s=>{this.emit("error",s)})})}resetEventsBlock(e){this._lastBlockNumber=e-1,this.polling&&this.poll()}get network(){return this._network}detectNetwork(){return on(this,void 0,void 0,function*(){return Pn.throwError("provider does not support network detection",Le.errors.UNSUPPORTED_OPERATION,{operation:"provider.detectNetwork"})})}getNetwork(){return on(this,void 0,void 0,function*(){const e=yield this._ready(),t=yield this.detectNetwork();if(e.chainId!==t.chainId){if(this.anyNetwork)return this._network=t,this._lastBlockNumber=-2,this._fastBlockNumber=null,this._fastBlockNumberPromise=null,this._fastQueryDate=0,this._emitted.block=-2,this._maxInternalBlockNumber=-1024,this._internalBlockNumber=null,this.emit("network",t,e),yield aF(0),this._network;const r=Pn.makeError("underlying network changed",Le.errors.NETWORK_ERROR,{event:"changed",network:e,detectedNetwork:t});throw this.emit("error",r),r}return e})}get blockNumber(){return this._getInternalBlockNumber(100+this.pollingInterval/2).then(e=>{this._setFastBlockNumber(e)},e=>{}),this._fastBlockNumber!=null?this._fastBlockNumber:-1}get polling(){return this._poller!=null}set polling(e){e&&!this._poller?(this._poller=setInterval(()=>{this.poll()},this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout(()=>{this.poll(),this._bootstrapPoll=setTimeout(()=>{this._poller||this.poll(),this._bootstrapPoll=null},this.pollingInterval)},0))):!e&&this._poller&&(clearInterval(this._poller),this._poller=null)}get pollingInterval(){return this._pollingInterval}set pollingInterval(e){if(typeof e!="number"||e<=0||parseInt(String(e))!=e)throw new Error("invalid polling interval");this._pollingInterval=e,this._poller&&(clearInterval(this._poller),this._poller=setInterval(()=>{this.poll()},this._pollingInterval))}_getFastBlockNumber(){const e=uy();return e-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=e,this._fastBlockNumberPromise=this.getBlockNumber().then(t=>((this._fastBlockNumber==null||t>this._fastBlockNumber)&&(this._fastBlockNumber=t),this._fastBlockNumber))),this._fastBlockNumberPromise}_setFastBlockNumber(e){this._fastBlockNumber!=null&&e<this._fastBlockNumber||(this._fastQueryDate=uy(),(this._fastBlockNumber==null||e>this._fastBlockNumber)&&(this._fastBlockNumber=e,this._fastBlockNumberPromise=Promise.resolve(e)))}waitForTransaction(e,t,r){return on(this,void 0,void 0,function*(){return this._waitForTransaction(e,t??1,r||0,null)})}_waitForTransaction(e,t,r,s){return on(this,void 0,void 0,function*(){const i=yield this.getTransactionReceipt(e);return(i?i.confirmations:0)>=t?i:new Promise((a,o)=>{const l=[];let c=!1;const u=function(){return c?!0:(c=!0,l.forEach(p=>{p()}),!1)},d=p=>{p.confirmations<t||u()||a(p)};if(this.on(e,d),l.push(()=>{this.removeListener(e,d)}),s){let p=s.startBlock,x=null;const y=v=>on(this,void 0,void 0,function*(){c||(yield aF(1e3),this.getTransactionCount(s.from).then(b=>on(this,void 0,void 0,function*(){if(!c){if(b<=s.nonce)p=v;else{{const S=yield this.getTransaction(e);if(S&&S.blockNumber!=null)return}for(x==null&&(x=p-3,x<s.startBlock&&(x=s.startBlock));x<=v;){if(c)return;const S=yield this.getBlockWithTransactions(x);for(let T=0;T<S.transactions.length;T++){const C=S.transactions[T];if(C.hash===e)return;if(C.from===s.from&&C.nonce===s.nonce){if(c)return;const I=yield this.waitForTransaction(C.hash,t);if(u())return;let $="replaced";C.data===s.data&&C.to===s.to&&C.value.eq(s.value)?$="repriced":C.data==="0x"&&C.from===C.to&&C.value.isZero()&&($="cancelled"),o(Pn.makeError("transaction was replaced",Le.errors.TRANSACTION_REPLACED,{cancelled:$==="replaced"||$==="cancelled",reason:$,replacement:this._wrapTransaction(C),hash:e,receipt:I}));return}}x++}}c||this.once("block",y)}}),b=>{c||this.once("block",y)}))});if(c)return;this.once("block",y),l.push(()=>{this.removeListener("block",y)})}if(typeof r=="number"&&r>0){const p=setTimeout(()=>{u()||o(Pn.makeError("timeout exceeded",Le.errors.TIMEOUT,{timeout:r}))},r);p.unref&&p.unref(),l.push(()=>{clearTimeout(p)})}})})}getBlockNumber(){return on(this,void 0,void 0,function*(){return this._getInternalBlockNumber(0)})}getGasPrice(){return on(this,void 0,void 0,function*(){yield this.getNetwork();const e=yield this.perform("getGasPrice",{});try{return st.from(e)}catch(t){return Pn.throwError("bad result from backend",Le.errors.SERVER_ERROR,{method:"getGasPrice",result:e,error:t})}})}getBalance(e,t){return on(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Ls({address:this._getAddress(e),blockTag:this._getBlockTag(t)}),s=yield this.perform("getBalance",r);try{return st.from(s)}catch(i){return Pn.throwError("bad result from backend",Le.errors.SERVER_ERROR,{method:"getBalance",params:r,result:s,error:i})}})}getTransactionCount(e,t){return on(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Ls({address:this._getAddress(e),blockTag:this._getBlockTag(t)}),s=yield this.perform("getTransactionCount",r);try{return st.from(s).toNumber()}catch(i){return Pn.throwError("bad result from backend",Le.errors.SERVER_ERROR,{method:"getTransactionCount",params:r,result:s,error:i})}})}getCode(e,t){return on(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Ls({address:this._getAddress(e),blockTag:this._getBlockTag(t)}),s=yield this.perform("getCode",r);try{return ot(s)}catch(i){return Pn.throwError("bad result from backend",Le.errors.SERVER_ERROR,{method:"getCode",params:r,result:s,error:i})}})}getStorageAt(e,t,r){return on(this,void 0,void 0,function*(){yield this.getNetwork();const s=yield Ls({address:this._getAddress(e),blockTag:this._getBlockTag(r),position:Promise.resolve(t).then(a=>X4(a))}),i=yield this.perform("getStorageAt",s);try{return ot(i)}catch(a){return Pn.throwError("bad result from backend",Le.errors.SERVER_ERROR,{method:"getStorageAt",params:s,result:i,error:a})}})}_wrapTransaction(e,t,r){if(t!=null&&Qp(t)!==32)throw new Error("invalid response - sendTransaction");const s=e;return t!=null&&e.hash!==t&&Pn.throwError("Transaction hash mismatch from Provider.sendTransaction.",Le.errors.UNKNOWN_ERROR,{expectedHash:e.hash,returnedHash:t}),s.wait=(i,a)=>on(this,void 0,void 0,function*(){i==null&&(i=1),a==null&&(a=0);let o;i!==0&&r!=null&&(o={data:e.data,from:e.from,nonce:e.nonce,to:e.to,value:e.value,startBlock:r});const l=yield this._waitForTransaction(e.hash,i,a,o);return l==null&&i===0?null:(this._emitted["t:"+e.hash]=l.blockNumber,l.status===0&&Pn.throwError("transaction failed",Le.errors.CALL_EXCEPTION,{transactionHash:e.hash,transaction:e,receipt:l}),l)}),s}sendTransaction(e){return on(this,void 0,void 0,function*(){yield this.getNetwork();const t=yield Promise.resolve(e).then(i=>ot(i)),r=this.formatter.transaction(e);r.confirmations==null&&(r.confirmations=0);const s=yield this._getInternalBlockNumber(100+2*this.pollingInterval);try{const i=yield this.perform("sendTransaction",{signedTransaction:t});return this._wrapTransaction(r,i,s)}catch(i){throw i.transaction=r,i.transactionHash=r.hash,i}})}_getTransactionRequest(e){return on(this,void 0,void 0,function*(){const t=yield e,r={};return["from","to"].forEach(s=>{t[s]!=null&&(r[s]=Promise.resolve(t[s]).then(i=>i?this._getAddress(i):null))}),["gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","value"].forEach(s=>{t[s]!=null&&(r[s]=Promise.resolve(t[s]).then(i=>i?st.from(i):null))}),["type"].forEach(s=>{t[s]!=null&&(r[s]=Promise.resolve(t[s]).then(i=>i??null))}),t.accessList&&(r.accessList=this.formatter.accessList(t.accessList)),["data"].forEach(s=>{t[s]!=null&&(r[s]=Promise.resolve(t[s]).then(i=>i?ot(i):null))}),this.formatter.transactionRequest(yield Ls(r))})}_getFilter(e){return on(this,void 0,void 0,function*(){e=yield e;const t={};return e.address!=null&&(t.address=this._getAddress(e.address)),["blockHash","topics"].forEach(r=>{e[r]!=null&&(t[r]=e[r])}),["fromBlock","toBlock"].forEach(r=>{e[r]!=null&&(t[r]=this._getBlockTag(e[r]))}),this.formatter.filter(yield Ls(t))})}_call(e,t,r){return on(this,void 0,void 0,function*(){r>=Pge&&Pn.throwError("CCIP read exceeded maximum redirections",Le.errors.SERVER_ERROR,{redirects:r,transaction:e});const s=e.to,i=yield this.perform("call",{transaction:e,blockTag:t});if(r>=0&&t==="latest"&&s!=null&&i.substring(0,10)==="0x556f1830"&&Qp(i)%32===4)try{const a=ui(i,4),o=ui(a,0,32);st.from(o).eq(s)||Pn.throwError("CCIP Read sender did not match",Le.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:i});const l=[],c=st.from(ui(a,32,64)).toNumber(),u=st.from(ui(a,c,c+32)).toNumber(),d=ui(a,c+32);for(let S=0;S<u;S++){const T=Gw(d,S*32);T==null&&Pn.throwError("CCIP Read contained corrupt URL string",Le.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:i}),l.push(T)}const p=m1(a,64);st.from(ui(a,100,128)).isZero()||Pn.throwError("CCIP Read callback selector included junk",Le.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:i});const x=ui(a,96,100),y=m1(a,128),v=yield this.ccipReadFetch(e,p,l);v==null&&Pn.throwError("CCIP Read disabled or provided no URLs",Le.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:i});const b={to:s,data:xo([x,wU([v,y])])};return this._call(b,t,r+1)}catch(a){if(a.code===Le.errors.SERVER_ERROR)throw a}try{return ot(i)}catch(a){return Pn.throwError("bad result from backend",Le.errors.SERVER_ERROR,{method:"call",params:{transaction:e,blockTag:t},result:i,error:a})}})}call(e,t){return on(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Ls({transaction:this._getTransactionRequest(e),blockTag:this._getBlockTag(t),ccipReadEnabled:Promise.resolve(e.ccipReadEnabled)});return this._call(r.transaction,r.blockTag,r.ccipReadEnabled?0:-1)})}estimateGas(e){return on(this,void 0,void 0,function*(){yield this.getNetwork();const t=yield Ls({transaction:this._getTransactionRequest(e)}),r=yield this.perform("estimateGas",t);try{return st.from(r)}catch(s){return Pn.throwError("bad result from backend",Le.errors.SERVER_ERROR,{method:"estimateGas",params:t,result:r,error:s})}})}_getAddress(e){return on(this,void 0,void 0,function*(){e=yield e,typeof e!="string"&&Pn.throwArgumentError("invalid address or ENS name","name",e);const t=yield this.resolveName(e);return t==null&&Pn.throwError("ENS name not configured",Le.errors.UNSUPPORTED_OPERATION,{operation:`resolveName(${JSON.stringify(e)})`}),t})}_getBlock(e,t){return on(this,void 0,void 0,function*(){yield this.getNetwork(),e=yield e;let r=-128;const s={includeTransactions:!!t};if(lr(e,32))s.blockHash=e;else try{s.blockTag=yield this._getBlockTag(e),lr(s.blockTag)&&(r=parseInt(s.blockTag.substring(2),16))}catch{Pn.throwArgumentError("invalid block hash or block tag","blockHashOrBlockTag",e)}return Cy(()=>on(this,void 0,void 0,function*(){const i=yield this.perform("getBlock",s);if(i==null)return s.blockHash!=null&&this._emitted["b:"+s.blockHash]==null||s.blockTag!=null&&r>this._emitted.block?null:void 0;if(t){let a=null;for(let l=0;l<i.transactions.length;l++){const c=i.transactions[l];if(c.blockNumber==null)c.confirmations=0;else if(c.confirmations==null){a==null&&(a=yield this._getInternalBlockNumber(100+2*this.pollingInterval));let u=a-c.blockNumber+1;u<=0&&(u=1),c.confirmations=u}}const o=this.formatter.blockWithTransactions(i);return o.transactions=o.transactions.map(l=>this._wrapTransaction(l)),o}return this.formatter.block(i)}),{oncePoll:this})})}getBlock(e){return this._getBlock(e,!1)}getBlockWithTransactions(e){return this._getBlock(e,!0)}getTransaction(e){return on(this,void 0,void 0,function*(){yield this.getNetwork(),e=yield e;const t={transactionHash:this.formatter.hash(e,!0)};return Cy(()=>on(this,void 0,void 0,function*(){const r=yield this.perform("getTransaction",t);if(r==null)return this._emitted["t:"+e]==null?null:void 0;const s=this.formatter.transactionResponse(r);if(s.blockNumber==null)s.confirmations=0;else if(s.confirmations==null){let a=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-s.blockNumber+1;a<=0&&(a=1),s.confirmations=a}return this._wrapTransaction(s)}),{oncePoll:this})})}getTransactionReceipt(e){return on(this,void 0,void 0,function*(){yield this.getNetwork(),e=yield e;const t={transactionHash:this.formatter.hash(e,!0)};return Cy(()=>on(this,void 0,void 0,function*(){const r=yield this.perform("getTransactionReceipt",t);if(r==null)return this._emitted["t:"+e]==null?null:void 0;if(r.blockHash==null)return;const s=this.formatter.receipt(r);if(s.blockNumber==null)s.confirmations=0;else if(s.confirmations==null){let a=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-s.blockNumber+1;a<=0&&(a=1),s.confirmations=a}return s}),{oncePoll:this})})}getLogs(e){return on(this,void 0,void 0,function*(){yield this.getNetwork();const t=yield Ls({filter:this._getFilter(e)}),r=yield this.perform("getLogs",t);return r.forEach(s=>{s.removed==null&&(s.removed=!1)}),Ct.arrayOf(this.formatter.filterLog.bind(this.formatter))(r)})}getEtherPrice(){return on(this,void 0,void 0,function*(){return yield this.getNetwork(),this.perform("getEtherPrice",{})})}_getBlockTag(e){return on(this,void 0,void 0,function*(){if(e=yield e,typeof e=="number"&&e<0){e%1&&Pn.throwArgumentError("invalid BlockTag","blockTag",e);let t=yield this._getInternalBlockNumber(100+2*this.pollingInterval);return t+=e,t<0&&(t=0),this.formatter.blockTag(t)}return this.formatter.blockTag(e)})}getResolver(e){return on(this,void 0,void 0,function*(){let t=e;for(;;){if(t===""||t==="."||e!=="eth"&&t==="eth")return null;const r=yield this._getResolver(t,"getResolver");if(r!=null){const s=new uF(this,r,e);return t!==e&&!(yield s.supportsWildcard())?null:s}t=t.split(".").slice(1).join(".")}})}_getResolver(e,t){return on(this,void 0,void 0,function*(){t==null&&(t="ENS");const r=yield this.getNetwork();r.ensAddress||Pn.throwError("network does not support ENS",Le.errors.UNSUPPORTED_OPERATION,{operation:t,network:r.name});try{const s=yield this.call({to:r.ensAddress,data:"0x0178b8bf"+Bw(e).substring(2)});return this.formatter.callAddress(s)}catch{}return null})}resolveName(e){return on(this,void 0,void 0,function*(){e=yield e;try{return Promise.resolve(this.formatter.address(e))}catch(r){if(lr(e))throw r}typeof e!="string"&&Pn.throwArgumentError("invalid ENS name","name",e);const t=yield this.getResolver(e);return t?yield t.getAddress():null})}lookupAddress(e){return on(this,void 0,void 0,function*(){e=yield e,e=this.formatter.address(e);const t=e.substring(2).toLowerCase()+".addr.reverse",r=yield this._getResolver(t,"lookupAddress");if(r==null)return null;const s=Gw(yield this.call({to:r,data:"0x691f3431"+Bw(t).substring(2)}),0);return(yield this.resolveName(s))!=e?null:s})}getAvatar(e){return on(this,void 0,void 0,function*(){let t=null;if(lr(e)){const i=this.formatter.address(e).substring(2).toLowerCase()+".addr.reverse",a=yield this._getResolver(i,"getAvatar");if(!a)return null;t=new uF(this,a,i);try{const o=yield t.getAvatar();if(o)return o.url}catch(o){if(o.code!==Le.errors.CALL_EXCEPTION)throw o}try{const o=Gw(yield this.call({to:a,data:"0x691f3431"+Bw(i).substring(2)}),0);t=yield this.getResolver(o)}catch(o){if(o.code!==Le.errors.CALL_EXCEPTION)throw o;return null}}else if(t=yield this.getResolver(e),!t)return null;const r=yield t.getAvatar();return r==null?null:r.url})}perform(e,t){return Pn.throwError(e+" not implemented",Le.errors.NOT_IMPLEMENTED,{operation:e})}_startEvent(e){this.polling=this._events.filter(t=>t.pollable()).length>0}_stopEvent(e){this.polling=this._events.filter(t=>t.pollable()).length>0}_addEventListener(e,t,r){const s=new Fge(C0(e),t,r);return this._events.push(s),this._startEvent(s),this}on(e,t){return this._addEventListener(e,t,!1)}once(e,t){return this._addEventListener(e,t,!0)}emit(e,...t){let r=!1,s=[],i=C0(e);return this._events=this._events.filter(a=>a.tag!==i?!0:(setTimeout(()=>{a.listener.apply(this,t)},0),r=!0,a.once?(s.push(a),!1):!0)),s.forEach(a=>{this._stopEvent(a)}),r}listenerCount(e){if(!e)return this._events.length;let t=C0(e);return this._events.filter(r=>r.tag===t).length}listeners(e){if(e==null)return this._events.map(r=>r.listener);let t=C0(e);return this._events.filter(r=>r.tag===t).map(r=>r.listener)}off(e,t){if(t==null)return this.removeAllListeners(e);const r=[];let s=!1,i=C0(e);return this._events=this._events.filter(a=>a.tag!==i||a.listener!=t||s?!0:(s=!0,r.push(a),!1)),r.forEach(a=>{this._stopEvent(a)}),this}removeAllListeners(e){let t=[];if(e==null)t=this._events,this._events=[];else{const r=C0(e);this._events=this._events.filter(s=>s.tag!==r?!0:(t.push(s),!1))}return t.forEach(r=>{this._stopEvent(r)}),this}}var sh=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const qs=new Le(FS),Uge=["call","estimateGas"];function Hy(n,e){if(n==null)return null;if(typeof n.message=="string"&&n.message.match("reverted")){const t=lr(n.data)?n.data:null;if(!e||t)return{message:n.message,data:t}}if(typeof n=="object"){for(const t in n){const r=Hy(n[t],e);if(r)return r}return null}if(typeof n=="string")try{return Hy(JSON.parse(n),e)}catch{}return null}function EU(n,e,t){const r=t.transaction||t.signedTransaction;if(n==="call"){const i=Hy(e,!0);if(i)return i.data;qs.throwError("missing revert data in call exception; Transaction reverted without a reason string",Le.errors.CALL_EXCEPTION,{data:"0x",transaction:r,error:e})}if(n==="estimateGas"){let i=Hy(e.body,!1);i==null&&(i=Hy(e,!1)),i&&qs.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Le.errors.UNPREDICTABLE_GAS_LIMIT,{reason:i.message,method:n,transaction:r,error:e})}let s=e.message;throw e.code===Le.errors.SERVER_ERROR&&e.error&&typeof e.error.message=="string"?s=e.error.message:typeof e.body=="string"?s=e.body:typeof e.responseText=="string"&&(s=e.responseText),s=(s||"").toLowerCase(),s.match(/insufficient funds|base fee exceeds gas limit|InsufficientFunds/i)&&qs.throwError("insufficient funds for intrinsic transaction cost",Le.errors.INSUFFICIENT_FUNDS,{error:e,method:n,transaction:r}),s.match(/nonce (is )?too low/i)&&qs.throwError("nonce has already been used",Le.errors.NONCE_EXPIRED,{error:e,method:n,transaction:r}),s.match(/replacement transaction underpriced|transaction gas price.*too low/i)&&qs.throwError("replacement fee too low",Le.errors.REPLACEMENT_UNDERPRICED,{error:e,method:n,transaction:r}),s.match(/only replay-protected/i)&&qs.throwError("legacy pre-eip-155 transactions not supported",Le.errors.UNSUPPORTED_OPERATION,{error:e,method:n,transaction:r}),Uge.indexOf(n)>=0&&s.match(/gas required exceeds allowance|always failing transaction|execution reverted|revert/)&&qs.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Le.errors.UNPREDICTABLE_GAS_LIMIT,{error:e,method:n,transaction:r}),e}function hF(n){return new Promise(function(e){setTimeout(e,n)})}function Gge(n){if(n.error){const e=new Error(n.error.message);throw e.code=n.error.code,e.data=n.error.data,e}return n.result}function hy(n){return n&&n.toLowerCase()}const SI={};class SU extends Wg{constructor(e,t,r){if(super(),e!==SI)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");Ke(this,"provider",t),r==null&&(r=0),typeof r=="string"?(Ke(this,"_address",this.provider.formatter.address(r)),Ke(this,"_index",null)):typeof r=="number"?(Ke(this,"_index",r),Ke(this,"_address",null)):qs.throwArgumentError("invalid address or index","addressOrIndex",r)}connect(e){return qs.throwError("cannot alter JSON-RPC Signer connection",Le.errors.UNSUPPORTED_OPERATION,{operation:"connect"})}connectUnchecked(){return new Hge(SI,this.provider,this._address||this._index)}getAddress(){return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then(e=>(e.length<=this._index&&qs.throwError("unknown account #"+this._index,Le.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),this.provider.formatter.address(e[this._index])))}sendUncheckedTransaction(e){e=pi(e);const t=this.getAddress().then(r=>(r&&(r=r.toLowerCase()),r));if(e.gasLimit==null){const r=pi(e);r.from=t,e.gasLimit=this.provider.estimateGas(r)}return e.to!=null&&(e.to=Promise.resolve(e.to).then(r=>sh(this,void 0,void 0,function*(){if(r==null)return null;const s=yield this.provider.resolveName(r);return s==null&&qs.throwArgumentError("provided ENS name resolves to null","tx.to",r),s}))),Ls({tx:Ls(e),sender:t}).then(({tx:r,sender:s})=>{r.from!=null?r.from.toLowerCase()!==s&&qs.throwArgumentError("from address mismatch","transaction",e):r.from=s;const i=this.provider.constructor.hexlifyTransaction(r,{from:!0});return this.provider.send("eth_sendTransaction",[i]).then(a=>a,a=>(typeof a.message=="string"&&a.message.match(/user denied/i)&&qs.throwError("user rejected transaction",Le.errors.ACTION_REJECTED,{action:"sendTransaction",transaction:r}),EU("sendTransaction",a,i)))})}signTransaction(e){return qs.throwError("signing transactions is unsupported",Le.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})}sendTransaction(e){return sh(this,void 0,void 0,function*(){const t=yield this.provider._getInternalBlockNumber(100+2*this.provider.pollingInterval),r=yield this.sendUncheckedTransaction(e);try{return yield Cy(()=>sh(this,void 0,void 0,function*(){const s=yield this.provider.getTransaction(r);if(s!==null)return this.provider._wrapTransaction(s,r,t)}),{oncePoll:this.provider})}catch(s){throw s.transactionHash=r,s}})}signMessage(e){return sh(this,void 0,void 0,function*(){const t=typeof e=="string"?Pi(e):e,r=yield this.getAddress();try{return yield this.provider.send("personal_sign",[ot(t),r.toLowerCase()])}catch(s){throw typeof s.message=="string"&&s.message.match(/user denied/i)&&qs.throwError("user rejected signing",Le.errors.ACTION_REJECTED,{action:"signMessage",from:r,messageData:e}),s}})}_legacySignMessage(e){return sh(this,void 0,void 0,function*(){const t=typeof e=="string"?Pi(e):e,r=yield this.getAddress();try{return yield this.provider.send("eth_sign",[r.toLowerCase(),ot(t)])}catch(s){throw typeof s.message=="string"&&s.message.match(/user denied/i)&&qs.throwError("user rejected signing",Le.errors.ACTION_REJECTED,{action:"_legacySignMessage",from:r,messageData:e}),s}})}_signTypedData(e,t,r){return sh(this,void 0,void 0,function*(){const s=yield Xa.resolveNames(e,t,r,a=>this.provider.resolveName(a)),i=yield this.getAddress();try{return yield this.provider.send("eth_signTypedData_v4",[i.toLowerCase(),JSON.stringify(Xa.getPayload(s.domain,t,s.value))])}catch(a){throw typeof a.message=="string"&&a.message.match(/user denied/i)&&qs.throwError("user rejected signing",Le.errors.ACTION_REJECTED,{action:"_signTypedData",from:i,messageData:{domain:s.domain,types:t,value:s.value}}),a}})}unlock(e){return sh(this,void 0,void 0,function*(){const t=this.provider,r=yield this.getAddress();return t.send("personal_unlockAccount",[r.toLowerCase(),e,null])})}}class Hge extends SU{sendTransaction(e){return this.sendUncheckedTransaction(e).then(t=>({hash:t,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:r=>this.provider.waitForTransaction(t,r)}))}}const Wge={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,type:!0,accessList:!0,maxFeePerGas:!0,maxPriorityFeePerGas:!0};class qge extends Vge{constructor(e,t){let r=t;r==null&&(r=new Promise((s,i)=>{setTimeout(()=>{this.detectNetwork().then(a=>{s(a)},a=>{i(a)})},0)})),super(r),e||(e=Qc(this.constructor,"defaultUrl")()),typeof e=="string"?Ke(this,"connection",Object.freeze({url:e})):Ke(this,"connection",Object.freeze(pi(e))),this._nextId=42}get _cache(){return this._eventLoopCache==null&&(this._eventLoopCache={}),this._eventLoopCache}static defaultUrl(){return"http://localhost:8545"}detectNetwork(){return this._cache.detectNetwork||(this._cache.detectNetwork=this._uncachedDetectNetwork(),setTimeout(()=>{this._cache.detectNetwork=null},0)),this._cache.detectNetwork}_uncachedDetectNetwork(){return sh(this,void 0,void 0,function*(){yield hF(0);let e=null;try{e=yield this.send("eth_chainId",[])}catch{try{e=yield this.send("net_version",[])}catch{}}if(e!=null){const t=Qc(this.constructor,"getNetwork");try{return t(st.from(e).toNumber())}catch(r){return qs.throwError("could not detect network",Le.errors.NETWORK_ERROR,{chainId:e,event:"invalidNetwork",serverError:r})}}return qs.throwError("could not detect network",Le.errors.NETWORK_ERROR,{event:"noNetwork"})})}getSigner(e){return new SU(SI,this,e)}getUncheckedSigner(e){return this.getSigner(e).connectUnchecked()}listAccounts(){return this.send("eth_accounts",[]).then(e=>e.map(t=>this.formatter.address(t)))}send(e,t){const r={method:e,params:t,id:this._nextId++,jsonrpc:"2.0"};this.emit("debug",{action:"request",request:Ah(r),provider:this});const s=["eth_chainId","eth_blockNumber"].indexOf(e)>=0;if(s&&this._cache[e])return this._cache[e];const i=uR(this.connection,JSON.stringify(r),Gge).then(a=>(this.emit("debug",{action:"response",request:r,response:a,provider:this}),a),a=>{throw this.emit("debug",{action:"response",error:a,request:r,provider:this}),a});return s&&(this._cache[e]=i,setTimeout(()=>{this._cache[e]=null},0)),i}prepareRequest(e,t){switch(e){case"getBlockNumber":return["eth_blockNumber",[]];case"getGasPrice":return["eth_gasPrice",[]];case"getBalance":return["eth_getBalance",[hy(t.address),t.blockTag]];case"getTransactionCount":return["eth_getTransactionCount",[hy(t.address),t.blockTag]];case"getCode":return["eth_getCode",[hy(t.address),t.blockTag]];case"getStorageAt":return["eth_getStorageAt",[hy(t.address),Gr(t.position,32),t.blockTag]];case"sendTransaction":return["eth_sendRawTransaction",[t.signedTransaction]];case"getBlock":return t.blockTag?["eth_getBlockByNumber",[t.blockTag,!!t.includeTransactions]]:t.blockHash?["eth_getBlockByHash",[t.blockHash,!!t.includeTransactions]]:null;case"getTransaction":return["eth_getTransactionByHash",[t.transactionHash]];case"getTransactionReceipt":return["eth_getTransactionReceipt",[t.transactionHash]];case"call":return["eth_call",[Qc(this.constructor,"hexlifyTransaction")(t.transaction,{from:!0}),t.blockTag]];case"estimateGas":return["eth_estimateGas",[Qc(this.constructor,"hexlifyTransaction")(t.transaction,{from:!0})]];case"getLogs":return t.filter&&t.filter.address!=null&&(t.filter.address=hy(t.filter.address)),["eth_getLogs",[t.filter]]}return null}perform(e,t){return sh(this,void 0,void 0,function*(){if(e==="call"||e==="estimateGas"){const s=t.transaction;if(s&&s.type!=null&&st.from(s.type).isZero()&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=yield this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=pi(t),t.transaction=pi(s),delete t.transaction.type)}}const r=this.prepareRequest(e,t);r==null&&qs.throwError(e+" not implemented",Le.errors.NOT_IMPLEMENTED,{operation:e});try{return yield this.send(r[0],r[1])}catch(s){return EU(e,s,t)}})}_startEvent(e){e.tag==="pending"&&this._startPending(),super._startEvent(e)}_startPending(){if(this._pendingFilter!=null)return;const e=this,t=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=t,t.then(function(r){function s(){e.send("eth_getFilterChanges",[r]).then(function(i){if(e._pendingFilter!=t)return null;let a=Promise.resolve();return i.forEach(function(o){e._emitted["t:"+o.toLowerCase()]="pending",a=a.then(function(){return e.getTransaction(o).then(function(l){return e.emit("pending",l),null})})}),a.then(function(){return hF(1e3)})}).then(function(){if(e._pendingFilter!=t){e.send("eth_uninstallFilter",[r]);return}return setTimeout(function(){s()},0),null}).catch(i=>{})}return s(),r}).catch(r=>{})}_stopEvent(e){e.tag==="pending"&&this.listenerCount("pending")===0&&(this._pendingFilter=null),super._stopEvent(e)}static hexlifyTransaction(e,t){const r=pi(Wge);if(t)for(const i in t)t[i]&&(r[i]=!0);SV(e,r);const s={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(function(i){if(e[i]==null)return;const a=X4(st.from(e[i]));i==="gasLimit"&&(i="gas"),s[i]=a}),["from","to","data"].forEach(function(i){e[i]!=null&&(s[i]=ot(e[i]))}),e.accessList&&(s.accessList=Kg(e.accessList)),s}}const dF=new Le(FS);let Kge=1;function fF(n,e){const t="Web3LegacyFetcher";return function(r,s){const i={method:r,params:s,id:Kge++,jsonrpc:"2.0"};return new Promise((a,o)=>{this.emit("debug",{action:"request",fetcher:t,request:Ah(i),provider:this}),e(i,(l,c)=>{if(l)return this.emit("debug",{action:"response",fetcher:t,error:l,request:i,provider:this}),o(l);if(this.emit("debug",{action:"response",fetcher:t,request:i,response:c,provider:this}),c.error){const u=new Error(c.error.message);return u.code=c.error.code,u.data=c.error.data,o(u)}a(c.result)})})}}function Xge(n){return function(e,t){t==null&&(t=[]);const r={method:e,params:t};return this.emit("debug",{action:"request",fetcher:"Eip1193Fetcher",request:Ah(r),provider:this}),n.request(r).then(s=>(this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:r,response:s,provider:this}),s),s=>{throw this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:r,error:s,provider:this}),s})}}class Yge extends qge{constructor(e,t){e==null&&dF.throwArgumentError("missing provider","provider",e);let r=null,s=null,i=null;typeof e=="function"?(r="unknown:",s=e):(r=e.host||e.path||"",!r&&e.isMetaMask&&(r="metamask"),i=e,e.request?(r===""&&(r="eip-1193:"),s=Xge(e)):e.sendAsync?s=fF(e,e.sendAsync.bind(e)):e.send?s=fF(e,e.send.bind(e)):dF.throwArgumentError("unsupported provider","provider",e),r||(r="unknown:")),super(r,t),Ke(this,"jsonRpcFetchFunc",s),Ke(this,"provider",i)}send(e,t){return this.jsonRpcFetchFunc(e,t)}}function Zge(n,e){return Mw(n,e)}const Qge=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"farmer",type:"address"},{indexed:!1,internalType:"uint256",name:"projectId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"CreditsGenerated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"holder",type:"address"},{indexed:!1,internalType:"uint256",name:"projectId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"CreditsRetired",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"holder",type:"address"},{indexed:!1,internalType:"bool",name:"suspended",type:"bool"}],name:"CreditsSuspended",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"projectId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"CreditsTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"projectId",type:"uint256"}],name:"ProjectAdded",type:"event"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"accounts",outputs:[{internalType:"uint256",name:"totalBalance",type:"uint256"},{internalType:"bool",name:"suspended",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"projectId",type:"uint256"}],name:"addProject",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"admin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"farmer",type:"address"},{internalType:"uint256",name:"projectId",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"generateCredits",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"holder",type:"address"},{internalType:"uint256",name:"projectId",type:"uint256"}],name:"getCreditsByProject",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"projectId",type:"uint256"}],name:"getProjectCredits",outputs:[{internalType:"uint256",name:"issued",type:"uint256"},{internalType:"uint256",name:"retired",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"holder",type:"address"}],name:"getTotalCredits",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"projectId",type:"uint256"}],name:"isProjectValid",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"holder",type:"address"}],name:"isSuspended",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"projects",outputs:[{internalType:"uint256",name:"totalIssued",type:"uint256"},{internalType:"uint256",name:"totalRetired",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"projectId",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"retireCredits",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"holder",type:"address"},{internalType:"bool",name:"suspend",type:"bool"}],name:"suspendCredits",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"projectId",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferCredits",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"userProjectBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"validProjects",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],Jge={abi:Qge},exe="0xA00431C46fb43396bB32FCc74e6221aB36ddBc07";window.ethereum||alert("MetaMask not found!");const pF=new Yge(window.ethereum);async function txe(){return await pF.send("eth_requestAccounts",[]),pF.getSigner()}async function TU(){const n=await txe();return new G0e(exe,Jge.abi,n)}function nxe(){const[n,e]=Se.useState({}),[t,r]=Se.useState([]),[s,i]=Se.useState(null),[a,o]=Se.useState({carbonSequestered:"",biomassGrowth:"",areaMonitored:"",monitoringDate:"",methodology:"",verificationStatus:"pending",notes:""});Se.useEffect(()=>{(async()=>{try{const v=hf.currentUser;if(!v)return;const b=uf(Xi,"projects"),S=V0(b,U0("userId","==",v.uid)),C=(await lh(S)).docs.map(q=>({id:q.id,...q.data()}));r(C);const I=await TU(),$={};for(let q of C)if(!(!q.numericId||!q.farmerWalletAddress))try{const U=await I.getCreditsByProject(q.farmerWalletAddress,q.numericId);$[q.id]=Number(Zge(U,0))}catch(U){console.error(`Failed to fetch on-chain credits for project ${q.projectName}:`,U)}e($)}catch(v){console.error("Error fetching projects:",v)}})()},[]);const l=y=>{const{name:v,value:b}=y.target;o(S=>({...S,[v]:b}))},c=y=>{if(y.preventDefault(),!s){alert("Please select a project first");return}const v=JSON.parse(localStorage.getItem("mrvReports")||"[]"),b={...a,id:Date.now(),projectId:s.id,projectName:s.projectName,submittedAt:new Date().toISOString()};v.push(b),localStorage.setItem("mrvReports",JSON.stringify(v)),alert("MRV Report submitted successfully!"),o({carbonSequestered:"",biomassGrowth:"",areaMonitored:"",monitoringDate:"",methodology:"",verificationStatus:"pending",notes:""}),i(null)},u=()=>JSON.parse(localStorage.getItem("mrvReports")||"[]"),d=()=>t.reduce((y,v)=>{v.creditsGenerated;const b=n[v.id]||0;return y+b},0),p=()=>{const y={};return t.forEach(v=>{const b=v.creditsGenerated||0,S=n[v.id]||0;b+S>0&&(y[v.projectName]=S)}),y},x=()=>{const y=u();return t.map(v=>{const b=y.filter(T=>T.projectId===v.id),S=b[b.length-1];return{...v,totalCredits:v.creditsGenerated||0,reportsCount:b.length,lastReportDate:S?S.submittedAt:null,verificationStatus:S?S.verificationStatus:v.status||"no-reports"}})};return _.jsxs("div",{className:"page-container",children:[_.jsxs("div",{className:"page-header",children:[_.jsx("h1",{className:"page-title",children:"📊 MRV Dashboard"}),_.jsx("p",{className:"page-subtitle",children:"Monitor, Report, and Verify your blue carbon projects"})]}),_.jsxs("div",{className:"mrv-content",children:[_.jsx("div",{className:"dashboard-overview",children:_.jsxs("div",{className:"mrv-section carbon-credits-section",children:[_.jsx("h3",{children:"💰 Generated Carbon Credits"}),_.jsxs("div",{className:"credits-summary",children:[_.jsxs("div",{className:"total-credits",children:[_.jsx("h4",{children:"Total Credits Generated"}),_.jsxs("span",{className:"credits-number",children:[d().toFixed(2)," tCO2"]})]}),_.jsxs("div",{className:"credits-by-project",children:[_.jsx("h4",{children:"Credits by Project"}),Object.entries(p()).map(([y,v])=>_.jsxs("div",{className:"project-credits",children:[_.jsx("span",{className:"project-name",children:y}),_.jsxs("span",{className:"credits-amount",children:[v.toFixed(3)," tCO2"]})]},y)),Object.keys(p()).length===0&&_.jsx("p",{className:"no-credits",children:"No carbon credits generated yet. Submit MRV reports to track credits."})]})]})]})}),_.jsxs("div",{className:"mrv-section projects-status-section",children:[_.jsx("h3",{children:"🌱 My Projects Status"}),_.jsxs("div",{className:"projects-status-grid",children:[x().map(y=>_.jsxs("div",{className:"project-status-card",children:[_.jsxs("div",{className:"project-header",children:[_.jsx("h4",{children:y.projectName}),_.jsx("span",{className:`status-badge ${y.verificationStatus}`,children:y.verificationStatus==="no-reports"?"No Reports":y.verificationStatus})]}),_.jsxs("div",{className:"project-stats",children:[_.jsxs("div",{className:"stat",children:[_.jsx("span",{className:"stat-label",children:"Total Credits"}),_.jsxs("span",{className:"stat-value",children:[y.totalCredits.toFixed(2)," tCO2"]})]}),_.jsxs("div",{className:"stat",children:[_.jsx("span",{className:"stat-label",children:"Reports Submitted"}),_.jsx("span",{className:"stat-value",children:y.reportsCount})]}),_.jsxs("div",{className:"stat",children:[_.jsx("span",{className:"stat-label",children:"Last Report"}),_.jsx("span",{className:"stat-value",children:y.lastReportDate?new Date(y.lastReportDate).toLocaleDateString():"Never"})]}),_.jsxs("div",{className:"stat",children:[_.jsx("span",{className:"stat-label",children:"Project Area"}),_.jsxs("span",{className:"stat-value",children:[y.area," hectares"]})]}),y.creditsGenerated>0&&_.jsxs("div",{className:"stat",children:[_.jsx("span",{className:"stat-label",children:"Blockchain Tx Hash"}),_.jsx("span",{className:"stat-value tx-id",children:y.blockchainTx?_.jsx("a",{href:`https://sepolia.etherscan.io/tx/${y.blockchainTx}`,target:"_blank",rel:"noopener noreferrer",className:"tx-link",children:y.blockchainTx}):"N/A"})]})]})]},y.id)),t.length===0&&_.jsx("div",{className:"no-projects-status",children:_.jsxs("p",{children:["No projects found. ",_.jsx(Dt,{to:"/add-project",children:"Add your first project"})]})})]})]}),_.jsxs("div",{className:"mrv-section",children:[_.jsx("h3",{children:"Select Project for Monitoring"}),_.jsx("div",{className:"project-grid",children:t.length>0?t.map(y=>_.jsxs("div",{className:`project-card ${s?.id===y.id?"selected":""}`,onClick:()=>i(y),children:[_.jsx("h4",{children:y.projectName}),_.jsxs("p",{children:[_.jsx("strong",{children:"Type:"})," ",y.projectType]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Location:"})," ",y.location]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Area:"})," ",y.area," hectares"]}),_.jsx("span",{className:`status-badge ${y.status}`,children:y.status})]},y.id)):_.jsx("div",{className:"no-projects",children:_.jsxs("p",{children:["No projects found. ",_.jsx(Dt,{to:"/add-project",children:"Add your first project"})]})})})]}),s&&_.jsxs("div",{className:"mrv-section",children:[_.jsxs("h3",{children:["Submit MRV Report for: ",s.projectName]}),_.jsxs("form",{className:"mrv-form",onSubmit:c,children:[_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"carbonSequestered",children:"Carbon Sequestered (tCO2) *"}),_.jsx("input",{type:"number",id:"carbonSequestered",name:"carbonSequestered",value:a.carbonSequestered,onChange:l,required:!0,placeholder:"Enter carbon sequestered"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"biomassGrowth",children:"Biomass Growth (%) *"}),_.jsx("input",{type:"number",id:"biomassGrowth",name:"biomassGrowth",value:a.biomassGrowth,onChange:l,required:!0,placeholder:"Enter biomass growth percentage"})]})]}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"areaMonitored",children:"Area Monitored (hectares) *"}),_.jsx("input",{type:"number",id:"areaMonitored",name:"areaMonitored",value:a.areaMonitored,onChange:l,required:!0,placeholder:"Enter monitored area"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"monitoringDate",children:"Monitoring Date *"}),_.jsx("input",{type:"date",id:"monitoringDate",name:"monitoringDate",value:a.monitoringDate,onChange:l,required:!0})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"methodology",children:"Verification Methodology *"}),_.jsxs("select",{id:"methodology",name:"methodology",value:a.methodology,onChange:l,required:!0,children:[_.jsx("option",{value:"",children:"Select methodology"}),_.jsx("option",{value:"remote-sensing",children:"Remote Sensing"}),_.jsx("option",{value:"field-sampling",children:"Field Sampling"}),_.jsx("option",{value:"drone-survey",children:"Drone Survey"}),_.jsx("option",{value:"satellite-imagery",children:"Satellite Imagery"}),_.jsx("option",{value:"combined",children:"Combined Methods"})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"notes",children:"Additional Notes"}),_.jsx("textarea",{id:"notes",name:"notes",value:a.notes,onChange:l,placeholder:"Add any additional observations or notes...",rows:"3"})]}),_.jsx("button",{type:"submit",className:"btn-primary",children:"Submit MRV Report"})]})]}),_.jsxs("div",{className:"mrv-section",children:[_.jsx("h3",{children:"Recent MRV Reports"}),_.jsxs("div",{className:"reports-list",children:[u().slice(-5).map(y=>_.jsxs("div",{className:"report-item",children:[_.jsxs("div",{className:"report-header",children:[_.jsx("h4",{children:y.projectName}),_.jsx("span",{className:`status-badge ${y.verificationStatus}`,children:y.verificationStatus})]}),_.jsxs("div",{className:"report-details",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Carbon Sequestered:"})," ",y.carbonSequestered," tCO2"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Monitoring Date:"})," ",new Date(y.monitoringDate).toLocaleDateString()]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Methodology:"})," ",y.methodology]})]})]},y.id)),u().length===0&&_.jsx("p",{className:"no-reports",children:"No MRV reports submitted yet."})]})]})]})]})}function rxe(){const[n,e]=Se.useState([]),[t,r]=Se.useState([]),[s,i]=Se.useState([]),[a,o]=Se.useState("");Se.useEffect(()=>{const y=s4(hf,async v=>{if(v)try{const b=uf(Xi,"projects"),S=V0(b,U0("userId","==",v.uid)),C=(await lh(S)).docs.map(I=>({id:I.id,...I.data()}));setProjects(C)}catch(b){console.error("Error fetching projects:",b)}else setProjects([])});return()=>y()},[]),Se.useEffect(()=>{l();const y=JSON.parse(localStorage.getItem("purchaseHistory")||"[]");r(y)},[]);const l=()=>{const y=JSON.parse(localStorage.getItem("mrvReports")||"[]"),v=JSON.parse(localStorage.getItem("userProjects")||"[]"),b={};y.forEach(T=>{if(T.verificationStatus==="verified"){if(!b[T.projectId]){const C=v.find(I=>I.id===T.projectId);b[T.projectId]={projectId:T.projectId,projectName:T.projectName,projectType:C?.projectType||"Unknown",location:C?.location||"Unknown",totalCredits:0,availableCredits:0,pricePerCredit:58,reports:[]}}b[T.projectId].totalCredits+=parseFloat(T.carbonSequestered||0),b[T.projectId].availableCredits+=parseFloat(T.carbonSequestered||0),b[T.projectId].reports.push(T)}}),JSON.parse(localStorage.getItem("purchaseHistory")||"[]").forEach(T=>{b[T.projectId]&&(b[T.projectId].availableCredits-=T.amount)}),e(Object.values(b).filter(T=>T.availableCredits>0))},c=(y,v)=>{const b=n.find(C=>C.projectId===y);if(!b||v>b.availableCredits){alert("Insufficient credits available for purchase");return}const S={id:Date.now(),projectId:y,projectName:b.projectName,amount:parseFloat(v),pricePerCredit:b.pricePerCredit,totalCost:parseFloat(v)*b.pricePerCredit,purchaseDate:new Date().toISOString(),status:"completed"},T=JSON.parse(localStorage.getItem("purchaseHistory")||"[]");T.push(S),localStorage.setItem("purchaseHistory",JSON.stringify(T)),r(T),l(),alert(`Successfully purchased ${v} tCO2 credits for  ₹${S.totalCost.toFixed(2)}`)},u=()=>t.reduce((y,v)=>y+v.amount,0),d=()=>t.reduce((y,v)=>y+v.totalCost,0),p=()=>[{month:"Jan",price:45},{month:"Feb",price:48},{month:"Mar",price:52},{month:"Apr",price:49},{month:"May",price:55},{month:"Jun",price:58}],x=()=>{const y=n.reduce((b,S)=>b+S.availableCredits,0),v=n.length>0?n.reduce((b,S)=>b+S.pricePerCredit,0)/n.length:58;return{totalAvailableCredits:y,averagePrice:v,totalProjects:n.length,marketValue:y*v}};return _.jsxs("div",{className:"page-container",children:[_.jsxs("div",{className:"page-header",children:[_.jsx("h1",{className:"page-title",children:"🛒 Carbon Credit Holdings"}),_.jsx("p",{className:"page-subtitle",children:"Manage your verified carbon credits from blue carbon projects"})]}),_.jsxs("div",{className:"mrv-content",children:[_.jsxs("div",{className:"dashboard-overview",children:[_.jsxs("div",{className:"mrv-section carbon-credits-section",children:[_.jsx("h3",{children:"💰 My Carbon Credit Portfolio"}),_.jsxs("div",{className:"credits-summary",children:[_.jsxs("div",{className:"total-credits",children:[_.jsx("h4",{children:"Total Credits Purchased"}),_.jsxs("span",{className:"credits-number",children:[u().toFixed(2)," tCO2"]})]}),_.jsxs("div",{className:"credits-by-project",children:[_.jsx("h4",{children:"Total Investment"}),_.jsxs("div",{className:"investment-summary",children:[_.jsxs("span",{className:"investment-amount",children:["$",d().toFixed(2)]}),_.jsx("span",{className:"investment-label",children:"Total Spent"})]}),_.jsxs("div",{className:"recent-purchases",children:[_.jsx("h5",{children:"Recent Purchases"}),t.slice(-3).map(y=>_.jsxs("div",{className:"project-credits",children:[_.jsx("span",{className:"project-name",children:y.projectName}),_.jsxs("span",{className:"credits-amount",children:[y.amount.toFixed(2)," tCO2"]})]},y.id)),t.length===0&&_.jsx("p",{className:"no-credits",children:"No purchases yet. Browse available credits below."})]})]})]})]}),_.jsxs("div",{className:"mrv-section price-graph-section",children:[_.jsx("h3",{children:"📈 Carbon Credit Price Trends"}),_.jsxs("div",{className:"price-graph",children:[_.jsxs("div",{className:"current-price",children:[_.jsx("span",{className:"price-label",children:"Current Price"}),_.jsx("span",{className:"price-value",children:"₹58.00 per tCO2"}),_.jsx("span",{className:"price-change positive",children:"+5.5% ↗"})]}),_.jsx("div",{className:"price-chart",children:p().map((y,v)=>_.jsxs("div",{className:"price-bar",children:[_.jsx("div",{className:"bar",style:{height:`${y.price/60*100}%`}}),_.jsx("span",{className:"month-label",children:y.month}),_.jsxs("span",{className:"price-label",children:["₹",y.price]})]},y.month))})]})]})]}),_.jsxs("div",{className:"mrv-section projects-status-section",children:[_.jsx("h3",{children:"📊 Market Overview"}),_.jsxs("div",{className:"market-stats-grid",children:[_.jsxs("div",{className:"market-stat-card",children:[_.jsx("div",{className:"stat-icon",children:"🌍"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("span",{className:"stat-value",children:x().totalAvailableCredits.toFixed(0)}),_.jsx("span",{className:"stat-label",children:"Available Credits (tCO2)"})]})]}),_.jsxs("div",{className:"market-stat-card",children:[_.jsx("div",{className:"stat-icon",children:"💵"}),_.jsxs("div",{className:"stat-content",children:[_.jsxs("span",{className:"stat-value",children:["₹",x().averagePrice.toFixed(2)]}),_.jsx("span",{className:"stat-label",children:"Average Price per tCO2"})]})]}),_.jsxs("div",{className:"market-stat-card",children:[_.jsx("div",{className:"stat-icon",children:"🏗️"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("span",{className:"stat-value",children:x().totalProjects}),_.jsx("span",{className:"stat-label",children:"Active Projects"})]})]}),_.jsxs("div",{className:"market-stat-card",children:[_.jsx("div",{className:"stat-icon",children:"💰"}),_.jsxs("div",{className:"stat-content",children:[_.jsxs("span",{className:"stat-value",children:["₹",x().marketValue.toFixed(0)]}),_.jsx("span",{className:"stat-label",children:"Total Market Value"})]})]})]})]}),_.jsxs("div",{className:"mrv-section",children:[_.jsx("h3",{children:"🛍️ Available Carbon Credits"}),_.jsx("div",{className:"credits-marketplace",children:n.length>0?n.map(y=>_.jsxs("div",{className:"credit-card",children:[_.jsxs("div",{className:"credit-header",children:[_.jsx("h4",{children:y.projectName}),_.jsx("span",{className:"project-type",children:y.projectType})]}),_.jsxs("div",{className:"credit-details",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Location:"})," ",y.location]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Available Credits:"})," ",y.availableCredits.toFixed(2)," tCO2"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Price per Credit:"})," ₹",y.pricePerCredit]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Total Value:"}),"₹",(y.availableCredits*y.pricePerCredit).toFixed(2)]})]}),_.jsxs("div",{className:"purchase-section",children:[_.jsx("input",{type:"number",placeholder:"Amount to purchase",max:y.availableCredits,min:"0.1",step:"0.1",className:"purchase-input",id:`purchase-${y.projectId}`}),_.jsx("button",{className:"btn-primary purchase-btn",onClick:()=>{const v=document.getElementById(`purchase-${y.projectId}`).value;v&&parseFloat(v)>0?(c(y.projectId,parseFloat(v)),document.getElementById(`purchase-${y.projectId}`).value=""):alert("Please enter a valid amount")},children:"Purchase Credits"})]})]},y.projectId)):_.jsxs("div",{className:"no-credits-available",children:[_.jsx("p",{children:"No verified carbon credits available for purchase at the moment."}),_.jsx("p",{children:"Credits become available once farmer projects are verified."})]})})]}),_.jsxs("div",{className:"mrv-section",children:[_.jsx("h3",{children:"📋 Purchase History"}),_.jsx("div",{className:"purchase-history",children:t.length>0?_.jsxs("div",{className:"history-table",children:[_.jsxs("div",{className:"table-header",children:[_.jsx("span",{children:"Date"}),_.jsx("span",{children:"Project"}),_.jsx("span",{children:"Amount"}),_.jsx("span",{children:"Price"}),_.jsx("span",{children:"Total Cost"}),_.jsx("span",{children:"Status"})]}),t.slice().reverse().map(y=>_.jsxs("div",{className:"table-row",children:[_.jsx("span",{children:new Date(y.purchaseDate).toLocaleDateString()}),_.jsx("span",{children:y.projectName}),_.jsxs("span",{children:[y.amount.toFixed(2)," tCO2"]}),_.jsxs("span",{children:["$",y.pricePerCredit]}),_.jsxs("span",{children:["$",y.totalCost.toFixed(2)]}),_.jsx("span",{className:`status-badge ${y.status}`,children:y.status})]},y.id))]}):_.jsx("p",{className:"no-history",children:"No purchase history yet. Start buying carbon credits to see your transactions here."})})]})]})]})}function sxe(){const[n,e]=Se.useState([]),[t,r]=Se.useState([]),[s,i]=Se.useState(null),[a,o]=Se.useState({creditsToSell:"",pricePerCredit:"",description:"",availableFrom:"",expiryDate:""});Se.useEffect(()=>{const p=JSON.parse(localStorage.getItem("userProjects")||"[]"),x=JSON.parse(localStorage.getItem("marketListings")||"[]");e(p.filter(y=>y.status==="verified")),r(x)},[]);const l=p=>{const{name:x,value:y}=p.target;o(v=>({...v,[x]:y}))},c=p=>{if(p.preventDefault(),!s){alert("Please select a project first");return}const x={...a,id:Date.now(),projectId:s.id,projectName:s.projectName,projectType:s.projectType,location:s.location,sellerId:localStorage.getItem("userEmail"),status:"active",createdAt:new Date().toISOString()},y=JSON.parse(localStorage.getItem("marketListings")||"[]");y.push(x),localStorage.setItem("marketListings",JSON.stringify(y)),r(y),alert("Listing created successfully!"),o({creditsToSell:"",pricePerCredit:"",description:"",availableFrom:"",expiryDate:""}),i(null)},u=()=>{const p=localStorage.getItem("userEmail");return t.filter(x=>x.sellerId===p)},d=()=>{const p=localStorage.getItem("userEmail");return t.filter(x=>x.sellerId!==p&&x.status==="active")};return _.jsxs("div",{className:"page-container",children:[_.jsxs("div",{className:"page-header",children:[_.jsx("h1",{className:"page-title",children:"💰 Carbon Credit Marketplace"}),_.jsx("p",{className:"page-subtitle",children:"Sell your verified carbon credits and discover opportunities"})]}),_.jsxs("div",{className:"marketplace-content",children:[_.jsxs("div",{className:"marketplace-section",children:[_.jsx("h3",{children:"🏷️ Create New Listing"}),_.jsxs("div",{className:"project-selection",children:[_.jsx("h4",{children:"Select Verified Project"}),_.jsx("div",{className:"project-grid",children:n.length>0?n.map(p=>_.jsxs("div",{className:`project-card ${s?.id===p.id?"selected":""}`,onClick:()=>i(p),children:[_.jsx("h5",{children:p.projectName}),_.jsxs("p",{children:[_.jsx("strong",{children:"Type:"})," ",p.projectType]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Location:"})," ",p.location]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Expected Credits:"})," ",p.expectedCredits]}),_.jsx("span",{className:"status-badge verified",children:"Verified"})]},p.id)):_.jsx("div",{className:"no-projects",children:_.jsxs("p",{children:["No verified projects available. ",_.jsx(Dt,{to:"/add-project",children:"Add a project"})," and complete verification first."]})})})]}),s&&_.jsxs("form",{className:"listing-form",onSubmit:c,children:[_.jsxs("h4",{children:["Create Listing for: ",s.projectName]}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"creditsToSell",children:"Credits to Sell *"}),_.jsx("input",{type:"number",id:"creditsToSell",name:"creditsToSell",value:a.creditsToSell,onChange:l,required:!0,placeholder:"Number of credits",max:s.expectedCredits})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"pricePerCredit",children:"Price per Credit ($) *"}),_.jsx("input",{type:"number",id:"pricePerCredit",name:"pricePerCredit",value:a.pricePerCredit,onChange:l,required:!0,placeholder:"Price in USD",step:"0.01"})]})]}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"availableFrom",children:"Available From *"}),_.jsx("input",{type:"date",id:"availableFrom",name:"availableFrom",value:a.availableFrom,onChange:l,required:!0})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"expiryDate",children:"Listing Expiry"}),_.jsx("input",{type:"date",id:"expiryDate",name:"expiryDate",value:a.expiryDate,onChange:l})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"description",children:"Description"}),_.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:l,placeholder:"Describe your carbon credits, project benefits, and any additional information...",rows:"3"})]}),_.jsx("button",{type:"submit",className:"btn-primary",children:"Create Listing"})]})]}),_.jsxs("div",{className:"marketplace-section",children:[_.jsx("h3",{children:"📋 Your Active Listings"}),_.jsxs("div",{className:"listings-grid",children:[u().map(p=>_.jsxs("div",{className:"listing-card own-listing",children:[_.jsxs("div",{className:"listing-header",children:[_.jsx("h4",{children:p.projectName}),_.jsx("span",{className:`status-badge ${p.status}`,children:p.status})]}),_.jsxs("div",{className:"listing-details",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Credits:"})," ",p.creditsToSell]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Price:"})," $",p.pricePerCredit,"/credit"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Total Value:"})," $",(p.creditsToSell*p.pricePerCredit).toFixed(2)]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Type:"})," ",p.projectType]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Location:"})," ",p.location]})]}),_.jsxs("div",{className:"listing-actions",children:[_.jsx("button",{className:"btn-secondary",children:"Edit"}),_.jsx("button",{className:"btn-danger",children:"Remove"})]})]},p.id)),u().length===0&&_.jsx("p",{className:"no-listings",children:"You haven't created any listings yet."})]})]}),_.jsxs("div",{className:"marketplace-section",children:[_.jsx("h3",{children:"🛒 Browse Available Credits"}),_.jsxs("div",{className:"listings-grid",children:[d().map(p=>_.jsxs("div",{className:"listing-card market-listing",children:[_.jsxs("div",{className:"listing-header",children:[_.jsx("h4",{children:p.projectName}),_.jsx("span",{className:"project-type",children:p.projectType})]}),_.jsxs("div",{className:"listing-details",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Credits Available:"})," ",p.creditsToSell]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Price:"})," $",p.pricePerCredit,"/credit"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Location:"})," ",p.location]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Available From:"})," ",new Date(p.availableFrom).toLocaleDateString()]}),p.description&&_.jsxs("p",{children:[_.jsx("strong",{children:"Description:"})," ",p.description]})]}),_.jsxs("div",{className:"listing-actions",children:[_.jsx("button",{className:"btn-primary",children:"Contact Seller"}),_.jsx("button",{className:"btn-secondary",children:"View Details"})]})]},p.id)),d().length===0&&_.jsx("p",{className:"no-listings",children:"No credits available in the marketplace currently."})]})]}),_.jsxs("div",{className:"marketplace-section",children:[_.jsx("h3",{children:"📊 Market Statistics"}),_.jsxs("div",{className:"stats-grid",children:[_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:t.length}),_.jsx("div",{className:"stat-label",children:"Total Listings"})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:t.reduce((p,x)=>p+parseInt(x.creditsToSell||0),0)}),_.jsx("div",{className:"stat-label",children:"Credits Available"})]}),_.jsxs("div",{className:"stat-card",children:[_.jsxs("div",{className:"stat-number",children:["₹",t.length>0?(t.reduce((p,x)=>p+parseFloat(x.pricePerCredit||0),0)/t.length).toFixed(2):"0.00"]}),_.jsx("div",{className:"stat-label",children:"Avg. Price/Credit"})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:u().length}),_.jsx("div",{className:"stat-label",children:"Your Listings"})]})]})]})]})]})}function ixe(){const[n,e]=Se.useState({name:"",email:"",subject:"",message:"",category:""}),t=s=>{const{name:i,value:a}=s.target;e(o=>({...o,[i]:a}))},r=s=>{s.preventDefault();const i=JSON.parse(localStorage.getItem("contactSubmissions")||"[]"),a={...n,id:Date.now(),submittedAt:new Date().toISOString()};i.push(a),localStorage.setItem("contactSubmissions",JSON.stringify(i)),alert("Thank you for your message! We will get back to you soon."),e({name:"",email:"",subject:"",message:"",category:""})};return _.jsxs("div",{className:"contact-container",children:[_.jsx(lS,{}),_.jsxs("div",{className:"contact-header",children:[_.jsx("h1",{className:"contact-title",children:"📞 Contact Us"}),_.jsx("p",{className:"contact-subtitle",children:"Get in touch with our team for support, partnerships, or general inquiries"})]}),_.jsxs("div",{className:"contact-content",children:[_.jsxs("div",{className:"contact-info-section",children:[_.jsx("h3",{children:"Get in Touch"}),_.jsxs("div",{className:"contact-methods",children:[_.jsxs("div",{className:"contact-method",children:[_.jsx("div",{className:"method-icon",children:"📧"}),_.jsxs("div",{className:"method-details",children:[_.jsx("h4",{children:"Email"}),_.jsx("p",{children:"contact@carbonlens.com"}),_.jsx("p",{children:"partnerships@carbonlens.com"})]})]}),_.jsxs("div",{className:"contact-method",children:[_.jsx("div",{className:"method-icon",children:"📱"}),_.jsxs("div",{className:"method-details",children:[_.jsx("h4",{children:"Phone"}),_.jsx("p",{children:"+91 9100899879"}),_.jsx("p",{children:"Mon-Sat, 9 AM - 6 PM EST"})]})]}),_.jsxs("div",{className:"contact-method",children:[_.jsx("div",{className:"method-icon",children:"📍"}),_.jsxs("div",{className:"method-details",children:[_.jsx("h4",{children:"Address"}),_.jsx("p",{children:"TPC"}),_.jsx("p",{children:"JORHAT ENGINEERING COLLEGE"})]})]})]})]}),_.jsxs("div",{className:"contact-form-section",children:[_.jsx("h3",{children:"Send us a Message"}),_.jsxs("form",{className:"contact-form",onSubmit:r,children:[_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"name",children:"Full Name *"}),_.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:t,required:!0,placeholder:"Enter your full name"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"email",children:"Email Address *"}),_.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:t,required:!0,placeholder:"Enter your email"})]})]}),_.jsxs("div",{className:"form-row",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"category",children:"Category *"}),_.jsxs("select",{id:"category",name:"category",value:n.category,onChange:t,required:!0,children:[_.jsx("option",{value:"",children:"Select category"}),_.jsx("option",{value:"general",children:"General Inquiry"}),_.jsx("option",{value:"support",children:"Technical Support"}),_.jsx("option",{value:"partnership",children:"Partnership"}),_.jsx("option",{value:"verification",children:"Project Verification"}),_.jsx("option",{value:"billing",children:"Billing & Payments"}),_.jsx("option",{value:"feedback",children:"Feedback"})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"subject",children:"Subject *"}),_.jsx("input",{type:"text",id:"subject",name:"subject",value:n.subject,onChange:t,required:!0,placeholder:"Brief subject line"})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"message",children:"Message *"}),_.jsx("textarea",{id:"message",name:"message",value:n.message,onChange:t,required:!0,placeholder:"Tell us how we can help you...",rows:"6"})]}),_.jsx("button",{type:"submit",className:"btn-primary",children:"Send Message"})]})]})]}),_.jsxs("div",{className:"faq-section",children:[_.jsx("h3",{children:"Frequently Asked Questions"}),_.jsxs("div",{className:"faq-grid",children:[_.jsxs("div",{className:"faq-item",children:[_.jsx("h4",{children:"How do I get my project verified?"}),_.jsx("p",{children:'Submit your project through the "Add Project" page with all required documentation. Our verification team will review within 5-7 business days.'})]}),_.jsxs("div",{className:"faq-item",children:[_.jsx("h4",{children:"What types of blue carbon projects are accepted?"}),_.jsx("p",{children:"We accept mangrove restoration, seagrass conservation, salt marsh restoration, oyster reef restoration, and kelp forest conservation projects."})]}),_.jsxs("div",{className:"faq-item",children:[_.jsx("h4",{children:"How are carbon credits priced?"}),_.jsx("p",{children:"Credit prices are set by project owners based on market conditions, project quality, and verification standards. Typical range is $20-50 per credit."})]}),_.jsxs("div",{className:"faq-item",children:[_.jsx("h4",{children:"What payment methods do you accept?"}),_.jsx("p",{children:"We accept major credit cards, bank transfers, and cryptocurrency payments for carbon credit transactions."})]})]})]})]})}function axe(){return _.jsxs("div",{className:"about-container",children:[_.jsx(lS,{}),_.jsxs("div",{className:"about-header",children:[_.jsx("h1",{className:"about-title",children:"🌊 About CarbonLens Platform"}),_.jsx("p",{className:"about-subtitle",children:"Protecting coastal ecosystems through transparent carbon credit trading"})]}),_.jsx("div",{className:"about-hero",children:_.jsxs("div",{className:"about-content",children:[_.jsx("h4",{children:"Revolutionizing Blue Carbon Conservation"}),_.jsx("p",{children:"Our platform connects coastal ecosystem protectors with carbon credit buyers, creating a transparent marketplace that drives real environmental impact while providing sustainable income for coastal communities."})]})}),_.jsxs("div",{className:"about-section",children:[_.jsx("h3",{children:"Our Mission"}),_.jsxs("div",{className:"mission-grid",children:[_.jsxs("div",{className:"mission-item",children:[_.jsx("div",{className:"mission-icon",children:"🌱"}),_.jsx("h4",{children:"Environmental Protection"}),_.jsx("p",{children:"Safeguard critical coastal ecosystems including mangroves, seagrass beds, and salt marshes that store vast amounts of carbon."})]}),_.jsxs("div",{className:"mission-item",children:[_.jsx("div",{className:"mission-icon",children:"🤝"}),_.jsx("h4",{children:"Community Empowerment"}),_.jsx("p",{children:"Provide sustainable income opportunities for coastal communities through verified carbon credit projects."})]}),_.jsxs("div",{className:"mission-item",children:[_.jsx("div",{className:"mission-icon",children:"🔗"}),_.jsx("h4",{children:"Transparent Trading"}),_.jsx("p",{children:"Create a trustworthy marketplace with blockchain-verified transactions and rigorous project monitoring."})]}),_.jsxs("div",{className:"mission-item",children:[_.jsx("div",{className:"mission-icon",children:"📊"}),_.jsx("h4",{children:"Scientific Rigor"}),_.jsx("p",{children:"Ensure all projects meet international standards through our comprehensive MRV (Monitor, Report, Verify) system."})]})]})]}),_.jsxs("div",{className:"about-section blue-carbon-section",children:[_.jsx("h3",{children:"What is Blue Carbon?"}),_.jsxs("div",{className:"blue-carbon-content",children:[_.jsxs("div",{className:"blue-carbon-text",children:[_.jsx("p",{children:"Blue carbon refers to the carbon captured and stored by coastal and marine ecosystems. These environments are among the most carbon-rich ecosystems on Earth, storing up to 10 times more carbon per hectare than terrestrial forests."}),_.jsxs("div",{className:"ecosystem-types",children:[_.jsx("h4",{children:"Key Blue Carbon Ecosystems:"}),_.jsxs("ul",{children:[_.jsxs("li",{children:[_.jsx("strong",{children:"Mangroves:"})," Tropical coastal forests that store carbon in both biomass and sediment"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Seagrass Beds:"})," Underwater meadows that sequester carbon in their roots and sediment"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Salt Marshes:"})," Coastal wetlands that capture carbon in plant matter and soil"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Kelp Forests:"})," Large marine algae that absorb CO2 from seawater"]})]})]})]}),_.jsxs("div",{className:"carbon-stats",children:[_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:"10x"}),_.jsx("div",{className:"stat-label",children:"More carbon storage than forests"})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:"50%"}),_.jsx("div",{className:"stat-label",children:"Of ocean carbon sequestration"})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-number",children:"2-4x"}),_.jsx("div",{className:"stat-label",children:"Faster carbon capture rate"})]})]})]})]}),_.jsxs("div",{className:"about-section",children:[_.jsx("h3",{children:"How Our Platform Works"}),_.jsxs("div",{className:"process-steps",children:[_.jsxs("div",{className:"step",children:[_.jsx("div",{className:"step-number",children:"1"}),_.jsxs("div",{className:"step-content",children:[_.jsx("h4",{children:"Project Registration"}),_.jsx("p",{children:"Coastal communities and organizations register their blue carbon conservation projects with detailed documentation."})]})]}),_.jsxs("div",{className:"step",children:[_.jsx("div",{className:"step-number",children:"2"}),_.jsxs("div",{className:"step-content",children:[_.jsx("h4",{children:"Verification Process"}),_.jsx("p",{children:"Our expert team verifies projects using international standards and satellite monitoring technology."})]})]}),_.jsxs("div",{className:"step",children:[_.jsx("div",{className:"step-number",children:"3"}),_.jsxs("div",{className:"step-content",children:[_.jsx("h4",{children:"MRV Monitoring"}),_.jsx("p",{children:"Continuous monitoring, reporting, and verification ensure project integrity and carbon sequestration accuracy."})]})]}),_.jsxs("div",{className:"step",children:[_.jsx("div",{className:"step-number",children:"4"}),_.jsxs("div",{className:"step-content",children:[_.jsx("h4",{children:"Credit Trading"}),_.jsx("p",{children:"Verified carbon credits are listed on our marketplace for transparent, secure trading with buyers worldwide."})]})]})]})]}),_.jsxs("div",{className:"about-section",children:[_.jsx("h3",{children:"Our Team"}),_.jsxs("div",{className:"team-grid",children:[_.jsxs("div",{className:"team-member",children:[_.jsx("div",{className:"member-avatar",children:"👨‍💼"}),_.jsx("h4",{}),_.jsx("p",{className:"member-role"}),_.jsx("p",{})]}),_.jsxs("div",{className:"team-member",children:[_.jsx("div",{className:"member-avatar",children:"👩‍💻"}),_.jsx("h4",{}),_.jsx("p",{className:"member-role"}),_.jsx("p",{})]}),_.jsxs("div",{className:"team-member",children:[_.jsx("div",{className:"member-avatar",children:"👨‍🔬"}),_.jsx("h4",{}),_.jsx("p",{className:"member-role"}),_.jsx("p",{children:"."})]}),_.jsxs("div",{className:"team-member",children:[_.jsx("div",{className:"member-avatar",children:"👩‍🌾"}),_.jsx("h4",{}),_.jsx("p",{className:"member-role"}),_.jsx("p",{children:"."})]})]})]}),_.jsxs("div",{className:"about-section impact-section",children:[_.jsx("h3",{children:"Our Impact"}),_.jsxs("div",{className:"impact-stats",children:[_.jsxs("div",{className:"impact-stat",children:[_.jsx("div",{className:"impact-number",children:"5"}),_.jsx("div",{className:"impact-label",children:"Active Projects"})]}),_.jsxs("div",{className:"impact-stat",children:[_.jsx("div",{className:"impact-number",children:"19"}),_.jsx("div",{className:"impact-label",children:"Carbon Credits Traded"})]}),_.jsxs("div",{className:"impact-stat",children:[_.jsx("div",{className:"impact-number",children:"50,0"}),_.jsx("div",{className:"impact-label",children:"Hectares Protected"})]}),_.jsxs("div",{className:"impact-stat",children:[_.jsx("div",{className:"impact-number",children:"3"}),_.jsx("div",{className:"impact-label",children:"Communities Supported"})]})]})]}),_.jsxs("div",{className:"about-cta",children:[_.jsx("h3",{children:"Join the Blue Carbon Revolution"}),_.jsx("p",{children:"Whether you're a coastal community looking to protect your ecosystem or a business seeking to offset your carbon footprint, we're here to help."}),_.jsxs("div",{className:"cta-buttons",children:[_.jsx(Dt,{to:"/signup",className:"btn-primary",children:"Get Started"}),_.jsx(Dt,{to:"/contact",className:"btn-secondary",children:"Contact Us"})]})]})]})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oxe=1e-7,lxe=1e-4;let cxe=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},CU=class{refCount(e){return Go("refCount")}incRef(e){return Go("incRef")}timerAvailable(){return!0}time(e){return Go("time")}read(e){return Go("read")}readSync(e){return Go("readSync")}readToGPU(e,t){return Go("readToGPU")}numDataIds(){return Go("numDataIds")}disposeData(e,t){return Go("disposeData")}write(e,t,r){return Go("write")}move(e,t,r,s,i){return Go("move")}memory(){return Go("memory")}floatPrecision(){return Go("floatPrecision")}epsilon(){return this.floatPrecision()===32?oxe:lxe}dispose(){return Go("dispose")}};function Go(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AU(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,xE(n,e,t)}function uxe(n,e){if(n.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${n.length}Second array length was ${e.length}`);let t=n.length,r=0;for(;t>0;)r=Math.random()*t|0,t--,xE(n,t,r),xE(e,t,r)}function g1(n,e,t){return Math.max(n,Math.min(e,t))}function hxe(n){return n%2===0?n:n+1}function xE(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function dxe(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function fxe(n,e){const t=Math.random();return e*t+(1-t)*n}function pxe(n,e){let t=0;for(let r=0;r<n.length;r++){const s=Number(n[r])-Number(e[r]);t+=s*s}return t}function fe(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function Da(n,e,t=""){fe(bu(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function Im(n){fe(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function nm(n,e=[],t=!1){if(e==null&&(e=[]),Array.isArray(n)||qi(n)&&!t)for(let r=0;r<n.length;++r)nm(n[r],e,t);else e.push(n);return e}function Hr(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function mxe(n){return n.length===0}function bu(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function xg(n){return n%1===0}function gxe(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{const e=Math.exp(2*n);return(e-1)/(e+1)}}function xxe(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function yxe(n){const e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return AU(e),e}function Wy(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function bxe(n,e=s=>0,t,r=setTimeout){return new Promise((s,i)=>{let a=0;const o=()=>{if(n()){s();return}a++;const l=e(a);if(t!=null&&a>=t){i();return}r(o,l)};o()})}function vxe(n,e){let t=1,r=-1;for(let i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(n[i]<0)throw Error(`Shapes can not be < 0. Found ${n[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const s=n.slice();return s[r]=e/t,s}function lb(n,e){const t=e.length;return n=n==null?e.map((r,s)=>s):[].concat(n),fe(n.every(r=>r>=-t&&r<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),fe(n.every(r=>xg(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?t+r:r)}function NU(n,e){const t=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:lb(e,n).sort();let a=0;for(let o=0;o<n.length;++o){if(i!=null){if(i[a]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(i[a]==null||i[a]>o)&&n[o]===1&&(t.push(n[o]),r.push(o)),i[a]<=o&&a++}n[o]!==1&&(t.push(n[o]),r.push(o))}return{newShape:t,keptDims:r}}function kU(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else throw new Error(`Unknown data type ${n}`);return t}function IU(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function RU(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function DU(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function _xe(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function qi(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}function TI(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function $U(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function jd(n){return typeof n=="string"||n instanceof String}function LU(n){return typeof n=="boolean"}function PU(n){return typeof n=="number"}function BS(n){return Array.isArray(n)?BS(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":PU(n)?"float32":jd(n)?"string":LU(n)?"bool":"float32"}function pf(n){return!!(n&&n.constructor&&n.call&&n.apply)}function yE(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Xg(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function OU(n,e,t,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let a=0;a<i;a++)s[a]=t[n+a]}else{const i=e[0],a=e.slice(1),o=a.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<i;l++)s[l]=OU(n+l*o,a,t,r)}return s}function Fp(n,e,t=!1){if(n.length===0)return e[0];const r=n.reduce((s,i)=>s*i)*(t?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return OU(0,n,e,t)}function hR(n,e){const t=zS(n,e);for(let r=0;r<t.length;r++)t[r]=1;return t}function zS(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function wxe(n,e){const t=n.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return Fp(n,new Float32Array(t));if(e==="int32")return Fp(n,new Int32Array(t));if(e==="bool")return Fp(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function dR(n){n.forEach(e=>{fe(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function Exe(n,e,t){if(e===0)return 0;if(e===1)return n[0];let r=n[n.length-1];for(let s=0;s<n.length-1;++s)r+=t[s]*n[s];return r}function Sxe(n,e,t){if(e===0)return[];if(e===1)return[n];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(n/t[s]),n-=r[s]*t[s];return r[r.length-1]=n,r}function rm(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mF="tfjsflags";let MU=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Txe,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(ln().getBool("IS_TEST")||ln().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];ln().getBool("IS_TEST")||ln().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(rm(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);mF in e&&e[mF].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=Axe(s,i)})}};function Txe(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>(Cxe(e,r[0],r[1]),r.join("="))),e}function Cxe(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Axe(n,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${n}.`)}function ln(){return fR}let fR=null;function Nxe(n){fR=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let hk;function FU(){if(hk==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");hk=n}return hk}function kxe(){const n=FU();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function pR(n,e){const t=kxe();if(t.has(n))return t.get(n);{const r=e();return t.set(n,r),t.get(n)}}const BU="Abs",zU="Acos",jU="Acosh",mR="Add",VU="AddN",UU="All",GU="Any",HU="ArgMax",WU="ArgMin",qU="Asin",KU="Asinh",XU="Atan",YU="Atanh",ZU="Atan2",QU="AvgPool",Ixe="AvgPoolGrad",JU="AvgPool3D",Rxe="AvgPool3DGrad",eG="BatchMatMul",tG="BatchToSpaceND",nG="Bincount",Dxe="BroadcastTo",rG="BroadcastArgs",gR="Cast",sG="Ceil",iG="ClipByValue",aG="Complex",oG="ComplexAbs",lG="Concat",cG="Conv2D",uG="Conv2DBackpropFilter",hG="Conv2DBackpropInput",dG="Conv3D",$xe="Conv3DBackpropFilterV2",fG="Conv3DBackpropInputV2",pG="Cos",mG="Cosh",gG="Cumprod",xG="Cumsum",yG="CropAndResize",bG="DenseBincount",vG="DepthToSpace",_G="DepthwiseConv2dNative",wG="DepthwiseConv2dNativeBackpropFilter",EG="DepthwiseConv2dNativeBackpropInput",SG="Diag",TG="Dilation2D",Lxe="Dilation2DBackpropInput",Pxe="Dilation2DBackpropFilter",CG="RealDiv",AG="Einsum",NG="Elu",Oxe="EluGrad",kG="Erf",IG="Equal",RG="Exp",DG="ExpandDims",$G="Expm1",LG="FFT",PG="Fill",OG="FlipLeftRight",MG="Floor",FG="FloorDiv",BG="FusedBatchNorm",zG="GatherV2",jG="GatherNd",VG="Greater",UG="GreaterEqual",xR="Identity",GG="IFFT",HG="Imag",WG="IsFinite",qG="IsInf",KG="IsNan",XG="LeakyRelu",YG="Less",ZG="LessEqual",QG="LinSpace",JG="Log",eH="Log1p",tH="LogicalAnd",nH="LogicalNot",rH="LogicalOr",Mxe="LogicalXor",Fxe="LogSoftmax",Bxe="LowerBound",sH="LRN",zxe="LRNGrad",iH="Max",aH="Maximum",oH="MaxPool",jxe="MaxPoolGrad",lH="MaxPool3D",Vxe="MaxPool3DGrad",cH="MaxPoolWithArgmax",uH="Mean",hH="Min",dH="Minimum",fH="MirrorPad",pH="Mod",mH="Multinomial",gH="Multiply",xH="Neg",yH="NotEqual",bH="NonMaxSuppressionV3",vH="NonMaxSuppressionV4",_H="NonMaxSuppressionV5",wH="OnesLike",EH="OneHot",SH="Pack",TH="PadV2",Uxe="Pool",CH="Pow",AH="Prelu",NH="Prod",kH="RaggedGather",IH="RaggedTensorToTensor",RH="Range",DH="Real",$H="Reciprocal",LH="Relu",PH="Reshape",OH="ResizeNearestNeighbor",Gxe="ResizeNearestNeighborGrad",MH="ResizeBilinear",Hxe="ResizeBilinearGrad",FH="Relu6",BH="Reverse",zH="Round",jH="Rsqrt",VH="ScatterNd",UH="SearchSorted",GH="Select",HH="Selu",WH="Slice",qH="Sin",KH="Sinh",XH="Sign",YH="Sigmoid",ZH="Softplus",QH="Sqrt",JH="Sum",eW="SpaceToBatchND",tW="SplitV",nW="Softmax",rW="SparseFillEmptyRows",sW="SparseReshape",iW="SparseSegmentMean",aW="SparseSegmentSum",oW="SparseToDense",lW="SquaredDifference",Wxe="Square",cW="StridedSlice",uW="StringNGrams",hW="StringSplit",dW="StringToHashBucketFast",fW="Sub",pW="Tan",mW="Tanh",yR="Tile",gW="TopK",xW="Transform",Hw="Transpose",yW="Unique",bW="Unpack",vW="UnsortedSegmentSum",qxe="UpperBound",_W="ZerosLike",wW="Step",CI="FromPixels",EW="RotateWithOffset",AI="_FusedMatMul",NI="FusedConv2D",kI="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bd(...n){ln().getBool("IS_TEST")||ln().getBool("PROD")||console.warn(...n)}function Kxe(...n){ln().getBool("IS_TEST")||ln().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yg=pR("kernelRegistry",()=>new Map),x1=pR("gradRegistry",()=>new Map);function bE(n,e){const t=bR(n,e);return yg.get(t)}function II(n){return x1.get(n)}function vE(n){const e=yg.entries(),t=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,a]=s,[o]=i.split("_");o===n&&t.push(a)}return t}function SW(n){const{kernelName:e,backendName:t}=n,r=bR(e,t);yg.has(r)&&Bd(`The kernel '${e}' for backend '${t}' is already registered`),yg.set(r,n)}function Xxe(n){const{kernelName:e}=n;x1.has(e)&&ln().getBool("DEBUG")&&Bd(`Overriding the gradient for '${e}'`),x1.set(e,n)}function Yxe(n,e){const t=bR(n,e);if(!yg.has(t))throw new Error(`The kernel '${n}' for backend '${e}' is not registered`);yg.delete(t)}function Zxe(n){if(!x1.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);x1.delete(n)}function Qxe(n,e){vE(n).forEach(r=>{const s=Object.assign({},r,{backendName:e});SW(s)})}function bR(n,e){return`${e}_${n}`}var dk,gF;function Jxe(){if(gF)return dk;gF=1,dk=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(V,O,K){this.low=V|0,this.high=O|0,this.unsigned=!!K}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(V){return(V&&V.__isLong__)===!0}e.isLong=t;var r={},s={};function i(V,O){var K,P,N;return O?(V>>>=0,(N=0<=V&&V<256)&&(P=s[V],P)?P:(K=o(V,(V|0)<0?-1:0,!0),N&&(s[V]=K),K)):(V|=0,(N=-128<=V&&V<128)&&(P=r[V],P)?P:(K=o(V,V<0?-1:0,!1),N&&(r[V]=K),K))}e.fromInt=i;function a(V,O){if(isNaN(V))return O?T:S;if(O){if(V<0)return T;if(V>=y)return U}else{if(V<=-v)return F;if(V+1>=v)return q}return V<0?a(-V,O).neg():o(V%x|0,V/x|0,O)}e.fromNumber=a;function o(V,O,K){return new e(V,O,K)}e.fromBits=o;var l=Math.pow;function c(V,O,K){if(V.length===0)throw Error("empty string");if(V==="NaN"||V==="Infinity"||V==="+Infinity"||V==="-Infinity")return S;if(typeof O=="number"?(K=O,O=!1):O=!!O,K=K||10,K<2||36<K)throw RangeError("radix");var P;if((P=V.indexOf("-"))>0)throw Error("interior hyphen");if(P===0)return c(V.substring(1),O,K).neg();for(var N=a(l(K,8)),M=S,B=0;B<V.length;B+=8){var Y=Math.min(8,V.length-B),Z=parseInt(V.substring(B,B+Y),K);if(Y<8){var ne=a(l(K,Y));M=M.mul(ne).add(a(Z))}else M=M.mul(N),M=M.add(a(Z))}return M.unsigned=O,M}e.fromString=c;function u(V,O){return typeof V=="number"?a(V,O):typeof V=="string"?c(V,O):o(V.low,V.high,typeof O=="boolean"?O:V.unsigned)}e.fromValue=u;var d=65536,p=1<<24,x=d*d,y=x*x,v=y/2,b=i(p),S=i(0);e.ZERO=S;var T=i(0,!0);e.UZERO=T;var C=i(1);e.ONE=C;var I=i(1,!0);e.UONE=I;var $=i(-1);e.NEG_ONE=$;var q=o(-1,2147483647,!1);e.MAX_VALUE=q;var U=o(-1,-1,!0);e.MAX_UNSIGNED_VALUE=U;var F=o(0,-2147483648,!1);e.MIN_VALUE=F;var G=e.prototype;return G.toInt=function(){return this.unsigned?this.low>>>0:this.low},G.toNumber=function(){return this.unsigned?(this.high>>>0)*x+(this.low>>>0):this.high*x+(this.low>>>0)},G.toString=function(O){if(O=O||10,O<2||36<O)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(F)){var K=a(O),P=this.div(K),N=P.mul(K).sub(this);return P.toString(O)+N.toInt().toString(O)}else return"-"+this.neg().toString(O);for(var M=a(l(O,6),this.unsigned),B=this,Y="";;){var Z=B.div(M),ne=B.sub(Z.mul(M)).toInt()>>>0,Q=ne.toString(O);if(B=Z,B.isZero())return Q+Y;for(;Q.length<6;)Q="0"+Q;Y=""+Q+Y}},G.getHighBits=function(){return this.high},G.getHighBitsUnsigned=function(){return this.high>>>0},G.getLowBits=function(){return this.low},G.getLowBitsUnsigned=function(){return this.low>>>0},G.getNumBitsAbs=function(){if(this.isNegative())return this.eq(F)?64:this.neg().getNumBitsAbs();for(var O=this.high!=0?this.high:this.low,K=31;K>0&&(O&1<<K)==0;K--);return this.high!=0?K+33:K+1},G.isZero=function(){return this.high===0&&this.low===0},G.eqz=G.isZero,G.isNegative=function(){return!this.unsigned&&this.high<0},G.isPositive=function(){return this.unsigned||this.high>=0},G.isOdd=function(){return(this.low&1)===1},G.isEven=function(){return(this.low&1)===0},G.equals=function(O){return t(O)||(O=u(O)),this.unsigned!==O.unsigned&&this.high>>>31===1&&O.high>>>31===1?!1:this.high===O.high&&this.low===O.low},G.eq=G.equals,G.notEquals=function(O){return!this.eq(O)},G.neq=G.notEquals,G.ne=G.notEquals,G.lessThan=function(O){return this.comp(O)<0},G.lt=G.lessThan,G.lessThanOrEqual=function(O){return this.comp(O)<=0},G.lte=G.lessThanOrEqual,G.le=G.lessThanOrEqual,G.greaterThan=function(O){return this.comp(O)>0},G.gt=G.greaterThan,G.greaterThanOrEqual=function(O){return this.comp(O)>=0},G.gte=G.greaterThanOrEqual,G.ge=G.greaterThanOrEqual,G.compare=function(O){if(t(O)||(O=u(O)),this.eq(O))return 0;var K=this.isNegative(),P=O.isNegative();return K&&!P?-1:!K&&P?1:this.unsigned?O.high>>>0>this.high>>>0||O.high===this.high&&O.low>>>0>this.low>>>0?-1:1:this.sub(O).isNegative()?-1:1},G.comp=G.compare,G.negate=function(){return!this.unsigned&&this.eq(F)?F:this.not().add(C)},G.neg=G.negate,G.add=function(O){t(O)||(O=u(O));var K=this.high>>>16,P=this.high&65535,N=this.low>>>16,M=this.low&65535,B=O.high>>>16,Y=O.high&65535,Z=O.low>>>16,ne=O.low&65535,Q=0,z=0,D=0,X=0;return X+=M+ne,D+=X>>>16,X&=65535,D+=N+Z,z+=D>>>16,D&=65535,z+=P+Y,Q+=z>>>16,z&=65535,Q+=K+B,Q&=65535,o(D<<16|X,Q<<16|z,this.unsigned)},G.subtract=function(O){return t(O)||(O=u(O)),this.add(O.neg())},G.sub=G.subtract,G.multiply=function(O){if(this.isZero())return S;if(t(O)||(O=u(O)),n){var K=n.mul(this.low,this.high,O.low,O.high);return o(K,n.get_high(),this.unsigned)}if(O.isZero())return S;if(this.eq(F))return O.isOdd()?F:S;if(O.eq(F))return this.isOdd()?F:S;if(this.isNegative())return O.isNegative()?this.neg().mul(O.neg()):this.neg().mul(O).neg();if(O.isNegative())return this.mul(O.neg()).neg();if(this.lt(b)&&O.lt(b))return a(this.toNumber()*O.toNumber(),this.unsigned);var P=this.high>>>16,N=this.high&65535,M=this.low>>>16,B=this.low&65535,Y=O.high>>>16,Z=O.high&65535,ne=O.low>>>16,Q=O.low&65535,z=0,D=0,X=0,re=0;return re+=B*Q,X+=re>>>16,re&=65535,X+=M*Q,D+=X>>>16,X&=65535,X+=B*ne,D+=X>>>16,X&=65535,D+=N*Q,z+=D>>>16,D&=65535,D+=M*ne,z+=D>>>16,D&=65535,D+=B*Z,z+=D>>>16,D&=65535,z+=P*Q+N*ne+M*Z+B*Y,z&=65535,o(X<<16|re,z<<16|D,this.unsigned)},G.mul=G.multiply,G.divide=function(O){if(t(O)||(O=u(O)),O.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&O.low===-1&&O.high===-1)return this;var K=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,O.low,O.high);return o(K,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?T:S;var P,N,M;if(this.unsigned){if(O.unsigned||(O=O.toUnsigned()),O.gt(this))return T;if(O.gt(this.shru(1)))return I;M=T}else{if(this.eq(F)){if(O.eq(C)||O.eq($))return F;if(O.eq(F))return C;var B=this.shr(1);return P=B.div(O).shl(1),P.eq(S)?O.isNegative()?C:$:(N=this.sub(O.mul(P)),M=P.add(N.div(O)),M)}else if(O.eq(F))return this.unsigned?T:S;if(this.isNegative())return O.isNegative()?this.neg().div(O.neg()):this.neg().div(O).neg();if(O.isNegative())return this.div(O.neg()).neg();M=S}for(N=this;N.gte(O);){P=Math.max(1,Math.floor(N.toNumber()/O.toNumber()));for(var Y=Math.ceil(Math.log(P)/Math.LN2),Z=Y<=48?1:l(2,Y-48),ne=a(P),Q=ne.mul(O);Q.isNegative()||Q.gt(N);)P-=Z,ne=a(P,this.unsigned),Q=ne.mul(O);ne.isZero()&&(ne=C),M=M.add(ne),N=N.sub(Q)}return M},G.div=G.divide,G.modulo=function(O){if(t(O)||(O=u(O)),n){var K=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,O.low,O.high);return o(K,n.get_high(),this.unsigned)}return this.sub(this.div(O).mul(O))},G.mod=G.modulo,G.rem=G.modulo,G.not=function(){return o(~this.low,~this.high,this.unsigned)},G.and=function(O){return t(O)||(O=u(O)),o(this.low&O.low,this.high&O.high,this.unsigned)},G.or=function(O){return t(O)||(O=u(O)),o(this.low|O.low,this.high|O.high,this.unsigned)},G.xor=function(O){return t(O)||(O=u(O)),o(this.low^O.low,this.high^O.high,this.unsigned)},G.shiftLeft=function(O){return t(O)&&(O=O.toInt()),(O&=63)===0?this:O<32?o(this.low<<O,this.high<<O|this.low>>>32-O,this.unsigned):o(0,this.low<<O-32,this.unsigned)},G.shl=G.shiftLeft,G.shiftRight=function(O){return t(O)&&(O=O.toInt()),(O&=63)===0?this:O<32?o(this.low>>>O|this.high<<32-O,this.high>>O,this.unsigned):o(this.high>>O-32,this.high>=0?0:-1,this.unsigned)},G.shr=G.shiftRight,G.shiftRightUnsigned=function(O){if(t(O)&&(O=O.toInt()),O&=63,O===0)return this;var K=this.high;if(O<32){var P=this.low;return o(P>>>O|K<<32-O,K>>>O,this.unsigned)}else return O===32?o(K,0,this.unsigned):o(K>>>O-32,0,this.unsigned)},G.shru=G.shiftRightUnsigned,G.shr_u=G.shiftRightUnsigned,G.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},G.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},G.toBytes=function(O){return O?this.toBytesLE():this.toBytesBE()},G.toBytesLE=function(){var O=this.high,K=this.low;return[K&255,K>>>8&255,K>>>16&255,K>>>24,O&255,O>>>8&255,O>>>16&255,O>>>24]},G.toBytesBE=function(){var O=this.high,K=this.low;return[O>>>24,O>>>16&255,O>>>8&255,O&255,K>>>24,K>>>16&255,K>>>8&255,K&255]},e.fromBytes=function(O,K,P){return P?e.fromBytesLE(O,K):e.fromBytesBE(O,K)},e.fromBytesLE=function(O,K){return new e(O[0]|O[1]<<8|O[2]<<16|O[3]<<24,O[4]|O[5]<<8|O[6]<<16|O[7]<<24,K)},e.fromBytesBE=function(O,K){return new e(O[4]<<24|O[5]<<16|O[6]<<8|O[7],O[0]<<24|O[1]<<16|O[2]<<8|O[3],K)},dk}var TW=Jxe();const vR=ku(TW),CW=Ore({__proto__:null,default:vR},[TW]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tp=vR||CW;function cb(n){return Tp.fromString(n,!0,16)}const AW=cb("c3a5c85c97cb3127"),_p=cb("b492b66fbe98f273"),wa=cb("9ae16a3b2f90404f");function RI(n){return n.xor(n.shru(47))}function NW(n,e,t){const r=n.slice(e,e+t);return Tp.fromBytes(Array.from(r),!0,!0)}function $r(n,e){return NW(n,e,8)}function xF(n,e){return NW(n,e,4)}function hi(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function Zd(n,e,t=cb("9ddfea08eb382d69")){let r=n.xor(e).mul(t);r=r.xor(r.shru(47));let s=e.xor(r).mul(t);return s=s.xor(s.shru(47)),s=s.mul(t),s}function eye(n,e,t,r,s,i){s=s.add(n),i=hi(i.add(s).add(r),21);const a=s;return s=s.add(e),s=s.add(t),i=i.add(hi(s,44)),[s.add(r),i.add(a)]}function sw(n,e,t,r){return eye($r(n,e),$r(n,e+8),$r(n,e+16),$r(n,e+24),t,r)}function tye(n,e=n.length){if(e>=8){const t=wa.add(e*2),r=$r(n,0).add(wa),s=$r(n,e-8),i=hi(s,37).mul(t).add(r),a=hi(r,25).add(s).mul(t);return Zd(i,a,t)}if(e>=4){const t=wa.add(e*2),r=xF(n,0);return Zd(r.shl(3).add(e),xF(n,e-4),t)}if(e>0){const t=n[0],r=n[e>>1],s=n[e-1],i=t+(r<<8),a=e+(s<<2);return RI(wa.mul(i).xor(AW.mul(a))).mul(wa)}return wa}function nye(n,e=n.length){const t=wa.add(e*2),r=$r(n,0).mul(_p),s=$r(n,8),i=$r(n,e-8).mul(t),a=$r(n,e-16).mul(wa);return Zd(hi(r.add(s),43).add(hi(i,30)).add(a),r.add(hi(s.add(wa),18)).add(i),t)}function rye(n,e=n.length){const t=wa.add(e*2),r=$r(n,0).mul(wa),s=$r(n,8),i=$r(n,e-8).mul(t),a=$r(n,e-16).mul(wa),o=hi(r.add(s),43).add(hi(i,30)).add(a),l=Zd(o,r.add(hi(s.add(wa),18)).add(i),t),c=$r(n,16).mul(t),u=$r(n,24),d=o.add($r(n,e-32)).mul(t),p=l.add($r(n,e-24)).mul(t);return Zd(hi(c.add(u),43).add(hi(d,30)).add(p),c.add(hi(u.add(r),18)).add(d),t)}function sye(n,e=n.length){const t=Tp.fromNumber(81,!0);if(e<=32)return e<=16?tye(n,e):nye(n,e);if(e<=64)return rye(n,e);let r=t,s=t.mul(_p).add(113),i=RI(s.mul(wa).add(113)).mul(wa),a=[Tp.UZERO,Tp.UZERO],o=[Tp.UZERO,Tp.UZERO];r=r.mul(wa).add($r(n,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do r=hi(r.add(s).add(a[0]).add($r(n,l+8)),37).mul(_p),s=hi(s.add(a[1]).add($r(n,l+48)),42).mul(_p),r=r.xor(o[1]),s=s.add(a[0]).add($r(n,l+40)),i=hi(i.add(o[0]),33).mul(_p),a=sw(n,l,a[1].mul(_p),r.add(o[0])),o=sw(n,l+32,i.add(o[1]),s.add($r(n,l+16))),[i,r]=[r,i],l+=64;while(l!==c);const d=_p.add(i.and(255).shl(1));return l=u,o[0]=o[0].add(e-1&63),a[0]=a[0].add(o[0]),o[0]=o[0].add(a[0]),r=hi(r.add(s).add(a[0]).add($r(n,l+8)),37).mul(d),s=hi(s.add(a[1]).add($r(n,l+48)),42).mul(d),r=r.xor(o[1].mul(9)),s=s.add(a[0].mul(9).add($r(n,l+40))),i=hi(i.add(o[0]),33).mul(d),a=sw(n,l,a[1].mul(d),r.add(o[0])),o=sw(n,l+32,i.add(o[1]),s.add($r(n,l+16))),[i,r]=[r,i],Zd(Zd(a[0],o[0],d).add(RI(s).mul(AW)).add(i),Zd(a[1],o[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iye(n,e){return e==="string"?ub(n):jS([n],e)}function aye(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function jS(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=nm(n)),ln().getBool("DEBUG")&&RU(n,e),aye(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let r=0;r<t.length;++r)Math.round(n[r])!==0&&(t[r]=1);return t}else throw new Error(`Unknown data type ${e}`)}function y1(){return ln().platform.now()}function oye(n,e){return ln().platform.fetch(n,e)}function ub(n,e="utf-8"){return e=e||"utf-8",ln().platform.encode(n,e)}function _E(n,e="utf-8"){return e=e||"utf-8",ln().platform.decode(n,e)}const lye=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:bu,assert:fe,assertNonNegativeIntegerDimensions:dR,assertNonNull:Im,assertShapesMatch:Da,bytesFromStringArray:$U,bytesPerElement:TI,checkConversionForErrors:RU,clamp:g1,computeStrides:Xg,createScalarValue:iye,createShuffledIndices:yxe,decodeString:_E,distSquared:pxe,encodeString:ub,fetch:oye,fingerPrint64:sye,flatten:nm,getArrayFromDType:IU,getTypedArrayFromDType:kU,hasEncodingLoss:_xe,hexToLong:cb,indexToLoc:Sxe,inferDtype:BS,inferFromImplicitShape:vxe,isBoolean:LU,isFunction:pf,isInt:xg,isNumber:PU,isPromise:rm,isScalarShape:mxe,isString:jd,isTypedArray:qi,isValidDtype:DU,locToIndex:Exe,makeOnesTypedArray:hR,makeZerosNestedTypedArray:wxe,makeZerosTypedArray:zS,nearestDivisor:yE,nearestLargerEven:hxe,now:y1,parseAxisParam:lb,randUniform:fxe,repeatedTry:bxe,rightPad:Wy,shuffle:AU,shuffleCombo:uxe,sizeFromShape:Hr,sizeToSquarishShape:xxe,squeezeShape:NU,sum:dxe,swap:xE,tanh:gxe,toNestedArray:Fp,toTypedArray:jS},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let cye=class{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new hye)}profileKernel(e,t,r){let s;const i=()=>{s=r()};let a;const o=y1();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(const c of s)c.dataSync();a=Promise.resolve({kernelMs:y1()-o})}if(ln().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<s.length;c++){const u=s[c];u.data().then(d=>{uye(d,u.dtype,e)})}return{kernelName:e,outputs:s,inputs:t,timeMs:a.then(c=>c.kernelMs),extraInfo:a.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:s,inputs:i,extraInfo:a}=e;r.forEach(o=>{Promise.all([o.data(),s,a]).then(l=>{this.logger.logKernelProfile(t,o,l[0],l[1],i,l[2])})})}};function uye(n,e,t){if(e!=="float32")return!1;for(let r=0;r<n.length;r++){const s=n[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${t}'`),!0}return!1}let hye=class{logKernelProfile(e,t,r,s,i,a){const o=typeof s=="number"?Wy(`${s}ms`,9):s.error,l=Wy(e,25),c=t.rank,u=t.size,d=Wy(t.shape.toString(),14);let p="";for(const x in i){const y=i[x];if(y!=null){const v=y.shape||t.shape,b=v.length;p+=`${x}: ${b}D ${b>0?v:""} `}}console.log(`%c${l}	%c${o}	%c${c}D ${d}	%c${u}	%c${p}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dye(n,e,t){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<n.length;l++){const c=n[l],u=c.inputs;for(const d in u){const p=u[d];let x=!1;for(let y=0;y<e.length;y++)if(r[p.id]){c.outputs.forEach(v=>r[v.id]=!0),x=!0,s[c.id]=!0;break}if(x)break}}const i={};i[t.id]=!0;const a={};for(let l=n.length-1;l>=0;l--){const c=n[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(const p in u)i[u[p].id]=!0,a[c.id]=!0;break}}const o=[];for(let l=0;l<n.length;l++){const c=n[l];if(s[c.id]&&a[c.id]){const u={};for(const p in c.inputs){const x=c.inputs[p];r[x.id]&&(u[p]=x)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,o.push(d)}}return o}function fye(n,e,t,r){for(let s=e.length-1;s>=0;s--){const i=e[s],a=[];if(i.outputs.forEach(l=>{const c=n[l.id];c!=null?a.push(c):a.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const o=i.gradient(a);for(const l in i.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const c=t(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!bu(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(n[u.id]==null)n[u.id]=c;else{const d=n[u.id];n[u.id]=r(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yF=20,dy=3,fk=7;function pye(n,e,t,r){const s=Xg(e),i=mye(n,e,t,s),a=e.length,o=Ww(n,e,t,s,i),l=["Tensor"];return r&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function mye(n,e,t,r){const s=Hr(e),i=r[r.length-1],a=new Array(i).fill(0),o=e.length,l=t==="complex64"?Ny(n):n;if(o>1)for(let c=0;c<s/i;c++){const u=c*i;for(let d=0;d<i;d++)a[d]=Math.max(a[d],Ay(l[u+d],0,t).length)}return a}function Ay(n,e,t){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(fk))} + ${parseFloat(n[1].toFixed(fk))}j`:jd(n)?r=`'${n}'`:t==="bool"?r=kW(n):r=parseFloat(n.toFixed(fk)).toString(),Wy(r,e)}function kW(n){return n===0?"false":"true"}function Ww(n,e,t,r,s,i=!0){const a=t==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(t==="complex64"){const v=Ny(n);return[Ay(v[0],0,t)]}return t==="bool"?[kW(n[0])]:[n[0].toString()]}if(l===1){if(o>yF){const b=dy*a;let S=Array.from(n.slice(0,b)),T=Array.from(n.slice((o-dy)*a,o*a));return t==="complex64"&&(S=Ny(S),T=Ny(T)),["["+S.map((C,I)=>Ay(C,s[I],t)).join(", ")+", ..., "+T.map((C,I)=>Ay(C,s[o-dy+I],t)).join(", ")+"]"]}return["["+(t==="complex64"?Ny(n):Array.from(n)).map((b,S)=>Ay(b,s[S],t)).join(", ")+"]"]}const c=e.slice(1),u=r.slice(1),d=r[0]*a,p=[];if(o>yF){for(let v=0;v<dy;v++){const b=v*d,S=b+d;p.push(...Ww(n.slice(b,S),c,t,u,s,!1))}p.push("...");for(let v=o-dy;v<o;v++){const b=v*d,S=b+d;p.push(...Ww(n.slice(b,S),c,t,u,s,v===o-1))}}else for(let v=0;v<o;v++){const b=v*d,S=b+d;p.push(...Ww(n.slice(b,S),c,t,u,s,v===o-1))}const x=l===2?",":"";p[0]="["+p[0]+x;for(let v=1;v<p.length-1;v++)p[v]=" "+p[v]+x;let y=`,
`;for(let v=2;v<l;v++)y+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(i?"":y),p}function Ny(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let wE=class{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=Hr(e),r!=null){const s=r.length;fe(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||IU(t,this.size),this.strides=Xg(e)}set(e,...t){t.length===0&&(t=[0]),fe(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const s of e){if(s<0||s>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return sc().makeTensor(this.values,this.shape,this.dtype)}},sc=null,P0=null;function gye(n){sc=n}function xye(n){P0=n}let ss=class{constructor(e,t,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Hr(e),this.strides=Xg(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return P0.buffer(this.shape,this.dtype,e)}bufferSync(){return P0.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Fp(this.shape,e,this.dtype==="complex64")}arraySync(){return Fp(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=sc().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(r=>_E(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),sc().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=sc().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>_E(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await sc().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(sc().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return P0.print(this,e)}clone(){return this.throwIfDisposed(),P0.clone(this)}toString(e=!1){const t=this.dataSync();return pye(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),P0.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),sc().makeVariable(this,e,t,r)}};Object.defineProperty(ss,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function yye(){return pR("Tensor",()=>ss)}yye();let b1=class extends ss{constructor(e,t,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!bu(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);sc().disposeTensor(this),this.dataId=e.dataId,sc().incRef(this,null)}dispose(){sc().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(b1,Symbol.hasInstance,{value:n=>n instanceof ss&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var DI;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(DI||(DI={}));var $I;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})($I||($I={}));var LI;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(LI||(LI={}));var PI;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(PI||(PI={}));var OI;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(OI||(OI={}));const bye={float32:PI,int32:$I,bool:LI,complex64:OI};function VS(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return bye[n][e]}function vye(n){return VS(n,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function as(n,e){if(n.dtype===e.dtype)return[n,e];const t=VS(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function IW(n,e){fe(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function _ye(n,e){return e.some(t=>t.id===n.id)}function _R(n){const e=[];return RW(n,e,new Set),e}function RW(n,e,t){if(n==null)return;if(n instanceof ss){e.push(n);return}if(!wye(n))return;const r=n;for(const s in r){const i=r[s];t.has(i)||(t.add(i),RW(i,e,t))}}function wye(n){return Array.isArray(n)||typeof n=="object"}const Eye=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:IW,getTensorsInContainer:_R,isTensorInList:_ye,makeTypesMatch:as},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pk(n){return n.kernelName!=null}let bF=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}},wR=class MI{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new bF}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?(Bd(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new cye(this.backendInstance),!0}setupRegisteredKernels(){vE(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){vE(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(r&&!(r instanceof CU)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(a=>s<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Bd(`Initialization of backend ${e} failed`),Bd(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Bd(`Initialization of backend ${e} failed`),Bd(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),s=r.backend,i=this.readSync(t),a=s.refCount(t);s.disposeData(t,!0),r.backend=e,e.move(t,i,r.shape,r.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=t(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,t,r){e();try{const s=r();return t(),s}catch(s){throw t(),s}}nextTensorId(){return MI.nextTensorId++}nextVariableId(){return MI.nextVariableId++}clone(e){const t=be.runKernel(xR,{x:e}),r={x:e},s=a=>({x:()=>{const o="float32",l={x:a},c={dtype:o};return be.runKernel(gR,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[t],s,i,{}),t}runKernel(e,t,r){if(this.backendName==null&&this.backend,!(bE(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const s=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=s-t-i-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const s=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const c=pk(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(pk(e)){const{kernelName:y,inputs:v,attrs:b}=e;this.backendName==null&&this.backend;const S=bE(y,this.backendName);fe(S!=null,()=>`Cannot find registered kernel '${y}' for backend '${this.backendName}'`),o=()=>{const T=this.backend.numDataIds();l=S.kernelFunc({inputs:v,attrs:b,backend:this.backend});const C=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,T,C);const I=C.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(s){const $=this.getTensorsForGradient(y,v,I);r=this.saveTensorsForBackwardMode($)}return I}}else{const{forwardFunc:y}=e,v=b=>{s&&(r=b.map(S=>this.keep(this.clone(S))))};o=()=>{const b=this.backend.numDataIds();l=this.tidy(()=>y(this.backend,v));const S=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,b,S),S}}const{inputs:u,attrs:d}=e,p=pk(e)?null:e.backwardsFunc;let x;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=o():(x=this.profiler.profileKernel(c,u,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(x),t=x.outputs)}),s&&this.addTapeNode(c,u,t,p,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(y=>u[y]!=null?u[y].shape:null),outputShapes:t.map(y=>y.shape),kernelTimeMs:x.timeMs,extraInfo:x.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,t,r){const s=II(e);if(s!=null){const i=s.inputsToSave||[],a=s.outputsToSave||[];let o;s.saveAllInputs?(fe(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(c=>t[c])):o=i.map(c=>t[c]);const l=r.filter((c,u)=>a[u]);return o.concat(l)}return[]}makeTensor(e,t,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&jd(e[0])&&(i=e.map(l=>ub(l)));const a=s.write(i,t,r),o=new ss(t,r,a,this.nextTensorId());if(this.trackTensor(o,s),r==="string"){const l=this.state.tensorInfo.get(a),c=$U(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(e,t,r,s){r=r||"float32";const i={dataId:e,shape:t,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:s,dtype:i}=e,a=new ss(s,i,r,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new b1(e,t,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*TI(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof b1||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*TI(e.dtype);this.state.numBytes-=r}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,r,s,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:i},l=II(e);l!=null&&(s=l.gradFunc),s!=null&&(o.gradient=c=>(c=c.map((u,d)=>{if(u==null){const p=r[d],x=zS(p.size,p.dtype);return this.makeTensor(x,p.shape,p.dtype)}return u}),s(c.length>1?c:c[0],i,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=_R(e),r=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const a=this.state.activeScope.track[i];!a.kept&&!r.has(a.id)&&a.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,t,r,s=!1){if(fe(t.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));fe(i instanceof ss,()=>"The result y returned by f() must be a tensor.");const a=dye(this.state.activeTape,t,i);if(!s&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[i.id]=r??Sye(i.shape),fye(o,a,c=>this.tidy(c),Tye);const l=t.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return fe(pf(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{fe(t.every(o=>o instanceof ss),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};t.forEach((o,l)=>{s[l]=o});const i=(o,l)=>(r=e(...t,l),fe(r.value instanceof ss,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),fe(pf(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),a=(o,l)=>{const c=r.gradFunc(o,l),u=Array.isArray(c)?c:[c];fe(u.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),fe(u.every(p=>p instanceof ss),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((p,x)=>{d[x]=()=>p}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:a,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=y1(),r=await this.backend.time(e);return r.wallMs=y1()-t,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new bF;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};wR.nextTensorId=0;wR.nextVariableId=0;function Sye(n){const e=hR(Hr(n),"float32");return be.makeTensor(e,n,"float32")}function DW(){const n=FU();if(n._tfengine==null){const e=new MU(n);n._tfengine=new wR(e)}return Nxe(n._tfengine.ENV),gye(()=>n._tfengine),n._tfengine}const be=DW();function Tye(n,e){const t={a:n,b:e};return be.runKernel(mR,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cye(){return typeof navigator<"u"&&navigator!=null}let FI;function Aye(n){FI=n}function Nye(n){if(FI!==void 0)return FI;if(n||Cye()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function $W(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const kye=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:$W,isMobile:Nye,mockIsMobile:Aye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _o=ln();_o.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});_o.registerFlag("IS_BROWSER",()=>$W());_o.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");_o.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));_o.registerFlag("PROD",()=>!1);_o.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>_o.getBool("DEBUG"));_o.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);_o.registerFlag("IS_TEST",()=>!1);_o.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);_o.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);_o.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);_o.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);_o.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vu(n,e){let t=n;if(qi(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(t)||qi(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&ln().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&LW(n,r,[]),r}function LW(n,e,t){if(t=t||[],!Array.isArray(n)&&!qi(n)){fe(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}fe(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),fe(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const r=e.slice(1);for(let s=0;s<n.length;++s)LW(n[s],r,t.concat(s))}function vF(n,e,t,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${r}' must be ${n} tensor, but got ${e} tensor`)}}function ce(n,e,t,r="numeric"){if(n instanceof ss)return vF(r,n.dtype,e,t),n;let s=BS(n);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),vF(r,s,e,t),n==null||!qi(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const i=vu(n,s);!qi(n)&&!Array.isArray(n)&&(n=[n]);const o=s!=="string"?jS(n,s):nm(n,[],!0);return be.makeTensor(o,i,s)}function v1(n,e,t,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,a)=>ce(i,`${e}[${a}]`,t,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ER="__op";function ye(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+ER;const s=(...i)=>{be.startScope(t);try{const a=r(...i);return rm(a)&&console.error("Cannot return a Promise inside of tidy."),be.endScope(a),a}catch(a){throw be.endScope(null),a}};return Object.defineProperty(s,"name",{value:t,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iye(n,e){const t=ce(n,"real","complex"),r=ce(e,"imag","complex");Da(t.shape,r.shape,`real and imag shapes, ${t.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:t,imag:r};return be.runKernel(aG,s)}const Nh=ye({complex_:Iye});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function If(n,e,t,r){if(r==null&&(r=BS(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!qi(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){dR(e);const s=Hr(e),i=Hr(t);fe(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let a=0;a<t.length;++a){const o=t[a],l=a===t.length-1?o!==Hr(e.slice(a)):!0;fe(t[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!qi(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=r!=="string"?jS(n,r):nm(n,[],!0),be.makeTensor(n,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hc(n,e,t){const r=vu(n,t);return If(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BI={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EE=4;async function Rye(n,e){const t=[],r=[],s=Array.isArray(n)?n.map(a=>a.name):Object.keys(n);for(let a=0;a<s.length;++a){const o=s[a],l=Array.isArray(n)?n[a].tensor:n[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const p=await l.bytes(),x=p.reduce((b,S)=>b+S.length,0)+EE*p.length,y=new Uint8Array(x);let v=0;for(let b=0;b<p.length;b++){const S=p[b],T=new Uint8Array(new Uint32Array([S.length]).buffer);y.set(T,v),v+=EE,y.set(S,v),v+=S.length}d(y)});r.push(u)}else r.push(l.data());e!=null&&(c.group=e),t.push(c)}const i=await Promise.all(r);return{data:Dye(i),specs:t}}function PW(n,e){const t={};let r,s=0;for(const i of e){const a=i.name,o=i.dtype,l=i.shape,c=Hr(l);let u;if("quantization"in i){const d=i.quantization;if(d.dtype==="uint8"||d.dtype==="uint16"){if(!("min"in d&&"scale"in d))throw new Error(`Weight ${i.name} with quantization ${d.dtype} doesn't have corresponding metadata min and scale.`)}else if(d.dtype==="float16"){if(o!=="float32")throw new Error(`Weight ${i.name} is quantized with ${d.dtype} which only supports weights of type float32 not ${o}.`)}else throw new Error(`Weight ${i.name} has unknown quantization dtype ${d.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const p=BI[d.dtype],x=n.slice(s,s+c*p),y=d.dtype==="uint8"?new Uint8Array(x):new Uint16Array(x);if(o==="float32")if(d.dtype==="uint8"||d.dtype==="uint16"){u=new Float32Array(y.length);for(let v=0;v<y.length;v++){const b=y[v];u[v]=b*d.scale+d.min}}else if(d.dtype==="float16")r===void 0&&(r=Fye()),u=r(y);else throw new Error(`Unsupported quantization type ${d.dtype} for weight type float32.`);else if(o==="int32"){if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error(`Unsupported quantization type ${d.dtype} for weight type int32.`);u=new Int32Array(y.length);for(let v=0;v<y.length;v++){const b=y[v];u[v]=Math.round(b*d.scale+d.min)}}else throw new Error(`Unsupported dtype in weight '${a}': ${o}`);s+=c*p}else if(o==="string"){const d=Hr(i.shape);u=[];for(let p=0;p<d;p++){const x=new Uint32Array(n.slice(s,s+EE))[0];s+=EE;const y=new Uint8Array(n.slice(s,s+x));u.push(y),s+=x}}else{const d=BI[o],p=n.slice(s,s+c*d);if(o==="float32")u=new Float32Array(p);else if(o==="int32")u=new Int32Array(p);else if(o==="bool")u=new Uint8Array(p);else if(o==="complex64"){u=new Float32Array(p);const x=new Float32Array(u.length/2),y=new Float32Array(u.length/2);for(let S=0;S<x.length;S++)x[S]=u[S*2],y[S]=u[S*2+1];const v=hc(x,l,"float32"),b=hc(y,l,"float32");t[a]=Nh(v,b),v.dispose(),b.dispose()}else throw new Error(`Unsupported dtype in weight '${a}': ${o}`);s+=c*d}o!=="complex64"&&(t[a]=hc(u,l,o))}return t}function Dye(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return t.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const SR=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function _F(n){return SR?Buffer.byteLength(n):new Blob([n]).size}function $ye(n){if(SR)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let r=0,s=e.length;r<s;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function Lye(n){if(SR){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t.set([e.charCodeAt(r)],r);return t.buffer}function TR(n){if(n.length===1)return n[0];let e=0;n.forEach(s=>{e+=s.byteLength});const t=new Uint8Array(e);let r=0;return n.forEach(s=>{t.set(new Uint8Array(s),r),r+=s.byteLength}),t.buffer}function wF(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);const t=n.split("/");return t[t.length-1]}function OW(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function MW(n,e,t){const r={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(r.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=t}return n.signature!=null&&(r.signature=n.signature),n.userDefinedMetadata!=null&&(r.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(r.modelInitializer=n.modelInitializer),r}async function CR(n,e){let t,r;return n.weightsManifest!=null&&([t,r]=await e(n.weightsManifest)),MW(n,t,r)}function hb(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:_F(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:_F(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}function FW(n){const e=[];for(const t of n)e.push(...t.weights);return e}function Pye(){const n=t=>{let r=t<<13,s=0;for(;(r&8388608)===0;)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function Oye(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function Mye(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function Fye(){const n=Pye(),e=Oye(),t=Mye();return r=>{const s=new ArrayBuffer(4*r.length),i=new Uint32Array(s);for(let a=0;a<r.length;a++){const o=r[a],l=n[t[o>>10]+(o&1023)]+e[o>>10];i[a]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let el=class ec{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return ec.instance==null&&(ec.instance=new ec),ec.instance}static registerSaveRouter(e){ec.getInstance().saveRouters.push(e)}static registerLoadRouter(e){ec.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return ec.getHandlers(e,"save")}static getLoadHandlers(e,t){return ec.getHandlers(e,"load",t)}static getHandlers(e,t,r){const s=[];return(t==="load"?ec.getInstance().loadRouters:ec.getInstance().saveRouters).forEach(a=>{const o=a(e,r);o!==null&&s.push(o)}),s}};const Bye=n=>el.registerSaveRouter(n),zye=n=>el.registerLoadRouter(n),jye=n=>el.getSaveHandlers(n),Vye=(n,e)=>el.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zI="tensorflowjs",jI=1,Rp="models_store",Vd="model_info_store";function BW(){if(!ln().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function VI(n){const e=n.result;e.createObjectStore(Rp,{keyPath:"modelPath"}),e.createObjectStore(Vd,{keyPath:"modelPath"})}let sm=class{constructor(e){if(this.indexedDB=BW(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,s)=>{const i=this.indexedDB.open(zI,jI);i.onupgradeneeded=()=>VI(i),i.onsuccess=()=>{const a=i.result;if(t==null){const o=a.transaction(Rp,"readonly"),c=o.objectStore(Rp).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=u=>(a.close(),s(c.error)),o.oncomplete=()=>a.close()}else{const o=hb(t),l=a.transaction(Vd,"readwrite");let c=l.objectStore(Vd);const u=c.put({modelPath:this.modelPath,modelArtifactsInfo:o});let d;u.onsuccess=()=>{d=a.transaction(Rp,"readwrite");const x=d.objectStore(Rp).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o});x.onsuccess=()=>r({modelArtifactsInfo:o}),x.onerror=y=>{c=l.objectStore(Vd);const v=c.delete(this.modelPath);v.onsuccess=()=>(a.close(),s(x.error)),v.onerror=b=>(a.close(),s(x.error))}},u.onerror=p=>(a.close(),s(u.error)),l.oncomplete=()=>{d==null?a.close():d.oncomplete=()=>a.close()}}},i.onerror=a=>s(i.error)})}};sm.URL_SCHEME="indexeddb://";const zW=n=>ln().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(sm.URL_SCHEME)?Uye(n.slice(sm.URL_SCHEME.length)):null;el.registerSaveRouter(zW);el.registerLoadRouter(zW);function Uye(n){return new sm(n)}function Gye(n){return n.startsWith(sm.URL_SCHEME)?n.slice(sm.URL_SCHEME.length):n}let Hye=class{constructor(){this.indexedDB=BW()}async listModels(){return new Promise((e,t)=>{const r=this.indexedDB.open(zI,jI);r.onupgradeneeded=()=>VI(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(Vd,"readonly"),o=i.objectStore(Vd).getAll();o.onsuccess=()=>{const l={};for(const c of o.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},o.onerror=l=>(s.close(),t(o.error)),i.oncomplete=()=>s.close()},r.onerror=s=>t(r.error)})}async removeModel(e){return e=Gye(e),new Promise((t,r)=>{const s=this.indexedDB.open(zI,jI);s.onupgradeneeded=()=>VI(s),s.onsuccess=()=>{const i=s.result,a=i.transaction(Vd,"readwrite"),o=a.objectStore(Vd),l=o.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=o.delete(e),d=()=>{c=i.transaction(Rp,"readwrite");const x=c.objectStore(Rp).delete(e);x.onsuccess=()=>t(l.result.modelArtifactsInfo),x.onerror=y=>r(l.error)};u.onsuccess=d,u.onerror=p=>(d(),i.close(),r(l.error))}},l.onerror=u=>(i.close(),r(l.error)),a.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uh="/",O0="tensorflowjs_models",jW="info",Wye="model_topology",qye="weight_specs",Kye="weight_data",Xye="model_metadata";function VW(n){return{info:[O0,n,jW].join(uh),topology:[O0,n,Wye].join(uh),weightSpecs:[O0,n,qye].join(uh),weightData:[O0,n,Kye].join(uh),modelMetadata:[O0,n,Xye].join(uh)}}function UW(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function Yye(n){const e=n.split(uh);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(uh)}function Zye(n){return n.startsWith(im.URL_SCHEME)?n.slice(im.URL_SCHEME.length):n}let im=class{constructor(e){if(!ln().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=VW(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=hb(e);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,$ye(e.weightData));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:s}}catch{throw UW(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const o=JSON.parse(i);t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,o.signature!=null&&(t.signature=o.signature),o.userDefinedMetadata!=null&&(t.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(t.modelInitializer=o.modelInitializer),o.trainingConfig!=null&&(t.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=Lye(a),t}};im.URL_SCHEME="localstorage://";const GW=n=>ln().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(im.URL_SCHEME)?Qye(n.slice(im.URL_SCHEME.length)):null;el.registerSaveRouter(GW);el.registerLoadRouter(GW);function Qye(n){return new im(n)}let Jye=class{constructor(){fe(ln().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),fe(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=O0+uh,r=uh+jW;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(t)&&i.endsWith(r)){const a=Yye(i);e[a]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=Zye(e);const t=VW(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(t.info));return UW(t),r}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tg="://";let mf=class kd{constructor(){this.managers={}}static getInstance(){return kd.instance==null&&(kd.instance=new kd),kd.instance}static registerManager(e,t){fe(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(tg)&&(e=e.slice(0,e.indexOf(tg))),fe(e.length>0,()=>"scheme must not be an empty string.");const r=kd.getInstance();fe(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=t}static getManager(e){const t=kd.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(kd.getInstance().managers)}};function qw(n){if(n.indexOf(tg)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${mf.getSchemes().join(",")}`);return{scheme:n.split(tg)[0],path:n.split(tg)[1]}}async function HW(n,e,t=!1){fe(n!==e,()=>`Old path and new path are the same: '${n}'`);const r=el.getLoadHandlers(n);fe(r.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),fe(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${n}.`);const s=r[0],i=el.getSaveHandlers(e);fe(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),fe(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const a=i[0],o=qw(n).scheme,l=qw(n).path,c=o===qw(n).scheme,u=await s.load();t&&c&&await mf.getManager(o).removeModel(l);const d=await a.save(u);return t&&!c&&await mf.getManager(o).removeModel(l),d.modelArtifactsInfo}async function e1e(){const n=mf.getSchemes(),e={};for(const t of n){const r=await mf.getManager(t).listModels();for(const s in r){const i=t+tg+s;e[i]=r[s]}}return e}async function t1e(n){const e=qw(n);return mf.getManager(e.scheme).removeModel(e.path)}async function n1e(n,e){return HW(n,e,!1)}async function r1e(n,e){return HW(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let s1e=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(!window||!ln().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}};if(ln().get("IS_BROWSER")){ln().setPlatform("browser",new s1e);try{mf.registerManager(im.URL_SCHEME,new Jye)}catch{}try{mf.registerManager(sm.URL_SCHEME,new Hye)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i1e={importFetch:()=>require("node-fetch")};let mk,a1e=class{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return ln().global.fetch!=null?ln().global.fetch(e,t):(mk==null&&(mk=i1e.importFetch()),mk(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}};ln().get("IS_NODE")&&!ln().get("IS_BROWSER")&&ln().setPlatform("node",new a1e);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xc(n,e="float32",t){return e=e||"float32",dR(n),new wE(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1e(n,e){const t=ce(n,"x","cast");if(!DU(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:t},s={dtype:e};return be.runKernel(gR,r,s)}const Qr=ye({cast_:o1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l1e(n){const t={x:ce(n,"x","clone","string_or_numeric")};return be.runKernel(xR,t)}const vh=ye({clone_:l1e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AR(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */DW();const c1e={buffer:xc,cast:Qr,clone:vh,print:AR};xye(c1e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u1e="model",h1e=".json",d1e=".weights.bin";function EF(n){return new Promise(e=>setTimeout(e)).then(n)}class am{constructor(e){if(!ln().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(am.URL_SCHEME)&&(e=e.slice(am.URL_SCHEME.length)),(e==null||e.length===0)&&(e=u1e),this.modelJsonFileName=e+h1e,this.weightDataFileName=e+d1e}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s=OW(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await EF(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const o=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;o.download=this.weightDataFileName,o.href=t,await EF(()=>o.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:hb(e)}}}}am.URL_SCHEME="downloads://";class f1e{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const r=new FileReader;r.onload=s=>{const i=JSON.parse(s.target.result),a=i.modelTopology;if(a==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:a});return}const l=CR(i,c=>this.loadWeights(c));e(l)},r.onerror=s=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const t=[],r=[];for(const a of e)t.push(...a.weights),r.push(...a.paths);const s=this.checkManifestAndWeightFiles(e),i=r.map(a=>this.loadWeightsFile(a,s[a]));return Promise.all(i).then(a=>[t,TR(a)])}loadWeightsFile(e,t){return new Promise((r,s)=>{const i=new FileReader;i.onload=a=>{const o=a.target.result;r(o)},i.onerror=a=>s(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],r=this.weightsFiles.map(i=>wF(i.name)),s={};for(const i of e)i.paths.forEach(a=>{const o=wF(a);if(t.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(t.push(o),r.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);s[a]=this.weightsFiles[r.indexOf(o)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const p1e=n=>ln().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(am.URL_SCHEME)?m1e(n.slice(am.URL_SCHEME.length)):null;el.registerSaveRouter(p1e);function m1e(n="model"){return new am(n)}function g1e(n){return new f1e(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SF(n,e,t,r){a(n),t=t??0,r=r??1,o(t,r);let s=0;const i=l=>(l.then(c=>{const u=t+ ++s/n.length*(r-t);return e(u),c}),l);function a(l){fe(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,c){fe(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),fe(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),fe(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(n.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function WW(n,e){e==null&&(e={});const t=e.fetchFunc==null?ln().platform.fetch:e.fetchFunc,r=n.map(d=>t(d,e.requestInit,{isBinary:!0})),o=(e.onProgress==null?await Promise.all(r):await SF(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(o):await SF(o,e.onProgress,.5,1)}async function x1e(n,e="",t,r){return qW(a=>WW(a,{requestInit:r}))(n,e,t)}function qW(n){return async(e,t="",r)=>{const s=e.map(()=>!1),i={},a=r!=null?r.map(()=>!1):[],o=[];if(e.forEach((x,y)=>{let v=0;x.weights.forEach(b=>{const S="quantization"in b?b.quantization.dtype:b.dtype,T=BI[S]*Hr(b.shape),C=()=>{s[y]=!0,i[y]==null&&(i[y]=[]),i[y].push({manifestEntry:b,groupOffset:v,sizeBytes:T})};r!=null?r.forEach((I,$)=>{I===b.name&&(C(),a[$]=!0)}):C(),o.push(b.name),v+=T})}),!a.every(x=>x)){const x=r.filter((y,v)=>!a[v]);throw new Error(`Could not find weights in manifest with names: ${x.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=s.reduce((x,y,v)=>(y&&x.push(v),x),[]),c=[];l.forEach(x=>{e[x].paths.forEach(y=>{const v=t+(t.endsWith("/")?"":"/")+y;c.push(v)})});const u=await n(c),d={};let p=0;return l.forEach(x=>{const y=e[x].paths.length;let v=0;for(let I=0;I<y;I++)v+=u[p+I].byteLength;const b=new ArrayBuffer(v),S=new Uint8Array(b);let T=0;for(let I=0;I<y;I++){const $=new Uint8Array(u[p+I]);S.set($,T),T+=$.byteLength}i[x].forEach(I=>{const $=b.slice(I.groupOffset,I.groupOffset+I.sizeBytes),q=PW($,[I.manifestEntry]);for(const U in q)d[U]=q[U]}),p+=y}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y1e="application/octet-stream",b1e="application/json";class NR{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(fe(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=ln().platform.fetch,fe(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&fe(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=OW(e,r);t.body.append("model.json",new Blob([JSON.stringify(s)],{type:b1e}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:y1e}),"model.weights.bin");const i=await this.fetch(this.path,t);if(i.ok)return{modelArtifactsInfo:hb(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const r=t.modelTopology,s=t.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return CR(t,i=>this.loadWeights(i))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=v1e(t),i=this.weightPathPrefix||r,a=FW(e),o=[],l=[];for(const u of e)for(const d of u.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(d)):o.push(i+d+s);this.weightUrlConverter&&o.push(...await Promise.all(l));const c=await WW(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,TR(c)]}}NR.URL_SCHEME_REGEX=/^https?:\/\//;function v1e(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),r=n.substring(0,e),s=t>e?n.substring(t):"";return[r+"/",s]}function UI(n){return n.match(NR.URL_SCHEME_REGEX)!=null}const KW=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(r=>UI(r)):t=UI(n),t)return kR(n,e)}return null};el.registerSaveRouter(KW);el.registerLoadRouter(KW);function kR(n,e){return new NR(n,e)}function _1e(n,e){return kR(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gk{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class XW{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class w1e{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function E1e(n,e,t,r){const s=arguments;return new w1e(YW(...s))}function YW(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new gk(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new gk({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new gk({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))}function S1e(n){return new XW(n)}function T1e(n){return new XW(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IR=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:g1e,browserHTTPRequest:_1e,concatenateArrayBuffers:TR,copyModel:n1e,decodeWeights:PW,encodeWeights:Rye,fromMemory:E1e,fromMemorySync:YW,getLoadHandlers:Vye,getModelArtifactsForJSON:CR,getModelArtifactsForJSONSync:MW,getModelArtifactsInfoForJSON:hb,getSaveHandlers:jye,getWeightSpecs:FW,http:kR,isHTTPScheme:UI,listModels:e1e,loadWeights:x1e,moveModel:r1e,registerLoadRouter:zye,registerSaveRouter:Bye,removeModel:t1e,weightsLoaderFactory:qW,withSaveHandler:S1e,withSaveHandlerSync:T1e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1e(n,e,t=!1,r=!1){let s=ce(n,"a","matMul"),i=ce(e,"b","matMul");[s,i]=as(s,i);const a={a:s,b:i},o={transposeA:t,transposeB:r};return be.runKernel(eG,a,o)}const yr=ye({matMul_:C1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1e(n,e,t=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:ce(n,"indices","oneHot","int32")},o={dtype:s,depth:e,onValue:t,offValue:r};return be.runKernel(EH,a,o)}const SE=ye({oneHot_:A1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1e(){ln().set("PROD",!0)}function k1e(){ln().set("DEBUG",!0)}function I1e(){ln().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function R1e(n){ln().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function D1e(){be.disposeVariables()}function $1e(){return be}function L1e(){return be.memory()}function P1e(n){return be.profile(n)}function ar(n,e){return be.tidy(n,e)}function Yi(n){_R(n).forEach(t=>t.dispose())}function eu(n){return be.keep(n)}function O1e(n){return be.time(n)}function M1e(n){return be.setBackend(n)}function F1e(){return be.ready()}function B1e(){return be.backendName}function z1e(n){be.removeBackend(n)}function j1e(n){return be.findBackend(n)}function V1e(n){return be.findBackendFactory(n)}function U1e(n,e,t=1){return be.registerBackend(n,e,t)}function G1e(){return be.backend}function H1e(n,e){ln().setPlatform(n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1e(n){const t={input:ce(n,"input","imag")};return be.runKernel(HG,t)}const db=ye({imag_:W1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q1e(n){const t={x:ce(n,"x","neg")};return be.runKernel(xH,t)}const cu=ye({neg_:q1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1e(n){const t={input:ce(n,"input","real")};return be.runKernel(DH,t)}const bg=ye({real_:K1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X1e(n,e,t){const r=ce(n,"x","transpose");if(e==null&&(e=r.shape.map((a,o)=>o).reverse()),fe(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(a=>{fe(a>=0&&a<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?ar(()=>{let a=bg(r),o=db(r);return a=be.runKernel(Hw,{x:a},i),o=be.runKernel(Hw,{x:o},i),t&&(o=cu(o)),Nh(a,o)}):be.runKernel(Hw,s,i)}const _1=ye({transpose_:X1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1e(n,e,t){const r=ce(n,"labels","confusionMatrix"),s=ce(e,"predictions","confusionMatrix");fe(t==null||t>0&&Number.isInteger(t),()=>`If provided, numClasses must be a positive integer, but got ${t}`),fe(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),fe(s.rank===1,()=>`Expected the rank of predictions to be 1, but got ${s.rank}`),fe(r.shape[0]===s.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${s.shape[0]}. Labels and predictions should have the same number of elements.`),fe(t>0&&Number.isInteger(t),()=>`numClasses is required to be a positive integer, but got ${t}`);const i=SE(Qr(r,"int32"),t),a=SE(Qr(s,"int32"),t),o=_1(i),l=yr(o,a);return Qr(l,"int32")}const Z1e=ye({confusionMatrix_:Y1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q1e=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:Z1e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(n,e){const t=n.length,r=[];for(let s=0;s<t;s++){const i=t-1-s,a=n[i]||1;(e[e.length-1-s]||1)>1&&a===1&&r.unshift(i)}return r}function RR(n,e){const t=[];for(let r=0;r<e.length;r++){const s=n[n.length-r-1],i=e.length-r-1,a=e[i];(s==null||s===1&&a>1)&&t.unshift(i)}return t}function Vs(n,e){const t=[],r=Math.max(n.length,e.length);for(let s=0;s<r;s++){let i=n[n.length-s-1];i==null&&(i=1);let a=e[e.length-s-1];if(a==null&&(a=1),i===1)t.unshift(a);else if(a===1)t.unshift(i);else if(i!==a){const o=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(o)}else t.unshift(i)}return t}const J1e=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Vs,getBroadcastDims:ZW,getReductionAxes:RR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DR(n,e,t){if(Im(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=vu(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return If(n,e,r,t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xp;function QW(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,r=!1,s=!1,i=!1,a=!1,o=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)i=!0;else if(n.getContext!=null)a=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(bE(CI,be.backendName)!=null){const y={pixels:n},v={numChannels:e};return be.runKernel(CI,y,v)}const[c,u]=s?[n.videoWidth,n.videoHeight]:[n.width,n.height];let d;if(a)d=n.getContext("2d").getImageData(0,0,c,u).data;else if(r||t)d=n.data;else if(i||s||o){if(xp==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")xp=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else xp=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});xp.canvas.width=c,xp.canvas.height=u,xp.drawImage(n,0,0,c,u),d=xp.getImageData(0,0,c,u).data}let p;if(e===4)p=new Int32Array(d);else{const y=c*u;p=new Int32Array(y*e);for(let v=0;v<y;v++)for(let b=0;b<e;++b)p[v*e+b]=d[v*4+b]}return DR(p,[u,c,e],"int32")}function ebe(n){return n!=null&&n.data instanceof Uint8Array}function tbe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function nbe(n){return n!=null&&n.width!==0&&n.height!==0}function rbe(n){return tbe()&&!(n instanceof ImageBitmap)&&nbe(n)&&!ebe(n)}async function sbe(n,e=3){let t=null;if(ln().getBool("WRAP_TO_IMAGEBITMAP")&&rbe(n)){let r;try{r=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===n.width&&r.height===n.height?t=r:t=n}else t=n;return QW(t,e)}async function JW(n,e){let t=ce(n,"img","toPixels");if(!(n instanceof ss)){const c=t;t=Qr(c,"int32"),c.dispose()}if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const[r,s]=t.shape.slice(0,2),i=t.rank===2?1:t.shape[2];if(i>4||i===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${i}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`);const a=await t.data(),o=t.dtype==="float32"?255:1,l=new Uint8ClampedArray(s*r*4);for(let c=0;c<r*s;++c){const u=[0,0,0,255];for(let p=0;p<i;p++){const x=a[c*i+p];if(t.dtype==="float32"){if(x<0||x>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${x}.`)}else if(t.dtype==="int32"&&(x<0||x>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${x}.`);i===1?(u[0]=x*o,u[1]=x*o,u[2]=x*o):u[p]=x*o}const d=c*4;l[d+0]=Math.round(u[0]),l[d+1]=Math.round(u[1]),l[d+2]=Math.round(u[2]),l[d+3]=Math.round(u[3])}if(e!=null){e.width=s,e.height=r;const c=e.getContext("2d"),u=new ImageData(l,s,r);c.putImageData(u,0,0)}return t!==n&&t.dispose(),l}const eq=ye({fromPixels_:QW}),ibe=Object.freeze(Object.defineProperty({__proto__:null,fromPixels:eq,fromPixelsAsync:sbe,toPixels:JW},Symbol.toStringTag,{value:"Module"}));function tq(n,e){const t=n.shape.length,r=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${t}`);if(Hr(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const s=e.shape,i=s[s.length-1];let a=1;for(let d=0;d<s.length-1;++d)a*=s[d];const o=n.shape,l=s.slice();l.pop();let c=1;for(let d=i;d<t;++d)c*=o[d],l.push(o[d]);const u=[...Xg(n.shape).map(d=>d/c),1].slice(0,i);return[l,a,c,u]}const abe=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:tq},Symbol.toStringTag,{value:"Module"}));function $R(n,e,t){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${s}.`;if(t.rank<s)throw new Error(i+` update.rank < ${s}. `);if(n.length<r+(t.rank-s))throw new Error(i+` Output shape length < ${r+(t.rank-s)}`);if(t.rank!==s+n.length-r)throw new Error(i+` update.rank != ${s+n.length-r}`);for(let a=0;a<s;++a)if(t.shape[a]!==e.shape[a])throw new Error(i+` updates.shape[${a}] (${t.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<t.rank-s;++a)if(t.shape[a+s]!==n[a+r])throw new Error(i+` updates.shape[${a+s}] (${t.shape[a+s]}) != shape[${a+s}] (${n[a+s]})`)}function LR(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}$R(t,e,n)}function nq(n,e,t){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=t.length;let a=1;for(let d=s;d<i;++d)a*=t[d];const o=s<1?1:s,l=Hr(e.shape)/o,c=[...Xg(t.slice(0,s)),1],u=Hr(t);return{sliceRank:s,numUpdates:l,sliceSize:a,strides:c,outputSize:u}}const obe=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:nq,validateInput:LR,validateUpdateShape:$R},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GI=-2,lbe=-1;function cbe(n,e,t){const r=n.shape.length;fe(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),fe(r===t.length,()=>`Error in slice${r}D: Length of size ${t} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)fe(e[s]+t[s]<=n.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+t[s]}) would overflow input.shape[${s}] (${n.shape[s]})`)}function ube(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function hbe(n,e,t){const r=[];for(let s=0;s<n.length;s++)r[s]=Math.ceil((e[s]-n[s])/t[s]);return r}function rq(n,e,t,r){const s=[...n];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<t;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function sq(n,e,t){return t<=n?t:t-(e-1)}function iq(n,e){const t=[];for(let r=0;r<n;r++)t.push(e+r);return t}function dbe(n,e,t,r,s,i,a,o,l){const c=n.length;let u=new Array(c),d=new Array(c),p=new Array(c);if(e.length&&t>0){const x=e[0],y=t+1;u=aq(a,x,y,r,n),d=oq(o,x,y,s,n),p=rq(i,x,y,n)}else for(let x=0;x<c;x++)u[x]=cq(a,r,i,n,x,l),d[x]=uq(o,s,i,n,x,l),p[x]=lq(i,x,l);return{begin:u,end:d,strides:p}}function aq(n,e,t,r,s){const i=[...s],a=iq(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=0;else{const l=sq(e,t,o);let c=r[l];n&1<<l&&(c=0),i[o]=c}return i}function oq(n,e,t,r,s){const i=[...s],a=iq(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{const l=sq(e,t,o);let c=r[l];n&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[o]=c}for(let o=0;o<i.length;o++){const l=s[o];i[o]<0&&(i[o]+=l),i[o]=g1(0,i[o],s[o])}return i}function lq(n,e,t){let r=n[e];return(t&1<<e||r==null)&&(r=1),r}function cq(n,e,t,r,s,i){let a=e[s];const o=t[s]||1;(n&1<<s||i&1<<s||a==null)&&(o>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=r[s];return a<0&&(a+=l),a=g1(0,a,l-1),a}function uq(n,e,t,r,s,i){let a=e[s];const o=t[s]||1;(n&1<<s||i&1<<s||a==null)&&(o>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=r[s];return a<0&&(a+=l),o>0?a=g1(0,a,l):a=g1(-1,a,l-1),a}function fbe(n,e,t){let r=t.length;for(let s=0;s<t.length;s++)if(t[s]>1){r=s;break}for(let s=r+1;s<t.length;s++)if(e[s]>0||t[s]!==n[s])return!1;return!0}function pbe(n,e){let t=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function mbe(n,e,t){let r;const s=n.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(a=>{fe(a!==-1,()=>"slice() does not support negative begin indexing.")});let i;return t==null?i=new Array(s).fill(-1):typeof t=="number"?i=[t,...new Array(s-1).fill(-1)]:t.length<s?i=t.concat(new Array(s-t.length).fill(-1)):i=t,i=i.map((a,o)=>a>=0?a:(fe(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${o}.`),n.shape[o]-r[o])),[r,i]}function gbe(n,e,t,r,s,i,a,o,l){let c;if(r==null?(c=new Array(e.length),c.fill(1)):c=r,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:c.slice(),beginMask:s,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};for(let C=0;C<d.dims;C++)u&&(1<<C&o)!==0&&d.numAddAxisAfterEllipsis++,1<<C&a&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};xbe(d,p);let x=!0,y=!0,v=!0;const b=[],S=[];for(let C=0;C<n.length;++C){if(p.strides[C]===0)throw Error(`strides[${C}] must be non-zero`);const I=!!(p.shrinkAxisMask&1<<C),$=n[C];if($===-1){b.push(I?1:-1);continue}const q=[p.beginMask&1<<C,p.endMask&1<<C],U=[p.strides[C]>0?0:-1,p.strides[C]>0?$:$-1];if(I&&p.strides[C]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&p.strides[C]===1;const F=!!(p.beginMask&1<<C&&p.endMask&1<<C);if(p.beginValid&&p.endValid){if(I){const K=p.begin[C]<0?$+p.begin[C]:p.begin[C];if(p.begin[C]=K,p.end[C]=p.begin[C]+1,K<0||K>=$)throw Error(`slice index ${p.begin[C]} of dimension ${C} out of bounds.`)}else p.begin[C]=TF(p.begin[C],0,p.strides[C],$,q,U),p.end[C]=TF(p.end[C],1,p.strides[C],$,q,U);const O=p.strides[C]===1&&p.begin[C]===0&&p.end[C]===$;x=x&&O,y=y&&(C===0&&p.strides[C]===1||O)}else x=x&&p.strides[C]===1&&F,y=y&&(C===0&&p.strides[C]===1||F);let G,V=!1;if(p.beginValid&&p.endValid?(G=p.end[C]-p.begin[C],V=!0):I?(G=1,V=!0):F&&$>=0&&(p.strides[C]<0?G=-$:G=$,V=!0),V){let O;G===0||G<0!=p.strides[C]<0?O=0:O=Math.trunc(G/p.strides[C])+(G%p.strides[C]!==0?1:0),b.push(O)}else b.push(-1)}for(let C=0;C<p.finalShapeGatherIndices.length;++C){const I=p.finalShapeGatherIndices[C];I>=0?S.push(b[I]):I===GI&&S.push(1)}return{finalShapeSparse:S.filter((C,I)=>p.finalShapeGatherIndices[I]!==GI),finalShape:S,isIdentity:x,sliceDim0:y,isSimpleSlice:v,begin:p.begin,end:p.end,strides:p.strides}}function xbe(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const s=Math.min(e.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<s;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=r}else if(1<<r&n.newAxisMask)e.finalShapeGatherIndices.push(GI),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[r]),n.end!=null&&(e.end[t]=n.end[r]),e.strides[t]=n.strides[r],n.beginMask&1<<r&&(e.beginMask|=1<<t),n.endMask&1<<r&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(lbe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[t]=r,t++}}function TF(n,e,t,r,s,i){if(s[e])return t>0?i[e]:i[e+1&1];{const a=n<0?r+n:n;return a<i[0]?i[0]:a>i[1]?i[1]:a}}const hq=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:cbe,computeFlatOffset:pbe,computeOutShape:hbe,getNormalizedAxes:dbe,isSliceContinous:fbe,maskToAxes:ube,parseSliceParams:mbe,sliceInfo:gbe,startForAxis:cq,startIndicesWithElidedDims:aq,stopForAxis:uq,stopIndicesWithElidedDims:oq,stridesForAxis:lq,stridesWithElidedDims:rq},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let dq=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},fq=class M0{constructor(){this.classNameMap={}}static getMap(){return M0.instance==null&&(M0.instance=new M0),M0.instance}static register(e){M0.getMap().classNameMap[e.className]=[e,e.fromConfig]}};function Rf(n){fe(n.className!=null,()=>"Class being registered does not have the static className property defined."),fe(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),fe(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),fq.register(n)}const ybe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:dq,SerializationMap:fq,registerClass:Rf},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bbe=.001,pq=.1;function vbe(n,e,t){return t==null&&(t=PR()),HI(n,e,(r,s)=>OR(r,s,t))}function PR(){return be.backend.floatPrecision()===32?bbe:pq}function HI(n,e,t){let r=!0;if((qi(n)||qi(e))&&(r=!1),qi(n)&&qi(e)&&(r=!0),r){const a=n.constructor.name,o=e.constructor.name;if(a!==o)throw new Error(`Arrays are of different type. Actual: ${a}. Expected: ${o}`)}if(Array.isArray(n)&&Array.isArray(e)){const a=vu(n),o=vu(e);if(!bu(a,o))throw new Error(`Arrays have different shapes. Actual: [${a}]. Expected: [${o}]`)}const s=qi(n)?n:nm(n),i=qi(e)?e:nm(e);if(s.length!==i.length)throw new Error(`Arrays have different lengths actual: ${s.length} vs expected: ${i.length}.
Actual:   ${s}.
Expected: ${i}.`);for(let a=0;a<i.length;++a){const o=s[a],l=i[a];if(!t(o,l))throw new Error(`Arrays differ: actual[${a}] = ${o}, expected[${a}] = ${l}.
Actual:   ${s}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function _be(n,e){n().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function wbe(n,e){const t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return jd(n)||jd(n[0])||jd(e)||jd(e[0])?HI(n,t,(r,s)=>r==s):HI(n,e,(r,s)=>OR(r,s,0))}function Ebe(n,e,t){if(t==null&&(t=PR()),!OR(n,e,t))throw new Error(`Numbers differ: actual === ${n}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function OR(n,e,t){return!isFinite(n)&&!isFinite(e)?!0:!(isNaN(n)||isNaN(e)||Math.abs(n-e)>t)}function Sbe(n,e,t){for(let r=0;r<n.length;r++)if(n[r]<e||n[r]>t)throw new Error(`Value out of range:${n[r]} low: ${e}, high: ${t}`)}function Tbe(n,e){const t=new Float32Array(n),r=new Float32Array(e);if(t.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${t.length}`);for(let s=0;s<r.length;s++)if(t[s]!==r[s])throw new Error(`Expected ArrayBuffer value at ${s} to be ${r[s]} but got ${t[s]} instead`)}function mq(n){for(let e=0;e<n.length;e++){const t=n[e];Array.isArray(t)?mq(t):n[e]=ub(t)}return n}function Cbe(n){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(n),new Promise(t=>{e.addEventListener("loadeddata",r=>t(e)),e.load()})}async function Abe(n){await n.play(),"requestVideoFrameCallback"in n&&await new Promise(e=>{n.requestVideoFrameCallback(e)})}const Nbe=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:pq,createVideoElement:Cbe,encodeStrings:mq,expectArrayBuffersEqual:Tbe,expectArraysClose:vbe,expectArraysEqual:wbe,expectNumbersClose:Ebe,expectPromiseToFail:_be,expectValuesInRange:Sbe,play:Abe,testEpsilon:PR},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const kbe="3.21.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ibe(n,e){let t=ce(n,"a","add"),r=ce(e,"b","add");[t,r]=as(t,r);const s={a:t,b:r};return be.runKernel(mR,s)}const Kt=ye({add_:Ibe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rbe(n,e){let t=ce(n,"a","floorDiv"),r=ce(e,"b","floorDiv");[t,r]=as(t,r);const s={a:t,b:r};return be.runKernel(FG,s)}const MR=ye({floorDiv_:Rbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dbe(n,e){let t=ce(n,"a","div"),r=ce(e,"b","div");if([t,r]=as(t,r),t.dtype==="int32"&&r.dtype==="int32")return MR(t,r);const s={a:t,b:r},i={};return be.runKernel(CG,s,i)}const Mr=ye({div_:Dbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $be(n,e){let t=ce(n,"a","mul"),r=ce(e,"b","mul");[t,r]=as(t,r);const s={a:t,b:r};return be.runKernel(gH,s)}const ut=ye({mul_:$be});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lbe(n){const e=ce(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return be.runKernel(oG,t)}else{const t={x:e};return be.runKernel(BU,t)}}const mo=ye({abs_:Lbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pbe(n){const t={x:ce(n,"x","acos")};return be.runKernel(zU,t)}const gq=ye({acos_:Pbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(n){const t={x:ce(n,"x","acosh")};return be.runKernel(jU,t)}const xq=ye({acosh_:Obe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mbe(n){fe(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),fe(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((s,i)=>ce(s,`tensors${i}`,"addN")),t=e[0];e.forEach(s=>{if(s.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!bu(s.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return be.runKernel(VU,r)}const yq=ye({addN_:Mbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbe(n,e=null,t=!1){const s={x:ce(n,"x","all","bool")},i={axis:e,keepDims:t};return be.runKernel(UU,s,i)}const bq=ye({all_:Fbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bbe(n,e=null,t=!1){const s={x:ce(n,"x","any","bool")},i={axis:e,keepDims:t};return be.runKernel(GU,s,i)}const vq=ye({any_:Bbe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zbe(n,e=0){const r={x:ce(n,"x","argMax")},s={axis:e};return be.runKernel(HU,r,s)}const _q=ye({argMax_:zbe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jbe(n,e=0){const r={x:ce(n,"x","argMin")},s={axis:e};return be.runKernel(WU,r,s)}const wq=ye({argMin_:jbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(n){const t={x:ce(n,"x","asin")};return be.runKernel(qU,t)}const Eq=ye({asin_:Vbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ube(n){const t={x:ce(n,"x","asinh")};return be.runKernel(KU,t)}const Sq=ye({asinh_:Ube});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gbe(n){const t={x:ce(n,"x","atan")};return be.runKernel(XU,t)}const Tq=ye({atan_:Gbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hbe(n,e){let t=ce(n,"a","atan2"),r=ce(e,"b","atan2");[t,r]=as(t,r);const s={a:t,b:r};return be.runKernel(ZU,s)}const Cq=ye({atan2_:Hbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(n){const t={x:ce(n,"x","atanh")};return be.runKernel(YU,t)}const Aq=ye({atanh_:Wbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qbe(n,e,t,r,s="NHWC",i){const a=n[3],o=[...e,a],l=Iq(s);return fb(n,o,t,i,r,null,null,l)}function Nq(n,e,t,r,s,i,a="channelsLast"){const[o,l]=TE(e);let c;if(a==="channelsLast")c=[o,l,n[3],n[3]];else if(a==="channelsFirst")c=[o,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return fb(n,c,t,r,s,i,!1,a)}function Kbe(n,e,t,r,s,i,a="NDHWC"){const[o,l,c]=WI(e);let u,d;if(a==="NDHWC")d="channelsLast",u=[o,l,c,n[4],n[4]];else if(a==="NCDHW")d="channelsFirst",u=[o,l,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return kq(n,u,t,r,s,!1,d,i)}function fb(n,e,t,r,s,i,a=!1,o="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d]=n;else if(o==="channelsFirst")[l,d,c,u]=n;else throw new Error(`Unknown dataFormat ${o}`);const[p,x,,y]=e,[v,b]=TE(t),[S,T]=TE(r),C=ng(p,S),I=ng(x,T),{padInfo:$,outHeight:q,outWidth:U}=Zbe(s,c,u,v,b,C,I,i,o),F=a?y*d:y;let G;return o==="channelsFirst"?G=[l,F,q,U]:o==="channelsLast"&&(G=[l,q,U,F]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:u,inChannels:d,outHeight:q,outWidth:U,outChannels:F,padInfo:$,strideHeight:v,strideWidth:b,filterHeight:p,filterWidth:x,effectiveFilterHeight:C,effectiveFilterWidth:I,dilationHeight:S,dilationWidth:T,inShape:n,outShape:G,filterShape:e}}function kq(n,e,t,r,s,i=!1,a="channelsLast",o){let[l,c,u,d,p]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d,p]=n;else if(a==="channelsFirst")[l,p,c,u,d]=n;else throw new Error(`Unknown dataFormat ${a}`);const[x,y,v,,b]=e,[S,T,C]=WI(t),[I,$,q]=WI(r),U=ng(x,I),F=ng(y,$),G=ng(v,q),{padInfo:V,outDepth:O,outHeight:K,outWidth:P}=Qbe(s,c,u,d,S,T,C,U,F,G,o),N=i?b*p:b;let M;return a==="channelsFirst"?M=[l,N,O,K,P]:a==="channelsLast"&&(M=[l,O,K,P,N]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:u,inWidth:d,inChannels:p,outDepth:O,outHeight:K,outWidth:P,outChannels:N,padInfo:V,strideDepth:S,strideHeight:T,strideWidth:C,filterDepth:x,filterHeight:y,filterWidth:v,effectiveFilterDepth:U,effectiveFilterHeight:F,effectiveFilterWidth:G,dilationDepth:I,dilationHeight:$,dilationWidth:q,inShape:n,outShape:M,filterShape:e}}function Xbe(n,e,t,r,s){r==null&&(r=FR(n,e,t));const i=n[0],a=n[1],o=Bp((i-e+2*r)/t+1,s),l=Bp((a-e+2*r)/t+1,s);return[o,l]}function Ybe(n,e,t,r,s,i){s==null&&(s=FR(n,e,r));const a=n[0],o=n[1],l=n[2],c=Bp((a-e+2*s)/r+1,i),u=Bp((o-e+2*s)/r+1,i),d=Bp((l-e+2*s)/r+1,i);return[c,u,d,t]}function FR(n,e,t,r=1){const s=ng(e,r);return Math.floor((n[0]*(t-1)-t+s)/2)}function TE(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function WI(n){return typeof n=="number"?[n,n,n]:n}function ng(n,e){return e<=1?n:n+(n-1)*(e-1)}function Zbe(n,e,t,r,s,i,a,o,l){let c,u,d;if(typeof n=="number"){c={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const x=Xbe([e,t],i,r,n,o);u=x[0],d=x[1]}else if(n==="same"){u=Math.ceil(e/r),d=Math.ceil(t/s);const p=Math.max(0,(u-1)*r+i-e),x=Math.max(0,(d-1)*s+a-t),y=Math.floor(p/2),v=p-y,b=Math.floor(x/2),S=x-b;c={top:y,bottom:v,left:b,right:S,type:"SAME"}}else if(n==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/r),d=Math.ceil((t-a+1)/s);else if(typeof n=="object"){const p=l==="channelsLast"?n[1][0]:n[2][0],x=l==="channelsLast"?n[1][1]:n[2][1],y=l==="channelsLast"?n[2][0]:n[3][0],v=l==="channelsLast"?n[2][1]:n[3][1];c={top:p,bottom:x,left:y,right:v,type:p===0&&x===0&&y===0&&v===0?"VALID":"EXPLICIT"},u=Bp((e-i+p+x)/r+1,o),d=Bp((t-a+y+v)/s+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:c,outHeight:u,outWidth:d}}function Qbe(n,e,t,r,s,i,a,o,l,c,u){let d,p,x,y;if(typeof n=="number"){d={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const b=Ybe([e,t,r,1],o,1,s,n,u);p=b[0],x=b[1],y=b[2]}else if(n==="same"){p=Math.ceil(e/s),x=Math.ceil(t/i),y=Math.ceil(r/a);const v=(p-1)*s+o-e,b=(x-1)*i+l-t,S=(y-1)*a+c-r,T=Math.floor(v/2),C=v-T,I=Math.floor(b/2),$=b-I,q=Math.floor(S/2),U=S-q;d={top:I,bottom:$,left:q,right:U,front:T,back:C,type:"SAME"}}else if(n==="valid")d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-o+1)/s),x=Math.ceil((t-l+1)/i),y=Math.ceil((r-c+1)/a);else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:d,outDepth:p,outHeight:x,outWidth:y}}function Bp(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function w1(n){const[e,t,r]=TE(n);return e===1&&t===1&&r===1}function Ph(n,e){return w1(n)||w1(e)}function Iq(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function Ol(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")fe(xg(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{fe(xg(s),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${s}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(n,e){const r={x:ce(n,"x","reshape","string_or_numeric")},s={shape:e};return be.runKernel(PH,r,s)}const Ye=ye({reshape_:Jbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eve(n,e,t,r,s){const i=ce(n,"x","avgPool","float32"),a=1;fe(Ph(t,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);let o=i,l=!1;i.rank===3&&(l=!0,o=Ye(i,[1,i.shape[0],i.shape[1],i.shape[2]])),fe(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),Ol("avgPool",r,s);const c={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s};let d=be.runKernel(QU,c,u);return d=Qr(d,i.dtype),l?Ye(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const BR=ye({avgPool_:eve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tve(n,e,t,r,s,i="NDHWC"){const a=ce(n,"x","avgPool3d","float32");let o=a,l=!1;a.rank===4&&(l=!0,o=Ye(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),fe(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),fe(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Ol("avgPool3d",r,s);const c={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i};let d=be.runKernel(JU,c,u);return d=Qr(d,o.dtype),l?Ye(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Rq=ye({avgPool3d_:tve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nve(n,e=0){fe(n.length>=1,()=>"Pass at least one tensor to concat");const t=v1(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return vh(t[0]);const r=t,s={axis:e};return be.runKernel(lG,r,s)}const Zi=ye({concat_:nve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rve(n){const t={x:ce(n,"x","sigmoid","float32")};return be.runKernel(YH,t)}const zp=ye({sigmoid_:rve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sve(n,e,t){const r=ce(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:t};return be.runKernel(WH,s,i)}const Ir=ye({slice_:sve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ive(n){const t={x:ce(n,"x","tanh","float32")};return be.runKernel(mW,t)}const CE=ye({tanh_:ive});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ave(n,e,t,r,s,i){const a=ce(n,"forgetBias","basicLSTMCell"),o=ce(e,"lstmKernel","basicLSTMCell"),l=ce(t,"lstmBias","basicLSTMCell"),c=ce(r,"data","basicLSTMCell"),u=ce(s,"c","basicLSTMCell"),d=ce(i,"h","basicLSTMCell"),p=Zi([c,d],1),x=yr(p,o),y=Kt(x,l),v=y.shape[0],b=y.shape[1]/4,S=[v,b],T=Ir(y,[0,0],S),C=Ir(y,[0,b],S),I=Ir(y,[0,b*2],S),$=Ir(y,[0,b*3],S),q=Kt(ut(zp(T),CE(C)),ut(u,zp(Kt(a,I)))),U=ut(CE(q),zp($));return[q,U]}const Dq=ye({basicLSTMCell_:ave});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ove(n,e,t){const r=ce(n,"x","batchToSpaceND"),s=e.reduce((o,l)=>o*l);fe(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),fe(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),fe(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},a={blockShape:e,crops:t};return be.runKernel(tG,i,a)}const zR=ye({batchToSpaceND_:ove});function lve(n){let e;return n.rank===0||n.rank===1?e=Ye(n,[1,1,1,n.size]):n.rank===2?e=Ye(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=Ye(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cve(n,e,t,r,s,i){i==null&&(i=.001);const a=ce(n,"x","batchNorm"),o=ce(e,"mean","batchNorm"),l=ce(t,"variance","batchNorm");let c;s!=null&&(c=ce(s,"scale","batchNorm"));let u;r!=null&&(u=ce(r,"offset","batchNorm")),fe(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),fe(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),fe(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:lve(a),scale:c,offset:u,mean:o,variance:l},x={varianceEpsilon:i},y=be.runKernel(BG,p,x);return Ye(y,a.shape)}const pb=ye({batchNorm_:cve});function uve(n,e,t,r,s,i){const a=ce(n,"x","batchNorm"),o=ce(e,"mean","batchNorm"),l=ce(t,"variance","batchNorm");let c;s!=null&&(c=ce(s,"scale","batchNorm"));let u;return r!=null&&(u=ce(r,"offset","batchNorm")),fe(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),fe(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),fe(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&fe(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&fe(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),pb(a,o,l,u,c,i)}const $q=ye({batchNorm2d_:uve});function hve(n,e,t,r,s,i){const a=ce(n,"x","batchNorm"),o=ce(e,"mean","batchNorm"),l=ce(t,"variance","batchNorm");let c;s!=null&&(c=ce(s,"scale","batchNorm"));let u;return r!=null&&(u=ce(r,"offset","batchNorm")),fe(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),fe(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),fe(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&fe(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&fe(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),pb(a,o,l,u,c,i)}const Lq=ye({batchNorm3d_:hve});function dve(n,e,t,r,s,i){const a=ce(n,"x","batchNorm"),o=ce(e,"mean","batchNorm"),l=ce(t,"variance","batchNorm");let c;s!=null&&(c=ce(s,"scale","batchNorm"));let u;return r!=null&&(u=ce(r,"offset","batchNorm")),fe(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),fe(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),fe(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&fe(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&fe(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),pb(a,o,l,u,c,i)}const Pq=ye({batchNorm4d_:dve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fve(n,e,t){const r=ce(n,"x","bincount"),s=ce(e,"weights","bincount");fe(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),fe(t>=0,()=>`size must be non-negative, but got ${t}.`),fe(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},a={size:t};return be.runKernel(nG,i,a)}const jR=ye({bincount_:fve});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pve(n,e){const t=ce(n,"s0","broadcastArgs","int32"),r=ce(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:t,s1:r};return be.runKernel(rG,s)}const Oq=ye({broadcastArgs_:pve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mve(n,e){let t=ce(n,"broadcastTo","x");const r=t.shape;if(e.some(c=>!(c>0)||c%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const c=t.shape.slice();for(;c.length<e.length;)c.unshift(1);t=Ye(t,c)}const s=t.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(s[c]===e[c])i[c]=1;else if(t.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return vh(t);const o={x:t},l={reps:i};return be.runKernel(yR,o,l)}const qy=ye({broadcastTo_:mve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gve(n){const t={x:ce(n,"x","ceil","float32")};return be.runKernel(sG,t)}const Mq=ye({ceil_:gve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yg(n,e,t){const r={shape:n,value:e,dtype:t};return be.runKernel(PG,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xve(n,e,t){const r=ce(n,"x","clipByValue");if(fe(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return Yg(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:t};return be.runKernel(iG,s,i)}const Fq=ye({clipByValue_:xve});function yve(n){return Zi(n,0)}const Bq=ye({concat1d_:yve});function bve(n,e){return Zi(n,e)}const zq=ye({concat2d_:bve});function vve(n,e){return Zi(n,e)}const jq=ye({concat3d_:vve});function _ve(n,e){return Zi(n,e)}const Vq=ye({concat4d_:_ve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wve(n,e,t,r,s="NHWC",i=[1,1],a){const o=ce(n,"x","conv2d","float32"),l=ce(e,"filter","conv2d","float32");let c=o,u=!1;o.rank===3&&(u=!0,c=Ye(o,[1,o.shape[0],o.shape[1],o.shape[2]])),fe(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),fe(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Ol("conv2d",r,a);const d=s==="NHWC"?c.shape[3]:c.shape[1];fe(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),fe(Ph(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const p={x:c,filter:l},x={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a},y=be.runKernel(cG,p,x);return u?Ye(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const mb=ye({conv2d_:wve});function Eve(n,e,t,r,s="NWC",i=1,a){const o=ce(n,"x","conv1d"),l=ce(e,"filter","conv1d");let c=o,u=!1;o.rank===2&&(u=!0,c=Ye(o,[1,o.shape[0],o.shape[1]])),fe(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),fe(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Ol("conv1d",r,a),fe(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),fe(Ph(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),fe(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=Ye(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=Ye(c,[c.shape[0],1,c.shape[1],c.shape[2]]),b=mb(p,d,[1,t],r,"NHWC",[1,i],a);return u?Ye(b,[b.shape[2],b.shape[3]]):Ye(b,[b.shape[0],b.shape[2],b.shape[3]])}const Uq=ye({conv1d_:Eve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sve(n,e,t,r,s,i="NHWC",a){fe(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,l=e,c=!1;e.rank===3&&(c=!0,l=Ye(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,n[0],n[1],n[2]]),fe(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),fe(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),fe(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const u=i==="NHWC"?o[3]:o[1],d=i==="NHWC"?l.shape[3]:l.shape[1];fe(u===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${t.shape[2]}.`),fe(d===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${t.shape[3]}.`),Ol("conv2dDerInput",s,a);const p={dy:l,filter:t},x={strides:r,pad:s,dataFormat:i,dimRoundingMode:a,inputShape:o},y=be.runKernel(hG,p,x);return c?Ye(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Gq=ye({conv2DBackpropInput_:Sve});function Tve(n,e,t,r,s,i){const a=ce(n,"x","conv2dTranspose"),o=ce(e,"filter","conv2dTranspose");return Gq(t,a,o,r,s,"NHWC",i)}const Hq=ye({conv2dTranspose_:Tve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cve(n,e,t,r,s="NDHWC",i=[1,1,1]){const a=ce(n,"x","conv3d"),o=ce(e,"filter","conv3d");let l=a,c=!1;a.rank===4&&(c=!0,l=Ye(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),fe(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),fe(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),fe(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),fe(Ph(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),fe(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`);const u={x:l,filter:o},d={strides:t,pad:r,dataFormat:s,dilations:i},p=be.runKernel(dG,u,d);return c?Ye(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const Wq=ye({conv3d_:Cve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ave(n,e,t,r,s){fe(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,a=e,o=!1;e.rank===4&&(o=!0,a=Ye(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const l=i[4],c=a.shape[4];fe(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),fe(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),fe(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),fe(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),fe(c===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${t.shape[4]}.`);const u={dy:a,filter:t},d={pad:s,strides:r,inputShape:i},p=be.runKernel(fG,u,d);return o?Ye(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const Nve=ye({conv3DBackpropInput_:Ave});function kve(n,e,t,r,s){const i=ce(n,"x","conv3dTranspose"),a=ce(e,"filter","conv3dTranspose");return Nve(t,i,a,r,s)}const qq=ye({conv3dTranspose_:kve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ive(n){const t={x:ce(n,"x","cos","float32")};return be.runKernel(pG,t)}const Kq=ye({cos_:Ive});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rve(n){const t={x:ce(n,"x","cosh","float32")};return be.runKernel(mG,t)}const Xq=ye({cosh_:Rve});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dve(n,e=0,t=!1,r=!1){const i={x:ce(n,"x","cumprod")},a={axis:e,exclusive:t,reverse:r};return be.runKernel(gG,i,a)}const Yq=ye({cumprod_:Dve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ve(n,e=0,t=!1,r=!1){const i={x:ce(n,"x","cumsum")},a={axis:e,exclusive:t,reverse:r};return be.runKernel(xG,i,a)}const Zq=ye({cumsum_:$ve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lve(n,e,t,r=!1){const s=ce(n,"x","denseBincount"),i=ce(e,"weights","denseBincount");fe(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),fe(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),fe(t>=0,()=>`size must be non-negative, but got ${t}.`),fe(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const a={x:s,weights:i},o={size:t,binaryOutput:r};return be.runKernel(bG,a,o)}const Qq=ye({denseBincount_:Lve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pve(n,e,t="NHWC"){const r=ce(n,"x","depthToSpace","float32"),s=t==="NHWC"?r.shape[1]:r.shape[2],i=t==="NHWC"?r.shape[2]:r.shape[3],a=t==="NHWC"?r.shape[3]:r.shape[1];fe(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),fe(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),fe(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),fe(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${r.shape}`);const o={x:r},l={blockSize:e,dataFormat:t};return be.runKernel(vG,o,l)}const Jq=ye({depthToSpace_:Pve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ove(n,e,t,r,s="NHWC",i=[1,1],a){const o=ce(n,"x","depthwiseConv2d","float32"),l=ce(e,"filter","depthwiseConv2d","float32");let c=o,u=!1;o.rank===3&&(u=!0,c=Ye(o,[1,o.shape[0],o.shape[1],o.shape[2]])),fe(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),fe(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?c.shape[3]:c.shape[1];fe(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Ol("depthwiseConv2d",r,a);const p={x:c,filter:l},x={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a},y=be.runKernel(_G,p,x);return u?Ye(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const US=ye({depthwiseConv2d_:Ove});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mve(n){const t={x:ce(n,"x","diag")};return be.runKernel(SG,t)}const eK=ye({diag_:Mve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fve(n,e,t,r,s=[1,1],i="NHWC"){const a=ce(n,"x","dilation2d"),o=ce(e,"filter","dilation2d");fe(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),fe(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),fe(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=a,c=!1;a.rank===3&&(l=Ye(a,[1,a.shape[0],a.shape[1],a.shape[2]]),c=!0);const u={x:l,filter:o},d={strides:t,pad:r,dilations:s},p=be.runKernel(TG,u,d);return c?Ye(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const tK=ye({dilation2d_:Fve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bve(n,e){let t=ce(n,"a","equal","string_or_numeric"),r=ce(e,"b","equal","string_or_numeric");[t,r]=as(t,r),Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(IG,s)}const VR=ye({equal_:Bve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zve(n,e,t){const r=ce(e,"a","where"),s=ce(t,"b","where"),i=ce(n,"condition","where","bool"),a=Vs(Vs(i.shape,r.shape),s.shape),o=qy(i,a),l=qy(r,a),c=qy(s,a),u={condition:o,t:l,e:c};return be.runKernel(GH,u)}const om=ye({where_:zve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jve(n){const t={x:ce(n,"x","zerosLike")};return be.runKernel(_W,t)}const vo=ye({zerosLike_:jve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(n,e){let t=ce(n,"a","div"),r=ce(e,"b","div");[t,r]=as(t,r);const s=Mr(t,r),i=vo(s),a=VR(r,i);return om(a,i,s)}const nK=ye({divNoNan_:Vve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uve(n,e){const t=ce(n,"t1","dot"),r=ce(e,"t2","dot");fe((t.rank===1||t.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${r.rank}.`);const s=t.rank===1?t.size:t.shape[1],i=r.rank===1?r.size:r.shape[0];if(fe(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),t.rank===1&&r.rank===1){const a=Ye(t,[1,-1]),o=Ye(r,[-1,1]),l=yr(a,o);return Ye(l,[])}else if(t.rank===1&&r.rank===2){const a=Ye(t,[1,-1]),o=Ye(r,[r.shape[0],r.shape[1]]),l=yr(a,o);return Ye(l,[l.size])}else if(t.rank===2&&r.rank===1){const a=Ye(r,[-1,1]),o=yr(t,a);return Ye(o,[o.size])}else{const a=Ye(r,[r.shape[0],r.shape[1]]);return yr(t,a)}}const rK=ye({dot_:Uve});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gve(n,...e){const t=e.map((s,i)=>ce(s,`tensors${i}`,"einsum")),r={equation:n};return be.runKernel(AG,t,r)}const sK=ye({einsum_:Gve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hve(n){const t={x:ce(n,"x","elu","float32")};return be.runKernel(NG,t)}const UR=ye({elu_:Hve});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wve(n){let e=ce(n,"x","erf");fe(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Qr(e,"float32"));const t={x:e};return be.runKernel(kG,t)}const iK=ye({erf_:Wve});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GR(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function aK(n,e,t){const r=n.length+e.length,s=[];let i=0,a=0;for(let o=0;o<r;o++)t.indexOf(o)===-1?s.push(n[i++]):s.push(e[a++]);return s}function qve(n,e){const t=[],r=n.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);const s=e.map(i=>n[i]);return[t,s]}function gb(n,e){const t=e.map(r=>1);return aK(n,t,e)}function Kve(n,e,t){fe(GR(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function Xve(n,e){if(GR(n,e))return null;const t=[];for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(r=>t.push(r)),t}function Yve(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Zve(n,e){const t=[];for(let r=e-n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qve(n,e=null,t=!1){const s={x:ce(n,"x","max")},i={reductionIndices:e,keepDims:t};return be.runKernel(iH,s,i)}const jp=ye({max_:Qve});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jve(n,e=null,t=!1){const s={x:ce(n,"x","min")},i={axis:e,keepDims:t};return be.runKernel(hH,s,i)}const AE=ye({min_:Jve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e_e(n,e){let t=ce(n,"base","pow"),r=ce(e,"exp","pow");[t,r]=as(t,r);const s={a:t,b:r};return be.runKernel(CH,s)}const vg=ye({pow_:e_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function On(n,e){if((qi(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&qi(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return If(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t_e(n){const t={x:ce(n,"x","sqrt","float32")};return be.runKernel(QH,t)}const _u=ye({sqrt_:t_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_e(n){const e=ce(n,"x","square"),t={};return be.runKernel("Square",{x:e},t)}const Il=ye({square_:n_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r_e(n,e=null,t=!1){let r=ce(n,"x","sum");r.dtype==="bool"&&(r=Qr(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return be.runKernel(JH,s,i)}const Or=ye({sum_:r_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_e(n,e="euclidean",t=null,r=!1){n=ce(n,"x","norm");const s=oK(n,e,t);let i=s.shape;if(r){const a=lb(t,n.shape);i=gb(s.shape,a)}return Ye(s,i)}function oK(n,e,t=null){if(n.rank===0)return mo(n);if(n.rank!==1&&t===null)return oK(Ye(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Or(mo(n),t);if(e===1/0)return jp(mo(n),t);if(e===-1/0)return AE(mo(n),t);if(e==="euclidean"||e===2)return _u(Or(vg(mo(n),On(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return jp(Or(mo(n),t[0]),t[1]-1);if(e===1/0)return jp(Or(mo(n),t[1]),t[0]);if(e===-1/0)return AE(Or(mo(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return _u(Or(Il(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const xb=ye({norm_:s_e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i_e(n,e=null,t=!1){return xb(n,"euclidean",e,t)}const lK=ye({euclideanNorm_:i_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_e(n){const t={x:ce(n,"x","exp")};return be.runKernel(RG,t)}const gf=ye({exp_:a_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_e(n,e=0){const t=ce(n,"x","expandDims","string_or_numeric");fe(e<=t.rank,()=>"Axis must be <= rank of the tensor");const r={input:t},s={dim:e};return be.runKernel(DG,r,s)}const ih=ye({expandDims_:o_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l_e(n){const t={x:ce(n,"x","expm1")};return be.runKernel($G,t)}const cK=ye({expm1_:l_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c_e(n,e){const t=ce(n,"x","tile","string_or_numeric");fe(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const r={x:t},s={reps:e};return be.runKernel(yR,r,s)}const rg=ye({tile_:c_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_e(n,e,t,r="float32"){e==null&&(e=n);const s=xc([n,e],r),i=n<=e?n:e;for(let o=0;o<i;++o)s.set(1,o,o);const a=Ye(s.toTensor(),[n,e]);if(t==null)return a;if(t.length===1)return rg(ih(a,0),[t[0],1,1]);if(t.length===2)return rg(ih(ih(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return rg(ih(ih(ih(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const HR=ye({eye_:u_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h_e(n){const t={x:ce(n,"x","floor","float32")};return be.runKernel(MG,t)}const WR=ye({floor_:h_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_e(n,e,t=0,r=0){const s=ce(n,"x","gather"),i=ce(e,"indices","gather","int32"),a={x:s,indices:i},o={axis:t,batchDims:r};return be.runKernel(zG,a,o)}const qR=ye({gather_:d_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_e(n,e){let t=ce(n,"a","greater","string_or_numeric"),r=ce(e,"b","greater","string_or_numeric");[t,r]=as(t,r),Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(VG,s)}const yb=ye({greater_:f_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p_e(n,e){let t=ce(n,"a","greaterEqual","string_or_numeric"),r=ce(e,"b","greaterEqual","string_or_numeric");[t,r]=as(t,r),Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(UG,s)}const KR=ye({greaterEqual_:p_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m_e(n){const t={x:ce(n,"x","isFinite")};return be.runKernel(WG,t)}const uK=ye({isFinite_:m_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_e(n){const t={x:ce(n,"x","isInf")};return be.runKernel(qG,t)}const hK=ye({isInf_:g_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x_e(n){const t={x:ce(n,"x","isNaN")};return be.runKernel(KG,t)}const dK=ye({isNaN_:x_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y_e(n,e=.2){const r={x:ce(n,"x","leakyRelu")},s={alpha:e};return be.runKernel(XG,r,s)}const XR=ye({leakyRelu_:y_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b_e(n,e){let t=ce(n,"a","less","string_or_numeric"),r=ce(e,"b","less","string_or_numeric");[t,r]=as(t,r),Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(YG,s)}const fK=ye({less_:b_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v_e(n,e){let t=ce(n,"a","lessEqual","string_or_numeric"),r=ce(e,"b","lessEqual","string_or_numeric");[t,r]=as(t,r),Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(ZG,s)}const GS=ye({lessEqual_:v_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pK(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const r={start:n,stop:e,num:t};return be.runKernel(QG,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function __e(n,e=5,t=1,r=1,s=.5){const i=ce(n,"x","localResponseNormalization");fe(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),fe(xg(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=i,o=!1;i.rank===3&&(o=!0,a=Ye(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:a},c={depthRadius:e,bias:t,alpha:r,beta:s},u=be.runKernel(sH,l,c);return o?Ye(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const mK=ye({localResponseNormalization_:__e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w_e(n){const t={x:ce(n,"x","log","float32")};return be.runKernel(JG,t)}const _g=ye({log_:w_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_e(n){const t={x:ce(n,"x","log1p")};return be.runKernel(eH,t)}const YR=ye({log1p_:E_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S_e(n){return fe(pf(n),()=>"The f passed in grad(f) must be a function"),(e,t)=>{const r=ce(e,"x","tf.grad","string_or_numeric"),s=t!=null?ce(t,"dy","tf.grad"):null;return be.tidy(()=>{const{value:i,grads:a}=be.gradients(()=>n(r),[r],s);return s!=null&&Da(i.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),HS(a),a[0]})}}function T_e(n){return fe(pf(n),()=>"The f passed in grads(f) must be a function"),(e,t)=>{fe(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=v1(e,"args","tf.grads","string_or_numeric"),s=t!=null?ce(t,"dy","tf.grads"):null;return be.tidy(()=>{const{value:i,grads:a}=be.gradients(()=>n(...r),r,s);return s!=null&&Da(i.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),HS(a),a})}}function C_e(n){return fe(pf(n),()=>"The f passed in valueAndGrad(f) must be a function"),(e,t)=>{fe(e instanceof ss,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),fe(t==null||t instanceof ss,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:s}=be.gradients(()=>n(e),[e],t);return HS(r),{grad:r[0],value:s}}}function A_e(n){return fe(pf(n),()=>"The f passed in valueAndGrads(f) must be a function"),(e,t)=>{fe(Array.isArray(e)&&e.every(s=>s instanceof ss),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),fe(t==null||t instanceof ss,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=be.gradients(()=>n(...e),e,t);return t!=null&&Da(r.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),HS(r.grads),r}}function gK(n,e){fe(pf(n),()=>"The f passed in variableGrads(f) must be a function"),fe(e==null||Array.isArray(e)&&e.every(c=>c instanceof b1),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const c in be.registeredVariables)e.push(be.registeredVariables[c])}const r=t?e.filter(c=>!c.trainable):null,s=e.length;e=e.filter(c=>c.trainable),fe(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:a,grads:o}=be.gradients(n,e,null,i);fe(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),fe(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return e.forEach((c,u)=>{o[u]!=null&&(l[c.name]=o[u])}),r?.forEach(c=>l[c.name]=null),{value:a,grads:l}}function wu(n){return be.customGrad(n)}function HS(n){if(n.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N_e(n){const t={x:ce(n,"x","softplus")};return be.runKernel(ZH,t)}const ZR=ye({softplus_:N_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_e(n){const e=ce(n,"x","logSigmoid");return wu(r=>({value:cu(ZR(cu(r))),gradFunc:a=>ut(a,zp(cu(r)))}))(e)}const xK=ye({logSigmoid_:k_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I_e(n,e){let t=ce(n,"a","sub"),r=ce(e,"b","sub");[t,r]=as(t,r);const s={a:t,b:r};return be.runKernel(fW,s)}const wn=ye({sub_:I_e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_e(n,e=-1){const t=ce(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return wu((s,i)=>{const o=jp(s,e,!0),l=wn(s,o),c=wn(Qr(l,"float32"),_g(Or(gf(l),e,!0)));return i([c]),{value:c,gradFunc:(d,p)=>{const[x]=p,y=!0,v=gf(x);return wn(d,ut(Or(d,e,y),v))}}})(t)}const yK=ye({logSoftmax_:R_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D_e(n,e=null,t=!1){const r=ce(n,"x","logSumExp"),s=lb(e,r.shape),i=jp(r,s,!0),a=wn(r,i),o=gf(a),l=Or(o,s),c=_g(l),u=Kt(Ye(i,c.shape),c);if(t){const d=gb(u.shape,s);return Ye(u,d)}return u}const QR=ye({logSumExp_:D_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $_e(n,e){const t=ce(n,"a","logicalAnd","bool"),r=ce(e,"b","logicalAnd","bool");Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(tH,s)}const E1=ye({logicalAnd_:$_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L_e(n){const t={x:ce(n,"x","logicalNot","bool")};return be.runKernel(nH,t)}const JR=ye({logicalNot_:L_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_e(n,e){const t=ce(n,"a","logicalOr","bool"),r=ce(e,"b","logicalOr","bool");Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(rH,s)}const eD=ye({logicalOr_:P_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O_e(n,e){const t=ce(n,"a","logicalXor","bool"),r=ce(e,"b","logicalXor","bool");return Vs(t.shape,r.shape),E1(eD(n,e),JR(E1(n,e)))}const bK=ye({logicalXor_:O_e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iw=2147483648;function M_e(n,e,t="left"){const r=ce(n,"sortedSequence","searchSorted"),s=ce(e,"values","searchSorted"),i=r.shape[r.shape.length-1],a=s.shape[s.shape.length-1],o=Ye(r,[-1,i]),l=Ye(s,[-1,a]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Hr(l.shape)>=iw)throw new Error(`values tensor size must less than ${iw}`);if(o.shape[1]>=iw)throw new Error(`trailing dim_size must less than ${iw} for int32 output type, was ${o.shape[1]}`);const c={sortedSequence:o,values:l},u={side:t};return be.runKernel(UH,c,u)}const WS=ye({searchSorted_:M_e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vK(n,e){return WS(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F_e(n,e,t,r,s){const i=ce(n,"x","maxPool"),a=1;let o=i,l=!1;i.rank===3&&(l=!0,o=Ye(i,[1,i.shape[0],i.shape[1],i.shape[2]])),fe(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),fe(Ph(t,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),Ol("maxPool",r,s);const c={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s},d=be.runKernel(oH,c,u);return l?Ye(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const tD=ye({maxPool_:F_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_e(n,e=[1,1,1],t,r,s,i="NDHWC"){const a=ce(n,"x","maxPool3d");let o=a,l=!1;a.rank===4&&(l=!0,o=Ye(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),fe(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),fe(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Ol("maxPool3d",r,s);const c={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i},d=be.runKernel(lH,c,u);return l?Ye(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const _K=ye({maxPool3d_:B_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z_e(n,e,t,r,s=!1){const a={x:ce(n,"x","maxPoolWithArgmax")},o={filterSize:e,strides:t,pad:r,includeBatchInIndex:s},l=be.runKernel(cH,a,o);return{result:l[0],indexes:l[1]}}const wK=ye({maxPoolWithArgmax_:z_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j_e(n,e){let t=ce(n,"a","maximum"),r=ce(e,"b","maximum");[t,r]=as(t,r),t.dtype==="bool"&&(t=Qr(t,"int32"),r=Qr(r,"int32")),Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(aH,s)}const nD=ye({maximum_:j_e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_e(n,e=null,t=!1){const s={x:ce(n,"x","mean")},i={axis:e,keepDims:t};return be.runKernel(uH,s,i)}const S1=ye({mean_:V_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lm(n,e="float32"){if(e==="complex64"){const r=lm(n,"float32"),s=lm(n,"float32");return Nh(r,s)}const t=zS(Hr(n),e);return be.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ud(n,e="float32"){if(e==="complex64"){const r=Ud(n,"float32"),s=lm(n,"float32");return Nh(r,s)}const t=hR(Hr(n),e);return be.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EK(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let r=ce(n,"x","meshgrid",n instanceof ss?n.dtype:"float32");if(e===void 0)return[r];let s=ce(e,"y","meshgrid",e instanceof ss?e.dtype:"float32");const i=Hr(r.shape),a=Hr(s.shape);return t==="xy"?(r=Ye(r,[1,-1]),s=Ye(s,[-1,1]),[yr(Ud([a,1],r.dtype),r),yr(s,Ud([1,i],s.dtype))]):(r=Ye(r,[-1,1]),s=Ye(s,[1,-1]),[yr(r,Ud([1,a],r.dtype)),yr(Ud([i,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_e(n,e){let t=ce(n,"a","minimum"),r=ce(e,"b","minimum");[t,r]=as(t,r),t.dtype==="bool"&&(t=Qr(t,"int32"),r=Qr(r,"int32")),Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(dH,s)}const rD=ye({minimum_:U_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G_e(n,e,t){fe(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const r=ce(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");fe(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=t==="reflect"?1:0;for(let o=0;o<r.rank;o++)fe(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),fe(e[o][0]>=0&&e[o][0]<=r.shape[o]-s&&e[o][1]>=0&&e[o][1]<=r.shape[o]-s,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:t},a={x:r};return be.runKernel(fH,a,i)}const SK=ye({mirrorPad_:G_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_e(n,e){let t=ce(n,"a","mod"),r=ce(e,"b","mod");[t,r]=as(t,r);const s={a:t,b:r};return be.runKernel(pH,s)}const TK=ye({mod_:H_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W_e(n,e=null,t=!1){n=ce(n,"x","moments");const r=lb(e,n.shape),s=S1(n,r,t);let i=s.shape;t||(i=gb(s.shape,r));const a=Il(wn(Qr(n,"float32"),Ye(s,i))),o=S1(a,r,t);return{mean:s,variance:o}}const CK=ye({moments_:W_e});function q_e(n,e,t,r){const s=ce(e,"data","multiRNNCell"),i=v1(t,"c","multiRNNCell"),a=v1(r,"h","multiRNNCell");let o=s;const l=[];for(let d=0;d<n.length;d++){const p=n[d](o,i[d],a[d]);l.push(p[0]),l.push(p[1]),o=p[1]}const c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}const AK=ye({multiRNNCell_:q_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_e(n,e,t,r=!1){const s=ce(n,"logits","multinomial"),i=s.size,a=s.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);t=t||Math.random();const l={logits:a===1?Ye(s,[1,-1]):s},c={numSamples:e,seed:t,normalized:r},u=be.runKernel(mH,l,c);return a===1?Ye(u,[u.size]):u}const NK=ye({multinomial_:K_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_e(n,e){let t=ce(n,"a","notEqual","string_or_numeric"),r=ce(e,"b","notEqual","string_or_numeric");[t,r]=as(t,r),Vs(t.shape,r.shape);const s={a:t,b:r};return be.runKernel(yH,s)}const sD=ye({notEqual_:X_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y_e(n){const t={x:ce(n,"x","onesLike")};return be.runKernel(wH,t)}const kK=ye({onesLike_:Y_e});function Z_e(n,e){const t=ce(n,"v1","outerProduct"),r=ce(e,"v2","outerProduct");fe(t.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${r.rank}.`);const s=Ye(t,[-1,1]),i=Ye(r,[1,-1]);return yr(s,i)}const IK=ye({outerProduct_:Z_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_e(n,e,t=0){const r=ce(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:t},i={x:r};return be.runKernel(TH,i,s)}const Zg=ye({pad_:Q_e});function J_e(n,e,t=0){return fe(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Zg(n,[e],t)}const RK=ye({pad1d_:J_e});function ewe(n,e,t=0){return fe(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Zg(n,e,t)}const DK=ye({pad2d_:ewe});function twe(n,e,t=0){return fe(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Zg(n,e,t)}const $K=ye({pad3d_:twe});function nwe(n,e,t=0){return fe(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Zg(n,e,t)}const LK=ye({pad4d_:nwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rwe(n,e,t){const r=ce(n,"x","spaceToBatchND");fe(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),fe(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),fe(r.shape.reduce((a,o,l)=>l>0&&l<=e.length?a&&(o+t[l-1][0]+t[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:t};return be.runKernel(eW,s,i)}const iD=ye({spaceToBatchND_:rwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function swe(n,e,t,r,s,i,a){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const o=ce(n,"x","maxPool");let l=o,c=!1;o.rank===3&&(c=!0,l=Ye(o,[1,o.shape[0],o.shape[1],o.shape[2]])),fe(Ph(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const u=Nq(l.shape,e,i,s,r),d=[u.dilationHeight,u.dilationWidth];let p;r==="same"?p=awe([u.filterHeight,u.filterWidth],d):p=[[0,0],[0,0]];const x=d[0]===1&&d[1]===1,[y,v]=iwe([u.inHeight,u.inWidth],d,p),b=x?r:"valid",S=x?l:iD(l,d,y),C=(t==="avg"?()=>BR(S,e,i,b,a):()=>tD(S,e,i,b,a))(),I=x?C:zR(C,d,v);return c?Ye(I,[I.shape[1],I.shape[2],I.shape[3]]):I}function iwe(n,e,t){const r=t.map(u=>u[0]),s=t.map(u=>u[1]),i=n.concat(r,s),a=e.map((u,d)=>(u-i[d]%u)%u),o=s.map((u,d)=>u+a[d]),l=e.map((u,d)=>[r[d],o[d]]),c=e.map((u,d)=>[0,a[d]]);return[l,c]}function awe(n,e){const r=n.map((a,o)=>a+(a-1)*(e[o]-1)).map(a=>a-1),s=r.map(a=>Math.floor(a/2)),i=r.map((a,o)=>a-s[o]);return r.map((a,o)=>[s[o],i[o]])}const PK=ye({pool_:swe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function owe(n,e){const t=ce(n,"x","prelu"),r=ce(e,"alpha","prelu"),s={x:t,alpha:r};return be.runKernel(AH,s)}const aD=ye({prelu_:owe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lwe(n,e=null,t=!1){let r=ce(n,"x","prod");r.dtype==="bool"&&(r=Qr(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return be.runKernel(NH,s,i)}const OK=ye({prod_:lwe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cwe(n,e,t,r){const s=n.map((u,d)=>ce(u,`tensors${d}`,"raggedGather","int32")),i=ce(e,"paramsDenseValues","raggedGather"),a=ce(t,"indices","raggedGather","int32"),o={paramsNestedSplits:s,paramsDenseValues:i,indices:a},l={outputRaggedRank:r},c=be.runKernel(kH,o,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const MK=ye({raggedGather_:cwe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uwe(n,e,t,r,s){const i=ce(n,"shape","raggedTensorToTensor","int32"),a=ce(e,"values","raggedTensorToTensor"),o=ce(t,"defaultValue","raggedTensorToTensor",a.dtype),l=r.map((d,p)=>ce(d,`tensors${p}`,"raggedTensorToTensor","int32")),c={shape:i,values:a,defaultValue:o,rowPartitionTensors:l},u={rowPartitionTypes:s};return be.runKernel(IH,c,u)}const FK=ye({raggedTensorToTensor_:uwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hwe(n,e,t){const r=Hr(n);let s=null;if(t==null||t==="float32")s=new Float32Array(r);else if(t==="int32")s=new Int32Array(r);else if(t==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${t}`);for(let i=0;i<r;i++)s[i]=e();return be.makeTensor(s,n,t)}const BK=ye({rand_:hwe});var Kw={exports:{}},dwe=Kw.exports,CF;function fwe(){return CF||(CF=1,(function(n){(function(e,t,r){function s(l){var c=this,u=o();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function a(l,c){var u=new s(l),d=c&&c.state,p=u.next;return p.int32=function(){return u.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&i(d,u),p.state=function(){return i(u,{})}),p}function o(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return c}t&&t.exports?t.exports=a:this.alea=a})(dwe,n)})(Kw)),Kw.exports}var Xw={exports:{}},pwe=Xw.exports,AF;function mwe(){return AF||(AF=1,(function(n){(function(e,t,r){function s(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:c+=o;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var c=new s(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,x=(c.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.xor128=a})(pwe,n)})(Xw)),Xw.exports}var Yw={exports:{}},gwe=Yw.exports,NF;function xwe(){return NF||(NF=1,(function(n){(function(e,t,r){function s(o){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var c=new s(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,x=(c.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.xorwow=a})(gwe,n)})(Yw)),Yw.exports}var Zw={exports:{}},ywe=Zw.exports,kF;function bwe(){return kF||(kF=1,(function(n){(function(e,t,r){function s(o){var l=this;l.next=function(){var u=l.x,d=l.i,p,x;return p=u[d],p^=p>>>7,x=p^p<<24,p=u[d+1&7],x^=p^p>>>10,p=u[d+3&7],x^=p^p>>>3,p=u[d+4&7],x^=p^p<<7,p=u[d+7&7],p=p^p<<13,x^=p^p<<9,u[d]=x,l.i=d+1&7,x};function c(u,d){var p,x=[];if(d===(d|0))x[0]=d;else for(d=""+d,p=0;p<d.length;++p)x[p&7]=x[p&7]<<15^d.charCodeAt(p)+x[p+1&7]<<13;for(;x.length<8;)x.push(0);for(p=0;p<8&&x[p]===0;++p);for(p==8?x[7]=-1:x[p],u.x=x,u.i=0,p=256;p>0;--p)u.next()}c(l,o)}function i(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var c=new s(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,x=(c.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,u&&(u.x&&i(u,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.xorshift7=a})(ywe,n)})(Zw)),Zw.exports}var Qw={exports:{}},vwe=Qw.exports,IF;function _we(){return IF||(IF=1,(function(n){(function(e,t,r){function s(o){var l=this;l.next=function(){var u=l.w,d=l.X,p=l.i,x,y;return l.w=u=u+1640531527|0,y=d[p+34&127],x=d[p=p+1&127],y^=y<<13,x^=x<<17,y^=y>>>15,x^=x>>>12,y=d[p]=y^x,l.i=p,y+(u^u>>>16)|0};function c(u,d){var p,x,y,v,b,S=[],T=128;for(d===(d|0)?(x=d,d=null):(d=d+"\0",x=0,T=Math.max(T,d.length)),y=0,v=-32;v<T;++v)d&&(x^=d.charCodeAt((v+32)%d.length)),v===0&&(b=x),x^=x<<10,x^=x>>>15,x^=x<<4,x^=x>>>13,v>=0&&(b=b+1640531527|0,p=S[v&127]^=x+b,y=p==0?y+1:0);for(y>=128&&(S[(d&&d.length||0)&127]=-1),y=127,v=512;v>0;--v)x=S[y+34&127],p=S[y=y+1&127],x^=x<<13,p^=p<<17,x^=x>>>15,p^=p>>>12,S[y]=x^p;u.w=b,u.X=S,u.i=y}c(l,o)}function i(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var c=new s(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,x=(c.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,u&&(u.X&&i(u,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.xor4096=a})(vwe,n)})(Qw)),Qw.exports}var Jw={exports:{}},wwe=Jw.exports,RF;function Ewe(){return RF||(RF=1,(function(n){(function(e,t,r){function s(o){var l=this,c="";l.next=function(){var d=l.b,p=l.c,x=l.d,y=l.a;return d=d<<25^d>>>7^p,p=p-x|0,x=x<<24^x>>>8^y,y=y-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-x|0,l.d=x<<16^p>>>16^y,l.a=y-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var c=new s(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,x=(c.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.tychei=a})(wwe,n)})(Jw)),Jw.exports}var e2={exports:{}},Swe=e2.exports,DF;function Twe(){return DF||(DF=1,(function(n){(function(e,t,r){var s=256,i=6,a=52,o="random",l=r.pow(s,i),c=r.pow(2,a),u=c*2,d=s-1,p;function x(I,$,q){var U=[];$=$==!0?{entropy:!0}:$||{};var F=S(b($.entropy?[I,C(t)]:I??T(),3),U),G=new y(U),V=function(){for(var O=G.g(i),K=l,P=0;O<c;)O=(O+P)*s,K*=s,P=G.g(1);for(;O>=u;)O/=2,K/=2,P>>>=1;return(O+P)/K};return V.int32=function(){return G.g(4)|0},V.quick=function(){return G.g(4)/4294967296},V.double=V,S(C(G.S),t),($.pass||q||function(O,K,P,N){return N&&(N.S&&v(N,G),O.state=function(){return v(G,{})}),P?(r[o]=O,K):O})(V,F,"global"in $?$.global:this==r,$.state)}function y(I){var $,q=I.length,U=this,F=0,G=U.i=U.j=0,V=U.S=[];for(q||(I=[q++]);F<s;)V[F]=F++;for(F=0;F<s;F++)V[F]=V[G=d&G+I[F%q]+($=V[F])],V[G]=$;(U.g=function(O){for(var K,P=0,N=U.i,M=U.j,B=U.S;O--;)K=B[N=d&N+1],P=P*s+B[d&(B[N]=B[M=d&M+K])+(B[M]=K)];return U.i=N,U.j=M,P})(s)}function v(I,$){return $.i=I.i,$.j=I.j,$.S=I.S.slice(),$}function b(I,$){var q=[],U=typeof I,F;if($&&U=="object")for(F in I)try{q.push(b(I[F],$-1))}catch{}return q.length?q:U=="string"?I:I+"\0"}function S(I,$){for(var q=I+"",U,F=0;F<q.length;)$[d&F]=d&(U^=$[d&F]*19)+q.charCodeAt(F++);return C($)}function T(){try{var I;return p&&(I=p.randomBytes)?I=I(s):(I=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(I)),C(I)}catch{var $=e.navigator,q=$&&$.plugins;return[+new Date,e,q,e.screen,C(t)]}}function C(I){return String.fromCharCode.apply(0,I)}if(S(r.random(),t),n.exports){n.exports=x;try{p=K4}catch{}}else r["seed"+o]=x})(typeof self<"u"?self:Swe,[],Math)})(e2)),e2.exports}var xk,$F;function Cwe(){if($F)return xk;$F=1;var n=fwe(),e=mwe(),t=xwe(),r=bwe(),s=_we(),i=Ewe(),a=Twe();return a.alea=n,a.xor128=e,a.xorwow=t,a.xorshift7=r,a.xor4096=s,a.tychei=i,xk=a,xk}var Qg=Cwe();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let oD=class{constructor(e,t,r,s,i){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=i||Math.random();this.random=Qg.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,t,r=!1;for(;!r;){let s,i,a;do s=2*this.random()-1,i=2*this.random()-1,a=s*s+i*i;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*s*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}};class Awe{constructor(e,t,r,s){this.alpha=e,this.beta=1/t,this.dtype=r;const i=s||Math.random();this.randu=Qg.alea(i.toString()),this.randn=new oD(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,r,s,i,a;for(;;){do s=this.randn.nextValue(),a=1+this.c*s;while(a<=0);if(a*=a*a,e=s*s,t=1-.331*e*e,r=.5*e+this.d*(1-a+Math.log(a)),i=this.randu(),i<t||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}let Nwe=class{constructor(e=0,t=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=Qg.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kwe(n,e,t=1,r="float32",s){if(t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const i=new Awe(e,t,r,s),a=xc(n,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const zK=ye({randomGamma_:kwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iwe(n,e=0,t=1,r,s){if(r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new oD(e,t,r,!1,s),a=xc(n,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const lD=ye({randomNormal_:Iwe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rwe(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return lD(n,0,1,e,t)}const jK=ye({randomStandardNormal_:Rwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dwe(n,e=0,t=1,r="float32",s){const i=xc(n,r),a=new Nwe(e,t,null,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const cD=ye({randomUniform_:Dwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wg(n,e,t=1,r="float32"){if(t===0)throw new Error("Cannot have a step of zero");const s={start:n,stop:e,step:t,dtype:r};return be.runKernel(RH,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $we(n){const t={x:ce(n,"x","reciprocal")};return be.runKernel($H,t)}const VK=ye({reciprocal_:$we});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lwe(n){const t={x:ce(n,"x","relu")};return be.runKernel(LH,t)}const bb=ye({relu_:Lwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pwe(n){const t={x:ce(n,"x","relu6")};return be.runKernel(FH,t)}const uD=ye({relu6_:Pwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Owe(n,e){const r={x:ce(n,"x","reverse")},s={dims:e};return be.runKernel(BH,r,s)}const xf=ye({reverse_:Owe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwe(n){const e=ce(n,"x","reverse");return fe(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),xf(e,0)}const UK=ye({reverse1d_:Mwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fwe(n,e){const t=ce(n,"x","reverse");return fe(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),xf(t,e)}const GK=ye({reverse2d_:Fwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bwe(n,e){const t=ce(n,"x","reverse");return fe(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),xf(t,e)}const HK=ye({reverse3d_:Bwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zwe(n,e){const t=ce(n,"x","reverse");return fe(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),xf(t,e)}const WK=ye({reverse4d_:zwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jwe(n){const t={x:ce(n,"x","round")};return be.runKernel(zH,t)}const hD=ye({round_:jwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vwe(n){const t={x:ce(n,"x","rsqrt","float32")};return be.runKernel(jH,t)}const qK=ye({rsqrt_:Vwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uwe(n){const t={x:ce(n,"x","selu")};return be.runKernel(HH,t)}const KK=ye({selu_:Uwe});function Gwe(n,e,t,r,s,i=[1,1],a="NHWC"){const o=ce(n,"x","separableConv2d"),l=ce(e,"depthwiseFilter","separableConv2d"),c=ce(t,"pointwiseFilter","separableConv2d");let u=o,d=!1;if(o.rank===3&&(d=!0,u=Ye(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");fe(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),fe(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),fe(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),fe(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),fe(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const p=l.shape[2],x=l.shape[3];fe(c.shape[2]===p*x,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*x}, but got ${c.shape[2]}.`);const y=US(u,l,r,s,a,i),b=mb(y,c,1,"valid",a);return d?Ye(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const XK=ye({separableConv2d_:Gwe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Hwe(n,e){const t=ce(n,"x","setdiff1d"),r=ce(e,"y","setdiff1d");fe(t.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${r.dtype}).`),fe(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),fe(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await t.data(),i=await r.data(),a=new Set(i);let o=0;for(let u=0;u<s.length;u++)a.has(s[u])||o++;const l=new wE([o],t.dtype),c=new wE([o],"int32");for(let u=0,d=0;u<s.length;u++)a.has(s[u])||(l.values[d]=s[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]}const YK=Hwe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wwe(n){const t={x:ce(n,"x","sign")};return be.runKernel(XH,t)}const ZK=ye({sign_:Wwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qwe(n){const t={x:ce(n,"x","sin","float32")};return be.runKernel(qH,t)}const QK=ye({sin_:qwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kwe(n){const t={x:ce(n,"x","sinh")};return be.runKernel(KH,t)}const JK=ye({sinh_:Kwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xwe(n,e,t){const r=ce(n,"x","slice1d");return fe(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Ir(r,[e],[t])}const eX=ye({slice1d_:Xwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ywe(n,e,t){const r=ce(n,"x","slice2d");return fe(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Ir(r,e,t)}const tX=ye({slice2d_:Ywe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zwe(n,e,t){const r=ce(n,"x","slice3d");return fe(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Ir(r,e,t)}const nX=ye({slice3d_:Zwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qwe(n,e,t){const r=ce(n,"x","slice4d");return fe(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Ir(r,e,t)}const rX=ye({slice4d_:Qwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jwe(n,e=-1){const t=ce(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const r={logits:t},s={dim:e};return be.runKernel(nW,r,s)}const sX=ye({softmax_:Jwe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e2e(n){fe(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return be.runKernel(LG,e)}const qS=ye({fft_:e2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2e(n){fe(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return be.runKernel(GG,e)}const T1=ye({ifft_:t2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n2e(n){const e=n.shape[n.shape.length-1],t=n.size/e;let r;if(e<=2){const s=Ye(n,[t,e]);r=T1(s)}else{const s=[t,2*(e-1)],i=Ye(bg(n),[t,e]),a=Ye(db(n),[t,e]),o=xf(Ir(i,[0,1],[t,e-2]),1),l=ut(xf(Ir(a,[0,1],[t,e-2]),1),On(-1)),c=Zi([i,o],1),u=Zi([a,l],1),d=Ye(Nh(c,u),[s[0],s[1]]);r=T1(d)}if(r=bg(r),n.rank===3&&n.shape[0]!==0){const s=r,i=n.shape[0];r=Ye(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const dD=ye({irfft_:n2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2e(n,e,t=0){const s={x:ce(n,"x","split")},i={numOrSizeSplits:e,axis:t};return be.runKernel(tW,s,i)}const Eg=ye({split_:r2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s2e(n,e){fe(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const r=n.size/t;let s;if(e!=null&&e<t){const y=n.shape.map(b=>0),v=n.shape.map(b=>b);v[n.shape.length-1]=e,s=Ir(n,y,v),t=e}else if(e!=null&&e>t){const y=n.shape.map(v=>v);y[n.shape.length-1]=e-t,s=Zi([n,lm(y)],n.shape.length-1),t=e}else s=n;const i=vo(s),a=Ye(Nh(s,i),[r,t]),o=qS(a),l=Math.floor(t/2)+1,c=bg(o),u=db(o),d=Eg(c,[l,t-l],c.shape.length-1),p=Eg(u,[l,t-l],u.shape.length-1),x=s.shape.slice();return x[s.shape.length-1]=l,Ye(Nh(d[0],p[0]),x)}const KS=ye({rfft_:s2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2e(n,e){let t=ce(n,"a","squaredDifference"),r=ce(e,"b","squaredDifference");[t,r]=as(t,r),Vs(t.shape,r.shape);const s={a:t,b:r},i={};return be.runKernel(lW,s,i)}const fD=ye({squaredDifference_:i2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a2e(n,e){const t=ce(n,"x","squeeze","string_or_numeric");return Ye(t,NU(t.shape,e).newShape)}const vb=ye({squeeze_:a2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o2e(n,e=0){const t=v1(n,"tensors","stack","string_or_numeric");fe(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&fe(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const r=t,s={axis:e};return be.runKernel(SH,r,s)}const Eu=ye({stack_:o2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l2e(n,e=0){const r={x:ce(n,"x","step")},s={alpha:e};return be.runKernel(wW,r,s)}const pD=ye({step_:l2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c2e(n,e,t,r,s=0,i=0,a=0,o=0,l=0){const u={x:ce(n,"x","stridedSlice","string_or_numeric")},d={begin:e,end:t,strides:r,beginMask:s,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};return be.runKernel(cW,u,d)}const iX=ye({stridedSlice_:c2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u2e(n){const t={x:ce(n,"x","tan","float32")};return be.runKernel(pW,t)}const aX=ye({tan_:u2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Al(n,e){Im(n);const t=vu(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return If(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sg(n,e,t){if(Im(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=vu(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return If(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oX(n,e,t){if(Im(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=vu(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return If(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(n,e,t){if(Im(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=vu(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return If(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cX(n,e,t){if(Im(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=vu(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,If(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2e(n,e=1,t=!0){const r=ce(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},a={k:e,sorted:t},[o,l]=be.runKernel(gW,i,a);return{values:o,indices:l}}const uX=ye({topk_:h2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d2e(n,e=0,t=1,r,s){if(r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new oD(e,t,r,!0,s),a=xc(n,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const hX=ye({truncatedNormal_:d2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f2e(n,e=0){const t=ce(n,"x","unique","string_or_numeric");fe(t.rank>0,()=>"The input tensor must be at least 1D");const r={x:t},s={axis:e},[i,a]=be.runKernel(yW,r,s);return{values:i,indices:a}}const dX=ye({unique_:f2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p2e(n,e,t){const r=ce(n,"x","unsortedSegmentSum"),s=ce(e,"segmentIds","unsortedSegmentSum","int32");fe(xg(t),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},a={numSegments:t};return be.runKernel(vW,i,a)}const fX=ye({unsortedSegmentSum_:p2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2e(n,e=0){const t=ce(n,"x","unstack","string_or_numeric");fe(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const r={value:t},s={axis:e};return be.runKernel(bW,r,s)}const Df=ye({unstack_:m2e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pX(n,e){return WS(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mX(n,e=!0,t,r){return be.makeVariable(n,e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gX(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const r=xc(n,"int32"),s=xc([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const a=r.indexToLoc(t[i]),o=i*n.length;s.values.set(a,o)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function g2e(n){const e=ce(n,"condition","whereAsync","bool"),t=await e.data(),r=gX(e.shape,t);return n!==e&&e.dispose(),r}const mD=g2e;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function x2e(n,e,t){const r=ce(n,"tensor","boolMask"),s=ce(e,"mask","boolMask","bool"),i=t??0,a=s.rank,o=r.shape;fe(a>0,()=>"mask cannot be scalar"),Da(o.slice(i,i+a),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let v=i;v<i+a;v++)l*=o[v];const c=o.slice(0,i).concat([l],o.slice(i+a)),u=Ye(r,c),d=Ye(s,[-1]),p=await mD(d),x=vb(p,[1]),y=qR(u,x,i);return n!==r&&r.dispose(),e!==s&&s.dispose(),x.dispose(),u.dispose(),d.dispose(),p.dispose(),y}const xX=x2e;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y2e(n,e,t,r,s=!0){const i=ce(n,"v","movingAverage"),a=ce(e,"x","movingAverage"),o=ce(t,"decay","movingAverage");IW(i,a),fe(bu(i.shape,a.shape),()=>"Shape mismatch in v and x");const l=On(1),c=wn(l,o);let u=ut(wn(a,i),c);if(s){fe(r!=null,()=>"When using zeroDebias: true, step is required.");const d=ce(r,"step","movingAverage");u=Mr(u,wn(l,vg(o,d)))}return Kt(i,u)}const yX=ye({movingAverage_:y2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2e(n,e,t){const r=ce(n,"indices","scatterND","int32"),s=ce(e,"updates","scatterND");LR(s,r,t);const i={indices:r,updates:s},a={shape:t};return be.runKernel(VH,i,a)}const bX=ye({scatterND_:b2e});function v2e(n,e,t,r){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const s=n.rank>0?n.shape[0]:1,i=n.rank>1?n.shape[1]:1;if(t.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${i}.`);const a=e.size;if(!(e.rank===0||e.rank===1&&a===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _2e(n,e,t,r=0){const s=ce(n,"sparseIndices","sparseToDense","int32"),i=ce(e,"sparseValues","sparseToDense","string_or_numeric"),a=ce(r,"defaultValue","sparseToDense",i.dtype);v2e(s,i,t,a);const o={sparseIndices:s,sparseValues:i,defaultValue:a},l={outputShape:t};return be.runKernel(oW,o,l)}const vX=ye({sparseToDense_:_2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w2e(n,e){const t=ce(e,"indices","gatherND","int32"),s={params:ce(n,"x","gatherND","string_or_numeric"),indices:t};return be.runKernel(jG,s)}const _X=ye({gatherND_:w2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2e(n,e){if(e==null)return n.shape.slice();if(bu(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let r=0;r<n.shape.length;r++)e[r]==null&&n.shape[r]!=null?t.push(n.shape[r]):t.push(e[r]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S2e(n,e,t,r){const s=ce(n,"x","dropout");if(fe(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),fe(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof ss?s.clone():s;const i=E2e(s,t),a=1-e,o=Mr(WR(Kt(cD(i,0,1,"float32",r),a)),a);return ut(s,o)}const wX=ye({dropout_:S2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gD(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function XS(n,e,t){const r=1-n%2,s=new Float32Array(n);for(let i=0;i<n;++i){const a=2*Math.PI*i/(n+r-1);s[i]=e-t*Math.cos(a)}return Al(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function T2e(n,e,t=1){const r=ce(n,"predictions","inTopK"),s=ce(e,"targets","inTopK");fe(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),fe(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),Da(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];fe(t>0&&t<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${t}`);const a=await r.data(),o=await s.data(),[l,c]=[a.length/i,i],u=kU("bool",l);for(let d=0;d<l;d++){const p=d*c,x=a.subarray(p,p+c),y=[];for(let v=0;v<x.length;v++)y.push({value:x[v],index:v});y.sort((v,b)=>b.value-v.value),u[d]=0;for(let v=0;v<t;v++)if(y[v].index===o[d]){u[d]=1;break}}return n!==r&&r.dispose(),e!==s&&s.dispose(),hc(u,s.shape,"bool")}const EX=T2e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C2e(n,e,t,r,s,i="NHWC",a){let o=n;n.rank===3&&(o=Ye(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=Ye(e,[1,e.shape[0],e.shape[1],e.shape[2]])),fe(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),fe(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),fe(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const c=i==="NHWC"?o.shape[3]:o.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];fe(c===t[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${t[2]}.`),fe(u===t[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${t[3]}).`),Ol("conv2dDerFilter",s,a);const d={x:o,dy:l},p={strides:r,pad:s,dataFormat:i,dimRoundingMode:a,filterShape:t};return be.runKernel(uG,d,p)}const A2e=ye({conv2DBackpropFilter_:C2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YS(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return ut(n,pD(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function ZS(n,e){let t=e;const r=RR(n.shape,e.shape);return r.length>0&&(t=Or(t,r)),Ye(t,n.shape)}function QS(n,e,t,r){if(e==="linear")return n;if(e==="relu")return bb(n);if(e==="elu")return UR(n);if(e==="relu6")return uD(n);if(e==="prelu")return aD(n,t);if(e==="leakyrelu")return XR(n,r);if(e==="sigmoid")return zp(n);throw new Error(`Unknown fused activation ${e}.`)}const JS=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N2e({x:n,filter:e,strides:t,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",JS(be.state.gradientDepth,l)===!1){fe(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let q=mb(n,e,t,r,s,i,a);return o!=null&&(q=Kt(q,o)),QS(q,l,c,u)}const d=ce(n,"x","conv2d","float32"),p=ce(e,"filter","conv2d","float32");let x=d,y=!1;d.rank===3&&(y=!0,x=Ye(d,[1,d.shape[0],d.shape[1],d.shape[2]])),fe(x.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${x.rank}.`),fe(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Ol("fused conv2d",r,a);const v=s==="NHWC"?x.shape[3]:x.shape[1];fe(p.shape[2]===v,()=>`Error in conv2d: depth of input (${v}) must match input depth for filter ${p.shape[2]}.`),fe(Ph(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const b=fb(x.shape,p.shape,t,i,r,a);let S;o!=null&&(S=ce(o,"bias","fused conv2d"),[S]=as(S,d),s==="NHWC"?Vs(b.outShape,S.shape):(fe(S.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${S.shape.length}.`),fe(S.shape.length===0||S.shape[0]===b.outChannels||S.shape[0]===1,()=>`Error in fused conv2d: bias shape (${S.shape}) is not compatible with the number of output channels (${b.outChannels})`)));let T;if(c!=null){const q=c.shape;if(fe(q.length<=1||q.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${q.length}.`),q.length===1)fe(q[0]===1||q[0]===b.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${q}) is not compatible with the number of output channels (${b.outChannels}).`);else if(q.length===3)try{Vs(q,b.outShape)}catch{const F=`Error in fused conv2d: PReLU activation weights (${q}) is not compatible with the output shape of the conv2d (${b.outShape}).`;throw Error(F)}T=ce(c,"prelu weights","fused conv2d")}const C=(q,U)=>{fe(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[F,G,V,O]=U,K=YS(q,V,l);fe(w1(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const P=Gq(G.shape,K,F,t,r),N=A2e(G,K,F.shape,t,r),M=[P,N];if(O!=null){const B=ZS(O,K);M.push(B)}return M},I={x,filter:p,bias:S,preluActivationWeights:T},$={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:u};return o==null?wu((U,F,G)=>{let V=be.runKernel(NI,I,$);return G([F,U,V]),y&&(V=Ye(V,[V.shape[1],V.shape[2],V.shape[3]])),{value:V,gradFunc:C}})(x,p):wu((U,F,G,V)=>{let O=be.runKernel(NI,I,$);return V([F,U,O,G]),y&&(O=Ye(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:C}})(x,p,S)}const k2e=ye({fusedConv2d_:N2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2e(n,e,t,r,s,i=[1,1],a){let o=n;n.rank===3&&(o=Ye(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=Ye(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:o,dy:l},u={strides:r,pad:s,dimRoundingMode:a,dilations:i,filterShape:t};return be.runKernel(wG,c,u)}const R2e=ye({depthwiseConv2dNativeBackpropFilter_:I2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2e(n,e,t,r,s,i=[1,1],a){let o=e,l=!1;e.rank===3&&(l=!0,o=Ye(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:o,filter:t},u={strides:r,pad:s,dimRoundingMode:a,dilations:i,inputShape:n},d=be.runKernel(EG,c,u);return l?Ye(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const $2e=ye({depthwiseConv2dNativeBackpropInput_:D2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L2e({x:n,filter:e,strides:t,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(JS(be.state.gradientDepth,l)===!1){let $=US(n,e,t,r,s,i,a);return o!=null&&($=Kt($,o)),QS($,l,c,u)}const d=ce(n,"x","depthwiseConv2d","float32"),p=ce(e,"filter","depthwiseConv2d","float32");let x=d,y=!1;d.rank===3&&(y=!0,x=Ye(d,[1,d.shape[0],d.shape[1],d.shape[2]])),fe(x.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${x.rank}.`),fe(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),fe(x.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${x.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),i==null&&(i=[1,1]),fe(Ph(t,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),Ol("fused depthwiseConv2d",r,a);const v=fb(x.shape,p.shape,t,i,r,a,!0);let b;o!=null&&(b=ce(o,"bias","fused conv2d"),[b]=as(b,d),Vs(v.outShape,b.shape));let S;c!=null&&(S=ce(c,"prelu weights","fused depthwiseConv2d"));const T=($,q)=>{fe(w1(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[U,F,G,V]=q,O=YS($,G,l),K=$2e(F.shape,O,U,t,r,i,a),P=R2e(F,O,U.shape,t,r,i,a);if(V!=null){const N=ZS(b,O);return[K,P,N]}return[K,P]},C={x,filter:p,bias:b,preluActivationWeights:S},I={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:u};return o==null?wu((q,U,F)=>{let G=be.runKernel(kI,C,I);return F([U,q,G]),y&&(G=Ye(G,[G.shape[1],G.shape[2],G.shape[3]])),{value:G,gradFunc:T}})(x,p):wu((q,U,F,G)=>{let V=be.runKernel(kI,C,I);return G([U,q,V,F]),y&&(V=Ye(V,[V.shape[1],V.shape[2],V.shape[3]])),{value:V,gradFunc:T}})(x,p,b)}const P2e=ye({fusedDepthwiseConv2d_:L2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O2e({a:n,b:e,transposeA:t=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(JS(be.state.gradientDepth,i)===!1){let O=yr(n,e,t,r);return s!=null&&(O=Kt(O,s)),QS(O,i,a,o)}let l=ce(n,"a","fused matMul"),c=ce(e,"b","fused matMul");[l,c]=as(l,c);const u=t?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],p=t?l.shape[l.rank-1]:l.shape[l.rank-2],x=r?c.shape[c.rank-2]:c.shape[c.rank-1],y=l.shape.slice(0,-2),v=c.shape.slice(0,-2),b=Hr(y),S=Hr(v);fe(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${t} and transposeB=${r} must match.`);const C=Vs(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,x]),I=t?Ye(l,[b,u,p]):Ye(l,[b,p,u]),$=r?Ye(c,[S,x,d]):Ye(c,[S,d,x]);let q;s!=null&&(q=ce(s,"bias","fused matMul"),[q]=as(q,l),Vs(C,q.shape));let U;a!=null&&(U=ce(a,"prelu weights","fused matMul"));const F=(O,K)=>{const[P,N,M,B]=K,Y=YS(Ye(O,M.shape),M,i);let Z,ne;if(!t&&!r?(Z=yr(Y,N,!1,!0),ne=yr(P,Y,!0,!1)):!t&&r?(Z=yr(Y,N,!1,!1),ne=yr(Y,P,!0,!1)):t&&!r?(Z=yr(N,Y,!1,!0),ne=yr(P,Y,!1,!1)):(Z=yr(N,Y,!0,!0),ne=yr(Y,P,!0,!0)),s!=null){const Q=ZS(B,Y);return[Z,ne,Q]}else return[Z,ne]},G={a:I,b:$,bias:q,preluActivationWeights:U},V={transposeA:t,transposeB:r,activation:i,leakyreluAlpha:o};return s==null?wu((K,P,N)=>{const M=be.runKernel(AI,G,V);return N([K,P,M]),{value:Ye(M,C),gradFunc:F}})(I,$):wu((K,P,N,M)=>{const B=be.runKernel(AI,G,V);return M([K,P,B,N]),{value:Ye(B,C),gradFunc:F}})(I,$,q)}const M2e=ye({fusedMatMul_:O2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX=Object.freeze(Object.defineProperty({__proto__:null,conv2d:k2e,depthwiseConv2d:P2e,matMul:M2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F2e(n){return XS(n,.54,.46)}const B2e=ye({hammingWindow_:F2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2e(n){return XS(n,.5,.5)}const TX=ye({hannWindow_:z2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j2e(n,e,t,r=!1,s=0){let i=0;const a=[];for(;i+e<=n.size;)a.push(Ir(n,i,e)),i+=t;if(r)for(;i<n.size;){const o=i+e-n.size,l=Zi([Ir(n,i,e-o),Yg([o],s)]);a.push(l),i+=t}return a.length===0?sg([],[0,e]):Ye(Zi(a),[a.length,e])}const CX=ye({frame_:j2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V2e(n,e,t,r,s=TX){r==null&&(r=gD(e));const i=CX(n,e,t),a=ut(i,s(e));return KS(a,r)}const U2e=ye({stft_:V2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G2e(n,e,t,r,s="bilinear",i=0){const a=ce(n,"image","cropAndResize"),o=ce(e,"boxes","cropAndResize","float32"),l=ce(t,"boxInd","cropAndResize","int32"),c=o.shape[0];fe(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),fe(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),fe(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),fe(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),fe(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),fe(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const u={image:a,boxes:o,boxInd:l},d={method:s,extrapolationValue:i,cropSize:r};return be.runKernel(yG,u,d)}const H2e=ye({cropAndResize_:G2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W2e(n){const e=ce(n,"image","flipLeftRight","float32");fe(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return be.runKernel(OG,t,{})}const q2e=ye({flipLeftRight_:W2e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2e(n){const e=ce(n,"image","grayscaleToRGB"),t=e.rank-1,r=e.shape[t];fe(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),fe(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,t),s[t]=3,rg(e,s)}const X2e=ye({grayscaleToRGB_:K2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y2e(n,e,t=0,r=.5){const s=ce(n,"image","rotateWithOffset","float32");fe(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},a={radians:e,fillValue:t,center:r};return be.runKernel(EW,i,a)}const Z2e=ye({rotateWithOffset_:Y2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jg(n,e,t,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const a=n.shape[0];return t=Math.min(t,a),fe(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),fe(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),fe(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),fe(e.rank===1,()=>"scores must be a 1D tensor"),fe(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),fe(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2e(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=ce(n,"boxes","nonMaxSuppression","float32"),a=ce(e,"scores","nonMaxSuppression","float32"),o=Jg(i,a,t,r,s);t=o.maxOutputSize,r=o.iouThreshold,s=o.scoreThreshold;const l={maxOutputSize:t,iouThreshold:r,scoreThreshold:s};return be.runKernel(bH,{boxes:i,scores:a},l)}const J2e=ye({nonMaxSuppression_:Q2e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eEe(n,e,t){const r=tEe(n,e,t),s=r<0?-(r+1):r;n.splice(s,0,e)}function tEe(n,e,t){return rEe(n,e,t||nEe)}function nEe(n,e){return n>e?1:n<e?-1:0}function rEe(n,e,t){let r=0,s=n.length,i=0,a=!1;for(;r<s;){i=r+(s-r>>>1);const o=t(e,n[i]);o>0?r=i+1:(s=i,a=!o)}return a?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AX(n,e,t,r,s){return xD(n,e,t,r,s,0)}function NX(n,e,t,r,s,i){return xD(n,e,t,r,s,0,!1,i,!0)}function kX(n,e,t,r,s,i){return xD(n,e,t,r,s,i,!0)}function xD(n,e,t,r,s,i,a=!1,o=!1,l=!1){const c=[];for(let b=0;b<e.length;b++)e[b]>s&&c.push({score:e[b],boxIndex:b,suppressBeginIndex:0});c.sort(LF);const u=i>0?-.5/i:0,d=[],p=[];for(;d.length<t&&c.length>0;){const b=c.pop(),{score:S,boxIndex:T,suppressBeginIndex:C}=b;if(S<s)break;let I=!1;for(let $=d.length-1;$>=C;--$){const q=sEe(n,T,d[$]);if(q>=r){I=!0;break}if(b.score=b.score*iEe(r,u,q),b.score<=s)break}b.suppressBeginIndex=d.length,I||(b.score===S?(d.push(T),p.push(b.score)):b.score>s&&eEe(c,b,LF))}const x=d.length,y=t-x;o&&y>0&&(d.push(...new Array(y).fill(0)),p.push(...new Array(y).fill(0)));const v={selectedIndices:d};return a&&(v.selectedScores=p),l&&(v.validOutputs=x),v}function sEe(n,e,t){const r=n.subarray(e*4,e*4+4),s=n.subarray(t*4,t*4+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(s[0],s[2]),u=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),p=Math.max(s[1],s[3]),x=(o-i)*(l-a),y=(d-c)*(p-u);if(x<=0||y<=0)return 0;const v=Math.max(i,c),b=Math.max(a,u),S=Math.min(o,d),T=Math.min(l,p),C=Math.max(S-v,0)*Math.max(T-b,0);return C/(x+y-C)}function iEe(n,e,t){const r=Math.exp(e*t*t);return t<=n?r:0}function LF(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function aEe(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=ce(n,"boxes","nonMaxSuppressionAsync"),a=ce(e,"scores","nonMaxSuppressionAsync"),o=Jg(i,a,t,r,s);t=o.maxOutputSize,r=o.iouThreshold,s=o.scoreThreshold;const l=await Promise.all([i.data(),a.data()]),c=l[0],u=l[1],{selectedIndices:d}=AX(c,u,t,r,s);return i!==n&&i.dispose(),a!==e&&a.dispose(),Al(d,"int32")}const oEe=aEe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lEe(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const a=ce(n,"boxes","nonMaxSuppression"),o=ce(e,"scores","nonMaxSuppression"),l=Jg(a,o,t,r,s,i);t=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:a,scores:o},u={maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},d=be.runKernel(_H,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const cEe=ye({nonMaxSuppressionWithScore_:lEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function uEe(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const a=ce(n,"boxes","nonMaxSuppressionAsync"),o=ce(e,"scores","nonMaxSuppressionAsync"),l=Jg(a,o,t,r,s,i);t=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([a.data(),o.data()]),u=c[0],d=c[1],{selectedIndices:p,selectedScores:x}=kX(u,d,t,r,s,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:Al(p,"int32"),selectedScores:Al(x)}}const hEe=uEe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dEe(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const a=ce(n,"boxes","nonMaxSuppression"),o=ce(e,"scores","nonMaxSuppression"),l=Jg(a,o,t,r,s,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,p={boxes:a,scores:o},x={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},y=be.runKernel(vH,p,x);return{selectedIndices:y[0],validOutputs:y[1]}}const fEe=ye({nonMaxSuppressionPadded_:dEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function pEe(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const a=ce(n,"boxes","nonMaxSuppressionAsync"),o=ce(e,"scores","nonMaxSuppressionAsync"),l=Jg(a,o,t,r,s,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[p,x]=await Promise.all([a.data(),o.data()]),{selectedIndices:y,validOutputs:v}=NX(p,x,c,u,d,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:Al(y,"int32"),validOutputs:On(v,"int32")}}const mEe=pEe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gEe(n,e,t=!1,r=!1){const s=ce(n,"images","resizeBilinear");fe(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),fe(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),fe(r===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,a=!1;s.rank===3&&(a=!0,i=Ye(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:r,size:e},c=be.runKernel(MH,o,l);return a?Ye(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const xEe=ye({resizeBilinear_:gEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yEe(n,e,t=!1,r=!1){const s=ce(n,"images","resizeNearestNeighbor");fe(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),fe(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),fe(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),fe(r===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,a=!1;s.rank===3&&(a=!0,i=Ye(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:r,size:e},c=be.runKernel(OH,o,l);return a?Ye(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const bEe=ye({resizeNearestNeighbor_:yEe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vEe(n,e="binary",t=!1,r=.5){const s=ce(n,"image","threshold"),i=.2989,a=.587,o=.114,l=s.shape[0]*s.shape[1];let c=ut(Al([r]),255),u,d,p,x;if(fe(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),fe(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),fe(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),fe(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[u,d,p]=Eg(s,[1,1,1],-1);const b=ut(u,i),S=ut(d,a),T=ut(p,o);x=Kt(Kt(b,S),T)}else x=n;if(e==="otsu"){const b=jR(Qr(hD(x),"int32"),hc([]),256);c=_Ee(b,l)}const y=t?GS(x,c):yb(x,c);return Qr(ut(y,255),"int32")}function _Ee(n,e){let t=Al([-1]),r=Al([0]),s=Al([0]),i,a,o,l,c,u;for(let d=0;d<n.size-1;d++){i=Ir(n,0,d+1),a=Ir(n,d+1),c=Mr(Or(i),e),u=Mr(Or(a),e);const p=Or(ut(i,wg(0,i.size)));o=Mr(p,Or(i));const x=Yg(a.shape,i.size),y=Kt(wg(0,a.size),x),v=ut(a,y);l=Mr(Or(v),Or(a));const b=wn(o,l),S=wn(o,l),T=ut(c,u);s=ut(ut(T,b),S);const C=yb(s,r);r=om(C,s,r),t=om(C,Al([d]),t)}return t}const wEe=ye({threshold_:vEe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EEe(n,e,t="nearest",r="constant",s=0,i){const a=ce(n,"image","transform","float32"),o=ce(e,"transforms","transform","float32");fe(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),fe(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),fe(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:a,transforms:o},c={interpolation:t,fillMode:r,fillValue:s,outputShape:i};return be.runKernel(xW,l,c)}const SEe=ye({transform_:EEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TEe(n,e,t){fe(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),fe(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`);const r=ce(n,"a","bandPart");fe(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,a]=r.shape.slice(-2);if(!(e<=i))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`);if(!(t<=a))throw new Error(`bandPart(): numUpper (${t}) must not be greater than the number of columns (${a}).`);e<0&&(e=i),t<0&&(t=a);const o=Ye(wg(0,i,1,"int32"),[-1,1]),l=wg(0,a,1,"int32"),c=wn(o,l),u=E1(GS(c,On(+e,"int32")),KR(c,On(-t,"int32"))),d=lm([i,a],r.dtype);return Ye(Eu(Df(Ye(r,[-1,i,a])).map(p=>om(u,p,d))),s)}const CEe=ye({bandPart_:TEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AEe(n){let e;if(Array.isArray(n)){e=!1,fe(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=n[0].shape[0];for(let i=1;i<n.length;++i)fe(n[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${s})`)}else e=!0,n=Eg(n,n.shape[0],0).map(s=>vb(s,[0]));fe(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],r=n;for(let s=0;s<n.length;++s)t.push(be.tidy(()=>{let i=r[s];if(s>0)for(let a=0;a<s;++a){const o=ut(Or(ut(t[a],i)),t[a]);i=wn(i,o)}return Mr(i,xb(i,"euclidean"))}));return e?Eu(t,0):t}const NEe=ye({gramSchmidt_:AEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kEe(n,e=!1){if(fe(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return PF(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,c)=>l*c),r=Df(Ye(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),s=[],i=[];r.forEach(l=>{const[c,u]=PF(l,e);s.push(c),i.push(u)});const a=Ye(Eu(s,0),n.shape),o=Ye(Eu(i,0),n.shape);return[a,o]}}function PF(n,e=!1){return be.tidy(()=>{fe(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],r=n.shape[1];let s=HR(t),i=vh(n);const a=sg([[1]],[1,1]);let o=vh(a);const l=t>=r?r:t;for(let c=0;c<l;++c){const u=i,d=o,p=s;[o,i,s]=be.tidy(()=>{const x=Ir(i,[c,c],[t-c,1]),y=xb(x),v=Ir(i,[c,c],[1,1]),b=om(yb(v,0),sg([[-1]]),sg([[1]])),S=wn(v,ut(b,y)),T=Mr(x,S);T.shape[0]===1?o=vh(a):o=Zi([a,Ir(T,[1,0],[T.shape[0]-1,T.shape[1]])],0);const C=cu(Mr(yr(b,S),y)),I=Ir(i,[c,0],[t-c,r]),$=ut(C,o),q=_1(o);if(c===0)i=wn(I,yr($,yr(q,I)));else{const G=wn(I,yr($,yr(q,I)));i=Zi([Ir(i,[0,0],[c,r]),G],0)}const U=_1($),F=Ir(s,[0,c],[t,s.shape[1]-c]);if(c===0)s=wn(F,yr(yr(F,o),U));else{const G=wn(F,yr(yr(F,o),U));s=Zi([Ir(s,[0,0],[t,c]),G],1)}return[o,i,s]}),Yi([u,d,p])}return!e&&t>r&&(s=Ir(s,[0,0],[t,r]),i=Ir(i,[0,0],[r,r])),[s,i]})}const IEe=ye({qr_:kEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ta;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ta||(Ta={}));function REe(n,e,t=Ta.SUM_BY_NONZERO_WEIGHTS){const r=ce(n,"losses","computeWeightedLoss");let s=null;e!=null&&(s=ce(e,"weights","computeWeightedLoss"));const i=s==null?r:ut(r,s);if(t===Ta.NONE)return i;if(t===Ta.SUM)return Or(i);if(t===Ta.MEAN){if(s==null)return S1(i);{const a=r.size/s.size,o=Mr(Or(i),Or(s));return a>1?Mr(o,On(a)):o}}if(t===Ta.SUM_BY_NONZERO_WEIGHTS){if(s==null)return Mr(Or(i),On(r.size));{const a=ut(s,Ud(r.shape)),o=Qr(Or(sD(a,On(0))),"float32");return Mr(Or(i),o)}}throw Error(`Unknown reduction: ${t}`)}const Oh=ye({computeWeightedLoss_:REe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DEe(n,e,t,r=Ta.SUM_BY_NONZERO_WEIGHTS){const s=ce(n,"labels","absoluteDifference"),i=ce(e,"predictions","absoluteDifference");let a=null;t!=null&&(a=ce(t,"weights","absoluteDifference")),Da(s.shape,i.shape,"Error in absoluteDifference: ");const o=mo(wn(s,i));return Oh(o,a,r)}const $Ee=ye({absoluteDifference_:DEe});function LEe(n,e,t,r,s=Ta.SUM_BY_NONZERO_WEIGHTS){const i=ce(n,"labels","cosineDistance"),a=ce(e,"predictions","cosineDistance");let o=null;r!=null&&(o=ce(r,"weights","cosineDistance")),Da(i.shape,a.shape,"Error in cosineDistance: ");const l=On(1),c=wn(l,Or(ut(i,a),t,!0));return Oh(c,o,s)}const PEe=ye({cosineDistance_:LEe});function OEe(n,e,t,r=Ta.SUM_BY_NONZERO_WEIGHTS){let s=ce(n,"labels","hingeLoss");const i=ce(e,"predictions","hingeLoss");let a=null;t!=null&&(a=ce(t,"weights","hingeLoss")),Da(s.shape,i.shape,"Error in hingeLoss: ");const o=On(1);s=wn(ut(On(2),s),o);const l=bb(wn(o,ut(s,i)));return Oh(l,a,r)}const MEe=ye({hingeLoss_:OEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FEe(n,e,t,r=1,s=Ta.SUM_BY_NONZERO_WEIGHTS){const i=ce(n,"labels","huberLoss"),a=ce(e,"predictions","huberLoss");let o=null;t!=null&&(o=ce(t,"weights","huberLoss")),Da(i.shape,a.shape,"Error in huberLoss: ");const l=On(r),c=mo(wn(a,i)),u=rD(c,l),d=wn(c,u),p=Kt(ut(On(.5),Il(u)),ut(l,d));return Oh(p,o,s)}const BEe=ye({huberLoss_:FEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zEe(n,e,t,r=1e-7,s=Ta.SUM_BY_NONZERO_WEIGHTS){const i=ce(n,"labels","logLoss"),a=ce(e,"predictions","logLoss");let o=null;t!=null&&(o=ce(t,"weights","logLoss")),Da(i.shape,a.shape,"Error in logLoss: ");const l=On(1),c=On(r),u=cu(ut(i,_g(Kt(a,c)))),d=ut(wn(l,i),_g(Kt(wn(l,a),c))),p=wn(u,d);return Oh(p,o,s)}const jEe=ye({logLoss_:zEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VEe(n,e,t,r=Ta.SUM_BY_NONZERO_WEIGHTS){const s=ce(n,"labels","meanSquaredError"),i=ce(e,"predictions","meanSquaredError");let a=null;t!=null&&(a=ce(t,"weights","meanSquaredError")),Da(s.shape,i.shape,"Error in meanSquaredError: ");const o=fD(s,i);return Oh(o,a,r)}const UEe=ye({meanSquaredError_:VEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GEe(n,e){const t=ce(n,"labels","sigmoidCrossEntropyWithLogits"),r=ce(e,"logits","sigmoidCrossEntropyWithLogits");Da(t.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=bb(r),i=ut(r,t),a=YR(gf(cu(mo(r))));return Kt(wn(s,i),a)}function HEe(n,e,t,r=0,s=Ta.SUM_BY_NONZERO_WEIGHTS){let i=ce(n,"multiClassLabels","sigmoidCrossEntropy");const a=ce(e,"logits","sigmoidCrossEntropy");let o=null;if(t!=null&&(o=ce(t,"weights","sigmoidCrossEntropy")),Da(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){const c=On(r),u=On(1),d=On(.5);i=Kt(ut(i,wn(u,c)),ut(d,c))}const l=GEe(i,a);return Oh(l,o,s)}const WEe=ye({sigmoidCrossEntropy_:HEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qEe(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return wu((s,i,a)=>{const l=QR(i,[t],!0),c=wn(Qr(i,"float32"),l);a([s,c]);const u=cu(ut(c,s));return{value:Or(u,[t]),gradFunc:(x,y)=>{const[v,b]=y,S=gb(x.shape,[t]);return[ut(Ye(x,S),wn(Qr(v,"float32"),gf(b))),ut(Ye(x,S),wn(gf(b),Qr(v,"float32")))]}}})(n,e)}function KEe(n,e,t,r=0,s=Ta.SUM_BY_NONZERO_WEIGHTS){let i=ce(n,"onehotLabels","softmaxCrossEntropy");const a=ce(e,"logits","softmaxCrossEntropy");let o=null;if(t!=null&&(o=ce(t,"weights","softmaxCrossEntropy")),Da(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){const c=On(r),u=On(1),d=On(i.shape[1]);i=Kt(ut(i,wn(u,c)),Mr(c,d))}const l=qEe(i,a);return Oh(l,o,s)}const XEe=ye({softmaxCrossEntropy_:KEe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YEe(n,e,t,r){const s=ce(n,"indices","sparseFillEmptyRows","int32"),i=ce(e,"values","sparseFillEmptyRows"),a=ce(t,"denseShape","sparseFillEmptyRows","int32"),o=ce(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:s,values:i,denseShape:a,defaultValue:o},c=be.runKernel(rW,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const ZEe=ye({sparseFillEmptyRows_:YEe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QEe(n,e,t){const r=ce(n,"inputIndices","sparseReshape","int32"),s=ce(e,"inputShape","sparseReshape","int32"),i=ce(t,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const a={inputIndices:r,inputShape:s,newShape:i},o=be.runKernel(sW,a);return{outputIndices:o[0],outputShape:o[1]}}const JEe=ye({sparseReshape_:QEe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eSe(n,e,t){const r=ce(n,"data","sparseSegmentMean"),s=ce(e,"indices","sparseSegmentMean","int32"),i=ce(t,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const a={data:r,indices:s,segmentIds:i};return be.runKernel(iW,a)}const tSe=ye({sparseSegmentMean_:eSe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nSe(n,e,t){const r=ce(n,"data","sparseSegmentSum"),s=ce(e,"indices","sparseSegmentSum","int32"),i=ce(t,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const a={data:r,indices:s,segmentIds:i};return be.runKernel(aW,a)}const rSe=ye({sparseSegmentSum_:nSe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sSe(n,e,t,r,s,i,a,o){const l=ce(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=ce(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:t,nGramWidths:r,leftPad:s,rightPad:i,padWidth:a,preserveShortSequences:o},d={data:l,dataSplits:c},p=be.runKernel(uW,d,u);return{nGrams:p[0],nGramsSplits:p[1]}}const iSe=ye({stringNGrams_:sSe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aSe(n,e,t=!0){const r=ce(n,"input","stringSplit","string"),s=ce(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const i={skipEmpty:t},a={input:r,delimiter:s},o=be.runKernel(hW,a,i);return{indices:o[0],values:o[1],shape:o[2]}}const oSe=ye({stringSplit_:aSe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lSe(n,e){const t=ce(n,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:t};return be.runKernel(dW,s,r)}const cSe=ye({stringToHashBucketFast_:lSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX={fft:qS,ifft:T1,rfft:KS,irfft:dD},RX={hammingWindow:B2e,hannWindow:TX,frame:CX,stft:U2e},yD={flipLeftRight:q2e,grayscaleToRGB:X2e,resizeNearestNeighbor:bEe,resizeBilinear:xEe,rotateWithOffset:Z2e,cropAndResize:H2e,nonMaxSuppression:J2e,nonMaxSuppressionAsync:oEe,nonMaxSuppressionWithScore:cEe,nonMaxSuppressionWithScoreAsync:hEe,nonMaxSuppressionPadded:fEe,nonMaxSuppressionPaddedAsync:mEe,threshold:wEe,transform:SEe},DX={bandPart:CEe,gramSchmidt:NEe,qr:IEe},$X={absoluteDifference:$Ee,computeWeightedLoss:Oh,cosineDistance:PEe,hingeLoss:MEe,huberLoss:BEe,logLoss:jEe,meanSquaredError:UEe,sigmoidCrossEntropy:WEe,softmaxCrossEntropy:XEe},LX={sparseFillEmptyRows:ZEe,sparseReshape:JEe,sparseSegmentMean:tSe,sparseSegmentSum:rSe},PX={stringNGrams:iSe,stringSplit:oSe,stringToHashBucketFast:cSe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let $f=class extends dq{minimize(e,t=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const a=r.map(o=>({name:o.name,tensor:i[o.name]}));this.applyGradients(a)}else this.applyGradients(i);return Yi(i),t?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return gK(e,t)}dispose(){this.iterations_!=null&&Yi(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:On(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty($f,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let eT=class extends $f{constructor(e,t,r=null){super(),this.learningRate=e,this.rho=t,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=be.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=be.registeredVariables[r],a=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:ar(()=>vo(i).variable(a))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:ar(()=>vo(i).variable(a))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const l=this.accumulatedGrads[s].variable,c=this.accumulatedUpdates[s].variable;ar(()=>{const u=Kt(ut(l,this.rho),ut(Il(o),1-this.rho)),d=ut(Mr(_u(Kt(c,this.epsilon)),_u(Kt(l,this.epsilon))),o),p=Kt(ut(c,this.rho),ut(Il(d),1-this.rho));l.assign(u),c.assign(p);const x=Kt(ut(d,-this.learningRate),i);i.assign(x)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Yi(this.accumulatedGrads.map(e=>e.variable)),Yi(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}};eT.className="Adadelta";Rf(eT);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let tT=class extends $f{constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=be.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:ar(()=>Yg(i.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const o=this.accumulatedGrads[s].variable;ar(()=>{const l=Kt(o,Il(a));o.assign(l);const c=Kt(ut(Mr(a,_u(Kt(l,be.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Yi(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}};tT.className="Adagrad";Rf(tT);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nT=class extends $f{constructor(e,t,r,s=null){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ar(()=>{this.accBeta1=On(t).variable(),this.accBeta2=On(r).variable()}),s==null&&(this.epsilon=be.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ar(()=>{const r=wn(1,this.accBeta1),s=wn(1,this.accBeta2);t.forEach((i,a)=>{const o=be.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:ar(()=>vo(o).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${i}/v`,variable:ar(()=>vo(o).variable(l))});const c=Array.isArray(e)?e[a].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[a].variable,d=this.accumulatedSecondMoment[a].variable,p=Kt(ut(u,this.beta1),ut(c,1-this.beta1)),x=Kt(ut(d,this.beta2),ut(Il(c),1-this.beta2)),y=Mr(p,r),v=Mr(x,s);u.assign(p),d.assign(x);const b=Kt(ut(Mr(y,Kt(_u(v),this.epsilon)),-this.learningRate),o);o.assign(b)}),this.accBeta1.assign(ut(this.accBeta1,this.beta1)),this.accBeta2.assign(ut(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Yi(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Yi(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),ar(()=>{this.accBeta1.assign(vg(this.beta1,this.iterations_+1)),this.accBeta2.assign(vg(this.beta2,this.iterations_+1))});const t=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}};nT.className="Adam";Rf(nT);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rT=class extends $f{constructor(e,t,r,s=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ar(()=>{this.iteration=On(0).variable(),this.accBeta1=On(t).variable()}),s==null&&(this.epsilon=be.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ar(()=>{const r=wn(1,this.accBeta1),s=Mr(-this.learningRate,Kt(ut(this.iteration,this.decay),1));t.forEach((i,a)=>{const o=be.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:vo(o).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${i}/v`,variable:vo(o).variable(l)});const c=Array.isArray(e)?e[a].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[a].variable,d=this.accumulatedWeightedInfNorm[a].variable,p=Kt(ut(u,this.beta1),ut(c,1-this.beta1)),x=ut(d,this.beta2),y=mo(c),v=nD(x,y);u.assign(p),d.assign(v);const b=Kt(ut(Mr(s,r),Mr(p,Kt(v,this.epsilon))),o);o.assign(b)}),this.iteration.assign(Kt(this.iteration,1)),this.accBeta1.assign(ut(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Yi(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Yi(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}};rT.className="Adamax";Rf(rT);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _b=class extends $f{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const a=be.registeredVariables[r];ar(()=>{const o=Kt(ut(this.c,i),a);a.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=eu(On(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}};_b.className="SGD";Rf(_b);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let sT=class extends _b{constructor(e,t,r=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=r,this.accumulations=[],this.m=On(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=be.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:ar(()=>vo(i).variable(!1))});const a=this.accumulations[s].variable,o=Array.isArray(e)?e[s].tensor:e[r];o!=null&&ar(()=>{let l;const c=Kt(ut(this.m,a),o);this.useNesterov?l=Kt(ut(this.c,Kt(o,ut(c,this.m))),i):l=Kt(ut(this.c,c),i),a.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Yi(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}};sT.className="Momentum";Rf(sT);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let iT=class extends $f{constructor(e,t=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=be.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=be.registeredVariables[r],a=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:ar(()=>vo(i).variable(a))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:ar(()=>vo(i).variable(a))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:ar(()=>vo(i).variable(a))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const l=this.accumulatedMeanSquares[s].variable,c=this.accumulatedMoments[s].variable;ar(()=>{const u=Kt(ut(l,this.decay),ut(Il(o),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,p=Kt(ut(d,this.decay),ut(o,1-this.decay)),x=Mr(ut(o,this.learningRate),_u(wn(u,Kt(Il(p),this.epsilon)))),y=Kt(ut(c,this.momentum),x);l.assign(u),d.assign(p),c.assign(y);const v=wn(i,y);i.assign(v)}else{const d=Kt(ut(l,this.decay),ut(Il(o),1-this.decay)),p=Kt(ut(c,this.momentum),Mr(ut(o,this.learningRate),_u(Kt(d,this.epsilon))));l.assign(d),c.assign(p);const x=wn(i,p);i.assign(x)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Yi(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Yi(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Yi(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}};iT.className="RMSProp";Rf(iT);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Id=class{static sgd(e){return new _b(e)}static momentum(e,t,r=!1){return new sT(e,t,r)}static rmsprop(e,t=.9,r=0,s=null,i=!1){return new iT(e,t,r,s,i)}static adam(e=.001,t=.9,r=.999,s=null){return new nT(e,t,r,s)}static adadelta(e=.001,t=.95,r=null){return new eT(e,t,r)}static adamax(e=.002,t=.9,r=.999,s=null,i=0){return new rT(e,t,r,s,i)}static adagrad(e,t=.1){return new tT(e,t)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uSe={sgd:Id.sgd,momentum:Id.momentum,adadelta:Id.adadelta,adagrad:Id.adagrad,rmsprop:Id.rmsprop,adamax:Id.adamax,adam:Id.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hSe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function dSe(){return new Promise(n=>hSe(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fSe(n,e){const t=n[0].length;n.forEach((s,i)=>{fe(s.length===t,()=>`Error in concat${t}D: rank of tensors[${i}] must be the same as the rank of the rest (${t})`)}),fe(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const r=n[0];n.forEach((s,i)=>{for(let a=0;a<t;a++)fe(a===e||s[a]===r[a],()=>`Error in concat${t}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function pSe(n,e){const t=n[0].slice();for(let r=1;r<n.length;r++)t[e]+=n[r][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Gc;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Gc||(Gc={}));function mSe(n,e,t){let r=new Array;if(t==null&&e==null)return r;if(e==null)for(;r.length<n+t.length;)r.push(-1);else r=e.slice();if(t==null)return r;if(n+t.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${r.length}`);for(let s=1;s<t.length;++s){const i=t[s],a=r[r.length-t.length+s],o=r[a];if(i>=0)if(o>=0){if(o!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+n}] = ${i} but shape[${s+n}] = ${o}`)}else r[a]=i}return r}function gSe(n){const e={FIRST_DIM_SIZE:Gc.FIRST_DIM_SIZE,VALUE_ROWIDS:Gc.VALUE_ROWIDS,ROW_LENGTHS:Gc.ROW_LENGTHS,ROW_SPLITS:Gc.ROW_SPLITS,ROW_LIMITS:Gc.ROW_LIMITS,ROW_STARTS:Gc.ROW_STARTS},t=[];for(const r of n)if(r in e)t.push(e[r]);else break;return t}function xSe(n){return n.length===0?0:n[0]===Gc.FIRST_DIM_SIZE?n.length-1:n.length}function ySe(n,e){if(n==null||e==null)return;const t=n.length,r=e.length;if(t>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(t,r-1);++s){const i=n[s],a=e[s+1];if(i>=0&&a>=0&&i!==1&&i!==a)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-n.length}] = ${i} but ragged tensor input.flatValues.shape[${s-n.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bD=30;function bSe(n){return n<=bD?n:yE(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vSe(n,e,t){const r=t*(typeof n=="number"?n:n[0]),s=e*(typeof n=="number"?n:n[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Se(n,e,t,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(n[0]/t),s=s.concat(n.slice(1));else{s=s.concat(n[0]);const i=e.length;for(let a=0;a<i;++a)s=s.concat([n[a+1]/e[a],e[a]]);s=s.concat(n.slice(i+1))}return s}function wSe(n,e,t=!0){const r=[];if(t){r.push(e);for(let s=e+1;s<n;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let a=1;a<n;++a)a>=e*2+1||a%2===1?i.push(a):s.push(a);r.push(...s),r.push(0),r.push(...i)}return r}function ESe(n,e,t,r=!0){const s=[];r?s.push(n[0]/t):s.push(n[0]*t);for(let i=1;i<n.length;++i)i<=e.length?r?s.push(e[i-1]*n[i]):s.push(n[i]/e[i-1]):s.push(n[i]);return s}function SSe(n,e){const t=[0];for(let r=0;r<e;++r)t.push(n[r][0]);return t}function TSe(n,e,t){const r=n.slice(0,1);for(let s=0;s<t;++s)r.push(n[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CSe=1.7580993408473768,ASe=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NSe=.3275911,kSe=.254829592,ISe=-.284496736,RSe=1.421413741,DSe=-1.453152027,$Se=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LSe(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function PSe(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)e[r/2]=n[r],t[r/2]=n[r+1];return{real:e,imag:t}}function OSe(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function MSe(n){const e=Math.floor(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function FSe(n,e){const t=n[e*2],r=n[e*2+1];return{real:t,imag:r}}function BSe(n,e,t,r){n[r*2]=e,n[r*2+1]=t}function zSe(n,e){const t=new Float32Array(n/2),r=new Float32Array(n/2);for(let s=0;s<Math.ceil(n/2);s++){const i=(e?2:-2)*Math.PI*(s/n);t[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:t,imag:r}}function jSe(n,e,t){const r=(t?2:-2)*Math.PI*(n/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yk="->",VSe=/->/g,OF=",",MF="...";function USe(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(VSe,"").length)/yk.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${yk}").`);const[r,s]=n.split(yk);fe(r.indexOf(MF)===-1,()=>`The ellipsis notation ("${MF}") is not supported yet.`);const i=r.split(OF),a=i.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let p=0;p<s.length;++p){const x=s[p];if(!i.some(y=>y.indexOf(x)!==-1))throw new Error(`Output subscripts contain the label ${x} not present in the input subscripts.`);o.indexOf(x)===-1&&o.push(x)}for(let p=0;p<r.length;++p){const x=r[p];o.indexOf(x)===-1&&x!==OF&&o.push(x)}const l=new Array(i.length);for(let p=0;p<a;++p){if(new Set(i[p].split("")).size!==i[p].length)throw new Error(`Found duplicate axes in input component ${i[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let x=0;x<i[p].length;++x)l[p].push(o.indexOf(i[p][x]))}const c=o.length,u=s.length,d=[];for(let p=u;p<c;++p)d.push(p);return{allDims:o,summedDims:d,idDims:l}}function GSe(n,e){let t=new Array(n);t.fill(-1);for(let s=0;s<e.length;++s)t[e[s]]=s;const r=[];for(let s=0;s<n;++s)t[s]===-1&&r.push(s);return t=t.filter(s=>s!==-1),{permutationIndices:t,expandDims:r}}function HSe(n,e,t){const r=new Array(n);for(let s=0;s<t.length;++s){const i=t[s].shape;for(let a=0;a<e[s].length;++a)r[e[s][a]]===void 0?r[e[s][a]]=i[a]:fe(r[e[s][a]]===i[a],()=>`Expected dimension ${r[e[s][a]]} at axis ${a} of input shaped ${JSON.stringify(i)}, but got dimension ${i[a]}`)}}function WSe(n,e){const t=n,r=[];let s=0;n.length===0&&t.push(-1),s=n.length+1;for(let a=0;a<s;++a)r.push([]);const i=[];for(let a=0;a<t.length;++a){const o=t[a],l=KSe(e,o);for(const c of l)i.indexOf(c)===-1&&(r[a].push(c),i.push(c))}return{path:t,steps:r}}function qSe(n){return n.every((e,t)=>e===t)}function KSe(n,e){const t=[];for(let r=0;r<n.length;++r)(n[r].length===0||n[r].indexOf(e)!==-1||e===-1)&&t.push(r);return t}function XSe(n,e,t=0){let r=[];if(typeof e=="number")fe(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(n.shape[t]/e);else{const s=e.reduce((a,o)=>(o===-1&&(a+=1),a),0);fe(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const a=e.reduce((o,l)=>l>0?o+l:o);e[i]=n.shape[t]-a}fe(n.shape[t]===e.reduce((a,o)=>a+o),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YSe(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function ZSe(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function QSe(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JSe(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function eTe(n,e){return`size ${n} must be non-negative, not ${e}`}function tTe(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function nTe(n,e){const t=Hr(n),r=Hr(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${n} outputShape= ${e}`}function rTe(n,e){const t=Hr(n),r=Hr(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${r}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sTe(){return"segment ids must be >= 0"}function iTe(){return"segment ids are not increasing"}function aTe(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function oTe(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lTe(n,e){let t=!1,r;for(n<=bD?(r=n,t=!0):r=yE(n,Math.floor(Math.sqrt(n)));!t;)r>e||r===n?t=!0:r=yE(n,r+1);return r}function cTe(n,e,t){const r=[],s=n.length;for(let i=0;i<s;i++)i!==e?r.push(n[i]):r.push(t);return r}function uTe(n,e,t,r){const s=e.shape.length,i=n.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(t<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${t}).`);for(let d=0;d<r;++d)if(n.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${n.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const a=n.shape[t],o=[];let l=1,c=1,u=1;for(let d=0;d<r;++d)o.push(n.shape[d]),l*=n.shape[d];for(let d=r;d<t;d++)o.push(n.shape[d]),c*=n.shape[d];for(let d=r;d<s;d++)o.push(e.shape[d]);for(let d=t+1;d<i;d++)o.push(n.shape[d]),u*=n.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:a,outputShape:o}}const hTe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:uTe,computeOutShape:cTe,segOpComputeOptimalWindowSize:lTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dTe(n){try{return n.map(e=>_E(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function fTe(n){return n.map(e=>ub(e))}const pTe=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:kSe,ERF_A2:ISe,ERF_A3:RSe,ERF_A4:DSe,ERF_A5:$Se,ERF_P:NSe,PARALLELIZE_THRESHOLD:bD,get RowPartitionType(){return Gc},SELU_SCALE:ASe,SELU_SCALEALPHA:CSe,applyActivation:QS,assertAndGetBroadcastShape:Vs,assertAxesAreInnerMostDims:Kve,assertParamsConsistent:fSe,assignToTypedArray:BSe,axesAreInnerMostDims:GR,calculateShapes:nq,checkEinsumDimSizes:HSe,checkPadOnDimRoundingMode:Ol,combineLocations:aK,combineRaggedTensorToTensorShapes:mSe,complexWithEvenIndex:OSe,complexWithOddIndex:MSe,computeConv2DInfo:fb,computeConv3DInfo:kq,computeDefaultPad:FR,computeDilation2DInfo:qbe,computeOptimalWindowSize:bSe,computeOutAndReduceShapes:qve,computeOutShape:pSe,computePool2DInfo:Nq,computePool3DInfo:Kbe,convertConv2DDataFormat:Iq,decodeEinsumEquation:USe,eitherStridesOrDilationsAreOne:Ph,expandShapeToKeepDim:gb,exponent:jSe,exponents:zSe,fromStringArrayToUint8:fTe,fromUint8ToStringArray:dTe,getAxesPermutation:Xve,getBroadcastDims:ZW,getComplexWithIndex:FSe,getEinsumComputePath:WSe,getEinsumPermutation:GSe,getFusedBiasGradient:ZS,getFusedDyActivation:YS,getImageCenter:vSe,getInnerMostAxes:Zve,getPermuted:wSe,getRaggedRank:xSe,getReductionAxes:RR,getReshaped:_Se,getReshapedPermuted:ESe,getRowPartitionTypesHelper:gSe,getSliceBeginCoords:SSe,getSliceSize:TSe,getSparseFillEmptyRowsIndicesDenseShapeMismatch:YSe,getSparseFillEmptyRowsNegativeIndexErrorMessage:ZSe,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:QSe,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:tTe,getSparseReshapeInputOutputMismatchErrorMessage:rTe,getSparseReshapeInputOutputMultipleErrorMessage:nTe,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:JSe,getSparseReshapeNegativeOutputDimErrorMessage:eTe,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:oTe,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:sTe,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:iTe,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:aTe,getUndoAxesPermutation:Yve,isIdentityPermutation:qSe,log:Kxe,mergeRealAndImagArrays:LSe,prepareAndValidate:tq,prepareSplitSize:XSe,segment_util:hTe,shouldFuse:JS,slice_util:hq,splitRealAndImagArrays:PSe,tupleValuesAreOne:w1,upcastType:VS,validateDefaultValueShape:ySe,validateInput:LR,validateUpdateShape:$R,warn:Bd},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mTe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:AX,nonMaxSuppressionV4Impl:NX,nonMaxSuppressionV5Impl:kX,whereImpl:gX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gTe=Object.freeze(Object.defineProperty({__proto__:null,Abs:BU,Acos:zU,Acosh:jU,AdadeltaOptimizer:eT,AdagradOptimizer:tT,AdamOptimizer:nT,AdamaxOptimizer:rT,Add:mR,AddN:VU,All:UU,Any:GU,ArgMax:HU,ArgMin:WU,Asin:qU,Asinh:KU,Atan:XU,Atan2:ZU,Atanh:YU,AvgPool:QU,AvgPool3D:JU,AvgPool3DGrad:Rxe,AvgPoolGrad:Ixe,BatchMatMul:eG,BatchToSpaceND:tG,Bincount:nG,BroadcastArgs:rG,BroadcastTo:Dxe,Cast:gR,Ceil:sG,ClipByValue:iG,Complex:aG,ComplexAbs:oG,Concat:lG,Conv2D:cG,Conv2DBackpropFilter:uG,Conv2DBackpropInput:hG,Conv3D:dG,Conv3DBackpropFilterV2:$xe,Conv3DBackpropInputV2:fG,Cos:pG,Cosh:mG,CropAndResize:yG,Cumprod:gG,Cumsum:xG,DataStorage:cxe,DenseBincount:bG,DepthToSpace:vG,DepthwiseConv2dNative:_G,DepthwiseConv2dNativeBackpropFilter:wG,DepthwiseConv2dNativeBackpropInput:EG,Diag:SG,Dilation2D:TG,Dilation2DBackpropFilter:Pxe,Dilation2DBackpropInput:Lxe,get ENV(){return fR},Einsum:AG,Elu:NG,EluGrad:Oxe,Environment:MU,Equal:IG,Erf:kG,Exp:RG,ExpandDims:DG,Expm1:$G,FFT:LG,Fill:PG,FlipLeftRight:OG,Floor:MG,FloorDiv:FG,FromPixels:CI,FusedBatchNorm:BG,FusedConv2D:NI,FusedDepthwiseConv2D:kI,GatherNd:jG,GatherV2:zG,Greater:VG,GreaterEqual:UG,IFFT:GG,Identity:xR,Imag:HG,IsFinite:WG,IsInf:qG,IsNan:KG,KernelBackend:CU,LRN:sH,LRNGrad:zxe,LeakyRelu:XG,Less:YG,LessEqual:ZG,LinSpace:QG,Log:JG,Log1p:eH,LogSoftmax:Fxe,LogicalAnd:tH,LogicalNot:nH,LogicalOr:rH,LogicalXor:Mxe,LowerBound:Bxe,Max:iH,MaxPool:oH,MaxPool3D:lH,MaxPool3DGrad:Vxe,MaxPoolGrad:jxe,MaxPoolWithArgmax:cH,Maximum:aH,Mean:uH,Min:hH,Minimum:dH,MirrorPad:fH,Mod:pH,MomentumOptimizer:sT,Multinomial:mH,Multiply:gH,Neg:xH,NonMaxSuppressionV3:bH,NonMaxSuppressionV4:vH,NonMaxSuppressionV5:_H,NotEqual:yH,OP_SCOPE_SUFFIX:ER,OneHot:EH,OnesLike:wH,Optimizer:$f,OptimizerConstructors:Id,Pack:SH,PadV2:TH,Pool:Uxe,Pow:CH,Prelu:AH,Prod:NH,RMSPropOptimizer:iT,RaggedGather:kH,RaggedTensorToTensor:IH,Range:RH,get Rank(){return DI},Real:DH,RealDiv:CG,Reciprocal:$H,get Reduction(){return Ta},Relu:LH,Relu6:FH,Reshape:PH,ResizeBilinear:MH,ResizeBilinearGrad:Hxe,ResizeNearestNeighbor:OH,ResizeNearestNeighborGrad:Gxe,Reverse:BH,RotateWithOffset:EW,Round:zH,Rsqrt:jH,SGDOptimizer:_b,ScatterNd:VH,SearchSorted:UH,Select:GH,Selu:HH,Sigmoid:YH,Sign:XH,Sin:qH,Sinh:KH,Slice:WH,Softmax:nW,Softplus:ZH,SpaceToBatchND:eW,SparseFillEmptyRows:rW,SparseReshape:sW,SparseSegmentMean:iW,SparseSegmentSum:aW,SparseToDense:oW,SplitV:tW,Sqrt:QH,Square:Wxe,SquaredDifference:lW,Step:wW,StridedSlice:cW,StringNGrams:uW,StringSplit:hW,StringToHashBucketFast:dW,Sub:fW,Sum:JH,Tan:pW,Tanh:mW,Tensor:ss,TensorBuffer:wE,Tile:yR,TopK:gW,Transform:xW,Transpose:Hw,Unique:yW,Unpack:bW,UnsortedSegmentSum:vW,UpperBound:qxe,Variable:b1,ZerosLike:_W,_FusedMatMul:AI,abs:mo,acos:gq,acosh:xq,add:Kt,addN:yq,all:bq,any:vq,argMax:_q,argMin:wq,asin:Eq,asinh:Sq,atan:Tq,atan2:Cq,atanh:Aq,avgPool:BR,avgPool3d:Rq,backend:G1e,backend_util:pTe,basicLSTMCell:Dq,batchNorm:pb,batchNorm2d:$q,batchNorm3d:Lq,batchNorm4d:Pq,batchToSpaceND:zR,bincount:jR,booleanMaskAsync:xX,broadcastArgs:Oq,broadcastTo:qy,broadcast_util:J1e,browser:ibe,buffer:xc,cast:Qr,ceil:Mq,clipByValue:Fq,clone:vh,complex:Nh,concat:Zi,concat1d:Bq,concat2d:zq,concat3d:jq,concat4d:Vq,conv1d:Uq,conv2d:mb,conv2dTranspose:Hq,conv3d:Wq,conv3dTranspose:qq,copyRegisteredKernels:Qxe,cos:Kq,cosh:Xq,cosineWindow:XS,cumprod:Yq,cumsum:Zq,customGrad:wu,denseBincount:Qq,deprecationWarn:R1e,depthToSpace:Jq,depthwiseConv2d:US,device_util:kye,diag:eK,dilation2d:tK,disableDeprecationWarnings:I1e,dispose:Yi,disposeVariables:D1e,div:Mr,divNoNan:nK,dot:rK,dropout:wX,einsum:sK,elu:UR,enableDebugMode:k1e,enableProdMode:N1e,enclosingPowerOfTwo:gD,engine:$1e,env:ln,equal:VR,erf:iK,euclideanNorm:lK,exp:gf,expandDims:ih,expm1:cK,eye:HR,fft:qS,fill:Yg,findBackend:j1e,findBackendFactory:V1e,floor:WR,floorDiv:MR,fused:SX,gather:qR,gatherND:_X,gather_util:abe,getBackend:B1e,getGradient:II,getKernel:bE,getKernelsForBackend:vE,grad:S_e,grads:T_e,greater:yb,greaterEqual:KR,ifft:T1,imag:db,image:yD,inTopKAsync:EX,io:IR,irfft:dD,isFinite:uK,isInf:hK,isNaN:dK,keep:eu,kernel_impls:mTe,leakyRelu:XR,less:fK,lessEqual:GS,linalg:DX,linspace:pK,localResponseNormalization:mK,log:_g,log1p:YR,logSigmoid:xK,logSoftmax:yK,logSumExp:QR,logicalAnd:E1,logicalNot:JR,logicalOr:eD,logicalXor:bK,losses:$X,lowerBound:vK,matMul:yr,math:Q1e,max:jp,maxPool:tD,maxPool3d:_K,maxPoolWithArgmax:wK,maximum:nD,mean:S1,memory:L1e,meshgrid:EK,min:AE,minimum:rD,mirrorPad:SK,mod:TK,moments:CK,movingAverage:yX,mul:ut,multiRNNCell:AK,multinomial:NK,neg:cu,nextFrame:dSe,norm:xb,notEqual:sD,oneHot:SE,ones:Ud,onesLike:kK,op:ye,outerProduct:IK,pad:Zg,pad1d:RK,pad2d:DK,pad3d:$K,pad4d:LK,pool:PK,pow:vg,prelu:aD,print:AR,prod:OK,profile:P1e,raggedGather:MK,raggedTensorToTensor:FK,rand:BK,randomGamma:zK,randomNormal:lD,randomStandardNormal:jK,randomUniform:cD,range:wg,ready:F1e,real:bg,reciprocal:VK,registerBackend:U1e,registerGradient:Xxe,registerKernel:SW,relu:bb,relu6:uD,removeBackend:z1e,reshape:Ye,reverse:xf,reverse1d:UK,reverse2d:GK,reverse3d:HK,reverse4d:WK,rfft:KS,round:hD,rsqrt:qK,scalar:On,scatterND:bX,scatter_util:obe,searchSorted:WS,selu:KK,separableConv2d:XK,serialization:ybe,setBackend:M1e,setPlatform:H1e,setdiff1dAsync:YK,sigmoid:zp,sign:ZK,signal:RX,sin:QK,sinh:JK,slice:Ir,slice1d:eX,slice2d:tX,slice3d:nX,slice4d:rX,slice_util:hq,softmax:sX,softplus:ZR,spaceToBatchND:iD,sparse:LX,sparseToDense:vX,spectral:IX,split:Eg,sqrt:_u,square:Il,squaredDifference:fD,squeeze:vb,stack:Eu,step:pD,stridedSlice:iX,string:PX,sub:wn,sum:Or,sumOutType:vye,tan:aX,tanh:CE,tensor:hc,tensor1d:Al,tensor2d:sg,tensor3d:DR,tensor4d:oX,tensor5d:lX,tensor6d:cX,tensor_util:Eye,test_util:Nbe,tidy:ar,tile:rg,time:O1e,topk:uX,train:uSe,transpose:_1,truncatedNormal:hX,unique:dX,unregisterGradient:Zxe,unregisterKernel:Yxe,unsortedSegmentSum:fX,unstack:Df,upcastType:VS,upperBound:pX,util:lye,valueAndGrad:C_e,valueAndGrads:A_e,variable:mX,variableGrads:gK,version_core:kbe,where:om,whereAsync:mD,zeros:lm,zerosLike:vo},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xTe=ln();xTe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var _l;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(_l||(_l={}));var FF;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(FF||(FF={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yTe={};function OX(n){return yTe[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function te(n,e,t,r,s){const i=e.inputParams[n];if(i&&i.inputIndexStart!==void 0){const o=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?o+1:i.inputIndexEnd;if(i.type==="tensor")return Ca(e.inputNames[i.inputIndexStart],t,r,s);if(i.type==="tensors")return e.inputNames.slice(o,l).map(p=>Ca(p,t,r,s));const c=Ca(e.inputNames.slice(o)[0],t,r,s),u=c.dataSync();return i.type==="number"?u[0]:Fp(c.shape,u)}const a=e.attrParams[n];return a&&a.value}function Ca(n,e,t,r){const[s,i]=fo(n);if(r!=null){const o=r.getHashTableHandleByName(s);if(o!=null)return o}const a=t.currentContextIds.find(o=>!!e[NE(s,o)]);return a!==void 0?e[NE(s,a)][i]:void 0}function bTe(n,e,t){return e[NE(n,t.currentContextId)]}function Hc(n,e){const[t,r,s]=fo(n);return[NE(t,e&&e.currentContextId),r,s]}function NE(n,e){return e?`${n}-${e}`:n}function fo(n){const e=n.split(":");if(e.length===1)return[n,0,void 0];const t=e[0],r=e.length===3?e[1]:void 0,s=Number(e[e.length-1]);return[t,s,r]}function t2(n,e,t){let r=te("pad",n,e,t);if(r==="explicit"){r=te("explicitPaddings",n,e,t);const s=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)s[i][0]=r[i*2],s[i][1]=r[i*2+1];return s}return r}function ah(n){return n.kept?n:vh(n)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vTe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_Te=Object.freeze(Object.defineProperty({__proto__:null,json:vTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wTe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],ETe=Object.freeze(Object.defineProperty({__proto__:null,json:wTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const STe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],TTe=Object.freeze(Object.defineProperty({__proto__:null,json:STe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CTe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],ATe=Object.freeze(Object.defineProperty({__proto__:null,json:CTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NTe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],kTe=Object.freeze(Object.defineProperty({__proto__:null,json:NTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ITe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],RTe=Object.freeze(Object.defineProperty({__proto__:null,json:ITe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DTe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],$Te=Object.freeze(Object.defineProperty({__proto__:null,json:DTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LTe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],PTe=Object.freeze(Object.defineProperty({__proto__:null,json:LTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OTe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],MTe=Object.freeze(Object.defineProperty({__proto__:null,json:OTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FTe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],BTe=Object.freeze(Object.defineProperty({__proto__:null,json:FTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zTe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],jTe=Object.freeze(Object.defineProperty({__proto__:null,json:zTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VTe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],UTe=Object.freeze(Object.defineProperty({__proto__:null,json:VTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GTe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],HTe=Object.freeze(Object.defineProperty({__proto__:null,json:GTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WTe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],qTe=Object.freeze(Object.defineProperty({__proto__:null,json:WTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KTe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],XTe=Object.freeze(Object.defineProperty({__proto__:null,json:KTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YTe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],ZTe=Object.freeze(Object.defineProperty({__proto__:null,json:YTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QTe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],JTe=Object.freeze(Object.defineProperty({__proto__:null,json:QTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eCe=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],tCe=Object.freeze(Object.defineProperty({__proto__:null,json:eCe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nCe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],rCe=Object.freeze(Object.defineProperty({__proto__:null,json:nCe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BF{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[_Te,ETe,TTe,ATe,kTe,RTe,$Te,PTe,MTe,BTe,jTe,UTe,HTe,qTe,XTe,ZTe,JTe,tCe,rCe],t=[].concat(...e.map(r=>r.json));this.opMappers=t.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,t={}){const r=e.node,s=[],i=[],a=[],o=r.reduce((v,b)=>(v[b.name]=this.mapNode(b),b.op.startsWith("Placeholder")?s.push(v[b.name]):b.op==="Const"?i.push(v[b.name]):(b.input==null||b.input.length===0)&&a.push(v[b.name]),v),{});let l=[];const c=[];let u={},d={};t!=null&&(u=this.mapSignatureEntries(t.inputs),d=this.mapSignatureEntries(t.outputs));const p=Object.keys(o);p.forEach(v=>{const b=o[v];b.inputNames.forEach((S,T)=>{const[C,,I]=Hc(S),$=o[C];if($.outputs!=null){const q=$.outputs.indexOf(I);if(q!==-1){const U=`${C}:${q}`;b.inputNames[T]=U}}b.inputs.push($),$.children.push(b)})}),Object.keys(d).length===0?p.forEach(v=>{const b=o[v];b.children.length===0&&c.push(b)}):Object.keys(d).forEach(v=>{const[b]=Hc(v),S=o[b];S!=null&&(S.signatureKey=d[v],c.push(S))}),Object.keys(u).length>0?Object.keys(u).forEach(v=>{const[b]=Hc(v),S=o[b];S&&(S.signatureKey=u[v],l.push(S))}):l=s;let x={};e.library!=null&&e.library.function!=null&&(x=e.library.function.reduce((v,b)=>(v[b.signature.name]=this.mapFunction(b),v),{}));const y={nodes:o,inputs:l,outputs:c,weights:i,placeholders:s,signature:t,functions:x};return a.length>0&&(y.initNodes=a),y}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,r)=>(t[e[r].name]=r,t),{})}mapNode(e){const t=OX(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(r.inputParams=t.inputs.reduce((s,i)=>(s[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},s),{})),t.attrs!=null&&(r.attrParams=t.attrs.reduce((s,i)=>{const a=i.type;let o;switch(i.type){case"string":o=qI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=qI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":o=e3(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=e3(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":o=XI(e.attr,i.tfName,i.defaultValue||0),o===void 0&&i.tfDeprecatedName&&(o=XI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":o=JI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=JI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":o=KI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=KI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":o=n3(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=n3(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":o=QI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=QI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":o=t3(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=t3(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":o=YI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=YI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":o=ZI(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=ZI(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":o=zF(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=zF(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return s[i.name]={value:o,type:a},s},{})),r}mapFunction(e){const t=e.nodeDef,r=[],s=[];let i={};t!=null&&(i=t.reduce((d,p)=>(d[p.name]=this.mapNode(p),p.op==="Const"&&s.push(d[p.name]),d),{}));const a=[],o=[];e.signature.inputArg.forEach(d=>{const[p]=Hc(d.name),x={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:vD(d.type),type:"dtype"}},children:[]};x.signatureKey=d.name,a.push(x),i[p]=x}),Object.keys(i).forEach(d=>{const p=i[d];p.inputNames.forEach((x,y)=>{const[v,,b]=Hc(x),S=i[v];if(S.outputs!=null){const T=S.outputs.indexOf(b);if(T!==-1){const C=`${v}:${T}`;p.inputNames[y]=C}}p.inputs.push(S),S.children.push(p)})});const c=e.ret;e.signature.outputArg.forEach(d=>{const[p,x]=Hc(c[d.name]),y=i[p];y!=null&&(y.defaultOutput=x,o.push(y))});const u=this.mapArgsToSignature(e);return{nodes:i,inputs:a,outputs:o,weights:s,placeholders:r,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r),t),{}),outputs:e.signature.outputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r,e.ret),t),{})}}mapArgToTensorInfo(e,t){let r=e.name;return t!=null&&(r=t[r]),{name:r,dtype:e.type}}}function sCe(n){const e=ln().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function MX(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):sCe(n);return e?t:t.toLowerCase()}function qI(n,e,t,r=!1){const s=n[e];return s!=null?MX(s.s,r):t}function KI(n,e,t){const r=n[e];return r?r.b:t}function XI(n,e,t){const r=n[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:t;return typeof s=="number"?s:parseInt(s,10)}function vD(n){switch(typeof n=="string"&&(n=_l[n]),n){case _l.DT_FLOAT:case _l.DT_HALF:return"float32";case _l.DT_INT32:case _l.DT_INT64:case _l.DT_INT8:case _l.DT_UINT8:return"int32";case _l.DT_BOOL:return"bool";case _l.DT_DOUBLE:return"float32";case _l.DT_STRING:return"string";default:return null}}function zF(n,e,t){const r=n[e];return r&&r.func?r.func.name:t}function YI(n,e,t){const r=n[e];return r&&r.type?vD(r.type):t}function ZI(n,e,t){const r=n[e];return r&&r.list&&r.list.type?r.list.type.map(s=>vD(s)):t}function FX(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function QI(n,e,t){const r=n[e];return r&&r.shape?FX(r.shape):t}function JI(n,e,t){const r=n[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):t}function e3(n,e,t,r=!1){const s=n[e];return s&&s.list&&s.list.s?s.list.s.map(i=>MX(i,r)):t}function t3(n,e,t){const r=n[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>FX(s)):t}function n3(n,e,t){const r=n[e];return r&&r.list&&r.list.b?r.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iCe{constructor(e,t,r){this.node=e,this.tensorMap=t,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,i)=>(s[i]=this.getAttr(i),s),{}))}getInput(e){return Ca(e,this.tensorMap,this.context)}getAttr(e,t){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Ca(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return XI(this.node.rawAttrs,e,t);if(r.s!=null)return qI(this.node.rawAttrs,e,t);if(r.b!=null)return KI(this.node.rawAttrs,e,t);if(r.shape!=null)return QI(this.node.rawAttrs,e,t);if(r.type!=null)return YI(this.node.rawAttrs,e,t);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return JI(this.node.rawAttrs,e,t);if(r.list.s!=null)return e3(this.node.rawAttrs,e,t);if(r.list.shape!=null)return t3(this.node.rawAttrs,e,t);if(r.list.b!=null)return n3(this.node.rawAttrs,e,t);if(r.list.type!=null)return ZI(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ra=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:ER,abs:mo,acos:gq,acosh:xq,add:Kt,addN:yq,all:bq,any:vq,argMax:_q,argMin:wq,asin:Eq,asinh:Sq,atan:Tq,atan2:Cq,atanh:Aq,avgPool:BR,avgPool3d:Rq,basicLSTMCell:Dq,batchNorm:pb,batchNorm2d:$q,batchNorm3d:Lq,batchNorm4d:Pq,batchToSpaceND:zR,bincount:jR,booleanMaskAsync:xX,broadcastArgs:Oq,broadcastTo:qy,buffer:xc,cast:Qr,ceil:Mq,clipByValue:Fq,clone:vh,complex:Nh,concat:Zi,concat1d:Bq,concat2d:zq,concat3d:jq,concat4d:Vq,conv1d:Uq,conv2d:mb,conv2dTranspose:Hq,conv3d:Wq,conv3dTranspose:qq,cos:Kq,cosh:Xq,cosineWindow:XS,cumprod:Yq,cumsum:Zq,denseBincount:Qq,depthToSpace:Jq,depthwiseConv2d:US,diag:eK,dilation2d:tK,div:Mr,divNoNan:nK,dot:rK,dropout:wX,einsum:sK,elu:UR,enclosingPowerOfTwo:gD,equal:VR,erf:iK,euclideanNorm:lK,exp:gf,expandDims:ih,expm1:cK,eye:HR,fft:qS,fill:Yg,floor:WR,floorDiv:MR,fused:SX,gather:qR,gatherND:_X,greater:yb,greaterEqual:KR,ifft:T1,imag:db,image:yD,inTopKAsync:EX,irfft:dD,isFinite:uK,isInf:hK,isNaN:dK,leakyRelu:XR,less:fK,lessEqual:GS,linalg:DX,linspace:pK,localResponseNormalization:mK,log:_g,log1p:YR,logSigmoid:xK,logSoftmax:yK,logSumExp:QR,logicalAnd:E1,logicalNot:JR,logicalOr:eD,logicalXor:bK,losses:$X,lowerBound:vK,matMul:yr,max:jp,maxPool:tD,maxPool3d:_K,maxPoolWithArgmax:wK,maximum:nD,mean:S1,meshgrid:EK,min:AE,minimum:rD,mirrorPad:SK,mod:TK,moments:CK,movingAverage:yX,mul:ut,multiRNNCell:AK,multinomial:NK,neg:cu,norm:xb,notEqual:sD,oneHot:SE,ones:Ud,onesLike:kK,op:ye,outerProduct:IK,pad:Zg,pad1d:RK,pad2d:DK,pad3d:$K,pad4d:LK,pool:PK,pow:vg,prelu:aD,print:AR,prod:OK,raggedGather:MK,raggedTensorToTensor:FK,rand:BK,randomGamma:zK,randomNormal:lD,randomStandardNormal:jK,randomUniform:cD,range:wg,real:bg,reciprocal:VK,relu:bb,relu6:uD,reshape:Ye,reverse:xf,reverse1d:UK,reverse2d:GK,reverse3d:HK,reverse4d:WK,rfft:KS,round:hD,rsqrt:qK,scalar:On,scatterND:bX,searchSorted:WS,selu:KK,separableConv2d:XK,setdiff1dAsync:YK,sigmoid:zp,sign:ZK,signal:RX,sin:QK,sinh:JK,slice:Ir,slice1d:eX,slice2d:tX,slice3d:nX,slice4d:rX,softmax:sX,softplus:ZR,spaceToBatchND:iD,sparse:LX,sparseToDense:vX,spectral:IX,split:Eg,sqrt:_u,square:Il,squaredDifference:fD,squeeze:vb,stack:Eu,step:pD,stridedSlice:iX,string:PX,sub:wn,sum:Or,tan:aX,tanh:CE,tensor:hc,tensor1d:Al,tensor2d:sg,tensor3d:DR,tensor4d:oX,tensor5d:lX,tensor6d:cX,tile:rg,topk:uX,transpose:_1,truncatedNormal:hX,unique:dX,unsortedSegmentSum:fX,unstack:Df,upperBound:pX,variable:mX,where:om,whereAsync:mD,zeros:lm,zerosLike:vo},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aCe=(n,e,t,r=ra)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(te("a",n,e,t),te("b",n,e,t))];case"AddN":return[r.addN(te("tensors",n,e,t))];case"FloorMod":case"Mod":return[r.mod(te("a",n,e,t),te("b",n,e,t))];case"Mul":return[r.mul(te("a",n,e,t),te("b",n,e,t))];case"RealDiv":case"Div":return[r.div(te("a",n,e,t),te("b",n,e,t))];case"DivNoNan":return[r.divNoNan(te("a",n,e,t),te("b",n,e,t))];case"FloorDiv":return[r.floorDiv(te("a",n,e,t),te("b",n,e,t))];case"Sub":return[r.sub(te("a",n,e,t),te("b",n,e,t))];case"Minimum":return[r.minimum(te("a",n,e,t),te("b",n,e,t))];case"Maximum":return[r.maximum(te("a",n,e,t),te("b",n,e,t))];case"Pow":return[r.pow(te("a",n,e,t),te("b",n,e,t))];case"SquaredDifference":return[r.squaredDifference(te("a",n,e,t),te("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oCe=(n,e,t,r=ra)=>{switch(n.op){case"Abs":case"ComplexAbs":return[r.abs(te("x",n,e,t))];case"Acos":return[r.acos(te("x",n,e,t))];case"Acosh":return[r.acosh(te("x",n,e,t))];case"Asin":return[r.asin(te("x",n,e,t))];case"Asinh":return[r.asinh(te("x",n,e,t))];case"Atan":return[r.atan(te("x",n,e,t))];case"Atan2":return[r.atan2(te("x",n,e,t),te("y",n,e,t))];case"Atanh":return[r.atanh(te("x",n,e,t))];case"Ceil":return[r.ceil(te("x",n,e,t))];case"Complex":return[r.complex(te("real",n,e,t),te("imag",n,e,t))];case"Cos":return[r.cos(te("x",n,e,t))];case"Cosh":return[r.cosh(te("x",n,e,t))];case"Elu":return[r.elu(te("x",n,e,t))];case"Erf":return[r.erf(te("x",n,e,t))];case"Exp":return[r.exp(te("x",n,e,t))];case"Expm1":return[r.expm1(te("x",n,e,t))];case"Floor":return[r.floor(te("x",n,e,t))];case"Log":return[r.log(te("x",n,e,t))];case"Log1p":return[r.log1p(te("x",n,e,t))];case"Imag":return[r.imag(te("x",n,e,t))];case"Neg":return[r.neg(te("x",n,e,t))];case"Reciprocal":return[r.reciprocal(te("x",n,e,t))];case"Real":return[r.real(te("x",n,e,t))];case"Relu":return[r.relu(te("x",n,e,t))];case"Round":return[r.round(te("x",n,e,t))];case"Selu":return[r.selu(te("x",n,e,t))];case"Sigmoid":return[r.sigmoid(te("x",n,e,t))];case"Sin":return[r.sin(te("x",n,e,t))];case"Sign":return[r.sign(te("x",n,e,t))];case"Sinh":return[r.sinh(te("x",n,e,t))];case"Softplus":return[r.softplus(te("x",n,e,t))];case"Sqrt":return[r.sqrt(te("x",n,e,t))];case"Square":return[r.square(te("x",n,e,t))];case"Tanh":return[r.tanh(te("x",n,e,t))];case"Tan":return[r.tan(te("x",n,e,t))];case"ClipByValue":return[r.clipByValue(te("x",n,e,t),te("clipValueMin",n,e,t),te("clipValueMax",n,e,t))];case"Relu6":return[r.relu6(te("x",n,e,t))];case"Rsqrt":return[r.rsqrt(Ca(n.inputNames[0],e,t))];case"Prod":return[r.prod(te("x",n,e,t),te("axes",n,e,t))];case"LeakyRelu":return[r.leakyRelu(te("x",n,e,t),te("alpha",n,e,t))];case"Prelu":return[r.prelu(te("x",n,e,t),te("alpha",n,e,t))];case"IsNan":return[r.isNaN(Ca(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function El(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){fe(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let r=0;r<n.length;r++){const s=n[r],i=e[r];fe(s<0||i<0||s===i,()=>t+` Shapes ${n} and ${e} must match`)}}}function jF(n){return!(typeof n=="number"||n.some(e=>e<0))}function fy(n,e,t){let r=r3(n,t);const s=!jF(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(i=>{r=r3(i.shape,r)}),!jF(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function r3(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let r=0;r<n.length;++r){const s=n[r],i=e[r];if(s>=0&&i>=0&&s!==i)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[r]=s>=0?s:i}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lCe{constructor(e,t,r,s,i,a,o){this.name=e,this.dtype=t,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=i,this.dynamicSize=a,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=On(0),eu(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),El(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=t,eu(t),r.written=!0,this.tensors[e]=r}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((r,s)=>this.write(r,t[s]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return hc([],[0].concat(this.elementShape));const r=this.readMany(e);return El(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Eu(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return hc([],[0].concat(this.elementShape));const t=[];for(let s=0;s<this.size();s++)t.push(s);const r=this.readMany(t);return El(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Zi(r,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Df(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let r=0;const s=e.map(l=>(r+=l,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=r===0?0:t.size/r,a=[];ar(()=>{t=Ye(t,[1,r,i]);for(let l=0;l<e.length;++l){const u=[0,l===0?0:s[l-1],0],d=[1,e[l],i];a[l]=Ye(Ir(t,u,d),this.elementShape)}return a});const o=[];for(let l=0;l<e.length;l++)o[l]=l;this.writeMany(o,a)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cm{constructor(e,t,r,s=-1){this.tensors=e,this.elementShape=t,this.elementDtype=r,e?.forEach(i=>{if(r!==i.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${i.dtype}`);El(t,i.shape,"TensorList shape mismatch: "),eu(i)}),this.idTensor=On(0),this.maxNumElements=s,eu(this.idTensor)}get id(){return this.idTensor.id}copy(){return new cm([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,r=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);El(e,this.elementShape,"TensorList shape mismatch: ");const s=fy(this.elementShape,this.tensors,e);return ar(()=>{const i=this.tensors.map(a=>Ye(a,s));return Eu(i,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=fy(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,El(s.shape,e,"TensorList shape mismatch: "),Ye(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(El(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");eu(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new cm([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)t.tensors[r]=this.tensors[r];return t}getItem(e,t,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);El(this.tensors[e].shape,t,"TensorList shape mismatch: ");const s=fy(this.elementShape,this.tensors,t);return Ye(this.tensors[e],s)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);El(this.elementShape,t.shape,"TensorList shape mismatch: "),eu(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,r){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);El(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=fy(this.elementShape,this.tensors,r);return e.length===0?hc([],[0].concat(s)):ar(()=>{const i=e.map(a=>Ye(this.tensors[a],s));return Eu(i,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);El(this.elementShape,t,"TensorList shape mismatch: ");const r=fy(this.elementShape,this.tensors,t);return this.size()===0?hc([],[0].concat(r)):ar(()=>{const s=this.tensors.map(i=>Ye(i,r));return Zi(s,0)})}}function cCe(n,e,t){const r=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const s=n.shape.slice(1);El(s,e,"TensorList shape mismatch: ");const i=Df(n);return new cm(i,e,r)}function uCe(n,e,t,r){return new cm([],n,e,r)}function hCe(n,e,t,r){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const i=new cm([],t,n.dtype,r),a=Df(n,0);return e.forEach((o,l)=>{i.setItem(o,a[l])}),i}function dCe(n,e,t){let r=0;const s=e.map(u=>(r+=u,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);const i=n.shape.slice(1),a=r3(i,t),o=r===0?0:n.size/r,l=ar(()=>{const u=[];n=Ye(n,[1,r,o]);for(let d=0;d<e.length;++d){const x=[0,d===0?0:s[d-1],0],y=[1,e[d],o];u[d]=Ye(Ir(n,x,y),a)}return n.dispose(),u}),c=new cm([],t,n.dtype,e.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fCe=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const r=te("thenBranch",n,e,t),s=te("elseBranch",n,e,t),i=te("cond",n,e,t),a=te("args",n,e,t);return(await i.data())[0]?t.functionMap[r].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap):t.functionMap[s].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const r=te("body",n,e,t),s=te("cond",n,e,t),i=te("args",n,e,t),a=await t.functionMap[s].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap),o=i.map(u=>u.id);let l=await a[0].data();a.forEach(u=>{!u.kept&&o.indexOf(u.id)===-1&&u.dispose()});let c=i;for(;l[0];){const u=c;c=await t.functionMap[r].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);const d=c.map(x=>x.id);u.forEach(x=>{!x.kept&&o.indexOf(x.id)===-1&&d.indexOf(x.id)===-1&&x.dispose()});const p=await t.functionMap[s].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);l=await p[0].data(),p.forEach(x=>{!x.kept&&o.indexOf(x.id)===-1&&d.indexOf(x.id)===-1&&x.dispose()})}return c}case"LoopCond":{const r=te("pred",n,e,t);return[ah(r)]}case"Switch":{const r=te("pred",n,e,t);let s=te("data",n,e,t);return s.kept||(s=ah(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=n.inputNames.find(s=>Ca(s,e,t)!==void 0);if(r){const s=Ca(r,e,t);return[ah(s)]}return}case"Enter":{const r=te("frameName",n,e,t),s=te("tensor",n,e,t);return t.enterFrame(r),[ah(s)]}case"Exit":{const r=te("tensor",n,e,t);return t.exitFrame(),[ah(r)]}case"NextIteration":{const r=te("tensor",n,e,t);return t.nextIteration(),[ah(r)]}case"TensorArrayV3":{const r=te("size",n,e,t),s=te("dtype",n,e,t),i=te("elementShape",n,e,t),a=te("dynamicSize",n,e,t),o=te("clearAfterRead",n,e,t),l=te("identicalElementShapes",n,e,t),c=te("name",n,e,t),u=new lCe(c,s,r,i,l,a,o);return t.addTensorArray(u),[u.idTensor,On(1)]}case"TensorArrayWriteV3":{const r=te("tensorArrayId",n,e,t),s=te("index",n,e,t),i=te("tensor",n,e,t),a=t.getTensorArray(r.id);return a.write(s,i),[a.idTensor]}case"TensorArrayReadV3":{const r=te("tensorArrayId",n,e,t),s=te("index",n,e,t);return[t.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=te("tensorArrayId",n,e,t),s=te("indices",n,e,t),i=te("dtype",n,e,t);return[t.getTensorArray(r.id).gather(s,i)]}case"TensorArrayScatterV3":{const r=te("tensorArrayId",n,e,t),s=te("indices",n,e,t),i=te("tensor",n,e,t),a=t.getTensorArray(r.id);return a.scatter(s,i),[a.idTensor]}case"TensorArrayConcatV3":{const r=te("tensorArrayId",n,e,t),s=t.getTensorArray(r.id),i=te("dtype",n,e,t);return[s.concat(i)]}case"TensorArraySplitV3":{const r=te("tensorArrayId",n,e,t),s=te("tensor",n,e,t),i=te("lengths",n,e,t),a=t.getTensorArray(r.id);return a.split(i,s),[a.idTensor]}case"TensorArraySizeV3":{const r=te("tensorArrayId",n,e,t),s=t.getTensorArray(r.id);return[On(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=te("tensorArrayId",n,e,t),s=t.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=te("tensorListId",n,e,t),s=te("index",n,e,t),i=te("tensor",n,e,t),a=t.getTensorList(r.id);return a.setItem(s,i),[a.idTensor]}case"TensorListGetItem":{const r=te("tensorListId",n,e,t),s=te("index",n,e,t),i=te("elementShape",n,e,t),a=te("elementDType",n,e,t);return[t.getTensorList(r.id).getItem(s,i,a)]}case"TensorListScatterV2":case"TensorListScatter":{const r=te("indices",n,e,t),s=te("tensor",n,e,t),i=te("elementShape",n,e,t),a=te("numElements",n,e,t),o=hCe(s,r,i,a);return t.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=te("elementShape",n,e,t),s=te("elementDType",n,e,t);let i;n.op==="TensorListReserve"?i="numElements":i="maxNumElements";const a=te(i,n,e,t),o=n.op==="TensorListReserve"?-1:a,l=uCe(r,s,a,o);return t.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=te("tensorListId",n,e,t),s=te("indices",n,e,t),i=te("elementShape",n,e,t),a=te("elementDType",n,e,t);return[t.getTensorList(r.id).gather(s,a,i)]}case"TensorListStack":{const r=te("tensorListId",n,e,t),s=te("elementShape",n,e,t),i=te("elementDType",n,e,t),a=te("numElements",n,e,t);return[t.getTensorList(r.id).stack(s,i,a)]}case"TensorListFromTensor":{const r=te("tensor",n,e,t),s=te("elementShape",n,e,t),i=te("elementDType",n,e,t),a=cCe(r,s,i);return t.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=te("tensorListId",n,e,t),s=t.getTensorList(r.id),i=te("dtype",n,e,t),a=te("elementShape",n,e,t);return[s.concat(i,a)]}case"TensorListPushBack":{const r=te("tensorListId",n,e,t),s=te("tensor",n,e,t),i=t.getTensorList(r.id);return i.pushBack(s),[i.idTensor]}case"TensorListPopBack":{const r=te("tensorListId",n,e,t),s=te("elementShape",n,e,t),i=te("elementDType",n,e,t);return[t.getTensorList(r.id).popBack(s,i)]}case"TensorListSplit":{const r=te("tensor",n,e,t),s=te("elementShape",n,e,t),i=te("lengths",n,e,t),a=dCe(r,i,s);return t.addTensorList(a),[a.idTensor]}case"TensorListLength":{const r=te("tensorListId",n,e,t),s=t.getTensorList(r.id);return[On(s.size(),"int32")]}case"TensorListResize":{const r=te("tensorListId",n,e,t),s=te("size",n,e,t),a=t.getTensorList(r.id).resize(s);return t.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VF(n,e,t){const[r,s]=te("fusedOps",n,e,t),i=r==="biasadd",a=!i,o=s==="prelu",l=r==="fusedbatchnorm",c=te("numArgs",n,e,t);if(i){if(o&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=te("strides",n,e,t),d=t2(n,e,t),p=te("dataFormat",n,e,t).toUpperCase(),x=te("dilations",n,e,t);let[y,v]=te("args",n,e,t);a&&(v=y,y=void 0);const b=te("leakyreluAlpha",n,e,t);return{stride:u,pad:d,dataFormat:p,dilations:x,biasArg:y,preluArg:v,activationFunc:s,leakyreluAlpha:b}}const pCe=(n,e,t,r=ra)=>{switch(n.op){case"Conv1D":{const s=te("stride",n,e,t),i=te("pad",n,e,t),a=te("dataFormat",n,e,t).toUpperCase(),o=te("dilation",n,e,t);return[r.conv1d(te("x",n,e,t),te("filter",n,e,t),s,i,a,o)]}case"Conv2D":{const s=te("strides",n,e,t),i=t2(n,e,t),a=te("dataFormat",n,e,t).toUpperCase(),o=te("dilations",n,e,t);return[r.conv2d(te("x",n,e,t),te("filter",n,e,t),[s[1],s[2]],i,a,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:s,pad:i,dataFormat:a,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=VF(n,e,t);return[r.fused.conv2d({x:te("x",n,e,t),filter:te("filter",n,e,t),strides:[s[1],s[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:i,dataFormat:a,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=VF(n,e,t);return[r.fused.depthwiseConv2d({x:te("x",n,e,t),filter:te("filter",n,e,t),strides:[s[1],s[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=te("outputShape",n,e,t),i=te("strides",n,e,t),a=t2(n,e,t);return[r.conv2dTranspose(te("x",n,e,t),te("filter",n,e,t),s,[i[1],i[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=te("strides",n,e,t),i=t2(n,e,t),a=te("dilations",n,e,t),o=te("dataFormat",n,e,t).toUpperCase();return[r.depthwiseConv2d(te("input",n,e,t),te("filter",n,e,t),[s[1],s[2]],i,o,[a[1],a[2]])]}case"Conv3D":{const s=te("strides",n,e,t),i=te("pad",n,e,t),a=te("dataFormat",n,e,t).toUpperCase(),o=te("dilations",n,e,t);return[r.conv3d(te("x",n,e,t),te("filter",n,e,t),[s[1],s[2],s[3]],i,a,[o[1],o[2],o[3]])]}case"AvgPool":{const s=te("strides",n,e,t),i=te("pad",n,e,t),a=te("kernelSize",n,e,t);return[r.avgPool(te("x",n,e,t),[a[1],a[2]],[s[1],s[2]],i)]}case"MaxPool":{const s=te("strides",n,e,t),i=te("pad",n,e,t),a=te("kernelSize",n,e,t);return[r.maxPool(te("x",n,e,t),[a[1],a[2]],[s[1],s[2]],i)]}case"MaxPoolWithArgmax":{const s=te("strides",n,e,t),i=te("pad",n,e,t),a=te("kernelSize",n,e,t),o=te("includeBatchInIndex",n,e,t),{result:l,indexes:c}=r.maxPoolWithArgmax(te("x",n,e,t),[a[1],a[2]],[s[1],s[2]],i,o);return[l,c]}case"AvgPool3D":{const s=te("strides",n,e,t),i=te("pad",n,e,t),a=te("kernelSize",n,e,t);return[r.avgPool3d(te("x",n,e,t),[a[1],a[2],a[3]],[s[1],s[2],s[3]],i)]}case"MaxPool3D":{const s=te("strides",n,e,t),i=te("pad",n,e,t),a=te("kernelSize",n,e,t);return[r.maxPool3d(te("x",n,e,t),[a[1],a[2],a[3]],[s[1],s[2],s[3]],i)]}case"Dilation2D":{const s=te("strides",n,e,t),i=te("pad",n,e,t),a=te("dilations",n,e,t),o=s[1],l=s[2],c=a[1],u=a[2];return[r.dilation2d(te("x",n,e,t),te("filter",n,e,t),[o,l],i,[c,u],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mCe=(n,e,t,r=ra)=>{switch(n.op){case"Fill":{const s=te("shape",n,e,t),i=te("dtype",n,e,t),a=te("value",n,e,t);return[r.fill(s,a,i)]}case"LinSpace":{const s=te("start",n,e,t),i=te("stop",n,e,t),a=te("num",n,e,t);return[r.linspace(s,i,a)]}case"Multinomial":{const s=te("logits",n,e,t),i=te("numSamples",n,e,t),a=te("seed",n,e,t);return[r.multinomial(s,i,a)]}case"OneHot":{const s=te("indices",n,e,t),i=te("depth",n,e,t),a=te("onValue",n,e,t),o=te("offValue",n,e,t),l=te("dtype",n,e,t);return[r.oneHot(s,i,a,o,l)]}case"Ones":return[r.ones(te("shape",n,e,t),te("dtype",n,e,t))];case"OnesLike":return[r.onesLike(te("x",n,e,t))];case"RandomStandardNormal":return[r.randomStandardNormal(te("shape",n,e,t),te("dtype",n,e,t),te("seed",n,e,t))];case"RandomUniform":return[r.randomUniform(te("shape",n,e,t),te("minval",n,e,t),te("maxval",n,e,t),te("dtype",n,e,t))];case"Range":{const s=te("start",n,e,t),i=te("stop",n,e,t),a=te("step",n,e,t);return[r.range(s,i,a,te("dtype",n,e,t))]}case"TruncatedNormal":{const s=te("shape",n,e,t),i=te("mean",n,e,t),a=te("stdDev",n,e,t),o=te("seed",n,e,t);return[r.truncatedNormal(s,i,a,te("dtype",n,e,t),o)]}case"Zeros":return[r.zeros(te("shape",n,e,t),te("dtype",n,e,t))];case"ZerosLike":return[r.zerosLike(te("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bk(n,e,t){const r=te("boxes",n,e,t),s=te("scores",n,e,t),i=te("maxOutputSize",n,e,t),a=te("iouThreshold",n,e,t),o=te("scoreThreshold",n,e,t),l=te("softNmsSigma",n,e,t);return{boxes:r,scores:s,maxOutputSize:i,iouThreshold:a,scoreThreshold:o,softNmsSigma:l}}const gCe=async(n,e,t,r,s=ra)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=bk(n,e,t),d=await s.image.nonMaxSuppressionWithScoreAsync(i,a,o,l,c,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=bk(n,e,t),u=te("padToMaxOutputSize",n,e,t),d=await s.image.nonMaxSuppressionPaddedAsync(i,a,o,l,c,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=bk(n,e,t);return[await s.image.nonMaxSuppressionAsync(i,a,o,l,c)]}case"Where":{const i=s.cast(te("condition",n,e,t),"bool"),a=[await s.whereAsync(i)];return i.dispose(),a}case"ListDiff":return s.setdiff1dAsync(te("x",n,e,t),te("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xCe=(n,e,t,r=ra)=>{switch(n.op){case"LowerBound":{const s=te("sortedSequence",n,e,t),i=te("values",n,e,t);return[r.lowerBound(s,i)]}case"TopKV2":{const s=te("x",n,e,t),i=te("k",n,e,t),a=te("sorted",n,e,t),o=r.topk(s,i,a);return[o.values,o.indices]}case"UpperBound":{const s=te("sortedSequence",n,e,t),i=te("values",n,e,t);return[r.upperBound(s,i)]}case"Unique":{const s=te("x",n,e,t),i=r.unique(s);return[i.values,i.indices]}case"UniqueV2":{const s=te("x",n,e,t),i=te("axis",n,e,t),a=r.unique(s,i);return[a.values,a.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yCe=(n,e,t,r=ra)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const s=te("default",n,e,t);return[Ca(n.name,e,t)||s];case"Placeholder":return[Ca(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=te("x",n,e,t);return[ah(u)]}case"IdentityN":return te("x",n,e,t).map(u=>ah(u));case"Snapshot":const i=te("x",n,e,t);return[ah(i)];case"Shape":return[r.tensor1d(te("x",n,e,t).shape,"int32")];case"ShapeN":return te("x",n,e,t).map(u=>r.tensor1d(u.shape));case"Size":return[r.scalar(te("x",n,e,t).size,"int32")];case"Rank":return[r.scalar(te("x",n,e,t).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const a=te("x",n,e,t),o=te("data",n,e,t),l=te("message",n,e,t),c=te("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<o.length;u++)console.log(Array.prototype.slice.call(o[u].dataSync()).slice(0,c));return[a];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bCe{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=On(0),this.tensorMap=new Map,eu(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return On(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),ar(()=>{const s=Df(t),i=r.length,a=s.length;fe(i===a,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${a} elements.`);for(let o=0;o<i;o++){const l=r[o],c=s[o];eu(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return ar(()=>{const s=[];for(let i=0;i<r.length;i++){const a=r[i],o=this.findWithDefault(a,t);s.push(o)}return Eu(s)})}findWithDefault(e,t){const r=this.tensorMap.get(e);return r??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vCe=async(n,e,t,r)=>{switch(n.op){case"HashTable":case"HashTableV2":{const s=te("keyDType",n,e,t),i=te("valueDType",n,e,t),a=new bCe(s,i);return r.addHashTable(n.name,a),[a.handle]}case"LookupTableImport":case"LookupTableImportV2":{const s=te("tableHandle",n,e,t,r),i=te("keys",n,e,t),a=te("values",n,e,t);return[await r.getHashTableById(s.id).import(i,a)]}case"LookupTableFind":case"LookupTableFindV2":{const s=te("tableHandle",n,e,t,r),i=te("keys",n,e,t),a=te("defaultValue",n,e,t);return[await r.getHashTableById(s.id).find(i,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=te("tableHandle",n,e,t,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ce=(n,e,t,r=ra)=>{switch(n.op){case"ResizeBilinear":{const s=te("images",n,e,t),i=te("size",n,e,t),a=te("alignCorners",n,e,t),o=te("halfPixelCenters",n,e,t);return[r.image.resizeBilinear(s,[i[0],i[1]],a,o)]}case"ResizeNearestNeighbor":{const s=te("images",n,e,t),i=te("size",n,e,t),a=te("alignCorners",n,e,t),o=te("halfPixelCenters",n,e,t);return[r.image.resizeNearestNeighbor(s,[i[0],i[1]],a,o)]}case"CropAndResize":{const s=te("image",n,e,t),i=te("boxes",n,e,t),a=te("boxInd",n,e,t),o=te("cropSize",n,e,t),l=te("method",n,e,t),c=te("extrapolationValue",n,e,t);return[r.image.cropAndResize(s,i,a,o,l,c)]}case"ImageProjectiveTransformV3":{const s=te("images",n,e,t),i=te("transforms",n,e,t),a=te("outputShape",n,e,t),o=te("fillValue",n,e,t),l=te("interpolation",n,e,t),c=te("fillMode",n,e,t);return[r.image.transform(s,i,l.toLowerCase(),c.toLowerCase(),o,a)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wCe=(n,e,t,r=ra)=>{switch(n.op){case"Equal":return[r.equal(te("a",n,e,t),te("b",n,e,t))];case"NotEqual":return[r.notEqual(te("a",n,e,t),te("b",n,e,t))];case"Greater":return[r.greater(te("a",n,e,t),te("b",n,e,t))];case"GreaterEqual":return[r.greaterEqual(te("a",n,e,t),te("b",n,e,t))];case"Less":return[r.less(te("a",n,e,t),te("b",n,e,t))];case"LessEqual":return[r.lessEqual(te("a",n,e,t),te("b",n,e,t))];case"LogicalAnd":return[r.logicalAnd(te("a",n,e,t),te("b",n,e,t))];case"LogicalNot":return[r.logicalNot(te("a",n,e,t))];case"LogicalOr":return[r.logicalOr(te("a",n,e,t),te("b",n,e,t))];case"Select":case"SelectV2":return[r.where(te("condition",n,e,t),te("a",n,e,t),te("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ECe=(n,e,t,r=ra)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(te("a",n,e,t),te("b",n,e,t),te("transposeA",n,e,t),te("transposeB",n,e,t))];case"Einsum":return[r.einsum(te("equation",n,e,t),...te("tensors",n,e,t))];case"Transpose":return[r.transpose(te("x",n,e,t),te("perm",n,e,t))];case"_FusedMatMul":const[s,i]=te("fusedOps",n,e,t),a=s==="biasadd",o=i==="prelu",l=te("numArgs",n,e,t),c=te("leakyreluAlpha",n,e,t);if(a){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,d]=te("args",n,e,t);return[r.fused.matMul({a:te("a",n,e,t),b:te("b",n,e,t),transposeA:te("transposeA",n,e,t),transposeB:te("transposeB",n,e,t),bias:u,activation:i,preluActivationWeights:d,leakyreluAlpha:c})];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SCe=(n,e,t,r=ra)=>{switch(n.op){case"EuclideanNorm":return[r.euclideanNorm(te("x",n,e,t),te("axis",n,e,t),te("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(te("x",n,e,t),te("mean",n,e,t),te("variance",n,e,t),te("offset",n,e,t),te("scale",n,e,t),te("epsilon",n,e,t))];case"FusedBatchNormV3":return[r.batchNorm(te("x",n,e,t),te("mean",n,e,t),te("variance",n,e,t),te("offset",n,e,t),te("scale",n,e,t),te("epsilon",n,e,t))];case"LRN":return[r.localResponseNormalization(te("x",n,e,t),te("radius",n,e,t),te("bias",n,e,t),te("alpha",n,e,t),te("beta",n,e,t))];case"Softmax":return[r.softmax(te("x",n,e,t))];case"LogSoftmax":return[r.logSoftmax(te("x",n,e,t))];case"SparseToDense":return[r.sparseToDense(te("sparseIndices",n,e,t),te("outputShape",n,e,t),te("sparseValues",n,e,t),te("defaultValue",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TCe=(n,e,t,r=ra)=>{switch(n.op){case"Max":{const o=te("axis",n,e,t),l=te("keepDims",n,e,t);return[r.max(te("x",n,e,t),o,l)]}case"Mean":{const o=te("axis",n,e,t),l=te("keepDims",n,e,t);return[r.mean(te("x",n,e,t),o,l)]}case"Min":{const o=te("axis",n,e,t),l=te("keepDims",n,e,t);return[r.min(te("x",n,e,t),o,l)]}case"Sum":{const o=te("axis",n,e,t),l=te("keepDims",n,e,t);return[r.sum(te("x",n,e,t),o,l)]}case"All":{const o=te("axis",n,e,t),l=te("keepDims",n,e,t);return[r.all(te("x",n,e,t),o,l)]}case"Any":{const o=te("axis",n,e,t),l=te("keepDims",n,e,t);return[r.any(te("x",n,e,t),o,l)]}case"ArgMax":{const o=te("axis",n,e,t);return[r.argMax(te("x",n,e,t),o)]}case"ArgMin":{const o=te("axis",n,e,t);return[r.argMin(te("x",n,e,t),o)]}case"Prod":{const o=te("axis",n,e,t),l=te("keepDims",n,e,t);return[r.prod(te("x",n,e,t),o,l)]}case"Cumprod":{const o=te("axis",n,e,t),l=te("exclusive",n,e,t),c=te("reverse",n,e,t);return[r.cumprod(te("x",n,e,t),o,l,c)]}case"Cumsum":{const o=te("axis",n,e,t),l=te("exclusive",n,e,t),c=te("reverse",n,e,t);return[r.cumsum(te("x",n,e,t),o,l,c)]}case"Bincount":const s=te("x",n,e,t),i=te("weights",n,e,t),a=te("size",n,e,t);return[r.bincount(s,i,a)];case"DenseBincount":{const o=te("x",n,e,t),l=te("weights",n,e,t),c=te("size",n,e,t),u=te("binaryOutput",n,e,t);return[r.denseBincount(o,l,c,u)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CCe=(n,e,t,r=ra)=>{switch(n.op){case"ConcatV2":case"Concat":{const s=te("n",n,e,t),i=te("axis",n,e,t);let a=te("tensors",n,e,t);return a=a.slice(0,s),[r.concat(a,i)]}case"Gather":{const s=te("x",n,e,t),i=te("indices",n,e,t);return[r.gather(s,r.cast(i,"int32"),0)]}case"GatherV2":{const s=te("axis",n,e,t),i=te("batchDims",n,e,t),a=te("x",n,e,t),o=te("indices",n,e,t);return[r.gather(a,r.cast(o,"int32"),s,i)]}case"Reverse":{const s=te("dims",n,e,t),i=[];for(let o=0;o<s.length;o++)s[o]&&i.push(o);const a=te("x",n,e,t);return[r.reverse(a,i)]}case"ReverseV2":{const s=te("axis",n,e,t),i=te("x",n,e,t);return[r.reverse(i,s)]}case"Slice":{const s=te("begin",n,e,t),i=te("size",n,e,t);return[r.slice(te("x",n,e,t),s,i)]}case"StridedSlice":{const s=te("begin",n,e,t),i=te("end",n,e,t),a=te("strides",n,e,t),o=te("beginMask",n,e,t),l=te("endMask",n,e,t),c=te("ellipsisMask",n,e,t),u=te("newAxisMask",n,e,t),d=te("shrinkAxisMask",n,e,t),p=te("x",n,e,t);return[r.stridedSlice(p,s,i,a,o,l,c,u,d)]}case"Pack":return ar(()=>{const s=te("axis",n,e,t),i=te("tensors",n,e,t),a=i[0].shape,o=r.squeeze(i[0]).shape,l=i.map(c=>{const u=bu(c.shape,a);if(!u&&!bu(r.squeeze(c).shape,o))throw new Error("the input tensors shape does not match");return u?c:r.reshape(c,a)});return[r.stack(l,s)]});case"Unpack":{const s=te("axis",n,e,t),i=te("tensor",n,e,t);return r.unstack(i,s)}case"Tile":{const s=te("reps",n,e,t);return[r.tile(te("x",n,e,t),s)]}case"Split":case"SplitV":{const s=te("axis",n,e,t),i=te("numOrSizeSplits",n,e,t),a=te("x",n,e,t);return r.split(a,i,s)}case"ScatterNd":{const s=te("indices",n,e,t),i=te("values",n,e,t),a=te("shape",n,e,t);return[r.scatterND(s,i,a)]}case"GatherNd":{const s=te("x",n,e,t),i=te("indices",n,e,t);return[r.gatherND(s,i)]}case"SparseToDense":{const s=te("sparseIndices",n,e,t),i=te("outputShape",n,e,t),a=te("sparseValues",n,e,t),o=te("defaultValue",n,e,t);return[r.sparseToDense(s,a,i,a.dtype===o.dtype?o:r.cast(o,a.dtype))]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ACe=(n,e,t,r=ra)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:i,emptyRowIndicator:a,reverseIndexMap:o}=r.sparse.sparseFillEmptyRows(te("indices",n,e,t),te("values",n,e,t),te("denseShape",n,e,t),te("defaultValue",n,e,t));return[s,i,a,o]}case"SparseReshape":{const{outputIndices:s,outputShape:i}=r.sparse.sparseReshape(te("inputIndices",n,e,t),te("inputShape",n,e,t),te("newShape",n,e,t));return[s,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(te("data",n,e,t),te("indices",n,e,t),te("segmentIds",n,e,t))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(te("data",n,e,t),te("indices",n,e,t),te("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NCe=(n,e,t,r=ra)=>{switch(n.op){case"FFT":return[r.fft(te("x",n,e,t))];case"IFFT":return[r.ifft(te("x",n,e,t))];case"RFFT":return[r.rfft(te("x",n,e,t))];case"IRFFT":return[r.irfft(te("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kCe=(n,e,t,r=ra)=>{switch(n.op){case"StringNGrams":{const{nGrams:s,nGramsSplits:i}=r.string.stringNGrams(te("data",n,e,t),te("dataSplits",n,e,t),te("separator",n,e,t),te("nGramWidths",n,e,t),te("leftPad",n,e,t),te("rightPad",n,e,t),te("padWidth",n,e,t),te("preserveShortSequences",n,e,t));return[s,i]}case"StringSplit":{const{indices:s,values:i,shape:a}=r.string.stringSplit(te("input",n,e,t),te("delimiter",n,e,t),te("skipEmpty",n,e,t));return[s,i,a]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(te("input",n,e,t),te("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ICe=(n,e,t,r=ra)=>{switch(n.op){case"Cast":return[r.cast(te("x",n,e,t),te("dtype",n,e,t))];case"ExpandDims":{const s=te("axis",n,e,t);return[r.expandDims(te("x",n,e,t),s)]}case"Squeeze":{const s=te("axis",n,e,t);return[r.squeeze(te("x",n,e,t),s)]}case"Reshape":return[r.reshape(te("x",n,e,t),te("shape",n,e,t))];case"MirrorPad":return[r.mirrorPad(te("x",n,e,t),te("padding",n,e,t),te("mode",n,e,t))];case"PadV2":case"Pad":return[r.pad(te("x",n,e,t),te("padding",n,e,t),te("constantValue",n,e,t))];case"SpaceToBatchND":{const s=te("blockShape",n,e,t),i=te("paddings",n,e,t);return[r.spaceToBatchND(te("x",n,e,t),s,i)]}case"BatchToSpaceND":{const s=te("blockShape",n,e,t),i=te("crops",n,e,t);return[r.batchToSpaceND(te("x",n,e,t),s,i)]}case"DepthToSpace":{const s=te("blockSize",n,e,t),i=te("dataFormat",n,e,t).toUpperCase();return[r.depthToSpace(te("x",n,e,t),s,i)]}case"BroadcastTo":return[r.broadcastTo(te("x",n,e,t),te("shape",n,e,t))];case"BroadcastArgs":return[r.broadcastArgs(te("s0",n,e,t),te("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UF(n,e,t,r,s=ar){const i=((a,o,l)=>{switch(a.category){case"arithmetic":return s(()=>aCe(a,o,l));case"basic_math":return s(()=>oCe(a,o,l));case"control":return fCe(a,o,l);case"convolution":return s(()=>pCe(a,o,l));case"creation":return s(()=>mCe(a,o,l));case"dynamic":return gCe(a,o,l);case"evaluation":return s(()=>xCe(a,o,l));case"image":return s(()=>_Ce(a,o,l));case"graph":return s(()=>yCe(a,o,l));case"logical":return s(()=>wCe(a,o,l));case"matrices":return s(()=>ECe(a,o,l));case"normalization":return s(()=>SCe(a,o,l));case"reduction":return s(()=>TCe(a,o,l));case"slice_join":return s(()=>CCe(a,o,l));case"sparse":return s(()=>ACe(a,o,l));case"spectral":return s(()=>NCe(a,o,l));case"string":return s(()=>kCe(a,o,l));case"transformation":return s(()=>ICe(a,o,l));case"hash_table":return vCe(a,o,l,r);case"custom":const c=OX(a.op);if(c&&c.customExecutor)return c.customExecutor(new iCe(a,o,l));throw TypeError(`Custom op ${a.op} is not registered.`);default:throw TypeError(`Unknown op '${a.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return rm(i)?i.then(a=>[].concat(a)):[].concat(i)}class GF{constructor(e={},t={},r={},s={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=r,this.functionMap=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const r=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HF(n,e,t,r){const s=new Set,i=[];let a=null,o=null;const l=new Set,c=Object.keys(n).map(p=>fo(p)[0]);let u=[];r!=null&&(u=r.map(p=>fo(p.name)[0]));const d=[...e];for(;d.length>0;){const p=d.pop();if((BX(p)||PCe(p)||OCe(p))&&a==null&&(a=p,o=a.children.map(x=>x.name).filter(x=>s.has(x))),s.add(p.name),t[p.name]==null&&c.indexOf(p.name)===-1&&u.indexOf(p.name)===-1){if(p.inputs.length===0){i.push(p.name);continue}p.inputs.forEach(x=>{l.has(x.name)||(l.add(x.name),d.push(x))})}}return{inputs:n,outputs:e,usedNodes:s,missingInputs:i,dynamicNode:a,syncInputs:o}}function RCe(n,e,t){const{usedNodes:r,inputs:s}=t,i=[],a=Object.keys(s).map(u=>fo(u)[0]).map(u=>n.nodes[u]),o=n.initNodes;a.forEach(u=>{r.has(u.name)&&i.push(u)}),n.weights.forEach(u=>{r.has(u.name)&&i.push(u)}),o?.forEach(u=>{r.has(u.name)&&i.push(u)});const l=new Set,c=[];for(;i.length>0;){const u=i.pop();l.add(u.name),e[u.name]||c.push(u),u.children.forEach(d=>{!l.has(d.name)&&r.has(d.name)&&d.inputs.every(p=>l.has(p.name))&&i.push(d)})}return c}const DCe=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],$Ce=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],LCe=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function BX(n){return DCe.indexOf(n.op)>=0}function PCe(n){return $Ce.indexOf(n.op)>=0}function OCe(n){return LCe.indexOf(n.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kE{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new kE(e.functions[r],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}getCompilationKey(e,t){const r=e.map(i=>i.name).sort(),s=t.map(i=>i.name).sort();return r.join(this.SEPERATOR)+"--"+s.join(this.SEPERATOR)}compile(e,t){const r=HF(e,t,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:i,syncInputs:a}=r;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(s.length>0){const o=t.map(c=>c.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${o}] from the provided inputs [${l}]. Missing the following inputs: [${s}]`)}return RCe(this.graph,this.weightMap,r)}execute(e,t){e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const s=r.map(d=>this.graph.nodes[fo(d)[0]]),i=t.map(d=>fo(d)[0]);let a=i.map(d=>this.graph.nodes[d]);this.resetIntermediateTensors(),a.length===0&&(a=this._outputs);const o=this.getCompilationKey(s,a);let l=this.compiledMap.get(o);l==null&&(l=this.compile(e,a),this.compiledMap.set(o,l));const c={},u={};return ar(()=>{const d=new GF(this.weightMap,c,u,this.functionExecutorMap),p=Object.assign({},this.weightMap);Object.keys(e).forEach(v=>{const[b,S]=fo(v),T=[];T[S]=e[v],p[b]=T});const x=this.getFrozenTensorIds(p),y={};for(let v=0;v<l.length;v++){const b=l[v];if(!p[b.name]){const S=UF(b,p,d,this._resourceManager);if(rm(S))throw new Error(`The execution of the op '${b.op}' returned a promise. Please use model.executeAsync() instead.`);p[b.name]=S,this.checkTensorForDisposal(b.name,b,p,d,x,i,y)}}return this.parent==null&&d.dispose(x),t.map(v=>Ca(v,p,d))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(t)}checkTensorForDisposal(e,t,r,s,i,a,o){t.category==="control"||a.indexOf(e)!==-1||(r[e].forEach(l=>{l!=null&&(o[l.id]=(o[l.id]||0)+t.children.length)}),t.inputs.forEach(l=>{if(l.category!=="control"){const c=bTe(l.name,r,s);c?.forEach(u=>{if(u&&!u.kept&&!i.has(u.id)){const d=o[u.id];if(d===1){if(!this.keepTensorForDebug)u.dispose();else{const[p,x]=Hc(t.name,s);this.intermediateTensors[p]?this.intermediateTensors[p][x]=u:(this.intermediateTensors[p]=[],this.intermediateTensors[p][x]=u)}delete o[u.id]}else d!=null&&o[u.id]--}})}}))}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(t=>t.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(r=>{r&&!r.kept&&!r.isDisposed&&!this.keepIds.has(r.id)&&r.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(t=>t.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,t,r=!1,s={},i={}){r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepTensorForDebug=ln().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(u){console.warn(u.message)}this.resetIntermediateTensors();const a=new GF(this.weightMap,s,i,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,a,t,r);const o=t.map(u=>Ca(u,this.tensorsMap,a)),l=o.map(u=>u.id),c=Object.keys(e).map(u=>e[u].id);return this.keepIds=new Set([...l,...c,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&a.dispose(this.keepIds),o}async executeFunctionAsync(e,t,r){const s=e.reduce((i,a,o)=>(i[this.inputs[o].name]=a,i),{});return this._executeAsync(s,this.outputNodes,!0,t,r)}async executeWithControlFlow(e,t,r,s){const i=Object.keys(e),a=i.map(C=>this.graph.nodes[fo(C)[0]]),o=r.map(C=>fo(C)[0]);let l=o.map(C=>this.graph.nodes[C]);l.length===0&&(l=this._outputs);const{usedNodes:c,missingInputs:u,dynamicNode:d,syncInputs:p}=HF(e,l,this.weightMap,this._initNodes),x=[...a,...this.graph.weights,...this._initNodes||[]].map(C=>({node:C,contexts:t.currentContext})),y=Object.assign({},this.weightMap);Object.keys(e).forEach(C=>{const[I,$]=fo(C),q=[];q[$]=e[C],y[I]=q});const v={},b=this.getFrozenTensorIds(y),S={};for(;x.length>0;){const C=this.processStack(a,x,t,y,S,b,o,v,c);await Promise.all(C)}d==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const T=l.filter(C=>!BX(C)&&!Ca(C.name,y,t)).map(C=>C.name);if(T.length>0){let C="";throw d!=null&&(C=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${T}] from the provided inputs [${i}]. Consider providing the following inputs: [${u}]. ${C}`)}return y}processStack(e,t,r,s,i,a,o,l,c){const u=[];for(;t.length>0;){const d=t.pop();r.currentContext=d.contexts;let p="";if(d.node.op==="Enter"&&te("isConstant",d.node,s,r)&&([p]=Hc(d.node.name,r)),s[d.node.name]==null){const x=UF(d.node,s,r,this._resourceManager);p||([p]=Hc(d.node.name,r));const y=r.currentContext;rm(x)?u.push(x.then(v=>(s[p]=v,r.currentContext=y,this.checkTensorForDisposal(p,d.node,s,r,a,o,l),this.processChildNodes(d.node,t,r,s,i,c),v))):(s[p]=x,this.checkTensorForDisposal(p,d.node,s,r,a,o,l),this.processChildNodes(d.node,t,r,s,i,c))}else this.processChildNodes(d.node,t,r,s,i,c)}return u}processChildNodes(e,t,r,s,i,a){e.children.forEach(o=>{const[l]=Hc(o.name,r);i[l]||!a.has(o.name)||(o.op==="Merge"?o.inputNames.some(c=>!!Ca(c,s,r))&&(i[l]=!0,t.push({contexts:r.currentContext,node:o})):o.inputNames.every(c=>!!Ca(c,s,r))&&(i[l]=!0,t.push({contexts:r.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const r=e[t],[s]=fo(t),i=this.graph.nodes[s];if(i.attrParams.shape&&i.attrParams.shape.value){const a=i.attrParams.shape.value,o=a.length===r.shape.length&&r.shape.every((l,c)=>a[c]===-1||a[c]===l);fe(o,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${a}], but was [${r.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&fe(r.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){const t={};for(const r in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null){const s=this._signature.inputs[r];t[s.name]=e[r]}else t[r]=e[r];return t}checkInputs(e){const t=Object.keys(e).filter(r=>{const[s]=fo(r);return this.graph.nodes[s]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[t]!=null?this._signature.outputs[t].name:t,{})}checkOutputs(e){e.forEach(t=>{const[r]=fo(t);if(!this.graph.nodes[r])throw new Error(`The output '${t}' is not found in the graph`)})}}class MCe{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FCe="?tfjs-format=file",BCe="model.json";class zCe{constructor(e,t={},r=IR){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=r,t==null&&(this.loadOptions={}),this.resourceManager=new MCe}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return rm(e)?e.then(t=>this.loadSync(t)):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(r=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}this.signature=r,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const s=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new kE(BF.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(s),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=BF.Instance.transformGraph(e.modelInitializer);this.initializer=new kE(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){const r=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const s=r instanceof ss?[r]:r,i={};return s.forEach((a,o)=>i[this.structuredOutputKeys[o]]=a),i}return r}normalizeInputs(e){if(!(e instanceof ss)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((t,r,s)=>(t[r]=e[s],t),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=this.executor.execute(e,t);return r.length>1?r:r[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=await this.executor.executeAsync(e,t);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,r)=>(t[r]=[e[r]],t),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function jCe(n,e={},t=IR){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=VCe(n));const r=new zCe(n,e,t);return await r.load(),r}function VCe(n){return n.endsWith("/")||(n=n+"/"),`${n}${BCe}${FCe}`}/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    *//**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function IE(n,e,t,r){return new(t||(t=Promise))((function(s,i){function a(c){try{l(r.next(c))}catch(u){i(u)}}function o(c){try{l(r.throw(c))}catch(u){i(u)}}function l(c){c.done?s(c.value):new t((function(u){u(c.value)})).then(a,o)}l((r=r.apply(n,[])).next())}))}function RE(n,e){var t,r,s,i,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(l){return function(c){return(function(u){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(s=2&u[0]?r.return:u[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,u[1])).done)return s;switch(r=0,s&&(u=[2&u[0],s.value]),u[0]){case 0:case 1:s=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!((s=s.length>0&&s[s.length-1])||u[0]!==6&&u[0]!==2)){a=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){a.label=u[1];break}if(u[0]===6&&a.label<s[1]){a.label=s[1],s=u;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(u);break}s[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(n,a)}catch(d){u=[6,d],r=0}finally{t=s=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}})([l,c])}}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var UCe="https://tfhub.dev/tensorflow/tfjs-model/deeplab",GCe=513,vk={ADE20K:[[0,0,0],[120,120,120],[180,120,120],[6,230,230],[80,50,50],[4,200,3],[120,120,80],[140,140,140],[204,5,255],[230,230,230],[4,250,7],[224,5,255],[235,255,7],[150,5,61],[120,120,70],[8,255,51],[255,6,82],[143,255,140],[204,255,4],[255,51,7],[204,70,3],[0,102,200],[61,230,250],[255,6,51],[11,102,255],[255,7,71],[255,9,224],[9,7,230],[220,220,220],[255,9,92],[112,9,255],[8,255,214],[7,255,224],[255,184,6],[10,255,71],[255,41,10],[7,255,255],[224,255,8],[102,8,255],[255,61,6],[255,194,7],[255,122,8],[0,255,20],[255,8,41],[255,5,153],[6,51,255],[235,12,255],[160,150,20],[0,163,255],[140,140,140],[250,10,15],[20,255,0],[31,255,0],[255,31,0],[255,224,0],[153,255,0],[0,0,255],[255,71,0],[0,235,255],[0,173,255],[31,0,255],[11,200,200],[255,82,0],[0,255,245],[0,61,255],[0,255,112],[0,255,133],[255,0,0],[255,163,0],[255,102,0],[194,255,0],[0,143,255],[51,255,0],[0,82,255],[0,255,41],[0,255,173],[10,0,255],[173,255,0],[0,255,153],[255,92,0],[255,0,255],[255,0,245],[255,0,102],[255,173,0],[255,0,20],[255,184,184],[0,31,255],[0,255,61],[0,71,255],[255,0,204],[0,255,194],[0,255,82],[0,10,255],[0,112,255],[51,0,255],[0,194,255],[0,122,255],[0,255,163],[255,153,0],[0,255,10],[255,112,0],[143,255,0],[82,0,255],[163,255,0],[255,235,0],[8,184,170],[133,0,255],[0,255,92],[184,0,255],[255,0,31],[0,184,255],[0,214,255],[255,0,112],[92,255,0],[0,224,255],[112,224,255],[70,184,160],[163,0,255],[153,0,255],[71,255,0],[255,0,163],[255,204,0],[255,0,143],[0,255,235],[133,255,0],[255,0,235],[245,0,255],[255,0,122],[255,245,0],[10,190,212],[214,255,0],[0,204,255],[20,0,255],[255,255,0],[0,153,255],[0,41,255],[0,255,204],[41,0,255],[41,255,0],[173,0,255],[0,245,255],[71,0,255],[122,0,255],[0,255,184],[0,92,255],[184,255,0],[0,133,255],[255,214,0],[25,194,194],[102,255,0],[92,0,255]],CITYSCAPES:[[128,64,128],[244,35,232],[70,70,70],[102,102,156],[190,153,153],[153,153,153],[250,170,30],[220,220,0],[107,142,35],[152,251,152],[70,130,180],[220,20,60],[255,0,0],[0,0,142],[0,0,70],[0,60,100],[0,80,100],[0,0,230],[119,11,32]],PASCAL:[[0,0,0],[128,0,0],[0,128,0],[128,128,0],[0,0,128],[128,0,128],[0,128,128],[128,128,128],[64,0,0],[192,0,0],[64,128,0],[192,128,0],[64,0,128],[192,0,128],[64,128,128],[192,128,128],[0,64,0],[128,64,0],[0,192,0],[128,192,0],[0,64,128],[128,64,128],[0,192,128],[128,192,128],[64,64,0],[192,64,0],[64,192,0],[192,192,0],[64,64,128],[192,64,128],[64,192,128],[192,192,128],[0,0,64],[128,0,64],[0,128,64],[128,128,64],[0,0,192],[128,0,192],[0,128,192],[128,128,192],[64,0,64],[192,0,64],[64,128,64],[192,128,64],[64,0,192],[192,0,192],[64,128,192],[192,128,192],[0,64,64],[128,64,64],[0,192,64],[128,192,64],[0,64,192],[128,64,192],[0,192,192],[128,192,192],[64,64,64],[192,64,64],[64,192,64],[192,192,64],[64,64,192],[192,64,192],[64,192,192],[192,192,192],[32,0,0],[160,0,0],[32,128,0],[160,128,0],[32,0,128],[160,0,128],[32,128,128],[160,128,128],[96,0,0],[224,0,0],[96,128,0],[224,128,0],[96,0,128],[224,0,128],[96,128,128],[224,128,128],[32,64,0],[160,64,0],[32,192,0],[160,192,0],[32,64,128],[160,64,128],[32,192,128],[160,192,128],[96,64,0],[224,64,0],[96,192,0],[224,192,0],[96,64,128],[224,64,128],[96,192,128],[224,192,128],[32,0,64],[160,0,64],[32,128,64],[160,128,64],[32,0,192],[160,0,192],[32,128,192],[160,128,192],[96,0,64],[224,0,64],[96,128,64],[224,128,64],[96,0,192],[224,0,192],[96,128,192],[224,128,192],[32,64,64],[160,64,64],[32,192,64],[160,192,64],[32,64,192],[160,64,192],[32,192,192],[160,192,192],[96,64,64],[224,64,64],[96,192,64],[224,192,64],[96,64,192],[224,64,192],[96,192,192],[224,192,192],[0,32,0],[128,32,0],[0,160,0],[128,160,0],[0,32,128],[128,32,128],[0,160,128],[128,160,128],[64,32,0],[192,32,0],[64,160,0],[192,160,0],[64,32,128],[192,32,128],[64,160,128],[192,160,128],[0,96,0],[128,96,0],[0,224,0],[128,224,0],[0,96,128],[128,96,128],[0,224,128],[128,224,128],[64,96,0],[192,96,0],[64,224,0],[192,224,0],[64,96,128],[192,96,128],[64,224,128],[192,224,128],[0,32,64],[128,32,64],[0,160,64],[128,160,64],[0,32,192],[128,32,192],[0,160,192],[128,160,192],[64,32,64],[192,32,64],[64,160,64],[192,160,64],[64,32,192],[192,32,192],[64,160,192],[192,160,192],[0,96,64],[128,96,64],[0,224,64],[128,224,64],[0,96,192],[128,96,192],[0,224,192],[128,224,192],[64,96,64],[192,96,64],[64,224,64],[192,224,64],[64,96,192],[192,96,192],[64,224,192],[192,224,192],[32,32,0],[160,32,0],[32,160,0],[160,160,0],[32,32,128],[160,32,128],[32,160,128],[160,160,128],[96,32,0],[224,32,0],[96,160,0],[224,160,0],[96,32,128],[224,32,128],[96,160,128],[224,160,128],[32,96,0],[160,96,0],[32,224,0],[160,224,0],[32,96,128],[160,96,128],[32,224,128],[160,224,128],[96,96,0],[224,96,0],[96,224,0],[224,224,0],[96,96,128],[224,96,128],[96,224,128],[224,224,128],[32,32,64],[160,32,64],[32,160,64],[160,160,64],[32,32,192],[160,32,192],[32,160,192],[160,160,192],[96,32,64],[224,32,64],[96,160,64],[224,160,64],[96,32,192],[224,32,192],[96,160,192],[224,160,192],[32,96,64],[160,96,64],[32,224,64],[160,224,64],[32,96,192],[160,96,192],[32,224,192],[160,224,192],[96,96,64],[224,96,64],[96,224,64],[224,224,64],[96,96,192],[224,96,192],[96,224,192],[224,224,192]]},_k={PASCAL:["background","aeroplane","bicycle","bird","boat","bottle","bus","car","cat","chair","cow","dining table","dog","horse","motorbike","person","potted plant","sheep","sofa","train","TV"],CITYSCAPES:["road","sidewalk","building","wall","fence","pole","traffic light","traffic sign","vegetation","terrain","sky","person","rider","car","truck","bus","train","motorcycle","bicycle"],ADE20K:["background","wall","building","sky","floor","tree","ceiling","road","bed","windowpane","grass","cabinet","sidewalk","person","earth","door","table","mountain","plant","curtain","chair","car","water","painting","sofa","shelf","house","sea","mirror","rug","field","armchair","seat","fence","desk","rock","wardrobe","lamp","bathtub","railing","cushion","base","box","column","signboard","chest","counter","sand","sink","skyscraper","fireplace","refrigerator","grandstand","path","stairs","runway","case","pool","pillow","screen","stairway","river","bridge","bookcase","blind","coffee","toilet","flower","book","hill","bench","countertop","stove","palm","kitchen","computer","swivel","boat","bar","arcade","hovel","bus","towel","light","truck","tower","chandelier","awning","streetlight","booth","television","airplane","dirt","apparel","pole","land","bannister","escalator","ottoman","bottle","buffet","poster","stage","van","ship","fountain","conveyer","canopy","washer","plaything","swimming","stool","barrel","basket","waterfall","tent","bag","minibike","cradle","oven","ball","food","step","tank","trade","microwave","pot","animal","bicycle","lake","dishwasher","screen","blanket","sculpture","hood","sconce","vase","traffic","tray","ashcan","fan","pier","screen","plate","monitor","bulletin","shower","radiator","glass","clock","flag"]};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCe(n,e){return""+UCe+"/"+(e===4?n+"/1/default/1/model.json":n+"/1/quantized/"+e+"/1/model.json")+"?tfjs-format=file"}function WCe(n){if(n==="pascal")return vk.PASCAL;if(n==="ade20k")return vk.ADE20K;if(n==="cityscapes")return vk.CITYSCAPES;throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+n+". Try one of 'pascal', 'cityscapes' and 'ade20k'.")}function qCe(n){if(n==="pascal")return _k.PASCAL;if(n==="ade20k")return _k.ADE20K;if(n==="cityscapes")return _k.CITYSCAPES;throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+n+". Try one of 'pascal', 'cityscapes' and 'ade20k'.")}function KCe(n,e,t,r){return IE(this,void 0,void 0,(function(){var s,i,a,o,l,c,u,d,p,x,y,v,b,S;return RE(this,(function(T){switch(T.label){case 0:if(n.length<e.length)throw new Error("The colormap must be expansive enough to encode each label. Aborting, since the given colormap has length "+n.length+", but there are "+e.length+" labels.");return s=t.shape,i=s[0],a=s[1],o=xc([i,a,3],"int32"),[4,t.array()];case 1:for(l=T.sent(),c=new Set,u=0;u<i;++u)for(d=0;d<a;++d)S=l[u][d],c.add(S),o.set(n[S][0],u,d,0),o.set(n[S][1],u,d,1),o.set(n[S][2],u,d,2);return p=o.toTensor(),[4,JW(p,r)];case 2:for(x=T.sent(),Yi(p),y={},v=0,b=Array.from(c);v<b.length;v++)S=b[v],y[e[S]]=n[S];return[2,{legend:y,segmentationMap:x}]}}))}))}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XCe(n){return n===void 0&&(n={base:"pascal",quantizationBytes:2}),IE(this,void 0,void 0,(function(){var e;return RE(this,(function(t){switch(t.label){case 0:if(gTe==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(n.base){if(["pascal","cityscapes","ade20k"].indexOf(n.base)===-1)throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+n.base+". Try one of 'pascal', 'cityscapes' and 'ade20k'.");if([1,2,4].indexOf(n.quantizationBytes)===-1)throw new Error("Only quantization to 1, 2 or 4 bytes is supported.")}else if(!n.modelUrl)throw new Error("SemanticSegmentation can be constructed either by passing the weights URL or one of the supported base model names from 'pascal', 'cityscapes' and 'ade20k',together with the degree of quantization (either 1, 2 or 4).Aborting, since neither has been provided.");return[4,jCe(n.modelUrl||HCe(n.base,n.quantizationBytes))];case 1:return e=t.sent(),[2,new YCe(e,n.base)]}}))}))}var YCe=(function(){function n(e,t){this.model=e,this.base=t}return n.prototype.predict=function(e){var t=this;return ar((function(){var r=Qr((function(s){return ar((function(){var i=s instanceof ss?s:eq(s),a=i.shape,o=a[0],l=a[1],c=GCe/Math.max(l,o),u=Math.round(o*c),d=Math.round(l*c);return ih(yD.resizeBilinear(i,[u,d]))}))})(e),"int32");return vb(t.model.execute(r))}))},n.prototype.segment=function(e,t){return t===void 0&&(t={}),IE(this,void 0,void 0,(function(){var r,s,i,a,o,l,c,u,d,p,x=this;return RE(this,(function(y){switch(y.label){case 0:if(!(t.colormap&&t.labels||this.base))throw new Error("Calling the 'segment' method requires either the 'base' attribute to be defined (e.g. 'pascal', 'cityscapes' or'ade20k'), or 'colormap' and 'labels' options to be set. Aborting, since neither has been provided.");return t.colormap&&t.labels||(t.colormap=WCe(this.base),t.labels=qCe(this.base)),r=t.colormap,s=t.labels,i=t.canvas,a=ar((function(){return x.predict(e)})),o=a.shape,l=o[0],c=o[1],[4,KCe(r,s,a,i)];case 1:return u=y.sent(),d=u.legend,p=u.segmentationMap,Yi(a),[2,{legend:d,height:l,width:c,segmentationMap:p}]}}))}))},n.prototype.dispose=function(){return IE(this,void 0,void 0,(function(){return RE(this,(function(e){return this.model&&this.model.dispose(),[2]}))}))},n})();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZCe=1e-7,QCe=1e-4;class zX{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class _D{refCount(e){return ho("refCount")}incRef(e){return ho("incRef")}timerAvailable(){return!0}time(e){return ho("time")}read(e){return ho("read")}readSync(e){return ho("readSync")}readToGPU(e,t){return ho("readToGPU")}numDataIds(){return ho("numDataIds")}disposeData(e,t){return ho("disposeData")}write(e,t,r){return ho("write")}move(e,t,r,s,i){return ho("move")}createTensorFromGPUData(e,t,r){return ho("createTensorFromGPUData")}memory(){return ho("memory")}floatPrecision(){return ho("floatPrecision")}epsilon(){return this.floatPrecision()===32?ZCe:QCe}dispose(){return ho("dispose")}}function ho(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JCe(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,F0(n,e,t)}function um(n,e,t){return Math.max(n,Math.min(e,t))}function wD(n){return n%2===0?n:n+1}function F0(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function eAe(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function ue(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function ED(n,e,t=""){ue(gr(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function jX(n){ue(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Ue(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function gr(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Sg(n){return n%1===0}function s3(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function ig(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function WF(n,e=s=>0,t,r){return new Promise((s,i)=>{let a=0;const o=()=>{if(n()){s();return}a++;const l=e(a);if(t!=null&&a>=t){i();return}r!=null?r(o,l):setTimeout(o,l)};o()})}function VX(n,e){let t=1,r=-1;for(let i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(n[i]<0)throw Error(`Shapes can not be < 0. Found ${n[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const s=n.slice();return s[r]=e/t,s}function Sn(n,e){const t=e.length;return n=n==null?e.map((r,s)=>s):[].concat(n),ue(n.every(r=>r>=-t&&r<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),ue(n.every(r=>Sg(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?t+r:r)}function Lf(n,e){const t=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:Sn(e,n).sort();let a=0;for(let o=0;o<n.length;++o){if(i!=null){if(i[a]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(i[a]==null||i[a]>o)&&n[o]===1&&(t.push(n[o]),r.push(o)),i[a]<=o&&a++}n[o]!==1&&(t.push(n[o]),r.push(o))}return{newShape:t,keptDims:r}}function Ji(n,e){return vs(n,e)}function vs(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function tAe(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function nAe(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function UX(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function DE(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function rAe(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function wb(n){return typeof n=="string"||n instanceof String}function sAe(n){return typeof n=="boolean"}function i3(n){return typeof n=="number"}function ex(n){return Array.isArray(n)?ex(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":i3(n)?"float32":wb(n)?"string":sAe(n)?"bool":"float32"}function a3(n){return!!(n&&n.constructor&&n.call&&n.apply)}function o3(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function kt(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function GX(n,e,t,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let a=0;a<i;a++)s[a]=t[n+a]}else{const i=e[0],a=e.slice(1),o=a.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<i;l++)s[l]=GX(n+l*o,a,t,r)}return s}function dc(n,e,t=!1){if(n.length===0)return e[0];const r=n.reduce((s,i)=>s*i)*(t?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return GX(0,n,e,t)}function iAe(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function SD(n,e){const t=ea(n,e);for(let r=0;r<t.length;r++)t[r]=1;return t}function ea(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function HX(n,e){const t=n.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return dc(n,new Float32Array(t));if(e==="int32")return dc(n,new Int32Array(t));if(e==="bool")return dc(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Mh(n){n.forEach(e=>{ue(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function uu(n,e,t){if(e===0)return 0;if(e===1)return n[0];let r=n[n.length-1];for(let s=0;s<n.length-1;++s)r+=t[s]*n[s];return r}function tx(n,e,t){if(e===0)return[];if(e===1)return[n];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(n/t[s]),n-=r[s]*t[s];return r[r.length-1]=n,r}function TD(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qF="tfjsflags";class aAe{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=oAe,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Me().getBool("IS_TEST")||Me().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];Me().getBool("IS_TEST")||Me().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(TD(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);qF in e&&e[qF].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=cAe(s,i)})}}function oAe(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>(lAe(e,r[0],r[1]),r.join("="))),e}function lAe(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function cAe(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function Me(){return WX}let WX=null;function uAe(n){WX=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let wk;function qX(){if(wk==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");wk=n}return wk}function hAe(){const n=qX();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function CD(n,e){const t=hAe();if(t.has(n))return t.get(n);{const r=e();return t.set(n,r),t.get(n)}}const aT="Abs",Eb="Acos",Sb="Acosh",nx="Add",AD="AddN",ND="All",kD="Any",oT="ArgMax",lT="ArgMin",Tb="Asin",Cb="Asinh",Ab="Atan",Nb="Atanh",kb="Atan2",cT="AvgPool",ID="AvgPoolGrad",uT="AvgPool3D",RD="AvgPool3DGrad",hT="BatchMatMul",dT="BatchToSpaceND",DD="Bincount",$D="BitwiseAnd",dAe="BroadcastTo",KX="BroadcastArgs",Ib="Cast",Rb="Ceil",Db="ClipByValue",LD="Complex",fT="ComplexAbs",pT="Concat",mT="Conv2D",PD="Conv2DBackpropFilter",gT="Conv2DBackpropInput",xT="Conv3D",OD="Conv3DBackpropFilterV2",MD="Conv3DBackpropInputV2",$b="Cos",Lb="Cosh",FD="Cumprod",yT="Cumsum",BD="CropAndResize",zD="DenseBincount",jD="DepthToSpace",bT="DepthwiseConv2dNative",VD="DepthwiseConv2dNativeBackpropFilter",UD="DepthwiseConv2dNativeBackpropInput",XX="Diag",vT="Dilation2D",l3="Dilation2DBackpropInput",c3="Dilation2DBackpropFilter",fAe="Draw",Pb="RealDiv",GD="Einsum",Ob="Elu",HD="EluGrad",Mb="Erf",_T="Equal",Fb="Exp",wT="ExpandDims",Bb="Expm1",WD="FFT",qD="Fill",KD="FlipLeftRight",zb="Floor",jb="FloorDiv",ET="FusedBatchNorm",ST="GatherV2",YX="GatherNd",TT="Greater",Vb="GreaterEqual",Ub="Identity",XD="IFFT",YD="Imag",Gb="IsFinite",Hb="IsInf",Wb="IsNan",CT="LeakyRelu",AT="Less",NT="LessEqual",ZX="LinSpace",qb="Log",Kb="Log1p",kT="LogicalAnd",IT="LogicalNot",RT="LogicalOr",pAe="LogSoftmax",DT="LRN",ZD="LRNGrad",$T="Max",Xb="Maximum",LT="MaxPool",QD="MaxPoolGrad",PT="MaxPool3D",JD="MaxPool3DGrad",QX="MaxPoolWithArgmax",OT="Mean",MT="Min",Yb="Minimum",FT="MirrorPad",Zb="Mod",JX="Multinomial",Qb="Multiply",BT="Neg",zT="NotEqual",e$="NonMaxSuppressionV3",t$="NonMaxSuppressionV4",n$="NonMaxSuppressionV5",jT="OnesLike",VT="OneHot",UT="Pack",GT="PadV2",Jb="Pow",HT="Prelu",WT="Prod",eY="RaggedGather",tY="RaggedRange",nY="RaggedTensorToTensor",r$="Range",s$="Real",ev="Reciprocal",tv="Relu",qT="Reshape",KT="ResizeNearestNeighbor",i$="ResizeNearestNeighborGrad",XT="ResizeBilinear",a$="ResizeBilinearGrad",nv="Relu6",YT="Reverse",rv="Round",sv="Rsqrt",rY="ScatterNd",sY="TensorScatterUpdate",iY="SearchSorted",ZT="Select",iv="Selu",QT="Slice",av="Sin",ov="Sinh",lv="Sign",cv="Sigmoid",uv="Softplus",hv="Sqrt",JT="Sum",eC="SpaceToBatchND",tC="SplitV",nC="Softmax",aY="SparseFillEmptyRows",oY="SparseReshape",lY="SparseSegmentMean",cY="SparseSegmentSum",uY="SparseToDense",dv="SquaredDifference",o$="Square",l$="StaticRegexReplace",c$="StridedSlice",hY="StringNGrams",dY="StringSplit",fY="StringToHashBucketFast",fv="Sub",pv="Tan",mv="Tanh",gv="Tile",u$="TopK",h$="Transform",ag="Transpose",d$="Unique",rC="Unpack",sC="UnsortedSegmentSum",iC="ZerosLike",xv="Step",mAe="FromPixels",f$="RotateWithOffset",$E="_FusedMatMul",LE="FusedConv2D",pY="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xo(...n){Me().getBool("IS_TEST")||Me().getBool("PROD")||console.warn(...n)}function gAe(...n){Me().getBool("IS_TEST")||Me().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PE=CD("kernelRegistry",()=>new Map),u3=CD("gradRegistry",()=>new Map);function KF(n,e){const t=gY(n,e);return PE.get(t)}function XF(n){return u3.get(n)}function YF(n){const e=PE.entries(),t=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,a]=s,[o]=i.split("_");o===n&&t.push(a)}return t}function mY(n){const{kernelName:e,backendName:t}=n,r=gY(e,t);PE.has(r)&&Xo(`The kernel '${e}' for backend '${t}' is already registered`),PE.set(r,n)}function xAe(n){const{kernelName:e}=n;u3.has(e)&&Me().getBool("DEBUG")&&Xo(`Overriding the gradient for '${e}'`),u3.set(e,n)}function gY(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xY(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cp=vR||CW;function aC(n){return Cp.fromString(n,!0,16)}const yY=aC("c3a5c85c97cb3127"),wp=aC("b492b66fbe98f273"),Ea=aC("9ae16a3b2f90404f");function h3(n){return n.xor(n.shru(47))}function bY(n,e,t){const r=n.slice(e,e+t);return Cp.fromBytes(Array.from(r),!0,!0)}function Lr(n,e){return bY(n,e,8)}function ZF(n,e){return bY(n,e,4)}function di(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function Qd(n,e,t=aC("9ddfea08eb382d69")){let r=n.xor(e).mul(t);r=r.xor(r.shru(47));let s=e.xor(r).mul(t);return s=s.xor(s.shru(47)),s=s.mul(t),s}function yAe(n,e,t,r,s,i){s=s.add(n),i=di(i.add(s).add(r),21);const a=s;return s=s.add(e),s=s.add(t),i=i.add(di(s,44)),[s.add(r),i.add(a)]}function aw(n,e,t,r){return yAe(Lr(n,e),Lr(n,e+8),Lr(n,e+16),Lr(n,e+24),t,r)}function bAe(n,e=n.length){if(e>=8){const t=Ea.add(e*2),r=Lr(n,0).add(Ea),s=Lr(n,e-8),i=di(s,37).mul(t).add(r),a=di(r,25).add(s).mul(t);return Qd(i,a,t)}if(e>=4){const t=Ea.add(e*2),r=ZF(n,0);return Qd(r.shl(3).add(e),ZF(n,e-4),t)}if(e>0){const t=n[0],r=n[e>>1],s=n[e-1],i=t+(r<<8),a=e+(s<<2);return h3(Ea.mul(i).xor(yY.mul(a))).mul(Ea)}return Ea}function vAe(n,e=n.length){const t=Ea.add(e*2),r=Lr(n,0).mul(wp),s=Lr(n,8),i=Lr(n,e-8).mul(t),a=Lr(n,e-16).mul(Ea);return Qd(di(r.add(s),43).add(di(i,30)).add(a),r.add(di(s.add(Ea),18)).add(i),t)}function _Ae(n,e=n.length){const t=Ea.add(e*2),r=Lr(n,0).mul(Ea),s=Lr(n,8),i=Lr(n,e-8).mul(t),a=Lr(n,e-16).mul(Ea),o=di(r.add(s),43).add(di(i,30)).add(a),l=Qd(o,r.add(di(s.add(Ea),18)).add(i),t),c=Lr(n,16).mul(t),u=Lr(n,24),d=o.add(Lr(n,e-32)).mul(t),p=l.add(Lr(n,e-24)).mul(t);return Qd(di(c.add(u),43).add(di(d,30)).add(p),c.add(di(u.add(r),18)).add(d),t)}function wAe(n,e=n.length){const t=Cp.fromNumber(81,!0);if(e<=32)return e<=16?bAe(n,e):vAe(n,e);if(e<=64)return _Ae(n,e);let r=t,s=t.mul(wp).add(113),i=h3(s.mul(Ea).add(113)).mul(Ea),a=[Cp.UZERO,Cp.UZERO],o=[Cp.UZERO,Cp.UZERO];r=r.mul(Ea).add(Lr(n,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do r=di(r.add(s).add(a[0]).add(Lr(n,l+8)),37).mul(wp),s=di(s.add(a[1]).add(Lr(n,l+48)),42).mul(wp),r=r.xor(o[1]),s=s.add(a[0]).add(Lr(n,l+40)),i=di(i.add(o[0]),33).mul(wp),a=aw(n,l,a[1].mul(wp),r.add(o[0])),o=aw(n,l+32,i.add(o[1]),s.add(Lr(n,l+16))),[i,r]=[r,i],l+=64;while(l!==c);const d=wp.add(i.and(255).shl(1));return l=u,o[0]=o[0].add(e-1&63),a[0]=a[0].add(o[0]),o[0]=o[0].add(a[0]),r=di(r.add(s).add(a[0]).add(Lr(n,l+8)),37).mul(d),s=di(s.add(a[1]).add(Lr(n,l+48)),42).mul(d),r=r.xor(o[1].mul(9)),s=s.add(a[0].mul(9).add(Lr(n,l+40))),i=di(i.add(o[0]),33).mul(d),a=aw(n,l,a[1].mul(d),r.add(o[0])),o=aw(n,l+32,i.add(o[1]),s.add(Lr(n,l+16))),[i,r]=[r,i],Qd(Qd(a[0],o[0],d).add(h3(s).mul(yY)).add(i),Qd(a[1],o[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pf(n,e){return e==="string"?Jd(n):Rm([n],e)}function EAe(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function Rm(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=hm(n)),Me().getBool("DEBUG")&&tAe(n,e),EAe(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let r=0;r<t.length;++r)Math.round(n[r])!==0&&(t[r]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Ya(){return Me().platform.now()}function Jd(n,e="utf-8"){return e=e||"utf-8",Me().platform.encode(n,e)}function yf(n,e="utf-8"){return e=e||"utf-8",Me().platform.decode(n,e)}function Dl(n){return Me().platform.isTypedArray!=null?Me().platform.isTypedArray(n):xY(n)}function hm(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||TD(n)||n==null||Dl(n)&&t)e.push(n);else if(Array.isArray(n)||Dl(n))for(let r=0;r<n.length;++r)hm(n[r],e,t);else{let r=-1;for(const s of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)hm(n[s],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SAe{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new CAe)}profileKernel(e,t,r){let s;const i=()=>{s=r()};let a;const o=Ya();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(const c of s)c.dataSync();a=Promise.resolve({kernelMs:Ya()-o})}if(Me().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<s.length;c++){const u=s[c];u.data().then(d=>{TAe(d,u.dtype,e)})}return{kernelName:e,outputs:s,inputs:t,timeMs:a.then(c=>c.kernelMs),extraInfo:a.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:s,inputs:i,extraInfo:a}=e;r.forEach(o=>{Promise.all([o.data(),s,a]).then(l=>{this.logger.logKernelProfile(t,o,l[0],l[1],i,l[2])})})}}function TAe(n,e,t){if(e!=="float32")return!1;for(let r=0;r<n.length;r++){const s=n[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${t}'`),!0}return!1}class CAe{logKernelProfile(e,t,r,s,i,a){const o=typeof s=="number"?ig(`${s}ms`,9):s.error,l=ig(e,25),c=t.rank,u=t.size,d=ig(t.shape.toString(),14);let p="";for(const x in i){const y=i[x];if(y!=null){const v=y.shape||t.shape,b=v.length;p+=`${x}: ${b}D ${b>0?v:""} `}}console.log(`%c${l}	%c${o}	%c${c}D ${d}	%c${u}	%c${p}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AAe(n,e,t){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<n.length;l++){const c=n[l],u=c.inputs;for(const d in u){const p=u[d];let x=!1;for(let y=0;y<e.length;y++)if(r[p.id]){c.outputs.forEach(v=>r[v.id]=!0),x=!0,s[c.id]=!0;break}if(x)break}}const i={};i[t.id]=!0;const a={};for(let l=n.length-1;l>=0;l--){const c=n[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(const p in u)i[u[p].id]=!0,a[c.id]=!0;break}}const o=[];for(let l=0;l<n.length;l++){const c=n[l];if(s[c.id]&&a[c.id]){const u={};for(const p in c.inputs){const x=c.inputs[p];r[x.id]&&(u[p]=x)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,o.push(d)}}return o}function NAe(n,e,t,r){for(let s=e.length-1;s>=0;s--){const i=e[s],a=[];if(i.outputs.forEach(l=>{const c=n[l.id];c!=null?a.push(c):a.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const o=i.gradient(a);for(const l in i.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const c=t(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!gr(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(n[u.id]==null)n[u.id]=c;else{const d=n[u.id];n[u.id]=r(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QF=20,py=3,Ek=7;function kAe(n,e,t,r){const s=kt(e),i=IAe(n,e,t,s),a=e.length,o=n2(n,e,t,s,i),l=["Tensor"];return r&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function IAe(n,e,t,r){const s=Ue(e),i=r[r.length-1],a=new Array(i).fill(0),o=e.length,l=t==="complex64"?Iy(n):n;if(o>1)for(let c=0;c<s/i;c++){const u=c*i;for(let d=0;d<i;d++)a[d]=Math.max(a[d],ky(l[u+d],0,t).length)}return a}function ky(n,e,t){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(Ek))} + ${parseFloat(n[1].toFixed(Ek))}j`:wb(n)?r=`'${n}'`:t==="bool"?r=vY(n):r=parseFloat(n.toFixed(Ek)).toString(),ig(r,e)}function vY(n){return n===0?"false":"true"}function n2(n,e,t,r,s,i=!0){const a=t==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(t==="complex64"){const v=Iy(n);return[ky(v[0],0,t)]}return t==="bool"?[vY(n[0])]:[n[0].toString()]}if(l===1){if(o>QF){const b=py*a;let S=Array.from(n.slice(0,b)),T=Array.from(n.slice((o-py)*a,o*a));return t==="complex64"&&(S=Iy(S),T=Iy(T)),["["+S.map((C,I)=>ky(C,s[I],t)).join(", ")+", ..., "+T.map((C,I)=>ky(C,s[o-py+I],t)).join(", ")+"]"]}return["["+(t==="complex64"?Iy(n):Array.from(n)).map((b,S)=>ky(b,s[S],t)).join(", ")+"]"]}const c=e.slice(1),u=r.slice(1),d=r[0]*a,p=[];if(o>QF){for(let v=0;v<py;v++){const b=v*d,S=b+d;p.push(...n2(n.slice(b,S),c,t,u,s,!1))}p.push("...");for(let v=o-py;v<o;v++){const b=v*d,S=b+d;p.push(...n2(n.slice(b,S),c,t,u,s,v===o-1))}}else for(let v=0;v<o;v++){const b=v*d,S=b+d;p.push(...n2(n.slice(b,S),c,t,u,s,v===o-1))}const x=l===2?",":"";p[0]="["+(o>0?p[0]+x:"");for(let v=1;v<p.length-1;v++)p[v]=" "+p[v]+x;let y=`,
`;for(let v=2;v<l;v++)y+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(i?"":y),p}function Iy(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oi{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=Ue(e),r!=null){const s=r.length;ue(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||vs(t,this.size),this.strides=kt(e)}set(e,...t){t.length===0&&(t=[0]),ue(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const s of e){if(s<0||s>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return ic().makeTensor(this.values,this.shape,this.dtype)}}let ic=null,B0=null;function RAe(n){ic=n}function DAe(n){B0=n}class Ks{constructor(e,t,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ue(e),this.strides=kt(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return B0.buffer(this.shape,this.dtype,e)}bufferSync(){return B0.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return dc(this.shape,e,this.dtype==="complex64")}arraySync(){return dc(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=ic().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(r=>yf(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ic().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ic().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>yf(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ic().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),ic().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return B0.print(this,e)}clone(){return this.throwIfDisposed(),B0.clone(this)}toString(e=!1){const t=this.dataSync();return kAe(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),B0.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),ic().makeVariable(this,e,t,r)}}Object.defineProperty(Ks,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function je(){return CD("Tensor",()=>Ks)}je();class OE extends Ks{constructor(e,t,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!gr(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);ic().disposeTensor(this),this.dataId=e.dataId,ic().incRef(this,null)}dispose(){ic().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(OE,Symbol.hasInstance,{value:n=>n instanceof Ks&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var JF;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(JF||(JF={}));var d3;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(d3||(d3={}));var f3;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(f3||(f3={}));var p3;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(p3||(p3={}));var m3;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(m3||(m3={}));const $Ae={float32:p3,int32:d3,bool:f3,complex64:m3};function wo(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return $Ae[n][e]}function p$(n){return wo(n,"int32")}function _Y(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function wY(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ss(n,e){if(n.dtype===e.dtype)return[n,e];const t=wo(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function EY(n){const e=[];return SY(n,e,new Set),e}function SY(n,e,t){if(n==null)return;if(n instanceof Ks){e.push(n);return}if(!LAe(n))return;const r=n;for(const s in r){const i=r[s];t.has(i)||(t.add(i),SY(i,e,t))}}function LAe(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sk(n){return n.kernelName!=null}class eB{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Tg{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new eB}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?(Xo(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new SAe(this.backendInstance),!0}setupRegisteredKernels(){YF(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){YF(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(r&&!(r instanceof _D)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(a=>s<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Xo(`Initialization of backend ${e} failed`),Xo(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Xo(`Initialization of backend ${e} failed`),Xo(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),s=r.backend,i=this.readSync(t),a=s.refCount(t);s.disposeData(t,!0),r.backend=e,e.move(t,i,r.shape,r.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=t(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,t,r){e();try{const s=r();return t(),s}catch(s){throw t(),s}}nextTensorId(){return Tg.nextTensorId++}nextVariableId(){return Tg.nextVariableId++}clone(e){const t=Te.runKernel(Ub,{x:e}),r={x:e},s=a=>({x:()=>{const o="float32",l={x:a},c={dtype:o};return Te.runKernel(Ib,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[t],s,i,{}),t}runKernel(e,t,r){if(this.backendName==null&&this.backend,!(KF(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const s=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=s-t-i-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const s=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const c=Sk(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Sk(e)){const{kernelName:y,inputs:v,attrs:b}=e;this.backendName==null&&this.backend;const S=KF(y,this.backendName);ue(S!=null,()=>`Cannot find registered kernel '${y}' for backend '${this.backendName}'`),o=()=>{const T=this.backend.numDataIds();l=S.kernelFunc({inputs:v,attrs:b,backend:this.backend});const C=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,T,C);const I=C.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(s){const $=this.getTensorsForGradient(y,v,I);r=this.saveTensorsForBackwardMode($)}return I}}else{const{forwardFunc:y}=e,v=b=>{s&&(r=b.map(S=>this.keep(this.clone(S))))};o=()=>{const b=this.backend.numDataIds();l=this.tidy(()=>y(this.backend,v));const S=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,b,S),S}}const{inputs:u,attrs:d}=e,p=Sk(e)?null:e.backwardsFunc;let x;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=o():(x=this.profiler.profileKernel(c,u,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(x),t=x.outputs)}),s&&this.addTapeNode(c,u,t,p,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(y=>u[y]!=null?u[y].shape:null),outputShapes:t.map(y=>y.shape),kernelTimeMs:x.timeMs,extraInfo:x.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,t,r){const s=XF(e);if(s!=null){const i=s.inputsToSave||[],a=s.outputsToSave||[];let o;s.saveAllInputs?(ue(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(c=>t[c])):o=i.map(c=>t[c]);const l=r.filter((c,u)=>a[u]);return o.concat(l)}return[]}makeTensor(e,t,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&wb(e[0])&&(i=e.map(l=>Jd(l)));const a=s.write(i,t,r),o=new Ks(t,r,a,this.nextTensorId());if(this.trackTensor(o,s),r==="string"){const l=this.state.tensorInfo.get(a),c=rAe(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(e,t,r,s){r=r||"float32";const i={dataId:e,shape:t,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:s,dtype:i}=e,a=new Ks(s,i,r,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new OE(e,t,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*DE(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof OE||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*DE(e.dtype);this.state.numBytes-=r}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,r,s,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:i},l=XF(e);l!=null&&(s=l.gradFunc),s!=null&&(o.gradient=c=>(c=c.map((u,d)=>{if(u==null){const p=r[d],x=ea(p.size,p.dtype);return this.makeTensor(x,p.shape,p.dtype)}return u}),s(c.length>1?c:c[0],i,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=EY(e),r=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const a=this.state.activeScope.track[i];!a.kept&&!r.has(a.id)&&a.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,t,r,s=!1){if(ue(t.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));ue(i instanceof Ks,()=>"The result y returned by f() must be a tensor.");const a=AAe(this.state.activeTape,t,i);if(!s&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[i.id]=r??PAe(i.shape),NAe(o,a,c=>this.tidy(c),OAe);const l=t.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return ue(a3(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{ue(t.every(o=>o instanceof Ks),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};t.forEach((o,l)=>{s[l]=o});const i=(o,l)=>(r=e(...t,l),ue(r.value instanceof Ks,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),ue(a3(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),a=(o,l)=>{const c=r.gradFunc(o,l),u=Array.isArray(c)?c:[c];ue(u.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),ue(u.every(p=>p instanceof Ks),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((p,x)=>{d[x]=()=>p}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:a,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Ya(),r=await this.backend.time(e);return r.wallMs=Ya()-t,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new eB;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Tg.nextTensorId=0;Tg.nextVariableId=0;function PAe(n){const e=SD(Ue(n),"float32");return Te.makeTensor(e,n,"float32")}function TY(){const n=qX();if(n._tfengine==null){const e=new aAe(n);n._tfengine=new Tg(e)}return uAe(n._tfengine.ENV),RAe(()=>n._tfengine),n._tfengine}const Te=TY();function OAe(n,e){const t={a:n,b:e};return Te.runKernel(nx,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MAe(){return typeof navigator<"u"&&navigator!=null}function CY(n){if(n||MAe()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function AY(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const to=Me();to.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});to.registerFlag("IS_BROWSER",()=>AY());to.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");to.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));to.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));to.registerFlag("PROD",()=>!1);to.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>to.getBool("DEBUG"));to.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);to.registerFlag("IS_TEST",()=>!1);to.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>to.getBool("DEBUG"));to.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);to.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);to.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oC(n,e){let t=n;if(Dl(n))return e==="string"?[]:[n.length];if(_Y(n)){const s=n.channels||"RGBA";return[n.height,n.width*s.length]}else if(wY(n))return[n.buffer.size/(e==null?4:DE(e))];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(t)||Dl(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&Me().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&NY(n,r,[]),r}function NY(n,e,t){if(t=t||[],!Array.isArray(n)&&!Dl(n)){ue(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}ue(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),ue(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const r=e.slice(1);for(let s=0;s<n.length;++s)NY(n[s],r,t.concat(s))}function tB(n,e,t,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${r}' must be ${n} tensor, but got ${e} tensor`)}}function me(n,e,t,r="numeric"){if(n instanceof je())return tB(r,n.dtype,e,t),n;let s=ex(n);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),tB(r,s,e,t),n==null||!Dl(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const i=oC(n,s);!Dl(n)&&!Array.isArray(n)&&(n=[n]);const o=s!=="string"?Rm(n,s):hm(n,[],!0);return Te.makeTensor(o,i,s)}function kY(n,e,t,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,a)=>me(i,`${e}[${a}]`,t,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FAe="__op";function Ae(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+FAe;const s=(...i)=>{Te.startScope(t);try{const a=r(...i);return TD(a)&&console.error("Cannot return a Promise inside of tidy."),Te.endScope(a),a}catch(a){throw Te.endScope(null),a}};return Object.defineProperty(s,"name",{value:t,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BAe(n,e){const t=me(n,"real","complex"),r=me(e,"imag","complex");ED(t.shape,r.shape,`real and imag shapes, ${t.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:t,imag:r};return Te.runKernel(LD,s)}const Cg=Ae({complex_:BAe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lC(n,e,t,r){if(r==null)r=ex(n);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(wY(n)||_Y(n)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return Te.backend.createTensorFromGPUData(n,e||t,r)}if(!Dl(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Mh(e);const s=Ue(e),i=Ue(t);ue(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let a=0;a<t.length;++a){const o=t[a],l=a===t.length-1?o!==Ue(e.slice(a)):!0;ue(t[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!Dl(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=r!=="string"?Rm(n,r):hm(n,[],!0),Te.makeTensor(n,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IY(n,e,t){const r=oC(n,t);return lC(n,e,r,t)}class rx{static join(e){return new rx(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Dl(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=t+s.byteLength;this.shards.push({buffer:s,start:t,end:i}),t=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=t-e,i=new ArrayBuffer(s),a=new Uint8Array(i);let o=0;for(let l=r;l<this.shards.length;l++){const c=this.shards[l],d=e+o-c.start,p=o,y=Math.min(t,c.end)-c.start,v=new Uint8Array(c.buffer,d,y-d);if(a.set(v,p),o+=v.length,t<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(s){return e<s.start?-1:e>=s.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=zAe(this.shards,t);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function zAe(n,e){let t=0,r=n.length;for(;t<=r;){const s=Math.floor((r-t)/2)+t,i=e(n[s]);if(i===0)return s;i<0?r=s:t=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zc(){return Te}function nB(){return Te.memory()}function De(n,e){return Te.tidy(n,e)}function In(n){EY(n).forEach(t=>t.dispose())}function hu(n){return Te.keep(n)}function RY(n,e,t=1){return Te.registerBackend(n,e,t)}function jAe(){return Te.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rB=4;async function sB(n,e){const t=[],r=[],s=Array.isArray(n)?n.map(a=>a.name):Object.keys(n);for(let a=0;a<s.length;++a){const o=s[a],l=Array.isArray(n)?n[a].tensor:n[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const p=await l.bytes(),x=p.reduce((b,S)=>b+S.length,0)+rB*p.length,y=new Uint8Array(x);let v=0;for(let b=0;b<p.length;b++){const S=p[b],T=new Uint8Array(new Uint32Array([S.length]).buffer);y.set(T,v),v+=rB,y.set(S,v),v+=S.length}d(y)});r.push(u)}else r.push(l.data());e!=null&&(c.group=e),t.push(c)}const i=await Promise.all(r);return{data:VAe(i),specs:t}}function VAe(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return t.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const m$=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function iB(n){return m$?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function UAe(n){if(m$)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let r=0,s=e.length;r<s;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function GAe(n){if(m$){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t.set([e.charCodeAt(r)],r);return t.buffer}function HAe(n){return rx.join(n)}function DY(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:iB(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:iB(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new rx(n.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xa{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return xa.instance==null&&(xa.instance=new xa),xa.instance}static registerSaveRouter(e){xa.getInstance().saveRouters.push(e)}static registerLoadRouter(e){xa.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return xa.getHandlers(e,"save")}static getLoadHandlers(e,t){return xa.getHandlers(e,"load",t)}static getHandlers(e,t,r){const s=[];return(t==="load"?xa.getInstance().loadRouters:xa.getInstance().saveRouters).forEach(a=>{const o=a(e,r);o!==null&&s.push(o)}),s}}const WAe=n=>xa.getSaveHandlers(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g3="tensorflowjs",x3=1,Dp="models_store",Gd="model_info_store";function $Y(){if(!Me().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function y3(n){const e=n.result;e.createObjectStore(Dp,{keyPath:"modelPath"}),e.createObjectStore(Gd,{keyPath:"modelPath"})}class dm{constructor(e){if(this.indexedDB=$Y(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,s)=>{const i=this.indexedDB.open(g3,x3);i.onupgradeneeded=()=>y3(i),i.onsuccess=()=>{const a=i.result;if(t==null){const o=a.transaction(Dp,"readonly"),c=o.objectStore(Dp).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=u=>(a.close(),s(c.error)),o.oncomplete=()=>a.close()}else{t.weightData=rx.join(t.weightData);const o=DY(t),l=a.transaction(Gd,"readwrite");let c=l.objectStore(Gd),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(p){return s(p)}let d;u.onsuccess=()=>{d=a.transaction(Dp,"readwrite");const p=d.objectStore(Dp);let x;try{x=p.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o})}catch(y){return s(y)}x.onsuccess=()=>r({modelArtifactsInfo:o}),x.onerror=y=>{c=l.objectStore(Gd);const v=c.delete(this.modelPath);v.onsuccess=()=>(a.close(),s(x.error)),v.onerror=b=>(a.close(),s(x.error))}},u.onerror=p=>(a.close(),s(u.error)),l.oncomplete=()=>{d==null?a.close():d.oncomplete=()=>a.close()}}},i.onerror=a=>s(i.error)})}}dm.URL_SCHEME="indexeddb://";const LY=n=>Me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(dm.URL_SCHEME)?qAe(n.slice(dm.URL_SCHEME.length)):null;xa.registerSaveRouter(LY);xa.registerLoadRouter(LY);function qAe(n){return new dm(n)}function KAe(n){return n.startsWith(dm.URL_SCHEME)?n.slice(dm.URL_SCHEME.length):n}class XAe{constructor(){this.indexedDB=$Y()}async listModels(){return new Promise((e,t)=>{const r=this.indexedDB.open(g3,x3);r.onupgradeneeded=()=>y3(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(Gd,"readonly"),o=i.objectStore(Gd).getAll();o.onsuccess=()=>{const l={};for(const c of o.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},o.onerror=l=>(s.close(),t(o.error)),i.oncomplete=()=>s.close()},r.onerror=s=>t(r.error)})}async removeModel(e){return e=KAe(e),new Promise((t,r)=>{const s=this.indexedDB.open(g3,x3);s.onupgradeneeded=()=>y3(s),s.onsuccess=()=>{const i=s.result,a=i.transaction(Gd,"readwrite"),o=a.objectStore(Gd),l=o.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=o.delete(e),d=()=>{c=i.transaction(Dp,"readwrite");const x=c.objectStore(Dp).delete(e);x.onsuccess=()=>t(l.result.modelArtifactsInfo),x.onerror=y=>r(l.error)};u.onsuccess=d,u.onerror=p=>(d(),i.close(),r(l.error))}},l.onerror=u=>(i.close(),r(l.error)),a.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hh="/",z0="tensorflowjs_models",PY="info",YAe="model_topology",ZAe="weight_specs",QAe="weight_data",JAe="model_metadata";function OY(n){return{info:[z0,n,PY].join(hh),topology:[z0,n,YAe].join(hh),weightSpecs:[z0,n,ZAe].join(hh),weightData:[z0,n,QAe].join(hh),modelMetadata:[z0,n,JAe].join(hh)}}function MY(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function eNe(n){const e=n.split(hh);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(hh)}function tNe(n){return n.startsWith(fm.URL_SCHEME)?n.slice(fm.URL_SCHEME.length):n}class fm{constructor(e){if(!Me().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=OY(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=DY(e),i=rx.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,UAe(i));const a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:s}}catch{throw MY(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const o=JSON.parse(i);t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,o.signature!=null&&(t.signature=o.signature),o.userDefinedMetadata!=null&&(t.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(t.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(t.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(t.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=GAe(a),t}}fm.URL_SCHEME="localstorage://";const FY=n=>Me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(fm.URL_SCHEME)?nNe(n.slice(fm.URL_SCHEME.length)):null;xa.registerSaveRouter(FY);xa.registerLoadRouter(FY);function nNe(n){return new fm(n)}class rNe{constructor(){ue(Me().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),ue(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=z0+hh,r=hh+PY;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(t)&&i.endsWith(r)){const a=eNe(i);e[a]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=tNe(e);const t=OY(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(t.info));return MY(t),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aB="://";class Uc{constructor(){this.managers={}}static getInstance(){return Uc.instance==null&&(Uc.instance=new Uc),Uc.instance}static registerManager(e,t){ue(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(aB)&&(e=e.slice(0,e.indexOf(aB))),ue(e.length>0,()=>"scheme must not be an empty string.");const r=Uc.getInstance();ue(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=t}static getManager(e){const t=Uc.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(Uc.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sNe{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!Me().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return xY(e)}}if(Me().get("IS_BROWSER")){Me().setPlatform("browser",new sNe);try{Uc.registerManager(fm.URL_SCHEME,new rNe)}catch{}try{Uc.registerManager(dm.URL_SCHEME,new XAe)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iNe={importFetch:()=>require("node-fetch")};let Tk;class aNe{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Me().global.fetch!=null?Me().global.fetch(e,t):(Tk==null&&(Tk=iNe.importFetch()),Tk(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Me().get("IS_NODE")&&!Me().get("IS_BROWSER")&&Me().setPlatform("node",new aNe);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function En(n,e="float32",t){return e=e||"float32",Mh(n),new Oi(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNe(n,e){const t=me(n,"x","cast");if(!nAe(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:t},s={dtype:e};return Te.runKernel(Ib,r,s)}const mt=Ae({cast_:oNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lNe(n){const t={x:me(n,"x","clone","string_or_numeric")};return Te.runKernel(Ub,t)}const Vp=Ae({clone_:lNe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cNe(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */TY();const uNe={buffer:En,cast:mt,clone:Vp,print:cNe};DAe(uNe);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hNe(n,e){let t=me(n,"a","add"),r=me(e,"b","add");[t,r]=Ss(t,r);const s={a:t,b:r};return Te.runKernel(nx,s)}const tt=Ae({add_:hNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dNe(n,e){let t=me(n,"a","floorDiv"),r=me(e,"b","floorDiv");[t,r]=Ss(t,r);const s={a:t,b:r};return Te.runKernel(jb,s)}const BY=Ae({floorDiv_:dNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fNe(n,e){let t=me(n,"a","div"),r=me(e,"b","div");if([t,r]=Ss(t,r),t.dtype==="int32"&&r.dtype==="int32")return BY(t,r);const s={a:t,b:r},i={};return Te.runKernel(Pb,s,i)}const Pt=Ae({div_:fNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pNe(n,e){let t=me(n,"a","mul"),r=me(e,"b","mul");[t,r]=Ss(t,r);const s={a:t,b:r};return Te.runKernel(Qb,s)}const Ee=Ae({mul_:pNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mNe(n){const e=me(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return Te.runKernel(fT,t)}else{const t={x:e};return Te.runKernel(aT,t)}}const ba=Ae({abs_:mNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gNe(n){const t={x:me(n,"x","acos")};return Te.runKernel(Eb,t)}const xNe=Ae({acos_:gNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yNe(n){const t={x:me(n,"x","acosh")};return Te.runKernel(Sb,t)}const bNe=Ae({acosh_:yNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vNe(n,e=null,t=!1){const s={x:me(n,"x","all","bool")},i={axis:e,keepDims:t};return Te.runKernel(ND,s,i)}const zY=Ae({all_:vNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ne(n,e=null,t=!1){const s={x:me(n,"x","any","bool")},i={axis:e,keepDims:t};return Te.runKernel(kD,s,i)}const b3=Ae({any_:_Ne});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wNe(n,e=0){const r={x:me(n,"x","argMax")},s={axis:e};return Te.runKernel(oT,r,s)}const C1=Ae({argMax_:wNe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ENe(n,e=0){const r={x:me(n,"x","argMin")},s={axis:e};return Te.runKernel(lT,r,s)}const SNe=Ae({argMin_:ENe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TNe(n){const t={x:me(n,"x","asin")};return Te.runKernel(Tb,t)}const CNe=Ae({asin_:TNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ANe(n){const t={x:me(n,"x","asinh")};return Te.runKernel(Cb,t)}const NNe=Ae({asinh_:ANe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kNe(n){const t={x:me(n,"x","atan")};return Te.runKernel(Ab,t)}const INe=Ae({atan_:kNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RNe(n,e){let t=me(n,"a","atan2"),r=me(e,"b","atan2");[t,r]=Ss(t,r);const s={a:t,b:r};return Te.runKernel(kb,s)}const DNe=Ae({atan2_:RNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ne(n){const t={x:me(n,"x","atanh")};return Te.runKernel(Nb,t)}const LNe=Ae({atanh_:$Ne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yv(n,e,t,r,s="NHWC",i){const a=n[3],o=[...e,a],l=Bh(s);return Fi(n,o,t,i,r,null,null,l)}function Ml(n,e,t,r,s,i,a="channelsLast"){const[o,l]=A1(e);let c;if(a==="channelsLast")c=[o,l,n[3],n[3]];else if(a==="channelsFirst")c=[o,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return Fi(n,c,t,r,s,i,!1,a)}function Fh(n,e,t,r,s,i,a="NDHWC"){const[o,l,c]=v3(e);let u,d;if(a==="NDHWC")d="channelsLast",u=[o,l,c,n[4],n[4]];else if(a==="NCDHW")d="channelsFirst",u=[o,l,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return Of(n,u,t,r,s,!1,d,i)}function Fi(n,e,t,r,s,i,a=!1,o="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d]=n;else if(o==="channelsFirst")[l,d,c,u]=n;else throw new Error(`Unknown dataFormat ${o}`);const[p,x,,y]=e,[v,b]=A1(t),[S,T]=A1(r),C=og(p,S),I=og(x,T),{padInfo:$,outHeight:q,outWidth:U}=MNe(s,c,u,v,b,C,I,i,o),F=a?y*d:y;let G;return o==="channelsFirst"?G=[l,F,q,U]:o==="channelsLast"&&(G=[l,q,U,F]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:u,inChannels:d,outHeight:q,outWidth:U,outChannels:F,padInfo:$,strideHeight:v,strideWidth:b,filterHeight:p,filterWidth:x,effectiveFilterHeight:C,effectiveFilterWidth:I,dilationHeight:S,dilationWidth:T,inShape:n,outShape:G,filterShape:e}}function Of(n,e,t,r,s,i=!1,a="channelsLast",o){let[l,c,u,d,p]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d,p]=n;else if(a==="channelsFirst")[l,p,c,u,d]=n;else throw new Error(`Unknown dataFormat ${a}`);const[x,y,v,,b]=e,[S,T,C]=v3(t),[I,$,q]=v3(r),U=og(x,I),F=og(y,$),G=og(v,q),{padInfo:V,outDepth:O,outHeight:K,outWidth:P}=FNe(s,c,u,d,S,T,C,U,F,G,o),N=i?b*p:b;let M;return a==="channelsFirst"?M=[l,N,O,K,P]:a==="channelsLast"&&(M=[l,O,K,P,N]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:u,inWidth:d,inChannels:p,outDepth:O,outHeight:K,outWidth:P,outChannels:N,padInfo:V,strideDepth:S,strideHeight:T,strideWidth:C,filterDepth:x,filterHeight:y,filterWidth:v,effectiveFilterDepth:U,effectiveFilterHeight:F,effectiveFilterWidth:G,dilationDepth:I,dilationHeight:$,dilationWidth:q,inShape:n,outShape:M,filterShape:e}}function PNe(n,e,t,r,s){r==null&&(r=g$(n,e,t));const i=n[0],a=n[1],o=N1((i-e+2*r)/t+1,s),l=N1((a-e+2*r)/t+1,s);return[o,l]}function ONe(n,e,t,r,s,i){s==null&&(s=g$(n,e[0],r[0]));const a=[0,0,0,t];for(let o=0;o<3;o++)n[o]+2*s>=e[o]&&(a[o]=N1((n[o]-e[o]+2*s)/r[o]+1,i));return a}function g$(n,e,t,r=1){const s=og(e,r);return Math.floor((n[0]*(t-1)-t+s)/2)}function A1(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function v3(n){return typeof n=="number"?[n,n,n]:n}function og(n,e){return e<=1?n:n+(n-1)*(e-1)}function MNe(n,e,t,r,s,i,a,o,l){let c,u,d;if(typeof n=="number"){c={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const x=PNe([e,t],i,r,n,o);u=x[0],d=x[1]}else if(n==="same"){u=Math.ceil(e/r),d=Math.ceil(t/s);const p=Math.max(0,(u-1)*r+i-e),x=Math.max(0,(d-1)*s+a-t),y=Math.floor(p/2),v=p-y,b=Math.floor(x/2),S=x-b;c={top:y,bottom:v,left:b,right:S,type:"SAME"}}else if(n==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/r),d=Math.ceil((t-a+1)/s);else if(typeof n=="object"){const p=l==="channelsLast"?n[1][0]:n[2][0],x=l==="channelsLast"?n[1][1]:n[2][1],y=l==="channelsLast"?n[2][0]:n[3][0],v=l==="channelsLast"?n[2][1]:n[3][1];c={top:p,bottom:x,left:y,right:v,type:p===0&&x===0&&y===0&&v===0?"VALID":"EXPLICIT"},u=N1((e-i+p+x)/r+1,o),d=N1((t-a+y+v)/s+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:c,outHeight:u,outWidth:d}}function FNe(n,e,t,r,s,i,a,o,l,c,u){let d,p,x,y;if(n==="valid"&&(n=0),typeof n=="number"){d={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const b=ONe([e,t,r,1],[o,l,c],1,[s,i,a],n,u);p=b[0],x=b[1],y=b[2]}else if(n==="same"){p=Math.ceil(e/s),x=Math.ceil(t/i),y=Math.ceil(r/a);const v=(p-1)*s+o-e,b=(x-1)*i+l-t,S=(y-1)*a+c-r,T=Math.floor(v/2),C=v-T,I=Math.floor(b/2),$=b-I,q=Math.floor(S/2),U=S-q;d={top:I,bottom:$,left:q,right:U,front:T,back:C,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:d,outDepth:p,outHeight:x,outWidth:y}}function N1(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function pm(n){const[e,t,r]=A1(n);return e===1&&t===1&&r===1}function sa(n,e){return pm(n)||pm(e)}function mm(n){return A1(n).every(e=>e>0)}function Bh(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function ro(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")ue(Sg(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{ue(Sg(s),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${s}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BNe(n,e){const r={x:me(n,"x","reshape","string_or_numeric")},s={shape:e};return Te.runKernel(qT,r,s)}const Ce=Ae({reshape_:BNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zNe(n,e,t,r,s){const i=me(n,"x","avgPool","float32"),a=1;ue(sa(t,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);let o=i,l=!1;i.rank===3&&(l=!0,o=Ce(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ue(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),ro("avgPool",r,s);const c={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s};let d=Te.runKernel(cT,c,u);return d=mt(d,i.dtype),l?Ce(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const x$=Ae({avgPool_:zNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jNe(n,e,t,r,s,i="NDHWC"){const a=me(n,"x","avgPool3d","float32");let o=a,l=!1;a.rank===4&&(l=!0,o=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),ue(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),ue(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),ue(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),ro("avgPool3d",r,s);const c={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i};let d=Te.runKernel(uT,c,u);return d=mt(d,o.dtype),l?Ce(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const VNe=Ae({avgPool3d_:jNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UNe(n,e=0){ue(n.length>=1,()=>"Pass at least one tensor to concat");const t=kY(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return Vp(t[0]);const r=t,s={axis:e};return Te.runKernel(pT,r,s)}const eo=Ae({concat_:UNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GNe(n,e,t=!1,r=!1){let s=me(n,"a","matMul"),i=me(e,"b","matMul");[s,i]=Ss(s,i);const a={a:s,b:i},o={transposeA:t,transposeB:r};return Te.runKernel(hT,a,o)}const fr=Ae({matMul_:GNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HNe(n){const t={x:me(n,"x","sigmoid","float32")};return Te.runKernel(cv,t)}const sx=Ae({sigmoid_:HNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WNe(n,e,t){const r=me(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:t};return Te.runKernel(QT,s,i)}const Pr=Ae({slice_:WNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qNe(n){const t={x:me(n,"x","tanh","float32")};return Te.runKernel(mv,t)}const cC=Ae({tanh_:qNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KNe(n,e,t){const r=me(n,"x","batchToSpaceND"),s=e.reduce((o,l)=>o*l);ue(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),ue(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),ue(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},a={blockShape:e,crops:t};return Te.runKernel(dT,i,a)}const y$=Ae({batchToSpaceND_:KNe});function XNe(n){let e;return n.rank===0||n.rank===1?e=Ce(n,[1,1,1,n.size]):n.rank===2?e=Ce(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=Ce(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YNe(n,e,t,r,s,i){i==null&&(i=.001);const a=me(n,"x","batchNorm"),o=me(e,"mean","batchNorm"),l=me(t,"variance","batchNorm");let c;s!=null&&(c=me(s,"scale","batchNorm"));let u;r!=null&&(u=me(r,"offset","batchNorm")),ue(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ue(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ue(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:XNe(a),scale:c,offset:u,mean:o,variance:l},x={varianceEpsilon:i},y=Te.runKernel(ET,p,x);return Ce(y,a.shape)}const uC=Ae({batchNorm_:YNe});function ZNe(n,e,t,r,s,i){const a=me(n,"x","batchNorm"),o=me(e,"mean","batchNorm"),l=me(t,"variance","batchNorm");let c;s!=null&&(c=me(s,"scale","batchNorm"));let u;return r!=null&&(u=me(r,"offset","batchNorm")),ue(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),ue(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),ue(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&ue(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&ue(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),uC(a,o,l,u,c,i)}const QNe=Ae({batchNorm2d_:ZNe});function JNe(n,e,t,r,s,i){const a=me(n,"x","batchNorm"),o=me(e,"mean","batchNorm"),l=me(t,"variance","batchNorm");let c;s!=null&&(c=me(s,"scale","batchNorm"));let u;return r!=null&&(u=me(r,"offset","batchNorm")),ue(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),ue(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),ue(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&ue(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&ue(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),uC(a,o,l,u,c,i)}const eke=Ae({batchNorm3d_:JNe});function tke(n,e,t,r,s,i){const a=me(n,"x","batchNorm"),o=me(e,"mean","batchNorm"),l=me(t,"variance","batchNorm");let c;s!=null&&(c=me(s,"scale","batchNorm"));let u;return r!=null&&(u=me(r,"offset","batchNorm")),ue(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),ue(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),ue(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&ue(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&ue(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),uC(a,o,l,u,c,i)}const nke=Ae({batchNorm4d_:tke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rke(n,e,t){const r=me(n,"x","bincount"),s=me(e,"weights","bincount");ue(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),ue(t>=0,()=>`size must be non-negative, but got ${t}.`),ue(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},a={size:t};return Te.runKernel(DD,i,a)}const ske=Ae({bincount_:rke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ike(n,e){let t=me(n,"broadcastTo","x");const r=t.shape;if(Mh(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const c=t.shape.slice();for(;c.length<e.length;)c.unshift(1);t=Ce(t,c)}const s=t.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(s[c]===e[c])i[c]=1;else if(t.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Vp(t);const o={x:t},l={reps:i};return Te.runKernel(gv,o,l)}const Ky=Ae({broadcastTo_:ike});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ake(n){const t={x:me(n,"x","ceil","float32")};return Te.runKernel(Rb,t)}const oke=Ae({ceil_:ake});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hC(n,e,t){Mh(n),t=t||ex(e);const r={shape:n,value:e,dtype:t};return Te.runKernel(qD,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lke(n,e,t){const r=me(n,"x","clipByValue");if(ue(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return hC(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:t};return Te.runKernel(Db,s,i)}const tl=Ae({clipByValue_:lke});function cke(n){return eo(n,0)}const uke=Ae({concat1d_:cke});function hke(n,e){return eo(n,e)}const dke=Ae({concat2d_:hke});function fke(n,e){return eo(n,e)}const pke=Ae({concat3d_:fke});function mke(n,e){return eo(n,e)}const gke=Ae({concat4d_:mke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(n,e,t,r,s="NHWC",i=[1,1],a){const o=me(n,"x","conv2d","float32"),l=me(e,"filter","conv2d","float32");let c=o,u=!1;o.rank===3&&(u=!0,c=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),ue(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),ue(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),ro("conv2d",r,a);const d=s==="NHWC"?c.shape[3]:c.shape[1];ue(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),ue(sa(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),ue(mm(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),ue(mm(t),()=>"Error in conv2D: Strides should be larger than 0.");const p={x:c,filter:l},x={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a},y=Te.runKernel(mT,p,x);return u?Ce(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const gm=Ae({conv2d_:xke});function yke(n,e,t,r,s="NWC",i=1,a){const o=me(n,"x","conv1d"),l=me(e,"filter","conv1d");let c=o,u=!1;o.rank===2&&(u=!0,c=Ce(o,[1,o.shape[0],o.shape[1]])),ue(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),ue(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),ro("conv1d",r,a),ue(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),ue(sa(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),ue(mm(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),ue(mm(t),()=>"Error in conv1D: Stride should be larger than 0."),ue(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=Ce(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=Ce(c,[c.shape[0],1,c.shape[1],c.shape[2]]),b=gm(p,d,[1,t],r,"NHWC",[1,i],a);return u?Ce(b,[b.shape[2],b.shape[3]]):Ce(b,[b.shape[0],b.shape[2],b.shape[3]])}const jY=Ae({conv1d_:yke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bke(n,e,t,r,s,i="NHWC",a){ue(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,l=e,c=!1;e.rank===3&&(c=!0,l=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,n[0],n[1],n[2]]),ue(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),ue(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),ue(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const u=i==="NHWC"?o[3]:o[1],d=i==="NHWC"?l.shape[3]:l.shape[1];ue(u===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${t.shape[2]}.`),ue(d===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${t.shape[3]}.`),ro("conv2dDerInput",s,a);const p={dy:l,filter:t},x={strides:r,pad:s,dataFormat:i,dimRoundingMode:a,inputShape:o},y=Te.runKernel(gT,p,x);return c?Ce(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const b$=Ae({conv2DBackpropInput_:bke});function vke(n,e,t,r,s,i){const a=me(n,"x","conv2dTranspose"),o=me(e,"filter","conv2dTranspose");return b$(t,a,o,r,s,"NHWC",i)}const VY=Ae({conv2dTranspose_:vke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ke(n,e,t,r,s="NDHWC",i=[1,1,1]){const a=me(n,"x","conv3d"),o=me(e,"filter","conv3d");let l=a,c=!1;a.rank===4&&(c=!0,l=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),ue(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),ue(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),ue(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),ue(sa(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),ue(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),ue(mm(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),ue(mm(t),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:o},d={strides:t,pad:r,dataFormat:s,dilations:i},p=Te.runKernel(xT,u,d);return c?Ce(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const wke=Ae({conv3d_:_ke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eke(n,e,t,r,s){ue(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,a=e,o=!1;e.rank===4&&(o=!0,a=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const l=i[4],c=a.shape[4];ue(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),ue(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),ue(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),ue(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),ue(c===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${t.shape[4]}.`);const u={dy:a,filter:t},d={pad:s,strides:r,inputShape:i},p=Te.runKernel(MD,u,d);return o?Ce(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const UY=Ae({conv3DBackpropInput_:Eke});function Ske(n,e,t,r,s){const i=me(n,"x","conv3dTranspose"),a=me(e,"filter","conv3dTranspose");return UY(t,i,a,r,s)}const Tke=Ae({conv3dTranspose_:Ske});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(n){const t={x:me(n,"x","cos","float32")};return Te.runKernel($b,t)}const v$=Ae({cos_:Cke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ake(n){const t={x:me(n,"x","cosh","float32")};return Te.runKernel(Lb,t)}const GY=Ae({cosh_:Ake});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nke(n,e=0,t=!1,r=!1){const i={x:me(n,"x","cumprod")},a={axis:e,exclusive:t,reverse:r};return Te.runKernel(FD,i,a)}const _3=Ae({cumprod_:Nke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kke(n,e=0,t=!1,r=!1){const i={x:me(n,"x","cumsum")},a={axis:e,exclusive:t,reverse:r};return Te.runKernel(yT,i,a)}const HY=Ae({cumsum_:kke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ike(n,e,t,r=!1){const s=me(n,"x","denseBincount"),i=me(e,"weights","denseBincount");ue(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),ue(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),ue(t>=0,()=>`size must be non-negative, but got ${t}.`),ue(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const a={x:s,weights:i},o={size:t,binaryOutput:r};return Te.runKernel(zD,a,o)}const oB=Ae({denseBincount_:Ike});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rke(n,e,t="NHWC"){const r=me(n,"x","depthToSpace","float32"),s=t==="NHWC"?r.shape[1]:r.shape[2],i=t==="NHWC"?r.shape[2]:r.shape[3],a=t==="NHWC"?r.shape[3]:r.shape[1];ue(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),ue(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),ue(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),ue(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${r.shape}`);const o={x:r},l={blockSize:e,dataFormat:t};return Te.runKernel(jD,o,l)}const Dke=Ae({depthToSpace_:Rke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(n,e,t,r,s="NHWC",i=[1,1],a){const o=me(n,"x","depthwiseConv2d","float32"),l=me(e,"filter","depthwiseConv2d","float32");let c=o,u=!1;o.rank===3&&(u=!0,c=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),ue(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),ue(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?c.shape[3]:c.shape[1];ue(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),ro("depthwiseConv2d",r,a);const p={x:c,filter:l},x={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a},y=Te.runKernel(bT,p,x);return u?Ce(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const _$=Ae({depthwiseConv2d_:$ke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lke(n,e,t,r,s=[1,1],i="NHWC"){const a=me(n,"x","dilation2d"),o=me(e,"filter","dilation2d");ue(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),ue(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),ue(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=a,c=!1;a.rank===3&&(l=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2]]),c=!0),ue(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const u={x:l,filter:o},d={strides:t,pad:r,dilations:s},p=Te.runKernel(vT,u,d);return c?Ce(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Pke=Ae({dilation2d_:Lke});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ag(n,e){const t=n.length,r=[];for(let s=0;s<t;s++){const i=t-1-s,a=n[i]||1;(e[e.length-1-s]||1)>1&&a===1&&r.unshift(i)}return r}function ti(n,e){const t=[];for(let r=0;r<e.length;r++){const s=n[n.length-r-1],i=e.length-r-1,a=e[i];(s==null||s===1&&a>1)&&t.unshift(i)}return t}function cn(n,e){const t=Math.max(n.length,e.length),r=new Array(t);for(let s=0;s<t;s++){let i=n[n.length-s-1];i==null&&(i=1);let a=e[e.length-s-1];if(a==null&&(a=1),i===1)r[t-s-1]=a;else if(a===1)r[t-s-1]=i;else if(i!==a){const o=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(o)}else r[t-s-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oke(n,e){let t=me(n,"a","equal","string_or_numeric"),r=me(e,"b","equal","string_or_numeric");[t,r]=Ss(t,r),cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(_T,s)}const Su=Ae({equal_:Oke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mke(n,e,t){const r=me(e,"a","where"),s=me(t,"b","where"),i=me(n,"condition","where","bool"),a=cn(cn(i.shape,r.shape),s.shape),o=Ky(i,a),l=Ky(r,a),c=Ky(s,a),u={condition:o,t:l,e:c};return Te.runKernel(ZT,u)}const ka=Ae({where_:Mke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fke(n){const t={x:me(n,"x","zerosLike")};return Te.runKernel(iC,t)}const Jn=Ae({zerosLike_:Fke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bke(n,e){let t=me(n,"a","div"),r=me(e,"b","div");[t,r]=Ss(t,r);const s=Pt(t,r),i=Jn(s),a=Su(r,i);return ka(a,i,s)}const zke=Ae({divNoNan_:Bke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jke(n,e){const t=me(n,"t1","dot"),r=me(e,"t2","dot");ue((t.rank===1||t.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${r.rank}.`);const s=t.rank===1?t.size:t.shape[1],i=r.rank===1?r.size:r.shape[0];if(ue(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),t.rank===1&&r.rank===1){const a=Ce(t,[1,-1]),o=Ce(r,[-1,1]),l=fr(a,o);return Ce(l,[])}else if(t.rank===1&&r.rank===2){const a=Ce(t,[1,-1]),o=Ce(r,[r.shape[0],r.shape[1]]),l=fr(a,o);return Ce(l,[l.size])}else if(t.rank===2&&r.rank===1){const a=Ce(r,[-1,1]),o=fr(t,a);return Ce(o,[o.size])}else{const a=Ce(r,[r.shape[0],r.shape[1]]);return fr(t,a)}}const Vke=Ae({dot_:jke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uke(n,...e){const t=e.map((s,i)=>me(s,`tensors${i}`,"einsum")),r={equation:n};return Te.runKernel(GD,t,r)}const my=Ae({einsum_:Uke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gke(n){const t={x:me(n,"x","elu","float32")};return Te.runKernel(Ob,t)}const dC=Ae({elu_:Gke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hke(n){let e=me(n,"x","erf");ue(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=mt(e,"float32"));const t={x:e};return Te.runKernel(Mb,t)}const WY=Ae({erf_:Hke});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w$(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function qY(n,e,t){const r=n.length+e.length,s=[];let i=0,a=0;for(let o=0;o<r;o++)t.indexOf(o)===-1?s.push(n[i++]):s.push(e[a++]);return s}function xi(n,e){const t=[],r=n.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);const s=e.map(i=>n[i]);return[t,s]}function Us(n,e){const t=e.map(r=>1);return qY(n,t,e)}function Bi(n,e,t){ue(w$(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function os(n,e){if(w$(n,e))return null;const t=[];for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(r=>t.push(r)),t}function Mf(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Cs(n,e){const t=[];for(let r=e-n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wke(n,e=null,t=!1){const s={x:me(n,"x","max")},i={reductionIndices:e,keepDims:t};return Te.runKernel($T,s,i)}const fc=Ae({max_:Wke});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qke(n,e=null,t=!1){const s={x:me(n,"x","min")},i={axis:e,keepDims:t};return Te.runKernel(MT,s,i)}const ME=Ae({min_:qke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kke(n,e){let t=me(n,"base","pow"),r=me(e,"exp","pow");[t,r]=Ss(t,r);const s={a:t,b:r};return Te.runKernel(Jb,s)}const xm=Ae({pow_:Kke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mr(n,e){if((Dl(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Dl(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return lC(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xke(n){const t={x:me(n,"x","sqrt","float32")};return Te.runKernel(hv,t)}const ta=Ae({sqrt_:Xke});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yke(n){const e=me(n,"x","square"),t={};return Te.runKernel("Square",{x:e},t)}const Ur=Ae({square_:Yke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zke(n,e=null,t=!1){let r=me(n,"x","sum");r.dtype==="bool"&&(r=mt(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return Te.runKernel(JT,s,i)}const $t=Ae({sum_:Zke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qke(n,e="euclidean",t=null,r=!1){n=me(n,"x","norm");const s=KY(n,e,t);let i=s.shape;if(r){const a=Sn(t,n.shape);i=Us(s.shape,a)}return Ce(s,i)}function KY(n,e,t=null){if(n.rank===0)return ba(n);if(n.rank!==1&&t===null)return KY(Ce(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return $t(ba(n),t);if(e===1/0)return fc(ba(n),t);if(e===-1/0)return ME(ba(n),t);if(e==="euclidean"||e===2)return ta($t(xm(ba(n),mr(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return fc($t(ba(n),t[0]),t[1]-1);if(e===1/0)return fc($t(ba(n),t[1]),t[0]);if(e===-1/0)return ME($t(ba(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return ta($t(Ur(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const fC=Ae({norm_:Qke});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jke(n,e=null,t=!1){return fC(n,"euclidean",e,t)}const eIe=Ae({euclideanNorm_:Jke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tIe(n){const t={x:me(n,"x","exp")};return Te.runKernel(Fb,t)}const Tu=Ae({exp_:tIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nIe(n,e=0){const t=me(n,"x","expandDims","string_or_numeric");ue(e<=t.rank,()=>"Axis must be <= rank of the tensor");const r={input:t},s={dim:e};return Te.runKernel(wT,r,s)}const Za=Ae({expandDims_:nIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rIe(n){const t={x:me(n,"x","expm1")};return Te.runKernel(Bb,t)}const sIe=Ae({expm1_:rIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIe(n,e){const t=me(n,"x","tile","string_or_numeric");ue(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const r={x:t},s={reps:e};return Te.runKernel(gv,r,s)}const cc=Ae({tile_:iIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aIe(n,e,t,r="float32"){e==null&&(e=n);const s=En([n,e],r),i=n<=e?n:e;for(let o=0;o<i;++o)s.set(1,o,o);const a=Ce(s.toTensor(),[n,e]);if(t==null)return a;if(t.length===1)return cc(Za(a,0),[t[0],1,1]);if(t.length===2)return cc(Za(Za(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return cc(Za(Za(Za(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const XY=Ae({eye_:aIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oIe(n){const t={x:me(n,"x","floor","float32")};return Te.runKernel(zb,t)}const pC=Ae({floor_:oIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lIe(n,e,t=0,r=0){const s=me(n,"x","gather"),i=me(e,"indices","gather","int32"),a={x:s,indices:i},o={axis:t,batchDims:r};return Te.runKernel(ST,a,o)}const E$=Ae({gather_:lIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cIe(n,e){let t=me(n,"a","greater","string_or_numeric"),r=me(e,"b","greater","string_or_numeric");[t,r]=Ss(t,r),cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(TT,s)}const rl=Ae({greater_:cIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uIe(n,e){let t=me(n,"a","greaterEqual","string_or_numeric"),r=me(e,"b","greaterEqual","string_or_numeric");[t,r]=Ss(t,r),cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(Vb,s)}const Dm=Ae({greaterEqual_:uIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hIe(n){const t={input:me(n,"input","imag")};return Te.runKernel(YD,t)}const S$=Ae({imag_:hIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dIe(n){const t={x:me(n,"x","isFinite")};return Te.runKernel(Gb,t)}const fIe=Ae({isFinite_:dIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pIe(n){const t={x:me(n,"x","isInf")};return Te.runKernel(Hb,t)}const mIe=Ae({isInf_:pIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gIe(n){const t={x:me(n,"x","isNaN")};return Te.runKernel(Wb,t)}const xIe=Ae({isNaN_:gIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yIe(n,e=.2){const r={x:me(n,"x","leakyRelu")},s={alpha:e};return Te.runKernel(CT,r,s)}const T$=Ae({leakyRelu_:yIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bIe(n,e){let t=me(n,"a","less","string_or_numeric"),r=me(e,"b","less","string_or_numeric");[t,r]=Ss(t,r),cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(AT,s)}const FE=Ae({less_:bIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vIe(n,e){let t=me(n,"a","lessEqual","string_or_numeric"),r=me(e,"b","lessEqual","string_or_numeric");[t,r]=Ss(t,r),cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(NT,s)}const ix=Ae({lessEqual_:vIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ie(n,e=5,t=1,r=1,s=.5){const i=me(n,"x","localResponseNormalization");ue(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),ue(Sg(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=i,o=!1;i.rank===3&&(o=!0,a=Ce(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:a},c={depthRadius:e,bias:t,alpha:r,beta:s},u=Te.runKernel(DT,l,c);return o?Ce(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const wIe=Ae({localResponseNormalization_:_Ie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EIe(n){const t={x:me(n,"x","log","float32")};return Te.runKernel(qb,t)}const Cu=Ae({log_:EIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SIe(n){const t={x:me(n,"x","log1p")};return Te.runKernel(Kb,t)}const YY=Ae({log1p_:SIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TIe(n,e){ue(a3(n),()=>"The f passed in variableGrads(f) must be a function"),ue(e==null||Array.isArray(e)&&e.every(c=>c instanceof OE),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const c in Te.registeredVariables)e.push(Te.registeredVariables[c])}const r=t?e.filter(c=>!c.trainable):null,s=e.length;e=e.filter(c=>c.trainable),ue(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:a,grads:o}=Te.gradients(n,e,null,i);ue(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),ue(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return e.forEach((c,u)=>{o[u]!=null&&(l[c.name]=o[u])}),r?.forEach(c=>l[c.name]=null),{value:a,grads:l}}function Ng(n){return Te.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CIe(n){const t={x:me(n,"x","neg")};return Te.runKernel(BT,t)}const _s=Ae({neg_:CIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AIe(n){const t={x:me(n,"x","softplus")};return Te.runKernel(uv,t)}const bv=Ae({softplus_:AIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NIe(n){const e=me(n,"x","logSigmoid");return Ng(r=>({value:_s(bv(_s(r))),gradFunc:a=>Ee(a,sx(_s(r)))}))(e)}const kIe=Ae({logSigmoid_:NIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IIe(n,e){let t=me(n,"a","sub"),r=me(e,"b","sub");[t,r]=Ss(t,r);const s={a:t,b:r};return Te.runKernel(fv,s)}const Vt=Ae({sub_:IIe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RIe(n,e=-1){const t=me(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Ng((s,i)=>{const o=fc(s,e,!0),l=Vt(s,o),c=Vt(mt(l,"float32"),Cu($t(Tu(l),e,!0)));return i([c]),{value:c,gradFunc:(d,p)=>{const[x]=p,y=!0,v=Tu(x);return Vt(d,Ee($t(d,e,y),v))}}})(t)}const ZY=Ae({logSoftmax_:RIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIe(n,e=null,t=!1){const r=me(n,"x","logSumExp"),s=Sn(e,r.shape),i=fc(r,s,!0),a=Vt(r,i),o=Tu(a),l=$t(o,s),c=Cu(l),u=tt(Ce(i,c.shape),c);if(t){const d=Us(u.shape,s);return Ce(u,d)}return u}const QY=Ae({logSumExp_:DIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ie(n,e){const t=me(n,"a","logicalAnd","bool"),r=me(e,"b","logicalAnd","bool");cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(kT,s)}const kh=Ae({logicalAnd_:$Ie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LIe(n){const t={x:me(n,"x","logicalNot","bool")};return Te.runKernel(IT,t)}const C$=Ae({logicalNot_:LIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PIe(n,e){const t=me(n,"a","logicalOr","bool"),r=me(e,"b","logicalOr","bool");cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(RT,s)}const JY=Ae({logicalOr_:PIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OIe(n,e){const t=me(n,"a","logicalXor","bool"),r=me(e,"b","logicalXor","bool");return cn(t.shape,r.shape),kh(JY(n,e),C$(kh(n,e)))}const MIe=Ae({logicalXor_:OIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIe(n,e,t,r,s){const i=me(n,"x","maxPool"),a=1;let o=i,l=!1;i.rank===3&&(l=!0,o=Ce(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ue(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),ue(sa(t,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),ro("maxPool",r,s);const c={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s},d=Te.runKernel(LT,c,u);return l?Ce(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const A$=Ae({maxPool_:FIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BIe(n,e=[1,1,1],t,r,s,i="NDHWC"){const a=me(n,"x","maxPool3d");let o=a,l=!1;a.rank===4&&(l=!0,o=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),ue(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),ue(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),ro("maxPool3d",r,s);const c={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i},d=Te.runKernel(PT,c,u);return l?Ce(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const zIe=Ae({maxPool3d_:BIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jIe(n,e){let t=me(n,"a","maximum"),r=me(e,"b","maximum");[t,r]=Ss(t,r),t.dtype==="bool"&&(t=mt(t,"int32"),r=mt(r,"int32")),cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(Xb,s)}const Ff=Ae({maximum_:jIe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VIe(n,e=null,t=!1){const s={x:me(n,"x","mean")},i={axis:e,keepDims:t};return Te.runKernel(OT,s,i)}const Fs=Ae({mean_:VIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fi(n,e="float32"){if(Mh(n),e==="complex64"){const r=fi(n,"float32"),s=fi(n,"float32");return Cg(r,s)}const t=ea(Ue(n),e);return Te.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bf(n,e="float32"){if(Mh(n),e==="complex64"){const r=Bf(n,"float32"),s=fi(n,"float32");return Cg(r,s)}const t=SD(Ue(n),e);return Te.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UIe(n,e){let t=me(n,"a","minimum"),r=me(e,"b","minimum");[t,r]=Ss(t,r),t.dtype==="bool"&&(t=mt(t,"int32"),r=mt(r,"int32")),cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(Yb,s)}const k1=Ae({minimum_:UIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GIe(n,e,t){ue(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const r=me(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");ue(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=t==="reflect"?1:0;for(let o=0;o<r.rank;o++)ue(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ue(e[o][0]>=0&&e[o][0]<=r.shape[o]-s&&e[o][1]>=0&&e[o][1]<=r.shape[o]-s,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:t},a={x:r};return Te.runKernel(FT,a,i)}const HIe=Ae({mirrorPad_:GIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WIe(n,e){let t=me(n,"a","mod"),r=me(e,"b","mod");[t,r]=Ss(t,r);const s={a:t,b:r};return Te.runKernel(Zb,s)}const qIe=Ae({mod_:WIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KIe(n,e=null,t=!1){n=me(n,"x","moments");const r=Sn(e,n.shape),s=Fs(n,r,t);let i=s.shape;t||(i=Us(s.shape,r));const a=Ur(Vt(mt(n,"float32"),Ce(s,i))),o=Fs(a,r,t);return{mean:s,variance:o}}const N$=Ae({moments_:KIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XIe(n,e){let t=me(n,"a","notEqual","string_or_numeric"),r=me(e,"b","notEqual","string_or_numeric");[t,r]=Ss(t,r),cn(t.shape,r.shape);const s={a:t,b:r};return Te.runKernel(zT,s)}const BE=Ae({notEqual_:XIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YIe(n,e,t=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:me(n,"indices","oneHot","int32")},o={dtype:s,depth:e,onValue:t,offValue:r};return Te.runKernel(VT,a,o)}const eZ=Ae({oneHot_:YIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZIe(n){const t={x:me(n,"x","onesLike")};return Te.runKernel(jT,t)}const $l=Ae({onesLike_:ZIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QIe(n,e,t=0){const r=me(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:t},i={x:r};return Te.runKernel(GT,i,s)}const k$=Ae({pad_:QIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JIe(n,e,t){const r=me(n,"x","spaceToBatchND");ue(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),ue(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),ue(r.shape.reduce((a,o,l)=>l>0&&l<=e.length?a&&(o+t[l-1][0]+t[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:t};return Te.runKernel(eC,s,i)}const I$=Ae({spaceToBatchND_:JIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3e(n,e,t,r,s,i,a){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const o=me(n,"x","maxPool");let l=o,c=!1;o.rank===3&&(c=!0,l=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),ue(sa(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const u=Ml(l.shape,e,i,s,r),d=[u.dilationHeight,u.dilationWidth];let p;r==="same"?p=n3e([u.filterHeight,u.filterWidth],d):p=[[0,0],[0,0]];const x=d[0]===1&&d[1]===1,[y,v]=t3e([u.inHeight,u.inWidth],d,p),b=x?r:"valid",S=x?l:I$(l,d,y),C=(t==="avg"?()=>x$(S,e,i,b,a):()=>A$(S,e,i,b,a))(),I=x?C:y$(C,d,v);return c?Ce(I,[I.shape[1],I.shape[2],I.shape[3]]):I}function t3e(n,e,t){const r=t.map(u=>u[0]),s=t.map(u=>u[1]),i=n.concat(r,s),a=e.map((u,d)=>(u-i[d]%u)%u),o=s.map((u,d)=>u+a[d]),l=e.map((u,d)=>[r[d],o[d]]),c=e.map((u,d)=>[0,a[d]]);return[l,c]}function n3e(n,e){const r=n.map((a,o)=>a+(a-1)*(e[o]-1)).map(a=>a-1),s=r.map(a=>Math.floor(a/2)),i=r.map((a,o)=>a-s[o]);return r.map((a,o)=>[s[o],i[o]])}const r3e=Ae({pool_:e3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3e(n,e){const t=me(n,"x","prelu"),r=me(e,"alpha","prelu"),s={x:t,alpha:r};return Te.runKernel(HT,s)}const R$=Ae({prelu_:s3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3e(n,e=null,t=!1){let r=me(n,"x","prod");r.dtype==="bool"&&(r=mt(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return Te.runKernel(WT,s,i)}const a3e=Ae({prod_:i3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tZ{constructor(e,t,r,s,i){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=i||Math.random();this.random=Qg.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,t,r=!1;for(;!r;){let s,i,a;do s=2*this.random()-1,i=2*this.random()-1,a=s*s+i*i;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*s*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class o3e{constructor(e=0,t=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=Qg.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3e(n,e=0,t=1,r,s){if(Mh(n),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new tZ(e,t,r,!1,s),a=En(n,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const c3e=Ae({randomNormal_:l3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3e(n,e=0,t=1,r="float32",s){Mh(n);const i=En(n,r),a=new o3e(e,t,null,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const vv=Ae({randomUniform_:u3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I1(n,e,t=1,r="float32"){if(t===0)throw new Error("Cannot have a step of zero");const s={start:n,stop:e,step:t,dtype:r};return Te.runKernel(r$,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3e(n){const t={input:me(n,"input","real")};return Te.runKernel(s$,t)}const zE=Ae({real_:h3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3e(n){const t={x:me(n,"x","reciprocal")};return Te.runKernel(ev,t)}const f3e=Ae({reciprocal_:d3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3e(n){const t={x:me(n,"x","relu")};return Te.runKernel(tv,t)}const $m=Ae({relu_:p3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m3e(n){const t={x:me(n,"x","relu6")};return Te.runKernel(nv,t)}const nZ=Ae({relu6_:m3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g3e(n,e){const r={x:me(n,"x","reverse")},s={dims:e};return Te.runKernel(YT,r,s)}const ym=Ae({reverse_:g3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x3e(n){const t={x:me(n,"x","round")};return Te.runKernel(rv,t)}const rZ=Ae({round_:x3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y3e(n){const t={x:me(n,"x","rsqrt","float32")};return Te.runKernel(sv,t)}const sZ=Ae({rsqrt_:y3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3e(n){const t={x:me(n,"x","selu")};return Te.runKernel(iv,t)}const iZ=Ae({selu_:b3e});function v3e(n,e,t,r,s,i=[1,1],a="NHWC"){const o=me(n,"x","separableConv2d"),l=me(e,"depthwiseFilter","separableConv2d"),c=me(t,"pointwiseFilter","separableConv2d");let u=o,d=!1;if(o.rank===3&&(d=!0,u=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ue(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),ue(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),ue(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),ue(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),ue(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const p=l.shape[2],x=l.shape[3];ue(c.shape[2]===p*x,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*x}, but got ${c.shape[2]}.`);const y=_$(u,l,r,s,a,i),b=gm(y,c,1,"valid",a);return d?Ce(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const aZ=Ae({separableConv2d_:v3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _3e(n){const t={x:me(n,"x","sign")};return Te.runKernel(lv,t)}const w3e=Ae({sign_:_3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E3e(n){const t={x:me(n,"x","sin","float32")};return Te.runKernel(av,t)}const oZ=Ae({sin_:E3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3e(n){const t={x:me(n,"x","sinh")};return Te.runKernel(ov,t)}const lZ=Ae({sinh_:S3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3e(n,e,t){const r=me(n,"x","slice1d");return ue(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Pr(r,[e],[t])}const D$=Ae({slice1d_:T3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C3e(n,e,t){const r=me(n,"x","slice2d");return ue(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Pr(r,e,t)}const cZ=Ae({slice2d_:C3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3e(n,e,t){const r=me(n,"x","slice3d");return ue(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Pr(r,e,t)}const $$=Ae({slice3d_:A3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3e(n,e,t){const r=me(n,"x","slice4d");return ue(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Pr(r,e,t)}const jE=Ae({slice4d_:N3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3e(n,e=-1){const t=me(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const r={logits:t},s={dim:e};return Te.runKernel(nC,r,s)}const L$=Ae({softmax_:k3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I3e(n){ue(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Te.runKernel(WD,e)}const uZ=Ae({fft_:I3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3e(n){ue(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Te.runKernel(XD,e)}const w3=Ae({ifft_:R3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3e(n){const e=n.shape[n.shape.length-1],t=n.size/e;let r;if(e<=2){const s=Ce(n,[t,e]);r=w3(s)}else{const s=[t,2*(e-1)],i=Ce(zE(n),[t,e]),a=Ce(S$(n),[t,e]),o=ym(Pr(i,[0,1],[t,e-2]),1),l=Ee(ym(Pr(a,[0,1],[t,e-2]),1),mr(-1)),c=eo([i,o],1),u=eo([a,l],1),d=Ce(Cg(c,u),[s[0],s[1]]);r=w3(d)}if(r=zE(r),n.rank===3&&n.shape[0]!==0){const s=r,i=n.shape[0];r=Ce(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const $3e=Ae({irfft_:D3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L3e(n,e,t=0){const s={x:me(n,"x","split")},i={numOrSizeSplits:e,axis:t};return Te.runKernel(tC,s,i)}const Jo=Ae({split_:L3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3e(n,e){ue(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const r=n.size/t;let s;if(e!=null&&e<t){const y=n.shape.map(b=>0),v=n.shape.map(b=>b);v[n.shape.length-1]=e,s=Pr(n,y,v),t=e}else if(e!=null&&e>t){const y=n.shape.map(v=>v);y[n.shape.length-1]=e-t,s=eo([n,fi(y)],n.shape.length-1),t=e}else s=n;const i=Jn(s),a=Ce(Cg(s,i),[r,t]),o=uZ(a),l=Math.floor(t/2)+1,c=zE(o),u=S$(o),d=Jo(c,[l,t-l],c.shape.length-1),p=Jo(u,[l,t-l],u.shape.length-1),x=s.shape.slice();return x[s.shape.length-1]=l,Ce(Cg(d[0],p[0]),x)}const O3e=Ae({rfft_:P3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M3e(n,e){let t=me(n,"a","squaredDifference"),r=me(e,"b","squaredDifference");[t,r]=Ss(t,r),cn(t.shape,r.shape);const s={a:t,b:r},i={};return Te.runKernel(dv,s,i)}const F3e=Ae({squaredDifference_:M3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3e(n,e){const t=me(n,"x","squeeze","string_or_numeric");return Ce(t,Lf(t.shape,e).newShape)}const _v=Ae({squeeze_:B3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3e(n,e=0){const t=kY(n,"tensors","stack","string_or_numeric");ue(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&ue(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const r=t,s={axis:e};return Te.runKernel(UT,r,s)}const Ih=Ae({stack_:z3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3e(n,e=0){const r={x:me(n,"x","step")},s={alpha:e};return Te.runKernel(xv,r,s)}const wv=Ae({step_:j3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V3e(n,e,t,r,s=0,i=0,a=0,o=0,l=0){const u={x:me(n,"x","stridedSlice","string_or_numeric")},d={begin:e,end:t,strides:r,beginMask:s,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};return Te.runKernel(c$,u,d)}const U3e=Ae({stridedSlice_:V3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3e(n){const t={x:me(n,"x","tan","float32")};return Te.runKernel(pv,t)}const H3e=Ae({tan_:G3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bo(n,e){jX(n);const t=oC(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return lC(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ck(n,e,t){if(jX(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=oC(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return lC(n,e,r,t)}function hZ(n,e,t){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${s}.`;if(t.rank<s)throw new Error(i+` update.rank < ${s}. `);if(n.length<r+(t.rank-s))throw new Error(i+` Output shape length < ${r+(t.rank-s)}`);if(t.rank!==s+n.length-r)throw new Error(i+` update.rank != ${s+n.length-r}`);for(let a=0;a<s;++a)if(t.shape[a]!==e.shape[a])throw new Error(i+` updates.shape[${a}] (${t.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<t.rank-s;++a)if(t.shape[a+s]!==n[a+r])throw new Error(i+` updates.shape[${a+s}] (${t.shape[a+s]}) != shape[${a+s}] (${n[a+s]})`)}function W3e(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}hZ(t,e,n)}function Lm(n,e,t){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=t.length;let a=1;for(let d=s;d<i;++d)a*=t[d];const o=s<1?1:s,l=Ue(e.shape)/o,c=[...kt(t.slice(0,s)),1],u=Ue(t);return{sliceRank:s,numUpdates:l,sliceSize:a,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q3e(n,e=1,t=!0){const r=me(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},a={k:e,sorted:t},[o,l]=Te.runKernel(u$,i,a);return{values:o,indices:l}}const K3e=Ae({topk_:q3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X3e(n,e=0,t=1,r,s){if(Mh(n),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new tZ(e,t,r,!0,s),a=En(n,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const dZ=Ae({truncatedNormal_:X3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y3e(n,e=0){const t=me(n,"x","unique","string_or_numeric");ue(t.rank>0,()=>"The input tensor must be at least 1D");const r={x:t},s={axis:e},[i,a]=Te.runKernel(d$,r,s);return{values:i,indices:a}}const Z3e=Ae({unique_:Y3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q3e(n,e,t){const r=me(n,"x","unsortedSegmentSum"),s=me(e,"segmentIds","unsortedSegmentSum","int32");ue(Sg(t),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},a={numSegments:t};return Te.runKernel(sC,i,a)}const fZ=Ae({unsortedSegmentSum_:Q3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J3e(n,e=0){const t=me(n,"x","unstack","string_or_numeric");ue(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const r={value:t},s={axis:e};return Te.runKernel(rC,r,s)}const bm=Ae({unstack_:J3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4e(n,e=!0,t,r){return Te.makeVariable(n,e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pZ(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const r=En(n,"int32"),s=En([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const a=r.indexToLoc(t[i]),o=i*n.length;s.values.set(a,o)}return s.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4e(n,e,t){const r=me(n,"x","transpose");if(e==null&&(e=r.shape.map((a,o)=>o).reverse()),ue(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(a=>{ue(a>=0&&a<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?De(()=>{let a=zE(r),o=S$(r);return a=Te.runKernel(ag,{x:a},i),o=Te.runKernel(ag,{x:o},i),t&&(o=_s(o)),Cg(a,o)}):Te.runKernel(ag,s,i)}const Qn=Ae({transpose_:t4e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4e(n,e){if(e==null)return n.shape.slice();if(gr(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let r=0;r<n.shape.length;r++)e[r]==null&&n.shape[r]!=null?t.push(n.shape[r]):t.push(e[r]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r4e(n,e,t,r){const s=me(n,"x","dropout");if(ue(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),ue(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Ks?s.clone():s;const i=n4e(s,t),a=1-e,o=Pt(pC(tt(vv(i,0,1,"float32",r),a)),a);return Ee(s,o)}const s4e=Ae({dropout_:r4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4e(n,e,t,r,s,i="NHWC",a){let o=n;n.rank===3&&(o=Ce(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2]])),ue(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),ue(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),ue(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const c=i==="NHWC"?o.shape[3]:o.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];ue(c===t[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${t[2]}.`),ue(u===t[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${t[3]}).`),ro("conv2dDerFilter",s,a);const d={x:o,dy:l},p={strides:r,pad:s,dataFormat:i,dimRoundingMode:a,filterShape:t};return Te.runKernel(PD,d,p)}const P$=Ae({conv2DBackpropFilter_:i4e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O$(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return Ee(n,wv(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function M$(n,e){let t=e;const r=ti(n.shape,e.shape);return r.length>0&&(t=$t(t,r)),Ce(t,n.shape)}function F$(n,e,t,r){if(e==="linear")return n;if(e==="relu")return $m(n);if(e==="elu")return dC(n);if(e==="relu6")return nZ(n);if(e==="prelu")return R$(n,t);if(e==="leakyrelu")return T$(n,r);if(e==="sigmoid")return sx(n);throw new Error(`Unknown fused activation ${e}.`)}const B$=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4e({x:n,filter:e,strides:t,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",B$(Te.state.gradientDepth,l)===!1){ue(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let q=gm(n,e,t,r,s,i,a);return o!=null&&(q=tt(q,o)),F$(q,l,c,u)}const d=me(n,"x","conv2d","float32"),p=me(e,"filter","conv2d","float32");let x=d,y=!1;d.rank===3&&(y=!0,x=Ce(d,[1,d.shape[0],d.shape[1],d.shape[2]])),ue(x.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${x.rank}.`),ue(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),ro("fused conv2d",r,a);const v=s==="NHWC"?x.shape[3]:x.shape[1];ue(p.shape[2]===v,()=>`Error in conv2d: depth of input (${v}) must match input depth for filter ${p.shape[2]}.`),ue(sa(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const b=Fi(x.shape,p.shape,t,i,r,a);let S;o!=null&&(S=me(o,"bias","fused conv2d"),[S]=Ss(S,d),s==="NHWC"?cn(b.outShape,S.shape):(ue(S.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${S.shape.length}.`),ue(S.shape.length===0||S.shape[0]===b.outChannels||S.shape[0]===1,()=>`Error in fused conv2d: bias shape (${S.shape}) is not compatible with the number of output channels (${b.outChannels})`)));let T;if(c!=null){const q=c.shape;if(ue(q.length<=1||q.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${q.length}.`),q.length===1)ue(q[0]===1||q[0]===b.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${q}) is not compatible with the number of output channels (${b.outChannels}).`);else if(q.length===3)try{cn(q,b.outShape)}catch{const F=`Error in fused conv2d: PReLU activation weights (${q}) is not compatible with the output shape of the conv2d (${b.outShape}).`;throw Error(F)}T=me(c,"prelu weights","fused conv2d")}const C=(q,U)=>{ue(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[F,G,V,O]=U,K=O$(q,V,l);ue(pm(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const P=b$(G.shape,K,F,t,r),N=P$(G,K,F.shape,t,r),M=[P,N];if(O!=null){const B=M$(O,K);M.push(B)}return M},I={x,filter:p,bias:S,preluActivationWeights:T},$={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:u};return o==null?Ng((U,F,G)=>{let V=Te.runKernel(LE,I,$);return G([F,U,V]),y&&(V=Ce(V,[V.shape[1],V.shape[2],V.shape[3]])),{value:V,gradFunc:C}})(x,p):Ng((U,F,G,V)=>{let O=Te.runKernel(LE,I,$);return V([F,U,O,G]),y&&(O=Ce(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:C}})(x,p,S)}const o4e=Ae({fusedConv2d_:a4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4e(n,e,t,r,s,i=[1,1],a){let o=n;n.rank===3&&(o=Ce(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:o,dy:l},u={strides:r,pad:s,dimRoundingMode:a,dilations:i,filterShape:t};return Te.runKernel(VD,c,u)}const c4e=Ae({depthwiseConv2dNativeBackpropFilter_:l4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u4e(n,e,t,r,s,i=[1,1],a){let o=e,l=!1;e.rank===3&&(l=!0,o=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:o,filter:t},u={strides:r,pad:s,dimRoundingMode:a,dilations:i,inputShape:n},d=Te.runKernel(UD,c,u);return l?Ce(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const h4e=Ae({depthwiseConv2dNativeBackpropInput_:u4e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4e({a:n,b:e,transposeA:t=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(B$(Te.state.gradientDepth,i)===!1){let O=fr(n,e,t,r);return s!=null&&(O=tt(O,s)),F$(O,i,a,o)}let l=me(n,"a","fused matMul"),c=me(e,"b","fused matMul");[l,c]=Ss(l,c);const u=t?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],p=t?l.shape[l.rank-1]:l.shape[l.rank-2],x=r?c.shape[c.rank-2]:c.shape[c.rank-1],y=l.shape.slice(0,-2),v=c.shape.slice(0,-2),b=Ue(y),S=Ue(v);ue(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${t} and transposeB=${r} must match.`);const C=cn(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,x]),I=t?Ce(l,[b,u,p]):Ce(l,[b,p,u]),$=r?Ce(c,[S,x,d]):Ce(c,[S,d,x]);let q;s!=null&&(q=me(s,"bias","fused matMul"),[q]=Ss(q,l),cn(C,q.shape));let U;a!=null&&(U=me(a,"prelu weights","fused matMul"));const F=(O,K)=>{const[P,N,M,B]=K,Y=O$(Ce(O,M.shape),M,i);let Z,ne;if(!t&&!r?(Z=fr(Y,N,!1,!0),ne=fr(P,Y,!0,!1)):!t&&r?(Z=fr(Y,N,!1,!1),ne=fr(Y,P,!0,!1)):t&&!r?(Z=fr(N,Y,!1,!0),ne=fr(P,Y,!1,!1)):(Z=fr(N,Y,!0,!0),ne=fr(Y,P,!0,!0)),s!=null){const Q=M$(B,Y);return[Z,ne,Q]}else return[Z,ne]},G={a:I,b:$,bias:q,preluActivationWeights:U},V={transposeA:t,transposeB:r,activation:i,leakyreluAlpha:o};return s==null?Ng((K,P,N)=>{const M=Te.runKernel($E,G,V);return N([K,P,M]),{value:Ce(M,C),gradFunc:F}})(I,$):Ng((K,P,N,M)=>{const B=Te.runKernel($E,G,V);return M([K,P,B,N]),{value:Ce(B,C),gradFunc:F}})(I,$,q)}const lB=Ae({fusedMatMul_:d4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f4e(n,e,t,r,s="bilinear",i=0){const a=me(n,"image","cropAndResize"),o=me(e,"boxes","cropAndResize","float32"),l=me(t,"boxInd","cropAndResize","int32"),c=o.shape[0];ue(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),ue(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),ue(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),ue(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),ue(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),ue(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const u={image:a,boxes:o,boxInd:l},d={method:s,extrapolationValue:i,cropSize:r};return Te.runKernel(BD,u,d)}const p4e=Ae({cropAndResize_:f4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m4e(n){const e=me(n,"image","flipLeftRight","float32");ue(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return Te.runKernel(KD,t,{})}const g4e=Ae({flipLeftRight_:m4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4e(n){const e=me(n,"image","grayscaleToRGB"),t=e.rank-1,r=e.shape[t];ue(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),ue(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,t),s[t]=3,cc(e,s)}const y4e=Ae({grayscaleToRGB_:x4e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4e(n){const e=me(n,"image","RGBToGrayscale"),t=e.rank-1,r=e.shape[t];ue(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),ue(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,i=mt(e,"float32"),a=bo([.2989,.587,.114]);let o;switch(e.rank){case 2:o=my("ij,j->i",i,a);break;case 3:o=my("ijk,k->ij",i,a);break;case 4:o=my("ijkl,l->ijk",i,a);break;case 5:o=my("ijklm,m->ijkl",i,a);break;case 6:o=my("ijklmn,n->ijklm",i,a);break;default:throw new Error("Not a valid tensor rank.")}return o=Za(o,-1),mt(o,s)}const v4e=Ae({rgbToGrayscale_:b4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4e(n,e,t=0,r=.5){const s=me(n,"image","rotateWithOffset","float32");ue(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},a={radians:e,fillValue:t,center:r};return Te.runKernel(f$,i,a)}const w4e=Ae({rotateWithOffset_:_4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ax(n,e,t,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const a=n.shape[0];return t=Math.min(t,a),ue(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),ue(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),ue(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),ue(e.rank===1,()=>"scores must be a 1D tensor"),ue(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),ue(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4e(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=me(n,"boxes","nonMaxSuppression","float32"),a=me(e,"scores","nonMaxSuppression","float32"),o=ax(i,a,t,r,s);t=o.maxOutputSize,r=o.iouThreshold,s=o.scoreThreshold;const l={maxOutputSize:t,iouThreshold:r,scoreThreshold:s};return Te.runKernel(e$,{boxes:i,scores:a},l)}const S4e=Ae({nonMaxSuppression_:E4e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T4e(n,e,t){const r=C4e(n,e,t),s=r<0?-(r+1):r;n.splice(s,0,e)}function C4e(n,e,t){return N4e(n,e,t||A4e)}function A4e(n,e){return n>e?1:n<e?-1:0}function N4e(n,e,t){let r=0,s=n.length,i=0,a=!1;for(;r<s;){i=r+(s-r>>>1);const o=t(e,n[i]);o>0?r=i+1:(s=i,a=!o)}return a?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z$(n,e,t,r,s){return U$(n,e,t,r,s,0)}function j$(n,e,t,r,s,i){return U$(n,e,t,r,s,0,!1,i,!0)}function V$(n,e,t,r,s,i){return U$(n,e,t,r,s,i,!0)}function U$(n,e,t,r,s,i,a=!1,o=!1,l=!1){const c=[];for(let b=0;b<e.length;b++)e[b]>s&&c.push({score:e[b],boxIndex:b,suppressBeginIndex:0});c.sort(cB);const u=i>0?-.5/i:0,d=[],p=[];for(;d.length<t&&c.length>0;){const b=c.pop(),{score:S,boxIndex:T,suppressBeginIndex:C}=b;if(S<s)break;let I=!1;for(let $=d.length-1;$>=C;--$){const q=k4e(n,T,d[$]);if(q>=r){I=!0;break}if(b.score=b.score*I4e(r,u,q),b.score<=s)break}b.suppressBeginIndex=d.length,I||(b.score===S?(d.push(T),p.push(b.score)):b.score>s&&T4e(c,b,cB))}const x=d.length,y=t-x;o&&y>0&&(d.push(...new Array(y).fill(0)),p.push(...new Array(y).fill(0)));const v={selectedIndices:d};return a&&(v.selectedScores=p),l&&(v.validOutputs=x),v}function k4e(n,e,t){const r=n.subarray(e*4,e*4+4),s=n.subarray(t*4,t*4+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(s[0],s[2]),u=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),p=Math.max(s[1],s[3]),x=(o-i)*(l-a),y=(d-c)*(p-u);if(x<=0||y<=0)return 0;const v=Math.max(i,c),b=Math.max(a,u),S=Math.min(o,d),T=Math.min(l,p),C=Math.max(S-v,0)*Math.max(T-b,0);return C/(x+y-C)}function I4e(n,e,t){const r=Math.exp(e*t*t);return t<=n?r:0}function cB(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function R4e(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=me(n,"boxes","nonMaxSuppressionAsync"),a=me(e,"scores","nonMaxSuppressionAsync"),o=ax(i,a,t,r,s);t=o.maxOutputSize,r=o.iouThreshold,s=o.scoreThreshold;const l=await Promise.all([i.data(),a.data()]),c=l[0],u=l[1],{selectedIndices:d}=z$(c,u,t,r,s);return i!==n&&i.dispose(),a!==e&&a.dispose(),bo(d,"int32")}const D4e=R4e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4e(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const a=me(n,"boxes","nonMaxSuppression"),o=me(e,"scores","nonMaxSuppression"),l=ax(a,o,t,r,s,i);t=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:a,scores:o},u={maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},d=Te.runKernel(n$,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const L4e=Ae({nonMaxSuppressionWithScore_:$4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function P4e(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const a=me(n,"boxes","nonMaxSuppressionAsync"),o=me(e,"scores","nonMaxSuppressionAsync"),l=ax(a,o,t,r,s,i);t=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([a.data(),o.data()]),u=c[0],d=c[1],{selectedIndices:p,selectedScores:x}=V$(u,d,t,r,s,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:bo(p,"int32"),selectedScores:bo(x)}}const O4e=P4e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M4e(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const a=me(n,"boxes","nonMaxSuppression"),o=me(e,"scores","nonMaxSuppression"),l=ax(a,o,t,r,s,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,p={boxes:a,scores:o},x={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},y=Te.runKernel(t$,p,x);return{selectedIndices:y[0],validOutputs:y[1]}}const F4e=Ae({nonMaxSuppressionPadded_:M4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function B4e(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const a=me(n,"boxes","nonMaxSuppressionAsync"),o=me(e,"scores","nonMaxSuppressionAsync"),l=ax(a,o,t,r,s,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[p,x]=await Promise.all([a.data(),o.data()]),{selectedIndices:y,validOutputs:v}=j$(p,x,c,u,d,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:bo(y,"int32"),validOutputs:mr(v,"int32")}}const z4e=B4e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j4e(n,e,t=!1,r=!1){const s=me(n,"images","resizeBilinear");ue(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),ue(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),ue(r===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,a=!1;s.rank===3&&(a=!0,i=Ce(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:r,size:e},c=Te.runKernel(XT,o,l);return a?Ce(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const mZ=Ae({resizeBilinear_:j4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4e(n,e,t=!1,r=!1){const s=me(n,"images","resizeNearestNeighbor");ue(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),ue(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),ue(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),ue(r===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,a=!1;s.rank===3&&(a=!0,i=Ce(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:r,size:e},c=Te.runKernel(KT,o,l);return a?Ce(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const gZ=Ae({resizeNearestNeighbor_:V4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U4e(n,e="binary",t=!1,r=.5){const s=me(n,"image","threshold"),i=.2989,a=.587,o=.114,l=s.shape[0]*s.shape[1];let c=Ee(bo([r]),255),u,d,p,x;if(ue(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),ue(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),ue(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),ue(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[u,d,p]=Jo(s,[1,1,1],-1);const b=Ee(u,i),S=Ee(d,a),T=Ee(p,o);x=tt(tt(b,S),T)}else x=n;if(e==="otsu"){const b=ske(mt(rZ(x),"int32"),IY([]),256);c=G4e(b,l)}const y=t?ix(x,c):rl(x,c);return mt(Ee(y,255),"int32")}function G4e(n,e){let t=bo([-1]),r=bo([0]),s=bo([0]),i,a,o,l,c,u;for(let d=0;d<n.size-1;d++){i=Pr(n,0,d+1),a=Pr(n,d+1),c=Pt($t(i),e),u=Pt($t(a),e);const p=$t(Ee(i,I1(0,i.size)));o=Pt(p,$t(i));const x=hC(a.shape,i.size),y=tt(I1(0,a.size),x),v=Ee(a,y);l=Pt($t(v),$t(a));const b=Vt(o,l),S=Vt(o,l),T=Ee(c,u);s=Ee(Ee(T,b),S);const C=rl(s,r);r=ka(C,s,r),t=ka(C,bo([d]),t)}return t}const H4e=Ae({threshold_:U4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4e(n,e,t="nearest",r="constant",s=0,i){const a=me(n,"image","transform","float32"),o=me(e,"transforms","transform","float32");ue(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),ue(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),ue(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:a,transforms:o},c={interpolation:t,fillMode:r,fillValue:s,outputShape:i};return Te.runKernel(h$,l,c)}const q4e=Ae({transform_:W4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K4e(n,e,t){const r=me(n,"a","bandPart");ue(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,a]=r.shape.slice(-2);let o,l;typeof e=="number"?(ue(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),ue(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),o=me(e<0?i:e,"numLower","bandPart")):(ue(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=ka(FE(e,0),i,k1(e,i))),typeof t=="number"?(ue(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),ue(t<=a,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${a}).`),l=me(t<0?a:t,"numUpper","bandPart")):(ue(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=ka(FE(t,0),a,k1(t,a)));const c=Ce(I1(0,i,1,"int32"),[-1,1]),u=I1(0,a,1,"int32"),d=Vt(c,u),p=kh(ix(d,o),Dm(d,_s(l))),x=fi([i,a],r.dtype);return Ce(Ih(bm(Ce(r,[-1,i,a])).map(y=>ka(p,y,x))),s)}const X4e=Ae({bandPart_:K4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4e(n){let e;if(Array.isArray(n)){e=!1,ue(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=n[0].shape[0];for(let i=1;i<n.length;++i)ue(n[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${s})`)}else e=!0,n=Jo(n,n.shape[0],0).map(s=>_v(s,[0]));ue(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],r=n;for(let s=0;s<n.length;++s)t.push(Te.tidy(()=>{let i=r[s];if(s>0)for(let a=0;a<s;++a){const o=Ee($t(Ee(t[a],i)),t[a]);i=Vt(i,o)}return Pt(i,fC(i,"euclidean"))}));return e?Ih(t,0):t}const Z4e=Ae({gramSchmidt_:Y4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q4e(n,e=!1){if(ue(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return uB(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,c)=>l*c),r=bm(Ce(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),s=[],i=[];r.forEach(l=>{const[c,u]=uB(l,e);s.push(c),i.push(u)});const a=Ce(Ih(s,0),n.shape),o=Ce(Ih(i,0),n.shape);return[a,o]}}function uB(n,e=!1){return Te.tidy(()=>{ue(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],r=n.shape[1];let s=XY(t),i=Vp(n);const a=Ck([[1]],[1,1]);let o=Vp(a);const l=t>=r?r:t;for(let c=0;c<l;++c){const u=i,d=o,p=s;[o,i,s]=Te.tidy(()=>{const x=Pr(i,[c,c],[t-c,1]),y=fC(x),v=Pr(i,[c,c],[1,1]),b=ka(rl(v,0),Ck([[-1]]),Ck([[1]])),S=Vt(v,Ee(b,y)),T=Pt(x,S);T.shape[0]===1?o=Vp(a):o=eo([a,Pr(T,[1,0],[T.shape[0]-1,T.shape[1]])],0);const C=_s(Pt(fr(b,S),y)),I=Pr(i,[c,0],[t-c,r]),$=Ee(C,o),q=Qn(o);if(c===0)i=Vt(I,fr($,fr(q,I)));else{const G=Vt(I,fr($,fr(q,I)));i=eo([Pr(i,[0,0],[c,r]),G],0)}const U=Qn($),F=Pr(s,[0,c],[t,s.shape[1]-c]);if(c===0)s=Vt(F,fr(fr(F,o),U));else{const G=Vt(F,fr(fr(F,o),U));s=eo([Pr(s,[0,0],[t,c]),G],1)}return[o,i,s]}),In([u,d,p])}return!e&&t>r&&(s=Pr(s,[0,0],[t,r]),i=Pr(i,[0,0],[r,r])),[s,i]})}const J4e=Ae({qr_:Q4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mh={flipLeftRight:g4e,grayscaleToRGB:y4e,resizeNearestNeighbor:gZ,resizeBilinear:mZ,rgbToGrayscale:v4e,rotateWithOffset:w4e,cropAndResize:p4e,nonMaxSuppression:S4e,nonMaxSuppressionAsync:D4e,nonMaxSuppressionWithScore:L4e,nonMaxSuppressionWithScoreAsync:O4e,nonMaxSuppressionPadded:F4e,nonMaxSuppressionPaddedAsync:z4e,threshold:H4e,transform:q4e},eRe={bandPart:X4e,gramSchmidt:Z4e,qr:J4e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tRe=new Map,nRe=new Map;class ox{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class Cl{constructor(){this.classNameMap={}}static getMap(){return Cl.instance==null&&(Cl.instance=new Cl),Cl.instance}static register(e){Cl.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function et(n,e,t){ue(n.className!=null,()=>"Class being registered does not have the static className property defined."),ue(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),ue(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const r=t,s=e+">"+r;return Cl.register(n),tRe.set(s,n),nRe.set(n,s),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zf extends ox{minimize(e,t=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const a=r.map(o=>({name:o.name,tensor:i[o.name]}));this.applyGradients(a)}else this.applyGradients(i);return In(i),t?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return TIe(e,t)}dispose(){this.iterations_!=null&&In(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:mr(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(zf,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xZ extends zf{static get className(){return"Adadelta"}constructor(e,t,r=null){super(),this.learningRate=e,this.rho=t,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=Te.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Te.registeredVariables[r],a=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:De(()=>Jn(i).variable(a))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:De(()=>Jn(i).variable(a))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const l=this.accumulatedGrads[s].variable,c=this.accumulatedUpdates[s].variable;De(()=>{const u=tt(Ee(l,this.rho),Ee(Ur(o),1-this.rho)),d=Ee(Pt(ta(tt(c,this.epsilon)),ta(tt(l,this.epsilon))),o),p=tt(Ee(c,this.rho),Ee(Ur(d),1-this.rho));l.assign(u),c.assign(p);const x=tt(Ee(d,-this.learningRate),i);i.assign(x)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(In(this.accumulatedGrads.map(e=>e.variable)),In(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yZ extends zf{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Te.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:De(()=>hC(i.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const o=this.accumulatedGrads[s].variable;De(()=>{const l=tt(o,Ur(a));o.assign(l);const c=tt(Ee(Pt(a,ta(tt(l,Te.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&In(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bZ extends zf{static get className(){return"Adam"}constructor(e,t,r,s=null){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],De(()=>{this.accBeta1=mr(t).variable(),this.accBeta2=mr(r).variable()}),s==null&&(this.epsilon=Te.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);De(()=>{const r=Vt(1,this.accBeta1),s=Vt(1,this.accBeta2);t.forEach((i,a)=>{const o=Te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:De(()=>Jn(o).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${i}/v`,variable:De(()=>Jn(o).variable(l))});const c=Array.isArray(e)?e[a].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[a].variable,d=this.accumulatedSecondMoment[a].variable,p=tt(Ee(u,this.beta1),Ee(c,1-this.beta1)),x=tt(Ee(d,this.beta2),Ee(Ur(c),1-this.beta2)),y=Pt(p,r),v=Pt(x,s);u.assign(p),d.assign(x);const b=tt(Ee(Pt(y,tt(ta(v),this.epsilon)),-this.learningRate),o);o.assign(b)}),this.accBeta1.assign(Ee(this.accBeta1,this.beta1)),this.accBeta2.assign(Ee(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&In(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&In(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),De(()=>{this.accBeta1.assign(xm(this.beta1,this.iterations_+1)),this.accBeta2.assign(xm(this.beta2,this.iterations_+1))});const t=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vZ extends zf{static get className(){return"Adamax"}constructor(e,t,r,s=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],De(()=>{this.iteration=mr(0).variable(),this.accBeta1=mr(t).variable()}),s==null&&(this.epsilon=Te.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);De(()=>{const r=Vt(1,this.accBeta1),s=Pt(-this.learningRate,tt(Ee(this.iteration,this.decay),1));t.forEach((i,a)=>{const o=Te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:Jn(o).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${i}/v`,variable:Jn(o).variable(l)});const c=Array.isArray(e)?e[a].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[a].variable,d=this.accumulatedWeightedInfNorm[a].variable,p=tt(Ee(u,this.beta1),Ee(c,1-this.beta1)),x=Ee(d,this.beta2),y=ba(c),v=Ff(x,y);u.assign(p),d.assign(v);const b=tt(Ee(Pt(s,r),Pt(p,tt(v,this.epsilon))),o);o.assign(b)}),this.iteration.assign(tt(this.iteration,1)),this.accBeta1.assign(Ee(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&In(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&In(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G$ extends zf{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const a=Te.registeredVariables[r];De(()=>{const o=tt(Ee(this.c,i),a);a.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=hu(mr(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Z extends G${static get className(){return"Momentum"}constructor(e,t,r=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=r,this.accumulations=[],this.m=mr(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Te.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:De(()=>Jn(i).variable(!1))});const a=this.accumulations[s].variable,o=Array.isArray(e)?e[s].tensor:e[r];o!=null&&De(()=>{let l;const c=tt(Ee(this.m,a),o);this.useNesterov?l=tt(Ee(this.c,tt(o,Ee(c,this.m))),i):l=tt(Ee(this.c,c),i),a.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&In(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wZ extends zf{static get className(){return"RMSProp"}constructor(e,t=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=Te.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Te.registeredVariables[r],a=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:De(()=>Jn(i).variable(a))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:De(()=>Jn(i).variable(a))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:De(()=>Jn(i).variable(a))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const l=this.accumulatedMeanSquares[s].variable,c=this.accumulatedMoments[s].variable;De(()=>{const u=tt(Ee(l,this.decay),Ee(Ur(o),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,p=tt(Ee(d,this.decay),Ee(o,1-this.decay)),x=Pt(Ee(o,this.learningRate),ta(Vt(u,tt(Ur(p),this.epsilon)))),y=tt(Ee(c,this.momentum),x);l.assign(u),d.assign(p),c.assign(y);const v=Vt(i,y);i.assign(v)}else{const d=tt(Ee(l,this.decay),Ee(Ur(o),1-this.decay)),p=tt(Ee(c,this.momentum),Pt(Ee(o,this.learningRate),ta(tt(d,this.epsilon))));l.assign(d),c.assign(p);const x=Vt(i,p);i.assign(x)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&In(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&In(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&In(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rRe=[xZ,yZ,bZ,vZ,_Z,wZ,G$];function sRe(){for(const n of rRe)et(n)}function H$(n,e){const t=n.shape.length,r=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${t}`);if(Ue(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const s=e.shape,i=s[s.length-1];let a=1;for(let d=0;d<s.length-1;++d)a*=s[d];const o=n.shape,l=s.slice();l.pop();let c=1;for(let d=i;d<t;++d)c*=o[d],l.push(o[d]);const u=[...kt(n.shape).map(d=>d/c),1].slice(0,i);return[l,a,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E3=-2,iRe=-1;function W$(n,e,t){const r=n.shape.length;ue(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),ue(r===t.length,()=>`Error in slice${r}D: Length of size ${t} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)ue(e[s]+t[s]<=n.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+t[s]}) would overflow input.shape[${s}] (${n.shape[s]})`)}function aRe(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function q$(n,e,t){const r=[];for(let s=0;s<n.length;s++)r[s]=Math.ceil((e[s]-n[s])/t[s]);return r}function EZ(n,e,t,r){const s=[...n];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<t;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function SZ(n,e,t){return t<=n?t:t-(e-1)}function TZ(n,e){const t=[];for(let r=0;r<n;r++)t.push(e+r);return t}function oRe(n,e,t,r,s,i,a,o,l){const c=n.length;let u=new Array(c),d=new Array(c),p=new Array(c);if(e.length&&t>0){const x=e[0],y=t+1;u=CZ(a,x,y,r,n),d=AZ(o,x,y,s,n),p=EZ(i,x,y,n)}else for(let x=0;x<c;x++)u[x]=kZ(a,r,i,n,x,l),d[x]=IZ(o,s,i,n,x,l),p[x]=NZ(i,x,l);return{begin:u,end:d,strides:p}}function CZ(n,e,t,r,s){const i=[...s],a=TZ(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=0;else{const l=SZ(e,t,o);let c=r[l];n&1<<l&&(c=0),i[o]=c}return i}function AZ(n,e,t,r,s){const i=[...s],a=TZ(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{const l=SZ(e,t,o);let c=r[l];n&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[o]=c}for(let o=0;o<i.length;o++){const l=s[o];i[o]<0&&(i[o]+=l),i[o]=um(0,i[o],s[o])}return i}function NZ(n,e,t){let r=n[e];return(t&1<<e||r==null)&&(r=1),r}function kZ(n,e,t,r,s,i){let a=e[s];const o=t[s]||1;(n&1<<s||i&1<<s||a==null)&&(o>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=r[s];return a<0&&(a+=l),a=um(0,a,l-1),a}function IZ(n,e,t,r,s,i){let a=e[s];const o=t[s]||1;(n&1<<s||i&1<<s||a==null)&&(o>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=r[s];return a<0&&(a+=l),o>0?a=um(0,a,l):a=um(-1,a,l-1),a}function K$(n,e,t){let r=t.length;for(let s=0;s<t.length;s++)if(t[s]>1){r=s;break}for(let s=r+1;s<t.length;s++)if(e[s]>0||t[s]!==n[s])return!1;return!0}function X$(n,e){let t=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function mC(n,e,t){let r;const s=n.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(a=>{ue(a!==-1,()=>"slice() does not support negative begin indexing.")});let i;return t==null?i=new Array(s).fill(-1):typeof t=="number"?i=[t,...new Array(s-1).fill(-1)]:t.length<s?i=t.concat(new Array(s-t.length).fill(-1)):i=t,i=i.map((a,o)=>a>=0?a:(ue(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${o}.`),n.shape[o]-r[o])),[r,i]}function Y$(n,e,t,r,s,i,a,o,l){let c;if(r==null?(c=new Array(e.length),c.fill(1)):c=r,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:c.slice(),beginMask:s,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};for(let C=0;C<d.dims;C++)u&&(1<<C&o)!==0&&d.numAddAxisAfterEllipsis++,1<<C&a&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};lRe(d,p);let x=!0,y=!0,v=!0;const b=[],S=[];for(let C=0;C<n.length;++C){if(p.strides[C]===0)throw Error(`strides[${C}] must be non-zero`);const I=!!(p.shrinkAxisMask&1<<C),$=n[C];if($===-1){b.push(I?1:-1);continue}const q=[p.beginMask&1<<C,p.endMask&1<<C],U=[p.strides[C]>0?0:-1,p.strides[C]>0?$:$-1];if(I&&p.strides[C]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&p.strides[C]===1;const F=!!(p.beginMask&1<<C&&p.endMask&1<<C);if(p.beginValid&&p.endValid){if(I){const K=p.begin[C]<0?$+p.begin[C]:p.begin[C];if(p.begin[C]=K,p.end[C]=p.begin[C]+1,K<0||K>=$)throw Error(`slice index ${p.begin[C]} of dimension ${C} out of bounds.`)}else p.begin[C]=hB(p.begin[C],0,p.strides[C],$,q,U),p.end[C]=hB(p.end[C],1,p.strides[C],$,q,U);const O=p.strides[C]===1&&p.begin[C]===0&&p.end[C]===$;x=x&&O,y=y&&(C===0&&p.strides[C]===1||O)}else x=x&&p.strides[C]===1&&F,y=y&&(C===0&&p.strides[C]===1||F);let G,V=!1;if(p.beginValid&&p.endValid?(G=p.end[C]-p.begin[C],V=!0):I?(G=1,V=!0):F&&$>=0&&(p.strides[C]<0?G=-$:G=$,V=!0),V){let O;G===0||G<0!=p.strides[C]<0?O=0:O=Math.trunc(G/p.strides[C])+(G%p.strides[C]!==0?1:0),b.push(O)}else b.push(-1)}for(let C=0;C<p.finalShapeGatherIndices.length;++C){const I=p.finalShapeGatherIndices[C];I>=0?S.push(b[I]):I===E3&&S.push(1)}return{finalShapeSparse:S.filter((C,I)=>p.finalShapeGatherIndices[I]!==E3),finalShape:S,isIdentity:x,sliceDim0:y,isSimpleSlice:v,begin:p.begin,end:p.end,strides:p.strides}}function lRe(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const s=Math.min(e.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<s;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=r}else if(1<<r&n.newAxisMask)e.finalShapeGatherIndices.push(E3),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[r]),n.end!=null&&(e.end[t]=n.end[r]),e.strides[t]=n.strides[r],n.beginMask&1<<r&&(e.beginMask|=1<<t),n.endMask&1<<r&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(iRe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[t]=r,t++}}function hB(n,e,t,r,s,i){if(s[e])return t>0?i[e]:i[e+1&1];{const a=n<0?r+n:n;return a<i[0]?i[0]:a>i[1]?i[1]:a}}const cRe=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:W$,computeFlatOffset:X$,computeOutShape:q$,getNormalizedAxes:oRe,isSliceContinous:K$,maskToAxes:aRe,parseSliceParams:mC,sliceInfo:Y$,startForAxis:kZ,startIndicesWithElidedDims:CZ,stopForAxis:IZ,stopIndicesWithElidedDims:AZ,stridesForAxis:NZ,stridesWithElidedDims:EZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uRe{static sgd(e){return new G$(e)}static momentum(e,t,r=!1){return new _Z(e,t,r)}static rmsprop(e,t=.9,r=0,s=null,i=!1){return new wZ(e,t,r,s,i)}static adam(e=.001,t=.9,r=.999,s=null){return new bZ(e,t,r,s)}static adadelta(e=.001,t=.95,r=null){return new xZ(e,t,r)}static adamax(e=.002,t=.9,r=.999,s=null,i=0){return new vZ(e,t,r,s,i)}static adagrad(e,t=.1){return new yZ(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A0=uRe;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hRe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function RZ(){return new Promise(n=>hRe(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$(n,e){const t=n[0].length;n.forEach((s,i)=>{ue(s.length===t,()=>`Error in concat${t}D: rank of tensors[${i}] must be the same as the rank of the rest (${t})`)}),ue(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const r=n[0];n.forEach((s,i)=>{for(let a=0;a<t;a++)ue(a===e||s[a]===r[a],()=>`Error in concat${t}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function du(n,e){const t=n[0].slice();for(let r=1;r<n.length;r++)t[e]+=n[r][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ac;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(ac||(ac={}));function DZ(n,e,t){let r=new Array;if(t==null&&e==null)return r;if(e==null)for(;r.length<n+t.length;)r.push(-1);else r=e.slice();if(t==null)return r;if(n+t.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${r.length}`);for(let s=1;s<t.length;++s){const i=t[s],a=r[r.length-t.length+s],o=r[a];if(i>=0)if(o>=0){if(o!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+n}] = ${i} but shape[${s+n}] = ${o}`)}else r[a]=i}return r}function $Z(n){const e={FIRST_DIM_SIZE:ac.FIRST_DIM_SIZE,VALUE_ROWIDS:ac.VALUE_ROWIDS,ROW_LENGTHS:ac.ROW_LENGTHS,ROW_SPLITS:ac.ROW_SPLITS,ROW_LIMITS:ac.ROW_LIMITS,ROW_STARTS:ac.ROW_STARTS},t=[];for(const r of n)if(r in e)t.push(e[r]);else break;return t}function LZ(n){return n.length===0?0:n[0]===ac.FIRST_DIM_SIZE?n.length-1:n.length}function PZ(n,e){if(n==null||e==null)return;const t=n.length,r=e.length;if(t>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(t,r-1);++s){const i=n[s],a=e[s+1];if(i>=0&&a>=0&&i!==1&&i!==a)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-n.length}] = ${i} but ragged tensor input.flatValues.shape[${s-n.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q$=30;function gC(n){return n<=Q$?n:o3(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$(n,e,t){const r=t*(typeof n=="number"?n:n[0]),s=e*(typeof n=="number"?n:n[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ev(n,e,t,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(n[0]/t),s=s.concat(n.slice(1));else{s=s.concat(n[0]);const i=e.length;for(let a=0;a<i;++a)s=s.concat([n[a+1]/e[a],e[a]]);s=s.concat(n.slice(i+1))}return s}function Sv(n,e,t=!0){const r=[];if(t){r.push(e);for(let s=e+1;s<n;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let a=1;a<n;++a)a>=e*2+1||a%2===1?i.push(a):s.push(a);r.push(...s),r.push(0),r.push(...i)}return r}function Tv(n,e,t,r=!0){const s=[];r?s.push(n[0]/t):s.push(n[0]*t);for(let i=1;i<n.length;++i)i<=e.length?r?s.push(e[i-1]*n[i]):s.push(n[i]/e[i-1]):s.push(n[i]);return s}function e6(n,e){const t=[0];for(let r=0;r<e;++r)t.push(n[r][0]);return t}function t6(n,e,t){const r=n.slice(0,1);for(let s=0;s<t;++s)r.push(n[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xC=1.7580993408473768,yC=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n6=.3275911,r6=.254829592,s6=-.284496736,i6=1.421413741,a6=-1.453152027,o6=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rh(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function OZ(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)e[r/2]=n[r],t[r/2]=n[r+1];return{real:e,imag:t}}function MZ(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function FZ(n){const e=Math.floor(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function l6(n,e){const t=n[e*2],r=n[e*2+1];return{real:t,imag:r}}function BZ(n,e,t,r){n[r*2]=e,n[r*2+1]=t}function zZ(n,e){const t=new Float32Array(n/2),r=new Float32Array(n/2);for(let s=0;s<Math.ceil(n/2);s++){const i=(e?2:-2)*Math.PI*(s/n);t[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:t,imag:r}}function jZ(n,e,t){const r=(t?2:-2)*Math.PI*(n/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ak="->",dRe=/->/g,dB=",",fB="...";function c6(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(dRe,"").length)/Ak.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${Ak}").`);const[r,s]=n.split(Ak);ue(r.indexOf(fB)===-1,()=>`The ellipsis notation ("${fB}") is not supported yet.`);const i=r.split(dB),a=i.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let p=0;p<s.length;++p){const x=s[p];if(!i.some(y=>y.indexOf(x)!==-1))throw new Error(`Output subscripts contain the label ${x} not present in the input subscripts.`);o.indexOf(x)===-1&&o.push(x)}for(let p=0;p<r.length;++p){const x=r[p];o.indexOf(x)===-1&&x!==dB&&o.push(x)}const l=new Array(i.length);for(let p=0;p<a;++p){if(new Set(i[p].split("")).size!==i[p].length)throw new Error(`Found duplicate axes in input component ${i[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let x=0;x<i[p].length;++x)l[p].push(o.indexOf(i[p][x]))}const c=o.length,u=s.length,d=[];for(let p=u;p<c;++p)d.push(p);return{allDims:o,summedDims:d,idDims:l}}function u6(n,e){let t=new Array(n);t.fill(-1);for(let s=0;s<e.length;++s)t[e[s]]=s;const r=[];for(let s=0;s<n;++s)t[s]===-1&&r.push(s);return t=t.filter(s=>s!==-1),{permutationIndices:t,expandDims:r}}function h6(n,e,t){const r=new Array(n);for(let s=0;s<t.length;++s){const i=t[s].shape;for(let a=0;a<e[s].length;++a)r[e[s][a]]===void 0?r[e[s][a]]=i[a]:ue(r[e[s][a]]===i[a],()=>`Expected dimension ${r[e[s][a]]} at axis ${a} of input shaped ${JSON.stringify(i)}, but got dimension ${i[a]}`)}}function d6(n,e){const t=n,r=[];let s=0;n.length===0&&t.push(-1),s=n.length+1;for(let a=0;a<s;++a)r.push([]);const i=[];for(let a=0;a<t.length;++a){const o=t[a],l=fRe(e,o);for(const c of l)i.indexOf(c)===-1&&(r[a].push(c),i.push(c))}return{path:t,steps:r}}function f6(n){return n.every((e,t)=>e===t)}function fRe(n,e){const t=[];for(let r=0;r<n.length;++r)(n[r].length===0||n[r].indexOf(e)!==-1||e===-1)&&t.push(r);return t}function p6(n,e,t=0){let r=[];if(typeof e=="number")ue(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(n.shape[t]/e);else{const s=e.reduce((a,o)=>(o===-1&&(a+=1),a),0);ue(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const a=e.reduce((o,l)=>l>0?o+l:o);e[i]=n.shape[t]-a}ue(n.shape[t]===e.reduce((a,o)=>a+o),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VZ(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function UZ(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function GZ(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HZ(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function WZ(n,e){return`size ${n} must be non-negative, not ${e}`}function qZ(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function KZ(n,e){const t=Ue(n),r=Ue(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${n} outputShape= ${e}`}function XZ(n,e){const t=Ue(n),r=Ue(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${r}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3(){return"segment ids must be >= 0"}function YZ(){return"segment ids are not increasing"}function ZZ(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function QZ(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JZ(n,e){let t=!1,r;for(n<=Q$?(r=n,t=!0):r=o3(n,Math.floor(Math.sqrt(n)));!t;)r>e||r===n?t=!0:r=o3(n,r+1);return r}function eQ(n,e,t){const r=[],s=n.length;for(let i=0;i<s;i++)i!==e?r.push(n[i]):r.push(t);return r}function m6(n,e,t,r){const s=e.shape.length,i=n.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(t<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${t}).`);for(let d=0;d<r;++d)if(n.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${n.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const a=n.shape[t],o=[];let l=1,c=1,u=1;for(let d=0;d<r;++d)o.push(n.shape[d]),l*=n.shape[d];for(let d=r;d<t;d++)o.push(n.shape[d]),c*=n.shape[d];for(let d=r;d<s;d++)o.push(e.shape[d]);for(let d=t+1;d<i;d++)o.push(n.shape[d]),u*=n.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:a,outputShape:o}}const pRe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:m6,computeOutShape:eQ,segOpComputeOptimalWindowSize:JZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dh(n){try{return n.map(e=>yf(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function tQ(n){return n.map(e=>Jd(e))}const mRe=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:r6,ERF_A2:s6,ERF_A3:i6,ERF_A4:a6,ERF_A5:o6,ERF_P:n6,PARALLELIZE_THRESHOLD:Q$,get RowPartitionType(){return ac},SELU_SCALE:yC,SELU_SCALEALPHA:xC,applyActivation:F$,assertAndGetBroadcastShape:cn,assertAxesAreInnerMostDims:Bi,assertParamsConsistent:Z$,assignToTypedArray:BZ,axesAreInnerMostDims:w$,calculateShapes:Lm,checkEinsumDimSizes:h6,checkPadOnDimRoundingMode:ro,combineLocations:qY,combineRaggedTensorToTensorShapes:DZ,complexWithEvenIndex:MZ,complexWithOddIndex:FZ,computeConv2DInfo:Fi,computeConv3DInfo:Of,computeDefaultPad:g$,computeDilation2DInfo:yv,computeOptimalWindowSize:gC,computeOutAndReduceShapes:xi,computeOutShape:du,computePool2DInfo:Ml,computePool3DInfo:Fh,convertConv2DDataFormat:Bh,decodeEinsumEquation:c6,eitherStridesOrDilationsAreOne:sa,expandShapeToKeepDim:Us,exponent:jZ,exponents:zZ,fromStringArrayToUint8:tQ,fromUint8ToStringArray:Dh,getAxesPermutation:os,getBroadcastDims:Ag,getComplexWithIndex:l6,getEinsumComputePath:d6,getEinsumPermutation:u6,getFusedBiasGradient:M$,getFusedDyActivation:O$,getImageCenter:J$,getInnerMostAxes:Cs,getPermuted:Sv,getRaggedRank:LZ,getReductionAxes:ti,getReshaped:Ev,getReshapedPermuted:Tv,getRowPartitionTypesHelper:$Z,getSliceBeginCoords:e6,getSliceSize:t6,getSparseFillEmptyRowsIndicesDenseShapeMismatch:VZ,getSparseFillEmptyRowsNegativeIndexErrorMessage:UZ,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:GZ,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:qZ,getSparseReshapeInputOutputMismatchErrorMessage:XZ,getSparseReshapeInputOutputMultipleErrorMessage:KZ,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:HZ,getSparseReshapeNegativeOutputDimErrorMessage:WZ,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:QZ,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:S3,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:YZ,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:ZZ,getUndoAxesPermutation:Mf,isIdentityPermutation:f6,log:gAe,mergeRealAndImagArrays:Rh,prepareAndValidate:H$,prepareSplitSize:p6,segment_util:pRe,shouldFuse:B$,slice_util:cRe,splitRealAndImagArrays:OZ,stridesOrDilationsArePositive:mm,tupleValuesAreOne:pm,upcastType:wo,validateDefaultValueShape:PZ,validateInput:W3e,validateUpdateShape:hZ,warn:Xo},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */sRe();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nQ={kernelName:aT,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(n,wv(mt(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gRe={kernelName:Eb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=Ur(mt(t,"float32")),s=ta(Vt(mr(1),r));return _s(Pt(n,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xRe={kernelName:Sb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=ta(Vt(Ur(mt(t,"float32")),1));return Pt(n,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yRe={kernelName:nx,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=cn(t.shape,r.shape);return{a:()=>{let o=n;const l=ti(t.shape,s);return l.length>0&&(o=$t(o,l)),Ce(o,t.shape)},b:()=>{let o=n;const l=ti(r.shape,s);return l.length>0&&(o=$t(o,l)),Ce(o,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bRe={kernelName:AD,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((r,s)=>{t[s]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vRe={kernelName:oT,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Jn(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Re={kernelName:lT,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Jn(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wRe={kernelName:Tb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Pt(n,ta(Vt(mr(1),Ur(mt(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ERe={kernelName:Cb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=ta(tt(mr(1),Ur(mt(t,"float32"))));return Pt(n,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SRe={kernelName:kb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=cn(t.shape,r.shape);return{a:()=>{const o=tt(Ur(t),Ur(r));let l=Ee(n,Pt(r,o));const c=ti(t.shape,s);return c.length>0&&(l=$t(l,c)),Ce(l,t.shape)},b:()=>{const o=tt(Ur(t),Ur(r));let l=_s(Ee(n,Pt(t,o)));const c=ti(r.shape,s);return c.length>0&&(l=$t(l,c)),Ce(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TRe={kernelName:Ab,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Pt(n,tt(Ur(mt(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CRe={kernelName:Nb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Pt(n,Vt(mr(1),Ur(mt(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ARe(n,e,t,r,s,i){const a=me(n,"dy","avgPool3dGrad"),o=me(e,"input","avgPool3dGrad");let l=a,c=o,u=!1;o.rank===4&&(u=!0,l=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),c=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ue(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),ue(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),ro("avgPool3dGrad",s,i);const d={dy:l,input:c},p={filterSize:t,strides:r,pad:s,dimRoundingMode:i},x=Te.runKernel(RD,d,p);return u?Ce(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const NRe=Ae({avgPool3dGrad_:ARe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kRe={kernelName:uT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{filterSize:s,strides:i,pad:a,dimRoundingMode:o}=t;return{x:()=>NRe(n,r,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IRe(n,e,t,r,s){const i=me(n,"dy","avgPoolGrad"),a=me(e,"input","avgPoolGrad");ue(a.rank===i.rank,()=>`Rank of input (${a.rank}) does not match rank of dy (${i.rank})`);let o=a,l=i,c=!1;a.rank===3&&(c=!0,o=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2]]),l=Ce(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ue(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),ue(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const u={dy:l,input:o},d={filterSize:t,strides:r,pad:s},p=Te.runKernel(ID,u,d);return c?Ce(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const RRe=Ae({avgPoolGrad_:IRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DRe={kernelName:cT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{filterSize:s,strides:i,pad:a}=t;return{x:()=>RRe(n,r,s,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Re={kernelName:hT,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[r,s]=e,{transposeA:i,transposeB:a}=t;return!i&&!a?{a:()=>fr(n,s,!1,!0),b:()=>fr(r,n,!0,!1)}:!i&&a?{a:()=>fr(n,s,!1,!1),b:()=>fr(n,r,!0,!1)}:i&&!a?{a:()=>fr(s,n,!1,!0),b:()=>fr(r,n,!1,!1)}:{a:()=>fr(s,n,!0,!0),b:()=>fr(n,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LRe={kernelName:dT,gradFunc:(n,e,t)=>{const{blockShape:r,crops:s}=t;return{x:()=>I$(n,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PRe={kernelName:dAe,gradFunc:(n,e,t)=>{const r=t,s=r.inputShape,i=r.shape,a=Array.from(i);for(let l=s.length-1;l>=0;l--)if(s[l]===i[l])a[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${i}].`);const o=[];for(let l=0;l<a.length;l++)a[l]>1&&o.push(l);return{x:()=>$t(n,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ORe={kernelName:Ib,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MRe={kernelName:Rb,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FRe={kernelName:Db,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=t;return{x:()=>ka(kh(Dm(r,s),ix(r,i)),n,Jn(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BRe={kernelName:fT,inputsToSave:["x"],gradFunc:nQ.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zRe={kernelName:pT,saveAllInputs:!0,gradFunc:(n,e,t)=>{const r=e.map(l=>l.shape),{axis:s}=t,i=Sn(s,e[0].shape)[0],a=r.map(l=>l[i]);return Jo(n,a,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jRe={kernelName:mT,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,{dilations:i,strides:a,pad:o,dataFormat:l}=t;return ue(pm(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>b$(r.shape,n,s,a,o,l),filter:()=>P$(r,n,s.shape,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VRe={kernelName:gT,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,{strides:i,pad:a,dataFormat:o,dimRoundingMode:l}=t;return{dy:()=>gm(n,s,i,a,o,1,l),filter:()=>P$(n,r,s.shape,i,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function URe(n,e,t,r,s){let i=n;n.rank===4&&(i=Ce(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let a=e;a.rank===4&&(a=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),ue(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),ue(a.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${a.shape}.`),ue(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),ue(i.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${t[3]}.`),ue(a.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${t[4]}).`);const o={x:i,dy:a},l={strides:r,pad:s,filterShape:t};return Te.runKernel(OD,o,l)}const GRe=Ae({conv3DBackpropFilter_:URe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HRe={kernelName:xT,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:r,strides:s,pad:i}=t;ue(pm(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[a,o]=e;return{x:()=>UY(a.shape,n,o,s,i),filter:()=>GRe(a,n,o.shape,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WRe={kernelName:$b,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(_s(oZ(mt(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qRe={kernelName:Lb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(lZ(mt(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KRe={kernelName:yT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s,exclusive:i,reverse:a}=t;return{x:()=>{const o=os([s],r.rank);let l=HY(n,s,i,!a);return o!=null&&(l=Qn(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XRe={kernelName:bT,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:a}=t,o=r??[1,1];ue(pm(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,c]=e;return ue(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),ue(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),ue(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),ue(sa(s,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${o}'.`),ro("depthwiseConv2d",i,a),{x:()=>h4e(l.shape,n,c,s,i,o,a),filter:()=>c4e(l,n,c.shape,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YRe={kernelName:vT,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,i={x:r,filter:s,dy:n},a={x:r,filter:s,dy:n};return{x:()=>Te.runKernel(l3,i,t),filter:()=>Te.runKernel(c3,a,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZRe={kernelName:Ob,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,r={dy:n,y:t};return{x:()=>Te.runKernel(HD,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QRe={kernelName:Mb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,r=Ee(Tu(_s(Ur(t))),2/Math.sqrt(Math.PI));return{x:()=>Ee(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JRe={kernelName:Fb,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eDe={kernelName:wT,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>Ce(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tDe={kernelName:Bb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(n,Tu(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nDe={kernelName:zb,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rDe={kernelName:jb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=cn(t.shape,r.shape);return{a:()=>{const o=Pt(n,mt(r,"float32")),l=ti(t.shape,s);return l.length>0?Ce($t(o,l),t.shape):o},b:()=>{let o=Ee(n,mt(t,"float32"));const l=ti(r.shape,s);l.length>0&&(o=Ce($t(o,l),r.shape));const c=Ur(r);return _s(Pt(o,mt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sDe={kernelName:ET,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:r}=t,[s,i,a,o]=e,l=o??mr(1),c=ti(i.shape,s.shape),u=[];if(i.rank===1){for(let I=0;I<s.shape.length-1;++I)u.push(s.shape[I]);u.push(1)}const d=Vt(s,i),p=Ee(n,l),x=sZ(tt(a,mr(r))),y=Ee(Ee(Ee(x,x),x),mr(-.5));return{x:()=>i.rank===1?Ce(Ee(Ee(n,cc(Ce(x,[1,1,1,i.shape[0]]),u)),l),s.shape):Ce(Ee(Ee(n,x),l),s.shape),mean:()=>{let I=Ee(Ee(x,mr(-1)),p);return i.rank===1&&(I=$t(I,c)),Ce(I,i.shape)},variance:()=>{let I=Ee(Ee(y,d),p);return i.rank===1&&(I=$t(I,c)),Ce(I,i.shape)},scale:()=>{const I=Ee(d,x);let $=Ee(n,I);return i.rank===1&&($=$t($,c)),Ce($,i.shape)},offset:()=>{let I=n;return i.rank===1&&(I=$t(I,c)),Ce(I,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iDe={kernelName:ST,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[r,s]=e,{axis:i,batchDims:a}=t,o=Sn(i,r.shape)[0],l=(c,u,d)=>()=>{const p=c.shape,x=u.size,y=p.slice(0,o),v=y.length,b=p.slice(i,p.length).slice(1),S=b.length,T=pB(0,v),C=pB(v+1,v+1+S),I=mB([y,[x],b]),$=Ce(d,I),q=Ce(u,[x]),U=mB([[v],T,C]),F=Qn($,U);let G=fZ(F,q,c.shape[o]);const V=Mf(U);return G=Qn(G,V),G};if(a===1){const c=r.shape[0],u=r.split(c,0);return{x:()=>Ih(u.map((x,y)=>l(x,s.slice(y,1),n.slice(y,1))())).reshape(r.shape),indices:()=>s}}else return{x:l(r,s,n),indices:()=>s}}};function pB(n,e){const t=[];for(let r=n;r<e;++r)t.push(r);return t}function mB(n){const e=[];for(let t=0;t<n.length;++t)for(let r=0;r<n[t].length;++r)e.push(n[t][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aDe={kernelName:Vb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>Jn(t),b:()=>Jn(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oDe={kernelName:Ub,gradFunc:n=>({x:()=>mt(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lDe={kernelName:Gb,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cDe={kernelName:Hb,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uDe={kernelName:Wb,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hDe={kernelName:CT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{alpha:s}=t,i=rl(r,0);return{x:()=>ka(i,n,Ee(n,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dDe={kernelName:Kb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Pt(n,tt(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fDe={kernelName:qb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Pt(n,mt(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pDe={kernelName:pAe,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t;return{logits:()=>{const a=Tu(r);return Vt(n,Ee($t(n,s,!0),a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mDe(n,e,t,r=5,s=1,i=1,a=.5){const o={x:n,y:e,dy:t},l={depthRadius:r,bias:s,alpha:i,beta:a};return Te.runKernel(ZD,o,l)}const gDe=Ae({localResponseNormalizationBackprop_:mDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xDe={kernelName:DT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{depthRadius:i,bias:a,alpha:o,beta:l}=t;return{x:()=>gDe(r,s,n,i,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rQ(n,e,t,r){return e.rank<t.rank&&(e=Ce(e,Us(e.shape,r))),n.rank<t.rank&&(n=Ce(n,Us(n.shape,r))),{x:()=>Ee(n,mt(Su(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gB={kernelName:$T,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const r=t,{reductionIndices:s}=r,i=e[0],a=e[1],o=Sn(s,i.shape),l=rQ(n,a,i,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yDe={kernelName:Xb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>Ee(n,mt(Dm(t,r),"float32")),b:()=>Ee(n,mt(FE(t,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bDe(n,e,t,r,s,i,a){const o=me(n,"dy","maxPool3dGrad"),l=me(e,"input","maxPool3dGrad"),c=me(t,"output","maxPool3dGrad");let u=o,d=l,p=c,x=!1;l.rank===4&&(x=!0,u=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=Ce(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=Ce(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),ue(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),ue(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),ue(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),ro("maxPool3dGrad",i,a);const y={dy:u,input:d,output:p},v={filterSize:r,strides:s,pad:i,dimRoundingMode:a},b=Te.runKernel(JD,y,v);return x?Ce(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}const vDe=Ae({maxPool3dGrad_:bDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _De={kernelName:PT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=t;return{x:()=>vDe(n,r,s,i,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wDe(n,e,t,r,s,i,a){const o=me(n,"dy","maxPoolGrad"),l=me(e,"input","maxPoolGrad"),c=me(t,"output","maxPoolGrad");ue(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),ue(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),ue(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),ro("maxPoolGrad",i,a);const u={dy:o,input:l,output:c},d={filterSize:r,strides:s,pad:i,dimRoundingMode:a};return Te.runKernel(QD,u,d)}const EDe=Ae({maxPoolGrad_:wDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SDe={kernelName:LT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{filterSize:i,strides:a,pad:o}=t;return{x:()=>EDe(n,r,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TDe={kernelName:OT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t,i=Sn(s,r.shape),o=xi(r.shape,i)[1],l=Ue(o);return{x:()=>{const u=r.shape.slice();i.forEach(x=>{u[x]=1});const d=Ce(n,u);return Pt(Ee(d,Bf(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CDe={kernelName:MT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const r=t,{axis:s}=r,[i,a]=e,o=Sn(s,i.shape),l=rQ(n,a,i,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ADe={kernelName:Yb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>Ee(n,mt(ix(t,r),"float32")),b:()=>Ee(n,mt(rl(t,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NDe={kernelName:FT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const r=e[0],{paddings:s}=t,i=s.map(a=>a[0]);return{x:()=>Pr(n,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kDe={kernelName:Zb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=cn(t.shape,r.shape);return{a:()=>{const o=ti(t.shape,s);return o.length>0?Ce($t(n,o),t.shape):n},b:()=>{const o=Ee(n,_s(pC(Pt(t,r)))),l=ti(r.shape,s);return l.length>0?Ce($t(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IDe={kernelName:Qb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=cn(t.shape,r.shape);return{a:()=>{const o=Ee(n,mt(r,"float32")),l=ti(t.shape,s);return l.length>0?Ce($t(o,l),t.shape):o},b:()=>{const o=Ee(n,mt(t,"float32")),l=ti(r.shape,s);return l.length>0?Ce($t(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RDe={kernelName:BT,gradFunc:n=>({x:()=>_s(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DDe={kernelName:VT,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>fi(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $De={kernelName:jT,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LDe={kernelName:UT,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:r}=t;return bm(n,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xB={kernelName:GT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const r=e[0],{paddings:s}=t,i=s.map(a=>a[0]);return{x:()=>Pr(n,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PDe={kernelName:Jb,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,r,s]=e,i=t,a=r,o=cn(i.shape,a.shape);return{a:()=>{const u=mt(a,"float32");let d=Ee(n,Ee(u,xm(i,Vt(u,mr(1)))));const p=ti(i.shape,o);return p.length>0&&(d=$t(d,p)),Ce(d,i.shape)},b:()=>{const u=rl(i,0),d=ka(u,Cu(i),Jn(i));let p=Ee(n,Ee(s,d));const x=ti(a.shape,o);return x.length>0&&(p=$t(p,x)),Ce(p,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ODe={kernelName:HT,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,r]=e,s=rl(t,0);return{x:()=>ka(s,n,Ee(n,r)),alpha:()=>{let i=ka(s,Jn(n),Ee(n,t));const a=ti(r.shape,n.shape);return a.length>0&&(i=$t(i,a)),Ce(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MDe(n,e,t){const r=n.shape.slice();r[t]=1;const s=Ce(e,r),i=_3(n,t,!0,!1),a=_3(n,t,!0,!0),o=Ee(i,a);return Ee(s,o)}function FDe(n,e,t){const r=n.shape.length,s=r-t.length,i=os(t,r);let a=n;i!=null&&(a=Qn(n,i));const o=a.shape.slice(),c=o.splice(r-t.length,t.length).reduce((p,x)=>p*x,1);o.push(c);const u=a.reshape(o);let d=MDe(u,e,s);if(d=d.reshape(a.shape),i!=null){const p=Mf(i);d=Qn(d,p)}return d}const BDe={kernelName:WT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t;let i=[];return s==null?i=r.shape.map((a,o)=>o):typeof s=="number"?i=[s]:i=s,{x:()=>FDe(r,n,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zDe={kernelName:Pb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=cn(t.shape,r.shape);return{a:()=>{const o=Pt(n,mt(r,"float32")),l=ti(t.shape,s);return l.length>0?Ce($t(o,l),t.shape):o},b:()=>{let o=Ee(n,mt(t,"float32"));const l=ti(r.shape,s);l.length>0&&(o=Ce($t(o,l),r.shape));const c=Ur(r);return _s(Pt(o,mt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jDe={kernelName:ev,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Pt(n,_s(Ur(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VDe={kernelName:nv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,r=Ee(ix(t,6),wv(t));return{x:()=>Ee(n,mt(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UDe={kernelName:tv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(n,mt(wv(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GDe={kernelName:qT,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ce(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HDe={kernelName:XT,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[r]=e,s={dy:n,images:r};return{images:()=>Te.runKernel(a$,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WDe={kernelName:KT,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[r]=e,s={dy:n,images:r};return{images:()=>Te.runKernel(i$,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qDe={kernelName:YT,gradFunc:(n,e,t)=>{const{dims:r}=t,s=Sn(r,n.shape);return{x:()=>ym(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KDe={kernelName:rv,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XDe={kernelName:sv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_s(Pt(n,Ee(xm(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YDe={kernelName:ZT,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>mt(Jn(t),"float32"),t:()=>Ee(n,mt(t,n.dtype)),e:()=>Ee(n,mt(C$(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZDe={kernelName:iv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=rl(t,mr(0)),s=mr(xC),i=mr(yC),a=Ee(n,i),o=Ee(Ee(n,s),Tu(mt(t,"float32")));return ka(r,a,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QDe={kernelName:cv,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(n,Ee(t,Vt(mr(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JDe={kernelName:lv,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e$e={kernelName:av,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(v$(mt(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t$e={kernelName:ov,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(GY(mt(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n$e={kernelName:QT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{begin:s,size:i}=t,a=r.shape,[o,l]=mC(r,s,i),c=[];for(let u=0;u<n.rank;u++)c.push([o[u],a[u]-o[u]-l[u]]);return{x:()=>k$(n,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r$e={kernelName:nC,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r]=e,{dim:s}=t,i=!0,a=Ee(n,r);return{logits:()=>Vt(a,Ee($t(a,[s],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s$e={kernelName:uv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(n,sx(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yB={kernelName:eC,gradFunc:(n,e,t)=>{const{blockShape:r,paddings:s}=t;return{x:()=>y$(n,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bB={kernelName:tC,gradFunc:(n,e,t)=>{const{axis:r}=t;return{x:()=>eo(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i$e={kernelName:hv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Pt(n,Ee(ta(mt(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a$e={kernelName:o$,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(n,Ee(mt(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o$e={kernelName:dv,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=mr(2);return{a:()=>Ee(n,Ee(s,Vt(t,r))),b:()=>Ee(n,Ee(s,Vt(r,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l$e={kernelName:xv,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c$e={kernelName:fv,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=cn(t.shape,r.shape);return{a:()=>{let o=n;const l=ti(t.shape,s);return l.length>0&&(o=$t(o,l)),Ce(o,t.shape)},b:()=>{let o=n;const l=ti(r.shape,s);return l.length>0&&(o=$t(o,l)),Ce(_s(o),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u$e={kernelName:JT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,s=r.shape.slice(),{axis:i}=t;Sn(i,r.shape).forEach(c=>{s[c]=1});const o=Ce(n,s),l=Ee(o,Bf(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h$e={kernelName:pv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Pt(n,Ur(v$(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d$e={kernelName:mv,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ee(Vt(mr(1),Ur(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f$e={kernelName:gv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{reps:s}=t;return{x:()=>{let a=Jn(r);if(r.rank===1)for(let o=0;o<s[0];++o)a=tt(a,Pr(n,[o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let o=0;o<s[0];++o)for(let l=0;l<s[1];++l)a=tt(a,Pr(n,[o*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let o=0;o<s[0];++o)for(let l=0;l<s[1];++l)for(let c=0;c<s[2];++c)a=tt(a,Pr(n,[o*r.shape[0],l*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let o=0;o<s[0];++o)for(let l=0;l<s[1];++l)for(let c=0;c<s[2];++c)for(let u=0;u<s[3];++u)a=tt(a,Pr(n,[o*r.shape[0],l*r.shape[1],c*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p$e={kernelName:ag,gradFunc:(n,e,t)=>{const r=t,{perm:s}=r,i=Mf(s);return{x:()=>Qn(n,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m$e={kernelName:rC,gradFunc:(n,e,t)=>{const r=t,{axis:s}=r;return{value:()=>Ih(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g$e={kernelName:sC,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>x$e(n,t)}}};function x$e(n,e){const t=Ff(e,Jn(e)),r=E$(n,t);let s=Dm(e,mr(0,"int32"));const i=r.rank-s.rank;for(let o=0;o<i;++o)s=Za(s,o+1);s=kh(s,Bf(r.shape,"bool"));const a=Jn(r);return ka(s,r,a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y$e={kernelName:iC,gradFunc:n=>({x:()=>Jn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b$e=[nQ,gRe,xRe,yRe,bRe,vRe,_Re,wRe,ERe,SRe,TRe,CRe,kRe,DRe,$Re,LRe,PRe,ORe,MRe,FRe,BRe,zRe,VRe,jRe,HRe,WRe,qRe,KRe,XRe,YRe,zDe,ZRe,QRe,JRe,eDe,tDe,rDe,nDe,sDe,iDe,aDe,oDe,lDe,cDe,uDe,hDe,dDe,fDe,pDe,xDe,gB,gB,yDe,_De,SDe,TDe,CDe,ADe,NDe,kDe,IDe,RDe,DDe,$De,LDe,xB,xB,PDe,ODe,BDe,jDe,VDe,UDe,GDe,HDe,WDe,qDe,KDe,XDe,YDe,ZDe,QDe,JDe,e$e,t$e,n$e,r$e,s$e,yB,yB,bB,bB,i$e,o$e,a$e,l$e,c$e,u$e,h$e,d$e,f$e,p$e,m$e,g$e,y$e];for(const n of b$e)xAe(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.abs=function(){return this.throwIfDisposed(),ba(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.acos=function(){return this.throwIfDisposed(),xNe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.acosh=function(){return this.throwIfDisposed(),bNe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.add=function(n){return this.throwIfDisposed(),tt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.all=function(n,e){return this.throwIfDisposed(),zY(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.any=function(n,e){return this.throwIfDisposed(),b3(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.argMax=function(n){return this.throwIfDisposed(),C1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.argMin=function(n){return this.throwIfDisposed(),SNe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.asScalar=function(){return this.throwIfDisposed(),ue(this.size===1,()=>"The array must have only 1 element."),Ce(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.asType=function(n){return this.throwIfDisposed(),mt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as1D=function(){return this.throwIfDisposed(),Ce(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as2D=function(n,e){return this.throwIfDisposed(),Ce(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),Ce(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as4D=function(n,e,t,r){return this.throwIfDisposed(),Ce(this,[n,e,t,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as5D=function(n,e,t,r,s){return this.throwIfDisposed(),Ce(this,[n,e,t,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.asin=function(){return this.throwIfDisposed(),CNe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.asinh=function(){return this.throwIfDisposed(),NNe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.atan=function(){return this.throwIfDisposed(),INe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.atan2=function(n){return this.throwIfDisposed(),DNe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.atanh=function(){return this.throwIfDisposed(),LNe(this)};je().prototype.avgPool=function(n,e,t,r){return this.throwIfDisposed(),x$(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),y$(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.batchNorm=function(n,e,t,r,s){return this.throwIfDisposed(),uC(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.broadcastTo=function(n){return this.throwIfDisposed(),Ky(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cast=function(n){return this.throwIfDisposed(),mt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.ceil=function(){return this.throwIfDisposed(),oke(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),tl(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof Ks&&(n=[n]),eo([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.conv1d=function(n,e,t,r,s,i){return this.throwIfDisposed(),jY(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.conv2dTranspose=function(n,e,t,r,s){return this.throwIfDisposed(),VY(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.conv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),gm(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cos=function(){return this.throwIfDisposed(),v$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cosh=function(){return this.throwIfDisposed(),GY(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),_3(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),HY(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),Dke(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.depthwiseConv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),_$(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.dilation2d=function(n,e,t,r,s){return this.throwIfDisposed(),Pke(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.divNoNan=function(n){return this.throwIfDisposed(),zke(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.div=function(n){return this.throwIfDisposed(),Pt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.dot=function(n){return this.throwIfDisposed(),Vke(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.elu=function(){return this.throwIfDisposed(),dC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.equal=function(n){return this.throwIfDisposed(),Su(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.erf=function(){return this.throwIfDisposed(),WY(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),eIe(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.exp=function(){return this.throwIfDisposed(),Tu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.expandDims=function(n){return this.throwIfDisposed(),Za(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.expm1=function(){return this.throwIfDisposed(),sIe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.fft=function(){return this.throwIfDisposed(),uZ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.flatten=function(){return this.throwIfDisposed(),Ce(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.floor=function(){return this.throwIfDisposed(),pC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.floorDiv=function(n){return this.throwIfDisposed(),BY(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.gather=function(n,e,t){return this.throwIfDisposed(),E$(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.greaterEqual=function(n){return this.throwIfDisposed(),Dm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.greater=function(n){return this.throwIfDisposed(),rl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.ifft=function(){return this.throwIfDisposed(),w3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.irfft=function(){return this.throwIfDisposed(),$3e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.isFinite=function(){return this.throwIfDisposed(),fIe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.isInf=function(){return this.throwIfDisposed(),mIe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.isNaN=function(){return this.throwIfDisposed(),xIe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.leakyRelu=function(n){return this.throwIfDisposed(),T$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.lessEqual=function(n){return this.throwIfDisposed(),ix(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.less=function(n){return this.throwIfDisposed(),FE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.localResponseNormalization=function(n,e,t,r){return this.throwIfDisposed(),wIe(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logSigmoid=function(){return this.throwIfDisposed(),kIe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logSoftmax=function(n){return this.throwIfDisposed(),ZY(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),QY(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.log=function(){return this.throwIfDisposed(),Cu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.log1p=function(){return this.throwIfDisposed(),YY(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logicalAnd=function(n){return this.throwIfDisposed(),kh(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logicalNot=function(){return this.throwIfDisposed(),C$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logicalOr=function(n){return this.throwIfDisposed(),JY(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logicalXor=function(n){return this.throwIfDisposed(),MIe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),fr(this,n,e,t)};je().prototype.maxPool=function(n,e,t,r){return this.throwIfDisposed(),A$(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.max=function(n,e){return this.throwIfDisposed(),fc(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.maximum=function(n){return this.throwIfDisposed(),Ff(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.mean=function(n,e){return this.throwIfDisposed(),Fs(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.min=function(n,e){return this.throwIfDisposed(),ME(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.minimum=function(n){return this.throwIfDisposed(),k1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),HIe(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.mod=function(n){return this.throwIfDisposed(),qIe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.mul=function(n){return this.throwIfDisposed(),Ee(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.neg=function(){return this.throwIfDisposed(),_s(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.norm=function(n,e,t){return this.throwIfDisposed(),fC(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.notEqual=function(n){return this.throwIfDisposed(),BE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),eZ(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.onesLike=function(){return this.throwIfDisposed(),$l(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.pad=function(n,e){return this.throwIfDisposed(),k$(this,n,e)};je().prototype.pool=function(n,e,t,r,s,i){return this.throwIfDisposed(),r3e(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.pow=function(n){return this.throwIfDisposed(),xm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.prelu=function(n){return this.throwIfDisposed(),R$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.prod=function(n,e){return this.throwIfDisposed(),a3e(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.reciprocal=function(){return this.throwIfDisposed(),f3e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.relu=function(){return this.throwIfDisposed(),$m(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.relu6=function(){return this.throwIfDisposed(),nZ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.reshapeAs=function(n){return this.throwIfDisposed(),Ce(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.reshape=function(n){return this.throwIfDisposed(),Ce(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),mZ(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),gZ(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.reverse=function(n){return this.throwIfDisposed(),ym(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.rfft=function(){return this.throwIfDisposed(),O3e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.round=function(){return this.throwIfDisposed(),rZ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.rsqrt=function(){return this.throwIfDisposed(),sZ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.selu=function(){return this.throwIfDisposed(),iZ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.separableConv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),aZ(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sigmoid=function(){return this.throwIfDisposed(),sx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sign=function(){return this.throwIfDisposed(),w3e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sin=function(){return this.throwIfDisposed(),oZ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sinh=function(){return this.throwIfDisposed(),lZ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.slice=function(n,e){return this.throwIfDisposed(),Pr(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.softmax=function(n){return this.throwIfDisposed(),L$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.softplus=function(){return this.throwIfDisposed(),bv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),I$(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.split=function(n,e){return this.throwIfDisposed(),Jo(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sqrt=function(){return this.throwIfDisposed(),ta(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.square=function(){return this.throwIfDisposed(),Ur(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.squaredDifference=function(n){return this.throwIfDisposed(),F3e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.squeeze=function(n){return this.throwIfDisposed(),_v(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof Ks?[this,n]:[this,...n];return Ih(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.step=function(n){return this.throwIfDisposed(),wv(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.stridedSlice=function(n,e,t,r,s,i,a,o){return this.throwIfDisposed(),U3e(this,n,e,t,r,s,i,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sub=function(n){return this.throwIfDisposed(),Vt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sum=function(n,e){return this.throwIfDisposed(),$t(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.tan=function(){return this.throwIfDisposed(),H3e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.tanh=function(){return this.throwIfDisposed(),cC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.tile=function(n){return this.throwIfDisposed(),cc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.toBool=function(){return this.throwIfDisposed(),mt(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.toFloat=function(){return this.throwIfDisposed(),mt(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.toInt=function(){return this.throwIfDisposed(),mt(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.topk=function(n,e){return this.throwIfDisposed(),K3e(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.transpose=function(n){return this.throwIfDisposed(),Qn(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.unique=function(n){return this.throwIfDisposed(),Z3e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),fZ(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.unstack=function(n){return this.throwIfDisposed(),bm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.where=function(n,e){return this.throwIfDisposed(),ka(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.zerosLike=function(){return this.throwIfDisposed(),Jn(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Wc extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Wc.prototype)}}class Nl extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Nl.prototype)}}class _e extends Error{constructor(e){super(e),Object.setPrototypeOf(this,_e.prototype)}}class fn extends Error{constructor(e){super(e),Object.setPrototypeOf(this,fn.prototype)}}class g6 extends Error{constructor(e){super(e),Object.setPrototypeOf(this,g6.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sQ{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vm(n,e){if(Array.isArray(n)){let t=[];for(let r=0;r<e;r++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function qc(n,e){if(!n)throw new g6(e)}function vB(n,e){let t=0;for(const r of n)r===e&&t++;return t}function Qa(n){return n.length===1?n[0]:n}function br(n){return Array.isArray(n)?n:[n]}function oh(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Ap(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let yl={};function x6(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function T3(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>T3(e));else{const e=Object.keys(n);for(const t of e){const r=n[t];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?n[t]=r.value:T3(r))}}}function Cv(n,e={},t={},r="object",s=!1){if(typeof n=="string"){const i=n;let a;if(i in t)a=t[i];else if(i in yl)a=yl[i];else if(a=e[i],a==null)throw new _e(`Unknown ${r}: ${n}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}else{const i=n;if(i.className==null||i.config==null)throw new _e(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const a=i.className;let o,l;if(a in t?[o,l]=t[a]:a in yl?[o,l]=yl.className:a in e&&([o,l]=e[a]),o==null)throw new _e(`Unknown ${r}: ${a}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const x of Object.keys(yl))c[x]=yl[x];for(const x of Object.keys(t))c[x]=t[x];const u=i.config;u.customObjects=c;const d=Object.assign({},yl);for(const x of Object.keys(t))yl[x]=t[x];T3(i.config);const p=l(o,i.config,t,s);return yl=Object.assign({},d),p}else{const c=Object.assign({},yl);for(const d of Object.keys(t))yl[d]=t[d];const u=new o(i.config);return yl=Object.assign({},c),u}}}function v$e(n,e){return n<e?-1:n>e?1:0}function ow(n,e){return-1*v$e(n,e)}function ef(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function _$e(n){if(n==null)throw new _e(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function Pm(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new _e(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function y6(n,e,t=0,r=1/0){return qc(t>=0),qc(r>=t),Array.isArray(n)&&n.length>=t&&n.length<=r&&n.every(s=>typeof s===e)}function mi(n,e){Array.isArray(n)?(ue(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,r)=>mi(t,`element ${r+1} of ${e}`))):ue(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${iQ(n)}.`)}function iQ(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>iQ(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function w$e(n,e,t){let r=t!=null?t():Ya(),s;return(...a)=>{const o=t!=null?t():Ya();return o-r<e||(r=o,s=n(...a)),s}}function aQ(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let E$e=0;function oQ(){return E$e++}const lw={};function bC(n=""){return n in lw||(lw[n]=0),lw[n]+=1,n+lw[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const S$e=["channelsFirst","channelsLast"],T$e=["nearest","bilinear"],C$e=["valid","same","causal"],A$e=["max","avg"],N$e=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const N0=new Map;function As(n){Pm(S$e,"DataFormat",n)}function k$e(n){Pm(T$e,"InterpolationFormat",n)}function sl(n){Pm(C$e,"PaddingMode",n)}function lQ(n){Pm(A$e,"PoolMode",n)}const Xy=[],_B="/";function Up(n,e){Xy.push(n);try{const t=e();return Xy.pop(),t}catch(t){throw Xy.pop(),t}}function I$e(){return Xy.length===0?"":Xy.join(_B)+_B}function cQ(n){if(!hQ(n))throw new Error("Not a valid tensor name: '"+n+"'");return I$e()+n}function uQ(n){if(!hQ(n))throw new Error("Not a valid tensor name: '"+n+"'");N0.has(n)||N0.set(n,0);const e=N0.get(n);if(N0.set(n,N0.get(n)+1),e>0){const t=`${n}_${e}`;return N0.set(t,1),t}else return n}const R$e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function hQ(n){return!!n.match(R$e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function D$e(n){return n===parseInt(n.toString(),10)}function tf(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let r=1;for(let s=e;s<t;++s)r*=n[s];return r}function kg(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const r=n[t];r<e&&(e=r)}return e}function bf(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const r=n[t];r>e&&(e=r)}return e}function yc(n,e){if(e<n)throw new _e(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let r=n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Nk;function Zs(){return Nk==null&&(Nk=jAe().epsilon()),Nk}function bc(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fu(n,e){return mt(n,e)}function Av(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),Ce(n,t)}function $$e(n,e){return De(()=>{if(n.shape.length!==2)throw new _e(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=Av(n,1);return C3(t,[1,e,1])})}function L$e(n){const e=[tf(n.shape)];return Ce(n,e)}function P$e(n){if(n.rank<=1)throw new _e(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],tf(n.shape,1)];return Ce(n,e)}function Gp(n,e,t){return De(()=>{switch(n.rank){case 1:return D$(n,e,t);case 2:return cZ(n,[e,0],[t,n.shape[1]]);case 3:return $$(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return jE(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return Pr(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return Pr(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new _e(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function kk(n,e,t){return De(()=>{switch(n.rank){case 1:return D$(n,e,t);case 2:return cZ(n,[0,e],[n.shape[0],t]);case 3:return $$(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return jE(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new _e(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function cw(n,e,t,r){return De(()=>{switch(n.rank){case 1:return D$(n,e,t);case 2:switch(r){case 1:return Gp(n,e,t);case 2:return kk(n,e,t);default:throw new _e(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Gp(n,e,t);case 2:return $$(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return kk(n,e,t);default:throw new _e(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Gp(n,e,t);case 2:return jE(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return jE(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return kk(n,e,t);default:throw new _e(`The axis is not within the rank of the tensor ${r}`)}default:throw new _e(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function b6(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),eo(n,e)}function wB(n,e){switch(n.rank){case 1:return uke([n,e]);case 2:return dke([n,e],0);case 3:return pke([n,e],0);case 4:return gke([n,e],0);default:throw new _e(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function C3(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new _e(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return cc(n,e)}function vC(n,e=0,t=1,r,s){return c3e(n,e,t,r,s)}function pu(n,e,t,r){if(n.rank<2||e.rank<2)throw new fn(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=n.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(s!==i)throw new fn(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return lB({a:n,b:e,transposeA:!1,transposeB:!1,bias:r?A3(n.rank,r,bc()):null,activation:t});{const s=n.shape.slice(),i=s.pop();n=Ce(n,[-1,i]);const a=e.shape.slice(),o=a.pop(),l=a.pop(),c=[...a,o],u=Array.from({length:e.rank},(y,v)=>v===0?e.rank-2:v<=e.rank-2?v-1:v);e=Ce(Qn(e,u),[l,-1]);const d=[...s,...c];return Ce(lB({a:n,b:e,transposeA:!1,transposeB:!1,bias:r?A3(n.rank,r,bc()):null,activation:t}),d)}}function dQ(n,e,t){return De(()=>(Array.isArray(e)?e=bo(e,"int32"):e=mt(e,"int32"),E$(n,e,t)))}function Nv(n){return Ee(n,n)}function A3(n,e,t){const r=e.shape;if(e.rank!==1&&e.rank!==n)throw new _e(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return r.length===1?Ce(e,[1,r[0],1,1,1]):Ce(e,[1,r[3],r[0],r[1],r[2]]);if(t==="channelsLast")return r.length===1?Ce(e,[1,1,1,1,r[0]]):Ce(e,[1].concat(r))}else if(n===4){if(t==="channelsFirst")return r.length===1?Ce(e,[1,r[0],1,1]):Ce(e,[1,r[2],r[0],r[1]]);if(t==="channelsLast")return r.length===1?Ce(e,[1,1,1,r[0]]):Ce(e,[1].concat(r))}else if(n===3){if(t==="channelsFirst")return r.length===1?Ce(e,[1,r[0],1]):Ce(e,[1,r[1],r[0]]);if(t==="channelsLast")return r.length===1?Ce(e,[1,1,r[0]]):Ce(e,[1].concat(r))}else if(n<3)return e;throw new _e(`Unsupported input rank by biasAdd: ${e.rank}`)}function wc(n,e,t){return De(()=>(t==null&&(t=bc()),As(t),tt(n,A3(n.rank,e,t))))}function O$e(n,e=1){if(e!==1)throw new fn(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return dC(n)}function M$e(n){return De(()=>Pt(n,tt(ba(n),1)))}function fQ(n,e,t,r){return De(()=>s4e(n,e,t,r))}function F$e(n){return De(()=>{const e=tt(.5,Ee(.2,n));return tl(e,0,1)})}function kv(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const B$e=["fanIn","fanOut","fanAvg"],z$e=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function j$e(n){Pm(B$e,"FanMode",n)}function V$e(n){Pm(z$e,"Distribution",n)}class Fl extends ox{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class pQ extends Fl{apply(e,t){return fi(e,t)}}pQ.className="Zeros";et(pQ);class v6 extends Fl{apply(e,t){return Bf(e,t)}}v6.className="Ones";et(v6);class mQ extends Fl{constructor(e){if(super(),typeof e!="object")throw new _e(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new _e(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return De(()=>Ee(mr(this.value),Bf(e,t)))}getConfig(){return{value:this.value}}}mQ.className="Constant";et(mQ);class gQ extends Fl{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return vv(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}gQ.className="RandomUniform";et(gQ);class xQ extends Fl{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new fn(`randomNormal does not support dType ${t}.`);return vC(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}xQ.className="RandomNormal";et(xQ);class yQ extends Fl{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new fn(`truncatedNormal does not support dType ${t}.`);return dZ(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}yQ.className="TruncatedNormal";et(yQ);class bQ extends Fl{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return De(()=>{if(e.length!==2||e[0]!==e[1])throw new _e("Identity matrix initializer can only be used for 2D square matrices.");return Ee(this.gain,XY(e[0]))})}getConfig(){return{gain:this.gain}}}bQ.className="Identity";et(bQ);function U$e(n,e="channelsLast"){let t,r;if(As(e),n.length===2)t=n[0],r=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const s=tf(n,2);t=n[1]*s,r=n[0]*s}else if(e==="channelsLast"){const s=tf(n,0,n.length-2);t=n[n.length-2]*s,r=n[n.length-1]*s}}else{const s=tf(n);t=Math.sqrt(s),r=Math.sqrt(s)}return[t,r]}class Eo extends Fl{constructor(e){if(super(),e.scale<0)throw new _e(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,j$e(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,V$e(this.distribution),this.seed=e.seed}apply(e,t){const r=U$e(e),s=r[0],i=r[1];let a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,s):this.mode==="fanOut"?a/=Math.max(1,i):a/=Math.max(1,(s+i)/2),this.distribution==="normal"){const o=Math.sqrt(a);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new fn(`${this.getClassName()} does not support dType ${t}.`);return dZ(e,0,o,t,this.seed)}else{const o=Math.sqrt(3*a);return vv(e,-o,o,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Eo.className="VarianceScaling";et(Eo);class _6 extends Eo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Eo.className}}_6.className="GlorotUniform";et(_6);class w6 extends Eo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Eo.className}}w6.className="GlorotNormal";et(w6);class E6 extends Eo{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Eo.className}}E6.className="HeNormal";et(E6);class S6 extends Eo{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Eo.className}}S6.className="HeUniform";et(S6);class T6 extends Eo{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Eo.className}}T6.className="LeCunNormal";et(T6);class C6 extends Eo{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Eo.className}}C6.className="LeCunUniform";et(C6);class vQ extends Fl{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return De(()=>{if(e.length<2)throw new fn("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const r=Ue(e.slice(0,-1)),s=e[e.length-1],i=r*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const a=[Math.max(s,r),Math.min(s,r)],o=vC(a,0,1,t,this.seed),l=eRe.qr(o,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return c=Ee(c,d.sign()),r<s&&(c=c.transpose()),Ee(mr(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}vQ.className="Orthogonal";et(vQ);const EB={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function SB(n,e={}){return Cv(n,Cl.getMap().classNameMap,e,"initializer")}function is(n){return x6(n)}function Zr(n){if(typeof n=="string"){const e=n in EB?EB[n]:n;if(e==="GlorotNormal")return new w6;if(e==="GlorotUniform")return new _6;if(e==="HeNormal")return new E6;if(e==="HeUniform")return new S6;if(e==="LeCunNormal")return new T6;if(e==="LeCunUniform")return new C6;{const t={};return t.className=e,t.config={},SB(t)}}else return n instanceof Fl?n:SB(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function N3(n){return Array.isArray(n)&&Array.isArray(n[0])}function VE(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function Wt(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new _e(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function or(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new _e(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function UE(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const TB="Variable";class G$e{constructor(e,t="float32",r=TB,s=!0,i=null){this.dtype=t??"float32",this.shape=e.shape,this.id=oQ(),r=r??TB,this.originalName=cQ(r),this.name=uQ(this.originalName),this.trainable_=s,this.constraint=i,this.val=e4e(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),H$e(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function H$e(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function k3(n){return n.map(e=>e.read())}function A6(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Qs{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Au{constructor(e,t,r,s,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=r,this.inputs=s,this.callArgs=i,this.outputTensorIndex=o,this.id=oQ(),a!=null&&(this.originalName=cQ(a),this.name=uQ(this.originalName)),this.rank=t.length}}let W$e=0;class _C{constructor(e,t){this.callArgs=t,this.id=W$e++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r?.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let q$e=0;class Tn extends ox{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=q$e++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const r=this.getClassName();t=oh(r)+"_"+bC(r)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new Nl(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new _e(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Qa(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Qa(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Wc(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Wc(`Layer ${this.name} is not connected, no input to return.`);return Qa(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Wc(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Wc(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Qa(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=br(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=br(this.inputSpec);if(t.length!==r.length)throw new _e(`Layer ${this.name} expects ${r.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let s=0;s<t.length;s++){const i=t[s],a=r[s];if(a==null)continue;const o=i.rank;if(a.ndim!=null&&o!==a.ndim)throw new _e(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${o}`);if(a.maxNDim!=null&&o>a.maxNDim)throw new _e(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${o}`);if(a.minNDim!=null&&o<a.minNDim)throw new _e(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${o}.`);if(a.dtype!=null&&i.dtype!==a.dtype)throw new _e(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${i.dtype}.`);if(a.axes){const l=i.shape;for(const c in a.axes){const u=Number(c),d=a.axes[c],p=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(p)===-1)throw new _e(`Input ${s} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(a.shape!=null)for(let l=0;l<a.shape.length;++l){const c=a.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new _e(`Input ${s} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${i.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const r=br(e),s=Y$e(e),i=Z$e(e);if(s===i)throw new _e("Arguments to apply() must be all SymbolicTensors or all Tensors");return Up(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const a=[];for(const o of br(e))a.push(o.shape);this.build(Qa(a)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let a=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,a);const o=br(a),l=[];for(let c of o)r.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(a=Qa(l),this.activityRegularizer!=null)throw new fn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}else{const a=K$e(e),o=this.computeOutputShape(a);let l;const c=X$e(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((u,d)=>new Au(c,u,this,br(e),t,this.name,d)):l=new Au(c,o,this,br(e),t,this.name),this.addInboundNode(e,l,null,null,a,o,t),this._refCount++,this.activityRegularizer!=null)throw new fn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Wc(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const r=JSON.stringify(t.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new Wc(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Nl(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return UE(this.weights)}build(e){this.built=!0}getWeights(e=!1){return k3(e?this.trainableWeights:this.weights)}setWeights(e){De(()=>{const t=this.weights;if(t.length!==e.length)throw new _e(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const r=[],s=k3(t);for(let i=0;i<s.length;++i){const a=s[i],o=t[i],l=e[i];if(!gr(a.shape,l.shape))throw new _e(`Layer weight shape ${a.shape} not compatible with provided weight shape ${l.shape}`);r.push([o,l])}A6(r)})}addWeight(e,t,r,s,i,a,o,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new _e(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():Zr("zeros"));const c=s.apply(t,r),u=new G$e(c,r,e,a,o);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),a==null&&(a=!0),a?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=br(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,r){if(!this.supportsMasking)return;const s=this.computeMask(e,r),i=br(t),a=br(s);if(i.length!==a.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let o=0;o<i.length;o++)i[o].kerasMask=a[o]}addInboundNode(e,t,r,s,i,a,o=null){const l=br(e);t=br(t),r=br(r),s=br(s),i=VE(i),a=VE(a);const c=[],u=[],d=[];for(const p of l)c.push(p.sourceLayer),u.push(p.nodeIndex),d.push(p.tensorIndex);new _C({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:t,inputMasks:r,outputMasks:s,inputShapes:i,outputShapes:a},o);for(let p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function K$e(n){n=br(n);const e=[];for(const t of n)e.push(t.shape);return Qa(e)}function X$e(n){return"float32"}function _Q(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const r=e.inboundNodes[t];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let i=0;i<r.inboundLayers.length;i++){const a=r.inputTensors[i],o=r.inboundLayers[i],l=r.nodeIndices[i],c=_Q(a,o,l);for(const u of c)s.indexOf(u)===-1&&s.push(u)}return s}}}function Y$e(n){let e=!0;for(const t of br(n))if(!(t instanceof Au)){e=!1;break}return e}function Z$e(n){let e=!0;for(const t of br(n))if(t instanceof Au){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Iv extends Tn{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:bC("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new _e("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new _e("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new _e("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=t,this.dtype=r,this.inputSpec=[{shape:t}];const s=new Au(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new _C({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new _e(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Iv.className="InputLayer";et(Iv);function Q$e(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new _e("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new Iv({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function J$e(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return mt(e,n.dtype)}catch{throw new _e(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class Hd{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Hd)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=J$e(e,t),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new _e(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Au){if(this.id2Value[e.id]==null)throw new _e(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new _e(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof Au){if(this.id2Value[e.id]==null)throw new _e(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new _e(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&In(this.id2Mask)}}const GE=new sQ,HE=new sQ;function e6e(n){GE?.setMaxEntries(n),HE?.setMaxEntries(n)}function Ry(n,e,t,r){const s=t==null?!1:t.training,i=Array.isArray(n),a=i?n:[n],o=a.map(y=>y.name),l=[],c=e.names();for(const y of o)c.indexOf(y)!==-1?l.push(e.getValue(y)):l.push(null);const u=o.join(",")+"|"+e.names().sort().join(",");let d=GE.get(u),p;if(d==null){const y=t6e(a,e);d=y.sorted,p=y.recipientCounts,GE.put(u,d),HE.put(u,p)}p={},s||Object.assign(p,HE.get(u));const x=new Hd(e);for(let y=0;y<d.length;++y){const v=d[y],b=v.sourceLayer;if(b instanceof Iv)continue;const S=[],T=[],C=[];let I=!1;for(const G of v.inputs){const V=x.getValue(G),O=x.getMask(G);S.push(V),T.push(O),O!=null&&(I=!0),s||(p[G.name]--,p[G.name]===0&&!e.hasKey(G)&&o.indexOf(G.name)===-1&&!V.isDisposed&&G.sourceLayer.stateful!==!0&&C.push(V))}I&&(t=t||{},t.mask=T[0]);const $=br(b.apply(S,t));let q=null;b.supportsMasking&&(q=b.computeMask(S,T));const U=r6e(v),F=Array.isArray(U)?U:[U];for(let G=0;G<F.length;++G){x.hasKey(F[G])||x.add(F[G],$[G],Array.isArray(q)?q[0]:q);const V=o.indexOf(F[G].name);V!==-1&&(l[V]=$[G])}s||In(C)}return x.disposeMasks(),i?l:l[0]}function t6e(n,e){ue(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],r={};if(n.length===1){const s=CB(n[0],e);t=s.sorted,r=s.recipientMap}else{const s=new Set;for(const i of n){const{sorted:a,recipientMap:o}=CB(i,e);for(const l of a)s.has(l.name)||(t.push(l),s.add(l.name));for(const l in o)r[l]==null&&(r[l]=new Set),o[l].forEach(c=>r[l].add(c))}}return{sorted:t,recipientCounts:n6e(r)}}function n6e(n){const e={};for(const t in n)e[t]=n[t].size;return e}function CB(n,e){const t=new Set,r=[],s={};for(const o of e.names())t.add(o);const i=[],a=[];for(i.push(n);i.length>0;){const o=i[i.length-1];if(t.has(o.name)){i.pop();continue}const l=a[a.length-1]===i.length-1;if(o.inputs.length===0||l)i.pop(),r.push(o),t.add(o.name),l&&a.pop();else{a.push(i.length-1);for(const c of o.inputs)s[c.name]==null&&(s[c.name]=new Set),s[c.name].add(o.name),!t.has(c.name)&&i.push(c)}}return{sorted:r,recipientMap:s}}function r6e(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let r=0;r<n.sourceLayer.inboundNodes.length;++r)for(const s of n.sourceLayer.inboundNodes[r].outputTensors)if(s.id===n.id){t=r;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s6e=Me();s6e.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,e6e);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function N6(n,e){return De(()=>ta($t(Ee(n,n),e,!0)))}class Rv extends ox{getConfig(){return{}}}class wQ extends Rv{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return De(()=>{const t=N6(e,this.axis),r=tl(t,0,this.maxValue);return Ee(e,Pt(r,tt(Zs(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}wQ.className="MaxNorm";et(wQ);class EQ extends Rv{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return De(()=>Pt(e,tt(Zs(),N6(e,this.axis))))}getConfig(){return{axis:this.axis}}}EQ.className="UnitNorm";et(EQ);class SQ extends Rv{apply(e){return $m(e)}}SQ.className="NonNeg";et(SQ);class TQ extends Rv{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return De(()=>{const t=N6(e,this.axis),r=tt(Ee(this.rate,tl(t,this.minValue,this.maxValue)),Ee(1-this.rate,t));return Ee(e,Pt(r,tt(Zs(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}TQ.className="MinMaxNorm";et(TQ);const AB={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Js(n){return x6(n)}function NB(n,e={}){return Cv(n,Cl.getMap().classNameMap,e,"constraint")}function ei(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in AB?AB[n]:n,config:{}};return NB(t)}else return n instanceof Rv?n:NB(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function yp(n){if(n==null)return;const e=[],t=[],r=[];for(const s in n){const i=n[s];if(typeof i!="number"){const a=i;e.push(a.data()),t.push(s),r.push(a)}}if(e.length>0){const s=await Promise.all(e);for(let i=0;i<s.length;++i)n[t[i]]=s[i][0];In(r)}}function CQ(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var kB;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(kB||(kB={}));const i6e=125;class R1{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class a6e{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class o6e extends R1{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const r=t.size==null?0:t.size;this.seen+=r;for(const s in t){const i=t[s];if(typeof i=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+i*r;else{let a;s in this.totals?a=this.totals[s]:this.totals[s]=0;const o=De(()=>tt(this.totals[s],Ee(i,r)));this.totals[s]=o,a?.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?t[r]=this.totals[r]/this.seen:De(()=>{const s=Ee(Pt(1,this.seen),this.totals[r]);t[r]=s,this.totals[r].dispose(),hu(t[r])}))}}class l6e extends R1{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const r in t)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(t[r])}async syncData(){const e=[],t=[],r=[];for(const i in this.history){const a=this.history[i];for(let o=0;o<a.length;++o)if(typeof a[o]!="number"){const l=a[o];e.push(l.data()),t.push(i),r.push(o)}}const s=await Promise.all(e);for(let i=0;i<s.length;++i)this.history[t[i]][r[i]].dispose(),this.history[t[i]][r[i]]=s[i][0]}}class c6e extends R1{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||RZ,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=i6e),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");i3(this.yieldEvery)&&(this.maybeWait=w$e(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,r){const s=[];this.yield!=null&&(await yp(r),s.push(this.yield(e,t,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await yp(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const r=[];this.epochEnd!=null&&(await yp(t),r.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,t){this.batchBegin!=null&&(await yp(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const r=[];this.batchEnd!=null&&(await yp(t),r.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):i3(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await yp(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await yp(e),await this.trainEnd(e))}}function AQ(n,e){return n==null&&(n={}),n instanceof R1?[n]:Array.isArray(n)&&n[0]instanceof R1?n:br(n).map(r=>new c6e(r,e))}class wl{constructor(){}static registerCallbackConstructor(e,t){ue(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),wl.checkForDuplicate(t),wl.constructors[e]==null&&(wl.constructors[e]=[]),wl.constructors[e].push(t)}static checkForDuplicate(e){for(const t in wl.constructors)wl.constructors[+t].forEach(s=>{if(s===e)throw new _e("Duplicate callback constructor.")})}static clear(){wl.constructors={}}static createCallbacks(e){const t=[];for(const r in wl.constructors){const s=+r;e>=s&&t.push(...wl.constructors[s])}return t.map(r=>new r)}}wl.constructors={};function NQ(n,e,t,r,s,i,a,o,l){const c=new l6e,u=[new o6e,...wl.createCallbacks(e)];n!=null&&u.push(...n),u.push(c);const d=new a6e(u);return d.setParams({epochs:t,initialEpoch:r,samples:s,steps:i,batchSize:a,verbose:e,doValidation:o,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _h(n,e={},t=!1){return Cv(n,Cl.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WE(n,e){return De(()=>{n.dtype!=="float32"&&(n=mt(n,"float32"));const t=$t(Nv(n),e,!0),r=hC(t.shape,Zs()),s=ta(Ff(t,r));return Pt(n,s)})}function wC(n,e){return De(()=>Fs(Nv(Vt(e,n)),-1))}function k6(n,e){return De(()=>Fs(ba(Vt(e,n)),-1))}function I6(n,e){return De(()=>{const t=Vt(n,e),r=tl(ba(n),Zs(),Number.MAX_VALUE),s=ba(Pt(t,r));return Ee(100,Fs(s,-1))})}function u6e(n,e){return De(()=>{const t=tl(e,Zs(),Number.MAX_VALUE),r=Cu(tt(1,t)),s=tl(n,Zs(),Number.MAX_VALUE),i=Cu(tt(1,s));return Fs(Nv(Vt(r,i)),-1)})}function h6e(n,e){return De(()=>{const t=Ff(0,Vt(1,Ee(n,e)));return Fs(Nv(t),-1)})}function d6e(n,e){return De(()=>{const t=Ff(0,Vt(1,Ee(n,e)));return Fs(t,-1)})}function f6e(n,e){return De(()=>{const t=$t(Ee(n,e),-1),r=fc(Ee(Vt(1,n),e),-1);return Ff(0,tt(1,Vt(r,t)))})}function p6e(n,e){return De(()=>{const t=Math.log(2),r=Vt(e,n),s=Vt(tt(r,bv(Ee(-2,r))),t);return Fs(s,-1)})}function D1(n,e,t=!1){return De(()=>{if(t)e=L$(e);else{const r=$t(e,e.shape.length-1,!0);e=Pt(e,r)}return e=tl(e,Zs(),1-Zs()),_s($t(Ee(mt(n,"float32"),Cu(e)),e.shape.length-1))})}function qE(n,e,t=!1){return De(()=>{const r=mt(pC(L$e(n)),"int32");e=tl(e,Zs(),1-Zs());const s=e.shape,i=Ce(eZ(r,s[s.length-1]),s);return D1(i,e,t)})}function m6e(n,e){if(!gr(n.shape,e.shape))throw new _e(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return De(()=>{const t=$m(e),r=_s(ba(e));return tt(Vt(t,Ee(e,n)),YY(Tu(r)))})}function EC(n,e){return De(()=>{let t;return t=tl(e,Zs(),1-Zs()),t=Cu(Pt(t,Vt(1,t))),Fs(m6e(n,t),-1)})}function g6e(n,e){return De(()=>{const t=tl(n,Zs(),1),r=tl(e,Zs(),1);return $t(Ee(n,Cu(Pt(t,r))),-1)})}function x6e(n,e){return De(()=>{const t=Cu(tt(Zs(),e));return Fs(Vt(e,Ee(n,t)),-1)})}function kQ(n,e){return De(()=>{const t=WE(n,-1),r=WE(e,-1),s=Ee(t,r);return _s($t(s,-1))})}const KE={meanSquaredError:wC,meanAbsoluteError:k6,meanAbsolutePercentageError:I6,meanSquaredLogarithmicError:u6e,squaredHinge:h6e,hinge:d6e,categoricalHinge:f6e,logcosh:p6e,categoricalCrossentropy:D1,sparseCategoricalCrossentropy:qE,binaryCrossentropy:EC,kullbackLeiblerDivergence:g6e,poisson:x6e,cosineProximity:kQ};function Ik(n){if(typeof n=="string"){if(n in KE)return KE[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new _e(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function IQ(n,e){return De(()=>{const t=Ee(.5,$l(e)),r=fu(rl(e,t),n.dtype);return Fs(Su(n,r),-1)})}function RQ(n,e){return De(()=>fu(Su(C1(n,-1),C1(e,-1)),"float32"))}function y6e(n,e){return De(()=>mt($t(kh(Su(n,1),Su(e,1))),"float32"))}function b6e(n,e){return De(()=>mt($t(kh(Su(n,0),Su(e,1))),"float32"))}function v6e(n,e){return De(()=>{const t=y6e(n,e),r=b6e(n,e),s=tt(t,r);return mt(ka(rl(s,0),Pt(t,s),0),"float32")})}function _6e(n,e){return EC(n,e)}function w6e(n,e){return n.rank===e.rank&&(n=_v(n,[n.rank-1])),e=C1(e,-1),e.dtype!==n.dtype&&(e=mt(e,n.dtype)),mt(Su(n,e),"float32")}const E6e=wC,S6e=wC,T6e=k6,C6e=k6,A6e=I6,N6e=I6,DQ=D1,k6e=kQ,$Q=qE,XE={binaryAccuracy:IQ,categoricalAccuracy:RQ,precision:v6e,categoricalCrossentropy:DQ,sparseCategoricalCrossentropy:$Q,mse:E6e,MSE:S6e,mae:T6e,MAE:C6e,mape:A6e,MAPE:N6e,cosine:k6e};function I6e(n){if(typeof n=="string"&&n in XE)return XE[n];if(typeof n!="string"&&n!=null)return n;throw new _e(`Unknown metric ${n}`)}function uw(n){if(qc(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(KE))if(KE[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(XE))if(XE[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function R6e(n){const e={Adagrad:()=>A0.adagrad(.01),Adadelta:()=>A0.adadelta(1,.95,Zs()),Adam:()=>A0.adam(.001,.9,.999,Zs()),Adamax:()=>A0.adamax(.002,.9,.999,Zs(),0),RMSProp:()=>A0.rmsprop(.001,.9,0,Zs()),SGD:()=>A0.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new _e(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const IB=1*1024*1024;function RB(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!I3(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const r=JSON.stringify(n);r.length>IB&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${IB}.`)}}function I3(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!I3(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!I3(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function D6e(n,e,t,r=console.log){const s=L6e(n),i=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(u=>Math.floor(e*u)));let a;if(!s){i.push("Receives inputs"),a=[];for(const u in n.nodesByDepth)a.push(...n.nodesByDepth[u])}r("_".repeat(e)),YE(i,t,r),r("=".repeat(e));const o=n.layers;for(let u=0;u<o.length;++u)s?P6e(o[u],t,r):O6e(o[u],t,a,r),r((u===o.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const l=$6e(n),c=UE(n.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(e))}function $6e(n){let e;return n.collectedTrainableWeights!=null?e=UE(n.collectedTrainableWeights):e=UE(n.trainableWeights),e}function L6e(n){let e=!0;const t=[],r=[];for(const s in n.nodesByDepth)t.push(n.nodesByDepth[s]);for(const s of t){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of n.layers){let i=!1;for(const a of s.inboundNodes)if(r.indexOf(a)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function YE(n,e,t=console.log){let r="";for(let s=0;s<n.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=n[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);t(r)}function P6e(n,e,t){let r,s;try{s=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const i=n.name,a=n.getClassName(),o=[`${i} (${a})`,s,r,n.countParams().toString()];YE(o,e,t)}function O6e(n,e,t,r){let s,i;try{i=n.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const a=[];for(const d of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(d)===-1))for(let p=0;p<d.inboundLayers.length;++p){const x=d.inboundLayers[p].name,y=d.nodeIndices[p],v=d.tensorIndices[p];a.push(`${x}[${y}][${v}]`)}const o=n.name,l=n.getClassName(),c=a.length===0?"":a[0],u=[`${o} (${l})`,i,s,n.countParams().toString(),c];YE(u,e,r);for(let d=1;d<a.length;++d)YE(["","","","",a[d]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function LQ(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function R3(n,e){if(n===null)return null;if(typeof n=="string")return Ap(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],r=n.length;for(let s=0;s<r;++s){const i=n[s];LQ(e,s,i)?t.push(i):t.push(R3(i,e))}return t}else{const t={};for(const r of Object.keys(n)){const s=n[r];if(r==="name"&&typeof s=="string")t[r]=s;else{const i=Ap(r);t[i]=R3(s,i)}}return t}}function D3(n,e){if(n==null)return null;if(typeof n=="string")return oh(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],r=n.length;for(let s=0;s<r;++s){const i=n[s];LQ(e,s,i)?t.push(i):t.push(D3(i,e))}return t}else{const t={};for(const r of Object.keys(n)){const s=n[r],i=oh(r);(r==="name"||r==="className")&&typeof s=="string"?t[i]=s:t[i]=D3(s,r)}return t}}/** @license See the LICENSE file. */const PQ="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const M6e=n=>{const e=Object.keys(n);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class tc extends Tn{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const T=this.getClassName().toLowerCase();this.name=bC(T)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],ef(this.inputs).length!==this.inputs.length)throw new _e(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(T=>T.name)}`);ef(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(T=>T.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const T of this.outputs){const C=T.sourceLayer,I=T.nodeIndex,$=T.tensorIndex;this.outputLayers.push(C),this.outputLayersNodeIndices.push(I),this.outputLayersTensorIndices.push($)}for(const T of this.inputs){const C=T.sourceLayer,I=T.nodeIndex,$=T.tensorIndex;qc(I===0,"input layer has >1 nodes"),qc($===0,"input layer has >1 tensors"),this.inputLayers.push(C),this.inputLayersNodeIndices.push(I),this.inputLayersTensorIndices.push($)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let T=0;T<this.inputLayers.length;T++){const C=this.inputLayers[T];if(!(C instanceof Iv))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${T} (0-based) originates from layer type ${C.getClassName()}.`);this.inputNames.push(C.name),this.feedInputShapes.push(C.batchInputShape),this.feedInputNames.push(C.name)}for(const T of this.outputLayers)this.outputNames.push(T.name);this.internalInputShapes=this.inputs.map(T=>T.shape),this.internalOutputShapes=this.outputs.map(T=>T.shape);const t={},r={},s={},i={},a={},o=[],l=(T,C,I,$,q,U)=>{($==null||q==null||U==null)&&($=T.sourceLayer,q=T.nodeIndex,U=T.tensorIndex);const F=$.inboundNodes[q];if(I.indexOf(F)!==-1)throw new Nl(`The tensor ${T.name} at layer "${$.name}" is part of a cycle.`);if(C.indexOf(F)!==-1)return;this.containerNodes.add(tc.nodeKey($,q)),$.id in a||(a[$.id]=Object.keys(a).length),I.indexOf(F)===-1&&I.push(F);const G=F.inboundLayers.length;for(let V=0;V<G;V++){const O=F.inputTensors[V],K=F.inboundLayers[V],P=F.nodeIndices[V],N=F.tensorIndices[V];l(O,C,I,K,P,N)}for(C.push(F);I.indexOf(F)>=0;)I.splice(I.indexOf(F),1);o.push(F)},c=[],u=[];for(const T of this.outputs)l(T,c,u);const d=o.slice().reverse();for(const T of d){r[T.id]=T,T.id in t||(t[T.id]=0);let C=t[T.id];const I=s[T.outboundLayer.id]==null?0:s[T.outboundLayer.id];C=Math.max(C,I),s[T.outboundLayer.id]=C,i[T.outboundLayer.id]=T.outboundLayer,t[T.id]=C;for(let $=0;$<T.inboundLayers.length;$++){const q=T.inboundLayers[$],U=T.nodeIndices[$],F=q.inboundNodes[U],G=t[F.id]==null?0:t[F.id];t[F.id]=Math.max(C+1,G),r[F.id]=F}}const p={};for(const T in t){const C=t[T];C in p||(p[C]=[]),p[C].push(r[T])}const x={};for(const T in s){const C=s[T];C in x||(x[C]=[]),x[C].push(i[T])}let y=Object.keys(x).map(T=>parseInt(T,10)).sort(ow);this.layers=[];for(const T of y){const C=x[T];C.sort((I,$)=>{const q=a[I.id],U=a[$.id];return q<U?-1:q>U?1:0});for(const I of C)I instanceof tc&&this.internalContainerRefs.push(I),this.layers.push(I)}this.layersByDepth=x,y=Object.keys(p).map(T=>parseInt(T,10)).sort(ow);const v=this.inputs.slice(),b=[];for(const T of y)for(const C of p[T]){const I=C.outboundLayer;if(I!=null){for(const $ of C.inputTensors)if(v.indexOf($)===-1)throw new Nl(`Graph disconnected: cannot obtain value for tensor ${$} at layer "${I.name}". The following previous layers were accessed without issue: ${b}`);for(const $ of C.outputTensors)v.push($);b.push(I.name)}}this.nodesByDepth=p;const S=this.layers.map(T=>T.name);for(const T of S){const C=S.filter(I=>I===T).length;if(C!==1)throw new Nl(`The name "${T}" is used ${C} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(S))}this.outboundNodes=[],this.inboundNodes=[],new _C({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(T=>null),outputMasks:this.outputs.map(T=>null),inputShapes:this.inputs.map(T=>T.shape),outputShapes:this.outputs.map(T=>T.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new _e("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const r of this.layers)t.push(...r.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const r={};let s=0;const i=M6e(e);i&&this.parseWeights(e);for(const o of this.layers)for(const[l,c]of o.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(r[u]!=null)throw new _e(`Duplicate weight name: ${u}`);r[u]=c,s++}const a=[];for(const o in e){let l=o;if(r[o]==null){const c=o.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[l]!=null)a.push([r[l],e[o]]);else if(t)throw new _e(`Provided weight data has no target variable: ${o}`);delete r[l]}if(t){const o=[];for(const l in r)o.push(l);if(o.length>0)throw new _e(`${o.length} of ${s} weights are not set: ${o}`)}A6(a)}parseWeights(e){for(const t in Object.keys(e)){const r=t.split("/"),s=["vars","layer_checkpoint_dependencies"],i=r.map(a=>a.startsWith("_")?a.slice(1):a).filter(a=>!s.includes(a)).join("/");i!==t&&(e[i]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${PQ}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const r=D3(this.updatedConfig());return t?JSON.stringify(r):r}call(e,t){return De(()=>{e=br(e);const r=new Hd;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return Ry(this.outputs,r,t)})}computeMask(e,t){return De(()=>{e=br(e);let r;return t==null?r=vm(null,e.length):r=br(t),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const t=VE(e);if(t.length!==this.inputLayers.length)throw new _e(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let o=0;o<t.length;o++){const l=this.inputLayers[o],c=t[o],u=l.name+"_0_0";r[u]=c}const s=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(ow);if(s.length>1)for(const o of s){const l=this.nodesByDepth[o];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(v=>v.id).indexOf(u.id)!==-1)continue;const d=[];for(let v=0;v<c.inboundLayers.length;v++){const b=c.inboundLayers[v],S=c.nodeIndices[v],T=c.tensorIndices[v],C=`${b.name}_${S}_${T}`,I=r[C];d.push(I)}const p=u.computeOutputShape(Qa(d)),x=VE(p),y=u.inboundNodes.indexOf(c);for(let v=0;v<x.length;v++){const b=`${u.name}_${y}_${v}`;r[b]=x[v]}}}const i=[],a=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],u=this.outputLayersTensorIndices[o],d=`${l.name}_${c}_${u}`;a.push(d)}for(let o=0;o<a.length;o++){const l=a[o];qc(l in r),i.push(r[l])}return Qa(i)}runInternalGraph(e,t){t==null&&(t=vm(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=t[l];r[c.id]=[u,d]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(ow);for(const l of s){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,p=u.inputTensors,x=u.outputTensors,y=new Array;for(const v of p)v.id in r&&y.push(r[v.id]);if(y.length===p.length){let v={},b,S,T,C;if(u.callArgs!=null&&(v=u.callArgs),y.length===1){const[I,$]=y[0];v.mask==null&&(v.mask=$),T=br(d.call(I,v)),C=br(d.computeMask(I,$)),b=[I],S=[$]}else b=y.map(I=>I[0]),S=y.map(I=>I[1]),v.mask==null&&(v.mask=S),T=br(d.call(b,v)),C=br(d.computeMask(b,S));if(d.activityRegularizer)throw new fn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let I=0;I<x.length;++I){const $=x[I],q=T[I],U=C[I];r[$.id]=[q,U]}}}}const i=[],a=[],o=[];for(const l of this.outputs){qc(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=r[l.id];o.push(c.shape),i.push(c),a.push(u)}return[i,a,o]}buildNodeConversionMap(e){const t={};let r;for(const s of this.layers){r=s instanceof tc?1:0;for(let i=0;i<s.inboundNodes.length;i++){const a=tc.nodeKey(s,i);this.containerNodes.has(a)&&(t[a]=r,r+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new _e("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new _e(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new _e(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return De(()=>{const e=[];for(const t of this.layers)for(let r=0;r<t.inboundNodes.length;++r){const s=tc.nodeKey(t,r);this.containerNodes.has(s)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),r=[];for(const a of this.layers){const o=a.getClassName(),l=a.getConfig(),c=[];for(let d=0;d<a.inboundNodes.length;d++){const p=a.inboundNodes[d],x=tc.nodeKey(a,d);let y={};if(this.containerNodes.has(x)){if(p.callArgs)try{JSON.stringify(p.callArgs),y=p.callArgs}catch{console.warn(`Layer ${a.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),y={}}if(p.inboundLayers.length>0){const v=[];for(let b=0;b<p.inboundLayers.length;b++){const S=p.inboundLayers[b],T=p.nodeIndices[b],C=p.tensorIndices[b],I=tc.nodeKey(S,T);let $=t[I];$==null&&($=0),v.push([S.name,$,C,y])}c.push(v)}}}const u={};u.name=a.name,u.className=o,u.config=l,u.inboundNodes=c,r.push(u)}e.layers=r;const s=[];for(let a=0;a<this.inputLayers.length;a++){const o=this.inputLayers[a],l=this.inputLayersNodeIndices[a],c=tc.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let u=t[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[a];s.push([o.name,u,d])}e.inputLayers=s;const i=[];for(let a=0;a<this.outputLayers.length;a++){const o=this.outputLayers[a],l=this.outputLayersNodeIndices[a],c=tc.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let u=t[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[a];i.push([o.name,u,d])}return e.outputLayers=i,e}static fromConfig(e,t,r={},s=!1){const i={},a={};function o(b,S){b.name in a?a[b.name].push(S):a[b.name]=[S]}function l(b,S){const T=[];let C;for(const I of S){const $=I[0],q=I[1],U=I[2];if(C=I[3]==null?{}:I[3],!($ in i)){o(b,S);return}const F=i[$];if(F.inboundNodes.length<=q){o(b,S);return}const G=F.inboundNodes[q];T.push(G.outputTensors[U])}T.length>0&&b.apply(Qa(T),C)}function c(b){const S=b.name,T=_h(b,t.customObjects!=null?t.customObjects:{});T.setFastWeightInitDuringBuild(s),i[S]=T,b.inboundNodes.forEach(I=>{if(!(I instanceof Array))throw new _e(`Corrupted configuration, expected array for nodeData: ${I}`);o(T,I)})}const u=t.name,d=t.layers;for(const b of d)c(b);for(;!_$e(a);)for(const b of d){const S=i[b.name];if(S.name in a){const T=a[S.name];delete a[S.name];for(const C of T)l(S,C)}}const p=[],x=[],y=t.inputLayers;for(const b of y){const S=b[0],T=b[1],C=b[2];qc(S in i);const $=i[S].inboundNodes[T].outputTensors;p.push($[C])}const v=t.outputLayers;for(const b of v){const S=b[0],T=b[1],C=b[2];qc(S in i);const $=i[S].inboundNodes[T].outputTensors;x.push($[C])}return new e({inputs:p,outputs:x,name:u})}get stateful(){if(this._stateful)throw new _e("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){De(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function F6e(n,e,t){const r=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>null);if(r===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==r)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const s=[];return e.forEach(i=>{i in n?s.push(n[i]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${t} must be either an array with ${r} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function OQ(n,e){return F6e(n,e,"classWeight")}async function MQ(n,e,t,r){if(t!=null){const s=De(()=>{if(n.shape.length===1)return Vp(n);if(n.shape.length===2){if(n.shape[1]>1)return C1(n,1);if(n.shape[1]===1)return Ce(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await s.data());In(s);const a=[];return i.forEach(o=>{if(t[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);a.push(t[o])}),bo(a,"float32")}else return null}function B6e(n,e){return Ee(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const z6e=32;function FQ(n,e){let t,r;const s=e;t=s.xs,r=s.ys,ue(t!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=DB("input",n.inputNames,t),a=DB("output",n.outputNames,r),o=i[0].shape[0];ue(i.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),ue(a.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<i.length;l++)ue(i[l].shape[0]===o,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);for(let l=0;l<a.length;l++)ue(a[l].shape[0]===o,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);return{xs:i,ys:a}}function DB(n,e,t){if(t instanceof Ks)return[t];if(Array.isArray(t))return ue(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const r=[];for(const s of e){if(t[s]==null)throw new _e(`The feature data generated by the dataset lacks the required ${n} key '${s}'.`);r.push(t[s])}return r}}function j6e(n){if(n.length===3)throw new fn("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function V6e(n,e,t){const r=t.batchesPerEpoch!=null;if(ue(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),ue(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),ue(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),ue(!r||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),ue(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const s=t.validationData!=null;let i,a;if(s)if($B(t.validationData))ue(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const b=j6e(t.validationData);i=b.xs,a=b.ys}const o=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let c;s?c=l.slice().concat(l.map(b=>"val_"+b)):c=l.slice();const u=AQ(t.callbacks,t.yieldEvery),d=t.verbose==null?1:t.verbose,{callbackList:p,history:x}=NQ(u,d,t.epochs,null,null,U6e(e,t),null,s,c);p.setModel(n),n.history=x,await p.onTrainBegin(),n.stopTraining_=!1;let y=t.initialEpoch==null?0:t.initialEpoch,v=await e.iterator();for(;y<t.epochs;){const b={};await p.onEpochBegin(y);let S=0,T=0;for(r||(v=await e.iterator());!r||S<t.batchesPerEpoch;){const C=await v.next();if(r&&C.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${S} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(C.value!=null){const{xs:I,ys:$}=FQ(n,C.value),q={};q.batch=T,q.size=I[0].shape[0],await p.onBatchBegin(T,q);const U=[];if(t.classWeight!=null){const V=OQ(t.classWeight,n.outputNames);for(let O=0;O<V.length;++O)U.push(await MQ($[O],null,V[O]))}const F=I.concat($).concat(U),G=o(F);In(F);for(let V=0;V<l.length;++V){const O=l[V],K=G[V];q[O]=K,hu(K)}await p.onBatchEnd(T,q),CQ(q),T++,S++}if(r?S>=t.batchesPerEpoch:C.done){if(s){let I;$B(t.validationData)?I=br(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):I=br(n.evaluate(i,a,{batchSize:t.validationBatchSize==null?z6e:t.validationBatchSize,verbose:0}));for(let $=0;$<n.metricsNames.length;++$)b[`val_${n.metricsNames[$]}`]=I[$]}break}if(n.stopTraining_)break}if(await p.onEpochEnd(y,b),y++,n.stopTraining_)break}return await p.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function U6e(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function $B(n){return typeof n.iterator=="function"}function G6e(n){return typeof n.next=="function"}async function H6e(n,e,t){t=t||{};const r=t.batches!=null,s=n.testFunction;let i=[];if(t.verbose>0)throw new fn("Verbose mode is not implemented yet.");ue(!r||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const a=G6e(e)?e:await e.iterator();let o=0,l=0;for(;!r||l<t.batches;){const c=await a.next();if(i=De(()=>{if(c.value){const{xs:u,ys:d}=FQ(n,c.value),p=u.concat(d),x=De(()=>s(p));if(In(p),l===0)for(let v=0;v<x.length;++v)i.push(mr(0));const y=p[0].shape[0];for(let v=0;v<x.length;++v){const b=x[v],S=i[v];i[v]=De(()=>tt(i[v],Ee(y,b))),l>0&&In(S)}In(x),o+=y,++l}return i}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=Pt(i[c],o),In(u)}return Qa(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rk(n){ue(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function gy(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(r=>Gp(r,e,t-e)):Gp(n,e,t-e)}function $3(n,e){return De(()=>n==null?null:Array.isArray(n)?n.map(t=>$3(t,e)):dQ(n,e.dtype==="int32"?e:mt(e,"int32")))}function Dk(n,e){const t=[];let r=0,s=null;for(;r<n;)s=r+e,s>=n&&(s=n),t.push([r,s]),r=s;return t}function BQ(n){const e=[];n instanceof Ks&&(n=[n]);for(let t=0;t<n.length;++t){const r=n[t];if(r.rank===1)e.push(Av(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function Ql(n,e){if(n==null)return;const t=[];if(e instanceof Ks)t.push(e.id);else if(Array.isArray(e))e.forEach(s=>t.push(s.id));else if(e!=null)for(const s in e){const i=e[s];t.push(i.id)}const r=[];if(n instanceof Ks)t.indexOf(n.id)===-1&&r.push(n);else if(Array.isArray(n))n.forEach(s=>{t.indexOf(s.id)===-1&&r.push(s)});else if(n!=null)for(const s in n){const i=n[s];t.indexOf(i.id)===-1&&r.push(i)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function W6e(n){return n instanceof Ks}function L3(n){return Array.isArray(n)}function LB(n){return!W6e(n)&&!L3(n)}function PB(n,e,t,r=!0,s=""){if(e==null||e.length===0){if(n!=null){let a=!1;if(L3(n)&&n.length>0)a=!0;else if(LB(n)){for(const o in n)if(n.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new _e(`Error when checking model ${s} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(a=>null);let i;if(LB(n)){n=n,i=[];for(const a of e){if(n[a]==null)throw new _e(`No data provided for "${a}". Need data for each key in: ${e}`);i.push(n[a])}}else if(L3(n)){if(n=n,n.length!==e.length)throw new _e(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);i=n}else{if(n=n,e.length>1)throw new _e(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);i=[n]}if(i=BQ(i),t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const o=i[a];if(o.shape.length!==t[a].length)throw new _e(`Error when checking ${s}: expected ${e[a]} to have ${t[a].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<t[a].length;++l){if(l===0&&!r)continue;const c=o.shape[l],u=t[a][l];if(u!=null&&u>=0&&c!==u)throw new _e(`${s} expected a batch of elements where each example has shape [${t[a].slice(1,t[a].length)}] (i.e.,tensor shape [*,${t[a].slice(1,t[a].length)}]) but the ${s} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return i}function q6e(n,e,t){const r=ef(n.map(i=>i.shape[0]));r.sort();const s=ef(e.map(i=>i.shape[0]));if(s.sort(),r.length>1)throw new _e(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(i=>i.shape))}`);if(s.length>1)throw new _e(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&s.length>0&&!gr(r,s))throw new _e(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function K6e(n,e,t){const r=[wC,EC,D1];for(let s=0;s<n.length;++s){const i=n[s],a=e[s],o=t[s];if(a!=null){if(a===D1&&i.shape[i.shape.length-1]===1)throw new _e(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(a)!==-1){const l=i.shape.slice(1),c=o.slice(1);for(let u=0;u<l.length;++u){const d=l[u],p=c[u];if(p!=null&&d!==p)throw new _e(`A target Tensor with shape ${i.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function OB(n,e,t,r=!0,s=""){let i;if(Array.isArray(n)){if(n.length!==e.length)throw new _e(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);i=n}else{if(e.length>1)throw new _e(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);i=[n]}if(t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const o=i[a];if(o.shape.length!==t[a].length)throw new _e(`Error when checking ${s}: expected ${e[a]} to have ${t[a].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<t[a].length;++l){if(l===0&&!r)continue;const c=o.shape[l],u=t[a][l];if(u!=null&&u!==c)throw new _e(`Error when checking ${s}: expected ${e[a]} to have shape ${JSON.stringify(t[a])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function X6e(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(r=>t);{const r=[];for(const s of e){let i=t.hasOwnProperty(s)?t[s]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const Y6e="layers-model";class lg extends tc{constructor(e){super(e),this.isTraining=!1}summary(e,t,r=console.log){if(!this.built)throw new _e("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");D6e(this,e,t,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=R6e(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof zf))throw new _e("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new _e(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),t.push(Ik(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new _e(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(o=>Ik(o))}else{const a=Ik(e.loss);this.outputs.forEach(o=>{t.push(a)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const o=this.internalOutputShapes[a],l=this.outputNames[a];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[a])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Up("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([o,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});const s=X6e(e.metrics,this.outputNames),i=(a,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[a]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,a])};Up("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=s[a];(c=>{let d,p,x;for(const y of c){if(typeof y=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(y)!==-1){const b=this.internalOutputShapes[a];b[b.length-1]===1||this.lossFunctions[a]===EC?["accuracy","acc"].indexOf(y)!==-1?p=IQ:["crossentropy","ce"].indexOf(y)!==-1&&(p=_6e):this.lossFunctions[a]===qE?["accuracy","acc"].indexOf(y)!==-1?p=w6e:["crossentropy","ce"].indexOf(y)!==-1&&(p=$Q):["accuracy","acc"].indexOf(y)!==-1?p=RQ:["crossentropy","ce"].indexOf(y)!==-1&&(p=DQ);let S;["accuracy","acc"].indexOf(y)!==-1?S="acc":["crossentropy","ce"].indexOf(y)!==-1&&(S="ce"),x=p,d=""+S}else x=I6e(y),d=""+uw(y);let v;Up(d,()=>{v=x}),i(a,d,v)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,r={}){const s=r.batchSize==null?32:r.batchSize;Rk(s);const a=this.standardizeUserDataXY(e,t,!0,s);try{const o=a[0].concat(a[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,o,s,r.verbose,r.steps);return Qa(c)}finally{Ql(a[0],e),Ql(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),H6e(this,e,t)}checkNumSamples(e,t,r,s="steps"){let i;if(r!=null){if(i=null,t!=null)throw new _e(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new _e(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new _e("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(t),s=r?t:[t],i=this.retrieveSymbolicTensors(s),a=new Hd;if(e instanceof Ks&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new _e(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)a.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new _e(`No value is provided for the model's input ${l.name}`);a.add(l,c)}const o=Ry(i,a);return r?o:o[0]}retrieveSymbolicTensors(e){const t=vm(null,e.length);let r=e.length;for(const s of this.layers){const i=Array.isArray(s.output)?s.output:[s.output],a=i.map(o=>o.name);for(let o=0;o<e.length;++o){const l=a.indexOf(e[o]);if(l!==-1&&(t[o]=i[l],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw t.forEach((i,a)=>{i==null&&s.push(e[a])}),new _e(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return t}predictLoop(e,t=32,r=!1){return De(()=>{const s=this.checkNumSamples(e);if(r)throw new fn("Verbose predictLoop() is not implemented yet.");const i=Dk(s,t),a=this.outputs.map(o=>[]);for(let o=0;o<i.length;++o)De(()=>{const c=i[o][0],u=i[o][1],d=gy(e,c,u),p=[];if(Array.isArray(d))for(let y=0;y<d.length;++y)p.push({key:this.inputs[y],value:d[y]});else p.push({key:this.inputs[0],value:d});const x=new Hd(p);return Ry(this.outputs,x)}).forEach((c,u)=>a[u].push(c));return Qa(a.map(o=>eo(o,0)))})}predict(e,t={}){const r=BQ(e);OB(r,this.inputNames,this.feedInputShapes,!1);try{const s=t.batchSize==null?32:t.batchSize;return Rk(s),this.predictLoop(r,s)}finally{Ql(r,e)}}predictOnBatch(e){OB(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,r=!0,s){if(this.optimizer_==null)throw new Nl("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let a=0;a<this.feedOutputShapes.length;++a){const o=this.feedOutputShapes[a];this.feedLossFns[a]===qE?i.push(o.slice(0,o.length-1).concat([1])):i.push(o)}if(e=PB(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=PB(t,this.feedOutputNames,i,!1,"target"),q6e(e,t),K6e(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new _e(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,r,s,i=!0,a){const[o,l]=this.standardizeUserDataXY(e,t,i,a);if(r!=null)throw new Error("sample weight is not supported yet.");let c=null;if(s!=null){const u=OQ(s,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await MQ(l[d],null,u[d]))}return[o,l,c]}testLoop(e,t,r,s=0,i){return De(()=>{const a=this.checkNumSamples(t,r,i,"steps"),o=[];if(s>0)throw new fn("Verbose mode is not implemented yet.");if(i!=null)throw new fn("steps mode in testLoop() is not implemented yet");{const l=Dk(a,r),c=bo(yc(0,a));for(let u=0;u<l.length;++u){const d=l[u][0],p=l[u][1],x=Gp(c,d,p-d),y=$3(t,x),v=e(y);if(u===0)for(let b=0;b<v.length;++b)o.push(mr(0));for(let b=0;b<v.length;++b){const S=v[b];o[b]=tt(o[b],Ee(p-d,S))}}for(let u=0;u<o.length;++u)o[u]=Pt(o[u],a)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let r=0;r<e.length;++r){const s=e[r];let i=s;if(vB(e,s)>1){const a=vB(e.slice(0,r),s);i+=`_${a}`}t.push(i)}return t}makeTrainFunction(){return e=>{const t=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],o=()=>{const d=[];for(let v=0;v<this.inputs.length;++v)d.push({key:this.inputs[v],value:r[v]});const p=new Hd(d),x=Ry(this.outputs,p,{training:!0});let y;for(let v=0;v<this.lossFunctions.length;++v){const b=this.lossFunctions[v];let S=b(s[v],x[v]);i[v]!=null&&(S=B6e(S,i[v]));const T=Fs(S);t.push(T),v===0?y=S:y=tt(y,S)}for(let v=0;v<this.metricsTensors.length;++v){let b;if(this.outputs.length>1&&v<this.outputs.length)b=t[v];else{const S=this.metricsTensors[v][0],T=this.metricsTensors[v][1];b=Fs(S(s[T],x[T]))}hu(b),a.push(b)}return y=Fs(y),this.calculateLosses().forEach(v=>{y=tt(y,v)}),y},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(o,!0,l)].concat(a)}}makeTestFunction(){this.testFunction=e=>De(()=>{const t=[];let r;const s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let c=0;c<this.inputs.length;++c)a.push({key:this.inputs[c],value:s[c]});const o=new Hd(a),l=Ry(this.outputs,o);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=Fs(u(i[c],l[c]));c===0?r=d:r=tt(r,d),t.push(r)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],p=Fs(u(i[d],l[d]));t.push(p)}return t})}async fit(e,t,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,i,a,o,l,c,u,d,p;try{const x=r.batchSize==null?32:r.batchSize;Rk(x);const v=await this.standardizeUserData(e,t,r.sampleWeight,r.classWeight,!1,x);s=v[0],i=v[1],p=v[2];let b=!1,S;if(r.validationData!=null&&r.validationData.length>0){if(b=!0,r.validationData.length===2)l=r.validationData[0],c=r.validationData[1];else throw r.validationData.length===3?new fn("validationData including sample weights is not supported yet."):new _e(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const V=await this.standardizeUserData(l,c,null,null,!0,x);u=V[0],d=V[1],S=u.concat(d)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){b=!0;const G=Math.floor(s[0].shape[0]*(1-r.validationSplit)),V=s[0].shape[0];u=gy(s,G,V),a=s,s=gy(s,0,G),d=gy(i,G,V),o=i,i=gy(i,0,G),S=u.concat(d)}else r.validationSteps!=null&&(b=!0);const T=s.concat(i).concat(p);this.checkTrainableWeightsConsistency();const C=this.makeTrainFunction(),I=this.getDedupedMetricsNames();let $,q;b?(this.makeTestFunction(),$=this.testFunction,q=I.slice().concat(I.map(G=>"val_"+G))):($=null,S=[],q=I.slice());const U=AQ(r.callbacks,r.yieldEvery);return await this.fitLoop(C,T,I,x,r.epochs,r.verbose,U,$,S,r.shuffle,q,r.initialEpoch,null,null)}finally{this.isTraining=!1,Ql(s,e),Ql(i,t),Ql(a,e),Ql(o,t),Ql(u,l),Ql(d,c),p!=null&&In(p)}}async fitLoop(e,t,r,s,i,a,o,l,c,u,d,p,x,y){s==null&&(s=32),i==null&&(i=1),u==null&&(u=!0),p==null&&(p=0);let v=!1;if(l!=null&&c!=null&&(v=!0),y!=null&&(v=!0,x==null))throw new _e("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const b=this.checkNumSamples(t,s,x,"steps_per_epoch");let S;b!=null&&(S=yc(0,b)),a==null&&(a=1);const{callbackList:T,history:C}=NQ(o,a,i,p,b,x,s,v,d);T.setModel(this),this.history=C,await T.onTrainBegin(),this.stopTraining_=!1;for(let I=p;I<i;++I){await T.onEpochBegin(I);const $={};if(x!=null)throw new fn("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new fn("batch shuffling is not implemneted yet");u&&JCe(S);const q=bo(S),U=Dk(b,s);for(let F=0;F<U.length;++F){const G={};if(await T.onBatchBegin(F,G),De(()=>{const V=U[F][0],O=U[F][1],K=Gp(q,V,O-V);G.batch=F,G.size=O-V;const P=$3(t,K),N=e(P);for(let M=0;M<r.length;++M){const B=r[M],Y=N[M];G[B]=Y,hu(Y)}if(F===U.length-1&&v){const M=this.testLoop(l,c,s);for(let B=0;B<r.length;++B){const Y=r[B],Z=M[B];hu(Z),$["val_"+Y]=Z}}}),await T.onBatchEnd(F,G),CQ(G),this.stopTraining_)break}q.dispose()}if(await T.onEpochEnd(I,$),this.stopTraining_)break}return await T.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return V6e(this,e,t)}async trainOnBatch(e,t){const r=await this.standardizeUserData(e,t),s=r[0],i=r[1],o=this.makeTrainFunction()(s.concat(i)),l=[];for(const c of o){const u=await c.data();l.push(u[0])}return In(o),Ql(r[0],e),Ql(r[1],t),Qa(l)}getNamedWeights(e){const t=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let a=0;a<s.length;++a)r&&!s[a].trainable||t.push({name:s[a].originalName,tensor:i[a]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=nB().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-nB().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=oh(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>oh(t))}else{const t=Object.keys(this.loss);e={};const r=this.loss;for(const s of t)if(typeof r[s]=="string")e[s]=oh(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[oh(uw(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>oh(uw(e)));{const e={};for(const t in this.metrics)e[t]=oh(uw(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=R3(e.optimizer_config),r=_h(t);let s;if(typeof e.loss=="string")s=Ap(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(a=>Ap(a));else if(e.loss!=null){s={};for(const a in e.loss)s[a]=Ap(e.loss[a])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(a=>Ap(a));else if(e.metrics!=null){i={};for(const a in e.metrics)i[a]=Ap(e.metrics[a])}this.compile({loss:s,metrics:i,optimizer:r})}async save(e,t){if(typeof e=="string"){const c=WAe(e);if(c.length===0)throw new _e(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new _e(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new _e("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await sB(this.getNamedWeights(t)),o={modelTopology:this.toJSON(null,!1),format:Y6e,generatedBy:`TensorFlow.js tfjs-layers v${PQ}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await sB(await this.optimizer.getWeights(),c);r.specs.push(...d),r.data=HAe([r.data,u])}return this.userDefinedMetadata!=null&&(RB(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=r.data,o.weightSpecs=r.specs,e.save(o)}setUserDefinedMetadata(e){RB(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}lg.className="Model";et(lg);class zQ extends lg{}zQ.className="Functional";et(zQ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $1 extends lg{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:bC("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new _e(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof $1||e instanceof lg;let r;if(t){if(r=e,r.outputs.length!==1)throw new _e("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new _e("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new _e("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=Q$e({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(t)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new _e(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new _e("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=_Q(this.outputs[0])}this.inboundNodes=[],new _C({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:vm(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(or(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new lg({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,r=console.log){this.built||this.build(),super.summary(e,t,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,r={}){if(!this.built)throw new Nl("The model needs to be compiled before being used.");return this.model.evaluate(e,t,r)}async evaluateDataset(e,t){if(!this.built)throw new Nl("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,r={}){if(!this.built)throw new Nl("The model needs to be compiled before being used.");return this.model.fit(e,t,r)}async fitDataset(e,t){if(!this.built)throw new Nl("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,r={},s=!1){let i,a={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new _e("Legacy serialization format not supported yet.");i=t}else ue(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=t.layers,delete t.layers,a=t;const o=new e(a);if(!(o instanceof $1))throw new fn(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of i){const u=_h(l,void 0,s);s&&u.setFastWeightInitDuringBuild(!0),o.add(u)}return o}set stopTraining(e){if(this.model==null)throw new _e("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new _e("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const r={};r.className=t.getClassName(),r.config=t.getConfig(),e.push(r)}return{name:this.name,layers:e}}}$1.className="Sequential";et($1);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let ia=class extends ox{getConfig(){return{}}};class jQ extends ia{apply(e,t=1){return O$e(e,t)}}jQ.className="elu";et(jQ);class VQ extends ia{apply(e){return iZ(e)}}VQ.className="selu";et(VQ);class UQ extends ia{apply(e){return $m(e)}}UQ.className="relu";et(UQ);class GQ extends ia{apply(e){return De(()=>k1(6,$m(e)))}}GQ.className="relu6";et(GQ);class HQ extends ia{apply(e){return e}}HQ.className="linear";et(HQ);class WQ extends ia{apply(e){return sx(e)}}WQ.className="sigmoid";et(WQ);class qQ extends ia{apply(e){return F$e(e)}}qQ.className="hardSigmoid";et(qQ);class KQ extends ia{apply(e){return bv(e)}}KQ.className="softplus";et(KQ);class XQ extends ia{apply(e){return M$e(e)}}XQ.className="softsign";et(XQ);class YQ extends ia{apply(e){return cC(e)}}YQ.className="tanh";et(YQ);let R6=class extends ia{apply(e,t=-1){return L$(e,t)}};R6.className="softmax";et(R6);class ZQ extends ia{apply(e,t=-1){return ZY(e,t)}}ZQ.className="logSoftmax";et(ZQ);class QQ extends ia{apply(e){return De(()=>De(()=>{const t=Math.sqrt(2),r=Ee(.5,tt(1,WY(Pt(e,t))));return Ee(e,r)}))}}QQ.className="gelu";et(QQ);class JQ extends ia{apply(e){return De(()=>Ee(.5,Ee(e,tt(1,cC(Ee(ta(Pt(2,Math.PI)),tt(e,Ee(.044715,xm(e,3)))))))))}}JQ.className="gelu_new";et(JQ);class eJ extends ia{apply(e){return De(()=>Ee(e,cC(bv(e))))}}eJ.className="mish";et(eJ);class tJ extends ia{apply(e,t=1){return De(()=>Ee(sx(Ee(e,t)),e))}}tJ.className="swish";et(tJ);function vf(n){return n.getClassName()}function $k(n,e={}){return Cv(n,Cl.getMap().classNameMap,e,"activation")}function _f(n){if(n==null){const e={};return e.className="linear",e.config={},$k(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},$k(e)}else return n instanceof ia?n:$k(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Z6e(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class nJ extends ox{}class rJ extends nJ{constructor(e){super(),Z6e(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return De(()=>{let t=fi([1]);return this.hasL1&&(t=tt(t,$t(Ee(this.l1,ba(e))))),this.hasL2&&(t=tt(t,$t(Ee(this.l2,Nv(e))))),Ce(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}rJ.className="L1L2";et(rJ);const MB={l1l2:"L1L2"};function Rr(n){return x6(n)}function FB(n,e={}){return Cv(n,Cl.getMap().classNameMap,e,"regularizer")}function Jr(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in MB?MB[n]:n,config:{}};return FB(t)}else return n instanceof nJ?n:FB(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sJ extends Tn{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=Wt(e);let r=$m(e);return this.maxValue!=null&&(r=tl(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}sJ.className="ReLU";et(sJ);class iJ extends Tn{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const r=Wt(e);return T$(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}iJ.className="LeakyReLU";et(iJ);class aJ extends Tn{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Zr(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Jr(e.alphaRegularizer),this.alphaConstraint=ei(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new _e(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=or(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)t[s-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new Qs({ndim:e.length,axes:r})],this.built=!0}call(e,t){return e=Wt(e),R$(e,this.alpha.read())}getConfig(){const e={alphaInitializer:is(this.alphaInitializer),alphaRegularizer:Rr(this.alphaRegularizer),alphaConstraint:Js(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}aJ.className="PReLU";et(aJ);let oJ=class extends Tn{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new fn(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const r=Wt(e);return dC(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};oJ.className="ELU";et(oJ);class lJ extends Tn{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const r=Wt(e);return Ee(r,mt(rl(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}lJ.className="ThresholdedReLU";et(lJ);class cJ extends Tn{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new R6().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return De(()=>{let r=Wt(e);const s=t.mask;if(s!=null){const i=Ee(Vt(Bf(r.shape),mt(s,r.dtype)),mr(-1e9));r=tt(r,i)}return this.axis instanceof Array?this.axis.length>1?Tu(Vt(r,QY(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}cJ.className="Softmax";et(cJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cg(n,e,t){if(typeof n=="number")return vm(n,e);if(n.length!==e)throw new _e(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let r=0;r<e;++r){const s=n[r];if(!D$e(s))throw new _e(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${s}`)}return n}function pc(n,e,t,r,s=1){if(n==null)return n;const i=e+(e-1)*(s-1);let a;return t==="same"?a=n:a=n-i+1,Math.floor((a+r-1)/r)}function Kc(n,e,t,r){if(n==null)return null;if(r==="valid")n=n*e+bf([t-e,0]);else if(r==="same")n=n*e;else throw new _e(`Unsupport padding mode: ${r}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function D6(n,e){return De(()=>(As(e),e==="channelsFirst"?Qn(n,[0,2,3,1]):n))}function uJ(n,e){return De(()=>(As(e),e==="channelsFirst"?Qn(n,[0,2,3,4,1]):n))}function Q6e(n,e,t,r=1,s="valid",i,a=1){return De(()=>{if(i==null&&(i=bc()),As(i),n.shape.length!==3)throw new _e(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new _e(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new _e(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(i==="channelsFirst"&&(n=Qn(n,[0,2,1])),s==="causal")throw new fn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=jY(n,e,r,s==="same"?"same":"valid","NWC",a);return t!=null&&(o=wc(o,t)),o})}function BB(n,e,t,r=[1,1],s="valid",i,a,o=null){return De(()=>{if(i==null&&(i=bc()),As(i),n.rank!==3&&n.rank!==4)throw new _e(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new _e(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=D6(n,i);if(s==="causal")throw new fn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=o4e({x:l,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:t,activation:o}),i==="channelsFirst"&&(l=Qn(l,[0,3,1,2])),l})}function J6e(n,e,t,r=[1,1,1],s="valid",i,a){return De(()=>{if(i==null&&(i=bc()),As(i),n.rank!==4&&n.rank!==5)throw new _e(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new _e(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let o=uJ(n,i);if(s==="causal")throw new fn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=wke(o,e,r,s==="same"?"same":"valid","NDHWC",a),t!=null&&(o=wc(o,t)),i==="channelsFirst"&&(o=Qn(o,[0,4,1,2,3])),o})}class SC extends Tn{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",SC.verifyArgs(t),this.rank=e,mi(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new fn(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=cg(t.kernelSize,e,"kernelSize"),this.strides=cg(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,sl(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,As(this.dataFormat),this.activation=_f(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=Zr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=ei(t.biasConstraint),this.biasRegularizer=Jr(t.biasRegularizer),this.activityRegularizer=Jr(t.activityRegularizer),this.dilationRate=cg(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new _e(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new _e(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new _e(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(qc("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!y6(e.kernelSize,"number",1,3))throw new _e(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:vf(this.activation),useBias:this.useBias,biasInitializer:is(this.biasInitializer),biasRegularizer:Rr(this.biasRegularizer),activityRegularizer:Rr(this.activityRegularizer),biasConstraint:Js(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class lx extends SC{constructor(e,t){super(e,t),this.kernel=null,lx.verifyArgs(t),this.filters=t.filters,mi(this.filters,"filters"),this.kernelInitializer=Zr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=ei(t.kernelConstraint),this.kernelRegularizer=Jr(t.kernelRegularizer)}build(e){e=or(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new _e(`The channel dimension of the input should be defined. Found ${e[t]}`);const r=e[t],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:r}}],this.built=!0}call(e,t){return De(()=>{e=Wt(e);let r;const s=this.bias==null?null:this.bias.read(),i=aQ(this.activation.getClassName());if(i!=null&&this.rank===2)r=BB(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=Q6e(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=BB(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=J6e(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new fn("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=or(e);const t=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const a=pc(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);t.push(a)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(t),s.push(this.filters)):(s.push(this.filters),s=s.concat(t)),s}getConfig(){const e={filters:this.filters,kernelInitializer:is(this.kernelInitializer),kernelRegularizer:Rr(this.kernelRegularizer),kernelConstraint:Js(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new _e(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Dv extends lx{constructor(e){super(2,e),Dv.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!y6(e.kernelSize,"number",1,2))throw new _e(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Dv.className="Conv2D";et(Dv);class $v extends lx{constructor(e){super(3,e),$v.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new _e(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}$v.className="Conv3D";et($v);class hJ extends Dv{constructor(e){if(super(e),this.inputSpec=[new Qs({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new _e(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=or(e),e.length!==4)throw new _e("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new _e("The channel dimension of the inputs should be defined. Found `None`.");const r=e[t],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Qs({ndim:4,axes:{[t]:r}})],this.built=!0}call(e,t){return De(()=>{let r=Wt(e);if(r.shape.length!==4)throw new _e(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let a,o;this.dataFormat==="channelsFirst"?(a=2,o=3):(a=1,o=2);const l=s[a],c=s[o],u=this.kernelSize[0],d=this.kernelSize[1],p=this.strides[0],x=this.strides[1],y=Kc(l,p,u,this.padding),v=Kc(c,x,d,this.padding),b=[i,y,v,this.filters];this.dataFormat!=="channelsLast"&&(r=Qn(r,[0,2,3,1]));let S=VY(r,this.kernel.read(),b,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=Qn(S,[0,3,1,2])),this.bias!=null&&(S=wc(S,this.bias.read(),this.dataFormat)),this.activation!=null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=or(e);const t=e.slice();let r,s,i;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3):(r=3,s=1,i=2);const a=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return t[r]=this.filters,t[s]=Kc(t[s],l,a,this.padding),t[i]=Kc(t[i],c,o,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}hJ.className="Conv2DTranspose";et(hJ);class dJ extends $v{constructor(e){if(super(e),this.inputSpec=[new Qs({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new _e(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=or(e),e.length!==5)throw new _e("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new _e("The channel dimension of the inputs should be defined. Found `None`.");const r=e[t],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Qs({ndim:5,axes:{[t]:r}})],this.built=!0}call(e,t){return De(()=>{let r=Wt(e);if(r.shape.length!==5)throw new _e(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let a,o,l;this.dataFormat==="channelsFirst"?(l=2,a=3,o=4):(l=1,a=2,o=3);const c=s[l],u=s[a],d=s[o],p=this.kernelSize[0],x=this.kernelSize[1],y=this.kernelSize[2],v=this.strides[0],b=this.strides[1],S=this.strides[2],T=Kc(c,v,p,this.padding),C=Kc(u,b,x,this.padding),I=Kc(d,S,y,this.padding),$=[i,T,C,I,this.filters];this.dataFormat!=="channelsLast"&&(r=Qn(r,[0,2,3,4,1]));let q=Tke(r,this.kernel.read(),$,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(q=Qn(q,[0,4,1,2,3])),this.bias!==null&&(q=wc(q,this.bias.read(),this.dataFormat)),this.activation!==null&&(q=this.activation.apply(q)),q})}computeOutputShape(e){e=or(e);const t=e.slice();let r,s,i,a;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3,a=4):(r=4,s=1,i=2,a=3);const o=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],p=this.strides[2];return t[r]=this.filters,t[s]=Kc(t[s],u,o,this.padding),t[i]=Kc(t[i],d,l,this.padding),t[a]=Kc(t[a],p,c,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}dJ.className="Conv3DTranspose";et(dJ);class fJ extends lx{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new _e("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new _e("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new _e(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Zr(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Jr(t.depthwiseRegularizer),this.depthwiseConstraint=ei(t.depthwiseConstraint),this.pointwiseInitializer=Zr(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Jr(t.pointwiseRegularizer),this.pointwiseConstraint=ei(t.pointwiseConstraint)}build(e){if(e=or(e),e.length<this.rank+2)throw new _e(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new _e(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const r=e[t],s=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let o=0;o<this.rank;++o)i.push(1);i.push(r*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new Qs({ndim:this.rank+2,axes:{[t]:r}})],this.built=!0}call(e,t){return De(()=>{e=Wt(e);let r;if(this.rank===1)throw new fn("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Qn(e,[0,2,3,1])),r=aZ(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=wc(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Qn(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=is(this.depthwiseInitializer),e.pointwiseInitializer=is(this.pointwiseInitializer),e.depthwiseRegularizer=Rr(this.depthwiseRegularizer),e.pointwiseRegularizer=Rr(this.pointwiseRegularizer),e.depthwiseConstraint=Js(this.depthwiseConstraint),e.pointwiseConstraint=Js(this.pointwiseConstraint),e}}fJ.className="SeparableConv";class pJ extends fJ{constructor(e){super(2,e)}}pJ.className="SeparableConv2D";et(pJ);class TC extends lx{constructor(e){super(1,e),TC.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!y6(e.kernelSize,"number",1,1))throw new _e(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}TC.className="Conv1D";et(TC);class mJ extends Tn{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return De(()=>{if(e=Wt(e),this.dataFormat==="channelsLast"){const r=cw(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return cw(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=cw(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return cw(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}mJ.className="Cropping2D";et(mJ);class gJ extends Tn{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,As(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,k$e(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,r]}else{const t=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],t,r,e[3]]}}call(e,t){return De(()=>{let r=Wt(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=Qn(r,[0,2,3,1]);const i=this.size[0]*s[2],a=this.size[1]*s[3],o=this.interpolation==="nearest"?mh.resizeNearestNeighbor(r,[i,a]):mh.resizeBilinear(r,[i,a]);return Qn(o,[0,3,1,2])}else{const i=this.size[0]*s[1],a=this.size[1]*s[2];return this.interpolation==="nearest"?mh.resizeNearestNeighbor(r,[i,a]):mh.resizeBilinear(r,[i,a])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}gJ.className="UpSampling2D";et(gJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function eLe(n,e,t=[1,1],r="valid",s,i){return De(()=>{s==null&&(s=bc()),As(s);let a=D6(n,s);if(n.rank!==4)throw new _e(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new _e(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return a=_$(a,e,t,r==="same"?"same":"valid","NHWC",i),s==="channelsFirst"&&(a=Qn(a,[0,3,1,2])),a})}class xJ extends SC{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Zr(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=ei(e.depthwiseConstraint),this.depthwiseRegularizer=Jr(e.depthwiseRegularizer)}build(e){if(e=or(e),e.length<4)throw new _e(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new _e(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const r=e[t],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return De(()=>{e=Wt(e);let r=eLe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=wc(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=or(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=pc(t,this.kernelSize[0],this.padding,this.strides[0]),a=pc(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,a]:[e[0],i,a,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=is(this.depthwiseInitializer),e.depthwiseRegularizer=Rr(this.depthwiseRegularizer),e.depthwiseConstraint=Js(this.depthwiseRegularizer),e}}xJ.className="DepthwiseConv2D";et(xJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yJ(n,e,t,r){if(Array.isArray(n)){if(e!=null||t!=null)throw new _e("When inputs is an array, neither initialState or constants should be provided");r!=null&&(t=n.slice(n.length-r,n.length),n=n.slice(0,n.length-r)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function s(i){return i==null||Array.isArray(i)?i:[i]}return e=s(e),t=s(t),{inputs:n,initialState:e,constants:t}}function bJ(n,e,t,r=!1,s,i,a=!1,o=!1){return De(()=>{const l=e.shape.length;if(l<3)throw new _e(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(yc(2,l));e=Qn(e,c),a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=mt(mt(s,"bool"),"float32"),s.rank===l-1&&(s=Za(s,-1)),s=Qn(s,c)),r&&(e=ym(e,0),s!=null&&(s=ym(s,0)));const u=[];let d,p=t;const x=e.shape[0],y=bm(e);let v;s!=null&&(v=bm(s));for(let S=0;S<x;++S){const T=y[S],C=De(()=>n(T,p));if(s==null)d=C[0],p=C[1];else{const I=De(()=>{const $=v[S],q=Vt($l($),$),U=tt(Ee(C[0],$),Ee(p[0],q)),F=p.map((G,V)=>tt(Ee(C[1][V],$),Ee(G,q)));return{output:U,newStates:F}});d=I.output,p=I.newStates}o&&u.push(d)}let b;return o&&(b=Ih(u,1)),[d,b,p]})}class jf extends Tn{constructor(e){super(e);let t;if(e.cell==null)throw new _e("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new P6({cells:e.cell}):t=e.cell,t.stateSize==null)throw new _e("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Qs({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return yc(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){N3(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const r=t[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const i=[];for(const a of t)i.push([e[0],a]);return[s].concat(i)}else return s}computeMask(e,t){return De(()=>{Array.isArray(t)&&(t=t[0]);const r=this.returnSequences?t:null;if(this.returnState){const s=this.states.map(i=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let r=0;r<e;++r)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new fn("Constants support is not implemented in RNN yet.");N3(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Qs({shape:[t,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!gr(this.stateSpec.map(a=>a.shape[a.shape.length-1]),i))throw new _e(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(a=>new Qs({shape:[null,a]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){De(()=>{if(!this.stateful)throw new Wc("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new _e("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>fi([r,s])):this.states_=[fi([r,this.cell.stateSize])];else if(e==null)In(this.states_),this.keptStates!=null&&(In(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>fi([r,s])):this.states_[0]=fi([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new _e(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):In(this.states_);for(let s=0;s<this.states_.length;++s){const i=e[s],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,o=[r,a];if(!gr(i.shape,o))throw new _e(`State ${s} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>hu(s.clone()))})}apply(e,t){let r=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const i=yJ(e,r,s,this.numConstants);e=i.inputs,r=i.initialState,s=i.constants;let a=[],o=[];if(r!=null){t.initialState=r,a=a.concat(r),this.stateSpec=[];for(const c of r)this.stateSpec.push(new Qs({shape:c.shape}));o=o.concat(this.stateSpec)}if(s!=null&&(t.constants=s,a=a.concat(s),this.numConstants=s.length),a[0]instanceof Au){const c=[e].concat(a),u=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=u;const p=super.apply(c,t);return this.inputSpec=d,p}else return super.apply(e,t)}call(e,t){return De(()=>{const r=t==null?null:t.mask,s=t==null?null:t.training;let i=t==null?null:t.initialState;e=Wt(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new _e(`RNN Layer has ${a} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:s},c=bJ((y,v)=>{const b=this.cell.call([y].concat(v),o);return[b[0],b.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),u=c[0],d=c[1],p=c[2];this.stateful&&this.resetStates(p,s);const x=this.returnSequences?d:u;return this.returnState?[x].concat(p):x})}getInitialState(e){return De(()=>{let t=fi(e.shape);return t=$t(t,[1,2]),t=Av(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?C3(t,[1,r]):t):this.cell.stateSize>1?[C3(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===jf.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),t)}static fromConfig(e,t,r={}){const s=t.cell,i=_h(s,r);return new e(Object.assign(t,{cell:i}))}}jf.className="RNN";et(jf);class CC extends Tn{}class $6 extends CC{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,mi(this.units,"units"),this.activation=_f(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Zr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Zr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Zr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Jr(e.kernelRegularizer),this.recurrentRegularizer=Jr(e.recurrentRegularizer),this.biasRegularizer=Jr(e.biasRegularizer),this.kernelConstraint=ei(e.kernelConstraint),this.recurrentConstraint=ei(e.recurrentConstraint),this.biasConstraint=ei(e.biasConstraint),this.dropout=kg([1,bf([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=kg([1,bf([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=or(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return De(()=>{if(e=e,e.length!==2)throw new _e(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=wf({ones:()=>$l(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=wf({ones:()=>$l(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i;const a=this.dropoutMask,o=this.recurrentDropoutMask;a!=null?i=pu(Ee(e,a),this.kernel.read()):i=pu(e,this.kernel.read()),this.bias!=null&&(i=wc(i,this.bias.read())),o!=null&&(r=Ee(r,o));let l=tt(i,pu(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:vf(this.activation),useBias:this.useBias,kernelInitializer:is(this.kernelInitializer),recurrentInitializer:is(this.recurrentInitializer),biasInitializer:is(this.biasInitializer),kernelRegularizer:Rr(this.kernelRegularizer),recurrentRegularizer:Rr(this.recurrentRegularizer),biasRegularizer:Rr(this.biasRegularizer),activityRegularizer:Rr(this.activityRegularizer),kernelConstraint:Js(this.kernelConstraint),recurrentConstraint:Js(this.recurrentConstraint),biasConstraint:Js(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}$6.className="SimpleRNNCell";et($6);class vJ extends jf{constructor(e){e.cell=new $6(e),super(e)}call(e,t){return De(()=>{this.cell.dropoutMask!=null&&(In(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(In(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return new e(t)}}vJ.className="SimpleRNN";et(vJ);class L6 extends CC{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new _e("GRUCell does not support reset_after parameter set to true.");this.units=e.units,mi(this.units,"units"),this.activation=_f(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=_f(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Zr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Zr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Zr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Jr(e.kernelRegularizer),this.recurrentRegularizer=Jr(e.recurrentRegularizer),this.biasRegularizer=Jr(e.biasRegularizer),this.kernelConstraint=ei(e.kernelConstraint),this.recurrentConstraint=ei(e.recurrentConstraint),this.biasConstraint=ei(e.biasConstraint),this.dropout=kg([1,bf([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=kg([1,bf([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=or(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return De(()=>{if(e=e,e.length!==2)throw new _e(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=t.training==null?!1:t.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=wf({ones:()=>$l(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=wf({ones:()=>$l(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let o,l,c;0<this.dropout&&this.dropout<1&&(e=Ee(e,i[0]));let u=pu(e,this.kernel.read());this.useBias&&(u=wc(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=Ee(s,a[0]));const d=this.recurrentKernel.read(),[p,x]=Jo(d,[2*this.units,this.units],d.rank-1),y=pu(s,p),[v,b,S]=Jo(u,3,u.rank-1),[T,C]=Jo(y,2,y.rank-1);o=this.recurrentActivation.apply(tt(v,T)),l=this.recurrentActivation.apply(tt(b,C));const I=pu(Ee(l,s),x);c=this.activation.apply(tt(S,I));const $=tt(Ee(o,s),Ee(tt(1,_s(o)),c));return[$,$]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:vf(this.activation),recurrentActivation:vf(this.recurrentActivation),useBias:this.useBias,kernelInitializer:is(this.kernelInitializer),recurrentInitializer:is(this.recurrentInitializer),biasInitializer:is(this.biasInitializer),kernelRegularizer:Rr(this.kernelRegularizer),recurrentRegularizer:Rr(this.recurrentRegularizer),biasRegularizer:Rr(this.biasRegularizer),activityRegularizer:Rr(this.activityRegularizer),kernelConstraint:Js(this.kernelConstraint),recurrentConstraint:Js(this.recurrentConstraint),biasConstraint:Js(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}L6.className="GRUCell";et(L6);class _J extends jf{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new L6(e),super(e)}call(e,t){return De(()=>{this.cell.dropoutMask!=null&&(In(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(In(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}_J.className="GRU";et(_J);class AC extends CC{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,mi(this.units,"units"),this.activation=_f(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=_f(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Zr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Zr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Zr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Jr(e.kernelRegularizer),this.recurrentRegularizer=Jr(e.recurrentRegularizer),this.biasRegularizer=Jr(e.biasRegularizer),this.kernelConstraint=ei(e.kernelConstraint),this.recurrentConstraint=ei(e.recurrentConstraint),this.biasConstraint=ei(e.biasConstraint),this.dropout=kg([1,bf([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=kg([1,bf([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=or(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,a=this.units;s=new(t=class extends Fl{apply(l,c){const u=i.apply([a]),d=new v6().apply([a]),p=i.apply([a*2]);return wB(wB(u,d),p)}},t.className="CustomInit",t)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return De(()=>{const r=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new _e(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=wf({ones:()=>$l(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=wf({ones:()=>$l(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=Ee(e,a[0]));let p=pu(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=Ee(s,o[0])),p=tt(p,pu(s,this.recurrentKernel.read())),this.useBias&&(p=wc(p,this.bias.read()));const[x,y,v,b]=Jo(p,4,p.rank-1);l=this.recurrentActivation.apply(x),c=this.recurrentActivation.apply(y),u=tt(Ee(c,i),Ee(l,this.activation.apply(v))),d=this.recurrentActivation.apply(b);const S=Ee(d,this.activation.apply(u));return[S,S,u]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:vf(this.activation),recurrentActivation:vf(this.recurrentActivation),useBias:this.useBias,kernelInitializer:is(this.kernelInitializer),recurrentInitializer:is(this.recurrentInitializer),biasInitializer:is(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Rr(this.kernelRegularizer),recurrentRegularizer:Rr(this.recurrentRegularizer),biasRegularizer:Rr(this.biasRegularizer),activityRegularizer:Rr(this.activityRegularizer),kernelConstraint:Js(this.kernelConstraint),recurrentConstraint:Js(this.recurrentConstraint),biasConstraint:Js(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}AC.className="LSTMCell";et(AC);class wJ extends jf{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new AC(e),super(e)}call(e,t){return De(()=>{this.cell.dropoutMask!=null&&(In(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(In(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}wJ.className="LSTM";et(wJ);class P6 extends CC{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return De(()=>{e=e;let r=e.slice(1);const s=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?s.push(r.splice(0,o.stateSize.length)):s.push(r.splice(0,1));s.reverse();const i=[];let a;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];r=s[o],o===0?a=[e[0]].concat(r):a=[a[0]].concat(r),a=l.call(a,t),i.push(a.slice(1))}r=[];for(const o of i.slice().reverse())r.push(...o);return[a[0]].concat(r)})}build(e){N3(e)&&(e=e[0]),e=e;let t;this.cells.forEach((r,s)=>{Up(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?t=r.stateSize[0]:t=r.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,t,r={}){const s=[];for(const i of t.cells)s.push(_h(i,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const r of this.cells)t.push(...r.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return k3(e)}setWeights(e){const t=[];for(const r of this.cells){const s=r.weights.length,i=e.splice(s);for(let a=0;a<r.weights.length;++a)t.push([r.weights[a],i[a]])}A6(t)}}P6.className="StackedRNNCells";et(P6);function wf(n){const{ones:e,rate:t,training:r=!1,count:s=1,dropoutFunc:i}=n,a=()=>i!=null?i(e(),t):fQ(e(),t),o=()=>kv(a,e,r);return!s||s<=1?hu(o().clone()):Array(s).fill(void 0).map(o).map(c=>hu(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var tLe=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class EJ extends jf{constructor(e){if(e.unroll)throw new fn("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new fn("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Qs({ndim:5})]}call(e,t){return De(()=>{if(this.cell.dropoutMask!=null&&(In(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(In(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new _e("ConvRNN2D cell does not support constants");const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return De(()=>{const{stateSize:t}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)],a=fi(i);return Array.isArray(t)?Array(t.length).fill(a):[a]})}resetStates(e,t=!1){De(()=>{if(!this.stateful)throw new Wc("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)];if(r[0]==null)throw new _e("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>fi(i)):this.states_=[fi(i)];else if(e==null)In(this.states_),this.keptStates!=null&&(In(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>fi(i)):this.states_[0]=fi(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new _e(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):In(this.states_);for(let o=0;o<this.states_.length;++o){const l=e[o],c=i;if(!gr(l.shape,c))throw new _e(`State ${o} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>hu(o.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:r,kernelSize:s,padding:i,strides:a,dilationRate:o}=this.cell,l=t==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=pc(c,s[0],i,a[0],o[0]),p=pc(u,s[1],i,a[1],o[1]);return[...e.slice(0,2),...l?[r,d,p]:[d,p,r]]}}EJ.className="ConvRNN2D";class O6 extends AC{constructor(e){const{filters:t,kernelSize:r,strides:s,padding:i,dataFormat:a,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,mi(this.filters,"filters"),this.kernelSize=cg(r,2,"kernelSize"),this.kernelSize.forEach(l=>mi(l,"kernelSize")),this.strides=cg(s||1,2,"strides"),this.strides.forEach(l=>mi(l,"strides")),this.padding=i||"valid",sl(this.padding),this.dataFormat=a||"channelsLast",As(this.dataFormat),this.dilationRate=cg(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>mi(l,"dilationRate"))}build(e){var t;e=or(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new _e(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],i=4,a=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(t=class extends Fl{apply(p,x){const y=c.apply([u]),v=Bf([u]),b=c.apply([u*2]);return b6([y,v,b])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return De(()=>{if(e.length!==3)throw new _e(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=t.training||!1,s=e[0],i=e[1],a=e[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=wf({ones:()=>$l(s),rate:this.dropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(Q,z,D)=>!z||!z[D]?Q:Ee(z[D],Q);let u=c(s,l,0),d=c(s,l,1),p=c(s,l,2),x=c(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=wf({ones:()=>$l(i),rate:this.recurrentDropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const y=this.recurrentDropoutMask;let v=c(i,y,0),b=c(i,y,1),S=c(i,y,2),T=c(i,y,3);const C=3,[I,$,q,U]=Jo(this.kernel.read(),o,C),[F,G,V,O]=this.useBias?Jo(this.bias.read(),o):[null,null,null,null];u=this.inputConv(u,I,F,this.padding),d=this.inputConv(d,$,G,this.padding),p=this.inputConv(p,q,V,this.padding),x=this.inputConv(x,U,O,this.padding);const[K,P,N,M]=Jo(this.recurrentKernel.read(),o,C);v=this.recurrentConv(v,K),b=this.recurrentConv(b,P),S=this.recurrentConv(S,N),T=this.recurrentConv(T,M);const B=this.recurrentActivation.apply(tt(u,v)),Y=this.recurrentActivation.apply(tt(d,b)),Z=tt(Ee(Y,a),Ee(B,this.activation.apply(tt(p,S)))),ne=Ee(this.recurrentActivation.apply(tt(x,T)),this.activation.apply(Z));return[ne,ne,Z]})}getConfig(){const e=super.getConfig(),{units:t}=e,r=tLe(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},r),s)}inputConv(e,t,r,s){const i=gm(e,t,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?wc(i,r,this.dataFormat):i}recurrentConv(e,t){return gm(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}O6.className="ConvLSTM2DCell";et(O6);class SJ extends EJ{constructor(e){const t=new O6(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}SJ.className="ConvLSTM2D";et(SJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class M6 extends Tn{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?t[s]:this.noiseShape[s]);return r}call(e,t){return De(()=>{this.invokeCallHook(e,t);const r=Wt(e);if(0<this.rate&&this.rate<1){const s=t.training==null?!1:t.training,i=this.getNoiseShape(r);return kv(()=>fQ(r,this.rate,i,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}M6.className="Dropout";et(M6);class TJ extends M6{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}TJ.className="SpatialDropout1D";et(TJ);class CJ extends Tn{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,mi(this.units,"units"),this.activation=_f(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Zr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Zr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=ei(e.kernelConstraint),this.biasConstraint=ei(e.biasConstraint),this.kernelRegularizer=Jr(e.kernelRegularizer),this.biasRegularizer=Jr(e.biasRegularizer),this.activityRegularizer=Jr(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=or(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=or(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return De(()=>{this.invokeCallHook(e,t);const r=Wt(e),s=aQ(this.activation.getClassName());let i;return s!=null?i=pu(r,this.kernel.read(),s,this.bias?this.bias.read():null):(i=pu(r,this.kernel.read()),this.bias!=null&&(i=wc(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:vf(this.activation),useBias:this.useBias,kernelInitializer:is(this.kernelInitializer),biasInitializer:is(this.biasInitializer),kernelRegularizer:Rr(this.kernelRegularizer),biasRegularizer:Rr(this.biasRegularizer),activityRegularizer:Rr(this.activityRegularizer),kernelConstraint:Js(this.kernelConstraint),biasConstraint:Js(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}CJ.className="Dense";et(CJ);class AJ extends Tn{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=or(e);for(const t of e.slice(1))if(t==null)throw new _e(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],tf(e,1)]}call(e,t){return De(()=>{this.invokeCallHook(e,t);let r=Wt(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let i=2;i<r.rank;++i)s.push(i);s.push(1),r=Qn(r,s)}return P$e(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}AJ.className="Flatten";et(AJ);class NJ extends Tn{constructor(e){super(e),this.supportsMasking=!0,this.activation=_f(e.activation)}call(e,t){return De(()=>{this.invokeCallHook(e,t);const r=Wt(e);return this.activation.apply(r)})}getConfig(){const e={activation:vf(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}NJ.className="Activation";et(NJ);class kJ extends Tn{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return De(()=>(e=Wt(e),$$e(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}kJ.className="RepeatVector";et(kJ);class IJ extends Tn{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const r="Total size of new array must be unchanged.",s=t.slice();let i=1,a=null;for(let l=0;l<s.length;++l){const c=s[l];if(this.isUnknown(c))if(a===null)a=l;else throw new _e("Can only specifiy one unknown dimension.");else i*=c}const o=tf(e);if(a!==null){if(i===0||o%i!==0)throw new _e(r);s[a]=o/i}else if(o!==i)throw new _e(r);return s}computeOutputShape(e){let t=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return De(()=>{this.invokeCallHook(e,t);const r=Wt(e),s=r.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return Ce(r,i)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}IJ.className="Reshape";et(IJ);class RJ extends Tn{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=yc(1,e.dims.length+1);if(!gr(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Qs({ndim:this.dims.length+1})]}computeOutputShape(e){e=or(e);const t=e.slice();return this.dims.forEach((r,s)=>{t[s+1]=e[r]}),t}call(e,t){return Qn(Wt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}RJ.className="Permute";et(RJ);class DJ extends Tn{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const r=Wt(e);return b3(BE(r,this.maskValue),-1)}call(e,t){return De(()=>{this.invokeCallHook(e,t);const r=Wt(e),a=b3(BE(r,this.maskValue),-1,!0);return Ee(r,mt(a,r.dtype))})}}DJ.className="Masking";et(DJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $J extends Tn{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(br(e.inputLength))}this.inputDim=e.inputDim,mi(this.inputDim,"inputDim"),this.outputDim=e.outputDim,mi(this.outputDim,"outputDim"),this.embeddingsInitializer=Zr(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Jr(e.embeddingsRegularizer),this.activityRegularizer=Jr(e.activityRegularizer),this.embeddingsConstraint=ei(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return De(()=>this.maskZero?(e=Wt(e),BE(e,Jn(e))):null)}computeOutputShape(e){if(e=or(e),this.inputLength==null)return[...e,this.outputDim];const t=br(this.inputLength);if(t.length!==e.length-1)throw new _e(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<t.length;++s){const i=t[s],a=e[s+1];if(i!=null&&a!=null&&i!==a)throw new _e(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(t[r]=a),r++}}return[e[0],...t,this.outputDim]}call(e,t){return De(()=>{this.invokeCallHook(e,t);let r=Wt(e);r.dtype!=="int32"&&(r=fu(r,"int32"));const s=dQ(this.embeddings.read(),Ce(r,[r.size]));return Ce(s,or(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:is(this.embeddingsInitializer),embeddingsRegularizer:Rr(this.embeddingsRegularizer),activityRegularizer:Rr(this.activityRegularizer),embeddingsConstraint:Js(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}$J.className="Embedding";et($J);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Om extends Tn{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new fn}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const r=e.slice(0,e.length-t.length);for(let s=0;s<t.length;++s){const i=e[e.length-t.length+s],a=t[s];if(i==null||a==null||i<0||a<0)r.push(null);else if(i===1)r.push(a);else if(a===1)r.push(i);else{if(i!==a)throw new _e("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[or(e)]),e=e,e.length<2)throw new _e(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const i of e)i!=null&&i[0]!==null&&t.push(i[0]);if(t=ef(t),t.length>1)throw new _e(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const a=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}const s=e.map(i=>i.length);e.indexOf(null)===-1&&ef(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return De(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(i=>i.rank);if(s.indexOf(null)===-1){const i=bf(s);for(let a of e){const o=a.rank;for(let l=0;l<i-o;++l)a=Av(a,1);r.push(a)}return this.mergeFunction(r)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],p=u.slice(1).concat([d]);let x=Ce(l,[d].concat(tf(u.slice(1))));x=Qn(x,[1,0]),x=Ce(x,p),r.push(x),i=!0}else if(c>1){const u=yc(1,c).concat([0]);r.push(Qn(l,u)),i=!0}else r.push(l)}let a=this.mergeFunction(r);const o=a.rank;if(i){if(o==null){const l=a.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));a=Ce(Qn(Ce(a,[-1,u]),[1,0]),d)}else if(o>1){const l=[o-1].concat(yc(0,o-1));a=Qn(a,l)}}return a}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);t=this.computeElementwiseOpOutputShape(t,i)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=ef(r),r.length===1?t=r.concat(t):t=[null].concat(t),t}computeMask(e,t){return De(()=>{if(t==null)return null;if(!Array.isArray(t))throw new _e("`mask` should be an Array");if(!Array.isArray(e))throw new _e("`inputs` should be an Array");if(t.length!==e.length)throw new _e(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(s=>s==null))return null;t=t.map(s=>s==null?s:Za(s,0));let r=t[0];for(let s=1;s<t.length-1;++s)r=kh(r,t[s]);return r})}}class LJ extends Om{constructor(e){super(e)}mergeFunction(e){return De(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=tt(t,e[r]);return t})}}LJ.className="Add";et(LJ);class PJ extends Om{constructor(e){super(e)}mergeFunction(e){return De(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=Ee(t,e[r]);return t})}}PJ.className="Multiply";et(PJ);class OJ extends Om{constructor(e){super(e)}mergeFunction(e){return De(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=tt(t,e[r]);return Ee(1/e.length,t)})}}OJ.className="Average";et(OJ);class MJ extends Om{constructor(e){super(e)}mergeFunction(e){return De(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=Ff(t,e[r]);return t})}}MJ.className="Maximum";et(MJ);class FJ extends Om{constructor(e){super(e)}mergeFunction(e){return De(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=k1(t,e[r]);return t})}}FJ.className="Minimum";et(FJ);class BJ extends Om{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new _e("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const s of e)if(s!=null){t=!1;break}if(t)return;const r=[];for(let s=0;s<e.length;++s){const i=e[s].slice();i.splice(this.axis,1);let a=!1;for(const o of r)if(gr(o,i)){a=!0;break}a||r.push(i)}if(r.length>1)throw new _e("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return De(()=>b6(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new _e("A `Concatenate` layer should be called on a list of inputs.");const t=e,r=t[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const i of t.slice(1)){if(r[s]==null||i[s]==null){r[s]=null;break}r[s]+=i[s]}return r}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new _e("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new _e("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new _e(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return De(()=>{let r=!0;if(t.forEach(a=>{if(a!=null){r=!1;return}}),r)return null;const s=[];for(let a=0;a<e.length;++a)t[a]==null?s.push(mt($l(e[a]),"bool")):t[a].rank<e[a].rank?s.push(Za(t[a],-1)):s.push(t[a]);const i=eo(s,this.axis);return zY(i,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}BJ.className="Concatenate";et(BJ);function xy(n,e){for(;n<0;)n+=e;return n}function nLe(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new fn("batchDot is not implemented for tensors of 4D or higher rank yet");if(ue(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),ue(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new fn("batchDot is not implemented for complex64-type Tensors yet.");const r=n.shape.length,s=e.shape.length;t==null&&(t=[r-1,s-2]);const i=t;return De(()=>{let a;if(r>s){a=r-s;const l=[];for(let c=0;c<a;++c)l.push(1);e=Ce(e,e.shape.concat(l))}else if(s>r){a=s-r;const l=[];for(let c=0;c<a;++c)l.push(1);n=Ce(n,n.shape.concat(l))}else a=0;let o;if(n.shape.length===2&&e.shape.length===2)i[0]===i[1]?o=$t(Ee(n,e),i[0]):o=$t(Ee(Qn(n,[1,0]),e),i[1]);else{const l=i[0]!==n.shape.length-1,c=i[1]===e.shape.length-1;o=fr(n,e,l,c)}if(a>0){let l;r>s?l=r+s-3:l=r-1;const c=[];for(let u=l;u<l+a;++u)c.push(u);o=_v(o,c)}return o.shape.length===1&&(o=Za(o,1)),o})}class zJ extends Om{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){ue(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],r=e[1];if(t.length>3||r.length>3)throw new fn("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,r);if(t[s[0]]!==r[s[1]])throw new _e(`Dimension incompatibility: ${t[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new _e(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,a)=>xy(i,e[a].shape.length)):s=[xy(this.axes,t.shape.length),xy(this.axes,r.shape.length)],this.normalize&&(t=WE(t,s[0]),r=WE(r,s[1])),nLe(t,r,s)}interpretAxes(e,t){let r;return Array.isArray(this.axes)?r=this.axes:r=[xy(this.axes,e.length),xy(this.axes,t.length)],r}computeOutputShape(e){ue(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),r=e[1].slice();if(t.length>3||r.length>3)throw new fn("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,r);t.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const i=t.concat(r);return i.length===1&&i.push(1),i}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}zJ.className="Dot";et(zJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jJ extends Tn{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return De(()=>{this.invokeCallHook(e,t);const r=Wt(e);return kv(()=>tt(vC(r.shape,0,this.stddev),r),()=>r,t.training||!1)})}}jJ.className="GaussianNoise";et(jJ);class VJ extends Tn{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return De(()=>{this.invokeCallHook(e,t);const r=Wt(e);return this.rate>0&&this.rate<1?kv(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return Ee(r,vC(r.shape,1,i))},()=>r,t.training||!1):r})}}VJ.className="GaussianDropout";et(VJ);class UJ extends Tn{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Wt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return De(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return kv(()=>{const i=Wt(e),o=-1.6732632423543772*1.0507009873554805;let l=Dm(vv(r),this.rate);l=fu(l,"float32");const c=((1-this.rate)*(1+this.rate*o**2))**-.5,u=-c*o*this.rate,d=tt(Ee(i,l),Ee(tt(l,-1),o));return tt(Ee(d,c),u)},()=>Wt(e),t.training||!1)}return e})}}UJ.className="AlphaDropout";et(UJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function L1(n,e,t,r,s,i=.001){let a;if(n.rank===2)a=QNe(n,e,t,r,s,i);else if(n.rank===3)a=eke(n,e,t,r,s,i);else if(n.rank===4)a=nke(n,e,t,r,s,i);else throw new fn(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return a}function rLe(n,e,t,r,s=.001){return De(()=>{const i=N$(n,r),a=i.mean,o=i.variance;return[L1(n,a,o,t,e,s),a,o]})}function sLe(n,e,t,r,s=.001){return De(()=>{const i=N$(n,r),a=i.mean,o=i.variance,l=[];for(const y of yc(0,n.rank))r.indexOf(y)!==-1?l.push(1):l.push(n.shape[y]);const c=Ce(a,l),u=Ce(o,l),d=e==null?null:Ce(e,l),p=t==null?null:Ce(t,l);return[L1(n,c,u,p,d,s),a,o]})}function iLe(n,e,t,r,s=.001){return gr(r.slice().sort(),yc(0,n.rank-1))?rLe(n,e,t,r,s):sLe(n,e,t,r,s)}class GJ extends Tn{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Zr(e.betaInitializer||"zeros"),this.gammaInitializer=Zr(e.gammaInitializer||"ones"),this.movingMeanInitializer=Zr(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Zr(e.movingVarianceInitializer||"ones"),this.betaConstraint=ei(e.betaConstraint),this.gammaConstraint=ei(e.gammaConstraint),this.betaRegularizer=Jr(e.betaRegularizer),this.gammaRegularizer=Jr(e.gammaRegularizer)}build(e){e=or(e);const t=this.axis>=0?this.axis:this.axis+e.length,r=e[t];if(r==null)throw new _e(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Qs({ndim:e.length,axes:{[t]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return De(()=>{const r=t.training==null?!1:t.training,s=Wt(e),i=s.shape,a=i.length,o=yc(0,a),l=this.axis>=0?this.axis:this.axis+a;o.splice(l,1);const c=vm(1,a);c[l]=i[l];const u=o.slice();u.sort();const d=!gr(u,yc(0,a).slice(0,a-1)),p=()=>{if(d){const T=Ce(this.movingMean.read(),c),C=Ce(this.movingVariance.read(),c),I=this.center?Ce(this.beta.read(),c):null,$=this.scale?Ce(this.gamma.read(),c):null;return L1(s,T,C,I,$,this.epsilon)}else return L1(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return p();const[x,y,v]=iLe(s,this.gamma.read(),this.beta.read(),o,this.epsilon),b=(T,C,I)=>{De(()=>{const $=1-I,q=T.read(),U=Ee(Vt(q,C),$);T.write(Vt(q,U))})};return(()=>{b(this.movingMean,y,this.momentum),b(this.movingVariance,v,this.momentum)})(),x})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:is(this.betaInitializer),gammaInitializer:is(this.gammaInitializer),movingMeanInitializer:is(this.movingMeanInitializer),movingVarianceInitializer:is(this.movingVarianceInitializer),betaRegularizer:Rr(this.betaRegularizer),gammaRegularizer:Rr(this.gammaRegularizer),betaConstraint:Js(this.betaConstraint),gammaConstraint:Js(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}GJ.className="BatchNormalization";et(GJ);class HJ extends Tn{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Zr(e.betaInitializer||"zeros"),this.gammaInitializer=Zr(e.gammaInitializer||"ones"),this.betaRegularizer=Jr(e.betaRegularizer),this.gammaRegularizer=Jr(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=or(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=t);for(const i of this.axis)if(i<0||i>=t)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==ef(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,t){const r=Wt(e),s=r.shape,i=s.length;return De(()=>{let{mean:o,variance:l}=N$(r,this.axis,!0);const c=vm(1,i);for(const v of this.axis)c[v]=s[v];const u=v=>v!=null&&v.shape.length!==i?Ce(v,c):v;let d=this.scale?u(this.gamma.read()):null,p=this.center?u(this.beta.read()):null;const x=[],y=[];for(let v=0;v<i;++v)this.axis.indexOf(v)!==-1?(x.push(s[v]),y.push(1)):(x.push(1),y.push(s[v]));return o=cc(o,x),l=cc(l,x),d!=null&&(d=cc(d,y)),p!=null&&(p=cc(p,y)),L1(r,o,l,p,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:is(this.betaInitializer),gammaInitializer:is(this.gammaInitializer),betaRegularizer:Rr(this.betaRegularizer),gammaRegularizer:Rr(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}HJ.className="LayerNormalization";et(HJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aLe(n,e,t){return De(()=>{if(n.rank!==4)throw new _e(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new _e("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=bc()),t!=="channelsLast"&&t!=="channelsFirst")throw new _e(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return t==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],k$(n,r)})}class WJ extends Tn{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?bc():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new _e(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,r;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new _e(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new _e(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[t,r]}this.inputSpec=[new Qs({ndim:4})]}computeOutputShape(e){e=or(e);let t,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],t,r]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],t,r,e[3]])}call(e,t){return De(()=>aLe(Wt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}WJ.className="ZeroPadding2D";et(WJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function NC(n,e,t,r,s,i){return De(()=>{As(s),lQ(i),sl(r),t==null&&(t=[1,1]),r==null&&(r="valid"),s==null&&(s=bc()),i==null&&(i="max"),n=D6(n,s);let a;const o=r==="same"?"same":"valid";return i==="max"?a=A$(n,e,t,o):a=x$(n,e,t,o),s==="channelsFirst"&&(a=Qn(a,[0,3,1,2])),a})}function qJ(n,e,t,r,s,i){return De(()=>{As(s),lQ(i),sl(r),t==null&&(t=[1,1,1]),r==null&&(r="valid"),s==null&&(s=bc()),i==null&&(i="max"),n=uJ(n,s);let a;const o=r==="same"?"same":"valid";return i==="max"?a=zIe(n,e,t,o):a=VNe(n,e,t,o),s==="channelsFirst"&&(a=Qn(a,[0,4,1,2,3])),a})}class KJ extends Tn{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new _e(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(mi(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new _e(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);mi(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,sl(this.padding),this.inputSpec=[new Qs({ndim:3})]}computeOutputShape(e){e=or(e);const t=pc(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return De(()=>{this.invokeCallHook(e,t),e=Av(Wt(e),2);const r=this.poolingFunction(Wt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return _v(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class XJ extends KJ{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return As(i),sl(s),NC(e,t,r,s,i,"max")}}XJ.className="MaxPooling1D";et(XJ);class YJ extends KJ{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return As(i),sl(s),NC(e,t,r,s,i,"avg")}}YJ.className="AveragePooling1D";et(YJ);class ZJ extends Tn{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new _e(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];mi(this.poolSize,"poolSize"),mi(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,As(this.dataFormat),sl(this.padding),this.inputSpec=[new Qs({ndim:4})]}computeOutputShape(e){e=or(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=pc(t,this.poolSize[0],this.padding,this.strides[0]),r=pc(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r]:[e[0],t,r,e[3]]}call(e,t){return De(()=>(this.invokeCallHook(e,t),this.poolingFunction(Wt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class QJ extends ZJ{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return As(i),sl(s),NC(e,t,r,s,i,"max")}}QJ.className="MaxPooling2D";et(QJ);class JJ extends ZJ{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return As(i),sl(s),NC(e,t,r,s,i,"avg")}}JJ.className="AveragePooling2D";et(JJ);class eee extends Tn{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new _e(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];mi(this.poolSize,"poolSize"),mi(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,As(this.dataFormat),sl(this.padding),this.inputSpec=[new Qs({ndim:5})]}computeOutputShape(e){e=or(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=pc(t,this.poolSize[0],this.padding,this.strides[0]),r=pc(r,this.poolSize[1],this.padding,this.strides[1]),s=pc(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r,s]:[e[0],t,r,s,e[4]]}call(e,t){return De(()=>(this.invokeCallHook(e,t),this.poolingFunction(Wt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class tee extends eee{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return As(i),sl(s),qJ(e,t,r,s,i,"max")}}tee.className="MaxPooling3D";et(tee);class nee extends eee{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return As(i),sl(s),qJ(e,t,r,s,i,"avg")}}nee.className="AveragePooling3D";et(nee);class ree extends Tn{constructor(e){super(e),this.inputSpec=[new Qs({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new fn}}class see extends ree{constructor(e){super(e||{})}call(e,t){return De(()=>{const r=Wt(e);return Fs(r,1)})}}see.className="GlobalAveragePooling1D";et(see);class iee extends ree{constructor(e){super(e||{})}call(e,t){return De(()=>{const r=Wt(e);return fc(r,1)})}}iee.className="GlobalMaxPooling1D";et(iee);class aee extends Tn{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,As(this.dataFormat),this.inputSpec=[new Qs({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new fn}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class oee extends aee{call(e,t){return De(()=>{const r=Wt(e);return this.dataFormat==="channelsLast"?Fs(r,[1,2]):Fs(r,[2,3])})}}oee.className="GlobalAveragePooling2D";et(oee);class lee extends aee{call(e,t){return De(()=>{const r=Wt(e);return this.dataFormat==="channelsLast"?fc(r,[1,2]):fc(r,[2,3])})}}lee.className="GlobalMaxPooling2D";et(lee);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cee extends Tn{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,r={}){const s=t.layer,i=_h(s,r);delete t.layer;const a={layer:i};return Object.assign(a,t),new e(a)}}class uee extends cee{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=or(e),e.length<3)throw new _e(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=or(e);const t=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(t),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,t){return De(()=>(e=Wt(e),bJ((a,o)=>[Wt(this.layer.call(a,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}uee.className="TimeDistributed";et(uee);function oLe(n){Pm(N$e,"BidirectionalMergeMode",n)}const lLe="concat";class hee extends cee{constructor(e){super(e);const t=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=t,this.forwardLayer=_h(r),t.goBackwards=t.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=t,this.backwardLayer=_h(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?lLe:e.mergeMode,oLe(this.mergeMode),e.weights)throw new fn("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,r=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let r,s,i;return this.returnState&&(i=t.slice(1)),r=t[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):Qa(s)}apply(e,t){let r=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const i=yJ(e,r,s,this.numConstants);if(e=i.inputs,r=i.initialState,s=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,t);const a=[],o=[];if(r!=null){const c=r.length;if(c%2>0)throw new _e("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,a.push(...r);const u=r.map(d=>new Qs({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),o.push(...u)}if(s!=null)throw new fn("Support for constants in Bidirectional layers is not implemented yet.");const l=a[0]instanceof Au;for(const c of a)if(c instanceof Au!==l)throw new _e("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(a),u=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=u;const p=super.apply(c,t);return this.inputSpec=d,p}else return super.apply(e,t)}call(e,t){return De(()=>{const r=t.initialState;let s,i;if(r==null)s=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{const l=r.slice(0,r.length/2),c=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:c}))}let a;this.returnState&&(Array.isArray(s)&&(a=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=ym(i,1));let o;return this.mergeMode==="concat"?o=b6([s,i]):this.mergeMode==="sum"?o=tt(s,i):this.mergeMode==="ave"?o=Ee(.5,tt(s,i)):this.mergeMode==="mul"?o=Ee(s,i):this.mergeMode==null&&(o=[s,i]),this.returnState?this.mergeMode==null?o.concat(a):[o].concat(a):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Up(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Up(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[t,t]:r=t:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(a=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const r=_h(t.layer);if(delete t.layer,t.numConstants!=null)throw new fn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=t;return s.layer=r,new e(s)}}hee.className="Bidirectional";et(hee);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dee extends Tn{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return De(()=>(e=Wt(e),e.dtype!=="float32"&&(e=fu(e,"float32")),tt(Ee(e,this.scale),this.offset)))}}dee.className="Rescaling";et(dee);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:cLe,cropAndResize:uLe}=mh;class fee extends Tn{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,r,s,i,a,o,l){return De(()=>{let c,u=!1;const d=t/a,p=r/o,x=(s+t)/a,y=(i+r)/o,v=[d,p,x,y],b=[];e.rank===3?(u=!0,c=Ih([e])):c=e;for(let $=0;$<c.shape[0];$++)b.push(v);const S=IY(b,[b.length,4]),T=I1(0,b.length,1,"int32"),I=uLe(c,S,T,[s,i],"nearest");return fu(u?Wt(bm(I)):I,l)})}upsize(e,t,r,s){return De(()=>{const i=cLe(e,[t,r]);return fu(i,s)})}call(e,t){return De(()=>{const r=Wt(e),s=r.dtype,i=r.shape,a=i[i.length-3],o=i[i.length-2];let l=0;a!==this.height&&(l=Math.floor((a-this.height)/2));let c=0;return o!==this.width&&(c=Math.floor((o-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(r,l,c,this.height,this.width,a,o,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=or(e);const t=e.length-3,r=e.length-2;return e[t]=this.height,e[r]=this.width,e}}fee.className="CenterCrop";et(fee);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hLe(n,e,t,r){let s=Wt(n);if(s.dtype!=="int32"&&(s=fu(s,"int32")),e==="int")return s;const i=s.shape;if(s.rank===0&&(s=Za(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=Za(s,-1)),s.rank>2)throw new _e(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${s.rank}.`);const a=["multiHot","oneHot"].includes(e),o=s;let l;if(typeof r<"u"&&e==="count"?l=oB(o,r,t,a):l=oB(o,[],t,a),e!=="tfIdf")return l;if(r)return Ee(l,r);throw new _e("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class pee extends Tn{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=or(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return De(()=>{e=Wt(e),e.dtype!=="int32"&&(e=fu(e,"int32"));let r;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new _e(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);r=Wt(t.countWeights)}const s=fc(e),i=ME(e),a=rl(this.numTokens,s).bufferSync().get(0),o=Dm(i,0).bufferSync().get(0);if(!(a&&o))throw new _e(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return hLe(e,this.outputMode,this.numTokens,r)})}}pee.className="CategoryEncoding";et(pee);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const dLe=["bilinear","nearest"],zB=new Set(dLe);class mee extends Tn{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(zB.has(e.interpolation))this.interpolation=e.interpolation;else throw new _e(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=or(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return De(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return mh.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return mh.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...zB]} are supported`)})}}mee.className="Resizing";et(mee);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gee{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}gee.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class xee extends Tn{constructor(e){super(e),this.randomGenerator=new gee(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}xee.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const fLe=["bilinear","nearest"],jB=new Set(fLe);class yee extends xee{constructor(e){super(e);const{factor:t,interpolation:r="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new _e(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new _e(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new _e(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(jB.has(r))this.interpolation=r;else throw new _e(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=or(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return De(()=>{const r=Wt(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=vv([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);const a=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return mh.resizeBilinear(e,a);case"nearest":return mh.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...jB]} are supported`)}})}}yee.className="RandomWidth";et(yee);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pLe=Me();pLe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var VB;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(VB||(VB={}));var UB;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(UB||(UB={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var GB;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(GB||(GB={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _t(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&ue(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mLe=pZ;class kC extends _D{nextDataId(){return kC.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new zX(this,zc())}write(e,t,r){this.firstUse&&(this.firstUse=!1,Me().get("IS_NODE")&&Xo(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,t,r){let s;if(t==="string"&&r!=null&&r.length>0&&wb(r[0])){const i=r.map(a=>Jd(a));s=this.write(i,e,t)}else s=this.write(r,e,t);return{dataId:s,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,r,s,i){this.data.set(e,{values:t,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:r}=this.data.get(e);if(t==="complex64"){const s=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return Rh(s,i)}return iAe(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(s=>yf(s));return En(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return En(e.shape,e.dtype,t)}makeOutput(e,t,r){return zc().makeTensorFromTensorInfo(this.makeTensorInfo(t,r,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=Ya();return e(),{kernelMs:Ya()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){_t([e],"where");const t=this.readSync(e.dataId);return mLe(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}kC.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bee(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const gLe=n=>{const{x:e}=n.inputs,t=n.backend;_t(e,"abs");let r=new Float32Array(Ue(e.shape));const s=t.data.get(e.dataId).values;return r=bee(s),t.makeOutput(r,e.shape,e.dtype)},xLe={kernelName:aT,backendName:"cpu",kernelFunc:gLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ns(n){return(e,t,r,s,i)=>{const a=cn(e,t),o=a.length,l=kt(a),c=Ue(a),u=Ji(i,c),d=e.length,p=t.length,x=kt(e),y=kt(t),v=Ag(e,a),b=Ag(t,a);if(v.length+b.length===0)for(let S=0;S<u.length;++S)u[S]=n(r[S%r.length],s[S%s.length]);else for(let S=0;S<u.length;++S){const T=tx(S,o,l),C=T.slice(-d);v.forEach(U=>C[U]=0);const I=uu(C,d,x),$=T.slice(-p);b.forEach(U=>$[U]=0);const q=uu($,p,y);u[S]=n(r[I],s[q])}return[u,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yo(n){const{inputs:e,backend:t}=n,{real:r,imag:s}=e,i=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,o=t.makeTensorInfo(r.shape,"complex64"),l=t.data.get(o.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(r.shape,"float32",i),imag:t.makeTensorInfo(s.shape,"float32",a)},o}const yLe={kernelName:LD,backendName:"cpu",kernelFunc:yo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZE(n,e,t="float32"){if(t==="complex64"){const s=ZE(n,e,"float32"),i=ZE(n,e,"float32");return yo({inputs:{real:s,imag:i},backend:n})}const r=ea(Ue(e),t);return n.makeTensorInfo(e,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nu(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const bLe={kernelName:Ub,backendName:"cpu",kernelFunc:Nu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _m(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.data.get(r.dataId).complexTensorInfos.real,i=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,i)}const vLe={kernelName:s$,backendName:"cpu",kernelFunc:_m};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vee(n,e,t,r){if(r==="int32"){const s=Int32Array.from(n);return[e,"int32",s]}if(r==="bool"){const s=Rm([0],t),[i,a]=Ns((o,l)=>o!==l?1:0)(e,[],n,s,"bool");return[a,"bool",i]}throw new Error(`Error in Cast: failed to cast ${t} to ${r}`)}function Ef(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return Nu({inputs:{x:s},backend:t});const u=ZE(t,s.shape,s.dtype),d=Ef({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),p=yo({inputs:{real:d,imag:u},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(d),p}if(s.dtype==="complex64"){const u=_m({inputs:{input:s},backend:t}),d=Ef({inputs:{x:u},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(u),d}if(!UX(s.dtype,i)){const u=Nu({inputs:{x:s},backend:t});return{dataId:u.dataId,shape:u.shape,dtype:i}}const a=t.data.get(s.dataId).values,[o,l,c]=vee(a,s.shape,s.dtype,i);return t.makeTensorInfo(o,l,c)}const _Le={kernelName:Ib,backendName:"cpu",kernelFunc:Ef};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ni(n,e,t,r){return t==null?({inputs:s,backend:i})=>{const{a,b:o}=s,l=i;_t([a,o],n);const c=l.data.get(a.dataId).values,u=l.data.get(o.dataId).values,d=a.dtype==="string"?Dh(c):c,p=a.dtype==="string"?Dh(u):u,x=r||a.dtype,[y,v]=e(a.shape,o.shape,d,p,x);return l.makeTensorInfo(v,x,y)}:({inputs:s,backend:i})=>{const{a,b:o}=s,l=i;if(a.dtype==="complex64"||o.dtype==="complex64"){const c=Ef({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,p=u.complexTensorInfos.imag,x=l.data.get(d.dataId).values,y=l.data.get(p.dataId).values,v=Ef({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),b=l.data.get(v.dataId),S=b.complexTensorInfos.real,T=b.complexTensorInfos.imag,C=l.data.get(S.dataId).values,I=l.data.get(T.dataId).values,[$,q,U]=t(a.shape,o.shape,x,y,C,I),F=l.makeTensorInfo(U,"float32",$),G=l.makeTensorInfo(U,"float32",q),V=yo({inputs:{real:F,imag:G},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(v),l.disposeIntermediateTensorInfo(F),l.disposeIntermediateTensorInfo(G),V}else{const c=l.data.get(a.dataId).values,u=l.data.get(o.dataId).values,d=r||a.dtype,[p,x]=e(a.shape,o.shape,c,u,d);return l.makeTensorInfo(x,d,p)}}}function F6(n){return(e,t,r,s,i,a)=>{const o=cn(e,t),l=Ue(o),c=o.length,u=kt(o),d=Ji("float32",l),p=Ji("float32",l),x=Ag(e,o),y=Ag(t,o),v=Rh(r,s),b=Rh(i,a),S=e.length,T=kt(e),C=t.length,I=kt(t);if(x.length+y.length===0)for(let $=0;$<d.length;$++){const q=$%v.length,U=$%b.length,F=n(v[q*2],v[q*2+1],b[U*2],b[U*2+1]);d[$]=F.real,p[$]=F.imag}else for(let $=0;$<d.length;$++){const q=tx($,c,u),U=q.slice(-S);x.forEach(K=>U[K]=0);const F=uu(U,S,T),G=q.slice(-C);y.forEach(K=>G[K]=0);const V=uu(G,C,I),O=n(v[F*2],v[F*2+1],b[V*2],b[V*2+1]);d[$]=O.real,p[$]=O.imag}return[d,p,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ee=Ns(((n,e)=>n+e)),wLe=F6(((n,e,t,r)=>({real:n+t,imag:e+r}))),Ig=ni(nx,_ee,wLe),ELe={kernelName:nx,backendName:"cpu",kernelFunc:Ig};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6(n,e,t,r,s){const i=Ue(r),a=ea(s,t);for(let o=0;o<n.length;o++){const l=n[o];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(i>0?a[l]+=e[o]:a[l]+=1)}return a}function wee(n,e,t,r=!1){const s=n.shape[0],i=n.shape[1],a=En([s,t],e.dtype);for(let o=0;o<s;o++)for(let l=0;l<i;l++){const c=n.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=t||(r?a.set(1,o,c):e.size>0?a.set(a.get(o,c)+e.get(o,l),o,c):a.set(a.get(o,c)+1,o,c))}return a}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eee=Ns(((n,e)=>n&e)),SLe=ni($D,Eee),TLe={kernelName:$D,backendName:"cpu",kernelFunc:SLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $u(n){return(e,t,r)=>{const s=vs(t,e.length);for(let i=0;i<e.length;++i)s[i]=n(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _r(n,e,t){const r=$u(e);return Vf(n,r,t)}function Vf(n,e,t){return({inputs:r,attrs:s,backend:i})=>{const{x:a}=r;_t(a,n);const o=i,l=o.data.get(a.dataId).values;let c;if(a.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=Dh(l)}else c=l;const u=t||a.dtype,d=e(c,u,s);return o.makeTensorInfo(a.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const See=$u(n=>Math.ceil(n)),CLe=Vf(Rb,See),ALe={kernelName:Rb,backendName:"cpu",kernelFunc:CLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tee(n,e,t,r){const s=vs(t,Ue(e));if(r&&t!=="string"){let i=0;n.forEach(a=>{const o=Ue(a.shape);s.set(a.vals,i),i+=o})}else{let i=0;n.forEach(a=>{const o=t==="string"?Dh(a.vals):a.vals;let l=0;for(let c=0;c<a.shape[0];++c){const u=c*e[1]+i;for(let d=0;d<a.shape[1];++d)s[u+d]=o[l++]}i+=a.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cee=Ns((n,e)=>n===e?1:0),Aee=ni(_T,Cee,null,"bool"),NLe={kernelName:_T,backendName:"cpu",kernelFunc:Aee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nee=$u(n=>Math.exp(n)),kee=Vf(Fb,Nee,"float32"),kLe={kernelName:Fb,backendName:"cpu",kernelFunc:kee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iee=$u(n=>Math.expm1(n)),ILe=Vf(Bb,Iee),RLe={kernelName:Bb,backendName:"cpu",kernelFunc:ILe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ree=$u(n=>Math.floor(n)),DLe=Vf(zb,Ree),$Le={kernelName:zb,backendName:"cpu",kernelFunc:DLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dee=Ns((n,e)=>Math.floor(n/e)),LLe=ni(jb,Dee,null,"int32"),PLe={kernelName:jb,backendName:"cpu",kernelFunc:LLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(n,e,t,r,s,i,a,o,l){const c=En([r,i],t);for(let u=0;u<r;u++){const d=[];let p=0;for(let x=0;x<s;x++){const y=n[u*s+x];p+=y*a[x],d.push(y)}if(p<0||p>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${o}`);for(let x=0;x<i;x++)c.values[u*i+x]=e.get(...e.indexToLoc(p*i+x))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lee(n,e,t){const r=En(t,n.dtype);for(let s=0;s<r.size;++s){const a=r.indexToLoc(s).slice(),o=a[0],l=a[2],c=e.locToIndex([o,l]);a[2]=e.values[c];const u=n.locToIndex(a);0<=u&&u<n.values.length&&(r.values[s]=n.values[u])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pee=Ns((n,e)=>n>e?1:0),OLe=ni(TT,Pee,null,"bool"),MLe={kernelName:TT,backendName:"cpu",kernelFunc:OLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oee=Ns((n,e)=>n>=e?1:0),FLe=ni(Vb,Oee,null,"bool"),BLe={kernelName:Vb,backendName:"cpu",kernelFunc:FLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mee=Ns((n,e)=>n<e?1:0),zLe=ni(AT,Mee,null,"bool"),jLe={kernelName:AT,backendName:"cpu",kernelFunc:zLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fee=Ns((n,e)=>n<=e?1:0),VLe=ni(NT,Fee,null,"bool"),ULe={kernelName:NT,backendName:"cpu",kernelFunc:VLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bee(n,e,t){const r=(e-n)/(t-1),s=ea(t,"float32");s[0]=n;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zee=$u(n=>Math.log(n)),GLe=Vf(qb,zee),HLe={kernelName:qb,backendName:"cpu",kernelFunc:GLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(n,e,t,r){const s=Ji(r,Ue(t));for(let i=0;i<s.length;++i){const a=i*e;let o=n[a];for(let l=0;l<e;++l){const c=n[a+l];(Number.isNaN(c)||c>o)&&(o=c)}s[i]=o}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vee=Ns(((n,e)=>Math.max(n,e))),WLe=ni(Xb,Vee),qLe={kernelName:Xb,backendName:"cpu",kernelFunc:WLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uee=Ns(((n,e)=>Math.min(n,e))),KLe=ni(Yb,Uee),XLe={kernelName:Yb,backendName:"cpu",kernelFunc:KLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z6=Ns(((n,e)=>n*e)),YLe=F6(((n,e,t,r)=>({real:n*t-e*r,imag:n*r+e*t}))),IC=ni(Qb,z6,YLe),ZLe={kernelName:Qb,backendName:"cpu",kernelFunc:IC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gee(n,e,t){const r=Pf(-1,t);return z6([],e,r,n,t)}function QLe(n){const{inputs:e,backend:t}=n,{x:r}=e;_t(r,"neg");const s=t.data.get(r.dataId).values,[i,a]=Gee(s,r.shape,r.dtype);return t.makeTensorInfo(a,r.dtype,i)}const JLe={kernelName:BT,backendName:"cpu",kernelFunc:QLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hee=Ns(((n,e)=>n!==e?1:0)),ePe=ni(zT,Hee,null,"bool"),tPe={kernelName:zT,backendName:"cpu",kernelFunc:ePe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(n,e,t,r,s){const i=e.length,a=Ue(e),o=kt(e),l=kt(s),c=Ji(t,Ue(s));for(let u=0;u<a;++u){const d=tx(u,i,o),p=new Array(d.length);for(let y=0;y<p.length;y++)p[y]=d[r[y]];const x=uu(p,i,l);c[x]=n[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function no(n){const{inputs:e,attrs:t,backend:r}=n,{x:s}=e,{perm:i}=t;_t(s,"transpose");const a=s.shape.length,o=new Array(a);for(let d=0;d<o.length;d++)o[d]=s.shape[i[d]];const l=r.data.get(s.dataId).values,c=j6(l,s.shape,s.dtype,i,o);return{dataId:r.write(c,o,s.dtype),shape:o,dtype:s.dtype}}const nPe={kernelName:ag,backendName:"cpu",kernelFunc:no};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(n,e,t,r){const[s,i]=xi(n,r),a=wo(e,"int32"),o=ea(Ue(s),a),l=Ue(i);for(let c=0;c<o.length;++c){const u=c*l;let d=1;for(let p=0;p<l;++p)d*=t[u+p];o[c]=d}return{outVals:o,outShape:s,outDtype:a}}function rPe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;_t(s,"prod");const o=s.shape.length,l=Sn(i,s.shape),c=os(l,o);let u=l,d=s;const p=[];c!=null&&(d=no({inputs:{x:s},backend:t,attrs:{perm:c}}),p.push(d),u=Cs(u.length,o));const x=t.data.get(d.dataId).values,{outVals:y,outShape:v,outDtype:b}=Wee(d.shape,d.dtype,x,u);let S=v;return a&&(S=Us(v,l)),p.forEach(T=>t.disposeIntermediateTensorInfo(T)),t.makeTensorInfo(S,b,y)}const sPe={kernelName:WT,backendName:"cpu",kernelFunc:rPe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iPe(n,e,t){n.forEach((r,s)=>{if(r<0||r>=t){const i=tx(s,e.length,kt(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${t})`)}})}function aPe(n,e){for(let t=0;t<n.length;++t){const r=n[t],s=t===n.length-1?e:n[t+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function oPe(n,e,t,r){const s=[];let i=0;const a=e.length-1+t.length,o=new Array(a).fill(null).map(()=>[0]);aPe(t,r);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)o[c].push(d*u)}for(let c=0;c<n.length;++c){let u=n[c],d=n[c]+1;for(let p=0;p<t.length;++p){const x=t[p],y=p+e.length-1;if(y>=0){const v=o[y],b=v[v.length-1]-x[u];for(let S=u;S<d;++S)o[y].push(x[S+1]+b)}u=x[u],d=x[d]}d!==u&&(s.push([u,d]),i+=d-u)}return{outSplits:o,valueSlices:s,numValues:i}}function lPe(n){const e=[];for(let t=0;t<n.length;++t){const r=n[t].length,s=vs("int32",r);e.push(s),n[t].forEach((i,a)=>s[a]=i)}return e}function HB(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let r=e;r<n.length;r++)t[e-1]*=n[r];return t}function cPe(n,e,t,r,s,i){const a=HB(e,2)[1],o=HB(i,2)[1];let l=0;for(const c of t)for(let u=c[0];u<c[1];++u){for(let d=0;d<r;++d)s[l*o+d]=n[u*a+d];++l}}function uPe(n,e,t,r,s){const i=e.slice();i[0]=s;const a=vs(t,Ue(i)),o=n.length,l=o===0?0:o/e[0];return cPe(n,e,r,l,a,i),[a,i]}function qee(n,e,t,r,s,i,a,o){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(iPe(i,a,l),r.length===0)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:u,valueSlices:d,numValues:p}=oPe(i,a,n,c),x=lPe(u),y=uPe(t,r,s,d,p);return[x,y[0],y[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WB=2147483647;function Kee(n,e,t,r,s,i,a){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const o=e.length===0,l=s.length===0,c=a.length===0,u=[];o||u.push(e[0]),l||u.push(s[0]),c||u.push(a[0]);for(let b=1;b<u.length;++b)if(u[b]!==u[b-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],p=vs("int32",d+1);p[0]=0;for(let b=0;b<d;++b){const S=o?n[0]:n[b],T=l?r[0]:r[b],C=c?i[0]:i[b];if(C===0)throw new Error("Requires delta != 0");let I;if(C>0&&T<S||C<0&&T>S)I=0;else if(I=Math.ceil(Math.abs((T-S)/C)),I>WB)throw new Error(`Requires ((limit - start) / delta) <= ${WB}`);p[b+1]=p[b]+I}const x=p[d],y=vs(t,x);let v=0;for(let b=0;b<d;++b){const S=p[b+1]-p[b];let T=o?n[0]:n[b];const C=c?i[0]:i[b];for(let I=0;I<S;++I)y[v++]=T,T+=C}return[p,y]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bl=ac;class QE{constructor(e,t,r,s,i,a,o,l,c,u){this.shape=e,this.shapeShape=t,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=a,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=$Z(u),this.raggedRank=LZ(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===bl.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===bl.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case bl.VALUE_ROWIDS:return QE.getMaxWidthValueRowID(t);case bl.ROW_SPLITS:return QE.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${bl[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let r=0;for(let s=0;s<t-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let r=0,s=e[0],i=0;for(let a=1;a<t;++a){const o=e[a];o!==s&&(s=o,i=Math.max(a-r,i),r=a)}return Math.max(t-r,i)}tensorShapeFromTensor(e,t,r=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return KB(e,r)}calculateOutputSize(e){const t=this.valuesShape,r=this.defaultValueShape;PZ(r,t);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=DZ(this.raggedRank,s,t);a[0]<0&&(a[0]=e);for(let o=1;o<=this.raggedRank;++o)a[o]<0&&(a[o]=this.getMaxWidth(o));return a}calculateFirstParentOutputIndex(e,t,r){const s=Math.min(e,r),i=[];let a=0;for(let o=0;o<s;++o,a+=t)i.push(a);for(let o=s;o<e;++o)i.push(-1);return ue(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,t,r,s){const i=e.length,a=[];for(let o=0;o<i-1;++o){const l=e[o+1]-e[o];let c=Math.min(s,l),u=t[o];u===-1&&(c=0);for(let d=0;d<c;++d)a.push(u),u+=r;for(let d=0;d<l-c;++d)a.push(-1)}if(i>0&&a.length!==e[i-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,t,r,s){const i=e.length,a=[];if(i===0)return[];let o=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let c=t[l];a.push(c);for(let u=1;u<i;++u){const d=e[u];if(d===l)c>=0&&(++o,o<s?c+=r:c=-1);else{if(o=0,l=d,d>=t.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${t.length}`);c=t[d]}a.push(c)}if(a.length!==e.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(e,t,r,s){const i=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case bl.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,r,s);case bl.ROW_SPLITS:if(i.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,r,s);default:throw new Error(`Unsupported partition type: ${bl[a]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case bl.FIRST_DIM_SIZE:return e[0];case bl.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case bl.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${bl[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),r=this.calculateOutputSize(t),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const i=KB(r,!1),a=vs(this.valuesDType,Ue(i));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(t,s[0],r[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,s[c],r[c]);this.setOutput(this.raggedRank,l,a,i)}return[i,a]}setOutput(e,t,r,s){if(r.length===0)return;const i=this.values,a=r;let o=s.slice();o=o.slice(e+1);const l=Ue(o),c=t.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const y=this.defaultValueShape;De(()=>{const v=Ce(u,y);u=Ky(v,o).dataSync()})}let d=0,p=0,x=0;for(let y=0;y<=c;++y){let v=y<c?t[y]:-1;if(v===x){++x;continue}if(p<x){const b=i.subarray(d*l),S=a.subarray(p*l),T=(x-p)*l;qB(S,b,T)}if(y>=c){const b=r.length;v=Math.floor(b/l)}if(v>x)if(this.defaultValue.length===1)a.subarray(x*l,v*l).fill(this.defaultValue[0]),x=v;else for(;v>x;){const b=a.slice(x*l);qB(b,u,l),++x}v<0?(d=y+1,p=x):(d=y,p=x,x=p+1)}}}function qB(n,e,t){for(let r=0;r<t;r++)n[r]=e[r]}function KB(n,e){const t=[];for(let r of n){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}t.push(r)}return t}function Xee(n,e,t,r,s,i,a,o,l,c){return new QE(n,e,t,r,s,i,a,o,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yee(n,e,t,r){const s=n===e,i=n<e&&t<0,a=e<n&&t>1;if(s||i||a)return ea(0,r);const o=Math.abs(Math.ceil((e-n)/t)),l=ea(o,r);e<n&&t===1&&(t=-1),l[0]=n;for(let c=1;c<l.length;c++)l[c]=l[c-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zee=$u(n=>1/Math.sqrt(n)),hPe=Vf(sv,Zee),dPe={kernelName:sv,backendName:"cpu",kernelFunc:hPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $p(n,e,t,r,s,i,a,o,l,c){const u=[r/s,s],d=n.values,p=e.values;if(r===0)return En(t,e.dtype);const x=l instanceof Oi?l:En(u,e.dtype);typeof l=="string"||typeof l=="number"?x.values.fill(l):typeof l=="boolean"&&x.values.fill(+l);for(let y=0;y<i;y++){const v=[];let b=0;for(let S=0;S<a;S++){const T=d[y*a+S];v.push(T),b+=T*o[S]}if(b<0||b>=r/s)throw new Error(`Invalid indices: ${v} does not index into ${t}`);for(let S=0;S<s;S++)c?x.values[b*s+S]+=p[y*s+S]:x.values[b*s+S]=e.rank===0?p[0]:p[y*s+S]}return x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fPe=$u(n=>1/(1+Math.exp(-n))),Qee=_r(cv,n=>1/(1+Math.exp(-n))),pPe={kernelName:cv,backendName:"cpu",kernelFunc:Qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(n,e,t,r,s){const i=K$(r,e,t),a=Ue(t),o=kt(r);if(i){const d=X$(e,o);return s==="string"?n.slice(d,d+a):n.subarray(d,d+a)}const l=s==="string"?Dh(n):n,c=En(r,s,l),u=En(t,s);for(let d=0;d<u.size;++d){const p=u.indexToLoc(d),x=p.map((y,v)=>y+e[v]);u.set(c.get(...x),...p)}return s==="string"?tQ(u.values):u.values}function wm(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,size:a}=r;_t(s,"slice");const[o,l]=mC(s,i,a);W$(s,o,l);const c=t.data.get(s.dataId).values,u=Jee(c,o,l,s.shape,s.dtype);return t.makeTensorInfo(l,s.dtype,u)}const mPe={kernelName:QT,backendName:"cpu",kernelFunc:wm};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(n,e,t,r,s,i,a){const o=e[0],l=i[0],c=new Array(l),u=new Array(o),d=e[1];if(l===0){if(o!==0)throw new Error(VZ(o));const b=vs(t,0),S=vs(s,0);return[b,[0,d],S,c,u]}let p=!0,x=0;const y=new Array(l).fill(0);for(let b=0;b<o;++b){const S=n[b*d];if(S<0)throw new Error(UZ(b,S));if(S>=l)throw new Error(GZ(b,S,l));++y[S],p=p&&S>=x,x=S}let v=!0;for(let b=0;b<l;++b){const S=y[b]===0;c[b]=S,v=v&&!S,y[b]=Math.max(y[b],1),b>0&&(y[b]+=y[b-1])}if(v&&p){const b=n,S=r;for(let T=0;T<o;++T)u[T]=T;return[b,[o,d],S,c,u]}else{const b=y[l-1],S=vs(t,b*d),T=vs(s,b),C=new Array(l).fill(0);for(let I=0;I<o;++I){const $=n[I*d],q=C[$],U=($===0?0:y[$-1])+q;C[$]++;for(let F=0;F<d;++F)S[U*d+F]=n[I*d+F];T[U]=r[I],u[I]=U}for(let I=0;I<l;++I)if(C[I]===0){const q=I===0?0:y[I-1];S[q*d+0]=I;for(let U=1;U<d;++U)S[q*d+U]=0;T[q]=a}return[S,[b,d],T,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tte(n,e,t,r,s){const i=Ue(r),a=e[0],o=s.length,l=[];let c=1,u=-1;for(let b=0;b<o;++b){const S=s[b];if(S===-1){if(u!==-1)throw new Error(HZ(u,b));u=b,l.push(1)}else{if(S<0)throw new Error(WZ(b,S));c*=S,l.push(S)}}if(u!==-1){if(c<=0)throw new Error(qZ());const b=Math.trunc(i/c);if(c*b!==i)throw new Error(KZ(r,l));l[u]=b}if(Ue(l)!==i)throw new Error(XZ(r,l));const p=r.length,x=[];if(p>0){x[p-1]=1;for(let b=p-2;b>=0;--b)x[b]=x[b+1]*r[b+1]}const y=[];if(o>0){y[o-1]=1;for(let b=o-2;b>=0;--b)y[b]=y[b+1]*l[b+1]}const v=vs(t,a*o);for(let b=0;b<a;++b){let S=0;for(let T=0;T<p;++T)S+=n[b*p+T]*x[T];for(let T=0;T<o;++T)v[b*o+T]=Math.trunc(S/y[T]),S%=y[T]}return[v,[a,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V6(n,e,t,r,s,i=!1,a=0){const o=r.length,l=[e[0],n.length/e[0]],c=l[1],d=o>0?s[o-1]+1:0;if(d<0)throw new Error(S3());const p=e.slice();p[0]=d;const x=p.reduce((C,I)=>C*I,1),y=vs(t,x);if(o===0)return d>0&&y.fill(a),[y,p];if(d<=0)throw new Error(S3());let v=0,b=1,S=0,T=s[v];for(;;){let C=0;if(b<o){if(C=s[b],T===C){++b;continue}if(T>=C)throw new Error(YZ())}if(T<0||T>=d)throw new Error(ZZ(T,d));T>S&&y.fill(a,S*c,T*c);for(let I=v;I<b;++I){const $=r[I];if($<0||$>=l[0])throw new Error(QZ(I,r[I],l[0]));for(let q=0;q<c;q++)y[T*c+q]+=n[$*c+q]}if(i)for(let I=0;I<c;I++)y[T*c+I]/=b-v;if(v=b,++b,S=T+1,T=C,b>o)break}return S<d&&y.fill(a,S*c,d*c),[y,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gPe=$u(n=>Math.sqrt(n)),xPe=_r(hv,n=>Math.sqrt(n)),yPe={kernelName:hv,backendName:"cpu",kernelFunc:xPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nte=Ns(((n,e)=>{const t=n-e;return t*t})),bPe=ni(dv,nte),vPe={kernelName:dv,backendName:"cpu",kernelFunc:bPe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rte=$u((n,e)=>{const{pattern:t,replaceGlobal:r,rewrite:s}=e;return n.replace(new RegExp(t,r?"g":""),s)}),_Pe=Vf(l$,rte),wPe={kernelName:l$,backendName:"cpu",kernelFunc:_Pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ste(n,e,t,r){const s=En(n,e.dtype);for(let i=0;i<s.size;i++){const a=s.indexToLoc(i),o=new Array(a.length);for(let l=0;l<o.length;l++)o[l]=a[l]*t[l]+r[l];s.set(e.get(...o),...a)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EPe{constructor(e,t,r,s,i,a){this.separator=Jd(e),this.nGramWidths=t,this.leftPad=Jd(r),this.rightPad=Jd(s),this.padWidth=i,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,s,i,a){for(let o=0;o<i;++o){const l=this.getPadWidth(a),c=Math.max(0,l-o),u=Math.max(0,l-(i-(o+1))),d=a-(c+u),p=t+(c>0?0:o-l);let x=0;x+=c*this.leftPad.length;for(let T=0;T<d;++T)x+=e[p+T].length;x+=u*this.rightPad.length;const y=c+u+d-1;x+=y*this.separator.length,r[s+o]=new Uint8Array(x);const v=r[s+o];let b=0;const S=T=>T.forEach(C=>v[b++]=C);for(let T=0;T<c;++T)S(this.leftPad),S(this.separator);for(let T=0;T<d-1;++T)S(e[p+T]),S(this.separator);if(d>0){S(e[p+d-1]);for(let T=0;T<u;++T)S(this.separator),S(this.rightPad)}else{for(let T=0;T<u-1;++T)S(this.rightPad),S(this.separator);S(this.rightPad)}}}compute(e,t){const r=e.length,s=t.length;if(s>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<s;++c){let u=t[c]>=l;if(u=u&&t[c]<=r,!u)throw new Error(`Invalid split value ${t[c]}, must be in [${l}, ${r}]`);l=t[c]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=s-1,a=vs("int32",s);if(r===0||s===0){const l=new Array(r);for(let c=0;c<=i;++c)a[c]=0;return[l,a]}a[0]=0;for(let l=1;l<=i;++l){const c=t[l]-t[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),a[l]=a[l-1]+u}const o=new Array(a[i]);for(let l=0;l<i;++l){const c=t[l];let u=a[l];if(this.nGramWidths.forEach(d=>{const p=t[l+1]-t[l],x=this.getNumNGrams(p,d);this.createNGrams(e,c,o,u,x,d),u+=x}),this.preserveShort&&u===a[l]){const d=t[l+1]-t[l];if(d===0)continue;const p=d+2*this.padWidth;this.createNGrams(e,c,o,u,1,p)}}return[o,a]}}function ite(n,e,t,r,s,i,a,o){return new EPe(t,r,s,i,a,o).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SPe(n,e,t,r){if(!n.length)return;if(e.length===0){for(let i=0;i<n.length;++i)r.push(n.subarray(i,i+1));return}if(e.length===1){const i=e[0];let a=n.indexOf(i);for(;a!==-1;){const o=n.subarray(0,a);(!t||o.length!==0)&&r.push(o),n=n.subarray(a+1),a=n.indexOf(i)}(!t||n.length!==0)&&r.push(n);return}let s=0;for(let i=0;i<n.length+1;i++)if(i===n.length||e.indexOf(n[i])!==-1){const a=n.subarray(s,i);(!t||a.length!==0)&&r.push(a),s=i+1}}function ate(n,e,t){const r=n.length,s=[];let i=0,a=0;const o=new Array(r);for(let p=0;p<r;++p){const x=s.length;SPe(n[p],e,t,s);const y=s.length-x;o[p]=y,i+=y,a=Math.max(a,y)}const l=vs("int32",i*2),c=new Array(i),u=[r,a];let d=0;for(let p=0;p<r;++p)for(let x=0;x<o[p];++x)l[d*2]=p,l[d*2+1]=x,c[d]=s[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(n,e){const t=vs("int32",n.length);for(let r=0;r<n.length;++r)t[r]=wAe(n[r]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lte=Ns(((n,e)=>n-e)),TPe=F6(((n,e,t,r)=>({real:n-t,imag:e-r}))),U6=ni(fv,lte,TPe),CPe={kernelName:fv,backendName:"cpu",kernelFunc:U6};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(n,e){const t=new Array(n.rank);for(let s=0;s<t.length;s++)t[s]=n.shape[s]*e[s];const r=En(t,n.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),a=new Array(n.rank);for(let l=0;l<a.length;l++)a[l]=i[l]%n.shape[l];const o=n.locToIndex(a);r.values[s]=n.values[o]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dy=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function ute(n,e,t=0,r=n.length-1){for(;r>t;){if(r-t>600){const o=r-t+1,l=e-t+1,c=Math.log(o),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(o-u)/o)*Math.sign(l-o/2),p=Math.max(t,Math.floor(e-l*u/o+d)),x=Math.min(r,Math.floor(e+(o-l)*u/o+d));ute(n,e,p,x)}const s=n[e];let i=t,a=r;for(F0(n,t,e),Dy(n[r],s)>0&&F0(n,t,r);i<a;){for(F0(n,i,a),i++,a--;Dy(n[i],s)<0;)i=i+1;for(;Dy(n[a],s)>0;)a=a-1}Dy(n[t],s)===0?F0(n,t,a):(a=a+1,F0(n,a,r)),a<=e&&(t=a+1),e<=a&&(r=a-1)}}function hte(n,e,t,r,s){const i=e[e.length-1],[a,o]=[n.length/i,i],l=Ji(t,a*r),c=Ji("int32",a*r);for(let d=0;d<a;d++){const p=d*o,x=n.subarray(p,p+o);let y=new Array(x.length);x.forEach((T,C)=>y[C]={value:T,index:C}),r<y.length&&(ute(y,r),y=y.slice(0,r)),s&&y.sort(Dy);const v=d*r,b=l.subarray(v,v+r),S=c.subarray(v,v+r);for(let T=0;T<r;T++)b[T]=y[T].value,S[T]=y[T].index}const u=e.slice();return u[u.length-1]=r,[En(u,t,l),En(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(n,e,t,r){const s=Sn(e,t)[0],i=[1,t[0],1];for(let y=0;y<s;y++)i[0]*=t[y];i[1]=t[s];for(let y=s+1;y<t.length;y++)i[2]*=t[y];const a=new Map,o=new Int32Array(t[s]),l=new Oi(i,r,n),c=[],u=i[0]===1&&i[2]===1;for(let y=0;y<t[s];y++){let v;if(u)v=n[y].toString();else{const S=[];for(let T=0;T<i[0];T++)for(let C=0;C<i[2];C++)S.push(l.get(T,y,C));v=S.join(",")}const b=a.get(v);if(b!=null)o[y]=b;else{const S=a.size;a.set(v,S),o[y]=S,c.push(y)}}const d=i.slice();d[1]=a.size;const p=new Oi(d,r);c.forEach((y,v)=>{for(let b=0;b<i[0];b++)for(let S=0;S<i[2];S++)p.set(l.get(b,y,S),b,v,S)});const x=t.slice();return x[s]=d[1],{outputValues:p.values,outputShape:x,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const APe=Object.freeze(Object.defineProperty({__proto__:null,addImpl:_ee,bincountImpl:B6,bincountReduceImpl:wee,bitwiseAndImpl:Eee,castImpl:vee,ceilImpl:See,concatImpl:Tee,equalImpl:Cee,expImpl:Nee,expm1Impl:Iee,floorDivImpl:Dee,floorImpl:Ree,gatherNdImpl:$ee,gatherV2Impl:Lee,greaterEqualImpl:Oee,greaterImpl:Pee,lessEqualImpl:Fee,lessImpl:Mee,linSpaceImpl:Bee,logImpl:zee,maxImpl:jee,maximumImpl:Vee,minimumImpl:Uee,multiplyImpl:z6,negImpl:Gee,notEqualImpl:Hee,prodImpl:Wee,raggedGatherImpl:qee,raggedRangeImpl:Kee,raggedTensorToTensorImpl:Xee,rangeImpl:Yee,rsqrtImpl:Zee,scatterImpl:$p,sigmoidImpl:fPe,simpleAbsImpl:bee,sliceImpl:Jee,sparseFillEmptyRowsImpl:ete,sparseReshapeImpl:tte,sparseSegmentReductionImpl:V6,sqrtImpl:gPe,squaredDifferenceImpl:nte,staticRegexReplaceImpl:rte,stridedSliceImpl:ste,stringNGramsImpl:ite,stringSplitImpl:ate,stringToHashBucketFastImpl:ote,subImpl:lte,tileImpl:cte,topKImpl:hte,transposeImpl:j6,uniqueImpl:dte},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */RY("cpu",()=>new kC,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fte=_r(Ob,n=>n>=0?n:Math.exp(n)-1),NPe={kernelName:Ob,backendName:"cpu",kernelFunc:fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{alpha:i}=r;_t([s],"leakyRelu");const a=Ue(s.shape),o=t.data.get(s.dataId).values,l=Ji("float32",a);for(let c=0;c<o.length;c++)l[c]=o[c]<0?i*o[c]:o[c];return t.makeTensorInfo(s.shape,"float32",l)}const kPe={kernelName:CT,backendName:"cpu",kernelFunc:pte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IPe=Ns((n,e)=>n<0?e*n:n);function mte(n){const{inputs:e,backend:t}=n,{x:r,alpha:s}=e;_t([r,s],"prelu");const i=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,[o,l]=IPe(r.shape,s.shape,i,a,"float32");return t.makeTensorInfo(l,"float32",o)}const RPe={kernelName:HT,backendName:"cpu",kernelFunc:mte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gte=_r(tv,n=>Math.max(0,n)),DPe={kernelName:tv,backendName:"cpu",kernelFunc:gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xte=_r(nv,n=>Math.min(Math.max(0,n),6)),$Pe={kernelName:nv,backendName:"cpu",kernelFunc:xte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JE(n,e,t,r,s){if(t==="linear")return Nu({inputs:{x:e},backend:n});if(t==="relu")return gte({inputs:{x:e},backend:n});if(t==="elu")return fte({inputs:{x:e},backend:n});if(t==="relu6")return xte({inputs:{x:e},backend:n});if(t==="prelu")return mte({inputs:{x:e,alpha:r},backend:n});if(t==="leakyrelu")return pte({inputs:{x:e},backend:n,attrs:{alpha:s}});if(t==="sigmoid")return Qee({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{shape:i}=r,a=Ue(s.shape),o=VX(i,a),l=Ue(o);ue(a===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`),t.incRef(s.dataId);const c=t.data.get(s.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=o,d.shape=o}return{dataId:s.dataId,shape:o,dtype:s.dtype}}const LPe={kernelName:qT,backendName:"cpu",kernelFunc:Fr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yte(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i}=e,{transposeA:a,transposeB:o}=r;_t([s,i],"matMul");const l=s.shape.length,c=i.shape.length,u=a?s.shape[l-2]:s.shape[l-1],d=o?i.shape[c-1]:i.shape[c-2],p=a?s.shape[l-1]:s.shape[l-2],x=o?i.shape[c-2]:i.shape[c-1],y=s.shape.slice(0,-2),v=i.shape.slice(0,-2),b=Ue(y),S=Ue(v),C=cn(s.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,x]);ue(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${s.shape} and ${i.shape} and transposeA=${a} and transposeB=${o} must match.`);const I=a?[b,u,p]:[b,p,u],$=o?[S,x,d]:[S,d,x],q=Fr({inputs:{x:s},backend:t,attrs:{shape:I}}),U=Fr({inputs:{x:i},backend:t,attrs:{shape:$}}),F=a?q.shape[1]:q.shape[2],G=a?q.shape[2]:q.shape[1],V=o?U.shape[1]:U.shape[2],O=Math.max(b,S),K=t.data.get(q.dataId).values,P=t.data.get(U.dataId).values,N=kt(q.shape),M=kt(U.shape),[B,Y,Z]=a?[N[0],1,N[1]]:[N[0],N[1],1],[ne,Q,z]=o?[1,M[1],M[0]]:[M[1],1,M[0]],D=G*V,X=En([O,G,V],q.dtype),re=X.values,W=t.blockSize;for(let ae=0;ae<O;ae++){const pe=ae%b,de=ae%S;for(let ve=0;ve<G;ve+=W){const Ve=Math.min(ve+W,G);for(let ze=0;ze<V;ze+=W){const Ge=Math.min(ze+W,V);for(let at=0;at<F;at+=W){const We=Math.min(at+W,F);for(let nt=ve;nt<Ve;nt++)for(let Nt=ze;Nt<Ge;Nt++){let ct=0;for(let xt=at;xt<We;xt++){const en=K[pe*B+nt*Y+xt*Z],ht=P[xt*ne+Nt*Q+de*z];ct+=en*ht}re[ae*D+(nt*V+Nt)]+=ct}}}}}return t.disposeIntermediateTensorInfo(q),t.disposeIntermediateTensorInfo(U),t.makeTensorInfo(C,X.dtype,X.values)}const PPe={kernelName:hT,backendName:"cpu",kernelFunc:yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OPe(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;let p,x,y;const v=[];p=yte({inputs:{a:s,b:i},attrs:{transposeA:l,transposeB:c},backend:t}),a&&(x=Ig({inputs:{a:p,b:a},backend:t}),v.push(p),p=x),u&&(y=JE(t,p,u,o,d),v.push(p),p=y);for(const S of v)t.disposeIntermediateTensorInfo(S);return p}const MPe={kernelName:$E,backendName:"cpu",kernelFunc:OPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FPe=_r(Eb,n=>Math.acos(n)),BPe={kernelName:Eb,backendName:"cpu",kernelFunc:FPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zPe=_r(Sb,n=>Math.acosh(n)),jPe={kernelName:Sb,backendName:"cpu",kernelFunc:zPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VPe(n){const{inputs:e,backend:t}=n,r=e;_t(e,"addN");const s=r.map(o=>t.data.get(o.dataId).values),i=En(r[0].shape,r[0].dtype),a=i.values;for(let o=0;o<r.length;o++){const l=s[o];for(let c=0;c<a.length;c++)a[c]+=l[c]}return t.makeTensorInfo(i.shape,i.dtype,i.values)}const UPe={kernelName:AD,backendName:"cpu",kernelFunc:VPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GPe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;_t(s,"all");const o=Sn(i,s.shape);let l=o;const c=os(l,s.shape.length);let u=s;c!=null&&(u=no({inputs:{x:s},backend:t,attrs:{perm:c}}),l=Cs(l.length,s.shape.length)),Bi("all",l,u.shape.length);const[d,p]=xi(u.shape,l),x=Ue(p),y=ea(Ue(d),u.dtype),v=t.data.get(u.dataId).values;for(let S=0;S<y.length;++S){const T=S*x;let C=v[T];for(let I=0;I<x;++I){const $=v[T+I];C=C&&$}y[S]=C}c!=null&&t.disposeIntermediateTensorInfo(u);const b=t.makeTensorInfo(d,u.dtype,y);if(a){const S=Us(d,o),T=Fr({inputs:{x:b},backend:t,attrs:{shape:S}});return t.disposeIntermediateTensorInfo(b),T}return b}const HPe={kernelName:ND,backendName:"cpu",kernelFunc:GPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WPe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;_t(s,"any");const o=Sn(i,s.shape);let l=o;const c=os(l,s.shape.length);let u=s;c!=null&&(u=no({inputs:{x:s},backend:t,attrs:{perm:c}}),l=Cs(l.length,s.shape.length)),Bi("any",l,u.shape.length);const[d,p]=xi(u.shape,l),x=Ue(p),y=ea(Ue(d),u.dtype),v=t.data.get(u.dataId).values;for(let S=0;S<y.length;++S){const T=S*x;let C=v[T];for(let I=0;I<x;++I){const $=v[T+I];C=C||$}y[S]=C}c!=null&&t.disposeIntermediateTensorInfo(u);const b=t.makeTensorInfo(d,u.dtype,y);if(a){const S=Us(d,o),T=Fr({inputs:{x:b},backend:t,attrs:{shape:S}});return t.disposeIntermediateTensorInfo(b),T}return b}const qPe={kernelName:kD,backendName:"cpu",kernelFunc:WPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KPe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;_t(s,"argMax");let a=Sn(i,s.shape);const o=os(a,s.shape.length);let l=s;const c=[];o!=null&&(l=no({inputs:{x:s},backend:t,attrs:{perm:o}}),c.push(l),a=Cs(a.length,l.shape.length)),a=[a[0]],Bi("argMax",a,l.shape.length);const[u,d]=xi(l.shape,a),p=Ue(u),x=ea(p,"int32"),y=Ue(d),v=t.data.get(l.dataId).values;for(let b=0;b<x.length;++b){const S=b*y;let T=v[S],C=0;for(let I=0;I<y;++I){const $=v[S+I];$>T&&(T=$,C=I)}x[b]=C}return c.forEach(b=>t.disposeIntermediateTensorInfo(b)),t.makeTensorInfo(u,"int32",x)}const XPe={kernelName:oT,backendName:"cpu",kernelFunc:KPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YPe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;_t(s,"argMin");let a=Sn(i,s.shape);const o=os(a,s.shape.length);let l=s;const c=[];o!=null&&(l=no({inputs:{x:s},backend:t,attrs:{perm:o}}),c.push(l),a=Cs(a.length,l.shape.length)),a=[a[0]],Bi("argMin",a,l.shape.length);const[u,d]=xi(l.shape,a),p=Ue(u),x=ea(p,"int32"),y=Ue(d),v=t.data.get(l.dataId).values;for(let b=0;b<x.length;++b){const S=b*y;let T=v[S],C=0;for(let I=0;I<y;++I){const $=v[S+I];$<T&&(T=$,C=I)}x[b]=C}return c.forEach(b=>t.disposeIntermediateTensorInfo(b)),t.makeTensorInfo(u,"int32",x)}const ZPe={kernelName:lT,backendName:"cpu",kernelFunc:YPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QPe=_r(Tb,n=>Math.asin(n)),JPe={kernelName:Tb,backendName:"cpu",kernelFunc:QPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eOe=_r(Cb,n=>Math.asinh(n)),tOe={kernelName:Cb,backendName:"cpu",kernelFunc:eOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nOe=_r(Ab,n=>Math.atan(n)),rOe={kernelName:Ab,backendName:"cpu",kernelFunc:nOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sOe=Ns((n,e)=>Math.atan2(n,e)),iOe=ni(kb,sOe),aOe={kernelName:kb,backendName:"cpu",kernelFunc:iOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oOe=_r(Nb,n=>Math.atanh(n)),lOe={kernelName:Nb,backendName:"cpu",kernelFunc:oOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(n,e,t,r,s,i){const a=s.strideHeight,o=s.strideWidth,l=s.dilationHeight,c=s.dilationWidth,u=s.effectiveFilterHeight,d=s.effectiveFilterWidth,p=s.padInfo.top,x=s.padInfo.left,y=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=En(s.outShape,t),b=v.values,S=s.outShape[1]*s.outShape[2]*s.outShape[3],T=s.outShape[2]*s.outShape[3],C=s.outShape[3];for(let I=0;I<s.batchSize;++I){const $=I*S,q=I*r[0];for(let U=0;U<s.inChannels;++U)for(let F=0;F<s.outHeight;++F){const G=F*a-p,V=Math.max(0,G),O=Math.min(s.inHeight,u+G),K=$+F*T;for(let P=0;P<s.outWidth;++P){const N=P*o-x,M=Math.max(0,N),B=Math.min(s.inWidth,d+N);let Y=y,Z=0,ne=0;for(let z=V;z<O;z+=l){const D=q+z*r[1];for(let X=M;X<B;X+=c){const re=D+X*r[2],W=n[re+U];i==="max"&&W>Y?Y=W:i==="avg"&&(Z+=W,ne++)}if(isNaN(Y))break}const Q=K+P*C+U;b[Q]=i==="avg"?Z/ne:Y}}}return v}function bte(n,e,t,r,s=!1,i=!1){const a=En(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,x=r.padInfo.top,y=r.padInfo.left,v=En(e,t,n);for(let b=0;b<r.batchSize;++b)for(let S=0;S<r.inChannels;++S)for(let T=0;T<r.outHeight;++T){const C=T*o-x;let I=C;for(;I<0;)I+=c;const $=Math.min(r.inHeight,d+C);for(let q=0;q<r.outWidth;++q){const U=q*l-y;let F=U;for(;F<0;)F+=u;const G=Math.min(r.inWidth,p+U);let V=Number.NEGATIVE_INFINITY,O=-1;for(let K=I;K<$;K+=c){const P=K-C;for(let N=F;N<G;N+=u){const M=N-U,B=v.get(b,K,N,S);B>V&&(V=B,s?O=i?((b*r.inHeight+K)*r.inWidth+N)*r.inChannels+S:(K*r.inWidth+N)*r.inChannels+S:O=P*p+M)}}a.set(O,b,T,q,S)}}return a}function vte(n,e,t,r,s,i){const a=s.strideDepth,o=s.strideHeight,l=s.strideWidth,c=s.dilationDepth,u=s.dilationHeight,d=s.dilationWidth,p=s.effectiveFilterDepth,x=s.effectiveFilterHeight,y=s.effectiveFilterWidth,v=s.padInfo.front,b=s.padInfo.top,S=s.padInfo.left,T=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,C=En(s.outShape,t),I=C.values,$=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],q=s.outShape[2]*s.outShape[3]*s.outShape[4],U=s.outShape[3]*s.outShape[4],F=s.outShape[4];for(let G=0;G<s.batchSize;++G){const V=G*$,O=G*r[0];for(let K=0;K<s.inChannels;++K)for(let P=0;P<s.outDepth;++P){const N=P*a-v;let M=N;for(;M<0;)M+=c;const B=Math.min(s.inDepth,p+N),Y=V+P*q;for(let Z=0;Z<s.outHeight;++Z){const ne=Z*o-b;let Q=ne;for(;Q<0;)Q+=u;const z=Math.min(s.inHeight,x+ne),D=Y+Z*U;for(let X=0;X<s.outWidth;++X){const re=X*l-S;let W=re;for(;W<0;)W+=d;const ae=Math.min(s.inWidth,y+re),pe=D+X*F;let de=T,ve=0,Ve=0;for(let Ge=M;Ge<B;Ge+=c){const at=O+Ge*r[1];for(let We=Q;We<z;We+=u){const nt=at+We*r[2];for(let Nt=W;Nt<ae;Nt+=d){const ct=nt+Nt*r[3],xt=n[ct+K];if(i==="max"&&xt>de?de=xt:i==="avg"&&(ve+=xt,Ve++),isNaN(de))break}if(isNaN(de))break}if(isNaN(de))break}const ze=pe+K;I[ze]=i==="avg"?ve/Math.max(Ve,1):de}}}}return C}function cOe(n,e){const t=En(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.front,x=e.padInfo.top,y=e.padInfo.left;for(let v=0;v<e.batchSize;++v)for(let b=0;b<e.inChannels;++b)for(let S=0;S<e.outDepth;++S){const T=S*r-p;let C=T;for(;C<0;)C+=a;const I=Math.min(e.inDepth,c+T);for(let $=0;$<e.outHeight;++$){const q=$*s-x;let U=q;for(;U<0;)U+=o;const F=Math.min(e.inHeight,u+q);for(let G=0;G<e.outWidth;++G){const V=G*i-y;let O=V;for(;O<0;)O+=l;const K=Math.min(e.inWidth,d+V);let P=Number.NEGATIVE_INFINITY,N=-1;for(let M=C;M<I;M+=a){const B=M-T;for(let Y=U;Y<F;Y+=o){const Z=Y-q;for(let ne=O;ne<K;ne+=l){const Q=ne-V,z=n.get(v,M,Y,ne,b);z>=P&&(P=z,N=B*u*d+Z*u+Q)}}}t.set(N,v,S,$,G,b)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;_t(s,"avgPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=r,c=1;ue(sa(a,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const u=Ml(s.shape,i,a,c,o,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&gr(u.inShape,u.outShape))d=Nu({inputs:{x:s},backend:t});else{const p=t.data.get(s.dataId).values,x=kt(s.shape),y=G6(p,s.shape,s.dtype,x,u,"avg");d=t.makeTensorInfo(u.outShape,s.dtype,y.values)}return d}const hOe={kernelName:cT,backendName:"cpu",kernelFunc:uOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:c}=r;_t(s,"avgPool3d");const u=Fh(s.shape,i,a,1,o,l,c),d=t.data.get(s.dataId).values,p=vte(d,s.shape,s.dtype,kt(s.shape),u,"avg");return t.makeTensorInfo(p.shape,"float32",p.values)}const fOe={kernelName:uT,backendName:"cpu",kernelFunc:dOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pOe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=r;_t([s,i],"avgPool3DGrad");const u=Fh(i.shape,a,o,1,l,c),d=u.strideDepth,p=u.strideHeight,x=u.strideWidth,y=u.filterDepth,v=u.filterHeight,b=u.filterWidth,S=u.dilationDepth,T=u.dilationHeight,C=u.dilationWidth,I=u.effectiveFilterDepth,$=u.effectiveFilterHeight,q=u.effectiveFilterWidth,U=I-1-u.padInfo.front,F=q-1-u.padInfo.left,G=$-1-u.padInfo.top,V=En(i.shape,"float32"),O=1/(y*v*b),K=t.bufferSync(s);for(let P=0;P<u.batchSize;++P)for(let N=0;N<u.inChannels;++N)for(let M=0;M<u.inDepth;++M)for(let B=0;B<u.inHeight;++B)for(let Y=0;Y<u.inWidth;++Y){const Z=M-U,ne=B-G,Q=Y-F;let z=0;for(let D=0;D<I;D+=S){const X=(Z+D)/d;if(!(X<0||X>=u.outDepth||Math.floor(X)!==X))for(let re=0;re<$;re+=T){const W=(ne+re)/p;if(!(W<0||W>=u.outHeight||Math.floor(W)!==W))for(let ae=0;ae<q;ae+=C){const pe=(Q+ae)/x;if(pe<0||pe>=u.outWidth||Math.floor(pe)!==pe)continue;const de=K.get(P,X,W,pe,N);z+=de}}}V.set(z*O,P,M,B,Y,N)}return t.makeTensorInfo(V.shape,V.dtype,V.values)}const mOe={kernelName:RD,backendName:"cpu",kernelFunc:pOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gOe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,a=i;_t([s,i],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=r,u=Ml(a.shape,o,l,1,c),d=u.strideHeight,p=u.strideWidth,x=u.filterHeight,y=u.filterWidth,v=u.dilationHeight,b=u.dilationWidth,S=u.effectiveFilterHeight,T=u.effectiveFilterWidth,C=T-1-u.padInfo.left,I=S-1-u.padInfo.top,$=En(a.shape,"float32"),q=1/(x*y),U=t.data.get(s.dataId).values,F=En(s.shape,"float32",U);for(let G=0;G<u.batchSize;++G)for(let V=0;V<u.inChannels;++V)for(let O=0;O<u.inHeight;++O)for(let K=0;K<u.inWidth;++K){const P=O-I,N=K-C;let M=0;for(let B=0;B<S;B+=v){const Y=(P+B)/d;if(!(Y<0||Y>=u.outHeight||Math.floor(Y)!==Y))for(let Z=0;Z<T;Z+=b){const ne=(N+Z)/p;if(ne<0||ne>=u.outWidth||Math.floor(ne)!==ne)continue;const Q=F.get(G,Y,ne,V);M+=Q}}$.set(M*q,G,O,K,V)}return t.makeTensorInfo($.shape,$.dtype,$.values)}const xOe={kernelName:ID,backendName:"cpu",kernelFunc:gOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,scale:i,offset:a,mean:o,variance:l}=e;ue(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ue(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ue(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),_t([s,o,l,i,a],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);const u=t.data.get(s.dataId).values,d=t.data.get(o.dataId).values,p=t.data.get(l.dataId).values,x=i?t.data.get(i.dataId).values:new Float32Array([1]),y=a?t.data.get(a.dataId).values:new Float32Array([0]),v=new Float32Array(u.length),b=y.length,S=x.length,T=p.length,C=d.length;let I=0,$=0,q=0,U=0;for(let F=0;F<u.length;++F)v[F]=y[I++]+(u[F]-d[$++])*x[q++]/Math.sqrt(p[U++]+c),I>=b&&(I=0),$>=C&&($=0),q>=S&&(q=0),U>=T&&(U=0);return t.makeTensorInfo(s.shape,s.dtype,v)}const bOe={kernelName:ET,backendName:"cpu",kernelFunc:yOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,crops:a}=r;_t([s],"batchToSpaceND");const o=i.reduce((S,T)=>S*T),l=Ev(s.shape,i,o),c=Sv(l.length,i.length),u=Tv(s.shape,i,o),d=e6(a,i.length),p=t6(u,a,i.length),x=Fr({inputs:{x:s},backend:t,attrs:{shape:l}}),y=no({inputs:{x},backend:t,attrs:{perm:c}}),v=Fr({inputs:{x:y},backend:t,attrs:{shape:u}}),b=wm({inputs:{x:v},backend:t,attrs:{begin:d,size:p}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),b}const _Oe={kernelName:dT,backendName:"cpu",kernelFunc:vOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:a}=r,o=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,c=B6(o,l,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,c)}const EOe={kernelName:DD,backendName:"cpu",kernelFunc:wOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SOe(n){const{inputs:e,backend:t}=n,{s0:r,s1:s}=e,i=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,o=cn(Array.from(i),Array.from(a));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const TOe={kernelName:KX,backendName:"cpu",kernelFunc:SOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const COe=_r(Db,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),AOe={kernelName:Db,backendName:"cpu",kernelFunc:COe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NOe=n=>{const{x:e}=n.inputs,t=n.backend,r=new Float32Array(Ue(e.shape)),s=t.data.get(e.dataId),i=s.complexTensorInfos.real,a=s.complexTensorInfos.imag,o=t.data.get(i.dataId).values,l=t.data.get(a.dataId).values;for(let c=0;c<o.length;c++){const u=o[c],d=l[c];r[c]=Math.hypot(u,d)}return t.makeOutput(r,e.shape,"float32")},kOe={kernelName:fT,backendName:"cpu",kernelFunc:NOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rg(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.data.get(r.dataId).complexTensorInfos.imag,i=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,i)}const IOe={kernelName:YD,backendName:"cpu",kernelFunc:Rg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dg(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r,i=Sn(s,e[0].shape)[0],a=e.map(v=>v.shape);Z$(a,i);let o=du(e.map(v=>v.shape),i);if(Ue(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(v=>Ue(v.shape)>0);if(l.length===1)return Nu({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const v=l.map(I=>_m({inputs:{input:I},backend:t})),b=l.map(I=>Rg({inputs:{input:I},backend:t})),S=Dg({inputs:v,backend:t,attrs:{axis:i}}),T=Dg({inputs:b,backend:t,attrs:{axis:i}}),C=yo({inputs:{real:S,imag:T},backend:t});return v.forEach(I=>t.disposeIntermediateTensorInfo(I)),b.forEach(I=>t.disposeIntermediateTensorInfo(I)),t.disposeIntermediateTensorInfo(S),t.disposeIntermediateTensorInfo(T),C}const c=l.map(v=>{const S=[-1,Ue(v.shape.slice(i))];return Fr({inputs:{x:v},backend:t,attrs:{shape:S}})}),u=c.map(v=>({vals:t.data.get(v.dataId).values,shape:v.shape}));o=du(c.map(v=>v.shape),1);const d=c[0].shape[0]===1,p=Tee(u,o,e[0].dtype,d),x=du(l.map(v=>v.shape),i),y=t.makeTensorInfo(x,e[0].dtype,p);return c.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}const ROe={kernelName:pT,backendName:"cpu",kernelFunc:Dg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _te(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r;_t([s,i],"conv2d");const d=Bh(l),p=Fi(s.shape,i.shape,a,c,o,u,!1,d),x=p.filterHeight,y=p.filterWidth,v=p.dilationHeight,b=p.dilationWidth,S=p.padInfo.left,T=p.padInfo.top,C=p.dataFormat==="channelsLast",I=new Oi(p.outShape,s.dtype),$=kt(s.shape),q=kt(i.shape),U=$[0],F=C?$[1]:$[2],G=C?$[2]:1,V=C?1:$[1],O=I.strides[0],K=C?I.strides[1]:I.strides[2],P=C?I.strides[2]:1,N=C?1:I.strides[1],M=t.data.get(s.dataId).values,B=t.data.get(i.dataId).values,Y=I.values;for(let Z=0;Z<p.batchSize;++Z){const ne=Z*U,Q=Z*O;for(let z=0;z<p.outHeight;++z){const D=Q+z*K,X=z*p.strideHeight-T;for(let re=0;re<x;++re){const W=X+re*v;if(W<0||W>=p.inHeight)continue;const ae=re*q[0],pe=ne+W*F;for(let de=0;de<p.outWidth;++de){const ve=D+de*P,Ve=de*p.strideWidth-S;for(let ze=0;ze<y;++ze){const Ge=Ve+ze*b;if(Ge<0||Ge>=p.inWidth)continue;const at=ae+ze*q[1],We=pe+Ge*G;let nt=at;for(let Nt=0;Nt<p.inChannels;++Nt){const ct=M[We+Nt*V];for(let xt=0;xt<p.outChannels;++xt)Y[ve+xt*N]+=ct*B[nt+xt];nt+=p.outChannels}}}}}}return t.makeTensorInfo(I.shape,I.dtype,Y)}const DOe={kernelName:mT,backendName:"cpu",kernelFunc:_te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Oe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;_t([s,i],"conv2dBackpropFilter");const d=Bh(l),p=Fi(s.shape,u,a,1,o,c,!1,d),{strideHeight:x,strideWidth:y,filterHeight:v,filterWidth:b}=p,S=p.dataFormat==="channelsLast",T=new Oi(p.filterShape,"float32"),C=p.padInfo.left,I=p.padInfo.top,$=t.data.get(s.dataId).values,q=t.data.get(i.dataId).values,U=new Oi(s.shape,s.dtype,$),F=new Oi(i.shape,i.dtype,q);for(let G=0;G<v;++G){const V=Math.max(0,Math.ceil((I-G)/x)),O=Math.min(p.outHeight,(p.inHeight+I-G)/x);for(let K=0;K<b;++K){const P=Math.max(0,Math.ceil((C-K)/y)),N=Math.min(p.outWidth,(p.inWidth+C-K)/y);for(let M=0;M<p.inChannels;++M)for(let B=0;B<p.outChannels;++B){let Y=0;for(let Z=0;Z<p.batchSize;++Z)for(let ne=V;ne<O;++ne){const Q=G+ne*x-I;for(let z=P;z<N;++z){const D=K+z*y-C;S?Y+=U.get(Z,Q,D,M)*F.get(Z,ne,z,B):Y+=U.get(Z,M,Q,D)*F.get(Z,B,ne,z)}}T.set(Y,G,K,M,B)}}}return t.makeTensorInfo(T.shape,T.dtype,T.values)}const LOe={kernelName:PD,backendName:"cpu",kernelFunc:$Oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function POe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{inputShape:a,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r;_t([s,i],"conv2dBackpropInput");const d=kt(i.shape),p=kt(s.shape);let x=Bh(c);const y=Fi(a,i.shape,o,1,l,u,!1,x),v=new Oi(y.inShape,"float32"),b=v.values,S=t.data.get(s.dataId).values,T=t.data.get(i.dataId).values,[C,I,$]=d,{batchSize:q,filterHeight:U,filterWidth:F,inChannels:G,inHeight:V,inWidth:O,outChannels:K,outHeight:P,outWidth:N,strideHeight:M,strideWidth:B}=y;x=y.dataFormat;const Y=U-1-y.padInfo.top,Z=F-1-y.padInfo.left,ne=x==="channelsLast",Q=v.strides[0],z=ne?v.strides[1]:v.strides[2],D=ne?v.strides[2]:1,X=ne?1:v.strides[1],re=p[0],W=ne?p[1]:p[2],ae=ne?p[2]:1,pe=ne?1:p[1];for(let de=0;de<q;++de)for(let ve=0;ve<G;++ve)for(let Ve=0;Ve<V;++Ve){const ze=Ve-Y,Ge=Math.max(0,Math.ceil(ze/M)),at=Math.min(P,(U+ze)/M);for(let We=0;We<O;++We){const nt=We-Z,Nt=Math.max(0,Math.ceil(nt/B)),ct=Math.min(N,(F+nt)/B);let xt=0;for(let ht=Ge;ht<at;++ht){const St=ht*M-ze;for(let an=Nt;an<ct;++an){const Ot=an*B-nt,Mt=re*de+W*ht+ae*an,Wn=C*(U-1-St)+I*(F-1-Ot)+$*ve;for(let It=0;It<K;++It){const Tt=S[Mt+pe*It],nr=T[Wn+It];xt+=Tt*nr}}}const en=Q*de+z*Ve+D*We+X*ve;b[en]=xt}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const OOe={kernelName:gT,backendName:"cpu",kernelFunc:POe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:l}=r;_t([s,i],"conv3d");const c=Of(s.shape,i.shape,a,l,o),{filterDepth:u,filterHeight:d,filterWidth:p,dilationDepth:x,dilationHeight:y,dilationWidth:v,padInfo:b}=c,S=b.front,T=b.left,C=b.top,I=new Oi(c.outShape,s.dtype),$=t.data.get(s.dataId).values,q=t.data.get(i.dataId).values,U=I.values,F=kt(s.shape),G=kt(i.shape);for(let V=0;V<c.batchSize;++V){const O=V*F[0],K=V*I.strides[0];for(let P=0;P<c.outDepth;++P){const N=K+P*I.strides[1],M=P*c.strideDepth-S;for(let B=0;B<u;++B){const Y=M+B*x;if(Y<0||Y>=c.inDepth)continue;const Z=B*G[0],ne=O+Y*F[1];for(let Q=0;Q<c.outHeight;++Q){const z=N+Q*I.strides[2],D=Q*c.strideHeight-C;for(let X=0;X<d;++X){const re=D+X*y;if(re<0||re>=c.inHeight)continue;const W=Z+X*G[1],ae=ne+re*F[2];for(let pe=0;pe<c.outWidth;++pe){const de=z+pe*c.outChannels,ve=pe*c.strideWidth-T;for(let Ve=0;Ve<p;++Ve){const ze=ve+Ve*v;if(ze<0||ze>=c.inWidth)continue;const Ge=W+Ve*G[2],at=ae+ze*c.inChannels;let We=Ge;for(let nt=0;nt<c.inChannels;++nt){const Nt=$[at+nt];for(let ct=0;ct<c.outChannels;++ct)U[de+ct]+=Nt*q[We+ct];We+=c.outChannels}}}}}}}}return t.makeTensorInfo(I.shape,I.dtype,I.values)}const FOe={kernelName:xT,backendName:"cpu",kernelFunc:MOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,pad:o,filterShape:l}=r;_t([s,i],"conv3dBackpropFilterV2");const c=kt(s.shape),u=kt(i.shape),d=Of(s.shape,l,a,1,o),p=d.strideDepth,x=d.strideHeight,y=d.strideWidth,v=d.filterDepth,b=d.filterHeight,S=d.filterWidth,T=new Oi(d.filterShape,"float32"),C=T.values,[I,$,q,U]=T.strides,F=t.data.get(i.dataId).values,[G,V,O,K]=u,P=t.data.get(s.dataId).values,[N,M,B,Y]=c,Z=d.padInfo.front,ne=d.padInfo.left,Q=d.padInfo.top;for(let z=0;z<v;++z){const D=Math.max(0,Math.ceil((Z-z)/p)),X=Math.min(d.outDepth,(d.inDepth+Z-z)/p),re=z*I;for(let W=0;W<b;++W){const ae=Math.max(0,Math.ceil((Q-W)/x)),pe=Math.min(d.outHeight,(d.inHeight+Q-W)/x),de=W*$+re;for(let ve=0;ve<S;++ve){const Ve=Math.max(0,Math.ceil((ne-ve)/y)),ze=Math.min(d.outWidth,(d.inWidth+ne-ve)/y),Ge=ve*q+de;for(let at=0;at<d.inChannels;++at){const We=at*U+Ge;for(let nt=0;nt<d.outChannels;++nt){let Nt=0;for(let ct=0;ct<d.batchSize;++ct){const xt=ct*N,en=ct*G;for(let ht=D;ht<X;++ht){const an=(z+ht*p-Z)*M+xt,Ot=ht*V+en;for(let Mt=ae;Mt<pe;++Mt){const It=(W+Mt*x-Q)*B+an,Tt=Mt*O+Ot;for(let nr=Ve;nr<ze;++nr){const Cn=(ve+nr*y-ne)*Y+It,Br=nr*K+Tt;Nt+=P[Cn+at]*F[Br+nt]}}}}C[We+nt]=Nt}}}}}return t.makeTensorInfo(T.shape,T.dtype,T.values)}const zOe={kernelName:OD,backendName:"cpu",kernelFunc:BOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jOe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{pad:a,strides:o,inputShape:l}=r;_t([s],"conv3dBackpropInputV2");const c=kt(s.shape),u=kt(i.shape),d=Of(l,i.shape,o,1,a),p=new Oi(d.inShape,"float32"),x=p.values,[y,v,b,S]=p.strides,T=t.data.get(s.dataId).values,[C,I,$,q]=c,U=t.data.get(i.dataId).values,[F,G,V,O]=u,{batchSize:K,filterDepth:P,filterHeight:N,filterWidth:M,inChannels:B,inDepth:Y,inHeight:Z,inWidth:ne,outChannels:Q,outDepth:z,outHeight:D,outWidth:X,strideDepth:re,strideHeight:W,strideWidth:ae}=d,pe=P-1-d.padInfo.front,de=N-1-d.padInfo.top,ve=M-1-d.padInfo.left;for(let Ve=0;Ve<K;++Ve)for(let ze=0;ze<B;++ze)for(let Ge=0;Ge<Y;++Ge){const at=Ge-pe,We=Math.max(0,Math.ceil(at/re)),nt=Math.min(z,(P+at)/re);for(let Nt=0;Nt<Z;++Nt){const ct=Nt-de,xt=Math.max(0,Math.ceil(ct/W)),en=Math.min(D,(N+ct)/W);for(let ht=0;ht<ne;++ht){const St=ht-ve,an=Math.max(0,Math.ceil(St/ae)),Ot=Math.min(X,(M+St)/ae);let Mt=0;for(let Wn=We;Wn<nt;++Wn){const It=Wn*re-at;for(let Tt=xt;Tt<en;++Tt){const nr=Tt*W-ct;for(let Bt=an;Bt<Ot;++Bt){const Cn=Bt*ae-St,Br=C*Ve+I*Wn+$*Tt+q*Bt,xn=F*(P-1-It)+G*(N-1-nr)+V*(M-1-Cn)+O*ze;for(let tn=0;tn<Q;++tn){const Wr=T[Br+tn],rn=U[xn+tn];Mt+=Wr*rn}}}}x[y*Ve+v*Ge+b*Nt+S*ht+ze]=Mt}}}return t.makeTensorInfo(p.shape,p.dtype,p.values)}const VOe={kernelName:MD,backendName:"cpu",kernelFunc:jOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UOe=_r($b,n=>Math.cos(n)),GOe={kernelName:$b,backendName:"cpu",kernelFunc:UOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HOe=_r(Lb,n=>Math.cosh(n)),WOe={kernelName:Lb,backendName:"cpu",kernelFunc:HOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qOe(n){const{inputs:e,backend:t,attrs:r}=n,{image:s,boxes:i,boxInd:a}=e,{cropSize:o,method:l,extrapolationValue:c}=r,[u,d,p,x]=s.shape,y=i.shape[0],[v,b]=o,S=En([y,v,b,x],"float32"),T=t.data.get(i.dataId).values,C=t.data.get(a.dataId).values,I=t.data.get(s.dataId).values,$=kt(s.shape),q=kt(S.shape);for(let U=0;U<y;U++){const F=U*4,G=T[F],V=T[F+1],O=T[F+2],K=T[F+3],P=C[U];if(P>=u)continue;const N=v>1?(O-G)*(d-1)/(v-1):0,M=b>1?(K-V)*(p-1)/(b-1):0;for(let B=0;B<v;B++){const Y=v>1?G*(d-1)+B*N:.5*(G+O)*(d-1);if(Y<0||Y>d-1){for(let Z=0;Z<b;Z++)for(let ne=0;ne<x;ne++){const Q=ne+Z*q[2]+B*q[1]+U*q[0];S.values[Q]=c}continue}if(l==="bilinear"){const Z=Math.floor(Y),ne=Math.ceil(Y),Q=Y-Z;for(let z=0;z<b;z++){const D=b>1?V*(p-1)+z*M:.5*(V+K)*(p-1);if(D<0||D>p-1){for(let ae=0;ae<x;ae++){const pe=ae+z*q[2]+B*q[1]+U*q[0];S.values[pe]=c}continue}const X=Math.floor(D),re=Math.ceil(D),W=D-X;for(let ae=0;ae<x;ae++){let pe=ae+X*$[2]+Z*$[1]+P*$[0];const de=I[pe];pe=ae+re*$[2]+Z*$[1]+P*$[0];const ve=I[pe];pe=ae+X*$[2]+ne*$[1]+P*$[0];const Ve=I[pe];pe=ae+re*$[2]+ne*$[1]+P*$[0];const ze=I[pe],Ge=de+(ve-de)*W,at=Ve+(ze-Ve)*W;pe=ae+z*q[2]+B*q[1]+U*q[0],S.values[pe]=Ge+(at-Ge)*Q}}}else for(let Z=0;Z<b;++Z){const ne=b>1?V*(p-1)+Z*M:.5*(V+K)*(p-1);if(ne<0||ne>p-1){for(let D=0;D<x;D++){const X=D+Z*q[2]+B*q[1]+U*q[0];S.values[X]=c}continue}const Q=Math.round(ne),z=Math.round(Y);for(let D=0;D<x;D++){const X=D+Q*$[2]+z*$[1]+P*$[0],re=D+Z*q[2]+B*q[1]+U*q[0];S.values[re]=I[X]}}}}return t.makeTensorInfo(S.shape,S.dtype,S.values)}const KOe={kernelName:BD,backendName:"cpu",kernelFunc:qOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:a,reverse:o}=r;_t(s,"cumprod");const l=os([i],s.shape.length);let c=s;l!=null&&(c=no({inputs:{x:s},backend:t,attrs:{perm:l}}));const u=Cs(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=wo(c.dtype,"int32"),p=SD(Ue(c.shape),d),x=t.data.get(c.dataId).values,y=c.shape[c.shape.length-1],v=o?(S,T)=>S+y-T-1:(S,T)=>S+T;for(let S=0;S<x.length;S+=y)for(let T=0;T<y;T++){const C=v(S,T);if(T===0)p[C]=a?1:x[C];else{const I=v(S,T-1);p[C]=a?x[I]*p[I]:x[C]*p[I]}}const b=t.makeTensorInfo(c.shape,d,p);if(l!=null){const S=Mf(l),T=no({inputs:{x:b},backend:t,attrs:{perm:S}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(c),T}return b}const YOe={kernelName:FD,backendName:"cpu",kernelFunc:XOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:a,reverse:o}=r;_t(s,"cumsum");const l=os([i],s.shape.length);let c=s;l!=null&&(c=no({inputs:{x:s},backend:t,attrs:{perm:l}}));const u=Cs(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=wo(c.dtype,"int32"),p=ea(Ue(c.shape),d),x=t.data.get(c.dataId).values,y=c.shape[c.shape.length-1],v=o?(S,T)=>S+y-T-1:(S,T)=>S+T;for(let S=0;S<x.length;S+=y)for(let T=0;T<y;T++){const C=v(S,T);if(T===0)p[C]=a?0:x[C];else{const I=v(S,T-1);p[C]=a?x[I]+p[I]:x[C]+p[I]}}const b=t.makeTensorInfo(c.shape,d,p);if(l!=null){const S=Mf(l),T=no({inputs:{x:b},backend:t,attrs:{perm:S}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(c),T}return b}const QOe={kernelName:yT,backendName:"cpu",kernelFunc:ZOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:a,binaryOutput:o}=r;if(s.shape.length===1){const l=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,u=B6(l,c,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,u)}else if(s.shape.length===2){const l=t.bufferSync(s),c=t.bufferSync(i),u=wee(l,c,a,o);return t.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const eMe={kernelName:zD,backendName:"cpu",kernelFunc:JOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tMe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockSize:i,dataFormat:a}=r;ue(a==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`);const o=s.shape[0],l=s.shape[1],c=s.shape[2],u=s.shape[3],d=l*i,p=c*i,x=u/(i*i),y=t.data.get(s.dataId).values,v=new Float32Array(o*d*p*x);let b=0;for(let S=0;S<o;++S)for(let T=0;T<d;++T){const C=Math.floor(T/i),I=T%i;for(let $=0;$<p;++$){const q=Math.floor($/i),U=$%i,F=(I*i+U)*x;for(let G=0;G<x;++G){const O=G+F+u*(q+c*(C+l*S));v[b++]=y[O]}}}return t.makeTensorInfo([o,d,p,x],s.dtype,v)}const nMe={kernelName:jD,backendName:"cpu",kernelFunc:tMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:l,dimRoundingMode:c}=r;_t([s,i],"depthwiseConv2DNative");const u=kt(s.shape),d=kt(i.shape);let p=l;p==null&&(p=[1,1]),ue(sa(a,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${p}'`);const x=Fi(s.shape,i.shape,a,p,o,c,!0),{filterHeight:y,filterWidth:v,dilationHeight:b,dilationWidth:S,padInfo:T}=x,C=T.left,I=T.top,$=x.outChannels/x.inChannels,q=new Oi(x.outShape,s.dtype),U=t.data.get(s.dataId).values,F=t.data.get(i.dataId).values,G=q.values;for(let V=0;V<x.batchSize;++V){const O=V*u[0],K=V*q.strides[0];for(let P=0;P<x.outHeight;++P){const N=K+P*q.strides[1],M=P*x.strideHeight-I;for(let B=0;B<y;++B){const Y=M+B*b;if(Y<0||Y>=x.inHeight)continue;const Z=B*d[0],ne=O+Y*u[1];for(let Q=0;Q<x.outWidth;++Q){const z=N+Q*q.strides[2],D=Q*x.strideWidth-C;for(let X=0;X<v;++X){const re=D+X*S;if(re<0||re>=x.inWidth)continue;const W=Z+X*d[1],ae=ne+re*x.inChannels;let pe=z,de=W;for(let ve=0;ve<x.inChannels;++ve){const Ve=U[ae+ve];for(let ze=0;ze<$;++ze)G[pe+ze]+=Ve*F[de+ze];pe+=$,de+=$}}}}}}return t.makeTensorInfo(q.shape,q.dtype,q.values)}const rMe={kernelName:bT,backendName:"cpu",kernelFunc:wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sMe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r;_t([s,i],"depthwiseConv2dNativeBackpropFilter");const d=Fi(s.shape,u,a,o,l,c,!0),{strideHeight:p,strideWidth:x,filterHeight:y,filterWidth:v}=d,b=new Oi(d.filterShape,"float32"),S=d.padInfo.left,T=d.padInfo.top,C=d.outChannels/d.inChannels,I=t.data.get(s.dataId).values,$=new Oi(s.shape,s.dtype,I),q=t.data.get(i.dataId).values,U=new Oi(i.shape,i.dtype,q);for(let F=0;F<y;++F){const G=Math.max(0,Math.ceil((T-F)/p)),V=Math.min(d.outHeight,(d.inHeight+T-F)/p);for(let O=0;O<v;++O){const K=Math.max(0,Math.ceil((S-O)/x)),P=Math.min(d.outWidth,(d.inWidth+S-O)/x);for(let N=0;N<d.outChannels;++N){const M=Math.trunc(N/C),B=N%C;let Y=0;for(let Z=0;Z<d.batchSize;++Z)for(let ne=G;ne<V;++ne){const Q=F+ne*p-T;for(let z=K;z<P;++z){const D=O+z*x-S;Y+=$.get(Z,Q,D,M)*U.get(Z,ne,z,N)}}b.set(Y,F,O,M,B)}}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const iMe={kernelName:VD,backendName:"cpu",kernelFunc:sMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aMe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r;_t([s,i],"depthwiseConv2DNativeBackpropInput");const d=kt(s.shape),p=kt(i.shape),x=Fi(u,i.shape,a,o,l,c,!0),y=new Oi(x.inShape,"float32"),v=y.values,[b,S,T]=y.strides,C=t.data.get(s.dataId).values,[I,$,q]=d,U=t.data.get(i.dataId).values,[F,G,V]=p,{batchSize:O,filterHeight:K,filterWidth:P,inChannels:N,inHeight:M,inWidth:B,outChannels:Y,outHeight:Z,outWidth:ne,strideHeight:Q,strideWidth:z}=x,D=K-1-x.padInfo.top,X=P-1-x.padInfo.left,re=Y/N;for(let W=0;W<O;++W)for(let ae=0;ae<N;++ae)for(let pe=0;pe<M;++pe){const de=pe-D,ve=Math.max(0,Math.ceil(de/Q)),Ve=Math.min(Z,(K+de)/Q);for(let ze=0;ze<B;++ze){const Ge=ze-X,at=Math.max(0,Math.ceil(Ge/z)),We=Math.min(ne,(P+Ge)/z);let nt=0;for(let Nt=ve;Nt<Ve;++Nt){const ct=Nt*Q-de;for(let xt=at;xt<We;++xt){const en=xt*z-Ge,ht=I*W+$*Nt+q*xt,St=F*(K-1-ct)+G*(P-1-en)+V*ae;for(let an=0;an<re;++an){const Ot=ae*re+an,Mt=C[ht+Ot],Wn=U[St+an];nt+=Mt*Wn}}}v[b*W+S*pe+T*ze+ae]=nt}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const oMe={kernelName:UD,backendName:"cpu",kernelFunc:aMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lMe(n){const{inputs:e,backend:t}=n,{x:r}=e,s=Ue(r.shape),i=t.data.get(r.dataId).values,a=En([s,s],r.dtype),o=a.values;for(let c=0;c<i.length;c++)o[c*s+c]=i[c];const l=[...r.shape,...r.shape];return t.makeTensorInfo(l,a.dtype,a.values)}const cMe={kernelName:XX,backendName:"cpu",kernelFunc:lMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uMe={kernelName:vT,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s}=n,{strides:i,pad:a,dilations:o}=t,l=e,c=l.data.get(r.dataId).values,u=r.shape.length,d=l.data.get(s.dataId).values,p=s.shape.length,{batchSize:x,inHeight:y,inWidth:v,inChannels:b,outHeight:S,outWidth:T,padInfo:C,strideHeight:I,strideWidth:$,filterHeight:q,filterWidth:U,dilationHeight:F,dilationWidth:G,outShape:V}=yv(r.shape,s.shape,i,a,"NHWC",o),O=Ue(V),K=V.length,P=vs(r.dtype,O);for(let M=0;M<x;++M)for(let B=0;B<S;++B){const Y=B*I-C.top;for(let Z=0;Z<T;++Z){const ne=Z*$-C.left;for(let Q=0;Q<b;++Q){let z=Number.MIN_SAFE_INTEGER;for(let X=0;X<q;++X){const re=Y+X*F;if(re>=0&&re<y)for(let W=0;W<U;++W){const ae=ne+W*G;if(ae>=0&&ae<v){const pe=uu([M,re,ae,Q],u,kt(r.shape)),de=uu([X,W,Q],p,kt(s.shape)),ve=c[pe]+d[de];ve>z&&(z=ve)}}}const D=uu([M,B,Z,Q],K,kt(V));P[D]=z}}}return{dataId:l.write(Rm(P,r.dtype),V,r.dtype),shape:V,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hMe={kernelName:c3,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s,dy:i}=n,{strides:a,pad:o,dilations:l}=t,c=e,u=dc(r.shape,c.data.get(r.dataId).values),d=dc(s.shape,c.data.get(s.dataId).values),{batchSize:p,inHeight:x,inWidth:y,inChannels:v,outHeight:b,outWidth:S,padInfo:T,strideHeight:C,strideWidth:I,filterHeight:$,filterWidth:q,dilationHeight:U,dilationWidth:F,outShape:G}=yv(r.shape,s.shape,a,o,"NHWC",l);ue(i.rank===G.length,()=>`Error in ${c3}, dy must have the same rank as output ${G.length}, but got ${i.rank}`);const V=dc(G,c.data.get(i.dataId).values),O=HX(s.shape,s.dtype);for(let P=0;P<p;++P)for(let N=0;N<b;++N){const M=N*C-T.top;for(let B=0;B<S;++B){const Y=B*I-T.left;for(let Z=0;Z<v;++Z){let ne=Number.MIN_SAFE_INTEGER,Q=0,z=0;for(let D=0;D<$;++D){const X=M+D*U;if(X>=0&&X<x)for(let re=0;re<q;++re){const W=Y+re*F;if(W>=0&&W<y){const ae=u[P][X][W][Z]+d[D][re][Z];ae>ne&&(ne=ae,Q=D,z=re)}}}O[Q][z][Z]+=V[P][N][B][Z]}}}return{dataId:c.write(Rm(O,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dMe={kernelName:l3,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s,dy:i}=n,{strides:a,pad:o,dilations:l}=t,c=e,u=dc(r.shape,c.data.get(r.dataId).values),d=dc(s.shape,c.data.get(s.dataId).values),{batchSize:p,inHeight:x,inWidth:y,inChannels:v,outHeight:b,outWidth:S,padInfo:T,strideHeight:C,strideWidth:I,filterHeight:$,filterWidth:q,dilationHeight:U,dilationWidth:F,outShape:G}=yv(r.shape,s.shape,a,o,"NHWC",l);ue(i.rank===G.length,()=>`Error in ${l3}, dy must have the same rank as output ${G.length}, but got ${i.rank}`);const V=dc(G,c.data.get(i.dataId).values),O=HX(r.shape,r.dtype);for(let P=0;P<p;++P)for(let N=0;N<b;++N){const M=N*C-T.top;for(let B=0;B<S;++B){const Y=B*I-T.left;for(let Z=0;Z<v;++Z){let ne=Number.MIN_SAFE_INTEGER,Q=M<0?0:M,z=Y<0?0:Y;for(let D=0;D<$;++D){const X=M+D*U;if(X>=0&&X<x)for(let re=0;re<q;++re){const W=Y+re*F;if(W>=0&&W<y){const ae=u[P][X][W][Z]+d[D][re][Z];ae>ne&&(ne=ae,Q=X,z=W)}}}O[P][Q][z][Z]+=V[P][N][B][Z]}}}return{dataId:c.write(Rm(O,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fMe(n){const{inputs:e,backend:t,attrs:r}=n,{image:s}=e,{canvas:i,options:a}=r,{contextOptions:o,imageOptions:l}=a||{},c=l?.alpha||1,u=o?.contextType||"2d";if(u!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const d=i.getContext(u,o?.contextAttributes||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[p,x]=s.shape.slice(0,2),y=s.shape.length===2?1:s.shape[2],v=t.data.get(s.dataId).values,b=s.dtype==="float32"?255:1,S=new Uint8ClampedArray(x*p*4);for(let C=0;C<p*x;++C){const I=[0,0,0,255*c];for(let q=0;q<y;q++){const U=v[C*y+q];if(s.dtype==="float32"){if(U<0||U>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${U}.`)}else if(s.dtype==="int32"&&(U<0||U>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${U}.`);y===1?(I[0]=U*b,I[1]=U*b,I[2]=U*b):I[q]=U*b}const $=C*4;S[$+0]=Math.round(I[0]),S[$+1]=Math.round(I[1]),S[$+2]=Math.round(I[2]),S[$+3]=Math.round(I[3])}i.width=x,i.height=p;const T=new ImageData(S,x,p);return d.putImageData(T,0,0),s}const pMe={kernelName:fAe,backendName:"cpu",kernelFunc:fMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lv(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;_t(s,"sum");let o;s.dtype==="bool"?o=Ef({inputs:{x:s},backend:t,attrs:{dtype:"int32"}}):o=Nu({inputs:{x:s},backend:t});const l=o.shape.length,c=Sn(i,o.shape),u=os(c,l);let d=c,p=o;u!=null&&(p=no({inputs:{x:o},backend:t,attrs:{perm:u}}),d=Cs(d.length,l)),Bi("sum",d,p.shape.length);const[x,y]=xi(p.shape,d),v=wo(p.dtype,"int32");let b=ZE(t,x,v);const S=Ue(y),T=t.data.get(b.dataId).values,C=t.data.get(p.dataId).values;for(let I=0;I<T.length;++I){const $=I*S;let q=0;for(let U=0;U<S;++U)q+=C[$+U];T[I]=q}if(a){const I=Us(b.shape,c),$=b;b=Fr({inputs:{x:b},backend:t,attrs:{shape:I}}),t.disposeIntermediateTensorInfo($)}return t.disposeIntermediateTensorInfo(o),u!=null&&t.disposeIntermediateTensorInfo(p),b}const mMe={kernelName:JT,backendName:"cpu",kernelFunc:Lv};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gMe(n){const{inputs:e,backend:t,attrs:r}=n,{equation:s}=r,i=e,{allDims:a,summedDims:o,idDims:l}=c6(s,i.length);h6(a.length,l,i);const{path:c,steps:u}=d6(o,l),d=u.length;let p=null,x=a.length;const y=[];for(let v=0;v<d;++v){for(const b of u[v]){const{permutationIndices:S,expandDims:T}=u6(x,l[b]);let C;f6(S)?C=i[b]:(C=no({inputs:{x:i[b]},backend:t,attrs:{perm:S}}),y.push(C));const I=C.shape.slice();for(let $=0;$<T.length;++$)I.splice(T[$],0,1);gr(C.shape,I)||(C=Fr({inputs:{x:C},backend:t,attrs:{shape:I}}),y.push(C)),p===null?p=C:(p=IC({inputs:{a:C,b:p},backend:t}),y.push(p))}v<d-1&&(c[v]>=0&&(p=Lv({inputs:{x:p},backend:t,attrs:{axis:c[v]-(a.length-x),keepDims:!1}}),y.push(p)),x--)}for(const v of y)v!==p&&t.disposeIntermediateTensorInfo(v);return p}const xMe={kernelName:GD,backendName:"cpu",kernelFunc:gMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yMe(n){const{inputs:e,backend:t}=n,{dy:r,y:s}=e;_t([r,s],"eluGrad");const i=new Float32Array(Ue(s.shape)),a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values;for(let l=0;l<a.length;++l){const c=a[l];c>=0?i[l]=o[l]:i[l]=o[l]*(c+1)}return t.makeTensorInfo(s.shape,"float32",i)}const bMe={kernelName:HD,backendName:"cpu",kernelFunc:yMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vMe=n6,_Me=r6,wMe=s6,EMe=i6,SMe=a6,TMe=o6,CMe=_r(Mb,n=>{const e=Math.sign(n),t=Math.abs(n),r=1/(1+vMe*t);return e*(1-((((TMe*r+SMe)*r+EMe)*r+wMe)*r+_Me)*r*Math.exp(-t*t))}),AMe={kernelName:Mb,backendName:"cpu",kernelFunc:CMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eS(n){const{inputs:e,backend:t,attrs:r}=n,{input:s}=e,{dim:i}=r,a=s.shape.length,o=s.shape.slice();let l=i;return i<0&&(ue(-(a+1)<=i,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+i+1),o.splice(l,0,1),Fr({inputs:{x:s},backend:t,attrs:{shape:o}})}const NMe={kernelName:wT,backendName:"cpu",kernelFunc:eS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kMe=Ns((n,e)=>n/e),H6=ni(Pb,kMe),P3={kernelName:Pb,backendName:"cpu",kernelFunc:H6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ete(n,e,t){const r=n.shape,s=r[0],i=r[1],a=t.data.get(n.dataId),o=a.complexTensorInfos.real,l=a.complexTensorInfos.imag,c=[s,i],u=Ue(c),d=Ji("float32",u),p=Ji("float32",u);for(let b=0;b<s;b++){const S=wm({inputs:{x:o},backend:t,attrs:{begin:[b,0],size:[1,i]}}),T=wm({inputs:{x:l},backend:t,attrs:{begin:[b,0],size:[1,i]}}),C=yo({inputs:{real:S,imag:T},backend:t}),{real:I,imag:$}=IMe(C,e,t),q=Rh(I,$);for(let U=0;U<i;U++){const F=l6(q,U);d[b*i+U]=F.real,p[b*i+U]=F.imag}t.disposeIntermediateTensorInfo(S),t.disposeIntermediateTensorInfo(T),t.disposeIntermediateTensorInfo(C)}const x=t.makeTensorInfo(c,"float32",d),y=t.makeTensorInfo(c,"float32",p),v=yo({inputs:{real:x,imag:y},backend:t});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(y),v}function IMe(n,e,t){const r=Ue(n.shape),s=t.data.get(n.dataId),i=t.data.get(s.complexTensorInfos.real.dataId).values,a=t.data.get(s.complexTensorInfos.imag.dataId).values;if(RMe(r)){const o=O3(i,a,r,e,t),l=[n.shape[0],n.shape[1]];if(e){const c=t.makeTensorInfo(l,"float32",o.real),u=t.makeTensorInfo(l,"float32",o.imag),d=t.makeTensorInfo([],"float32",Pf(r,"float32")),p=Nu({inputs:{x:d},backend:t}),x=P3.kernelFunc({inputs:{a:c,b:d},backend:t}),y=P3.kernelFunc({inputs:{a:u,b:p},backend:t}),v=t.data.get(x.dataId).values,b=t.data.get(y.dataId).values;return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(y),{real:v,imag:b}}return o}else{const o=Rh(i,a),l=DMe(o,r,e);return OZ(l)}}function RMe(n){return(n&n-1)===0}function O3(n,e,t,r,s){if(t===1)return{real:n,imag:e};const i=Rh(n,e),a=t/2,o=MZ(i),l=o.real,c=o.imag,u=[l.length],d=s.makeTensorInfo(u,"float32",l),p=s.makeTensorInfo(u,"float32",c),x=yo({inputs:{real:d,imag:p},backend:s}),y=FZ(i),v=y.real,b=y.imag,S=[v.length],T=s.makeTensorInfo(S,"float32",v),C=s.makeTensorInfo(S,"float32",b),I=yo({inputs:{real:T,imag:C},backend:s}),$=O3(l,c,a,r,s),q=$.real,U=$.imag,F=[q.length],G=s.makeTensorInfo(F,"float32",q),V=s.makeTensorInfo(F,"float32",U),O=yo({inputs:{real:G,imag:V},backend:s}),K=O3(v,b,a,r,s),P=K.real,N=K.imag,M=[P.length],B=s.makeTensorInfo(M,"float32",P),Y=s.makeTensorInfo(M,"float32",N),Z=yo({inputs:{real:B,imag:Y},backend:s}),ne=zZ(t,r),Q=[ne.real.length],z=s.makeTensorInfo(Q,"float32",ne.real),D=s.makeTensorInfo(Q,"float32",ne.imag),X=yo({inputs:{real:z,imag:D},backend:s}),re=IC({inputs:{a:X,b:Z},backend:s}),W=Ig({inputs:{a:O,b:re},backend:s}),ae=U6({inputs:{a:O,b:re},backend:s}),pe=_m({inputs:{input:W},backend:s}),de=_m({inputs:{input:ae},backend:s}),ve=Rg({inputs:{input:W},backend:s}),Ve=Rg({inputs:{input:ae},backend:s}),ze=Dg({inputs:[pe,de],backend:s,attrs:{axis:0}}),Ge=Dg({inputs:[ve,Ve],backend:s,attrs:{axis:0}}),at=s.data.get(ze.dataId).values,We=s.data.get(Ge.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(p),s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(T),s.disposeIntermediateTensorInfo(C),s.disposeIntermediateTensorInfo(I),s.disposeIntermediateTensorInfo(G),s.disposeIntermediateTensorInfo(V),s.disposeIntermediateTensorInfo(O),s.disposeIntermediateTensorInfo(B),s.disposeIntermediateTensorInfo(Y),s.disposeIntermediateTensorInfo(Z),s.disposeIntermediateTensorInfo(z),s.disposeIntermediateTensorInfo(D),s.disposeIntermediateTensorInfo(X),s.disposeIntermediateTensorInfo(re),s.disposeIntermediateTensorInfo(W),s.disposeIntermediateTensorInfo(ae),s.disposeIntermediateTensorInfo(pe),s.disposeIntermediateTensorInfo(ve),s.disposeIntermediateTensorInfo(de),s.disposeIntermediateTensorInfo(Ve),s.disposeIntermediateTensorInfo(ze),s.disposeIntermediateTensorInfo(Ge),{real:at,imag:We}}function DMe(n,e,t){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let i=0,a=0;for(let o=0;o<e;o++){const l=jZ(s*o,e,t),c=l6(n,o);i+=c.real*l.real-c.imag*l.imag,a+=c.real*l.imag+c.imag*l.real}t&&(i/=e,a/=e),BZ(r,i,a,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Me(n){const{inputs:e,backend:t}=n,{input:r}=e,s=Ue(r.shape),i=r.shape[r.shape.length-1],a=s/i,o=Fr({inputs:{x:r},backend:t,attrs:{shape:[a,i]}}),l=Ete(o,!1,t),c=Fr({inputs:{x:l},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}const LMe={kernelName:WD,backendName:"cpu",kernelFunc:$Me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(n){const{backend:e,attrs:t}=n,{shape:r,value:s,dtype:i}=t,a=i||ex(s),o=vs(a,Ue(r));return OMe(o,s,a),e.makeTensorInfo(r,a,o)}const PMe={kernelName:qD,backendName:"cpu",kernelFunc:W6};function OMe(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MMe={kernelName:KD,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,s=t,i=Ji(r.dtype,Ue(r.shape)),[a,o,l,c]=r.shape,u=s.data.get(r.dataId).values;for(let p=0;p<a;p++){const x=p*l*o*c;for(let y=0;y<o;y++){const v=y*(l*c);for(let b=0;b<l;b++){const S=b*c;for(let T=0;T<c;T++){const C=Math.round(l-b-1),I=x+v+S+T;let $=u[I];if(C>=0&&C<l){const q=C*c,U=x+v+q+T;$=u[U]}i[I]=$}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FMe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:x,leakyreluAlpha:y}=r;let v=_te({inputs:{x:s,filter:i},backend:t,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p}});if(a){const b=v;if(u==="NCHW"&&a.shape.length===1&&a.shape[0]!==1){const S=Fr({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});v=Ig({inputs:{a:v,b:S},backend:t}),t.disposeIntermediateTensorInfo(S)}else v=Ig({inputs:{a:v,b:a},backend:t});t.disposeIntermediateTensorInfo(b)}if(x){const b=v;if(u==="NCHW"&&x==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const S=Fr({inputs:{x:o},backend:t,attrs:{shape:[o.shape[0],1,1]}});v=JE(t,v,x,S,y),t.disposeIntermediateTensorInfo(S)}else v=JE(t,v,x,o,y);t.disposeIntermediateTensorInfo(b)}return v}const BMe={kernelName:LE,backendName:"cpu",kernelFunc:FMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zMe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:x,leakyreluAlpha:y}=r;let v=wte({inputs:{x:s,filter:i},backend:t,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p}});if(a){const b=v;v=Ig({inputs:{a:v,b:a},backend:t}),t.disposeIntermediateTensorInfo(b)}if(x){const b=v;v=JE(t,v,x,o,y),t.disposeIntermediateTensorInfo(b)}return v}const jMe={kernelName:pY,backendName:"cpu",kernelFunc:zMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VMe(n){const{inputs:e,backend:t}=n,{params:r,indices:s}=e,i=Ue(r.shape),a=s.shape,o=a[a.length-1],[l,c,u,d]=H$(r,s);if(c===0)return t.makeTensorInfo(l,r.dtype,[]);const p=t.data.get(s.dataId).values,x=t.bufferSync(r),y=$ee(p,x,r.dtype,c,o,u,d,r.shape,i);return t.makeTensorInfo(l,r.dtype,y.values)}const UMe={kernelName:YX,backendName:"cpu",kernelFunc:VMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GMe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,indices:i}=e,{axis:a,batchDims:o}=r;_t([s,i],"gatherV2");const l=Sn(a,s.shape)[0],c=t.data.get(i.dataId).values,u=s.shape[l];for(let I=0;I<c.length;++I){const $=c[I];ue($<=u-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${u-1}]`)}let d=o;o==null&&(d=0);const p=Ue(i.shape),x=m6(s,i,l,d),y=Fr({inputs:{x:s},backend:t,attrs:{shape:[x.batchSize,x.outerSize,x.dimSize,x.sliceSize]}}),v=Fr({inputs:{x:i},backend:t,attrs:{shape:[x.batchSize,p/x.batchSize]}}),b=[x.batchSize,x.outerSize,p/x.batchSize,x.sliceSize],S=t.bufferSync(v),T=t.bufferSync(y),C=Lee(T,S,b);return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),t.makeTensorInfo(x.outputShape,C.dtype,C.values)}const HMe={kernelName:ST,backendName:"cpu",kernelFunc:GMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WMe(n){const{inputs:e,backend:t}=n,{input:r}=e,s=Ue(r.shape),i=r.shape[r.shape.length-1],a=s/i,o=Fr({inputs:{x:r},backend:t,attrs:{shape:[a,i]}}),l=Ete(o,!0,t),c=Fr({inputs:{x:l},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}const qMe={kernelName:XD,backendName:"cpu",kernelFunc:WMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KMe=_r(Gb,n=>Number.isFinite(n)?1:0,"bool"),XMe={kernelName:Gb,backendName:"cpu",kernelFunc:KMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YMe=_r(Hb,n=>Math.abs(n)===1/0?1:0,"bool"),ZMe={kernelName:Hb,backendName:"cpu",kernelFunc:YMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QMe=_r(Wb,n=>Number.isNaN(n)?1:0,"bool"),JMe={kernelName:Wb,backendName:"cpu",kernelFunc:QMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e8e(n){const{backend:e,attrs:t}=n,{start:r,stop:s,num:i}=t,a=Bee(r,s,i);return e.makeTensorInfo([a.length],"float32",a)}const t8e={kernelName:ZX,backendName:"cpu",kernelFunc:e8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n8e=_r(Kb,n=>Math.log1p(n)),r8e={kernelName:Kb,backendName:"cpu",kernelFunc:n8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s8e=Ns((n,e)=>n&&e),i8e=ni(kT,s8e,null,"bool"),a8e={kernelName:kT,backendName:"cpu",kernelFunc:i8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o8e=_r(IT,n=>n?0:1,"bool"),l8e={kernelName:IT,backendName:"cpu",kernelFunc:o8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c8e=Ns((n,e)=>n||e),u8e=ni(RT,c8e,null,"bool"),h8e={kernelName:RT,backendName:"cpu",kernelFunc:u8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{depthRadius:i,bias:a,alpha:o,beta:l}=r;_t(s,"LRN");const c=s.shape[3],u=c-1,d=t.data.get(s.dataId).values,p=Ue(s.shape),x=new Float32Array(p);function y(v){const b=v%c;let S=v-b+Math.max(0,b-i);const T=v-b+Math.min(b+i,u);let C=0;for(;S<=T;S++){const I=d[S];C+=I*I}return C}for(let v=0;v<p;v++){const b=y(v),S=d[v]*Math.pow(a+o*b,-l);x[v]=S}return t.makeTensorInfo(s.shape,s.dtype,x)}const f8e={kernelName:DT,backendName:"cpu",kernelFunc:d8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,y:i,dy:a}=e,{depthRadius:o,bias:l,alpha:c,beta:u}=r;_t(a,"LRNGrad");const d=Ue(a.shape),p=a.shape[3],x=t.data.get(a.dataId).values,y=t.data.get(s.dataId).values,v=t.data.get(i.dataId).values,b=new Float32Array(d),S=d;for(let T=0;T<S;T++){const C=T%p,I=T-C+Math.max(0,C-o),$=T-C+Math.min(p,C+o+1);let q=0;for(let U=I;U<$;U++)q+=Math.pow(y[U],2);q=c*q+l;for(let U=I;U<$;U++){let F=-2*c*u*y[U]*v[T]/q;T===U&&(F+=Math.pow(q,-u)),F*=x[T],b[U]+=F}}return t.makeTensorInfo(a.shape,s.dtype,b)}const m8e={kernelName:ZD,backendName:"cpu",kernelFunc:p8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ste(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reductionIndices:i,keepDims:a}=r,o=t;let l=s.shape;const c=l.length,u=Sn(i,l);let d=u;const p=os(d,c);let x=o.data.get(s.dataId).values;if(p!=null){const I=new Array(c);for(let $=0;$<I.length;$++)I[$]=l[p[$]];x=j6(x,l,s.dtype,p,I),d=Cs(d.length,c),l=I}_t(s,"max"),Bi("max",d,c);const[y,v]=xi(l,d),b=Ue(v),S=jee(x,b,y,s.dtype),T=o.write(S,y,s.dtype);let C=y;return a&&(C=Us(y,u)),{dataId:T,shape:C,dtype:s.dtype}}const g8e={kernelName:$T,backendName:"cpu",kernelFunc:Ste};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x8e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;_t(s,"maxPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=r,c=1;ue(sa(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const u=Ml(s.shape,i,a,c,o,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&gr(u.inShape,u.outShape))d=Nu({inputs:{x:s},backend:t});else{const p=t.data.get(s.dataId).values,x=kt(s.shape),y=G6(p,s.shape,s.dtype,x,u,"max");d=t.makeTensorInfo(u.outShape,s.dtype,y.values)}return d}const y8e={kernelName:LT,backendName:"cpu",kernelFunc:x8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:c}=r;_t(s,"maxPool3d");const u=Fh(s.shape,i,a,1,o,l,c),d=t.data.get(s.dataId).values,p=vte(d,s.shape,s.dtype,kt(s.shape),u,"max");return t.makeTensorInfo(p.shape,"float32",p.values)}const v8e={kernelName:PT,backendName:"cpu",kernelFunc:b8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _8e(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=r;_t([s,i],"maxPool3DGrad");const u=Fh(i.shape,a,o,1,l,c),d=t.bufferSync(i),p=cOe(d,u),x=u.strideDepth,y=u.strideHeight,v=u.strideWidth,b=u.dilationDepth,S=u.dilationHeight,T=u.dilationWidth,C=u.effectiveFilterDepth,I=u.effectiveFilterHeight,$=u.effectiveFilterWidth,q=C-1-u.padInfo.front,U=$-1-u.padInfo.left,F=I-1-u.padInfo.top,G=En(i.shape,"float32"),V=t.bufferSync(s);for(let O=0;O<u.batchSize;++O)for(let K=0;K<u.inChannels;++K)for(let P=0;P<u.inDepth;++P)for(let N=0;N<u.inHeight;++N)for(let M=0;M<u.inWidth;++M){const B=P-q,Y=N-F,Z=M-U;let ne=0;for(let Q=0;Q<C;Q+=b){const z=(B+Q)/x;if(!(z<0||z>=u.outDepth||Math.floor(z)!==z))for(let D=0;D<I;D+=S){const X=(Y+D)/y;if(!(X<0||X>=u.outHeight||Math.floor(X)!==X))for(let re=0;re<$;re+=T){const W=(Z+re)/v;if(W<0||W>=u.outWidth||Math.floor(W)!==W)continue;const ae=C*I*$-1-p.get(O,z,X,W,K),pe=Q*I*$+D*$+re,de=ae===pe?1:0;if(de===0)continue;const ve=V.get(O,z,X,W,K);ne+=ve*de}}}G.set(ne,O,P,N,M,K)}return t.makeTensorInfo(G.shape,G.dtype,G.values)}const w8e={kernelName:JD,backendName:"cpu",kernelFunc:_8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E8e(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i,output:a}=e,o=i;_t([i,a],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,p=Ml(o.shape,l,c,1,u,d),x=t.data.get(o.dataId).values,y=En(p.outShape,o.dtype,bte(x,o.shape,o.dtype,p).values),v=p.strideHeight,b=p.strideWidth,S=p.dilationHeight,T=p.dilationWidth,C=p.effectiveFilterHeight,I=p.effectiveFilterWidth,$=I-1-p.padInfo.left,q=C-1-p.padInfo.top,U=En(o.shape,"float32"),F=t.data.get(s.dataId).values,G=En(s.shape,"float32",F);for(let V=0;V<p.batchSize;++V)for(let O=0;O<p.inChannels;++O)for(let K=0;K<p.inHeight;++K)for(let P=0;P<p.inWidth;++P){const N=K-q,M=P-$;let B=0;for(let Y=0;Y<C;Y+=S){const Z=(N+Y)/v;if(!(Z<0||Z>=p.outHeight||Math.floor(Z)!==Z))for(let ne=0;ne<I;ne+=T){const Q=(M+ne)/b;if(Q<0||Q>=p.outWidth||Math.floor(Q)!==Q)continue;const z=C*I-1-y.get(V,Z,Q,O),D=Y*I+ne,X=z===D?1:0;if(X===0)continue;const re=G.get(V,Z,Q,O);B+=re*X}}U.set(B,V,K,P,O)}return t.makeTensorInfo(U.shape,U.dtype,U.values)}const S8e={kernelName:QD,backendName:"cpu",kernelFunc:E8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T8e(n,e,t,r,s){const i=kt(e),a=G6(n,e,t,i,s,"max"),o=bte(n,e,t,s,!0,r);return[a.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C8e={kernelName:QX,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:s,strides:i,pad:a,includeBatchInIndex:o}=e,l=t;_t(r,"MaxPoolWithArgmax");const c=l.data.get(r.dataId).values,u=Ml(r.shape,s,i,[1,1],a),[d,p]=T8e(c,r.shape,r.dtype,o,u),x=l.write(d,u.outShape,r.dtype),y=l.write(p,u.outShape,r.dtype);return[{dataId:x,shape:u.outShape,dtype:r.dtype},{dataId:y,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A8e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=Sn(i,s.shape),c=xi(s.shape,o)[1],u=Ue(c),d=[],p=t.makeTensorInfo([],"float32",new Float32Array([u]));d.push(p);const x=Ef({inputs:{x:s},backend:t,attrs:{dtype:"float32"}});d.push(x);const y=H6({inputs:{a:x,b:p},backend:t});d.push(y);const v=Lv({inputs:{x:y},backend:t,attrs:{axis:i,keepDims:a}});return d.forEach(b=>t.disposeIntermediateTensorInfo(b)),v}const N8e={kernelName:OT,backendName:"cpu",kernelFunc:A8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;_t(s,"min");const o=Sn(i,s.shape);let l=o;const c=os(l,s.shape.length);let u=s;c!=null&&(u=no({inputs:{x:s},backend:t,attrs:{perm:c}}),l=Cs(l.length,s.shape.length)),Bi("min",l,u.shape.length);const[d,p]=xi(u.shape,l),x=Ue(p),y=ea(Ue(d),u.dtype),v=t.data.get(u.dataId).values;for(let S=0;S<y.length;++S){const T=S*x;let C=v[T];for(let I=0;I<x;++I){const $=v[T+I];(Number.isNaN($)||$<C)&&(C=$)}y[S]=C}c!=null&&t.disposeIntermediateTensorInfo(u);const b=t.makeTensorInfo(d,u.dtype,y);if(a){const S=Us(d,o),T=Fr({inputs:{x:b},backend:t,attrs:{shape:S}});return t.disposeIntermediateTensorInfo(b),T}return b}const I8e={kernelName:MT,backendName:"cpu",kernelFunc:k8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R8e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,mode:a}=r;_t(s,"mirrorPad");const o=i.map((C,I)=>C[0]+s.shape[I]+C[1]),l=i.map(C=>C[0]),c=i.map((C,I)=>C[0]+s.shape[I]),u=a==="reflect"?0:1,d=t.data.get(s.dataId).values,p=s.shape.length,x=kt(s.shape),y=Ue(o),v=o.length,b=kt(o),S=Ji(s.dtype,y);for(let C=0;C<y;C++){let I=tx(C,v,b);for(let q=0;q<v;q++)I[q]<l[q]?I[q]=l[q]*2-I[q]-u:I[q]>=c[q]&&(I[q]=(c[q]-1)*2-I[q]+u);I=I.map((q,U)=>q-l[U]);const $=uu(I,p,x);S[C]=d[$]}return{dataId:t.write(S,o,s.dtype),shape:o,dtype:s.dtype}}const D8e={kernelName:FT,backendName:"cpu",kernelFunc:R8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $8e=Ns(((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e})),L8e=ni(Zb,$8e),P8e={kernelName:Zb,backendName:"cpu",kernelFunc:L8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tte(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{dim:i}=r,a=s.shape.length;let o=i;if(o===-1&&(o=a-1),o!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${o}`);const l=Sn([o],s.shape),c=Ste({inputs:{x:s},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),u=Us(c.shape,l),d=Fr({inputs:{x:c},backend:t,attrs:{shape:u}}),p=U6({inputs:{a:s,b:d},backend:t}),x=kee({inputs:{x:p},backend:t}),y=Lv({inputs:{x},backend:t,attrs:{axis:l,keepDims:!1}}),v=Fr({inputs:{x:y},backend:t,attrs:{shape:u}}),b=H6({inputs:{a:x,b:v},backend:t});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),b}const O8e={kernelName:nC,backendName:"cpu",kernelFunc:Tte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M8e(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{numSamples:i,seed:a,normalized:o}=r;_t(s,"multinomial");const l=o?s:Tte({inputs:{logits:s},backend:t,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=t.data.get(l.dataId).values,p=[c,i],x=ea(Ue(p),"int32");for(let y=0;y<c;++y){const v=y*u,b=new Float32Array(u-1);b[0]=d[v];for(let C=1;C<b.length;++C)b[C]=b[C-1]+d[v+C];const S=Qg.alea(a.toString()),T=y*i;for(let C=0;C<i;++C){const I=S();x[T+C]=b.length;for(let $=0;$<b.length;$++)if(I<b[$]){x[T+C]=$;break}}}return o||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(p,"int32",x)}const F8e={kernelName:JX,backendName:"cpu",kernelFunc:M8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B8e=z$;function z8e(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r;_t(s,"NonMaxSuppression");const c=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,{selectedIndices:d}=B8e(c,u,a,o,l);return t.makeTensorInfo([d.length],"int32",new Int32Array(d))}const j8e={kernelName:e$,backendName:"cpu",kernelFunc:z8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V8e=j$;function U8e(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r;_t(s,"NonMaxSuppressionPadded");const u=t.data.get(s.dataId).values,d=t.data.get(i.dataId).values,{selectedIndices:p,validOutputs:x}=V8e(u,d,a,o,l,c);return[t.makeTensorInfo([p.length],"int32",new Int32Array(p)),t.makeTensorInfo([],"int32",new Int32Array([x]))]}const G8e={kernelName:t$,backendName:"cpu",kernelFunc:U8e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H8e=V$;function W8e(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r;_t(s,"NonMaxSuppressionWithScore");const u=t.data.get(s.dataId).values,d=t.data.get(i.dataId).values,p=a,x=o,y=l,v=c,{selectedIndices:b,selectedScores:S}=H8e(u,d,p,x,y,v);return[t.makeTensorInfo([b.length],"int32",new Int32Array(b)),t.makeTensorInfo([S.length],"float32",new Float32Array(S))]}const q8e={kernelName:n$,backendName:"cpu",kernelFunc:W8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8e(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s}=e,{dtype:i,depth:a,onValue:o,offValue:l}=r;_t(s,"oneHot");const c=Ue(s.shape),u=new Float32Array(c*a);u.fill(l);const d=t.data.get(s.dataId).values;for(let p=0;p<c;++p)d[p]>=0&&d[p]<a&&(u[p*a+d[p]]=o);return t.makeTensorInfo([...s.shape,a],i,u)}const X8e={kernelName:VT,backendName:"cpu",kernelFunc:K8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tS(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=_m({inputs:{input:r},backend:t}),i=tS({inputs:{x:s},backend:t}),a=Rg({inputs:{input:r},backend:t}),o=tS({inputs:{x:a},backend:t}),l=yo({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return W6({backend:t,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const Y8e={kernelName:iC,backendName:"cpu",kernelFunc:tS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=_m({inputs:{input:r},backend:t}),i=Cte({inputs:{x:s},backend:t}),a=Rg({inputs:{input:r},backend:t}),o=tS({inputs:{x:a},backend:t}),l=yo({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return W6({backend:t,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const Z8e={kernelName:jT,backendName:"cpu",kernelFunc:Cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r;if(e.length===1)return eS({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const i=e[0].shape,a=e[0].dtype;e.forEach(u=>{ED(i,u.shape,"All tensors passed to stack must have matching shapes"),ue(a===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(u=>{const d=eS({inputs:{input:u},backend:t,attrs:{dim:s}});return o.push(d),d}),c=Dg({inputs:l,backend:t,attrs:{axis:s}});return o.forEach(u=>t.disposeIntermediateTensorInfo(u)),c}const Q8e={kernelName:UT,backendName:"cpu",kernelFunc:Ate};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J8e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,constantValue:a}=r;_t(s,"pad");const o=i.map((T,C)=>T[0]+s.shape[C]+T[1]),l=i.map(T=>T[0]),c=t.data.get(s.dataId).values,u=Ue(s.shape),d=s.shape.length,p=kt(s.shape),x=Ue(o),y=o.length,v=kt(o),b=Ji(s.dtype,x);a!==0&&b.fill(a);for(let T=0;T<u;T++){const I=tx(T,d,p).map((q,U)=>q+l[U]),$=uu(I,y,v);b[$]=c[T]}return{dataId:t.write(b,o,s.dtype),shape:o,dtype:s.dtype}}const Nte={kernelName:GT,backendName:"cpu",kernelFunc:J8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e5e=Ns((n,e)=>Math.pow(n,e)),t5e=ni(Jb,e5e),n5e={kernelName:Jb,backendName:"cpu",kernelFunc:t5e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r5e(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:s,paramsDenseValues:i,indices:a}=e,{outputRaggedRank:o}=r,l=s.map(S=>t.data.get(S.dataId).values),c=s.map(S=>S.shape),u=t.data.get(i.dataId).values,d=t.data.get(a.dataId).values,[p,x,y]=qee(l,c,u,i.shape,i.dtype,d,a.shape),v=p.map(S=>t.makeTensorInfo([S.length],"int32",S)),b=t.makeTensorInfo(y,i.dtype,x);return v.concat([b])}const s5e={kernelName:eY,backendName:"cpu",kernelFunc:r5e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i5e(n){const{inputs:e,backend:t}=n,{starts:r,limits:s,deltas:i}=e,a=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,[c,u]=Kee(a,r.shape,r.dtype,o,s.shape,l,i.shape),d=t.makeTensorInfo([c.length],"int32",c),p=t.makeTensorInfo([u.length],r.dtype,u);return[d,p]}const a5e={kernelName:tY,backendName:"cpu",kernelFunc:i5e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o5e(n){const{inputs:e,backend:t,attrs:r}=n,{shape:s,values:i,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=r,c=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,d=t.data.get(a.dataId).values,p=o.map(b=>t.data.get(b.dataId).values),x=o.map(b=>b.shape),[y,v]=Xee(c,s.shape,u,i.shape,i.dtype,d,a.shape,p,x,l);return t.makeTensorInfo(y,i.dtype,v)}const l5e={kernelName:nY,backendName:"cpu",kernelFunc:o5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5e(n){const{backend:e,attrs:t}=n,{start:r,stop:s,dtype:i,step:a}=t,o=Yee(r,s,a,i);return e.makeTensorInfo([o.length],i,o)}const u5e={kernelName:r$,backendName:"cpu",kernelFunc:c5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h5e=_r(ev,n=>1/n),d5e={kernelName:ev,backendName:"cpu",kernelFunc:h5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f5e(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r;_t(s,"resizeBilinear");const l=kt(s.shape),[c,u]=o,[d,p,x,y]=s.shape,v=t.data.get(s.dataId).values,b=new Float32Array(Ue([d,c,u,y])),S=[i&&c>1?p-1:p,i&&u>1?x-1:x],T=[i&&c>1?c-1:c,i&&u>1?u-1:u];let C=0;const I=S[0]/T[0],$=S[1]/T[1];for(let q=0;q<d;q++)for(let U=0;U<c;U++){let F;a?F=I*(U+.5)-.5:F=I*U;const G=Math.max(0,Math.floor(F)),V=F-G,O=Math.min(p-1,Math.ceil(F)),K=q*l[0]+G*l[1],P=q*l[0]+O*l[1];for(let N=0;N<u;N++){let M;a?M=$*(N+.5)-.5:M=$*N;const B=Math.max(0,Math.floor(M)),Y=M-B,Z=Math.min(x-1,Math.ceil(M)),ne=K+B*l[2],Q=P+B*l[2],z=K+Z*l[2],D=P+Z*l[2];for(let X=0;X<y;X++){const re=v[ne+X],W=v[Q+X],ae=v[z+X],pe=v[D+X],de=re+(ae-re)*Y,ve=W+(pe-W)*Y,Ve=de+(ve-de)*V;b[C++]=Ve}}}return t.makeTensorInfo([d,c,u,y],"float32",b)}const p5e={kernelName:XT,backendName:"cpu",kernelFunc:f5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5e(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:a}=r;_t([i,s],"resizeBilinearGrad");const o=kt(s.shape),[l,c,u,d]=s.shape,[,p,x]=i.shape,y=new Float32Array(l*c*u*d),v=[a&&p>1?c-1:c,a&&x>1?u-1:u],b=[a&&p>1?p-1:p,a&&x>1?x-1:x],S=v[0]/b[0],T=v[1]/b[1],C=t.data.get(i.dataId).values;let I=0;for(let $=0;$<l;$++){const q=$*o[0];for(let U=0;U<p;U++){const F=U*S,G=Math.floor(F),V=Math.min(Math.ceil(F),c-1),O=q+G*o[1],K=q+V*o[1],P=F-G,N=1-P;for(let M=0;M<x;M++){const B=M*T,Y=Math.floor(B),Z=Math.min(Math.ceil(B),u-1),ne=B-Y,Q=1-ne,z=O+Y*o[2],D=O+Z*o[2],X=K+Y*o[2],re=K+Z*o[2],W=N*Q,ae=N*ne,pe=P*Q,de=P*ne;for(let ve=0;ve<d;ve++){const Ve=C[I++];y[z+ve]+=Ve*W,y[D+ve]+=Ve*ae,y[X+ve]+=Ve*pe,y[re+ve]+=Ve*de}}}}return t.makeTensorInfo([l,u,c,d],"float32",y)}const g5e={kernelName:a$,backendName:"cpu",kernelFunc:m5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5e(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r;_t(s,"resizeNearestNeighbor");const l=kt(s.shape),[c,u]=o,[d,p,x,y]=s.shape,v=t.data.get(s.dataId).values,b=new Float32Array(d*c*u*y),S=[i&&c>1?p-1:p,i&&u>1?x-1:x],T=[i&&c>1?c-1:c,i&&u>1?u-1:u],C=S[0]/T[0],I=S[1]/T[1];let $=0;for(let q=0;q<d;q++){const U=q*l[0];for(let F=0;F<c;F++){const G=a?C*(F+.5):C*F;let V=Math.min(p-1,i?Math.round(G):Math.floor(G));a&&(V=Math.max(0,V));const O=U+V*l[1];for(let K=0;K<u;K++){const P=a?I*(K+.5):I*K;let N=Math.min(x-1,i?Math.round(P):Math.floor(P));a&&(N=Math.max(0,N));const M=O+N*l[2];for(let B=0;B<y;B++){const Y=v[M+B];b[$++]=Y}}}}return t.makeTensorInfo([d,c,u,y],s.dtype,b)}const y5e={kernelName:KT,backendName:"cpu",kernelFunc:x5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b5e(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:a}=r;_t([i,s],"resizeNearestNeighborGrad");const o=kt(s.shape),l=kt(i.shape),[c,u,d,p]=s.shape,[,x,y]=i.shape,v=new Float32Array(c*u*d*p),b=t.data.get(i.dataId).values,S=[a&&x>1?u-1:u,a&&y>1?d-1:d],T=[a&&x>1?x-1:x,a&&y>1?y-1:y],C=S[0]/T[0],I=S[1]/T[1],$=1/C,q=1/I,U=Math.ceil($)*2+2,F=Math.ceil(q)*2+2;for(let G=0;G<c;G++){const V=G*o[0];for(let O=0;O<u;O++){const K=V+O*o[1],P=Math.floor(O*$),N=Math.floor(P-U/2);for(let M=0;M<d;M++){const B=K+M*o[2],Y=Math.floor(M*q),Z=Math.floor(Y-F/2);for(let ne=0;ne<p;ne++){let Q=0;for(let z=0;z<U;z++){const D=z+N;if(D<0||D>=x)continue;const X=V+D*l[1],re=D*C,W=Math.min(u-1,a?Math.round(re):Math.floor(re));if(O===W)for(let ae=0;ae<F;ae++){const pe=ae+Z;if(pe<0||pe>=y)continue;const de=X+pe*l[2],ve=pe*I,Ve=Math.min(d-1,a?Math.round(ve):Math.floor(ve));M===Ve&&(Q+=b[de+ne])}}v[B+ne]=Q}}}}return t.makeTensorInfo(s.shape,s.dtype,v)}const v5e={kernelName:i$,backendName:"cpu",kernelFunc:b5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _5e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dims:i}=r;_t(s,"reverse");const a=s.shape.length,o=Sn(i,s.shape);if(a===0)return Nu({inputs:{x:s},backend:t});const l=new Oi(s.shape,s.dtype),c=t.bufferSync(s);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),p=d.slice();o.forEach(x=>p[x]=s.shape[x]-1-p[x]),l.set(c.get(...p),...d)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const w5e={kernelName:YT,backendName:"cpu",kernelFunc:_5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E5e={kernelName:f$,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:s,fillValue:i,center:a}=e,o=t,l=Ji(r.dtype,Ue(r.shape)),[c,u,d,p]=r.shape,[x,y]=J$(a,u,d),v=255,b=Math.sin(s),S=Math.cos(s),T=o.data.get(r.dataId).values;for(let I=0;I<c;I++){const $=I*d*u*p;for(let q=0;q<u;q++){const U=q*(d*p);for(let F=0;F<d;F++){const G=F*p;for(let V=0;V<p;V++){const O=[c,q,F,V],K=O[2],P=O[1];let N=(K-x)*S-(P-y)*b,M=(K-x)*b+(P-y)*S;N=Math.round(N+x),M=Math.round(M+y);let B=i;if(typeof i!="number"&&(V===3?B=v:B=i[V]),N>=0&&N<d&&M>=0&&M<u){const Z=M*(d*p),ne=N*p,Q=$+Z+ne+V;B=T[Q]}const Y=$+U+G+V;l[Y]=B}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5e=_r(rv,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),T5e={kernelName:rv,backendName:"cpu",kernelFunc:S5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C5e(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s,updates:i}=e,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Lm(i,s,a),p=!0,x=t.bufferSync(s),y=t.bufferSync(i),v=$p(x,y,a,d,c,l,o,u,0,p);return t.makeTensorInfo(a,v.dtype,v.values)}const A5e={kernelName:rY,backendName:"cpu",kernelFunc:C5e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N5e(n,e){let t=0,r=n.length,s=0;for(;t<r;)s=Math.floor((t+r)/2),n[s]<e?t=s+1:r=s;return r}function k5e(n,e){let t=0,r=n.length,s=0;for(;t<r;)s=Math.floor((t+r)/2),n[s]<=e?t=s+1:r=s;return r}function I5e(n,e,t,r,s,i){const a=vs("int32",t*s);for(let o=0;o<t;++o){const l=n.slice(o*r,(o+1)*r),c=o*s;for(let u=0;u<s;++u)a[c+u]=i==="left"?N5e(l,e[u+c]):k5e(l,e[u+c])}return a}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R5e(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:s,values:i}=e,{side:a}=r,o=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,c=I5e(o,l,s.shape[0],s.shape[1],i.shape[1],a);return t.makeTensorInfo(i.shape,"int32",c)}const D5e={kernelName:iY,backendName:"cpu",kernelFunc:R5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $5e(n){const{inputs:e,backend:t}=n,{condition:r,t:s,e:i}=e;_t([r,s,i],"select");const a=r.shape.length,o=t.data.get(r.dataId).values,l=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,u=wo(s.dtype,i.dtype),d=ea(Ue(s.shape),u);let p=0;const x=a===0||a>1||s.shape.length===1?1:Ue(s.shape.slice(1));for(let y=0;y<o.length;y++)for(let v=0;v<x;v++)o[y]===1?d[p++]=l[y]:d[p++]=c[y];return t.makeTensorInfo(s.shape,u,d)}const L5e={kernelName:ZT,backendName:"cpu",kernelFunc:$5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P5e=xC,O5e=yC,M5e=_r(iv,n=>n>=0?O5e*n:P5e*(Math.exp(n)-1)),F5e={kernelName:iv,backendName:"cpu",kernelFunc:M5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B5e=_r(lv,n=>n<0?-1:n>0?1:0),z5e={kernelName:lv,backendName:"cpu",kernelFunc:B5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j5e=_r(av,n=>Math.sin(n)),V5e={kernelName:av,backendName:"cpu",kernelFunc:j5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U5e=_r(ov,n=>Math.sinh(n)),G5e={kernelName:ov,backendName:"cpu",kernelFunc:U5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H5e=11920928955078125e-23,XB=Math.log(H5e)+2,W5e=_r(uv,n=>{const e=n>-XB,t=n<XB,r=Math.exp(n);let s;return t?s=r:e?s=n:s=Math.log(1+r),s}),q5e={kernelName:uv,backendName:"cpu",kernelFunc:W5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K5e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,paddings:a}=r;_t([s],"spaceToBatchND");const o=Ue(i),l=[[0,0]];l.push(...a);for(let q=1+i.length;q<s.shape.length;++q)l.push([0,0]);const c=Nte.kernelFunc({inputs:{x:s},backend:t,attrs:{paddings:l,constantValue:0}}),u=Ev(c.shape,i,o,!1),d=Sv(u.length,i.length,!1),p=Tv(c.shape,i,o,!1),v=Fr({inputs:{x:c},backend:t,attrs:{shape:u}}),T=no({inputs:{x:v},backend:t,attrs:{perm:d}}),$=Fr({inputs:{x:T},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(T),$}const X5e={kernelName:eC,backendName:"cpu",kernelFunc:K5e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y5e(n){const{inputs:e,backend:t}=n,{indices:r,values:s,denseShape:i,defaultValue:a}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=t.data.get(r.dataId).values,l=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,u=t.data.get(a.dataId).values[0],[d,p,x,y,v]=ete(o,r.shape,r.dtype,l,s.dtype,c,u);return[t.makeTensorInfo(p,r.dtype,d),t.makeTensorInfo([p[0]],s.dtype,x),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(b=>Number(b)))),t.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}const Z5e={kernelName:aY,backendName:"cpu",kernelFunc:Y5e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q5e(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const a=Array.from(t.data.get(s.dataId).values),o=t.data.get(r.dataId).values,l=Array.from(t.data.get(i.dataId).values),[c,u,d]=tte(o,r.shape,r.dtype,a,l);return[t.makeTensorInfo(u,r.dtype,c),t.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const J5e={kernelName:oY,backendName:"cpu",kernelFunc:Q5e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eFe(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,[c,u]=V6(a,r.shape,r.dtype,o,l,!0);return t.makeTensorInfo(u,r.dtype,c)}const tFe={kernelName:lY,backendName:"cpu",kernelFunc:eFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nFe(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,[c,u]=V6(a,r.shape,r.dtype,o,l);return t.makeTensorInfo(u,r.dtype,c)}const rFe={kernelName:cY,backendName:"cpu",kernelFunc:nFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sFe(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:s,sparseValues:i,defaultValue:a}=e,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=Lm(i,s,o),x=!1,y=t.bufferSync(s);let v;switch(i.dtype){case"bool":{const b=t.bufferSync(i),S=!!t.data.get(a.dataId).values[0];v=$p(y,b,o,p,u,c,l,d,S,x);break}case"float32":{const b=t.bufferSync(i),S=t.data.get(a.dataId).values[0];v=$p(y,b,o,p,u,c,l,d,S,x);break}case"int32":{const b=t.bufferSync(i),S=t.data.get(a.dataId).values[0];v=$p(y,b,o,p,u,c,l,d,S,x);break}case"string":{const b=t.bufferSync(i),S=yf(t.data.get(a.dataId).values[0]);v=$p(y,b,o,p,u,c,l,d,S,x);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return t.makeTensorInfo(o,v.dtype,v.values)}const iFe={kernelName:uY,backendName:"cpu",kernelFunc:sFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{numOrSizeSplits:i,axis:a}=r,o=Sn(a,s.shape)[0],l=p6(s,i,o),c=new Array(s.shape.length).fill(0),u=s.shape.slice();return l.map(d=>{const p=[...u];p[o]=d;const x=wm({inputs:{x:s},backend:t,attrs:{begin:c,size:p}});return c[o]+=d,x})}const oFe={kernelName:tC,backendName:"cpu",kernelFunc:aFe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lFe={kernelName:o$,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,r=e;_t(t,"square");const s=r.data.get(t.dataId).values,i=new Float32Array(s.length);for(let o=0;o<s.length;++o){const l=s[o];i[o]=l*l}return{dataId:r.write(i,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cFe=_r(xv,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),uFe={kernelName:xv,backendName:"cpu",kernelFunc:cFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,end:a,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:p}=r;_t(s,"stridedSlice");const{finalShapeSparse:x,finalShape:y,isIdentity:v,sliceDim0:b,isSimpleSlice:S,begin:T,end:C,strides:I}=Y$(s.shape,i,a,o,l,c,u,d,p);let $;if(v)$=Fr({inputs:{x:s},backend:t,attrs:{shape:y}});else if(b||S){ue(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const q=q$(T,C,I),U=wm({inputs:{x:s},backend:t,attrs:{begin:T,size:q}});$=Fr({inputs:{x:U},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(U)}else{const q=t.bufferSync(s),U=ste(x,q,I,T);$=t.makeTensorInfo(y,U.dtype,U.values)}return $}const dFe={kernelName:c$,backendName:"cpu",kernelFunc:hFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fFe(n){const{inputs:e,backend:t,attrs:r}=n,{separator:s,nGramWidths:i,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=e,p=t.data.get(u.dataId).values,x=t.data.get(d.dataId).values,[y,v]=ite(p,x,s,i,a,o,l,c);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(d.shape,"int32",v)]}const pFe={kernelName:hY,backendName:"cpu",kernelFunc:fFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mFe(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:s}=r,{input:i,delimiter:a}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=t.data.get(i.dataId).values,l=t.data.get(a.dataId).values[0],[c,u,d]=ate(o,l,s),p=u.length;return[t.makeTensorInfo([p,2],"int32",c),t.makeTensorInfo([p],"string",u),t.makeTensorInfo([2],"int32",new Int32Array(d))]}const gFe={kernelName:dY,backendName:"cpu",kernelFunc:mFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xFe(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const a=t.data.get(i.dataId).values,o=ote(a,s);return t.makeTensorInfo(i.shape,"int32",o)}const yFe={kernelName:fY,backendName:"cpu",kernelFunc:xFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bFe=_r(pv,n=>Math.tan(n)),vFe={kernelName:pv,backendName:"cpu",kernelFunc:bFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Fe=_r(mv,n=>Math.tanh(n)),wFe={kernelName:mv,backendName:"cpu",kernelFunc:_Fe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EFe(n){const{inputs:e,backend:t}=n,{tensor:r,indices:s,updates:i}=e,{sliceRank:a,numUpdates:o,sliceSize:l,strides:c,outputSize:u}=Lm(i,s,r.shape),d=!1,p=t.bufferSync(s),x=t.bufferSync(i),y=t.bufferSync(r),v=$p(p,x,r.shape,u,l,o,a,c,y,d);return t.makeTensorInfo(r.shape,v.dtype,v.values)}const SFe={kernelName:sY,backendName:"cpu",kernelFunc:EFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reps:i}=r;_t(s,"tile");const a=cte(t.bufferSync(s),i);return t.makeTensorInfo(a.shape,a.dtype,a.values)}const CFe={kernelName:gv,backendName:"cpu",kernelFunc:TFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{k:i,sorted:a}=r;_t(s,"topk");const o=t.data.get(s.dataId).values,[l,c]=hte(o,s.shape,s.dtype,i,a);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(c.shape,c.dtype,c.values)]}const NFe={kernelName:u$,backendName:"cpu",kernelFunc:AFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kFe(n){const{inputs:e,attrs:t,backend:r}=n,{image:s,transforms:i}=e,{interpolation:a,fillMode:o,fillValue:l,outputShape:c}=t,[u,d,p,x]=s.shape,[y,v]=c??[d,p],b=[u,y,v,x],S=kt(s.shape),T=S[0],C=S[1],I=S[2],$=kt(b),q=$[0],U=$[1],F=$[2],G=Ji(s.dtype,Ue(b));G.fill(l);const V=r.data.get(s.dataId).values,O=r.data.get(i.dataId).values;for(let P=0;P<u;++P){const N=i.shape[0]===1?O:O.subarray(P*8,P*8+8);for(let M=0;M<y;++M)for(let B=0;B<v;++B)for(let Y=0;Y<x;++Y){let Z;const ne=N[6]*B+N[7]*M+1;if(ne===0)continue;const Q=(N[0]*B+N[1]*M+N[2])/ne,z=(N[3]*B+N[4]*M+N[5])/ne,D=YB(Q,p,o),X=YB(z,d,o);switch(a){case"nearest":Z=PFe(V,d,p,T,C,I,P,X,D,Y,l);break;case"bilinear":Z=OFe(V,d,p,T,C,I,P,X,D,Y,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}const re=P*q+M*U+B*F+Y;G[re]=Z}return r.makeTensorInfo(b,s.dtype,G)}return{dataId:r.write(G,b,s.dtype),shape:s.shape,dtype:s.dtype}}const IFe={kernelName:h$,backendName:"cpu",kernelFunc:kFe};function YB(n,e,t){switch(t){case"reflect":return RFe(n,e);case"wrap":return DFe(n,e);case"nearest":return LFe(n,e);case"constant":default:return $Fe(n)}}function RFe(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const r=2*e;t<r&&(t=r*Math.trunc(-t/r)+t),t=t<-e?t+r:-t-1}else if(t>e-1)if(e<=1)t=0;else{const r=2*e;t-=r*Math.trunc(t/r),t>=e&&(t=r-t-1)}return um(0,t,e-1)}function DFe(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const r=e-1;t+=e*(Math.trunc(-t/r)+1)}else if(t>e-1)if(e<=1)t=0;else{const r=e-1;t-=e*Math.trunc(t/r)}return um(0,t,e-1)}function $Fe(n,e){return n}function LFe(n,e){return um(0,n,e-1)}function $y(n,e,t,r,s,i,a,o,l,c,u){const d=a*r+o*s+l*i+c;return 0<=o&&o<e&&0<=l&&l<t?n[d]:u}function PFe(n,e,t,r,s,i,a,o,l,c,u){const d=Math.round(o),p=Math.round(l);return $y(n,e,t,r,s,i,a,d,p,c,u)}function OFe(n,e,t,r,s,i,a,o,l,c,u){const d=Math.floor(o),p=Math.floor(l),x=d+1,y=p+1,v=(y-l)*$y(n,e,t,r,s,i,a,d,p,c,u)+(l-p)*$y(n,e,t,r,s,i,a,d,y,c,u),b=(y-l)*$y(n,e,t,r,s,i,a,x,p,c,u)+(l-p)*$y(n,e,t,r,s,i,a,x,y,c,u);return(x-o)*v+(o-d)*b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MFe(n){const{inputs:e,attrs:t,backend:r}=n,{axis:s}=t,{x:i}=e;_t(i,"unique");const a=r.data.get(i.dataId).values,{outputValues:o,outputShape:l,indices:c}=dte(a,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}const FFe={kernelName:d$,backendName:"cpu",kernelFunc:MFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BFe(n){const{inputs:e,backend:t,attrs:r}=n,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const a=s.shape.length,o=s.shape[i],l=new Array(a-1);let c=0;for(let x=0;x<a;x++)x!==i&&(l[c++]=s.shape[x]);const u=new Array(a).fill(0),d=s.shape.slice();d[i]=1;const p=new Array(o);for(let x=0;x<p.length;x++){u[i]=x;const y=wm({inputs:{x:s},backend:t,attrs:{begin:u,size:d}});p[x]=Fr({inputs:{x:y},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(y)}return p}const zFe={kernelName:rC,backendName:"cpu",kernelFunc:BFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,segmentIds:i}=e,{numSegments:a}=r;_t(s,"unsortedSegmentSum");const o=s.shape.length,l=i.shape.length,c=[],u=[],d=o-l;let p=i;for(let y=0;y<d;++y){const v=eS({inputs:{input:p},backend:t,attrs:{dim:y+1}});p=v,u.push(v)}for(let y=0;y<a;++y){const v=Pf(y,"int32"),b=t.makeTensorInfo([],"int32",v),S=Aee({inputs:{a:b,b:p},backend:t}),T=Ef({inputs:{x:S},backend:t,attrs:{dtype:"float32"}}),C=IC({inputs:{a:T,b:s},backend:t}),I=Lv({inputs:{x:C},backend:t,attrs:{axis:0,keepDims:!1}});c.push(I),u.push(b),u.push(S),u.push(T),u.push(C),u.push(I)}const x=Ate({inputs:c,backend:t,attrs:{axis:0}});return u.forEach(y=>t.disposeIntermediateTensorInfo(y)),x}const VFe={kernelName:sC,backendName:"cpu",kernelFunc:jFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UFe=[MPe,xLe,BPe,jPe,ELe,UPe,HPe,qPe,XPe,ZPe,JPe,tOe,rOe,aOe,lOe,hOe,fOe,mOe,xOe,PPe,bOe,_Oe,EOe,TLe,TOe,_Le,ALe,AOe,yLe,kOe,ROe,DOe,LOe,OOe,FOe,zOe,VOe,GOe,WOe,KOe,YOe,QOe,eMe,nMe,rMe,iMe,oMe,cMe,uMe,hMe,dMe,pMe,xMe,NPe,bMe,NLe,AMe,kLe,NMe,RLe,LMe,PMe,MMe,$Le,PLe,BMe,jMe,UMe,HMe,MLe,BLe,bLe,qMe,IOe,XMe,ZMe,JMe,kPe,jLe,ULe,t8e,HLe,r8e,a8e,l8e,h8e,f8e,m8e,g8e,qLe,y8e,v8e,w8e,S8e,C8e,N8e,I8e,XLe,D8e,P8e,F8e,ZLe,JLe,j8e,G8e,q8e,tPe,X8e,Z8e,Q8e,Nte,n5e,RPe,sPe,s5e,a5e,l5e,u5e,vLe,P3,d5e,DPe,$Pe,LPe,p5e,g5e,y5e,v5e,w5e,E5e,T5e,dPe,A5e,D5e,L5e,F5e,pPe,z5e,V5e,G5e,mPe,O8e,q5e,X5e,Z5e,J5e,tFe,rFe,iFe,oFe,yPe,lFe,vPe,wPe,uFe,dFe,pFe,gFe,yFe,CPe,mMe,vFe,wFe,SFe,CFe,NFe,IFe,nPe,FFe,zFe,VFe,Y8e];for(const n of UFe)mY(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Np={},hw={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function GFe(n,e){Np[n]=e}function vc(n,e){if(!(n in Np)||e!=null){const r=WFe(n,e);if(r!==null)Np[n]=r;else return console.log("Could not get context for WebGL version",n),null}const t=Np[n];return t==null||t.isContextLost()?(delete Np[n],vc(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Np[n])}function HFe(n){if(!Me().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function WFe(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??HFe(n);return t.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Np[n]},!1),Me().getBool("SOFTWARE_WEBGL_ENABLED")&&(hw.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",hw)||t.getContext("experimental-webgl",hw):t.getContext("webgl2",hw)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var P1;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(P1||(P1={}));var Qo;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(Qo||(Qo={}));var Li;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Li||(Li={}));function Pv(n,e){return[e,n]}function qFe(n,e){return n*e}function dw(n){const e=Ue(n),t=Math.ceil(e/4);return s3(t)}function cx(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function KFe(n,e){const[t,r]=cx(n,e);return t*r*4}function q6(n,e){const t=n;let r,s,i,a,o,l,c,u,d,p;return Me().getNumber("WEBGL_VERSION")===2?(r=t.R32F,s=t.R16F,i=t.RGBA16F,a=t.RGBA32F,o=t.RED,c=4,u=1,d=t.HALF_FLOAT,p=t.FLOAT,l=t.RGBA8):(r=n.RGBA,s=n.RGBA,i=n.RGBA,a=t.RGBA,o=n.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,p=n.FLOAT,l=n.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pt(n,e){const t=e();return Me().getBool("DEBUG")&&XFe(n),t}function XFe(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+JFe(n,e))}const YFe=596e-10,ZFe=65504;function QFe(n){return!!(Me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||YFe<Math.abs(n)&&Math.abs(n)<ZFe)}function JFe(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function fw(n,e){return zh(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function eBe(n,e){const t=zh(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(pt(n,()=>n.shaderSource(t,e)),pt(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function tBe(n,e){const t=zh(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(pt(n,()=>n.shaderSource(t,e)),pt(n,()=>n.compileShader(t)),Me().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw kte(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const nBe=/ERROR: [0-9]+:([0-9]+):/g;function kte(n,e){const t=nBe.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const r=+t[1],s=n.split(`
`),i=s.length.toString().length+2,a=s.map((d,p)=>ig((p+1).toString(),i)+d);let o=0;for(let d=0;d<a.length;d++)o=Math.max(a[d].length,o);const l=a.slice(0,r-1),c=a.slice(r-1,r),u=a.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${ig(c[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function rBe(n){return zh(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function sBe(n,e){if(pt(n,()=>n.linkProgram(e)),!Me().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Lk(n,e){if(pt(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function iBe(n,e){const t=zh(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return pt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),pt(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function aBe(n,e){const t=zh(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return pt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),pt(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function oBe(n){return zh(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function lBe(n,e){const t=Me().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const r=`[${n}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t){const r=`[${n}x${e}]`,s=`[${t}x${t}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function cBe(n){return zh(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function ZB(n,e,t,r,s,i,a){const o=n.getAttribLocation(e,t);return o===-1?!1:(pt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),pt(n,()=>n.vertexAttribPointer(o,s,n.FLOAT,!1,i,a)),pt(n,()=>n.enableVertexAttribArray(o)),!0)}function uBe(n,e,t){mBe(n,t),pt(n,()=>n.activeTexture(n.TEXTURE0+t)),pt(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function hBe(n,e,t){return zh(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function dBe(n,e,t){return n.getUniformLocation(e,t)}function fBe(n,e,t,r){pt(n,()=>uBe(n,e,r)),pt(n,()=>n.uniform1i(t,r))}function Pk(n,e,t){pt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),pt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function QB(n,e){pt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),pt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function pw(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+pBe(n,e))}function pBe(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function zh(n,e,t){const r=pt(n,()=>e());if(r==null)throw new Error(t);return r}function mBe(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t){const s=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${s}.`)}}function $g(n,e=2){return Ue(n.slice(0,n.length-e))}function Lg(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function mw(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[$g(n),...Lg(n)]),e}function gBe(n,e=!1){let t=Me().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Me().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Me().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=t/2),e&&(t=t*2,r=r*2,n=n.map((o,l)=>l>=n.length-2?wD(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=Lf(n).newShape);let s=Ue(n),i=null;n.length<=1&&s<=t?i=[1,s]:n.length===2&&n[0]<=t&&n[1]<=t?i=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?i=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?i=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?i=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(i=[n[0],n[1]*n[2]*n[3]]);const a=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||a)if(e){const o=$g(n);let l=2,c=2;n.length&&([l,c]=Lg(n)),s=o*(l/2)*(c/2),i=s3(s).map(u=>u*2)}else i=s3(s);return i}function gw(n){return n%2===0}function nS(n,e){if(n=n.slice(-2),e=e.slice(-2),gr(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],r=e[e.length-1];if(t===r||gw(t)&&gw(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&gw(n[0])&&gw(e[0])}let Ok,Mk;function xBe(n){if(Ok==null){const e=vc(n);Ok=e.getParameter(e.MAX_TEXTURE_SIZE)}return Ok}function yBe(n){if(Mk==null){const e=vc(n);Mk=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Mk)}function bBe(n){if(n===0)return 0;let e;const t=vc(n);return kl(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:kl(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function kl(n,e){return n.getExtension(e)!=null}function JB(n){try{if(vc(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function vBe(n){if(n===0)return!1;const e=vc(n);if(n===1){if(!kl(e,"OES_texture_float"))return!1}else if(!kl(e,"EXT_color_buffer_float"))return!1;return M3(e)}function _Be(n){if(n===0)return!1;const e=vc(n);if(n===1){if(!kl(e,"OES_texture_float")||!kl(e,"WEBGL_color_buffer_float"))return!1}else{if(kl(e,"EXT_color_buffer_float"))return M3(e);const r="EXT_color_buffer_half_float";if(kl(e,r)){const s=e.getExtension(r);return wBe(e,s)}return!1}return M3(e)}function M3(n){const e=q6(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(i),a}function wBe(n,e){const t=q6(n,e),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(a),o}function EBe(n){return n!==2?!1:vc(n).fenceSync!=null}function Ov(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&ue(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Et=Me();Et.registerFlag("HAS_WEBGL",()=>Et.getNumber("WEBGL_VERSION")>0);Et.registerFlag("WEBGL_VERSION",()=>JB(2)?2:JB(1)?1:0);Et.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Et.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Et.get("WEBGL_VERSION")===2);Et.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Et.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Et.registerFlag("WEBGL_PACK",()=>Et.getBool("HAS_WEBGL"));Et.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_CLIP",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_REDUCE",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_LAZILY_UNPACK",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_CONV_IM2COL",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>xBe(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>yBe(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Et.getNumber("WEBGL_VERSION");return n===0?0:bBe(n)});Et.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Et.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!CY());Et.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>vBe(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Et.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Et.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Et.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>_Be(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_FENCE_API_ENABLED",()=>EBe(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Et.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Et.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Et.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>CY()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Et.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Et.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Et.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Et.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Et.registerFlag("WEBGL_EXP_CONV",()=>!1);Et.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Et.getBool("IS_TEST"));Et.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Et.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Et.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Et.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $a(){let n,e,t,r,s,i,a,o,l,c;return Me().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",s="texture",i="outputColor",a="out vec4 outputColor;",o=Me().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",s="texture2D",i="gl_FragColor",a="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:s,output:i,defineOutput:a,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mm(n,e,t="index"){const r=kt(e);return r.map((s,i)=>{const a=`int ${n[i]} = ${t} / ${s}`,o=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${s}`:`index -= ${n[i]} * ${s}`;return`${a}; ${o};`}).join("")}function RC(n,e,t="index"){const r=kt(e);return r.map((s,i)=>{const a=`int ${n[i]} = ${t} / outShapeStrides[${i}]`,o=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * outShapeStrides[${i}]`:`index -= ${n[i]} * outShapeStrides[${i}]`;return`${a}; ${o};`}).join("")}function SBe(n,e){const t=n.length,r=n.map(i=>`${e}[${i}]`),s=new Array(t-1);s[t-2]=r[t-1];for(let i=t-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function TBe(n,e,t="index"){const r=n.map((i,a)=>a),s=SBe(r,e);return s.map((i,a)=>{const o=`int ${n[a]} = ${t} / ${s[a]}`,l=a===s.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * ${s[a]}`:`index -= ${n[a]} * ${s[a]}`;return`${o}; ${l};`}).join("")}function K6(n){const e=kt(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function X6(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const Ite=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:Rte}=mRe;function CBe(n,e,t){const r=[];if(n.forEach(x=>{const y=Ue(x.shapeInfo.logicalShape);if(x.shapeInfo.isUniform?r.push(`uniform float ${x.name}${y>1?`[${y}]`:""};`):(r.push(`uniform sampler2D ${x.name};`),r.push(`uniform int offset${x.name};`)),t.enableShapeUniforms){const{uniformShape:v}=Y6(t.packedInputs,x.shapeInfo.logicalShape,x.shapeInfo.texShape);switch(v.length){case 1:r.push(`uniform int ${x.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${x.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${x.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${x.name}Shape;`);break}r.push(`uniform ivec2 ${x.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(x=>{r.push(`uniform ${x.type} ${x.name}${x.arrayIndex?`[${x.arrayIndex}]`:""};`)});const s=r.join(`
`),i=n.map(x=>ABe(x,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),a=e.texShape,o=$a(),l=IBe(o);let c,u,d=$Be(o);return e.isPacked?(c=NBe(e.logicalShape,a,t.enableShapeUniforms),u=DBe(o)):(c=kBe(e.logicalShape,a,t.enableShapeUniforms),u=RBe(o)),t.packedInputs&&(d+=MBe),[d,l,u,s,c,i,t.userCode].join(`
`)}function ux(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return XBe(n,e);case 1:return ZBe(n,e);case 2:return JBe(n,e);case 3:return t9e(n,e);case 4:return r9e(n,e);case 5:return s9e(n);case 6:return i9e(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function Dte(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return KBe(n);case 1:return YBe(n,e);case 2:return QBe(n,e);case 3:return e9e(n,e);default:return n9e(n,e)}}function ABe(n,e,t=!1,r){let s="";t?s+=Dte(n,r):s+=ux(n,r);const i=n.shapeInfo.logicalShape,a=e.logicalShape;return i.length<=a.length&&(t?s+=a9e(n,e):s+=o9e(n,e)),s}function NBe(n,e,t){switch(n.length){case 0:return $te();case 1:return FBe(n,e,t);case 2:return WBe(n,e,t);case 3:return zBe(n,e,t);default:return VBe(n,e,t)}}function kBe(n,e,t){switch(n.length){case 0:return $te();case 1:return BBe(n,e,t);case 2:return qBe(n,e,t);case 3:return jBe(n,e,t);case 4:return UBe(n,e,t);case 5:return GBe(n,e);case 6:return HBe(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function IBe(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function RBe(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function DBe(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function $Be(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${LBe}
    ${PBe}
    ${OBe}
  `}const LBe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,PBe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,OBe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,MBe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function $te(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function FBe(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function BBe(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function zBe(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[2]/2),i=s*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function jBe(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${RC(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const r=Mm(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function VBe(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[n.length-1]/2),i=s*Math.ceil(n[n.length-2]/2);let a=i,o="",l="b, r, c";for(let c=2;c<n.length-1;c++)a*=n[n.length-c-1],o=`
      int b${c} = index / ${a};
      index -= b${c} * ${a};
    `+o,l=`b${c}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${n.length}(${l});
    }
  `}function UBe(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${RC(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Mm(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function GBe(n,e){const t=Mm(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function HBe(n,e){const t=Mm(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function WBe(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(gr(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function qBe(n,e,t){return gr(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Fm(n){return`offset${n}`}function KBe(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=$a();return`
    vec4 ${t}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function XBe(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${r}() {return ${t};}`;const[s,i]=n.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=Fm(t);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${a});
      return sampleTexture(${t}, uv);
    }
  `;const[o,l]=n.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${a});
      return sampleTexture(${t}, uv);
    }
  `}function YBe(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=n.shapeInfo.texShape,i=$a();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${t}, uv);
    }
  `;const a=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${a[0]}, ${a[1]}, index);
      return ${i.texture2D}(${t}, uv);
    }
  `}function ZBe(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${hx(n)}
      }
    `;const s=n.shapeInfo.texShape,i=s[0],a=s[1];if(a===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=Fm(t);return a===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${i}.0);
        return sampleTexture(${t}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${a}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${o});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${a}, index + ${o});
      return sampleTexture(${t}, uv);
    }
  `}function QBe(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,a=i[0],o=i[1],l=$a();if(i!=null&&gr(t,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${a}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(t[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function JBe(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape;if(i!=null&&gr(t,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const p=i[0],x=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${x}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:a,keptDims:o}=Lf(t),l=a;if(l.length<t.length){const p=dx(n,l),x=["row","col"];return`
      ${ux(p,e)}
      float ${s}(int row, int col) {
        return ${s}(${fx(x,o)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${hx(n)}
      }
    `;const c=i[0],u=i[1],d=Fm(r);return u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function e9e(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(t[0]===1){const p=t.slice(1),x=[1,2],y=dx(n,p),v=["b","row","col"];return`
        ${Dte(y,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${fx(v,x)});
        }
      `}const o=$a();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;const l=a[0],c=a[1],u=Math.ceil(t[2]/2),d=u*Math.ceil(t[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function t9e(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[1]*t[2],a=t[2],{newShape:o,keptDims:l}=Lf(t),c=o;if(c.length<t.length){const v=dx(n,c),b=["row","col","depth"];return`
        ${ux(v,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${fx(b,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${a}, 1)));
        ${hx(n)}
      }
    `;const u=n.shapeInfo.texShape,d=u[0],p=u[1],x=n.shapeInfo.flatOffset;if(p===i&&x==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${a}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===a&&x==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const y=Fm(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${y};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${a} + depth + ${y};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function n9e(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=$a();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${t}, uv);
    }
  `;const i=n.shapeInfo.logicalShape,a=i.length,o=n.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],u=l[1],d=Math.ceil(i[a-1]/2);let p=d*Math.ceil(i[a-2]/2),x="int b, int row, int col",y=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let v=2;v<a-1;v++)x=`int b${v}, `+x,p*=i[a-v-1],y=`b${v} * ${p} + `+y;return`
    vec4 ${r}(${x}) {
      int index = ${y};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${s.texture2D}(${t}, uv);
    }
  `}function r9e(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[3],a=t[2]*i,o=t[1]*a,{newShape:l,keptDims:c}=Lf(t);if(l.length<t.length){const T=dx(n,l),C=["row","col","depth","depth2"];return`
      ${ux(T,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${fx(C,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${a}, ${i}, 1)));
        ${hx(n)}
      }
    `;const u=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,p=d[0],x=d[1],y=`int stride2 = ${r}Shape[3];`,v=`int stride1 = ${r}Shape[2] * stride2;`,b=`int stride0 = ${r}Shape[1] * stride1;`;if(x===o&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${y}
        ${v}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${a}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${x}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(x===i&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${x}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;const S=Fm(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${y}
      ${v}
      ${b}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${S});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${p}, ${x}, index + ${S});
      return sampleTexture(${r}, uv);
    }
  `}function s9e(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=e[4],i=e[3]*s,a=e[2]*i,o=e[1]*a,{newShape:l,keptDims:c}=Lf(e);if(l.length<e.length){const v=dx(n,l),b=["row","col","depth","depth2","depth3"];return`
      ${ux(v)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${fx(b,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${a}, ${i}, ${s})) +
          depth3;
        ${hx(n)}
      }
    `;const u=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,p=d[0],x=d[1];if(x===o&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${a}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${x}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(x===s&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${x}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;const y=Fm(t);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} + depth * ${i} +
          depth2 * ${s} + depth3 + ${y};
      vec2 uv = uvFromFlat(${p}, ${x}, index);
      return sampleTexture(${t}, uv);
    }
  `}function i9e(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:s,keptDims:i}=Lf(e);if(s.length<e.length){const b=dx(n,s),S=["row","col","depth","depth2","depth3","depth4"];return`
      ${ux(b)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${fx(S,i)});
      }
    `}const a=e[5],o=e[4]*a,l=e[3]*o,c=e[2]*l,u=e[1]*c;if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${a}, 1)));
        ${hx(n)}
      }
    `;const d=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,x=p[0],y=p[1];if(y===u&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${o}, ${a})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${x}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(y===a&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${x}.0);
        return sampleTexture(${t}, uv);
      }
    `;const v=Fm(t);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${o} + depth3 * ${a} + depth4 + ${v};
      vec2 uv = uvFromFlat(${x}, ${y}, index);
      return sampleTexture(${t}, uv);
    }
  `}function hx(n){const e=n.name,t=Ue(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function a9e(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",i=n.shapeInfo.logicalShape.length,a=e.logicalShape.length,o=Rte(n.shapeInfo.logicalShape,e.logicalShape),l=Sr(a),c=a-i;let u;const d=["x","y","z","w","u","v"];i===0?u="":a<2&&o.length>=1?u="coords = 0;":u=o.map(T=>`coords.${d[T+c]} = 0;`).join(`
`);let p="";a<2&&i>0?p="coords":p=n.shapeInfo.logicalShape.map((T,C)=>`coords.${d[C+c]}`).join(", ");let x="return outputValue;";const v=Ue(n.shapeInfo.logicalShape)===1,S=Ue(e.logicalShape)===1;if(i===1&&!v&&!S)x=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(v&&!S)a===1?x=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:x=`
        return vec4(outputValue.x);
      `;else if(o.length){const T=i-2,C=i-1;o.indexOf(T)>-1&&o.indexOf(C)>-1?x="return vec4(outputValue.x);":o.indexOf(T)>-1?x="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(C)>-1&&(x="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${p});
      ${x}
    }
  `}function o9e(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,a=n.shapeInfo.texShape,o=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&o===l&&n.shapeInfo.flatOffset==null&&gr(a,i))return`
      float ${s}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const c=Sr(l),u=Rte(n.shapeInfo.logicalShape,e.logicalShape),d=l-o;let p;const x=["x","y","z","w","u","v"];o===0?p="":l<2&&u.length>=1?p="coords = 0;":p=u.map(v=>`coords.${x[v+d]} = 0;`).join(`
`);let y="";return l<2&&o>0?y="coords":y=n.shapeInfo.logicalShape.map((v,b)=>`coords.${x[b+d]}`).join(", "),`
    float ${s}() {
      ${c} coords = getOutputCoords();
      ${p}
      return get${r}(${y});
    }
  `}function Sr(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function Y6(n,e,t){const{newShape:r,keptDims:s}=Lf(e),i=e.length,a=n&&i===3&&e[0]===1,o=a?e.slice(1):r,l=!n&&i>1&&!gr(e,t)&&r.length<i||a;return{useSqueezeShape:l,uniformShape:l?o:e,keptDims:s}}function dx(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function fx(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9e(n,e,t,r){const s=t.map((u,d)=>{const p={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(p.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:p}}),i=s.map(u=>u.shapeInfo),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=CBe(s,a,e),l=tBe(n.gl,o),c=n.createProgram(l);return Me().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:a,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(c),Object.assign({program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:a},Lte(n,e,c)))}function Lte(n,e,t){const r=[],s=[];let i,a,o,l=null,c=null;c=n.getUniformLocation(t,"NAN",!1),Me().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(t,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const p={name:d,uniform:n.getUniformLocation(t,d,u),offset:n.getUniformLocation(t,`offset${d}`,u)};e.enableShapeUniforms&&(p.shape=n.getUniformLocation(t,`${d}Shape`,u),p.texShape=n.getUniformLocation(t,`${d}TexShape`,u)),r.push(p)}if(e.enableShapeUniforms&&(i=n.getUniformLocation(t,"outShape",u),o=n.getUniformLocation(t,"outShapeStrides",u),a=n.getUniformLocation(t,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)s.push(n.getUniformLocation(t,d.name,u));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:a}}function e9(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,r)=>{const s=t.logicalShape,i=e[r],a=i.shape;if(!gr(s,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${a} must match`);if(t.isUniform&&i.isUniform)return;const o=t.texShape,l=i.isUniform?null:i.texData.texShape;if(!gr(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function c9e(n,e,t,r,s){e.program.enableShapeUniforms||(e9(e.inShapeInfos,t),e9([e.outShapeInfo],[r]));const i=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(i.texture,a[0],a[1]):n.setOutputMatrixTexture(i.texture,a[0],a[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),Me().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<t.length;++l){const c=t[l],{uniform:u,offset:d,shape:p,texShape:x}=e.variablesLocations[l];if(p){const{uniformShape:y}=Y6(e.program.packedInputs,c.shape,c.texData.texShape);switch(y.length){case 1:n.gl.uniform1iv(p,new Int32Array(y));break;case 2:n.gl.uniform2iv(p,new Int32Array(y));break;case 3:n.gl.uniform3iv(p,new Int32Array(y));break;case 4:n.gl.uniform4iv(p,new Int32Array(y));break}}if(x&&n.gl.uniform2i(x,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(Ue(c.shape)<2)n.gl.uniform1f(u,c.uniformValues[0]);else{let y=c.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),n.gl.uniform1fv(u,y)}continue}c.texData.slice!=null&&d!=null&&n.gl.uniform1i(d,c.texData.slice.flatOffset),n.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const o=e.outShapeLocation;if(o)switch(r.shape.length){case 1:n.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:n.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:n.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:n.gl.uniform4iv(o,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=kt(r.shape);switch(r.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],d=s[l];if(c.type==="float")n.gl.uniform1fv(u,d);else if(c.type==="vec2")n.gl.uniform2fv(u,d);else if(c.type==="vec3")n.gl.uniform3fv(u,d);else if(c.type==="vec4")n.gl.uniform4fv(u,d);else if(c.type==="int")n.gl.uniform1iv(u,d);else if(c.type==="ivec2")n.gl.uniform2iv(u,d);else if(c.type==="ivec3")n.gl.uniform3iv(u,d);else if(c.type==="ivec4")n.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}n.executeProgram()}function u9e(n,e,t){let r="";e.concat(t).forEach(a=>{const o=a.texData!=null&&a.texData.slice!=null&&a.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!a.isUniform){const l=a.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=Y6(n.packedInputs,a.shape,l);let p="",x="",y="";if(u.length===1&&n.packedInputs){const $=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${$[0]>1}_${$[1]>1}`}else if(u.length===2&&!n.packedInputs)x=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!n.packedInputs){const $=kt(u);y=`${$[0]===l[1]}_${$[$.length-1]===l[1]}`}const v=a.shape.length,b=u.length===2&&gr(a.shape,l),S=Ue(a.shape)===1,T=Ag(a.shape,t.shape),C=!n.packedInputs&&v===t.shape.length&&gr(l,t.texData.texShape),I=n.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${v}_${C}_${c?d:""}_${u.length}_${S}_${T}_${b}_${p}_${x}_${y}_${I}_${o}`}else{const l=a.isUniform?"uniform":a.texData.texShape;r+=`${a.shape}_${l}_${o}`}});const s=n.userCode;let i=n.constructor.name;return i+="_"+r+"_"+s+`${Me().getNumber("WEBGL_VERSION")}`,i}function aa(n){return Me().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h9e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=P1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=$a();this.outputShape=e,this.enableShapeUniforms=aa(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?RC(["r","c","d"],e):Mm(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d9e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=P1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=$a();this.outputShape=e,this.enableShapeUniforms=aa(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?RC(["r","c","d"],e):Mm(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f9e{constructor(e){this.variableNames=["A"],this.outTexUsage=Qo.DOWNLOAD;const t=$a();this.outputShape=e,this.userCode=`
      ${Ite}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p9e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Qo.DOWNLOAD;const t=$a();this.outputShape=e,this.userCode=`
      ${Ite}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m9e={R:0,G:1,B:2,A:3};class t9{constructor(e,t=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=$a();this.outputShape=e,this.enableShapeUniforms=aa(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let a="";for(let o=0;o<r.length;o++){const l=r[o];a+=`
          if(offset == ${o}) {
            result = values[${m9e[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?X6():K6(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${a}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g9e{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=$a();this.outputShape=e,this.enableShapeUniforms=aa(this.outputShape.length);let s="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){const l=a*2+o;s+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?X6():K6(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9e(n){const e=$a(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return eBe(n,t)}function y9e(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return iBe(n,e)}function b9e(n){const e=new Uint16Array([0,1,2,2,1,3]);return aBe(n,e)}function Mv(n,e,t,r,s,i){lBe(e,t);const a=oBe(n),o=n.TEXTURE_2D;return pt(n,()=>n.bindTexture(o,a)),pt(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),pt(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),pt(n,()=>n.texParameteri(o,n.TEXTURE_MIN_FILTER,n.NEAREST)),pt(n,()=>n.texParameteri(o,n.TEXTURE_MAG_FILTER,n.NEAREST)),Me().getNumber("WEBGL_VERSION")===1?pt(n,()=>n.texImage2D(o,0,r,e,t,0,s,i,null)):pt(n,()=>n.texStorage2D(o,1,r,e,t)),pt(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:a,texShape:[t,e]}}function Pte(n){return n.internalFormatFloat}function v9e(n,e,t,r){const[s,i]=Pv(e,t);return Mv(n,s,i,Pte(r),r.textureFormatFloat,n.FLOAT)}function Ote(n){return n.internalFormatHalfFloat}function _9e(n,e,t,r){const[s,i]=Pv(e,t);return Mv(n,s,i,Ote(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function Mte(n){return n.downloadTextureFormat}function w9e(n,e,t,r){const[s,i]=Pv(e,t);return Mv(n,s,i,Mte(r),n.RGBA,n.UNSIGNED_BYTE)}function Fte(n){return n.internalFormatPackedFloat}function E9e(n,e,t,r){const[s,i]=cx(e,t);return Mv(n,s,i,Fte(r),n.RGBA,n.FLOAT)}function Bte(n){return n.internalFormatPackedHalfFloat}function S9e(n,e,t,r){const[s,i]=cx(e,t);return Mv(n,s,i,Bte(r),n.RGBA,r.textureTypeHalfFloat)}function T9e(n,e,t){return pt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),ZB(n,e,"clipSpacePos",t,3,20,0)&&ZB(n,e,"uv",t,2,20,12)}function C9e(n,e,t,r,s,i){pt(n,()=>n.bindTexture(n.TEXTURE_2D,e));let a,o,l;s instanceof Uint8Array?(a=new Uint8Array(t*r*4),o=n.UNSIGNED_BYTE,l=n.RGBA):(a=new Float32Array(t*r*4),o=n.FLOAT,l=i.internalFormatPackedFloat),a.set(s),Me().getNumber("WEBGL_VERSION")===2?pt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,r,n.RGBA,o,a)):pt(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,r,0,n.RGBA,o,a)),pt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function A9e(n,e,t){pt(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?Me().getNumber("WEBGL_VERSION")===2?pt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):pt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):Me().getNumber("WEBGL_VERSION")===2?pt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):pt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),pt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function N9e(n,e,t,r){const s=n.createBuffer();pt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,s));const o=4*4*e*t;return pt(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,o,n.STREAM_READ)),pt(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),pt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),s}function k9e(n,e,t){const r=n,s=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function I9e(n,e,t,r){const[s,i]=Pv(e,t),a=4,o=new Uint8Array(qFe(e*t,a));return pt(n,()=>n.readPixels(0,0,s,i,r.downloadTextureFormat,n.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function R9e(n,e,t,r,s,i,a,o){const l=n,c=new Float32Array(KFe(i,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function D9e(n,e,t){const r=new Float32Array(e*t*4);return pt(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fk{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=Me().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,GFe(t,e)):this.gl=vc(t),e=this.gl,Me().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>pt(i,()=>i.createVertexArray()),this.bindVertexArray=a=>pt(i,()=>i.bindVertexArray(a)),this.deleteVertexArray=a=>pt(i,()=>i.deleteVertexArray(a)),this.getVertexArray=()=>pt(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>pt(e,()=>i.createVertexArrayOES()),this.bindVertexArray=a=>pt(e,()=>i.bindVertexArrayOES(a)),this.deleteVertexArray=a=>pt(e,()=>i.deleteVertexArrayOES(a)),this.getVertexArray=()=>pt(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Me().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=fw(this.gl,i),kl(this.gl,a))this.textureHalfFloatExtension=fw(this.gl,a);else if(Me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),kl(this.gl,s))this.colorBufferHalfFloatExtension=fw(this.gl,s);else if(Me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",kl(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(kl(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=y9e(this.gl),this.indexBuffer=b9e(this.gl),this.framebuffer=cBe(this.gl),this.textureConfig=q6(this.gl,this.textureHalfFloatExtension)}get debug(){return Me().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;pt(e,()=>e.finish()),pt(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),pt(e,()=>e.deleteFramebuffer(this.framebuffer)),pt(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),pt(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),pt(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),v9e(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),_9e(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),w9e(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),A9e(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,r,s){this.throwIfDisposed(),C9e(this.gl,e,t,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),S9e(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),E9e(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(QB(this.gl,this.framebuffer),this.outputTexture=null),pt(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,r){return this.downloadMatrixDriver(e,()=>I9e(this.gl,t,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,r,s,i,a){return R9e(this.gl,e,t,r,s,i,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return k9e(this.gl,e,t)}createBufferFromTexture(e,t,r){this.bindTextureToFrameBuffer(e);const s=N9e(this.gl,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r;if(Me().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const a=s.clientWaitSync(i,0,0);return a===s.ALREADY_SIGNALED||a===s.CONDITION_SATISFIED},t=i}else Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(t,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:t,isFencePassed:r}}downloadMatrixFromPackedTexture(e,t,r){return this.downloadMatrixDriver(e,()=>D9e(this.gl,t,r))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=x9e(t));const r=rBe(t);pt(t,()=>t.attachShader(r,this.vertexShader)),pt(t,()=>t.attachShader(r,e)),sBe(t,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&Lk(t,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;pt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),T9e(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(pt(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Lk(this.gl,this.program),pt(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,r=!0){return this.throwIfDisposed(),r?hBe(this.gl,e,t):dBe(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),pt(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),fBe(this.gl,e,t,r)}setOutputMatrixTexture(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)}setOutputPackedMatrixTexture(e,t,r){this.throwIfDisposed();const[s,i]=cx(t,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,t,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,t)}setOutputPackedMatrixWriteRegion(e,t,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Lk(this.gl,this.program),pw(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}pt(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),pt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=fw(this.gl,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await WF(()=>this.disposed||this.isQueryAvailable(e,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=$9e(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:r}=this.itemsToPoll[t];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Me().platform&&(r=Me().platform.setTimeoutCustom.bind(Me().platform)),WF(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Pk(this.gl,e,this.framebuffer),this.debug&&pw(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Pk(this.gl,this.outputTexture,this.framebuffer),this.debug&&pw(this.gl)):QB(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const r=t();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,t,r){this.throwIfDisposed();const s=this.gl;Pk(s,e,this.framebuffer),this.debug&&pw(s),this.outputTexture=e,pt(s,()=>s.viewport(0,0,t,r)),pt(s,()=>s.scissor(0,0,t,r))}setOutputMatrixWriteRegionDriver(e,t,r,s){this.throwIfDisposed(),pt(this.gl,()=>this.gl.scissor(e,t,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function $9e(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:L9e,bincountImpl:zte,bincountReduceImpl:P9e,bitwiseAndImpl:O9e,castImpl:M9e,ceilImpl:F9e,concatImpl:B9e,equalImpl:z9e,expImpl:j9e,expm1Impl:V9e,floorImpl:U9e,gatherNdImpl:G9e,gatherV2Impl:H9e,greaterImpl:W9e,greaterEqualImpl:q9e,lessImpl:K9e,lessEqualImpl:X9e,linSpaceImpl:Y9e,logImpl:Z9e,maxImpl:Q9e,maximumImpl:J9e,minimumImpl:e7e,multiplyImpl:t7e,negImpl:n7e,notEqualImpl:r7e,prodImpl:s7e,raggedGatherImpl:i7e,raggedRangeImpl:a7e,raggedTensorToTensorImpl:o7e,rangeImpl:l7e,rsqrtImpl:c7e,scatterImpl:u7e,sigmoidImpl:h7e,simpleAbsImpl:jte,sliceImpl:d7e,sparseFillEmptyRowsImpl:f7e,sparseReshapeImpl:p7e,sparseSegmentReductionImpl:Vte,sqrtImpl:m7e,staticRegexReplaceImpl:g7e,stridedSliceImpl:x7e,stringNGramsImpl:y7e,stringSplitImpl:b7e,stringToHashBucketFastImpl:v7e,subImpl:_7e,tileImpl:w7e,topKImpl:E7e,transposeImpl:Z6,uniqueImpl:S7e}=APe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ute(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function Aa(n,e){return e===1?[n]:Ute(n,e)}function T7e(n,e){if(n===1)return"rc";let t="";for(let r=0;r<n;r++)t+=e[r],r<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C7e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=aa(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=Aa("rc",this.rank),r=Sr(this.rank),s=this.getOutOfBoundsCondition(t),i=this.getSetup(t),a=this.getOutput(t);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)i=`${e[e.length-1-a]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let r=this.rank-2;r<this.rank;r++)t+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gte{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=aa(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${A7e(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?X6():K6(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function A7e(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?TBe(["r","c","d"],"inputShape"):Mm(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N7e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,r){const s=r9(t,r),i=s9(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const a=n9(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let o;return s===Li.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===Li.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===Li.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===Li.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===Li.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(e,t,r,s){if(this.freeTextures==null)return;const i=r9(r,s),a=s9(t,i,s);a in this.freeTextures||(this.freeTextures[a]=[]);const o=n9(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=Me().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const c=this.usedTextures[a],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function k7e(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function n9(n,e,t,r,s){const i=I7e(e,r);let a;if(s){const[l,c]=cx(n[0],n[1]);a=l*c}else{const[l,c]=Pv(n[0],n[1]);a=l*c}const o=k7e(t,i);return a*o}function I7e(n,e){switch(n){case Li.PACKED_2X2_FLOAT32:return Fte(e);case Li.PACKED_2X2_FLOAT16:return Bte(e);case Li.UNPACKED_FLOAT32:return Pte(e);case Li.UNPACKED_FLOAT16:return Ote(e);case Li.PACKED_4X1_UNSIGNED_BYTE:return Mte(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function R7e(n){return Me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Li.PACKED_2X2_FLOAT32:Li.UNPACKED_FLOAT32:n?Li.PACKED_2X2_FLOAT16:Li.UNPACKED_FLOAT16}function r9(n,e){if(n===Qo.UPLOAD)return Li.PACKED_2X2_FLOAT32;if(n===Qo.RENDER||n==null)return R7e(e);if(n===Qo.DOWNLOAD||n===Qo.PIXELS)return Li.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function s9(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tu{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=aa(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Bl="if (isnan(x)) return x;",D7e="return x;",i9="return abs(x);",$7e="return (x >= 0.0) ? x : (exp(x) - 1.0);",L7e=Bl+`
  return (x < 0.0) ? 0.0 : x;
`,P7e=Bl+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Dd="return x;",O7e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M7e="return x;",F7e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,B7e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,z7e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,j7e="return 1.0 / (1.0 + exp(-1.0 * x));";class Wd{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=aa(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V7e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=aa(this.outputShape.length);const t=e.length,r=Aa("rc",t),s=Sr(t),i=T7e(t,r),a=r.slice(-2),o=t<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U7e=pZ,G7e=1e-7,H7e=1e-4,xw={};function W7e(n){return n in xw||(xw[n]={}),xw[n]}const q7e=Me().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),K7e=600;function X7e(){return Me().global.screen==null?1024:Me().global.screen.height*Me().global.screen.width*window.devicePixelRatio*K7e/1024/1024}class DC extends _D{nextDataId(){return DC.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Me().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof Fk)t=e;else{const r=vc(Me().getNumber("WEBGL_VERSION"),e);t=new Fk(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=vc(Me().getNumber("WEBGL_VERSION"));t=new Fk(r),this.binaryCache=W7e(Me().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new N7e(this.gpgpu),this.numMBBeforeWarning=X7e(),this.texData=new zX(this,zc())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,r,s,i,a){const o=this.makeTensorInfo(t,r),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,i]},l.texShape=[s,i];const c=mw(t),u=new t9(c,!1,a),d=this.runWebGLProgram(u,[o],r,[[s,i]]);return d.shape=t,l.texture=null,this.disposeIntermediateTensorInfo(o),d.dataId}write(e,t,r){if((Me().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Me().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:t,dtype:r,values:e,usage:Qo.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,r,s,i){if(Me().getBool("DEBUG")&&this.checkNumericalProblems(t),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:t,usage:Qo.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:a,shape:o,isPacked:l}=t;if(a!=null){let p;l?p=new Wd(o,Dd):p=new tu(o,Dd);const x=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:s}],s),y=this.readSync(x.dataId);return this.disposeIntermediateTensorInfo(x),y}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const c=this.activeTimers!=null;let u;c&&(u=Ya());let d;if(s==="complex64"){const p=this.readSync(i.real.dataId),x=this.readSync(i.imag.dataId);d=Rh(p,x)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Ya()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const y=this.pendingRead.get(e);return new Promise(v=>y.push(v))}const t=this.texData.get(e),{values:r,shape:s,slice:i,dtype:a,complexTensorInfos:o,isPacked:l}=t;if(i!=null){let y;l?y=new Wd(s,Dd):y=new tu(s,Dd);const v=this.runWebGLProgram(y,[{dataId:e,shape:s,dtype:a}],a),b=this.read(v.dataId);return this.disposeIntermediateTensorInfo(v),b}if(r!=null)return this.convertAndCacheOnCPU(e);if(Me().getBool("DEBUG")&&!Me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Me().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(a!=="complex64"&&Me().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const y=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(y.texture.texture,...dw(s))}this.pendingRead.set(e,[]),a!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(a==="complex64"){const y=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),v=y[0],b=y[1];d=Rh(v,b)}else if(c==null)d=this.getValuesFromTexture(e);else{const y=Ue(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,y)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const y=this.gpgpu.gl;pt(y,()=>y.deleteBuffer(c))}const p=this.convertAndCacheOnCPU(e,d),x=this.pendingRead.get(e);return this.pendingRead.delete(e),x.forEach(y=>y(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&zc().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,t={}){const r=this.texData.get(e),{values:s,shape:i,slice:a,dtype:o,isPacked:l,texture:c}=r;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let x;l?x=new Wd(i,Dd):x=new tu(i,Dd);const y=this.runWebGLProgram(x,[{dataId:e,shape:i,dtype:o}],o),v=this.readToGPU(y,t);return this.disposeIntermediateTensorInfo(y),v}if(c==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,t.customTexShape),d=zc().makeTensorFromTensorInfo(u),p=this.texData.get(u.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(s=>yf(s));return En(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return En(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const r=e[t];if(!QFe(r))throw Me().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:r,isPacked:s}=this.texData.get(e),i=Ue(t);if(Me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),x=this.texData.get(p.dataId),y=this.gpgpu.downloadMatrixFromPackedTexture(x.texture.texture,...dw(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(p),y}const a=Me().getBool("WEBGL_PACK")&&s===!0,o=a?mw(t):t,l=a?new p9e(o):new f9e(o),c=this.runWebGLProgram(l,[{shape:o,dtype:r,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=hm(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),a=hm(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,s&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);o.kernelMs=eAe(l),o.getExtraProfileInfo=()=>l.map((c,u)=>({name:a[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ya(),endMs:null}}endTimer(e){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Ya(),e)}async getQueryTime(e){if(Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:r,texShape:s,usage:i,isPacked:a,slice:o}=this.texData.get(e),l=o&&o.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(t,s,i,a)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=q7e){return Me().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&Ue(r.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Xo("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return U7e(e.shape,t)}packedUnaryOp(e,t,r){const s=new Wd(e.shape,t),i=this.compileAndRun(s,[e],r);return zc().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=jte(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(Me().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,i9,e.dtype);const t=new tu(e.shape,i9),r=this.compileAndRun(t,[e]);return zc().makeTensorFromTensorInfo(r)}makeTensorInfo(e,t,r){let s;if(t==="string"&&r!=null&&r.length>0&&wb(r[0])){const i=r.map(a=>Jd(a));s=this.write(i,e,t)}else s=this.write(r,e,t);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:t}}makeOutput(e,t,r){return zc().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,r),this)}unpackTensor(e){const t=new V7e(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new C7e(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const r=[$g(e.shape),...Lg(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[$g(t),...Lg(t)],a=new Gte(i,r),o=!0,l=[r],c=this.runWebGLProgram(a,[s],e.dtype,l,o);return{dataId:c.dataId,shape:t,dtype:c.dtype}}decode(e,t){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:a}=r;if(t!=null){const p=Ue(i),x=t[0]*t[1]*4;ue(p<=x,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=mw(i);let l;s?l=new d9e(o):l=new h9e(o);const c=!0,u=[t??dw(o)],d=this.runWebGLProgram(l,[{shape:o,dtype:a,dataId:e}],a,u,c,t);return{dtype:a,shape:i,dataId:d.dataId}}runWebGLProgram(e,t,r,s,i=!1,a){const o=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===P1.DENSE){const S=a??dw(e.outputShape);l.texShape=S.map(T=>T*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Ue(o.shape)===0)return l.values=Ji(o.dtype,0),o;const c=[],u=t.map(S=>{if(S.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let T=this.texData.get(S.dataId);if(T.texture==null){if(!e.packedInputs&&Ue(S.shape)<=Me().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:S.shape,texData:null,isUniform:!0,uniformValues:T.values};e.packedInputs&&(T.isPacked=!0,T.shape=S.shape)}if(this.uploadToGPU(S.dataId),!!T.isPacked!=!!e.packedInputs)S=T.isPacked?this.unpackTensor(S):this.packTensor(S),c.push(S),T=this.texData.get(S.dataId);else if(T.isPacked&&!nS(T.shape,S.shape)){const C=S,I=S.shape;S.shape=T.shape,S=this.packedReshape(S,I),c.push(S),T=this.texData.get(S.dataId),C.shape=I}return{shape:S.shape,texData:T,isUniform:!1}});this.uploadToGPU(o.dataId);const d={shape:o.shape,texData:l,isUniform:!1},p=u9e(e,u,d),x=this.getAndSaveBinary(p,()=>l9e(this.gpgpu,e,u,d)),y=this.activeTimers!=null;let v;y&&(v=this.startTimer()),Me().get("ENGINE_COMPILE_ONLY")||c9e(this.gpgpu,x,u,d,s),c.forEach(S=>this.disposeIntermediateTensorInfo(S)),y&&(v=this.endTimer(v),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(v)}));const b=Me().getNumber("WEBGL_FLUSH_THRESHOLD");if(b>0){const S=Ya();S-this.lastGlFlushTime>b&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=S)}if(!Me().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const S=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),S}return o}compileAndRun(e,t,r,s,i=!1){return r=r||t[0].dtype,this.runWebGLProgram(e,t,r,s,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Me().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=De(()=>{if(!Me().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Me().getBool("DEBUG");Me().set("DEBUG",!1);const t=this.abs(mr(1e-8)).dataSync()[0];if(Me().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?G7e:H7e}uploadToGPU(e){const t=this.texData.get(e),{shape:r,dtype:s,values:i,texture:a,usage:o,isPacked:l}=t;if(a!=null)return;const c=this.activeTimers!=null;let u;c&&(u=Ya());let d=t.texShape;if(d==null&&(d=gBe(r,l),t.texShape=d),i!=null){const p=mw(r);let x,y=d[1],v=d[0];const b=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!b)&&([y,v]=cx(d[0],d[1])),l?x=new g9e(p,b):x=new t9(p,b);const S=b?[v,y]:d,T=this.makeTensorInfo(S,s),C=this.texData.get(T.dataId);b?C.usage=Qo.PIXELS:C.usage=Qo.UPLOAD,C.texShape=S,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(T.dataId),y,v,i);const I=[[v,y]],q=this.runWebGLProgram(x,[T],s,I,!0),U=this.texData.get(q.dataId);t.texShape=U.texShape,t.isPacked=U.isPacked,t.usage=U.usage,Me().get("ENGINE_COMPILE_ONLY")?this.disposeData(q.dataId):(t.texture=U.texture,t.values=null,this.texData.delete(q.dataId)),this.disposeIntermediateTensorInfo(T),c&&(this.uploadWaitMs+=Ya()-u)}else{const p=this.acquireTexture(d,o,s,l);t.texture=p}}convertAndCacheOnCPU(e,t){const r=this.texData.get(e),{dtype:s}=r;return t!=null&&(r.values=Y7e(t,s)),r.values}acquireTexture(e,t,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,s)}computeBytes(e,t){return e[0]*e[1]*DE(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(t),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await RZ(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(kte(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:l}=Lte(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=a,e.outShapeStridesLocation=o,e.outTexShapeLocation=l}}createTensorFromGPUData(e,t,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:a,channels:o}=e,l=zc().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(s,t,r,i,a,o);return zc().makeTensorFromDataId(c,t,r,l)}}DC.nextDataId=0;function Y7e(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<t.length;++r)t[r]=Math.round(n[r]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */AY()&&RY("webgl",()=>new DC,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q6=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Em{constructor(e,t,r){this.variableNames=["A","B"],this.outputShape=cn(t,r),this.enableShapeUniforms=aa(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bm=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class px{constructor(e,t,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=cn(t,r);const i=this.outputShape.length;this.enableShapeUniforms=aa(i);let a="";if(s)if(i===0||Ue(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${Sr(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Aa("coords",i);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function So(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Z7e={kernelName:Ub,backendName:"webgl",kernelFunc:So};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uf(n){const{inputs:e,backend:t}=n,{real:r,imag:s}=e,i=t.makeTensorInfo(r.shape,"complex64"),a=t.texData.get(i.dataId),o=So({inputs:{x:r},backend:t}),l=So({inputs:{x:s},backend:t});return a.complexTensorInfos={real:o,imag:l},i}const Q7e={kernelName:LD,backendName:"webgl",kernelFunc:Uf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hte="return (a < 0.) ? b * a : a;",Wte=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function J7e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{alpha:i}=r,a=t.makeTensorInfo([],"float32",Pf(i,"float32")),o=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new px(Wte,s.shape,a.shape):new Em(Hte,s.shape,a.shape),l=t.runWebGLProgram(o,[s,a],"float32");return t.disposeIntermediateTensorInfo(a),l}const eze={kernelName:CT,backendName:"webgl",kernelFunc:J7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qte="return (a < 0.) ? b * a : a;",Kte=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function tze(n){const{inputs:e,backend:t}=n,{x:r,alpha:s}=e,i=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new px(Kte,r.shape,s.shape):new Em(qte,r.shape,s.shape);return t.runWebGLProgram(i,[r,s],"float32")}const nze={kernelName:HT,backendName:"webgl",kernelFunc:tze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mx="if (isnan(x)) return x;";function er({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:r}){return({inputs:s,backend:i})=>{const{x:a}=s,o=i,l=r||a.dtype;if(o.shouldExecuteOnCPU([a])&&t!=null){const d=o.texData.get(a.dataId),p=t(d.values,l);return o.makeTensorInfo(a.shape,l,p)}const c=Me().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Wd(a.shape,e):u=new tu(a.shape,n),o.runWebGLProgram(u,[a],l)}}function zi({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:a,backend:o})=>{const{a:l,b:c}=a,u=o;if(r&&l.dtype==="complex64"){const y=u.texData.get(l.dataId),v=u.texData.get(c.dataId),[b,S]=[[y.complexTensorInfos.real,v.complexTensorInfos.real],[y.complexTensorInfos.imag,v.complexTensorInfos.imag]].map(C=>{const[I,$]=C,q={dataId:I.dataId,dtype:I.dtype,shape:l.shape},U={dataId:$.dataId,dtype:$.dtype,shape:c.shape},F=new Em(n,l.shape,c.shape);return u.runWebGLProgram(F,[q,U],wo(I.dtype,$.dtype))}),T=Uf({inputs:{real:b,imag:S},backend:u});return u.disposeIntermediateTensorInfo(b),u.disposeIntermediateTensorInfo(S),T}const d=i||wo(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&s!=null){const y=u.texData.get(l.dataId).values,v=u.texData.get(c.dataId).values,b=l.dtype==="string"?Dh(y):y,S=l.dtype==="string"?Dh(v):v,[T,C]=s(l.shape,c.shape,b,S,d),I=u.makeTensorInfo(C,d),$=u.texData.get(I.dataId);return $.values=T,I}const p=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let x;return p?x=new px(e,l.shape,c.shape,t):x=new Em(n,l.shape,c.shape),u.runWebGLProgram(x,[l,c],d)}}function O1(n,e=!1){if(n==="linear")return e?M7e:D7e;if(n==="relu")return e?B7e:L7e;if(n==="elu")return e?F7e:$7e;if(n==="relu6")return e?z7e:P7e;if(n==="prelu")return e?Kte:qte;if(n==="leakyrelu")return e?Wte:Hte;if(n==="sigmoid")return e?j7e:O7e;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xte{constructor(e,t,r,s=!1,i=!1,a=!1,o=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=aa(this.outputShape.length);const u=s?e[1]:e[2],d=Math.ceil(u/2),p=s?"i * 2, rc.y":"rc.y, i * 2",x=i?"rc.z, i * 2":"i * 2, rc.z",y=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let b="",S="";o&&(l?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:c?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:b=`vec4 activation(vec4 x) {
          ${o}
        }`,S="result = activation(result);");const T=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let C="rc.x",I="rc.x";e[0]<t[0]?C=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(I=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${b}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${C};
        int batchB = ${I};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${x});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${y[0]} * ${v[0]});
          result += (${y[1]} * ${v[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${T}

        ${S}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a9={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class o9{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=cn(t,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l9="return a * b;";function J6(n){const{inputs:e,backend:t}=n,{a:r,b:s}=e,i=wo(r.dtype,s.dtype);if(r.dtype==="complex64"){const o=t.texData.get(r.dataId),l=t.texData.get(s.dataId),c=new o9(a9.REAL,r.shape,s.shape),u=new o9(a9.IMAG,r.shape,s.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],p=t.runWebGLProgram(c,d,"float32"),x=t.runWebGLProgram(u,d,"float32"),y=Uf({inputs:{real:p,imag:x},backend:t});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(x),y}if(t.shouldExecuteOnCPU([r,s])){const o=t.texData.get(r.dataId),l=t.texData.get(s.dataId),[c,u]=t7e(r.shape,s.shape,o.values,l.values,i),d=t.makeTensorInfo(u,i),p=t.texData.get(d.dataId);return p.values=c,d}let a;return Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?a=new px(l9,r.shape,s.shape):a=new Em(l9,r.shape,s.shape),t.runWebGLProgram(a,[r,s],i)}const rze={kernelName:Qb,backendName:"webgl",kernelFunc:J6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sze(n,e,t){const r=[$g(n.shape),...Lg(n.shape)],s={dtype:n.dtype,shape:r,dataId:n.dataId},i=[$g(e),...Lg(e)],a=new Gte(i,r),o=!0,l=[r],c=t.runWebGLProgram(a,[s],n.dtype,l,o);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lt(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{shape:i}=r,a=t,o=Ue(s.shape),l=VX(i,o),c=Ue(l);ue(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const u=a.texData.get(s.dataId);return u.isPacked&&!nS(s.shape,l)&&!(u.texture!==null&&nS(u.shape,l))?sze(s,l,a):(a.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const ize={kernelName:qT,backendName:"webgl",kernelFunc:lt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c9{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:a}=e;this.outputShape=[s,a];const o=Math.floor(r/4)*4,l=r%4;let c="sumValue += dot(values, ones);";if(t!=null){const d=1/t;c=`sumValue += dot(values * ${Sg(d)?d.toPrecision(2):d}, ones);`}let u="";i%r>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aze{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:a}=e;this.outputShape=[s,a];let o="0.0",l="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",l="min"):t==="max"&&(o="-1.0 / 1e-20",l="max");let c=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");const u=Math.floor(r/4)*4,d=r%4;let p=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,x="vec4";t==="all"?(o="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,x="bvec4"):t==="any"&&(o="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,x="bvec4");let y="";i%r>0&&(y=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${x} values = ${x}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${x} values = ${x}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===2}) {
          ${x} values = ${x}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===3}) {
          ${x} values = ${x}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oze(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],r=gC(t);e.push({inSize:t,windowSize:r,outSize:Math.ceil(t/r)})}return e}function zm(n,e,t,r){const s=oze(n.shape);let i=n;for(let a=0;a<s.length;a++){const{inSize:o,windowSize:l,outSize:c}=s[a];let u,d;t==="mean"?u=a===0?new c9({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c},o):new c9({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c}):u=new aze({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c},t),d=i,i=r.runWebGLProgram(u,[i],e),d.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lze{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[t[a]];this.outputShape=r,this.rank=r.length;const s=Sr(this.rank),i=cze(t);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function cze(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<n.length;s++)r[n[s]]=t[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uze{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let u=0;u<r.length;u++)r[u]=e[t[u]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=Sr(this.rank),i=Ute("rc",this.rank),a=new Array(this.rank);for(let u=0;u<t.length;u++)a[t[u]]=i[u];const o=`vec2(${a.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $C(n,e,t){const r=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uze(n.shape,e):new lze(n.shape,e);return t.runWebGLProgram(r,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hze(n,e,t,r){const s=e,i=n.shape.length,a=Sn(s,n.shape);let o=a;const l=os(o,i),c=l!=null;let u=n;c&&(u=$C(n,l,r),o=Cs(o.length,i)),Bi("sum",o,i);const[d,p]=xi(u.shape,o);let x=d;t&&(x=Us(d,a));const y=Ue(p),b=Ue(n.shape)/y,S=lt({inputs:{x:u},attrs:{shape:[b,y]},backend:r}),T=p$(n.dtype),C=zm(S,T,"sum",r),I=lt({inputs:{x:C},attrs:{shape:x},backend:r});return r.disposeIntermediateTensorInfo(S),r.disposeIntermediateTensorInfo(C),c&&r.disposeIntermediateTensorInfo(u),I}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LC(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;return hze(s,i,a,t)}const dze={kernelName:JT,backendName:"webgl",kernelFunc:LC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ra(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{perm:i}=r,a=t,o=s.shape.length,l=new Array(o);for(let u=0;u<l.length;u++)l[u]=s.shape[i[u]];let c;if(a.shouldExecuteOnCPU([s])){const d=a.texData.get(s.dataId).values,p=Z6(d,s.shape,s.dtype,i,l);c=a.makeTensorInfo(l,s.dtype);const x=a.texData.get(c.dataId);x.values=p}else c=$C(s,i,a);return c}const fze={kernelName:ag,backendName:"webgl",kernelFunc:Ra};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yte=1e3;function rS({a:n,b:e,transposeA:t,transposeB:r,backend:s,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const c=n.shape.length,u=e.shape.length,d=t?n.shape[c-2]:n.shape[c-1],p=r?e.shape[u-1]:e.shape[u-2],x=t?n.shape[c-1]:n.shape[c-2],y=r?e.shape[u-2]:e.shape[u-1],v=n.shape.slice(0,-2),b=e.shape.slice(0,-2),S=Ue(v),T=Ue(b),I=cn(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([x,y]);ue(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${r} must match.`);const $=t?[S,d,x]:[S,x,d],q=r?[T,y,p]:[T,p,y],U=lt({inputs:{x:n},backend:s,attrs:{shape:$}}),F=lt({inputs:{x:e},backend:s,attrs:{shape:q}}),G=[U,F],V=Math.max(S,T),O=t?U.shape[1]:U.shape[2],K=i!=null,P=a!=null,N=l==="leakyrelu",M=l!=null?O1(l,!0):null,B=K||P||N||M!=null;let Y;if((x===1||y===1)&&O>Yte&&B===!1){let ne=U,Q=F;t&&(ne=Ra({inputs:{x:U},backend:s,attrs:{perm:[0,2,1]}}),G.push(ne)),r&&(Q=Ra({inputs:{x:F},backend:s,attrs:{perm:[0,2,1]}}),G.push(Q));const z=y!==1,D=y===1;let X=ne;z&&(X=lt({inputs:{x:ne},backend:s,attrs:{shape:[V,O,1]}}),G.push(X));const re=y===1?2:1;let W=Q;D&&(W=lt({inputs:{x:Q},backend:s,attrs:{shape:[V,1,O]}}),G.push(W));const ae=J6({inputs:{a:X,b:W},backend:s});Y=LC({inputs:{x:ae},backend:s,attrs:{axis:re,keepDims:!0}}),G.push(ae)}else{const ne=wo(n.dtype,e.dtype),Q=new Xte($,q,[V,x,y],t,r,K,M,P,N),z=[U,F];if(i!=null&&z.push(i),P&&z.push(a),N){const D=s.makeTensorInfo([],"float32",Pf(o,"float32"));z.push(D),G.push(D)}Y=s.runWebGLProgram(Q,z,ne)}const Z=lt({inputs:{x:Y},backend:s,attrs:{shape:I}});G.push(Y);for(const ne of G)s.disposeIntermediateTensorInfo(ne);return Z}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pze(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;return rS({a:s,b:i,transposeA:l,transposeB:c,backend:t,bias:a,preluActivationWeights:o,leakyreluAlpha:d,activation:u})}const mze={kernelName:$E,backendName:"webgl",kernelFunc:pze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9="return abs(x);";function gze(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=t.texData.get(r.dataId),a=jte(i.values);return t.makeTensorInfo(r.shape,r.dtype,a)}let s;return Me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Wd(r.shape,u9):s=new tu(r.shape,u9),t.runWebGLProgram(s,[r],r.dtype)}const xze={kernelName:aT,backendName:"webgl",kernelFunc:gze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yze=Bl+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,bze=er({opSnippet:yze}),vze={kernelName:Eb,backendName:"webgl",kernelFunc:bze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ze=Bl+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,wze=er({opSnippet:_ze}),Eze={kernelName:Sb,backendName:"webgl",kernelFunc:wze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h9="return a + b;",Sze=zi({opSnippet:h9,packedOpSnippet:h9,supportsComplex:!0,cpuKernelImpl:L9e}),Tze={kernelName:nx,backendName:"webgl",kernelFunc:Sze};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cze{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aze{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2(n){const{inputs:e,backend:t}=n,r=e;if(r.length===1)return So({inputs:{x:r[0]},backend:t});if(r.length>Me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),c=r2({inputs:r.slice(0,l),backend:t}),u=r2({inputs:r.slice(l),backend:t});return r2({inputs:[c,u],backend:t})}const s=r.map(l=>l.dtype).reduce((l,c)=>wo(l,c)),i=r.map(l=>l.shape),o=Me().getBool("WEBGL_PACK")?new Aze(r[0].shape,i):new Cze(r[0].shape,i);return t.runWebGLProgram(o,r,s)}const Nze={kernelName:AD,backendName:"webgl",kernelFunc:r2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kze(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=s.shape.length,l=Sn(i,s.shape);let c=l;const u=os(c,o);let d=s;u!=null&&(d=Ra({inputs:{x:s},backend:t,attrs:{perm:u}}),c=Cs(c.length,o)),Bi("all",c,o);const[p,x]=xi(d.shape,c),y=Ue(x),v=lt({inputs:{x:d},backend:t,attrs:{shape:[-1,y]}}),b=zm(v,v.dtype,"all",t);let S;if(a){const T=Us(p,l);S=lt({inputs:{x:b},backend:t,attrs:{shape:T}})}else S=lt({inputs:{x:b},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(b),u!=null&&t.disposeIntermediateTensorInfo(d),S}const Ize={kernelName:ND,backendName:"webgl",kernelFunc:kze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rze(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=s.shape.length,l=Sn(i,s.shape);let c=l;const u=os(c,o);let d=s;u!=null&&(d=Ra({inputs:{x:s},backend:t,attrs:{perm:u}}),c=Cs(c.length,o)),Bi("any",c,o);const[p,x]=xi(d.shape,c),y=Ue(x),v=lt({inputs:{x:d},backend:t,attrs:{shape:[-1,y]}}),b=zm(v,v.dtype,"any",t);let S;if(a){const T=Us(p,l);S=lt({inputs:{x:b},backend:t,attrs:{shape:T}})}else S=lt({inputs:{x:b},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(b),u!=null&&t.disposeIntermediateTensorInfo(d),S}const Dze={kernelName:kD,backendName:"webgl",kernelFunc:Rze};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ze{constructor(e,t,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:a}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];const o=t==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lze{constructor(e,t,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ue(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),s||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,c=Sr(l),u=Aa("coords",l);let d,p;if(a===1){p=l+1;const F=Sr(p);d=`
        ${F} sourceLocR = ${F}(${u.join()}, 0);
        ++${u[l-1]};
        ${F} sourceLocG = ${F}(${u.join()}, 0);
        ++${u[l-2]};
        ${F} sourceLocA = ${F}(${u.join()}, 0);
        --${u[l-1]};
        ${F} sourceLocB = ${F}(${u.join()}, 0);
        --${u[l-2]};`}else p=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const x=["x","y","z","w","u","v"].slice(0,p),y="."+x[p-1],v=x.map(F=>"int "+F),b=Aa("sourceLocR",p-1).concat("inIdx.r"),S=Aa("sourceLocG",p-1).concat("inIdx.g"),T=Aa("sourceLocB",p-1).concat("inIdx.b"),C=Aa("sourceLocA",p-1).concat("inIdx.a"),I=r==="max"?"greaterThan":"lessThan",$=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${S.join()}),
                             getBestIndicesAChannel(${T.join()}),
                             getBestIndicesAChannel(${C.join()})));`,q=`vec4(
            getAChannel(${b.join()}),
            hasNextCol ? getAChannel(${S.join()}) : 0.,
            hasNextRow ? getAChannel(${T.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${C.join()}) : 0.)`,U=s?"":`
      float getBestIndicesAChannel(${v.join()}) {
        return getChannel(getBestIndicesA(${x.join()}),
                                          vec2(${x.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${v.join()}) {
        return getChannel(getA(${x.join()}),
                               vec2(${x.slice(-2).join()}));
      }
      ${U}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${o[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${y}, sourceLocG${y},
          sourceLocB${y}, sourceLocA${y}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${q};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${$}
          vec4 candidate = ${q};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${I}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(n,e,t,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const a=gC(i),o={windowSize:a,inSize:i,batchSize:s,outSize:Math.ceil(i/a)},l=new $ze(o,t,r==null),c=[e];r!=null&&c.push(r);const u=n.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=Zte(n,e,t,u);return n.disposeIntermediateTensorInfo(u),d}function Qte(n,e,t,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],a=gC(i),o=new Lze(s,a,t,r==null),l=r==null?[e]:[e,r],c=n.runWebGLProgram(o,l,"int32");if(c.shape.length===e.shape.length){const u=Qte(n,e,t,c);return n.disposeIntermediateTensorInfo(c),u}return c}function Jte(n,e,t,r){const s=[t];if(Bi("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!Me().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],a=n.texData.get(e.dataId),o=a!==null&&a.isPacked;let l=e;o&&(l=n.unpackTensor(e),i.push(l));const[c,u]=xi(l.shape,s),d=Ue(u),p=lt({inputs:{x:l},backend:n,attrs:{shape:[-1,d]}});i.push(p);const x=Zte(n,p,r);i.push(x);const y=lt({inputs:{x},backend:n,attrs:{shape:c}});return i.forEach(v=>n.disposeIntermediateTensorInfo(v)),y}return Qte(n,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pze(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;let a=Sn(i,s.shape);const o=os(a,s.shape.length);let l=s;const c=[];o!=null&&(l=Ra({inputs:{x:s},backend:t,attrs:{perm:o}}),c.push(l),a=Cs(a.length,l.shape.length)),Bi("argMax",[a[0]],l.shape.length);const u=Jte(t,l,a[0],"max");return c.forEach(d=>t.disposeIntermediateTensorInfo(d)),u}const Oze={kernelName:oT,backendName:"webgl",kernelFunc:Pze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mze(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;let a=Sn(i,s.shape);const o=os(a,s.shape.length);let l=s;const c=[];o!=null&&(l=Ra({inputs:{x:s},backend:t,attrs:{perm:o}}),c.push(l),a=Cs(a.length,l.shape.length)),Bi("argMin",[a[0]],l.shape.length);const u=Jte(t,l,a[0],"min");return c.forEach(d=>t.disposeIntermediateTensorInfo(d)),u}const Fze={kernelName:lT,backendName:"webgl",kernelFunc:Mze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bze=Bl+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,zze=er({opSnippet:Bze}),jze={kernelName:Tb,backendName:"webgl",kernelFunc:zze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vze=Bl+"return log(x + sqrt(x * x + 1.0));",Uze=er({opSnippet:Vze}),Gze={kernelName:Cb,backendName:"webgl",kernelFunc:Uze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hze=Bl+`
  return atan(x);
`,Wze=er({opSnippet:Hze}),qze={kernelName:Ab,backendName:"webgl",kernelFunc:Wze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kze=Q6+`
  return atan(a, b);
`,Xze=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Bm+`
  return result;
`,Yze=zi({opSnippet:Kze,packedOpSnippet:Xze}),Zze={kernelName:kb,backendName:"webgl",kernelFunc:Yze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qze=Bl+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Jze=er({opSnippet:Qze}),eje={kernelName:Nb,backendName:"webgl",kernelFunc:Jze};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M1{constructor(e,t,r,s=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,x=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const v=t==="avg",b=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,S=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let T="0.0";if(v||(T="-1.0 / 1e-20"),r){this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${x}, ${y});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?b:S:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let I=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(I="avgValue / max(count, 1.0)");const $=Math.floor(a/4)*4,q=a%4,U=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${x}, ${y});
      const float initializationValue = ${T};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${T});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${$}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${U}
          }

          int xC = xCCorner + ${$};
          if (${q===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${U}
          } else if (${q===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${U}
          } else if (${q===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${U}
          }
        }
        setOutput(${I});
      }
    `}}class eL{constructor(e,t,r,s=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,p=e.dilationWidth,x=e.effectiveFilterDepth,y=e.effectiveFilterHeight,v=e.effectiveFilterWidth,b=e.padInfo.front,S=e.padInfo.top,T=e.padInfo.left;this.outputShape=e.outShape;const C=t==="avg";let I="0.0";if(C||(I="-1.0 / 1e-20"),r){this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${c});
        const ivec3 pads = ivec3(${b}, ${S}, ${T});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${x};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${y};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${v};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${y} * ${v} +
                      wR * ${v} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let q=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(q="avgValue / max(count, 1.0)");const U=Math.floor(a/4)*4,F=a%4,G=`
      if (${C}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${c});
      const ivec3 pads = ivec3(${b}, ${S}, ${T});
      const float initializationValue = ${I};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${I});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${x};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${y};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${U}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${G}
            }

            int xC = xCCorner + ${U};
            if (${F===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${G}
            } else if (${F===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${G}
            } else if (${F===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${G}
            }
          }
        }
        setOutput(${q});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tje(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;Ov(s,"avgPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=r,c=1;ue(sa(a,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const u=Ml(s.shape,i,a,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&gr(u.inShape,u.outShape))return So({inputs:{x:s},backend:t});const d=new M1(u,"avg",!1);return t.runWebGLProgram(d,[s],"float32")}const nje={kernelName:cT,backendName:"webgl",kernelFunc:tje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rje(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],d=Fh(s.shape,i,a,u,o,l,c),p=new eL(d,"avg",!1);return t.runWebGLProgram(p,[s],"float32")}const sje={kernelName:uT,backendName:"webgl",kernelFunc:rje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ije{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,p=1/(t*r);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class aje{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,x=e.effectiveFilterWidth,y=d-1-e.padInfo.front,v=p-1-e.padInfo.top,b=x-1-e.padInfo.left,S=1/(t*r*s);this.userCode=`
      const ivec3 pads = ivec3(${y}, ${v}, ${b});
      const float avgMultiplier = float(${S});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${x};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oje(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,a=i,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],p=Fh(a.shape,o,l,d,c,u),x=new aje(p);return t.runWebGLProgram(x,[s],a.dtype)}const lje={kernelName:RD,backendName:"webgl",kernelFunc:oje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cje(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,a=i;Ov([s,i],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=r,u=Ml(a.shape,o,l,1,c),d=new ije(u);return t.runWebGLProgram(d,[s],a.dtype)}const uje={kernelName:ID,backendName:"webgl",kernelFunc:cje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hje(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i}=e,{transposeA:a,transposeB:o}=r;return rS({a:s,b:i,transposeA:a,transposeB:o,backend:t})}const dje={kernelName:hT,backendName:"webgl",kernelFunc:hje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fje{constructor(e,t,r,s,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],cn(e,t),cn(e,r);let o="0.0";s!=null&&(cn(e,s),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";i!=null&&(cn(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pje{constructor(e,t,r,s,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],cn(e,t),cn(e,r);let o="vec4(0.0)";s!=null&&(cn(e,s),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(cn(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mje=({inputs:n,backend:e,attrs:t})=>{const{x:r,mean:s,variance:i,offset:a,scale:o}=n;ue(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ue(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ue(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const c=[r,s,i];let u=null;a!=null&&(u=a.shape,c.push(a));let d=null;o!=null&&(d=o.shape,c.push(o));const p=Me().getBool("WEBGL_PACK_NORMALIZATION")?new pje(r.shape,s.shape,i.shape,u,d,l):new fje(r.shape,s.shape,i.shape,u,d,l);return e.runWebGLProgram(p,c,c[0].dtype)},gje={kernelName:ET,backendName:"webgl",kernelFunc:mje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xje{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Sr(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=yje(this.rank);let s;const i=e.map((a,o)=>`sourceLoc.${F3[o]} = start[${o}] + coords.${F3[o]};`);s=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const F3=["x","y","z","w","u","v"];function yje(n){if(n===1)return"sourceLoc";if(n<=6)return F3.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bje{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Sr(this.rank),r=Aa("coords",this.rank),s=Aa("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,a=`getChannel(getSource(${s.join()}), ${i})`,o=`
      result.x = ${a};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${a};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${a};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${a};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vje(n,e,t,r){const s=r.texData.get(n.dataId),i=r.makeTensorInfo(t,n.dtype),a=r.texData.get(i.dataId);Object.assign(a,s),a.refCount=1,a.shape=t,a.dtype=n.dtype;let o=X$(e,kt(n.shape));s.slice&&(o+=s.slice.flatOffset),a.slice={flatOffset:o,origDataId:s.slice&&s.slice.origDataId||n.dataId};const l=r.dataRefCount.get(a.slice.origDataId)||1;return r.dataRefCount.set(a.slice.origDataId,l+1),i}function gx(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,size:a}=r,[o,l]=mC(s,i,a);if(W$(s,o,l),Ue(l)===0)return t.makeTensorInfo(l,s.dtype,[]);if(t.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=t.texData.get(s.dataId),p=d7e(d.values,o,l,s.shape,s.dtype);return t.makeTensorInfo(l,s.dtype,p)}const{isPacked:c}=t.texData.get(s.dataId),u=K$(s.shape,o,l);if(c||!u){const d=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bje(l):new xje(l),p=[o];return t.runWebGLProgram(d,[s],s.dtype,p)}return t.uploadToGPU(s.dataId),vje(s,o,l,t)}const _je={kernelName:QT,backendName:"webgl",kernelFunc:gx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wje=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,crops:a}=r;ue(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=i.reduce((T,C)=>T*C),l=Ev(s.shape,i,o),c=Sv(l.length,i.length),u=Tv(s.shape,i,o),d=e6(a,i.length),p=t6(u,a,i.length),x=[],y=lt({inputs:{x:s},backend:t,attrs:{shape:l}}),v=Ra({inputs:{x:y},backend:t,attrs:{perm:c}}),b=lt({inputs:{x:v},backend:t,attrs:{shape:u}}),S=gx({inputs:{x:b},backend:t,attrs:{begin:d,size:p}});return x.push(y),x.push(v),x.push(b),x.forEach(T=>t.disposeIntermediateTensorInfo(T)),S},Eje={kernelName:dT,backendName:"webgl",kernelFunc:wje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sje(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:a}=r,o=t.readSync(s.dataId),l=t.readSync(i.dataId),c=zte(o,l,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,c)}const Tje={kernelName:DD,backendName:"webgl",kernelFunc:Sje};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cje=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Aje=`
  return float(int(a.r) & int(b.r));
`;function Nje(n){const{inputs:e,backend:t}=n,{a:r,b:s}=e,i=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS"),a=Me().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([r,s])||a===1){const l=t.texData.get(r.dataId).values,c=t.texData.get(s.dataId).values,[u,d]=O9e(r.shape,s.shape,l,c,r.dtype),p=t.makeTensorInfo(d,r.dtype),x=t.texData.get(p.dataId);return x.values=u,p}let o;return i?o=new px(Cje,r.shape,s.shape,!1):o=new Em(Aje,r.shape,s.shape),t.runWebGLProgram(o,[r,s],r.dtype)}const kje={kernelName:$D,backendName:"webgl",kernelFunc:Nje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ije(n){const{inputs:e,backend:t}=n,{s0:r,s1:s}=e,i=t.readSync(r.dataId),a=t.readSync(s.dataId),o=cn(Array.from(i),Array.from(a));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const Rje={kernelName:KX,backendName:"webgl",kernelFunc:Ije};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dje="return float(a != b);",ene=zi({opSnippet:Dje,cpuKernelImpl:r7e,dtype:"bool"}),$je={kernelName:zT,backendName:"webgl",kernelFunc:ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fv(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return So({inputs:{x:s.complexTensorInfos.real},backend:t})}const Lje={kernelName:s$,backendName:"webgl",kernelFunc:Fv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pje="return float(int(x));";function Oje(n,e){const t=new tu(n.shape,Pje),r=e.runWebGLProgram(t,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return So({inputs:{x:s},backend:t});const a=fi(s.shape),o=B3({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),l=Uf({inputs:{real:o,imag:a},backend:t});return a.dispose(),t.disposeIntermediateTensorInfo(o),l}if(s.dtype==="complex64"){const a=Fv({inputs:{input:s},backend:t}),o=B3({inputs:{x:a},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(a),o}if(!UX(s.dtype,i)){const a=So({inputs:{x:s},backend:t});return{dataId:a.dataId,shape:a.shape,dtype:i}}if(t.shouldExecuteOnCPU([s])){const a=t.texData.get(s.dataId).values,[o,l,c]=M9e(a,s.shape,s.dtype,i);return t.makeTensorInfo(o,l,c)}if(i==="int32")return Oje(s,t);if(i==="bool"){const a=t.makeTensorInfo([],"bool",Ji("bool",1)),l=ene({inputs:{a:s,b:a},backend:t});return t.disposeIntermediateTensorInfo(a),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const Mje={kernelName:Ib,backendName:"webgl",kernelFunc:B3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d9="return ceil(x);",Fje=er({opSnippet:d9,packedOpSnippet:d9,cpuKernelImpl:F9e}),Bje={kernelName:Rb,backendName:"webgl",kernelFunc:Fje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zje{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jje{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vje(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{clipValueMin:i,clipValueMax:a}=r;let o;Me().getBool("WEBGL_PACK_CLIP")?o=new jje(s.shape):o=new zje(s.shape);const l=[[i],[a]];return t.runWebGLProgram(o,[s],s.dtype,l)}const Uje={kernelName:Db,backendName:"webgl",kernelFunc:Vje};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gje{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function Hje(n){const{inputs:e,backend:t}=n,{x:r}=e,s=t.texData.get(r.dataId),i=new Gje(r.shape),a=[f9(r,s.complexTensorInfos.real),f9(r,s.complexTensorInfos.imag)];return t.runWebGLProgram(i,a,a[0].dtype)}const Wje={kernelName:fT,backendName:"webgl",kernelFunc:Hje};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qje{constructor(e){this.outputShape=[],this.outputShape=du(e,1),this.variableNames=e.map((a,o)=>`T${o}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let a=1;a<t.length;a++)t[a]=t[a-1]+e[a][1];const r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<t.length;a++){const o=t[a-1];r.push(`else if (yC < ${t[a]}) setOutput(getT${a}(yR, yC-${o}));`)}const s=t.length,i=t[t.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kje{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=du(e,t);const r=this.outputShape,s=r.length,i=Sr(s),a=Aa("coords",s),o=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((v,b)=>`T${b}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let v=1;v<l.length;v++)l[v]=l[v-1]+e[v][t];const c=o[t],u=o.slice(-2),d=o.join();let p=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let v=1;v<l.length;v++){const b=l[v-1];p+=`
        if (${c} < ${l[v]}  && ${c} >= ${l[v-1]}) {
          return getChannel(
            getT${v}(${yw(o,c,b)}),
            vec2(${yw(u,c,b)}));
        }`}const x=l.length,y=l[l.length-1];p+=`
        return getChannel(
          getT${x}(${yw(o,c,y)}),
          vec2(${yw(u,c,y)}));`,this.userCode=`
      float getValue(${o.map(v=>"int "+v)}) {
        ${p}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[s-1]} = ${a[s-1]} + 1;
        if (${a[s-1]} < ${r[s-1]}) {
          result.g = getValue(${a});
        }

        ${a[s-2]} = ${a[s-2]} + 1;
        if (${a[s-2]} < ${r[s-2]}) {
          result.a = getValue(${a});
        }

        ${a[s-1]} = ${a[s-1]} - 1;
        if (${a[s-2]} < ${r[s-2]} &&
            ${a[s-1]} < ${r[s-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function yw(n,e,t){const r=n.indexOf(e);return n.map((i,a)=>a===r?`${i} - ${t}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PC(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return So({inputs:{x:s.complexTensorInfos.imag},backend:t})}const Xje={kernelName:YD,backendName:"webgl",kernelFunc:PC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ly(n,e,t){const r=n[0].dtype;if(r==="complex64"){const x=n.map(T=>Fv({inputs:{input:T},backend:t})),y=n.map(T=>PC({inputs:{input:T},backend:t})),v=Ly(x,e,t),b=Ly(y,e,t),S=Uf({inputs:{real:v,imag:b},backend:t});return x.forEach(T=>t.disposeIntermediateTensorInfo(T)),y.forEach(T=>t.disposeIntermediateTensorInfo(T)),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(b),S}let s=t.shouldExecuteOnCPU(n);if(r==="string"&&(s=!0),s){const x=n.map(I=>{const q=[-1,Ue(I.shape.slice(e))];return lt({inputs:{x:I},backend:t,attrs:{shape:q}})}),y=x.map(I=>({vals:t.readSync(I.dataId),shape:I.shape})),v=du(x.map(I=>I.shape),1),b=x[0].shape[0]===1,S=B9e(y,v,r,b),T=du(n.map(I=>I.shape),e),C=t.makeTensorInfo(T,r,S);return x.forEach(I=>t.disposeIntermediateTensorInfo(I)),C}const i=n.filter(x=>Ue(x.shape)>0),a=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const x=a?new tu(n[0].shape,Dd):new Wd(n[0].shape,Dd);return t.runWebGLProgram(x,n,r)}const o=Me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>o){const x=[];for(let v=0;v<i.length;v+=o){const b=i.slice(v,v+o);x.push(Ly(b,e,t))}const y=Ly(x,e,t);for(const v of x)t.disposeIntermediateTensorInfo(v);return y}if(a){const x=new Kje(i.map(y=>y.shape),e);return t.runWebGLProgram(x,i,r)}const{tensors2D:l,outShape:c}=Yje(i,e,t),u=new qje(l.map(x=>x.shape)),d=t.runWebGLProgram(u,l,r);l.forEach(x=>t.disposeIntermediateTensorInfo(x));const p=lt({inputs:{x:d},attrs:{shape:c},backend:t});return t.disposeIntermediateTensorInfo(d),p}function Yje(n,e,t){const r=du(n.map(i=>i.shape),e);return{tensors2D:n.map(i=>lt({inputs:{x:i},attrs:{shape:[-1,Ue(i.shape.slice(e))]},backend:t})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tne(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r,i=Sn(s,e[0].shape)[0],a=e.map(c=>c.shape);Z$(a,i);const o=du(e.map(c=>c.shape),i);if(Ue(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(c=>Ue(c.shape)>0);return l.length===1?So({inputs:{x:l[0]},backend:t}):Ly(l,i,t)}const Zje={kernelName:pT,backendName:"webgl",kernelFunc:tne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nne{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const a=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,x=e.filterWidth,y=Math.floor(e.inChannels/4)*4,v=e.inChannels%4,b=e.dataFormat==="channelsLast",S=b?1:2,T=b?2:3,C=b?3:1;let I="",$="";r&&(s?I=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?I=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:I=`
          float activation(float x) {
            ${r}
          }
        `,$="result = activation(result);");const q=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${I}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${C}];

        ivec2 xRCCorner =
            ivec2(coords[${S}], coords[${T}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${x}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${y}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${b}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${v===1}) {

              if (${b}) {
                dotProd +=
                    getX(batch, xR, xC, ${y}) *
                    getW(wR, wC, ${y}, d2);
              } else {
                dotProd +=
                    getX(batch, ${y}, xR, xC) *
                    getW(wR, wC, ${y}, d2);
              }

            } else if (${v===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2)
              );

              if (${b}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${v===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2),
                getW(wR, wC, ${y} + 2, d2)
              );

              if (${b}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1),
                  getX(batch, xR, xC, ${y} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC),
                  getX(batch, ${y} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${q}
        ${$}
        setOutput(result);
      }
    `}}class Qje{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,p=e.filterHeight,x=e.filterWidth,y=Math.floor(e.inChannels/4)*4,v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${a}, ${o});
      const ivec3 pads = ivec3(${t}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${x}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${y}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${v===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${y}) *
                  getW(wF, wR, wC, ${y}, d2);
              } else if (${v===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${v===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1),
                  getX(batch, xF, xR, xC, ${y} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2),
                  getW(wF, wR, wC, ${y} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rne{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=aa(this.outputShape.length);const a=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<u;b++)p+=`
           vec4 xTexelC${b*2};
           int xTexelC${b*2}Ready;
           vec4 xTexelC${b*2+1};
           int xTexelC${b*2+1}Ready;
           vec4 xC${b};`;p+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let b=0;b<u;b++)p+=`
           xTexelC${b*2} = vec4(0.0);
           xTexelC${b*2}Ready = 0;
           xTexelC${b*2+1} = vec4(0.0);
           xTexelC${b*2+1}Ready = 0;
           xC${b} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let b=0;b<(d+1)/2;b++){const S=b*2;if(p+=`
           xC = xCCorner + ${S*l};
           `,o===1){if(S<u&&(a%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }
               `,l===1&&S>0?p+=`
                 xC${S} = vec4(xTexelC${S-2}.zw, xTexelC${S}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${S} = vec4(previous.zw, xTexelC${S}.xy);
                   } else {
                     xC${S} = vec4(0.0, 0.0, xTexelC${S}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 xC${S} = xTexelC${S};
                 `,S+1<u)){const T=a%2===0?wD(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${T};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                     xTexelC${S+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${S+1}.zw = vec2(0.0);
                     }
                     xTexelC${S+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${S+1} = vec4(previous.zw, xTexelC${S+1}.xy);
                     } else {
                      xC${S+1} = vec4(0.0, 0.0, xTexelC${S+1}.xy);
                     }
                     `:p+=`
                     xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.xy);
                     `):T===1?p+=`
                     xC${S+1} = xTexelC${S};
                     `:p+=`
                     xCOffset = xC + ${T};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                       xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${S+1}.zw = vec2(0.0);
                       }
                       xTexelC${S+1}Ready = 1;
                     }

                     xC${S+1} = xTexelC${S+1};
                     `}}else S<u&&(a%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${S+1}Ready == 0) {
                   xTexelC${S+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${S+1}.zw = vec2(0.0);
                   }
                   xTexelC${S+1}Ready = 1;
                 }

                 xC${S} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
               `,S+1<u&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${S+1} = vec4(xTexelC${S+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                   xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S+1}.zw = vec2(0.);
                   }
                   xTexelC${S+1}Ready = 1;
                 }

                 xC${S} = vec4(
                   xTexelC${S}.xy, xTexelC${S+1}.xy);
               `,S+1<u&&(p+=`
                   xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
                 `)));S<u&&(p+=`
             wTexel = getW(r, ${S}, d1, d2);
             dotProd += xC${S}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${S}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,S+1<u&&(p+=`
               wTexel = getW(r, ${S+1}, d1, d2);
               dotProd += xC${S+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${S+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let x="",y="";r&&(s?x=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?x=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:x=`vec4 activation(vec4 x) {
           ${r}
         }`,y="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${x}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${v}
         ${y}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jje{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=aa(this.outputShape.length);const{dataFormat:r}=t,s=$a(),i=r==="channelsLast",a=i?1:2,o=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sS(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function sne({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:o=null}){const l=n.shape,c=r.texData.get(n.dataId),u=t.inChannels,d=l[0]*l[1]*l[2],p=t.outChannels,x=t.dataFormat==="channelsLast",y=!1,v=!1;let b;const S=[];if(i!=null){const I=sS(i.shape,x);I!=null&&(i=lt({inputs:{x:i},backend:r,attrs:{shape:I}}),S.push(i))}if(s!=null){const I=sS(s.shape,x);I!=null&&(s=lt({inputs:{x:s},backend:r,attrs:{shape:I}}),S.push(s))}if(!((d===1||p===1)&&u>Yte)&&c.isPacked&&x&&c.texture!=null&&l[2]%2!==0&&gr(c.shape.slice(-3),l.slice(-3))){const I=l[0]*l[1]*(l[2]+1),$={dataId:n.dataId,shape:[1,I,t.inChannels],dtype:n.dtype},q=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,ue(nS(c.shape,$.shape),()=>`packed reshape ${c.shape} to ${$.shape} isn't free`);const U=lt({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}});S.push(U);const F=rS({a:$,b:U,backend:r,transposeA:y,transposeB:v,bias:s,activation:o,preluActivationWeights:i,leakyreluAlpha:a}),G=r.texData.get(F.dataId);ue(G.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=q,G.shape=t.outShape,b=So({inputs:{x:F},backend:r}),b.shape=t.outShape,S.push(F)}else{const I=t.outHeight*t.outWidth,$=lt({inputs:{x:n},backend:r,attrs:{shape:x?[t.batchSize,I,t.inChannels]:[t.batchSize,t.inChannels,I]}}),q=lt({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}}),U=rS({a:x?$:q,b:x?q:$,transposeA:!x,transposeB:v,backend:r,bias:s,activation:o,preluActivationWeights:i,leakyreluAlpha:a});b=lt({inputs:{x:U},backend:r,attrs:{shape:t.outShape}}),S.push($),S.push(q),S.push(U)}for(const I of S)r.disposeIntermediateTensorInfo(I);return b}function ine({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:o=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:p,dataFormat:x}=t,y=x==="channelsLast",v=l*c*u,b=p*d,S=[t.batchSize,v,b],T=!0,C=!1,I=[];if(i!=null){const Z=sS(i.shape,y);Z!=null&&(i=lt({inputs:{x:i},backend:r,attrs:{shape:Z}}),I.push(i))}if(s!=null){const Z=sS(s.shape,y);Z!=null&&(s=lt({inputs:{x:s},backend:r,attrs:{shape:Z}}),I.push(s))}const $=lt({inputs:{x:e},backend:r,attrs:{shape:[1,v,Ue(e.shape)/v]}});I.push($);const q=new Jje(S,t),U=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],F=r.runWebGLProgram(q,[n],"float32",U),G=lt({inputs:{x:F},backend:r,attrs:{shape:S}});I.push(F),I.push(G);const V=s!=null,O=i!=null,K=o==="leakyrelu",P=o?O1(o,!0):null,N=new Xte(y?G.shape:$.shape,y?$.shape:G.shape,y?[t.batchSize,b,t.outChannels]:[t.batchSize,t.outChannels,b],T,C,V,P,O,K),M=y?[G,$]:[$,G];if(s&&M.push(s),O&&M.push(i),K){const Z=r.makeTensorInfo([],"float32",Pf(a,"float32"));M.push(Z),I.push(Z)}const B=r.runWebGLProgram(N,M,"float32"),Y=lt({inputs:{x:B},backend:r,attrs:{shape:t.outShape}});I.push(B);for(const Z of I)r.disposeIntermediateTensorInfo(Z);return Y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r,d=Bh(l),p=Fi(s.shape,i.shape,a,c,o,u,!1,d);let x;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))x=sne({x:s,filter:i,convInfo:p,backend:t});else if(p.strideWidth<=2&&d==="channelsLast"&&Me().getBool("WEBGL_EXP_CONV")){const v=new rne(p),b=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];x=t.runWebGLProgram(v,[s,i],"float32",b)}else if(Me().getBool("WEBGL_CONV_IM2COL"))x=ine({x:s,filter:i,convInfo:p,backend:t});else{const v=new nne(p);x=t.runWebGLProgram(v,[s,i],"float32")}const y=lt({inputs:{x},backend:t,attrs:{shape:p.outShape}});return t.disposeIntermediateTensorInfo(x),y}const tVe={kernelName:mT,backendName:"webgl",kernelFunc:eVe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nVe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class rVe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,l=r-1-e.padInfo.left,c=a?1:2,u=a?2:3,d=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class sVe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class iVe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.front,c=r-1-e.padInfo.top,u=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,d=Bh(l),p=Fi(s.shape,u,a,1,o,c,!1,d),x=new nVe(p);return t.runWebGLProgram(x,[s,i],"float32")}const oVe={kernelName:PD,backendName:"webgl",kernelFunc:aVe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lVe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=aa(this.outputShape.length);const t=e.filterHeight,r=e.filterWidth,s=t-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cVe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{inputShape:a,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r,d=Bh(c),p=Fi(a,i.shape,o,1,l,u,!1,d);if(Me().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const x=[[p.strideHeight,p.strideWidth]],y=new lVe(p);return t.runWebGLProgram(y,[s,i],"float32",x)}else{const x=new rVe(p);return t.runWebGLProgram(x,[s,i],"float32")}}const uVe={kernelName:gT,backendName:"webgl",kernelFunc:cVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:l}=r,c=Of(s.shape,i.shape,a,l,o),u=new Qje(c);return t.runWebGLProgram(u,[s,i],"float32")}const dVe={kernelName:xT,backendName:"webgl",kernelFunc:hVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,pad:o,filterShape:l}=r,c=Of(s.shape,l,a,1,o),u=new sVe(c);return t.runWebGLProgram(u,[s,i],"float32")}const pVe={kernelName:OD,backendName:"webgl",kernelFunc:fVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mVe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{pad:a,strides:o,inputShape:l}=r,c=Of(l,i.shape,o,1,a),u=new iVe(c);return t.runWebGLProgram(u,[s,i],"float32")}const gVe={kernelName:MD,backendName:"webgl",kernelFunc:mVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xVe=mx+`
  return cos(x);
`,yVe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Bm}
  return result;
`,bVe=er({opSnippet:xVe,packedOpSnippet:yVe}),vVe={kernelName:$b,backendName:"webgl",kernelFunc:bVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ve=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,wVe=er({opSnippet:_Ve}),EVe={kernelName:Lb,backendName:"webgl",kernelFunc:wVe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SVe{constructor(e,t,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,l,c]=e,[u]=t,[d,p]=r;this.outputShape=[u,d,p,c];const x=s==="bilinear"?1:0,[y,v]=[`${o-1}.0`,`${l-1}.0`],[b,S,T]=d>1?[`${(o-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${y} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${y}`],[C,I,$]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${v} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${v}`];this.userCode=`
      const float height_ratio = float(${b});
      const float width_ratio = float(${C});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${S};
        float width_scale = ${I};

        float in_y = ${T};
        if( in_y < 0.0 || in_y > ${y} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${$};
        if( in_x < 0.0 || in_x > ${v} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${x} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TVe=n=>{const{inputs:e,backend:t,attrs:r}=n,{image:s,boxes:i,boxInd:a}=e,{cropSize:o,method:l,extrapolationValue:c}=r,u=new SVe(s.shape,i.shape,o,l,c);return t.runWebGLProgram(u,[s,i,a],"float32")},CVe={kernelName:BD,backendName:"webgl",kernelFunc:TVe};var F1;(function(n){n.Prod="*",n.Sum="+"})(F1||(F1={}));class p9{constructor(e,t,r,s){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,a=this.op===F1.Prod?"1.0":"0.0",o=r?a:`getX(${m9(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";r?(c=s?`end != ${l-1}`:"end != 0",u=s?"end + 1":"end - 1"):(c=s?`end + pow2 < ${l}`:"end >= pow2",u=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Sr(i)} coords = getOutputCoords();
        int end = ${g9(i,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${g9(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${m9(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function m9(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function g9(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(n,e,t,r,s,i){const a=e.shape.length,o=os([r],a);let l=e;o!=null&&(l=Ra({inputs:{x:e},backend:t,attrs:{perm:o}}));const c=Cs(1,a)[0];if(c!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const u=l.shape[c];let d=So({inputs:{x:l},backend:t});for(let p=0;p<=Math.ceil(Math.log2(u))-1;p++){const x=new p9(n,l.shape,!1,i),y=[[p]],v=d;d=t.runWebGLProgram(x,[d],d.dtype,y),t.disposeIntermediateTensorInfo(v)}if(s){const p=new p9(n,l.shape,s,i),x=d;d=t.runWebGLProgram(p,[d],d.dtype),t.disposeIntermediateTensorInfo(x)}if(o!=null){const p=Mf(o),x=Ra({inputs:{x:d},backend:t,attrs:{perm:p}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(l),x}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:a,reverse:o}=r;return ane(F1.Prod,s,t,i,a,o)}const NVe={kernelName:FD,backendName:"webgl",kernelFunc:AVe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:a,reverse:o}=r;return ane(F1.Sum,s,t,i,a,o)}const IVe={kernelName:yT,backendName:"webgl",kernelFunc:kVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:a,binaryOutput:o}=r;if(s.shape.length===1){const l=t.readSync(s.dataId),c=t.readSync(i.dataId),u=zte(l,c,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,u)}else if(s.shape.length===2){const l=t.bufferSync(s),c=t.bufferSync(i),u=P9e(l,c,a,o);return t.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const DVe={kernelName:zD,backendName:"webgl",kernelFunc:RVe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ve{constructor(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockSize:i,dataFormat:a}=r,o=s.shape[0],l=a==="NHWC"?s.shape[1]:s.shape[2],c=a==="NHWC"?s.shape[2]:s.shape[3],u=a==="NHWC"?s.shape[3]:s.shape[1],d=l*i,p=c*i,x=u/(i*i),y=a==="NHWC"?[o,d,p,x]:[o,x,d,p],v=new $Ve(y,i,a);return t.runWebGLProgram(v,[s],s.dtype)}const PVe={kernelName:jD,backendName:"webgl",kernelFunc:LVe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class one{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=aa(this.outputShape.length);const a=e.filterHeight,o=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";r&&(s?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,u="result = activation(result);");const d=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lne{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=aa(this.outputShape.length);const a=e.outChannels/e.inChannels,o=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,p=d;let x=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let S=0;S<d;S++)x+=`
          vec4 xTexelC${S*2};
          int xTexelC${S*2}Ready;
          vec4 xTexelC${S*2+1};
          int xTexelC${S*2+1}Ready;
          vec4 xC${S};`;x+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let S=0;S<d;S++)x+=`
          xTexelC${S*2} = vec4(0.0);
          xTexelC${S*2}Ready = 0;
          xTexelC${S*2+1} = vec4(0.0);
          xTexelC${S*2+1}Ready = 0;
          xC${S} = vec4(0.0);`;x+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let S=0;S<(p+1)/2;S++){const T=S*2;if(x+=`
          xC = xCCorner + ${T*c};
          `,l===1){if(T<d&&(o%2===1?(x+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }
              `,c===1&&T>0?x+=`
                xC${T} = vec4(xTexelC${T-2}.zw, xTexelC${T}.xy);
                `:x+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${T} = vec4(previous.zw, xTexelC${T}.xy);
                  } else {
                    xC${T} = vec4(0.0, 0.0, xTexelC${T}.xy);
                  }
                  `):x+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }

                xC${T} = xTexelC${T};
                `,T+1<d)){const C=o%2===0?wD(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(x+=`
                  xCOffset = xC + imod(pads[1], 2) + ${C};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                    xTexelC${T+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${T+1}.zw = vec2(0.0);
                    }
                    xTexelC${T+1}Ready = 1;
                  }
                  `,c>1?x+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${T+1} = vec4(previous.zw, xTexelC${T+1}.xy);
                    } else {
                     xC${T+1} = vec4(0.0, 0.0, xTexelC${T+1}.xy);
                    }
                    `:x+=`
                    xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.xy);
                    `):C===1?x+=`
                    xC${T+1} = xTexelC${T};
                    `:x+=`
                    xCOffset = xC + ${C};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                      xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${T+1}.zw = vec2(0.0);
                      }
                      xTexelC${T+1}Ready = 1;
                    }

                    xC${T+1} = xTexelC${T+1};
                    `}}else T<d&&(o%2===1?(x+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${T+1}Ready == 0) {
                  xTexelC${T+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${T+1}.zw = vec2(0.0);
                  }
                  xTexelC${T+1}Ready = 1;
                }

                xC${T} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
              `,T+1<d&&(x+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${T+1} = vec4(xTexelC${T+1}.xy, final.xy);
                `)):(x+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                  xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${T+1}.zw = vec2(0.);
                  }
                  xTexelC${T+1}Ready = 1;
                }

                xC${T} = vec4(
                  xTexelC${T}.xy, xTexelC${T+1}.xy);
              `,T+1<d&&(x+=`
                  xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
                `)));T<d&&(x+=`
            wTexel = getW(r, ${T}, d1, q);
            dotProd += xC${T} * vec4(wTexel.xz, wTexel.xz);
          `,T+1<d&&(x+=`
              wTexel = getW(r, ${T+1}, d1, q);
              dotProd += xC${T+1} * vec4(wTexel.xz, wTexel.xz);
            `))}x+=`
    }
  `,x+=`
      }
    `;let y="",v="";r&&(s?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:y=`vec4 activation(vec4 x) {
          ${r}
        }`,v="result = activation(result);");const b=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${x}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${b}
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:l,dimRoundingMode:c}=r;let u=l;u==null&&(u=[1,1]),ue(sa(a,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const d=Fi(s.shape,i.shape,a,u,o,c,!0);let p;Me().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new lne(d):p=new one(d);const x=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return t.runWebGLProgram(p,[s,i],"float32",x)}const MVe={kernelName:bT,backendName:"webgl",kernelFunc:OVe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FVe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class BVe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r,d=Fi(s.shape,u,a,o,l,c,!0),p=new FVe(d);return t.runWebGLProgram(p,[s,i],"float32")}const jVe={kernelName:VD,backendName:"webgl",kernelFunc:zVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VVe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r,d=Fi(u,i.shape,a,o,l,c,!0),p=new BVe(d);return t.runWebGLProgram(p,[s,i],"float32")}const UVe={kernelName:UD,backendName:"webgl",kernelFunc:VVe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GVe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HVe(n){const{inputs:e,backend:t}=n,{x:r}=e,s=[...r.shape,...r.shape],i=Ue(r.shape),a=lt({inputs:{x:r},backend:t,attrs:{shape:[i]}}),o=new GVe(i),l=t.runWebGLProgram(o,[a],a.dtype),c=lt({inputs:{x:l},backend:t,attrs:{shape:s}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),c}const WVe={kernelName:XX,backendName:"webgl",kernelFunc:HVe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qVe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:r,padInfo:s,strideHeight:i,strideWidth:a,filterHeight:o,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:p}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${a});
      const ivec2 pads = ivec2(${d}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KVe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:l}=r,c=yv(s.shape,i.shape,a,o,"NHWC",l);let u;const d=new qVe(c);u=t.runWebGLProgram(d,[s,i],"float32");const p=lt({inputs:{x:u},backend:t,attrs:{shape:c.outShape}});return t.disposeIntermediateTensorInfo(u),p}const XVe={kernelName:vT,backendName:"webgl",kernelFunc:KVe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YVe(n){const{inputs:e,backend:t,attrs:r}=n,{equation:s}=r,i=e,{allDims:a,summedDims:o,idDims:l}=c6(s,i.length);h6(a.length,l,i);const{path:c,steps:u}=d6(o,l),d=u.length;let p=null,x=a.length;const y=[];for(let v=0;v<d;++v){for(const b of u[v]){const{permutationIndices:S,expandDims:T}=u6(x,l[b]);let C;f6(S)?C=i[b]:(C=Ra({inputs:{x:i[b]},backend:t,attrs:{perm:S}}),y.push(C));const I=C.shape.slice();for(let $=0;$<T.length;++$)I.splice(T[$],0,1);gr(C.shape,I)||(C=lt({inputs:{x:C},backend:t,attrs:{shape:I}}),y.push(C)),p===null?p=C:(p=J6({inputs:{a:C,b:p},backend:t}),y.push(p))}v<d-1&&(c[v]>=0&&(p=LC({inputs:{x:p},backend:t,attrs:{axis:c[v]-(a.length-x),keepDims:!1}}),y.push(p)),x--)}for(const v of y)v!==p&&t.disposeIntermediateTensorInfo(v);return p}const ZVe={kernelName:GD,backendName:"webgl",kernelFunc:YVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QVe="return (x >= 0.0) ? x : (exp(x) - 1.0);",JVe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,eUe=er({opSnippet:QVe,packedOpSnippet:JVe}),tUe={kernelName:Ob,backendName:"webgl",kernelFunc:eUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nUe="return (b >= 0.0) ? a : a * (b + 1.0);",rUe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,sUe=n=>{const{inputs:e,backend:t}=n,{dy:r,y:s}=e,i=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new px(rUe,r.shape,s.shape):new Em(nUe,r.shape,s.shape);return t.runWebGLProgram(i,[r,s],r.dtype)},iUe={kernelName:HD,backendName:"webgl",kernelFunc:sUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aUe=`
  return vec4(equal(a, b));
`,oUe="return float(a == b);",lUe=zi({opSnippet:oUe,packedOpSnippet:aUe,dtype:"bool",cpuKernelImpl:z9e}),cUe={kernelName:_T,backendName:"webgl",kernelFunc:lUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uUe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${n6};
  float a1 = ${r6};
  float a2 = ${s6};
  float a3 = ${i6};
  float a4 = ${a6};
  float a5 = ${o6};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,hUe=er({opSnippet:uUe}),dUe={kernelName:Mb,backendName:"webgl",kernelFunc:hUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fUe=mx+`
  return exp(x);
`,pUe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cne=er({opSnippet:fUe,packedOpSnippet:pUe,cpuKernelImpl:j9e,dtype:"float32"}),mUe={kernelName:Fb,backendName:"webgl",kernelFunc:cne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3(n){const{inputs:e,attrs:t,backend:r}=n,{dim:s}=t,{input:i}=e,a=i.shape.length,o=i.shape.slice();let l=s;return s<0&&(ue(-(a+1)<=s,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+s+1),o.splice(l,0,1),lt({inputs:{x:i},backend:r,attrs:{shape:o}})}const gUe={kernelName:wT,backendName:"webgl",kernelFunc:z3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x9="return exp(x) - 1.0;",xUe=er({opSnippet:x9,packedOpSnippet:x9,cpuKernelImpl:V9e}),yUe={kernelName:Bb,backendName:"webgl",kernelFunc:xUe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y9{constructor(e,t,r){this.variableNames=["real","imag"];const s=t[1];this.outputShape=t;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=r?`${s}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(n,e,t){const r=t.texData.get(n.dataId),s=Ue(n.shape),i=n.shape[n.shape.length-1],a=s/i,o=lt({inputs:{x:n},backend:t,attrs:{shape:[a,i]}}),l=o.shape,c=new y9("real",l,e),u=new y9("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=t.runWebGLProgram(c,d,"float32"),x=t.runWebGLProgram(u,d,"float32"),y=Uf({inputs:{real:p,imag:x},backend:t});t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(x);const v=lt({inputs:{x:y},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(y),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bUe(n){const{inputs:e,backend:t}=n,{input:r}=e;return une(r,!1,t)}const vUe={kernelName:WD,backendName:"webgl",kernelFunc:bUe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ue{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bv(n){const{backend:e,attrs:t}=n,{shape:r,value:s}=t;let{dtype:i}=t;if(i=i||ex(s),i==="string"){const a=vs(i,Ue(r));return a.fill(s),e.makeTensorInfo(r,i,a)}else{const a=new _Ue(r,s),o=[[s]];return e.runWebGLProgram(a,[],i,o)}}const wUe={kernelName:qD,backendName:"webgl",kernelFunc:Bv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EUe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SUe={kernelName:KD,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,r=e,s=new EUe(t.shape);return r.runWebGLProgram(s,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b9="return floor(x);",TUe=er({opSnippet:b9,packedOpSnippet:b9,cpuKernelImpl:U9e}),CUe={kernelName:zb,backendName:"webgl",kernelFunc:TUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AUe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,NUe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,kUe=zi({opSnippet:AUe,packedOpSnippet:NUe,dtype:"int32"}),IUe={kernelName:jb,backendName:"webgl",kernelFunc:kUe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RUe{constructor(e){this.variableNames=["A"];const t=$a(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DUe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=$a(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ue={kernelName:mAe,backendName:"webgl",kernelFunc:LUe};let k0,Bk=Me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function LUe(n){const{inputs:e,backend:t,attrs:r}=n;let{pixels:s}=e;const{numChannels:i}=r,a=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,c]=a?[s.videoWidth,s.videoHeight]:[s.width,s.height],u=[c,l],d=[c,l,i];if(o||a){const v=Me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(k0==null||v!==Bk)&&(Bk=v,k0=document.createElement("canvas").getContext("2d",{willReadFrequently:Bk})),k0.canvas.width=l,k0.canvas.height=c,k0.drawImage(s,0,0,l,c),s=k0.canvas}const p=t.makeTensorInfo(u,"int32");t.texData.get(p.dataId).usage=Qo.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(p.dataId),s);const x=Me().getBool("WEBGL_PACK")?new DUe(d):new RUe(d),y=t.runWebGLProgram(x,[p],"int32");return t.disposeData(p.dataId),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PUe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:x,leakyreluAlpha:y}=r,v=Bh(u),b=Fi(s.shape,i.shape,l,d,c,p,!1,v);let S;const T=[],C=a!=null,I=o!=null,$=x==="leakyrelu",q=()=>{const F=[s,i],G=(V,O)=>{if(O==="NCHW"&&V.shape.length===1&&V.shape[0]!==1){const K=lt({inputs:{x:V},backend:t,attrs:{shape:[V.shape[0],1,1]}});return T.push(K),K}return V};if(C&&F.push(G(a,u)),I&&F.push(G(o,u)),$){const V=t.makeTensorInfo([],"float32",Pf(y,"float32"));F.push(V),T.push(V)}return F};if(b.filterHeight===1&&b.filterWidth===1&&b.dilationHeight===1&&b.dilationWidth===1&&b.strideHeight===1&&b.strideWidth===1&&(b.padInfo.type==="SAME"||b.padInfo.type==="VALID"))S=sne({x:s,filter:i,convInfo:b,backend:t,bias:a,activation:x,preluActivationWeights:o,leakyreluAlpha:y});else if(b.strideWidth<=2&&v==="channelsLast"&&Me().getBool("WEBGL_EXP_CONV")){const F=x?O1(x,!0):null,G=new rne(b,C,F,I,$),V=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],O=q();S=t.runWebGLProgram(G,O,"float32",V)}else if(Me().getBool("WEBGL_CONV_IM2COL"))S=ine({x:s,filter:i,convInfo:b,backend:t,bias:a,activation:x,preluActivationWeights:o,leakyreluAlpha:y});else{const F=x?O1(x,!1):null,G=new nne(b,C,F,I,$),V=q();S=t.runWebGLProgram(G,V,"float32")}const U=lt({inputs:{x:S},backend:t,attrs:{shape:b.outShape}});return T.push(S),T.forEach(F=>t.disposeIntermediateTensorInfo(F)),U}const OUe={kernelName:LE,backendName:"webgl",kernelFunc:PUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MUe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:p,leakyreluAlpha:x}=r,y=[];let v=u;v==null&&(v=[1,1]),ue(sa(l,v),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${v}'`);const b=Fi(s.shape,i.shape,l,v,c,d,!0),S=Me().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels===1,T=p?O1(p,S):null,C=[s,i],I=a!=null,$=o!=null,q=p==="leakyrelu";if(I&&C.push(a),$&&C.push(o),q){const V=t.makeTensorInfo([],"float32",Pf(x,"float32"));C.push(V),y.push(V)}let U;S?U=new lne(b,I,T,$,q):U=new one(b,I,T,$,q);const F=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],G=t.runWebGLProgram(U,C,"float32",F);return y.forEach(V=>t.disposeIntermediateTensorInfo(V)),G}const FUe={kernelName:pY,backendName:"webgl",kernelFunc:MUe};class BUe{constructor(e,t,r,s){this.sliceDim=e,this.strides=t,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=Sr(r.length);let a=`
    int index;`;for(let o=0;o<this.sliceDim;o++)a+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zUe(n){const{inputs:e,backend:t}=n,{params:r,indices:s}=e,i=s.shape,a=i[i.length-1],o=Ue(r.shape),[l,c,u,d]=H$(r,s),p=lt({inputs:{x:s},backend:t,attrs:{shape:[c,a]}}),x=lt({inputs:{x:r},backend:t,attrs:{shape:[Ue(r.shape)/u,u]}});if(t.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const S=t.readSync(s.dataId),T=t.bufferSync(r),C=G9e(S,T,r.dtype,c,a,u,d,r.shape,o);return t.makeTensorInfo(l,r.dtype,C.values)}const y=new BUe(a,d,[c,u],r.shape),v=t.runWebGLProgram(y,[x,p],x.dtype),b=lt({inputs:{x:v},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),b}const jUe={kernelName:YX,backendName:"webgl",kernelFunc:zUe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VUe{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const r=Sr(this.rank),s=UUe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function UUe(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<n.length;s++)s===2?r.push("index"):r.push(`${t[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,indices:i}=e,{axis:a,batchDims:o}=r,l=Sn(a,s.shape)[0];if(Me().get("DEBUG")){const T=t.readSync(i.dataId),C=s.shape[l];for(let I=0;I<T.length;++I){const $=T[I];ue($<=C-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${C-1}]`)}}const c=m6(s,i,l,o),u=Ue(i.shape),d=[],p=lt({inputs:{x:s},backend:t,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),x=lt({inputs:{x:i},backend:t,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(p),d.push(x);const y=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(t.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const T=t.bufferSync(x),C=t.bufferSync(p),I=H9e(C,T,y);return d.forEach($=>t.disposeIntermediateTensorInfo($)),t.makeTensorInfo(c.outputShape,I.dtype,I.values)}const v=new VUe(p.shape,y),b=t.runWebGLProgram(v,[p,x],p.dtype);d.push(b);const S=lt({inputs:{x:b},backend:t,attrs:{shape:c.outputShape}});return d.forEach(T=>t.disposeIntermediateTensorInfo(T)),S}const GUe={kernelName:ST,backendName:"webgl",kernelFunc:hne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HUe="return float(a > b);",WUe=`
  return vec4(greaterThan(a, b));
`,qUe=zi({opSnippet:HUe,packedOpSnippet:WUe,cpuKernelImpl:W9e,dtype:"bool"}),KUe={kernelName:TT,backendName:"webgl",kernelFunc:qUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XUe="return float(a >= b);",YUe=`
  return vec4(greaterThanEqual(a, b));
`,ZUe=zi({opSnippet:XUe,packedOpSnippet:YUe,dtype:"bool",cpuKernelImpl:q9e}),QUe={kernelName:Vb,backendName:"webgl",kernelFunc:ZUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JUe(n){const{inputs:e,backend:t}=n,{input:r}=e;return une(r,!0,t)}const eGe={kernelName:XD,backendName:"webgl",kernelFunc:JUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tGe="return float(!isnan(x) && !isinf(x));",nGe=er({opSnippet:tGe,dtype:"bool"}),rGe={kernelName:Gb,backendName:"webgl",kernelFunc:nGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sGe="return float(isinf(x));",iGe=er({opSnippet:sGe,dtype:"bool"}),aGe={kernelName:Hb,backendName:"webgl",kernelFunc:iGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oGe="return float(isnan(x));",lGe=er({opSnippet:oGe,dtype:"bool"}),cGe={kernelName:Wb,backendName:"webgl",kernelFunc:lGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uGe="return float(a < b);",hGe=`
  return vec4(lessThan(a, b));
`,dGe=zi({opSnippet:uGe,packedOpSnippet:hGe,cpuKernelImpl:K9e,dtype:"bool"}),fGe={kernelName:AT,backendName:"webgl",kernelFunc:dGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pGe="return float(a <= b);",mGe=`
  return vec4(lessThanEqual(a, b));
`,gGe=zi({opSnippet:pGe,packedOpSnippet:mGe,cpuKernelImpl:X9e,dtype:"bool"}),xGe={kernelName:NT,backendName:"webgl",kernelFunc:gGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yGe(n){const{backend:e,attrs:t}=n,{start:r,stop:s,num:i}=t,a=Y9e(r,s,i);return e.makeTensorInfo([a.length],"float32",a)}const bGe={kernelName:ZX,backendName:"webgl",kernelFunc:yGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vGe=mx+`
  return x < 0.0 ? 0./0. : log(x);
`,_Ge=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,wGe=er({opSnippet:vGe,packedOpSnippet:_Ge,cpuKernelImpl:Z9e}),EGe={kernelName:qb,backendName:"webgl",kernelFunc:wGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SGe=mx+`
  return log(1.0 + x);
`,TGe=er({opSnippet:SGe}),CGe={kernelName:Kb,backendName:"webgl",kernelFunc:TGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AGe="return float(a >= 1.0 && b >= 1.0);",NGe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,kGe=zi({opSnippet:AGe,packedOpSnippet:NGe,dtype:"bool"}),IGe={kernelName:kT,backendName:"webgl",kernelFunc:kGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RGe="return float(!(x >= 1.0));",DGe=er({opSnippet:RGe}),$Ge={kernelName:IT,backendName:"webgl",kernelFunc:DGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LGe="return float(a >= 1.0 || b >= 1.0);",PGe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,OGe=zi({opSnippet:LGe,packedOpSnippet:PGe,dtype:"bool"}),MGe={kernelName:RT,backendName:"webgl",kernelFunc:OGe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FGe{constructor(e,t,r,s,i){this.variableNames=["x"],this.outputShape=[];const a=t,o=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BGe{constructor(e,t,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=t,o=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zGe=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{depthRadius:i,bias:a,alpha:o,beta:l}=r,c=Me().getBool("WEBGL_PACK_NORMALIZATION")?new BGe(s.shape,i,a,o,l):new FGe(s.shape,i,a,o,l);return t.runWebGLProgram(c,[s],s.dtype)},jGe={kernelName:DT,backendName:"webgl",kernelFunc:zGe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VGe{constructor(e,t,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UGe=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s,y:i,dy:a}=e,{depthRadius:o,bias:l,alpha:c,beta:u}=r,d=new VGe(s.shape,o,l,c,u);return t.runWebGLProgram(d,[s,i,a],s.dtype)},GGe={kernelName:ZD,backendName:"webgl",kernelFunc:UGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HGe(n,e,t,r){const s=Ue(e),a=Ue(n.shape)/s,o=lt({inputs:{x:n},attrs:{shape:[a,s]},backend:r}),l=zm(o,n.dtype,"max",r),c=lt({inputs:{x:l},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reductionIndices:i,keepDims:a}=r,o=s.shape.length,l=Sn(i,s.shape);let c=l;const u=os(c,o),d=u!=null,p=t.shouldExecuteOnCPU([s]);let x=s;if(d){if(p){const C=t.texData.get(x.dataId).values,I=new Array(o);for(let U=0;U<I.length;U++)I[U]=s.shape[u[U]];const $=Z6(C,s.shape,s.dtype,u,I);x=t.makeTensorInfo(I,s.dtype);const q=t.texData.get(x.dataId);q.values=$}else x=$C(s,u,t);c=Cs(c.length,o)}Bi("max",c,o);const[y,v]=xi(x.shape,c);let b=y;a&&(b=Us(y,l));let S;if(p){const C=t.texData.get(x.dataId).values,I=Q9e(C,Ue(v),b,s.dtype);S=t.makeTensorInfo(b,s.dtype);const $=t.texData.get(S.dataId);$.values=I}else S=HGe(x,v,b,t);return d&&t.disposeIntermediateTensorInfo(x),S}const WGe={kernelName:$T,backendName:"webgl",kernelFunc:dne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qGe=Q6+`
  return max(a, b);
`,KGe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Bm+`
  return result;
`,XGe=zi({opSnippet:qGe,packedOpSnippet:KGe,cpuKernelImpl:J9e}),YGe={kernelName:Xb,backendName:"webgl",kernelFunc:XGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZGe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;Ov(s,"maxPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=r,c=1;ue(sa(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const u=Ml(s.shape,i,a,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&gr(u.inShape,u.outShape))return So({inputs:{x:s},backend:t});const d=new M1(u,"max",!1);return t.runWebGLProgram(d,[s],s.dtype)}const QGe={kernelName:LT,backendName:"webgl",kernelFunc:ZGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JGe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:a,pad:o,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],d=Fh(s.shape,i,a,u,o,c,l),p=new eL(d,"max",!1);return t.runWebGLProgram(p,[s],s.dtype)}const eHe={kernelName:PT,backendName:"webgl",kernelFunc:JGe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tHe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,l=a-1-e.padInfo.left,c=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class nHe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,p=c-1-e.padInfo.top,x=u-1-e.padInfo.left,y=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${p}, ${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${y} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rHe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,a=i,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],p=Fh(a.shape,o,l,d,c,u),x=new eL(p,"max",!0),y=t.runWebGLProgram(x,[a],a.dtype),v=new nHe(p),b=t.runWebGLProgram(v,[s,y],a.dtype);return t.disposeIntermediateTensorInfo(y),b}const sHe={kernelName:JD,backendName:"webgl",kernelFunc:rHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iHe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i,output:a}=e,o=i;Ov([i,a],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,p=Ml(o.shape,l,c,1,u,d),x=!0,y=new M1(p,"max",x),v=t.runWebGLProgram(y,[o],o.dtype),b=new tHe(p),S=t.runWebGLProgram(b,[s,v],o.dtype);return t.disposeIntermediateTensorInfo(v),S}const aHe={kernelName:QD,backendName:"webgl",kernelFunc:iHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oHe(n,e,t,r){let s=new M1(t,"max",!1);const i=r.runWebGLProgram(s,[n],"float32");s=new M1(t,"max",!0,!0,e);const a=r.runWebGLProgram(s,[n],"float32");return[i,a]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lHe={kernelName:QX,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:s,strides:i,pad:a,includeBatchInIndex:o}=e,l=t;ue(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const c=[1,1];ue(sa(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Ml(r.shape,s,i,c,a),[d,p]=oHe(r,o,u,l);return[d,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cHe(n,e,t,r){const s=Ue(e),a=Ue(n.shape)/s,o=lt({inputs:{x:n},attrs:{shape:[a,s]},backend:r}),l=zm(o,"float32","mean",r),c=lt({inputs:{x:l},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uHe={kernelName:OT,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{keepDims:s,axis:i}=e,a=t,o=r.shape.length,l=Sn(i,r.shape);let c=l;const u=os(c,o),d=u!=null,p=a.shouldExecuteOnCPU([r]),x=[];let y=r;if(d){if(p){const I=a.texData.get(y.dataId).values,$=new Array(o);for(let F=0;F<$.length;F++)$[F]=r.shape[u[F]];const q=Z6(I,r.shape,r.dtype,u,$);y=a.makeTensorInfo($,r.dtype);const U=a.texData.get(y.dataId);U.values=q}else y=$C(r,u,a);x.push(y),c=Cs(c.length,o)}Bi("sum",c,o);const[v,b]=xi(y.shape,c);let S=v;s&&(S=Us(v,l));const T=cHe(y,b,S,a);for(const C of x)a.disposeIntermediateTensorInfo(C);return T}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hHe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=s.shape.length,l=Sn(i,s.shape);let c=l;const u=os(c,o);let d=s;u!=null&&(d=Ra({inputs:{x:s},backend:t,attrs:{perm:u}}),c=Cs(c.length,s.shape.length)),Bi("min",c,o);const[p,x]=xi(d.shape,c),y=Ue(x),v=lt({inputs:{x:d},backend:t,attrs:{shape:[-1,y]}}),b=zm(v,v.dtype,"min",t);let S;if(a){const T=Us(p,l);S=lt({inputs:{x:b},backend:t,attrs:{shape:T}})}else S=lt({inputs:{x:b},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(b),u!=null&&t.disposeIntermediateTensorInfo(d),S}const dHe={kernelName:MT,backendName:"webgl",kernelFunc:hHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fHe=Q6+`
  return min(a, b);
`,pHe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Bm+`
  return result;
`,mHe=zi({opSnippet:fHe,packedOpSnippet:pHe,cpuKernelImpl:e7e}),gHe={kernelName:Yb,backendName:"webgl",kernelFunc:mHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xHe{constructor(e,t,r){this.variableNames=["x"],this.outputShape=t.map((u,d)=>u[0]+e[d]+u[1]);const s=e.length,i=Sr(s),a=t.map(u=>u[0]).join(","),o=t.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),c=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yHe{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((y,v)=>y[0]+e[v]+y[1]);const s=e.length,i=Sr(s),a=t.map(y=>y[0]).join(","),o=t.map((y,v)=>y[0]+e[v]).join(","),l=Aa("rc",s),c=Aa("source",s),u=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${c.slice(-2).join()})`,p=r==="reflect"?0:1;let x="";if(s===1){const y=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;x=`
        ${i} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[s-1]} += 1;
        if(${u}) {
          ${y}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const y=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;x=`
        ${i} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[s-1]} += 1;
        if(${u}) {
          ${y}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${y}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[s-1]} += 1;
          if(${u}) {
            ${y}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bHe=({inputs:n,backend:e,attrs:t})=>{const{x:r}=n,{paddings:s,mode:i}=t,a=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yHe(r.shape,s,i):new xHe(r.shape,s,i);return e.runWebGLProgram(a,[r],r.dtype)},vHe={kernelName:FT,backendName:"webgl",kernelFunc:bHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _He=`if (b == 0.0) return NAN;
  return mod(a, b);`,wHe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Bm+`
  return result;
`,EHe=zi({opSnippet:_He,packedOpSnippet:wHe}),SHe={kernelName:Zb,backendName:"webgl",kernelFunc:EHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class THe{constructor(e,t,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CHe=`
if (a == b) {
  return 1.0;
};
return a / b;`,AHe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,fne=zi({opSnippet:CHe,packedOpSnippet:AHe,checkOutOfBounds:!0}),NHe={kernelName:Pb,backendName:"webgl",kernelFunc:fne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v9="return a - b;",pne=zi({opSnippet:v9,packedOpSnippet:v9,supportsComplex:!0,cpuKernelImpl:_7e}),kHe={kernelName:fv,backendName:"webgl",kernelFunc:pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{dim:i}=r,a=Sn([i],s.shape),o=dne({inputs:{x:s},backend:t,attrs:{reductionIndices:a,keepDims:!1}}),l=Us(o.shape,a),c=lt({inputs:{x:o},backend:t,attrs:{shape:l}}),u=pne({inputs:{a:s,b:c},backend:t}),d=cne({inputs:{x:u},backend:t}),p=LC({inputs:{x:d},backend:t,attrs:{axis:a,keepDims:!1}}),x=lt({inputs:{x:p},backend:t,attrs:{shape:l}}),y=fne({inputs:{a:d,b:x},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(x),y}const IHe={kernelName:nC,backendName:"webgl",kernelFunc:mne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RHe(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{numSamples:i,seed:a,normalized:o}=r,l=o?s:mne({inputs:{logits:s},backend:t,attrs:{dim:s.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new THe(c,u,i),p=[[a]],x=t.runWebGLProgram(d,[l],"int32",p);return o||t.disposeIntermediateTensorInfo(l),x}const DHe={kernelName:JX,backendName:"webgl",kernelFunc:RHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $He=Bl+`
  return -x;
`,LHe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function PHe(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])){const i=t.texData.get(r.dataId),[a,o]=n7e(i.values,r.shape,r.dtype);return t.makeTensorInfo(o,r.dtype,a)}let s;return Me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Wd(r.shape,LHe):s=new tu(r.shape,$He),t.runWebGLProgram(s,[r],r.dtype)}const OHe={kernelName:BT,backendName:"webgl",kernelFunc:PHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MHe=z$;function FHe(n){Xo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r,c=t.readSync(s.dataId),u=t.readSync(i.dataId),{selectedIndices:d}=MHe(c,u,a,o,l);return t.makeTensorInfo([d.length],"int32",new Int32Array(d))}const BHe={kernelName:e$,backendName:"webgl",kernelFunc:FHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zHe=j$;function jHe(n){Xo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r,u=t.readSync(s.dataId),d=t.readSync(i.dataId),{selectedIndices:p,validOutputs:x}=zHe(u,d,a,o,l,c);return[t.makeTensorInfo([p.length],"int32",new Int32Array(p)),t.makeTensorInfo([],"int32",new Int32Array([x]))]}const VHe={kernelName:t$,backendName:"webgl",kernelFunc:jHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UHe=V$;function GHe(n){Xo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r,u=t.readSync(s.dataId),d=t.readSync(i.dataId),p=a,x=o,y=l,v=c,{selectedIndices:b,selectedScores:S}=UHe(u,d,p,x,y,v);return[t.makeTensorInfo([b.length],"int32",new Int32Array(b)),t.makeTensorInfo([S.length],"float32",new Float32Array(S))]}const HHe={kernelName:n$,backendName:"webgl",kernelFunc:GHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WHe{constructor(e,t,r,s){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qHe=n=>{const{inputs:e,backend:t,attrs:r}=n,{indices:s}=e,{dtype:i,depth:a,onValue:o,offValue:l}=r,c=Ue(s.shape),u=new WHe(c,a,o,l),d=lt({inputs:{x:s},backend:t,attrs:{shape:[c]}}),p=t.runWebGLProgram(u,[d],i);t.disposeIntermediateTensorInfo(d);const x=[...s.shape,a],y=lt({inputs:{x:p},backend:t,attrs:{shape:x}});return t.disposeIntermediateTensorInfo(p),y},KHe={kernelName:VT,backendName:"webgl",kernelFunc:qHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iS(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="complex64"){const s=Fv({inputs:{input:r},backend:t}),i=iS({inputs:{x:s},backend:t}),a=PC({inputs:{input:r},backend:t}),o=iS({inputs:{x:a},backend:t}),l=Uf({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return Bv({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:t})}const XHe={kernelName:iC,backendName:"webgl",kernelFunc:iS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Fv({inputs:{input:r},backend:t}),i=gne({inputs:{x:s},backend:t}),a=PC({inputs:{input:r},backend:t}),o=iS({inputs:{x:a},backend:t}),l=Uf({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return Bv({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:t})}const YHe={kernelName:jT,backendName:"webgl",kernelFunc:gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZHe(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r;if(e.length===1)return z3({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const i=e[0].shape,a=e[0].dtype;e.forEach(u=>{ED(i,u.shape,"All tensors passed to stack must have matching shapes"),ue(a===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(u=>{const d=z3({inputs:{input:u},backend:t,attrs:{dim:s}});return o.push(d),d}),c=tne({inputs:l,backend:t,attrs:{axis:s}});return o.forEach(u=>t.disposeIntermediateTensorInfo(u)),c}const QHe={kernelName:UT,backendName:"webgl",kernelFunc:ZHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JHe{constructor(e,t,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((c,u)=>c[0]+e[u]+c[1]);const s=e.length,i=Sr(s),a=t.map(c=>c[0]).join(","),o=t.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eWe{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((v,b)=>v[0]+e[b]+v[1]);const s=e.length,i=Sr(s),a=t.map(v=>v[0]).join(","),o=t.map((v,b)=>v[0]+e[b]).join(","),l=Aa("rc",s),c=Aa("source",s),u=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${c.slice(-2).join()})`,p=[`${i} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${u}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${u}) {`],x=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let y="";for(let v=0,b=s===1?2:4;v<b;v++)y+=`
        ${p[v]}
        if (${x}) {
          result[${v}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${v}] = getChannel(getX(${c.join()}), ${d});
        }
      `;y+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xne=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,constantValue:a}=r;if(Ue(s.shape)===0){const c=i.map((u,d)=>u[0]+s.shape[d]+u[1]);return Bv({backend:t,attrs:{shape:c,value:a,dtype:s.dtype}})}const o=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eWe(s.shape,i,a):new JHe(s.shape,i,a),l=[[a]];return t.runWebGLProgram(o,[s],s.dtype,l)},tWe={kernelName:GT,backendName:"webgl",kernelFunc:xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nWe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,rWe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Bm+`
  return result;
`,sWe=zi({opSnippet:nWe,packedOpSnippet:rWe}),iWe={kernelName:Jb,backendName:"webgl",kernelFunc:sWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aWe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=s.shape.length,l=[],c=Sn(i,s.shape);let u=c;const d=os(u,o);let p=s;d!=null&&(p=Ra({inputs:{x:s},backend:t,attrs:{perm:d}}),u=Cs(u.length,o),l.push(p)),Bi("prod",u,o);let x;if(t.shouldExecuteOnCPU([p])){const y=t.texData.get(p.dataId).values,{outVals:v,outShape:b,outDtype:S}=s7e(p.shape,p.dtype,y,u);x=t.makeTensorInfo(b,S,v)}else{const[y,v]=xi(p.shape,u),b=Ue(v),S=lt({inputs:{x:p},backend:t,attrs:{shape:[-1,b]}}),T=p$(s.dtype),C=zm(S,T,"prod",t);x=lt({inputs:{x:C},backend:t,attrs:{shape:y}}),l.push(S),l.push(C)}if(a){l.push(x);const y=Us(x.shape,c);x=lt({inputs:{x},backend:t,attrs:{shape:y}})}return l.forEach(y=>t.disposeIntermediateTensorInfo(y)),x}const oWe={kernelName:WT,backendName:"webgl",kernelFunc:aWe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lWe(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:s,paramsDenseValues:i,indices:a}=e,{outputRaggedRank:o}=r,l=s.map(S=>t.readSync(S.dataId)),c=s.map(S=>S.shape),u=t.readSync(i.dataId),d=t.readSync(a.dataId),[p,x,y]=i7e(l,c,u,i.shape,i.dtype,d,a.shape,o),v=p.map(S=>t.makeTensorInfo([S.length],"int32",S)),b=t.makeTensorInfo(y,i.dtype,x);return v.concat([b])}const cWe={kernelName:eY,backendName:"webgl",kernelFunc:lWe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uWe(n){const{inputs:e,backend:t}=n,{starts:r,limits:s,deltas:i}=e,a=t.readSync(r.dataId),o=t.readSync(s.dataId),l=t.readSync(i.dataId),[c,u]=a7e(a,r.shape,r.dtype,o,s.shape,l,i.shape),d=t.makeTensorInfo([c.length],"int32",c),p=t.makeTensorInfo([u.length],r.dtype,u);return[d,p]}const hWe={kernelName:tY,backendName:"webgl",kernelFunc:uWe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dWe(n){const{inputs:e,backend:t,attrs:r}=n,{shape:s,values:i,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=r,c=t.readSync(s.dataId),u=t.readSync(i.dataId),d=t.readSync(a.dataId),p=o.map(b=>t.readSync(b.dataId)),x=o.map(b=>b.shape),[y,v]=o7e(c,s.shape,u,i.shape,i.dtype,d,a.shape,p,x,l);return t.makeTensorInfo(y,i.dtype,v)}const fWe={kernelName:nY,backendName:"webgl",kernelFunc:dWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yne=n=>{const{backend:e,attrs:t}=n,{start:r,stop:s,step:i,dtype:a}=t,o=l7e(r,s,i,a);return e.makeTensorInfo([o.length],a,o)},pWe={kernelName:r$,backendName:"webgl",kernelFunc:yne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mWe="return 1.0 / x;",gWe=er({opSnippet:mWe}),xWe={kernelName:ev,backendName:"webgl",kernelFunc:gWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yWe=Bl+`
  return (x < 0.0) ? 0.0 : x;
`,bWe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,vWe=er({opSnippet:yWe,packedOpSnippet:bWe}),_We={kernelName:tv,backendName:"webgl",kernelFunc:vWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wWe=Bl+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,EWe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,SWe=er({opSnippet:wWe,packedOpSnippet:EWe}),TWe={kernelName:nv,backendName:"webgl",kernelFunc:SWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CWe{constructor(e,t,r,s,i){this.variableNames=["A"],this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,t,r,c];const u=[s&&t>1?o-1:o,s&&r>1?l-1:l],d=[s&&t>1?t-1:t,s&&r>1?r-1:r];let p;i?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AWe{constructor(e,t,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,t,r,c];const u=[s&&t>1?o-1:o,s&&r>1?l-1:l],d=[s&&t>1?t-1:t,s&&r>1?r-1:r];let p;i?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NWe(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r,[l,c]=o,u=Me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new AWe(s.shape,l,c,i,a):new CWe(s.shape,l,c,i,a);return t.runWebGLProgram(u,[s],"float32")}const kWe={kernelName:XT,backendName:"webgl",kernelFunc:NWe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IWe{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,i]=t,[,a,o]=e,l=[r&&a>1?s-1:s,r&&o>1?i-1:i],c=[r&&a>1?a-1:a,r&&o>1?o-1:o],u=l[0]/c[0],d=l[1]/c[1],p=1/u,x=1/d,y=Math.ceil(p)*2+2,v=Math.ceil(x)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${x});

        const int winHeight = int(${y});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RWe(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:a}=r,o=new IWe(i.shape,s.shape,a);return t.runWebGLProgram(o,[i],i.dtype)}const DWe={kernelName:a$,backendName:"webgl",kernelFunc:RWe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $We{constructor(e,t,r,s,i){this.variableNames=["A"],this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,t,r,c];const u=[s&&t>1?o-1:o,s&&r>1?l-1:l],d=[s&&t>1?t-1:t,s&&r>1?r-1:r],p=s?"0.5":"0.0";let x;i?x="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":x="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${x};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LWe{constructor(e,t,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,t,r,c];const u=[s&&t>1?o-1:o,s&&r>1?l-1:l],d=[s&&t>1?t-1:t,s&&r>1?r-1:r],p=s?"0.5":"0.0";let x;i?x="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":x="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${x};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PWe(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r,[l,c]=o,u=Me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new LWe(s.shape,l,c,i,a):new $We(s.shape,l,c,i,a);return t.runWebGLProgram(u,[s],s.dtype)}const OWe={kernelName:KT,backendName:"webgl",kernelFunc:PWe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MWe{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,i]=t,[,a,o]=e,l=[r&&a>1?s-1:s,r&&o>1?i-1:i],c=[r&&a>1?a-1:a,r&&o>1?o-1:o],u=l[0]/c[0],d=l[1]/c[1],p=1/u,x=1/d,y=Math.ceil(p)*2+2,v=Math.ceil(x)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${x});

        const int winHeight = int(${y});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FWe(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:a}=r,o=new MWe(i.shape,s.shape,a);return t.runWebGLProgram(o,[i],i.dtype)}const BWe={kernelName:i$,backendName:"webgl",kernelFunc:FWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zWe{constructor(e,t){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=o=>t.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,i=e.map((o,l)=>s(l)).join(","),a=Sr(r);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jWe{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=Aa("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,a=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,o=Sr(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${i}){
            result.g = ${c(s.slice())};
          }
          if(${a}) {
            result.b = ${u(s.slice())};
            if(${i}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(y){return p(y)}function c(y){return y[r-1]="("+y[r-1]+" + 1)",p(y)}function u(y){return y[r-2]="("+y[r-2]+" + 1)",p(y)}function d(y){return y[r-1]="("+y[r-1]+" + 1)",y[r-2]="("+y[r-2]+" + 1)",p(y)}function p(y){const v=e.map((T,C)=>x(C,y)),b=v.join(","),S=v.slice(-2).join(",");return`getChannel(getX(${b}), vec2(${S}))`}function x(y,v){return t.indexOf(y)!==-1&&e[y]!==1?`${e[y]} - ${v[y]} - 1`:`${v[y]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VWe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dims:i}=r,a=s.shape.length,o=Sn(i,s.shape);if(a===0)return So({inputs:{x:s},backend:t});const l=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jWe(s.shape,o):new zWe(s.shape,o);return t.runWebGLProgram(l,[s],s.dtype)}const UWe={kernelName:YT,backendName:"webgl",kernelFunc:VWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GWe{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof t=="number"?i=`float outputValue = ${t.toFixed(2)};`:i=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HWe={kernelName:f$,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:s,fillValue:i,center:a}=e,o=t,l=new GWe(r.shape,i),[c,u]=J$(a,r.shape[1],r.shape[2]),d=[[c,u,Math.sin(s),Math.cos(s)]];return o.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WWe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,qWe=er({opSnippet:WWe}),KWe={kernelName:rv,backendName:"webgl",kernelFunc:qWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XWe="return inversesqrt(x);",YWe=er({opSnippet:XWe,cpuKernelImpl:c7e}),ZWe={kernelName:sv,backendName:"webgl",kernelFunc:YWe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tL{constructor(e,t,r,s,i,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const c=Sr(i.length),u=Sr(a.length);let d="";r===1?d="i":r===2&&(d="i, j");const p=`getIndices(${d})`;let x="";s===1?x="i":s===2&&(x="i, coords[1]");const y=`getUpdates(${x})`;let v="";l&&(v="coords[0], coords[1]");const b=`getDefaultValue(${v})`,S=t>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${S};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${y};
              found = true;
            }
          }
          setOutput(mix(${b}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QWe{constructor(e,t,r,s,i,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const c=Sr(i.length),u=Sr(a.length);let d="";r===1?d="i":r===2&&(d="i, j");const p=`getIndices(${d})`;let x="";s===1?x="i":s===2&&(x="i, coords[1]");const y=`getUpdates(${x})`;let v="";l&&(v="coords[0], coords[1]");const b=`getDefaultValue(${v})`,S=t>1?"strides[j]":"strides",T=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${p});
              flattenedIndex += index.xz * ${S};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${T};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${y};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${b}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JWe(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s,updates:i}=e,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Lm(i,s,a),p=[d/c,c];if(d===0)return t.makeTensorInfo(a,s.dtype);const x=lt({inputs:{x:s},backend:t,attrs:{shape:[l,o]}}),y=lt({inputs:{x:i},backend:t,attrs:{shape:[l,c]}}),v=t.makeTensorInfo([],"float32",new Float32Array([0]));let b;Me().getBool("WEBGL_PACK")?b=new QWe(l,o,x.shape.length,y.shape.length,u,p):b=new tL(l,o,x.shape.length,y.shape.length,u,p);const S=t.runWebGLProgram(b,[y,x,v],y.dtype),T=lt({inputs:{x:S},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(S),t.disposeIntermediateTensorInfo(v),T}const eqe={kernelName:rY,backendName:"webgl",kernelFunc:JWe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tqe{constructor(e,t,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,o=Me().getNumber("WEBGL_VERSION")===2?i:a,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nqe(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:s,values:i}=e,{side:a}=r,o=new tqe(s.shape[0],s.shape[1],i.shape[1],a),l=[[s.shape[1]]];return t.runWebGLProgram(o,[s,i],"int32",l)}const rqe={kernelName:iY,backendName:"webgl",kernelFunc:nqe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sqe{constructor(e,t,r){this.variableNames=["c","a","b"],this.outputShape=t;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<t.length;u++)c.push(`${o[u]}`),u<e&&l.push(`${o[u]}`);s=l.join(),i=c.join()}const a=Sr(r);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iqe(n){const{inputs:e,backend:t}=n,{condition:r,t:s,e:i}=e,a=new sqe(r.shape.length,s.shape,s.shape.length);return t.runWebGLProgram(a,[r,s,i],wo(s.dtype,i.dtype))}const aqe={kernelName:ZT,backendName:"webgl",kernelFunc:iqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oqe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${xC};
  float scale = ${yC};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,lqe=er({opSnippet:oqe}),cqe={kernelName:iv,backendName:"webgl",kernelFunc:lqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uqe=mx+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,hqe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dqe=er({opSnippet:uqe,packedOpSnippet:hqe,cpuKernelImpl:h7e}),fqe={kernelName:cv,backendName:"webgl",kernelFunc:dqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pqe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,mqe=er({opSnippet:pqe}),gqe={kernelName:lv,backendName:"webgl",kernelFunc:mqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xqe=mx+`
  return sin(x);
`,yqe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Bm}
  return result;
`,bqe=er({opSnippet:xqe,packedOpSnippet:yqe}),vqe={kernelName:av,backendName:"webgl",kernelFunc:bqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _qe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,wqe=er({opSnippet:_qe}),Eqe={kernelName:ov,backendName:"webgl",kernelFunc:wqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sqe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Tqe=er({opSnippet:Sqe}),Cqe={kernelName:uv,backendName:"webgl",kernelFunc:Tqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aqe=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,paddings:a}=r;ue(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=i.reduce((S,T)=>S*T),l=[[0,0]];l.push(...a);for(let S=1+i.length;S<s.shape.length;++S)l.push([0,0]);const c=[],u=xne({inputs:{x:s},backend:t,attrs:{paddings:l,constantValue:0}}),d=Ev(u.shape,i,o,!1),p=Sv(d.length,i.length,!1),x=Tv(u.shape,i,o,!1),y=lt({inputs:{x:u},backend:t,attrs:{shape:d}}),v=Ra({inputs:{x:y},backend:t,attrs:{perm:p}}),b=lt({inputs:{x:v},backend:t,attrs:{shape:x}});return c.push(u),c.push(y),c.push(v),c.forEach(S=>t.disposeIntermediateTensorInfo(S)),b},Nqe={kernelName:eC,backendName:"webgl",kernelFunc:Aqe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kqe(n){const{inputs:e,backend:t}=n,{indices:r,values:s,denseShape:i,defaultValue:a}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=t.readSync(r.dataId),l=t.readSync(s.dataId),c=t.readSync(i.dataId),u=t.readSync(a.dataId)[0],[d,p,x,y,v]=f7e(o,r.shape,r.dtype,l,s.dtype,c,u);return[t.makeTensorInfo(p,r.dtype,d),t.makeTensorInfo([p[0]],s.dtype,x),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(b=>Number(b)))),t.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}const Iqe={kernelName:aY,backendName:"webgl",kernelFunc:kqe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rqe(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const a=Array.from(t.readSync(s.dataId)),o=t.readSync(r.dataId),l=Array.from(t.readSync(i.dataId)),[c,u,d]=p7e(o,r.shape,r.dtype,a,l);return[t.makeTensorInfo(u,r.dtype,c),t.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const Dqe={kernelName:oY,backendName:"webgl",kernelFunc:Rqe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $qe(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const a=t.readSync(r.dataId),o=t.readSync(s.dataId),l=t.readSync(i.dataId),[c,u]=Vte(a,r.shape,r.dtype,o,l,!0);return t.makeTensorInfo(u,r.dtype,c)}const Lqe={kernelName:lY,backendName:"webgl",kernelFunc:$qe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pqe(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const a=t.readSync(r.dataId),o=t.readSync(s.dataId),l=t.readSync(i.dataId),[c,u]=Vte(a,r.shape,r.dtype,o,l);return t.makeTensorInfo(u,r.dtype,c)}const Oqe={kernelName:cY,backendName:"webgl",kernelFunc:Pqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mqe(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:s,sparseValues:i,defaultValue:a}=e,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=Lm(i,s,o),x=!1;if(i.dtype==="string"){const S=t.bufferSync(s),T=t.bufferSync(i),C=yf(t.readSync(a.dataId)[0]),I=u7e(S,T,o,p,u,c,l,d,C,x);return t.makeTensorInfo(o,I.dtype,I.values)}const y=new tL(c,l,s.shape.length,i.shape.length,d,[p,1],x),v=t.runWebGLProgram(y,[i,s,a],i.dtype),b=lt({inputs:{x:v},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(v),b}const Fqe={kernelName:uY,backendName:"webgl",kernelFunc:Mqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bqe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{numOrSizeSplits:i,axis:a}=r,o=Sn(a,s.shape)[0],l=p6(s,i,o),c=s.shape.length,u=new Array(c).fill(0),d=s.shape.slice();return l.map(p=>{const x=[...d];x[o]=p;const y=gx({inputs:{x:s},backend:t,attrs:{begin:u,size:x}});return u[o]+=p,y})}const zqe={kernelName:tC,backendName:"webgl",kernelFunc:Bqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _9="return sqrt(x);",jqe=er({opSnippet:_9,packedOpSnippet:_9,cpuKernelImpl:m7e}),Vqe={kernelName:hv,backendName:"webgl",kernelFunc:jqe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uqe="return x * x;",Gqe=er({opSnippet:Uqe}),Hqe={kernelName:o$,backendName:"webgl",kernelFunc:Gqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w9="return (a - b) * (a - b);",Wqe=zi({opSnippet:w9,packedOpSnippet:w9}),qqe={kernelName:dv,backendName:"webgl",kernelFunc:Wqe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kqe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=t.readSync(s.dataId),a=Dh(i),o=g7e(a,"string",r);return t.makeTensorInfo(s.shape,"string",o)}const Xqe={kernelName:l$,backendName:"webgl",kernelFunc:Kqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yqe({inputs:n,attrs:e,backend:t}){const{x:r}=n,s=Bl+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new tu(r.shape,s);return t.runWebGLProgram(i,[r],r.dtype)}const Zqe={kernelName:xv,backendName:"webgl",kernelFunc:Yqe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qqe{constructor(e,t,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=Sr(r.length),a=Sr(r.length);let o="";if(s===1)o="coords * strides + begin";else{let l=0;o=r.map((c,u)=>(l++,r.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jqe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,end:a,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:x,finalShape:y,isIdentity:v,sliceDim0:b,isSimpleSlice:S,begin:T,end:C,strides:I}=Y$(s.shape,i,a,o,l,c,u,d,p);let $;if(v)$=lt({inputs:{x:s},backend:t,attrs:{shape:y}});else if(b||S){ue(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const U=q$(T,C,I),F=gx({inputs:{x:s},backend:t,attrs:{begin:T,size:U}});$=lt({inputs:{x:F},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(F)}else if(t.shouldExecuteOnCPU([s])){const F=t.readSync(s.dataId),G=En(s.shape,s.dtype,F),V=x7e(x,G,I,T);$=t.makeTensorInfo(y,s.dtype,V.values)}else{const F=new Qqe(T,I,x);$=t.runWebGLProgram(F,[s],s.dtype)}const q=lt({inputs:{x:$},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo($),q}const eKe={kernelName:c$,backendName:"webgl",kernelFunc:Jqe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tKe(n){const{inputs:e,backend:t,attrs:r}=n,{separator:s,nGramWidths:i,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=e,p=t.readSync(u.dataId),x=t.readSync(d.dataId),[y,v]=y7e(p,x,s,i,a,o,l,c);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(d.shape,"int32",v)]}const nKe={kernelName:hY,backendName:"webgl",kernelFunc:tKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rKe(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:s}=r,{input:i,delimiter:a}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=t.readSync(i.dataId),l=t.readSync(a.dataId)[0],[c,u,d]=b7e(o,l,s),p=u.length;return[t.makeTensorInfo([p,2],"int32",c),t.makeTensorInfo([p],"string",u),t.makeTensorInfo([2],"int32",new Int32Array(d))]}const sKe={kernelName:dY,backendName:"webgl",kernelFunc:rKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iKe(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const a=t.readSync(i.dataId),o=v7e(a,s);return t.makeTensorInfo(i.shape,"int32",o)}const aKe={kernelName:fY,backendName:"webgl",kernelFunc:iKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oKe="return tan(x);",lKe=er({opSnippet:oKe}),cKe={kernelName:pv,backendName:"webgl",kernelFunc:lKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uKe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,hKe=er({opSnippet:uKe}),dKe={kernelName:mv,backendName:"webgl",kernelFunc:hKe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fKe(n){const{inputs:e,backend:t,attrs:r}=n,{tensor:s,indices:i,updates:a}=e,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Lm(a,i,s.shape),p=[d/c,c];if(d===0)return t.makeTensorInfo(s.shape,i.dtype);const x=lt({inputs:{x:i},backend:t,attrs:{shape:[l,o]}}),y=lt({inputs:{x:a},backend:t,attrs:{shape:[l,c]}}),v=lt({inputs:{x:s},backend:t,attrs:{shape:p}}),b=new tL(l,o,x.shape.length,y.shape.length,u,p,!1,!0),S=t.runWebGLProgram(b,[y,x,v],v.dtype),T=lt({inputs:{x:S},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(S),T}const pKe={kernelName:sY,backendName:"webgl",kernelFunc:fKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mKe{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[a]*t[a];this.outputShape=r,this.rank=r.length;const s=Sr(this.rank),i=gKe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function gKe(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<n.length;s++)r.push(`imod(${t[s]}, ${n[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const l=t.readSync(s.dataId),c=s.dtype==="string"?l.map(p=>yf(p)):l,u=En(s.shape,s.dtype,c),d=w7e(u,i);return t.makeTensorInfo(d.shape,d.dtype,d.values)}const a=new mKe(s.shape,i);return t.runWebGLProgram(a,[s],s.dtype)}const xKe={kernelName:gv,backendName:"webgl",kernelFunc:bne};class yKe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class bKe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bp(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function E9(n){let e=1;for(;e<n;)e*=2;return e}function vKe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{k:i,sorted:a}=r,o=Me().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Me().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=s.shape,u=c[c.length-1];if(t.shouldExecuteOnCPU([s])||u<o||i>l){const V=t.readSync(s.dataId),[O,K]=E7e(V,c,s.dtype,i,a);return[t.makeTensorInfo(O.shape,O.dtype,O.values),t.makeTensorInfo(K.shape,K.dtype,K.values)]}if(i===0)return c[c.length-1]=0,[t.makeTensorInfo(c,s.dtype,[]),t.makeTensorInfo(c,"int32",[])];if(u===1)return[s,Bv({attrs:{shape:c,dtype:"int32",value:0},backend:t})];const d=t.texData.get(s.dataId),p=d!==null&&d.isPacked,x=p?t.unpackTensor(s):s,v=Ue(c)/u,b=lt({inputs:{x},attrs:{shape:[v,u]},backend:t});p&&bp(t,x);const S=E9(i),T=E9(u);let C=null;const I=()=>C===null?[b,b]:[b,C],$=(V,O,K)=>{const P=I(),N=new yKe(K),B=[[u],[C===null?1:0],[Number.NEGATIVE_INFINITY],[V],[O]],Y=C;C=t.runWebGLProgram(N,P,"int32",B),bp(t,Y)};for(let V=1;V<S;V*=2){const O=V*2;for(let K=V;K>=1;K/=2)$(O,K,[v,T])}for(let V=T;V>S;V/=2){const O=I(),K=new bKe([v,V/2]),N=[[u],[C===null?1:0],[S]],M=C;C=t.runWebGLProgram(K,O,"int32",N),bp(t,M);const B=S/2,Y=B*2;for(let Z=B;Z>=1;Z/=2)$(Y,Z,C.shape)}let q=C;C=gx({inputs:{x:C},backend:t,attrs:{begin:0,size:[v,i]}}),bp(t,q);let U=hne({inputs:{x:b,indices:C},backend:t,attrs:{axis:1,batchDims:1}});bp(t,b);const F=c.slice(0,-1);F.push(i),q=C,C=lt({inputs:{x:C},attrs:{shape:F},backend:t}),bp(t,q);const G=U;return U=lt({inputs:{x:U},attrs:{shape:F},backend:t}),bp(t,G),[U,C]}const _Ke={kernelName:u$,backendName:"webgl",kernelFunc:vKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wKe{constructor(e,t,r,s,i,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const o=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EKe(n){const{inputs:e,backend:t,attrs:r}=n,{image:s,transforms:i}=e,{interpolation:a,fillMode:o,fillValue:l,outputShape:c}=r,[u,d,p,x]=s.shape,[y,v]=c??[d,p],b=[u,y,v,x],S=new wKe(d,p,a,o,l,b);return t.runWebGLProgram(S,[s,i],"float32")}const SKe={kernelName:h$,backendName:"webgl",kernelFunc:EKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TKe(n){const{inputs:e,attrs:t,backend:r}=n,{axis:s}=t,{x:i}=e;Ov(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=r.readSync(i.dataId),{outputValues:o,outputShape:l,indices:c}=S7e(a,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}const CKe={kernelName:d$,backendName:"webgl",kernelFunc:TKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AKe(n){const{inputs:e,backend:t,attrs:r}=n,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const a=s,o=a.shape.length,l=s.shape[i],c=new Array(o-1);let u=0;for(let v=0;v<o;v++)v!==i&&(c[u++]=a.shape[v]);const d=[],p=new Array(o).fill(0),x=a.shape.slice();x[i]=1;const y=new Array(l);for(let v=0;v<y.length;v++){p[i]=v;const b=gx({inputs:{x:a},backend:t,attrs:{begin:p,size:x}}),S=lt({inputs:{x:b},backend:t,attrs:{shape:c}});y[v]=S,d.push(b)}return d.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}const NKe={kernelName:rC,backendName:"webgl",kernelFunc:AKe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kKe{constructor(e,t){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/r);this.outputShape=[s,o];const l="0.0",c="sumValue",u=Math.floor(r/4)*4,d=r%4,p=`
        sumValue += dot(values, segFilter);
    `;let x="";i%r>0&&(x=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let y="";i%r>0&&(y=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${x}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${y}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IKe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,segmentIds:i}=e,{numSegments:a}=r,o=s.shape.length,l=[];let c=0;const u=os([c],o);let d=s;u!=null&&(d=Ra({inputs:{x:s},backend:t,attrs:{perm:u}}),l.push(d),c=Cs(1,o)[0]);const p=eQ(d.shape,c,a),x=Ue([d.shape[c]]),y=lt({inputs:{x:d},backend:t,attrs:{shape:[-1,x]}});l.push(y);const v=p$(s.dtype),b=(I,$,q,U,F)=>{const G=I.shape[0],V=I.shape[1],O=JZ(V,F),K={windowSize:O,inSize:V,batchSize:G,numSegments:F},P=new kKe(K,$),N=t.compileAndRun(P,[I,q],U);if(l.push(N),N.shape[1]===F)return N;const M=yne({backend:t,attrs:{start:0,stop:F,step:1,dtype:"float32"}}),B=bne({inputs:{x:M},backend:t,attrs:{reps:[V/O]}});return l.push(M),l.push(B),b(N,$,B,U,F)},S=b(y,"unsortedSegmentSum",i,v,a),T=lt({inputs:{x:S},backend:t,attrs:{shape:p}});let C=T;if(u!=null){l.push(T);const I=Mf(u);C=Ra({inputs:{x:C},backend:t,attrs:{perm:I}})}return l.forEach(I=>t.disposeIntermediateTensorInfo(I)),C}const RKe={kernelName:sC,backendName:"webgl",kernelFunc:IKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DKe=[mze,xze,vze,Eze,Tze,Nze,Ize,Dze,Oze,Fze,jze,Gze,qze,Zze,eje,nje,sje,lje,uje,dje,gje,Eje,Tje,kje,Rje,Mje,Bje,Uje,Q7e,Wje,Zje,tVe,oVe,uVe,dVe,pVe,gVe,vVe,EVe,CVe,NVe,IVe,DVe,PVe,MVe,jVe,UVe,WVe,XVe,ZVe,tUe,iUe,cUe,dUe,mUe,gUe,yUe,vUe,wUe,SUe,CUe,IUe,$Ue,OUe,FUe,jUe,GUe,KUe,QUe,Z7e,eGe,Xje,rGe,aGe,cGe,eze,fGe,xGe,bGe,EGe,CGe,IGe,$Ge,MGe,jGe,GGe,WGe,YGe,QGe,eHe,sHe,aHe,lHe,uHe,dHe,gHe,vHe,SHe,DHe,rze,OHe,BHe,VHe,HHe,$je,KHe,YHe,QHe,tWe,iWe,nze,oWe,cWe,hWe,fWe,pWe,Lje,NHe,xWe,_We,TWe,ize,kWe,DWe,OWe,BWe,UWe,HWe,KWe,ZWe,eqe,rqe,aqe,cqe,fqe,gqe,vqe,Eqe,_je,IHe,Cqe,Nqe,Iqe,Dqe,Lqe,Oqe,Fqe,zqe,Vqe,Hqe,qqe,Xqe,Zqe,eKe,nKe,sKe,aKe,kHe,dze,cKe,dKe,pKe,xKe,_Ke,SKe,fze,CKe,NKe,RKe,XHe];for(const n of DKe)mY(n);var s2={exports:{}};function $Ke(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var i2={exports:{}},LKe=i2.exports,S9;function tr(){return S9||(S9=1,(function(n,e){(function(t,r){n.exports=r()})(LKe,function(){var t=t||(function(r,s){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof bw<"u"&&bw.crypto&&(i=bw.crypto),!i&&typeof $Ke=="function")try{i=K4}catch{}var a=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||(function(){function T(){}return function(C){var I;return T.prototype=C,I=new T,T.prototype=null,I}})(),l={},c=l.lib={},u=c.Base=(function(){return{extend:function(T){var C=o(this);return T&&C.mixIn(T),(!C.hasOwnProperty("init")||this.init===C.init)&&(C.init=function(){C.$super.init.apply(this,arguments)}),C.init.prototype=C,C.$super=this,C},create:function(){var T=this.extend();return T.init.apply(T,arguments),T},init:function(){},mixIn:function(T){for(var C in T)T.hasOwnProperty(C)&&(this[C]=T[C]);T.hasOwnProperty("toString")&&(this.toString=T.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),d=c.WordArray=u.extend({init:function(T,C){T=this.words=T||[],C!=s?this.sigBytes=C:this.sigBytes=T.length*4},toString:function(T){return(T||x).stringify(this)},concat:function(T){var C=this.words,I=T.words,$=this.sigBytes,q=T.sigBytes;if(this.clamp(),$%4)for(var U=0;U<q;U++){var F=I[U>>>2]>>>24-U%4*8&255;C[$+U>>>2]|=F<<24-($+U)%4*8}else for(var G=0;G<q;G+=4)C[$+G>>>2]=I[G>>>2];return this.sigBytes+=q,this},clamp:function(){var T=this.words,C=this.sigBytes;T[C>>>2]&=4294967295<<32-C%4*8,T.length=r.ceil(C/4)},clone:function(){var T=u.clone.call(this);return T.words=this.words.slice(0),T},random:function(T){for(var C=[],I=0;I<T;I+=4)C.push(a());return new d.init(C,T)}}),p=l.enc={},x=p.Hex={stringify:function(T){for(var C=T.words,I=T.sigBytes,$=[],q=0;q<I;q++){var U=C[q>>>2]>>>24-q%4*8&255;$.push((U>>>4).toString(16)),$.push((U&15).toString(16))}return $.join("")},parse:function(T){for(var C=T.length,I=[],$=0;$<C;$+=2)I[$>>>3]|=parseInt(T.substr($,2),16)<<24-$%8*4;return new d.init(I,C/2)}},y=p.Latin1={stringify:function(T){for(var C=T.words,I=T.sigBytes,$=[],q=0;q<I;q++){var U=C[q>>>2]>>>24-q%4*8&255;$.push(String.fromCharCode(U))}return $.join("")},parse:function(T){for(var C=T.length,I=[],$=0;$<C;$++)I[$>>>2]|=(T.charCodeAt($)&255)<<24-$%4*8;return new d.init(I,C)}},v=p.Utf8={stringify:function(T){try{return decodeURIComponent(escape(y.stringify(T)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(T){return y.parse(unescape(encodeURIComponent(T)))}},b=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(T){typeof T=="string"&&(T=v.parse(T)),this._data.concat(T),this._nDataBytes+=T.sigBytes},_process:function(T){var C,I=this._data,$=I.words,q=I.sigBytes,U=this.blockSize,F=U*4,G=q/F;T?G=r.ceil(G):G=r.max((G|0)-this._minBufferSize,0);var V=G*U,O=r.min(V*4,q);if(V){for(var K=0;K<V;K+=U)this._doProcessBlock($,K);C=$.splice(0,V),I.sigBytes-=O}return new d.init(C,O)},clone:function(){var T=u.clone.call(this);return T._data=this._data.clone(),T},_minBufferSize:0});c.Hasher=b.extend({cfg:u.extend(),init:function(T){this.cfg=this.cfg.extend(T),this.reset()},reset:function(){b.reset.call(this),this._doReset()},update:function(T){return this._append(T),this._process(),this},finalize:function(T){T&&this._append(T);var C=this._doFinalize();return C},blockSize:16,_createHelper:function(T){return function(C,I){return new T.init(I).finalize(C)}},_createHmacHelper:function(T){return function(C,I){return new S.HMAC.init(T,I).finalize(C)}}});var S=l.algo={};return l})(Math);return t})})(i2)),i2.exports}var a2={exports:{}},PKe=a2.exports,T9;function OC(){return T9||(T9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(PKe,function(t){return(function(r){var s=t,i=s.lib,a=i.Base,o=i.WordArray,l=s.x64={};l.Word=a.extend({init:function(c,u){this.high=c,this.low=u}}),l.WordArray=a.extend({init:function(c,u){c=this.words=c||[],u!=r?this.sigBytes=u:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,u=c.length,d=[],p=0;p<u;p++){var x=c[p];d.push(x.high),d.push(x.low)}return o.create(d,this.sigBytes)},clone:function(){for(var c=a.clone.call(this),u=c.words=this.words.slice(0),d=u.length,p=0;p<d;p++)u[p]=u[p].clone();return c}})})(),t})})(a2)),a2.exports}var o2={exports:{}},OKe=o2.exports,C9;function MKe(){return C9||(C9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(OKe,function(t){return(function(){if(typeof ArrayBuffer=="function"){var r=t,s=r.lib,i=s.WordArray,a=i.init,o=i.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],d=0;d<c;d++)u[d>>>2]|=l[d]<<24-d%4*8;a.call(this,u,c)}else a.apply(this,arguments)};o.prototype=i}})(),t.lib.WordArray})})(o2)),o2.exports}var l2={exports:{}},FKe=l2.exports,A9;function BKe(){return A9||(A9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(FKe,function(t){return(function(){var r=t,s=r.lib,i=s.WordArray,a=r.enc;a.Utf16=a.Utf16BE={stringify:function(l){for(var c=l.words,u=l.sigBytes,d=[],p=0;p<u;p+=2){var x=c[p>>>2]>>>16-p%4*8&65535;d.push(String.fromCharCode(x))}return d.join("")},parse:function(l){for(var c=l.length,u=[],d=0;d<c;d++)u[d>>>1]|=l.charCodeAt(d)<<16-d%2*16;return i.create(u,c*2)}},a.Utf16LE={stringify:function(l){for(var c=l.words,u=l.sigBytes,d=[],p=0;p<u;p+=2){var x=o(c[p>>>2]>>>16-p%4*8&65535);d.push(String.fromCharCode(x))}return d.join("")},parse:function(l){for(var c=l.length,u=[],d=0;d<c;d++)u[d>>>1]|=o(l.charCodeAt(d)<<16-d%2*16);return i.create(u,c*2)}};function o(l){return l<<8&4278255360|l>>>8&16711935}})(),t.enc.Utf16})})(l2)),l2.exports}var c2={exports:{}},zKe=c2.exports,N9;function jm(){return N9||(N9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(zKe,function(t){return(function(){var r=t,s=r.lib,i=s.WordArray,a=r.enc;a.Base64={stringify:function(l){var c=l.words,u=l.sigBytes,d=this._map;l.clamp();for(var p=[],x=0;x<u;x+=3)for(var y=c[x>>>2]>>>24-x%4*8&255,v=c[x+1>>>2]>>>24-(x+1)%4*8&255,b=c[x+2>>>2]>>>24-(x+2)%4*8&255,S=y<<16|v<<8|b,T=0;T<4&&x+T*.75<u;T++)p.push(d.charAt(S>>>6*(3-T)&63));var C=d.charAt(64);if(C)for(;p.length%4;)p.push(C);return p.join("")},parse:function(l){var c=l.length,u=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var p=0;p<u.length;p++)d[u.charCodeAt(p)]=p}var x=u.charAt(64);if(x){var y=l.indexOf(x);y!==-1&&(c=y)}return o(l,c,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(l,c,u){for(var d=[],p=0,x=0;x<c;x++)if(x%4){var y=u[l.charCodeAt(x-1)]<<x%4*2,v=u[l.charCodeAt(x)]>>>6-x%4*2,b=y|v;d[p>>>2]|=b<<24-p%4*8,p++}return i.create(d,p)}})(),t.enc.Base64})})(c2)),c2.exports}var u2={exports:{}},jKe=u2.exports,k9;function VKe(){return k9||(k9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(jKe,function(t){return(function(){var r=t,s=r.lib,i=s.WordArray,a=r.enc;a.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var u=l.words,d=l.sigBytes,p=c?this._safe_map:this._map;l.clamp();for(var x=[],y=0;y<d;y+=3)for(var v=u[y>>>2]>>>24-y%4*8&255,b=u[y+1>>>2]>>>24-(y+1)%4*8&255,S=u[y+2>>>2]>>>24-(y+2)%4*8&255,T=v<<16|b<<8|S,C=0;C<4&&y+C*.75<d;C++)x.push(p.charAt(T>>>6*(3-C)&63));var I=p.charAt(64);if(I)for(;x.length%4;)x.push(I);return x.join("")},parse:function(l,c){c===void 0&&(c=!0);var u=l.length,d=c?this._safe_map:this._map,p=this._reverseMap;if(!p){p=this._reverseMap=[];for(var x=0;x<d.length;x++)p[d.charCodeAt(x)]=x}var y=d.charAt(64);if(y){var v=l.indexOf(y);v!==-1&&(u=v)}return o(l,u,p)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function o(l,c,u){for(var d=[],p=0,x=0;x<c;x++)if(x%4){var y=u[l.charCodeAt(x-1)]<<x%4*2,v=u[l.charCodeAt(x)]>>>6-x%4*2,b=y|v;d[p>>>2]|=b<<24-p%4*8,p++}return i.create(d,p)}})(),t.enc.Base64url})})(u2)),u2.exports}var h2={exports:{}},UKe=h2.exports,I9;function Vm(){return I9||(I9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(UKe,function(t){return(function(r){var s=t,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[];(function(){for(var v=0;v<64;v++)c[v]=r.abs(r.sin(v+1))*4294967296|0})();var u=l.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(v,b){for(var S=0;S<16;S++){var T=b+S,C=v[T];v[T]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360}var I=this._hash.words,$=v[b+0],q=v[b+1],U=v[b+2],F=v[b+3],G=v[b+4],V=v[b+5],O=v[b+6],K=v[b+7],P=v[b+8],N=v[b+9],M=v[b+10],B=v[b+11],Y=v[b+12],Z=v[b+13],ne=v[b+14],Q=v[b+15],z=I[0],D=I[1],X=I[2],re=I[3];z=d(z,D,X,re,$,7,c[0]),re=d(re,z,D,X,q,12,c[1]),X=d(X,re,z,D,U,17,c[2]),D=d(D,X,re,z,F,22,c[3]),z=d(z,D,X,re,G,7,c[4]),re=d(re,z,D,X,V,12,c[5]),X=d(X,re,z,D,O,17,c[6]),D=d(D,X,re,z,K,22,c[7]),z=d(z,D,X,re,P,7,c[8]),re=d(re,z,D,X,N,12,c[9]),X=d(X,re,z,D,M,17,c[10]),D=d(D,X,re,z,B,22,c[11]),z=d(z,D,X,re,Y,7,c[12]),re=d(re,z,D,X,Z,12,c[13]),X=d(X,re,z,D,ne,17,c[14]),D=d(D,X,re,z,Q,22,c[15]),z=p(z,D,X,re,q,5,c[16]),re=p(re,z,D,X,O,9,c[17]),X=p(X,re,z,D,B,14,c[18]),D=p(D,X,re,z,$,20,c[19]),z=p(z,D,X,re,V,5,c[20]),re=p(re,z,D,X,M,9,c[21]),X=p(X,re,z,D,Q,14,c[22]),D=p(D,X,re,z,G,20,c[23]),z=p(z,D,X,re,N,5,c[24]),re=p(re,z,D,X,ne,9,c[25]),X=p(X,re,z,D,F,14,c[26]),D=p(D,X,re,z,P,20,c[27]),z=p(z,D,X,re,Z,5,c[28]),re=p(re,z,D,X,U,9,c[29]),X=p(X,re,z,D,K,14,c[30]),D=p(D,X,re,z,Y,20,c[31]),z=x(z,D,X,re,V,4,c[32]),re=x(re,z,D,X,P,11,c[33]),X=x(X,re,z,D,B,16,c[34]),D=x(D,X,re,z,ne,23,c[35]),z=x(z,D,X,re,q,4,c[36]),re=x(re,z,D,X,G,11,c[37]),X=x(X,re,z,D,K,16,c[38]),D=x(D,X,re,z,M,23,c[39]),z=x(z,D,X,re,Z,4,c[40]),re=x(re,z,D,X,$,11,c[41]),X=x(X,re,z,D,F,16,c[42]),D=x(D,X,re,z,O,23,c[43]),z=x(z,D,X,re,N,4,c[44]),re=x(re,z,D,X,Y,11,c[45]),X=x(X,re,z,D,Q,16,c[46]),D=x(D,X,re,z,U,23,c[47]),z=y(z,D,X,re,$,6,c[48]),re=y(re,z,D,X,K,10,c[49]),X=y(X,re,z,D,ne,15,c[50]),D=y(D,X,re,z,V,21,c[51]),z=y(z,D,X,re,Y,6,c[52]),re=y(re,z,D,X,F,10,c[53]),X=y(X,re,z,D,M,15,c[54]),D=y(D,X,re,z,q,21,c[55]),z=y(z,D,X,re,P,6,c[56]),re=y(re,z,D,X,Q,10,c[57]),X=y(X,re,z,D,O,15,c[58]),D=y(D,X,re,z,Z,21,c[59]),z=y(z,D,X,re,G,6,c[60]),re=y(re,z,D,X,B,10,c[61]),X=y(X,re,z,D,U,15,c[62]),D=y(D,X,re,z,N,21,c[63]),I[0]=I[0]+z|0,I[1]=I[1]+D|0,I[2]=I[2]+X|0,I[3]=I[3]+re|0},_doFinalize:function(){var v=this._data,b=v.words,S=this._nDataBytes*8,T=v.sigBytes*8;b[T>>>5]|=128<<24-T%32;var C=r.floor(S/4294967296),I=S;b[(T+64>>>9<<4)+15]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,b[(T+64>>>9<<4)+14]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,v.sigBytes=(b.length+1)*4,this._process();for(var $=this._hash,q=$.words,U=0;U<4;U++){var F=q[U];q[U]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360}return $},clone:function(){var v=o.clone.call(this);return v._hash=this._hash.clone(),v}});function d(v,b,S,T,C,I,$){var q=v+(b&S|~b&T)+C+$;return(q<<I|q>>>32-I)+b}function p(v,b,S,T,C,I,$){var q=v+(b&T|S&~T)+C+$;return(q<<I|q>>>32-I)+b}function x(v,b,S,T,C,I,$){var q=v+(b^S^T)+C+$;return(q<<I|q>>>32-I)+b}function y(v,b,S,T,C,I,$){var q=v+(S^(b|~T))+C+$;return(q<<I|q>>>32-I)+b}s.MD5=o._createHelper(u),s.HmacMD5=o._createHmacHelper(u)})(Math),t.MD5})})(h2)),h2.exports}var d2={exports:{}},GKe=d2.exports,R9;function vne(){return R9||(R9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(GKe,function(t){return(function(){var r=t,s=r.lib,i=s.WordArray,a=s.Hasher,o=r.algo,l=[],c=o.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,d){for(var p=this._hash.words,x=p[0],y=p[1],v=p[2],b=p[3],S=p[4],T=0;T<80;T++){if(T<16)l[T]=u[d+T]|0;else{var C=l[T-3]^l[T-8]^l[T-14]^l[T-16];l[T]=C<<1|C>>>31}var I=(x<<5|x>>>27)+S+l[T];T<20?I+=(y&v|~y&b)+1518500249:T<40?I+=(y^v^b)+1859775393:T<60?I+=(y&v|y&b|v&b)-1894007588:I+=(y^v^b)-899497514,S=b,b=v,v=y<<30|y>>>2,y=x,x=I}p[0]=p[0]+x|0,p[1]=p[1]+y|0,p[2]=p[2]+v|0,p[3]=p[3]+b|0,p[4]=p[4]+S|0},_doFinalize:function(){var u=this._data,d=u.words,p=this._nDataBytes*8,x=u.sigBytes*8;return d[x>>>5]|=128<<24-x%32,d[(x+64>>>9<<4)+14]=Math.floor(p/4294967296),d[(x+64>>>9<<4)+15]=p,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}});r.SHA1=a._createHelper(c),r.HmacSHA1=a._createHmacHelper(c)})(),t.SHA1})})(d2)),d2.exports}var f2={exports:{}},HKe=f2.exports,D9;function nL(){return D9||(D9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(HKe,function(t){return(function(r){var s=t,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[],u=[];(function(){function x(S){for(var T=r.sqrt(S),C=2;C<=T;C++)if(!(S%C))return!1;return!0}function y(S){return(S-(S|0))*4294967296|0}for(var v=2,b=0;b<64;)x(v)&&(b<8&&(c[b]=y(r.pow(v,1/2))),u[b]=y(r.pow(v,1/3)),b++),v++})();var d=[],p=l.SHA256=o.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(x,y){for(var v=this._hash.words,b=v[0],S=v[1],T=v[2],C=v[3],I=v[4],$=v[5],q=v[6],U=v[7],F=0;F<64;F++){if(F<16)d[F]=x[y+F]|0;else{var G=d[F-15],V=(G<<25|G>>>7)^(G<<14|G>>>18)^G>>>3,O=d[F-2],K=(O<<15|O>>>17)^(O<<13|O>>>19)^O>>>10;d[F]=V+d[F-7]+K+d[F-16]}var P=I&$^~I&q,N=b&S^b&T^S&T,M=(b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22),B=(I<<26|I>>>6)^(I<<21|I>>>11)^(I<<7|I>>>25),Y=U+B+P+u[F]+d[F],Z=M+N;U=q,q=$,$=I,I=C+Y|0,C=T,T=S,S=b,b=Y+Z|0}v[0]=v[0]+b|0,v[1]=v[1]+S|0,v[2]=v[2]+T|0,v[3]=v[3]+C|0,v[4]=v[4]+I|0,v[5]=v[5]+$|0,v[6]=v[6]+q|0,v[7]=v[7]+U|0},_doFinalize:function(){var x=this._data,y=x.words,v=this._nDataBytes*8,b=x.sigBytes*8;return y[b>>>5]|=128<<24-b%32,y[(b+64>>>9<<4)+14]=r.floor(v/4294967296),y[(b+64>>>9<<4)+15]=v,x.sigBytes=y.length*4,this._process(),this._hash},clone:function(){var x=o.clone.call(this);return x._hash=this._hash.clone(),x}});s.SHA256=o._createHelper(p),s.HmacSHA256=o._createHmacHelper(p)})(Math),t.SHA256})})(f2)),f2.exports}var p2={exports:{}},WKe=p2.exports,$9;function qKe(){return $9||($9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),nL())})(WKe,function(t){return(function(){var r=t,s=r.lib,i=s.WordArray,a=r.algo,o=a.SHA256,l=a.SHA224=o.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=o._doFinalize.call(this);return c.sigBytes-=4,c}});r.SHA224=o._createHelper(l),r.HmacSHA224=o._createHmacHelper(l)})(),t.SHA224})})(p2)),p2.exports}var m2={exports:{}},KKe=m2.exports,L9;function _ne(){return L9||(L9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),OC())})(KKe,function(t){return(function(){var r=t,s=r.lib,i=s.Hasher,a=r.x64,o=a.Word,l=a.WordArray,c=r.algo;function u(){return o.create.apply(o,arguments)}var d=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],p=[];(function(){for(var y=0;y<80;y++)p[y]=u()})();var x=c.SHA512=i.extend({_doReset:function(){this._hash=new l.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(y,v){for(var b=this._hash.words,S=b[0],T=b[1],C=b[2],I=b[3],$=b[4],q=b[5],U=b[6],F=b[7],G=S.high,V=S.low,O=T.high,K=T.low,P=C.high,N=C.low,M=I.high,B=I.low,Y=$.high,Z=$.low,ne=q.high,Q=q.low,z=U.high,D=U.low,X=F.high,re=F.low,W=G,ae=V,pe=O,de=K,ve=P,Ve=N,ze=M,Ge=B,at=Y,We=Z,nt=ne,Nt=Q,ct=z,xt=D,en=X,ht=re,St=0;St<80;St++){var an,Ot,Mt=p[St];if(St<16)Ot=Mt.high=y[v+St*2]|0,an=Mt.low=y[v+St*2+1]|0;else{var Wn=p[St-15],It=Wn.high,Tt=Wn.low,nr=(It>>>1|Tt<<31)^(It>>>8|Tt<<24)^It>>>7,Bt=(Tt>>>1|It<<31)^(Tt>>>8|It<<24)^(Tt>>>7|It<<25),Cn=p[St-2],Br=Cn.high,xn=Cn.low,tn=(Br>>>19|xn<<13)^(Br<<3|xn>>>29)^Br>>>6,Wr=(xn>>>19|Br<<13)^(xn<<3|Br>>>29)^(xn>>>6|Br<<26),rn=p[St-7],hn=rn.high,es=rn.low,Mn=p[St-16],qn=Mn.high,ms=Mn.low;an=Bt+es,Ot=nr+hn+(an>>>0<Bt>>>0?1:0),an=an+Wr,Ot=Ot+tn+(an>>>0<Wr>>>0?1:0),an=an+ms,Ot=Ot+qn+(an>>>0<ms>>>0?1:0),Mt.high=Ot,Mt.low=an}var Fn=at&nt^~at&ct,Ft=We&Nt^~We&xt,oa=W&pe^W&ve^pe&ve,Rn=ae&de^ae&Ve^de&Ve,Dn=(W>>>28|ae<<4)^(W<<30|ae>>>2)^(W<<25|ae>>>7),yi=(ae>>>28|W<<4)^(ae<<30|W>>>2)^(ae<<25|W>>>7),Kn=(at>>>14|We<<18)^(at>>>18|We<<14)^(at<<23|We>>>9),An=(We>>>14|at<<18)^(We>>>18|at<<14)^(We<<23|at>>>9),bi=d[St],yn=bi.high,zt=bi.low,pn=ht+An,nn=en+Kn+(pn>>>0<ht>>>0?1:0),pn=pn+Ft,nn=nn+Fn+(pn>>>0<Ft>>>0?1:0),pn=pn+zt,nn=nn+yn+(pn>>>0<zt>>>0?1:0),pn=pn+an,nn=nn+Ot+(pn>>>0<an>>>0?1:0),Zt=yi+Rn,dt=Dn+oa+(Zt>>>0<yi>>>0?1:0);en=ct,ht=xt,ct=nt,xt=Nt,nt=at,Nt=We,We=Ge+pn|0,at=ze+nn+(We>>>0<Ge>>>0?1:0)|0,ze=ve,Ge=Ve,ve=pe,Ve=de,pe=W,de=ae,ae=pn+Zt|0,W=nn+dt+(ae>>>0<pn>>>0?1:0)|0}V=S.low=V+ae,S.high=G+W+(V>>>0<ae>>>0?1:0),K=T.low=K+de,T.high=O+pe+(K>>>0<de>>>0?1:0),N=C.low=N+Ve,C.high=P+ve+(N>>>0<Ve>>>0?1:0),B=I.low=B+Ge,I.high=M+ze+(B>>>0<Ge>>>0?1:0),Z=$.low=Z+We,$.high=Y+at+(Z>>>0<We>>>0?1:0),Q=q.low=Q+Nt,q.high=ne+nt+(Q>>>0<Nt>>>0?1:0),D=U.low=D+xt,U.high=z+ct+(D>>>0<xt>>>0?1:0),re=F.low=re+ht,F.high=X+en+(re>>>0<ht>>>0?1:0)},_doFinalize:function(){var y=this._data,v=y.words,b=this._nDataBytes*8,S=y.sigBytes*8;v[S>>>5]|=128<<24-S%32,v[(S+128>>>10<<5)+30]=Math.floor(b/4294967296),v[(S+128>>>10<<5)+31]=b,y.sigBytes=v.length*4,this._process();var T=this._hash.toX32();return T},clone:function(){var y=i.clone.call(this);return y._hash=this._hash.clone(),y},blockSize:1024/32});r.SHA512=i._createHelper(x),r.HmacSHA512=i._createHmacHelper(x)})(),t.SHA512})})(m2)),m2.exports}var g2={exports:{}},XKe=g2.exports,P9;function YKe(){return P9||(P9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),OC(),_ne())})(XKe,function(t){return(function(){var r=t,s=r.x64,i=s.Word,a=s.WordArray,o=r.algo,l=o.SHA512,c=o.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});r.SHA384=l._createHelper(c),r.HmacSHA384=l._createHmacHelper(c)})(),t.SHA384})})(g2)),g2.exports}var x2={exports:{}},ZKe=x2.exports,O9;function QKe(){return O9||(O9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),OC())})(ZKe,function(t){return(function(r){var s=t,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.x64,c=l.Word,u=s.algo,d=[],p=[],x=[];(function(){for(var b=1,S=0,T=0;T<24;T++){d[b+5*S]=(T+1)*(T+2)/2%64;var C=S%5,I=(2*b+3*S)%5;b=C,S=I}for(var b=0;b<5;b++)for(var S=0;S<5;S++)p[b+5*S]=S+(2*b+3*S)%5*5;for(var $=1,q=0;q<24;q++){for(var U=0,F=0,G=0;G<7;G++){if($&1){var V=(1<<G)-1;V<32?F^=1<<V:U^=1<<V-32}$&128?$=$<<1^113:$<<=1}x[q]=c.create(U,F)}})();var y=[];(function(){for(var b=0;b<25;b++)y[b]=c.create()})();var v=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var b=this._state=[],S=0;S<25;S++)b[S]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(b,S){for(var T=this._state,C=this.blockSize/2,I=0;I<C;I++){var $=b[S+2*I],q=b[S+2*I+1];$=($<<8|$>>>24)&16711935|($<<24|$>>>8)&4278255360,q=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360;var U=T[I];U.high^=q,U.low^=$}for(var F=0;F<24;F++){for(var G=0;G<5;G++){for(var V=0,O=0,K=0;K<5;K++){var U=T[G+5*K];V^=U.high,O^=U.low}var P=y[G];P.high=V,P.low=O}for(var G=0;G<5;G++)for(var N=y[(G+4)%5],M=y[(G+1)%5],B=M.high,Y=M.low,V=N.high^(B<<1|Y>>>31),O=N.low^(Y<<1|B>>>31),K=0;K<5;K++){var U=T[G+5*K];U.high^=V,U.low^=O}for(var Z=1;Z<25;Z++){var V,O,U=T[Z],ne=U.high,Q=U.low,z=d[Z];z<32?(V=ne<<z|Q>>>32-z,O=Q<<z|ne>>>32-z):(V=Q<<z-32|ne>>>64-z,O=ne<<z-32|Q>>>64-z);var D=y[p[Z]];D.high=V,D.low=O}var X=y[0],re=T[0];X.high=re.high,X.low=re.low;for(var G=0;G<5;G++)for(var K=0;K<5;K++){var Z=G+5*K,U=T[Z],W=y[Z],ae=y[(G+1)%5+5*K],pe=y[(G+2)%5+5*K];U.high=W.high^~ae.high&pe.high,U.low=W.low^~ae.low&pe.low}var U=T[0],de=x[F];U.high^=de.high,U.low^=de.low}},_doFinalize:function(){var b=this._data,S=b.words;this._nDataBytes*8;var T=b.sigBytes*8,C=this.blockSize*32;S[T>>>5]|=1<<24-T%32,S[(r.ceil((T+1)/C)*C>>>5)-1]|=128,b.sigBytes=S.length*4,this._process();for(var I=this._state,$=this.cfg.outputLength/8,q=$/8,U=[],F=0;F<q;F++){var G=I[F],V=G.high,O=G.low;V=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,O=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,U.push(O),U.push(V)}return new a.init(U,$)},clone:function(){for(var b=o.clone.call(this),S=b._state=this._state.slice(0),T=0;T<25;T++)S[T]=S[T].clone();return b}});s.SHA3=o._createHelper(v),s.HmacSHA3=o._createHmacHelper(v)})(Math),t.SHA3})})(x2)),x2.exports}var y2={exports:{}},JKe=y2.exports,M9;function eXe(){return M9||(M9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(JKe,function(t){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return(function(r){var s=t,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),p=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),x=a.create([0,1518500249,1859775393,2400959708,2840853838]),y=a.create([1352829926,1548603684,1836072691,2053994217,0]),v=l.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(q,U){for(var F=0;F<16;F++){var G=U+F,V=q[G];q[G]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360}var O=this._hash.words,K=x.words,P=y.words,N=c.words,M=u.words,B=d.words,Y=p.words,Z,ne,Q,z,D,X,re,W,ae,pe;X=Z=O[0],re=ne=O[1],W=Q=O[2],ae=z=O[3],pe=D=O[4];for(var de,F=0;F<80;F+=1)de=Z+q[U+N[F]]|0,F<16?de+=b(ne,Q,z)+K[0]:F<32?de+=S(ne,Q,z)+K[1]:F<48?de+=T(ne,Q,z)+K[2]:F<64?de+=C(ne,Q,z)+K[3]:de+=I(ne,Q,z)+K[4],de=de|0,de=$(de,B[F]),de=de+D|0,Z=D,D=z,z=$(Q,10),Q=ne,ne=de,de=X+q[U+M[F]]|0,F<16?de+=I(re,W,ae)+P[0]:F<32?de+=C(re,W,ae)+P[1]:F<48?de+=T(re,W,ae)+P[2]:F<64?de+=S(re,W,ae)+P[3]:de+=b(re,W,ae)+P[4],de=de|0,de=$(de,Y[F]),de=de+pe|0,X=pe,pe=ae,ae=$(W,10),W=re,re=de;de=O[1]+Q+ae|0,O[1]=O[2]+z+pe|0,O[2]=O[3]+D+X|0,O[3]=O[4]+Z+re|0,O[4]=O[0]+ne+W|0,O[0]=de},_doFinalize:function(){var q=this._data,U=q.words,F=this._nDataBytes*8,G=q.sigBytes*8;U[G>>>5]|=128<<24-G%32,U[(G+64>>>9<<4)+14]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360,q.sigBytes=(U.length+1)*4,this._process();for(var V=this._hash,O=V.words,K=0;K<5;K++){var P=O[K];O[K]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return V},clone:function(){var q=o.clone.call(this);return q._hash=this._hash.clone(),q}});function b(q,U,F){return q^U^F}function S(q,U,F){return q&U|~q&F}function T(q,U,F){return(q|~U)^F}function C(q,U,F){return q&F|U&~F}function I(q,U,F){return q^(U|~F)}function $(q,U){return q<<U|q>>>32-U}s.RIPEMD160=o._createHelper(v),s.HmacRIPEMD160=o._createHmacHelper(v)})(),t.RIPEMD160})})(y2)),y2.exports}var b2={exports:{}},tXe=b2.exports,F9;function rL(){return F9||(F9=1,(function(n,e){(function(t,r){n.exports=r(tr())})(tXe,function(t){(function(){var r=t,s=r.lib,i=s.Base,a=r.enc,o=a.Utf8,l=r.algo;l.HMAC=i.extend({init:function(c,u){c=this._hasher=new c.init,typeof u=="string"&&(u=o.parse(u));var d=c.blockSize,p=d*4;u.sigBytes>p&&(u=c.finalize(u)),u.clamp();for(var x=this._oKey=u.clone(),y=this._iKey=u.clone(),v=x.words,b=y.words,S=0;S<d;S++)v[S]^=1549556828,b[S]^=909522486;x.sigBytes=y.sigBytes=p,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var u=this._hasher,d=u.finalize(c);u.reset();var p=u.finalize(this._oKey.clone().concat(d));return p}})})()})})(b2)),b2.exports}var v2={exports:{}},nXe=v2.exports,B9;function rXe(){return B9||(B9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),nL(),rL())})(nXe,function(t){return(function(){var r=t,s=r.lib,i=s.Base,a=s.WordArray,o=r.algo,l=o.SHA256,c=o.HMAC,u=o.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,p){for(var x=this.cfg,y=c.create(x.hasher,d),v=a.create(),b=a.create([1]),S=v.words,T=b.words,C=x.keySize,I=x.iterations;S.length<C;){var $=y.update(p).finalize(b);y.reset();for(var q=$.words,U=q.length,F=$,G=1;G<I;G++){F=y.finalize(F),y.reset();for(var V=F.words,O=0;O<U;O++)q[O]^=V[O]}v.concat($),T[0]++}return v.sigBytes=C*4,v}});r.PBKDF2=function(d,p,x){return u.create(x).compute(d,p)}})(),t.PBKDF2})})(v2)),v2.exports}var _2={exports:{}},sXe=_2.exports,z9;function Gf(){return z9||(z9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),vne(),rL())})(sXe,function(t){return(function(){var r=t,s=r.lib,i=s.Base,a=s.WordArray,o=r.algo,l=o.MD5,c=o.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,d){for(var p,x=this.cfg,y=x.hasher.create(),v=a.create(),b=v.words,S=x.keySize,T=x.iterations;b.length<S;){p&&y.update(p),p=y.update(u).finalize(d),y.reset();for(var C=1;C<T;C++)p=y.finalize(p),y.reset();v.concat(p)}return v.sigBytes=S*4,v}});r.EvpKDF=function(u,d,p){return c.create(p).compute(u,d)}})(),t.EvpKDF})})(_2)),_2.exports}var w2={exports:{}},iXe=w2.exports,j9;function ji(){return j9||(j9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),Gf())})(iXe,function(t){t.lib.Cipher||(function(r){var s=t,i=s.lib,a=i.Base,o=i.WordArray,l=i.BufferedBlockAlgorithm,c=s.enc;c.Utf8;var u=c.Base64,d=s.algo,p=d.EvpKDF,x=i.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(V,O){return this.create(this._ENC_XFORM_MODE,V,O)},createDecryptor:function(V,O){return this.create(this._DEC_XFORM_MODE,V,O)},init:function(V,O,K){this.cfg=this.cfg.extend(K),this._xformMode=V,this._key=O,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(V){return this._append(V),this._process()},finalize:function(V){V&&this._append(V);var O=this._doFinalize();return O},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function V(O){return typeof O=="string"?G:q}return function(O){return{encrypt:function(K,P,N){return V(P).encrypt(O,K,P,N)},decrypt:function(K,P,N){return V(P).decrypt(O,K,P,N)}}}})()});i.StreamCipher=x.extend({_doFinalize:function(){var V=this._process(!0);return V},blockSize:1});var y=s.mode={},v=i.BlockCipherMode=a.extend({createEncryptor:function(V,O){return this.Encryptor.create(V,O)},createDecryptor:function(V,O){return this.Decryptor.create(V,O)},init:function(V,O){this._cipher=V,this._iv=O}}),b=y.CBC=(function(){var V=v.extend();V.Encryptor=V.extend({processBlock:function(K,P){var N=this._cipher,M=N.blockSize;O.call(this,K,P,M),N.encryptBlock(K,P),this._prevBlock=K.slice(P,P+M)}}),V.Decryptor=V.extend({processBlock:function(K,P){var N=this._cipher,M=N.blockSize,B=K.slice(P,P+M);N.decryptBlock(K,P),O.call(this,K,P,M),this._prevBlock=B}});function O(K,P,N){var M,B=this._iv;B?(M=B,this._iv=r):M=this._prevBlock;for(var Y=0;Y<N;Y++)K[P+Y]^=M[Y]}return V})(),S=s.pad={},T=S.Pkcs7={pad:function(V,O){for(var K=O*4,P=K-V.sigBytes%K,N=P<<24|P<<16|P<<8|P,M=[],B=0;B<P;B+=4)M.push(N);var Y=o.create(M,P);V.concat(Y)},unpad:function(V){var O=V.words[V.sigBytes-1>>>2]&255;V.sigBytes-=O}};i.BlockCipher=x.extend({cfg:x.cfg.extend({mode:b,padding:T}),reset:function(){var V;x.reset.call(this);var O=this.cfg,K=O.iv,P=O.mode;this._xformMode==this._ENC_XFORM_MODE?V=P.createEncryptor:(V=P.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==V?this._mode.init(this,K&&K.words):(this._mode=V.call(P,this,K&&K.words),this._mode.__creator=V)},_doProcessBlock:function(V,O){this._mode.processBlock(V,O)},_doFinalize:function(){var V,O=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(O.pad(this._data,this.blockSize),V=this._process(!0)):(V=this._process(!0),O.unpad(V)),V},blockSize:128/32});var C=i.CipherParams=a.extend({init:function(V){this.mixIn(V)},toString:function(V){return(V||this.formatter).stringify(this)}}),I=s.format={},$=I.OpenSSL={stringify:function(V){var O,K=V.ciphertext,P=V.salt;return P?O=o.create([1398893684,1701076831]).concat(P).concat(K):O=K,O.toString(u)},parse:function(V){var O,K=u.parse(V),P=K.words;return P[0]==1398893684&&P[1]==1701076831&&(O=o.create(P.slice(2,4)),P.splice(0,4),K.sigBytes-=16),C.create({ciphertext:K,salt:O})}},q=i.SerializableCipher=a.extend({cfg:a.extend({format:$}),encrypt:function(V,O,K,P){P=this.cfg.extend(P);var N=V.createEncryptor(K,P),M=N.finalize(O),B=N.cfg;return C.create({ciphertext:M,key:K,iv:B.iv,algorithm:V,mode:B.mode,padding:B.padding,blockSize:V.blockSize,formatter:P.format})},decrypt:function(V,O,K,P){P=this.cfg.extend(P),O=this._parse(O,P.format);var N=V.createDecryptor(K,P).finalize(O.ciphertext);return N},_parse:function(V,O){return typeof V=="string"?O.parse(V,this):V}}),U=s.kdf={},F=U.OpenSSL={execute:function(V,O,K,P,N){if(P||(P=o.random(64/8)),N)var M=p.create({keySize:O+K,hasher:N}).compute(V,P);else var M=p.create({keySize:O+K}).compute(V,P);var B=o.create(M.words.slice(O),K*4);return M.sigBytes=O*4,C.create({key:M,iv:B,salt:P})}},G=i.PasswordBasedCipher=q.extend({cfg:q.cfg.extend({kdf:F}),encrypt:function(V,O,K,P){P=this.cfg.extend(P);var N=P.kdf.execute(K,V.keySize,V.ivSize,P.salt,P.hasher);P.iv=N.iv;var M=q.encrypt.call(this,V,O,N.key,P);return M.mixIn(N),M},decrypt:function(V,O,K,P){P=this.cfg.extend(P),O=this._parse(O,P.format);var N=P.kdf.execute(K,V.keySize,V.ivSize,O.salt,P.hasher);P.iv=N.iv;var M=q.decrypt.call(this,V,O,N.key,P);return M}})})()})})(w2)),w2.exports}var E2={exports:{}},aXe=E2.exports,V9;function oXe(){return V9||(V9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(aXe,function(t){return t.mode.CFB=(function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize;s.call(this,i,a,l,o),this._prevBlock=i.slice(a,a+l)}}),r.Decryptor=r.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=i.slice(a,a+l);s.call(this,i,a,l,o),this._prevBlock=c}});function s(i,a,o,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var d=0;d<o;d++)i[a+d]^=c[d]}return r})(),t.mode.CFB})})(E2)),E2.exports}var S2={exports:{}},lXe=S2.exports,U9;function cXe(){return U9||(U9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(lXe,function(t){return t.mode.CTR=(function(){var r=t.lib.BlockCipherMode.extend(),s=r.Encryptor=r.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var d=u.slice(0);o.encryptBlock(d,0),u[l-1]=u[l-1]+1|0;for(var p=0;p<l;p++)i[a+p]^=d[p]}});return r.Decryptor=s,r})(),t.mode.CTR})})(S2)),S2.exports}var T2={exports:{}},uXe=T2.exports,G9;function hXe(){return G9||(G9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(uXe,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=(function(){var r=t.lib.BlockCipherMode.extend();function s(o){if((o>>24&255)===255){var l=o>>16&255,c=o>>8&255,u=o&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,o=0,o+=l<<16,o+=c<<8,o+=u}else o+=1<<24;return o}function i(o){return(o[0]=s(o[0]))===0&&(o[1]=s(o[1])),o}var a=r.Encryptor=r.extend({processBlock:function(o,l){var c=this._cipher,u=c.blockSize,d=this._iv,p=this._counter;d&&(p=this._counter=d.slice(0),this._iv=void 0),i(p);var x=p.slice(0);c.encryptBlock(x,0);for(var y=0;y<u;y++)o[l+y]^=x[y]}});return r.Decryptor=a,r})(),t.mode.CTRGladman})})(T2)),T2.exports}var C2={exports:{}},dXe=C2.exports,H9;function fXe(){return H9||(H9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(dXe,function(t){return t.mode.OFB=(function(){var r=t.lib.BlockCipherMode.extend(),s=r.Encryptor=r.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),o.encryptBlock(u,0);for(var d=0;d<l;d++)i[a+d]^=u[d]}});return r.Decryptor=s,r})(),t.mode.OFB})})(C2)),C2.exports}var A2={exports:{}},pXe=A2.exports,W9;function mXe(){return W9||(W9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(pXe,function(t){return t.mode.ECB=(function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(s,i){this._cipher.encryptBlock(s,i)}}),r.Decryptor=r.extend({processBlock:function(s,i){this._cipher.decryptBlock(s,i)}}),r})(),t.mode.ECB})})(A2)),A2.exports}var N2={exports:{}},gXe=N2.exports,q9;function xXe(){return q9||(q9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(gXe,function(t){return t.pad.AnsiX923={pad:function(r,s){var i=r.sigBytes,a=s*4,o=a-i%a,l=i+o-1;r.clamp(),r.words[l>>>2]|=o<<24-l%4*8,r.sigBytes+=o},unpad:function(r){var s=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=s}},t.pad.Ansix923})})(N2)),N2.exports}var k2={exports:{}},yXe=k2.exports,K9;function bXe(){return K9||(K9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(yXe,function(t){return t.pad.Iso10126={pad:function(r,s){var i=s*4,a=i-r.sigBytes%i;r.concat(t.lib.WordArray.random(a-1)).concat(t.lib.WordArray.create([a<<24],1))},unpad:function(r){var s=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=s}},t.pad.Iso10126})})(k2)),k2.exports}var I2={exports:{}},vXe=I2.exports,X9;function _Xe(){return X9||(X9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(vXe,function(t){return t.pad.Iso97971={pad:function(r,s){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,s)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})})(I2)),I2.exports}var R2={exports:{}},wXe=R2.exports,Y9;function EXe(){return Y9||(Y9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(wXe,function(t){return t.pad.ZeroPadding={pad:function(r,s){var i=s*4;r.clamp(),r.sigBytes+=i-(r.sigBytes%i||i)},unpad:function(r){for(var s=r.words,i=r.sigBytes-1,i=r.sigBytes-1;i>=0;i--)if(s[i>>>2]>>>24-i%4*8&255){r.sigBytes=i+1;break}}},t.pad.ZeroPadding})})(R2)),R2.exports}var D2={exports:{}},SXe=D2.exports,Z9;function TXe(){return Z9||(Z9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(SXe,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})})(D2)),D2.exports}var $2={exports:{}},CXe=$2.exports,Q9;function AXe(){return Q9||(Q9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),ji())})(CXe,function(t){return(function(r){var s=t,i=s.lib,a=i.CipherParams,o=s.enc,l=o.Hex,c=s.format;c.Hex={stringify:function(u){return u.ciphertext.toString(l)},parse:function(u){var d=l.parse(u);return a.create({ciphertext:d})}}})(),t.format.Hex})})($2)),$2.exports}var L2={exports:{}},NXe=L2.exports,J9;function kXe(){return J9||(J9=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),jm(),Vm(),Gf(),ji())})(NXe,function(t){return(function(){var r=t,s=r.lib,i=s.BlockCipher,a=r.algo,o=[],l=[],c=[],u=[],d=[],p=[],x=[],y=[],v=[],b=[];(function(){for(var C=[],I=0;I<256;I++)I<128?C[I]=I<<1:C[I]=I<<1^283;for(var $=0,q=0,I=0;I<256;I++){var U=q^q<<1^q<<2^q<<3^q<<4;U=U>>>8^U&255^99,o[$]=U,l[U]=$;var F=C[$],G=C[F],V=C[G],O=C[U]*257^U*16843008;c[$]=O<<24|O>>>8,u[$]=O<<16|O>>>16,d[$]=O<<8|O>>>24,p[$]=O;var O=V*16843009^G*65537^F*257^$*16843008;x[U]=O<<24|O>>>8,y[U]=O<<16|O>>>16,v[U]=O<<8|O>>>24,b[U]=O,$?($=F^C[C[C[V^F]]],q^=C[C[q]]):$=q=1}})();var S=[0,1,2,4,8,16,32,64,128,27,54],T=a.AES=i.extend({_doReset:function(){var C;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var I=this._keyPriorReset=this._key,$=I.words,q=I.sigBytes/4,U=this._nRounds=q+6,F=(U+1)*4,G=this._keySchedule=[],V=0;V<F;V++)V<q?G[V]=$[V]:(C=G[V-1],V%q?q>6&&V%q==4&&(C=o[C>>>24]<<24|o[C>>>16&255]<<16|o[C>>>8&255]<<8|o[C&255]):(C=C<<8|C>>>24,C=o[C>>>24]<<24|o[C>>>16&255]<<16|o[C>>>8&255]<<8|o[C&255],C^=S[V/q|0]<<24),G[V]=G[V-q]^C);for(var O=this._invKeySchedule=[],K=0;K<F;K++){var V=F-K;if(K%4)var C=G[V];else var C=G[V-4];K<4||V<=4?O[K]=C:O[K]=x[o[C>>>24]]^y[o[C>>>16&255]]^v[o[C>>>8&255]]^b[o[C&255]]}}},encryptBlock:function(C,I){this._doCryptBlock(C,I,this._keySchedule,c,u,d,p,o)},decryptBlock:function(C,I){var $=C[I+1];C[I+1]=C[I+3],C[I+3]=$,this._doCryptBlock(C,I,this._invKeySchedule,x,y,v,b,l);var $=C[I+1];C[I+1]=C[I+3],C[I+3]=$},_doCryptBlock:function(C,I,$,q,U,F,G,V){for(var O=this._nRounds,K=C[I]^$[0],P=C[I+1]^$[1],N=C[I+2]^$[2],M=C[I+3]^$[3],B=4,Y=1;Y<O;Y++){var Z=q[K>>>24]^U[P>>>16&255]^F[N>>>8&255]^G[M&255]^$[B++],ne=q[P>>>24]^U[N>>>16&255]^F[M>>>8&255]^G[K&255]^$[B++],Q=q[N>>>24]^U[M>>>16&255]^F[K>>>8&255]^G[P&255]^$[B++],z=q[M>>>24]^U[K>>>16&255]^F[P>>>8&255]^G[N&255]^$[B++];K=Z,P=ne,N=Q,M=z}var Z=(V[K>>>24]<<24|V[P>>>16&255]<<16|V[N>>>8&255]<<8|V[M&255])^$[B++],ne=(V[P>>>24]<<24|V[N>>>16&255]<<16|V[M>>>8&255]<<8|V[K&255])^$[B++],Q=(V[N>>>24]<<24|V[M>>>16&255]<<16|V[K>>>8&255]<<8|V[P&255])^$[B++],z=(V[M>>>24]<<24|V[K>>>16&255]<<16|V[P>>>8&255]<<8|V[N&255])^$[B++];C[I]=Z,C[I+1]=ne,C[I+2]=Q,C[I+3]=z},keySize:256/32});r.AES=i._createHelper(T)})(),t.AES})})(L2)),L2.exports}var P2={exports:{}},IXe=P2.exports,e7;function RXe(){return e7||(e7=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),jm(),Vm(),Gf(),ji())})(IXe,function(t){return(function(){var r=t,s=r.lib,i=s.WordArray,a=s.BlockCipher,o=r.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],p=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],x=o.DES=a.extend({_doReset:function(){for(var S=this._key,T=S.words,C=[],I=0;I<56;I++){var $=l[I]-1;C[I]=T[$>>>5]>>>31-$%32&1}for(var q=this._subKeys=[],U=0;U<16;U++){for(var F=q[U]=[],G=u[U],I=0;I<24;I++)F[I/6|0]|=C[(c[I]-1+G)%28]<<31-I%6,F[4+(I/6|0)]|=C[28+(c[I+24]-1+G)%28]<<31-I%6;F[0]=F[0]<<1|F[0]>>>31;for(var I=1;I<7;I++)F[I]=F[I]>>>(I-1)*4+3;F[7]=F[7]<<5|F[7]>>>27}for(var V=this._invSubKeys=[],I=0;I<16;I++)V[I]=q[15-I]},encryptBlock:function(S,T){this._doCryptBlock(S,T,this._subKeys)},decryptBlock:function(S,T){this._doCryptBlock(S,T,this._invSubKeys)},_doCryptBlock:function(S,T,C){this._lBlock=S[T],this._rBlock=S[T+1],y.call(this,4,252645135),y.call(this,16,65535),v.call(this,2,858993459),v.call(this,8,16711935),y.call(this,1,1431655765);for(var I=0;I<16;I++){for(var $=C[I],q=this._lBlock,U=this._rBlock,F=0,G=0;G<8;G++)F|=d[G][((U^$[G])&p[G])>>>0];this._lBlock=U,this._rBlock=q^F}var V=this._lBlock;this._lBlock=this._rBlock,this._rBlock=V,y.call(this,1,1431655765),v.call(this,8,16711935),v.call(this,2,858993459),y.call(this,16,65535),y.call(this,4,252645135),S[T]=this._lBlock,S[T+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function y(S,T){var C=(this._lBlock>>>S^this._rBlock)&T;this._rBlock^=C,this._lBlock^=C<<S}function v(S,T){var C=(this._rBlock>>>S^this._lBlock)&T;this._lBlock^=C,this._rBlock^=C<<S}r.DES=a._createHelper(x);var b=o.TripleDES=a.extend({_doReset:function(){var S=this._key,T=S.words;if(T.length!==2&&T.length!==4&&T.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var C=T.slice(0,2),I=T.length<4?T.slice(0,2):T.slice(2,4),$=T.length<6?T.slice(0,2):T.slice(4,6);this._des1=x.createEncryptor(i.create(C)),this._des2=x.createEncryptor(i.create(I)),this._des3=x.createEncryptor(i.create($))},encryptBlock:function(S,T){this._des1.encryptBlock(S,T),this._des2.decryptBlock(S,T),this._des3.encryptBlock(S,T)},decryptBlock:function(S,T){this._des3.decryptBlock(S,T),this._des2.encryptBlock(S,T),this._des1.decryptBlock(S,T)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=a._createHelper(b)})(),t.TripleDES})})(P2)),P2.exports}var O2={exports:{}},DXe=O2.exports,t7;function $Xe(){return t7||(t7=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),jm(),Vm(),Gf(),ji())})(DXe,function(t){return(function(){var r=t,s=r.lib,i=s.StreamCipher,a=r.algo,o=a.RC4=i.extend({_doReset:function(){for(var u=this._key,d=u.words,p=u.sigBytes,x=this._S=[],y=0;y<256;y++)x[y]=y;for(var y=0,v=0;y<256;y++){var b=y%p,S=d[b>>>2]>>>24-b%4*8&255;v=(v+x[y]+S)%256;var T=x[y];x[y]=x[v],x[v]=T}this._i=this._j=0},_doProcessBlock:function(u,d){u[d]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,d=this._i,p=this._j,x=0,y=0;y<4;y++){d=(d+1)%256,p=(p+u[d])%256;var v=u[d];u[d]=u[p],u[p]=v,x|=u[(u[d]+u[p])%256]<<24-y*8}return this._i=d,this._j=p,x}r.RC4=i._createHelper(o);var c=a.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});r.RC4Drop=i._createHelper(c)})(),t.RC4})})(O2)),O2.exports}var M2={exports:{}},LXe=M2.exports,n7;function PXe(){return n7||(n7=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),jm(),Vm(),Gf(),ji())})(LXe,function(t){return(function(){var r=t,s=r.lib,i=s.StreamCipher,a=r.algo,o=[],l=[],c=[],u=a.Rabbit=i.extend({_doReset:function(){for(var p=this._key.words,x=this.cfg.iv,y=0;y<4;y++)p[y]=(p[y]<<8|p[y]>>>24)&16711935|(p[y]<<24|p[y]>>>8)&4278255360;var v=this._X=[p[0],p[3]<<16|p[2]>>>16,p[1],p[0]<<16|p[3]>>>16,p[2],p[1]<<16|p[0]>>>16,p[3],p[2]<<16|p[1]>>>16],b=this._C=[p[2]<<16|p[2]>>>16,p[0]&4294901760|p[1]&65535,p[3]<<16|p[3]>>>16,p[1]&4294901760|p[2]&65535,p[0]<<16|p[0]>>>16,p[2]&4294901760|p[3]&65535,p[1]<<16|p[1]>>>16,p[3]&4294901760|p[0]&65535];this._b=0;for(var y=0;y<4;y++)d.call(this);for(var y=0;y<8;y++)b[y]^=v[y+4&7];if(x){var S=x.words,T=S[0],C=S[1],I=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,$=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,q=I>>>16|$&4294901760,U=$<<16|I&65535;b[0]^=I,b[1]^=q,b[2]^=$,b[3]^=U,b[4]^=I,b[5]^=q,b[6]^=$,b[7]^=U;for(var y=0;y<4;y++)d.call(this)}},_doProcessBlock:function(p,x){var y=this._X;d.call(this),o[0]=y[0]^y[5]>>>16^y[3]<<16,o[1]=y[2]^y[7]>>>16^y[5]<<16,o[2]=y[4]^y[1]>>>16^y[7]<<16,o[3]=y[6]^y[3]>>>16^y[1]<<16;for(var v=0;v<4;v++)o[v]=(o[v]<<8|o[v]>>>24)&16711935|(o[v]<<24|o[v]>>>8)&4278255360,p[x+v]^=o[v]},blockSize:128/32,ivSize:64/32});function d(){for(var p=this._X,x=this._C,y=0;y<8;y++)l[y]=x[y];x[0]=x[0]+1295307597+this._b|0,x[1]=x[1]+3545052371+(x[0]>>>0<l[0]>>>0?1:0)|0,x[2]=x[2]+886263092+(x[1]>>>0<l[1]>>>0?1:0)|0,x[3]=x[3]+1295307597+(x[2]>>>0<l[2]>>>0?1:0)|0,x[4]=x[4]+3545052371+(x[3]>>>0<l[3]>>>0?1:0)|0,x[5]=x[5]+886263092+(x[4]>>>0<l[4]>>>0?1:0)|0,x[6]=x[6]+1295307597+(x[5]>>>0<l[5]>>>0?1:0)|0,x[7]=x[7]+3545052371+(x[6]>>>0<l[6]>>>0?1:0)|0,this._b=x[7]>>>0<l[7]>>>0?1:0;for(var y=0;y<8;y++){var v=p[y]+x[y],b=v&65535,S=v>>>16,T=((b*b>>>17)+b*S>>>15)+S*S,C=((v&4294901760)*v|0)+((v&65535)*v|0);c[y]=T^C}p[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,p[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,p[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,p[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,p[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,p[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,p[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,p[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.Rabbit=i._createHelper(u)})(),t.Rabbit})})(M2)),M2.exports}var F2={exports:{}},OXe=F2.exports,r7;function MXe(){return r7||(r7=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),jm(),Vm(),Gf(),ji())})(OXe,function(t){return(function(){var r=t,s=r.lib,i=s.StreamCipher,a=r.algo,o=[],l=[],c=[],u=a.RabbitLegacy=i.extend({_doReset:function(){var p=this._key.words,x=this.cfg.iv,y=this._X=[p[0],p[3]<<16|p[2]>>>16,p[1],p[0]<<16|p[3]>>>16,p[2],p[1]<<16|p[0]>>>16,p[3],p[2]<<16|p[1]>>>16],v=this._C=[p[2]<<16|p[2]>>>16,p[0]&4294901760|p[1]&65535,p[3]<<16|p[3]>>>16,p[1]&4294901760|p[2]&65535,p[0]<<16|p[0]>>>16,p[2]&4294901760|p[3]&65535,p[1]<<16|p[1]>>>16,p[3]&4294901760|p[0]&65535];this._b=0;for(var b=0;b<4;b++)d.call(this);for(var b=0;b<8;b++)v[b]^=y[b+4&7];if(x){var S=x.words,T=S[0],C=S[1],I=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,$=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,q=I>>>16|$&4294901760,U=$<<16|I&65535;v[0]^=I,v[1]^=q,v[2]^=$,v[3]^=U,v[4]^=I,v[5]^=q,v[6]^=$,v[7]^=U;for(var b=0;b<4;b++)d.call(this)}},_doProcessBlock:function(p,x){var y=this._X;d.call(this),o[0]=y[0]^y[5]>>>16^y[3]<<16,o[1]=y[2]^y[7]>>>16^y[5]<<16,o[2]=y[4]^y[1]>>>16^y[7]<<16,o[3]=y[6]^y[3]>>>16^y[1]<<16;for(var v=0;v<4;v++)o[v]=(o[v]<<8|o[v]>>>24)&16711935|(o[v]<<24|o[v]>>>8)&4278255360,p[x+v]^=o[v]},blockSize:128/32,ivSize:64/32});function d(){for(var p=this._X,x=this._C,y=0;y<8;y++)l[y]=x[y];x[0]=x[0]+1295307597+this._b|0,x[1]=x[1]+3545052371+(x[0]>>>0<l[0]>>>0?1:0)|0,x[2]=x[2]+886263092+(x[1]>>>0<l[1]>>>0?1:0)|0,x[3]=x[3]+1295307597+(x[2]>>>0<l[2]>>>0?1:0)|0,x[4]=x[4]+3545052371+(x[3]>>>0<l[3]>>>0?1:0)|0,x[5]=x[5]+886263092+(x[4]>>>0<l[4]>>>0?1:0)|0,x[6]=x[6]+1295307597+(x[5]>>>0<l[5]>>>0?1:0)|0,x[7]=x[7]+3545052371+(x[6]>>>0<l[6]>>>0?1:0)|0,this._b=x[7]>>>0<l[7]>>>0?1:0;for(var y=0;y<8;y++){var v=p[y]+x[y],b=v&65535,S=v>>>16,T=((b*b>>>17)+b*S>>>15)+S*S,C=((v&4294901760)*v|0)+((v&65535)*v|0);c[y]=T^C}p[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,p[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,p[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,p[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,p[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,p[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,p[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,p[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.RabbitLegacy=i._createHelper(u)})(),t.RabbitLegacy})})(F2)),F2.exports}var B2={exports:{}},FXe=B2.exports,s7;function BXe(){return s7||(s7=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),jm(),Vm(),Gf(),ji())})(FXe,function(t){return(function(){var r=t,s=r.lib,i=s.BlockCipher,a=r.algo;const o=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function d(b,S){let T=S>>24&255,C=S>>16&255,I=S>>8&255,$=S&255,q=b.sbox[0][T]+b.sbox[1][C];return q=q^b.sbox[2][I],q=q+b.sbox[3][$],q}function p(b,S,T){let C=S,I=T,$;for(let q=0;q<o;++q)C=C^b.pbox[q],I=d(b,C)^I,$=C,C=I,I=$;return $=C,C=I,I=$,I=I^b.pbox[o],C=C^b.pbox[o+1],{left:C,right:I}}function x(b,S,T){let C=S,I=T,$;for(let q=o+1;q>1;--q)C=C^b.pbox[q],I=d(b,C)^I,$=C,C=I,I=$;return $=C,C=I,I=$,I=I^b.pbox[1],C=C^b.pbox[0],{left:C,right:I}}function y(b,S,T){for(let U=0;U<4;U++){b.sbox[U]=[];for(let F=0;F<256;F++)b.sbox[U][F]=c[U][F]}let C=0;for(let U=0;U<o+2;U++)b.pbox[U]=l[U]^S[C],C++,C>=T&&(C=0);let I=0,$=0,q=0;for(let U=0;U<o+2;U+=2)q=p(b,I,$),I=q.left,$=q.right,b.pbox[U]=I,b.pbox[U+1]=$;for(let U=0;U<4;U++)for(let F=0;F<256;F+=2)q=p(b,I,$),I=q.left,$=q.right,b.sbox[U][F]=I,b.sbox[U][F+1]=$;return!0}var v=a.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var b=this._keyPriorReset=this._key,S=b.words,T=b.sigBytes/4;y(u,S,T)}},encryptBlock:function(b,S){var T=p(u,b[S],b[S+1]);b[S]=T.left,b[S+1]=T.right},decryptBlock:function(b,S){var T=x(u,b[S],b[S+1]);b[S]=T.left,b[S+1]=T.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=i._createHelper(v)})(),t.Blowfish})})(B2)),B2.exports}var zXe=s2.exports,i7;function jXe(){return i7||(i7=1,(function(n,e){(function(t,r,s){n.exports=r(tr(),OC(),MKe(),BKe(),jm(),VKe(),Vm(),vne(),nL(),qKe(),_ne(),YKe(),QKe(),eXe(),rL(),rXe(),Gf(),ji(),oXe(),cXe(),hXe(),fXe(),mXe(),xXe(),bXe(),_Xe(),EXe(),TXe(),AXe(),kXe(),RXe(),$Xe(),PXe(),MXe(),BXe())})(zXe,function(t){return t})})(s2)),s2.exports}var VXe=jXe();const UXe=ku(VXe),GXe="someSuperSecretString123!";function HXe(){const n=Sp.createRandom(),e=UXe.AES.encrypt(n.privateKey,GXe).toString();return{address:n.address,encryptedPrivateKey:e}}function WXe(){const[n,e]=Se.useState([]),[t,r]=Se.useState(null),[s,i]=Se.useState(1),[a,o]=Se.useState(""),[l,c]=Se.useState(""),u=Se.useRef(null),d=Se.useRef(null),p=Se.useRef([]),x=Se.useRef(null),y=Se.useRef(null),v=Se.useRef([]),[b,S]=Se.useState(null),[T,C]=Se.useState("Model not loaded"),[I,$]=Se.useState([]);Se.useEffect(()=>{(async()=>{const Y=(await lh(uf(Xi,"projects"))).docs.map(Z=>({id:Z.id,...Z.data()}));e(Y)})()},[]);const q=async M=>{if(!t)return alert("No project selected!");const B=yu(Xi,"projects",t.id),Y={step:`Step ${s}`,reviewer:"Admin User",date:new Date().toISOString().split("T")[0],status:M,notes:a},Z=M==="approved"?"verified":M==="rejected"?"rejected":"under_review";try{await G0(B,{status:Z,verificationHistory:[...t.verificationHistory||[],Y]}),e(ne=>ne.map(Q=>Q.id===t.id?{...Q,status:Z,verificationHistory:[...Q.verificationHistory||[],Y]}:Q)),r(ne=>({...ne,status:Z,verificationHistory:[...ne.verificationHistory||[],Y]})),o(""),i(ne=>ne+1),alert(`Project ${M} successfully!`)}catch(ne){console.error("Firestore update failed:",ne),alert("Failed to update project. Check console for details.")}},U=async()=>{if(!t||t.status!=="verified"){alert("Credits can only be generated for a verified project.");return}const M=parseFloat(l);if(isNaN(M)||M<=0){alert("Please enter a valid number of credits to generate.");return}try{const B=yu(Xi,"projects",t.id);let Z=(await DS(B)).data().farmerWalletAddress;if(!Z){const X=HXe();Z=X.address,await G0(B,{farmerWalletAddress:X.address,farmerWalletPrivateKey:X.encryptedPrivateKey}),console.log(`Custodial wallet created for farmer: ${Z}`)}const ne=await TU(),Q=t.numericId;if(typeof Q!="number")throw new Error("Project must have a numericId in Firestore.");t.onChain||(console.log(`Registering project ${Q} on-chain...`),await(await ne.addProject(Q)).wait(),await G0(B,{onChain:!0}),console.log(`Project ${Q} registered on blockchain ✅`));const z=st.from(Math.floor(M).toString()),D=await ne.generateCredits(Z,Q,z);await D.wait(),await G0(B,{creditsGenerated:(t.creditsGenerated||0)+M,blockchainTx:D.hash}),e(X=>X.map(re=>re.id===t.id?{...re,creditsGenerated:(re.creditsGenerated||0)+M,onChain:!0}:re)),r(X=>({...X,creditsGenerated:(X.creditsGenerated||0)+M,onChain:!0})),c(""),alert(`${M} carbon credits successfully generated on blockchain!`)}catch(B){console.error("❌ Failed to generate credits:",B),alert("Failed to generate credits. Check console for details.")}},F=M=>{switch(M){case"pending":return"status-badge pending";case"under_review":return"status-badge active";case"verified":return"status-badge verified";case"rejected":return"status-badge rejected";default:return"status-badge no-reports"}},G=M=>{switch(M){case"pending":return"Pending Review";case"under_review":return"Under Review";case"verified":return"Verified";case"rejected":return"Rejected";default:return"Unknown"}};async function V(){C("Loading model...");try{const M=await XCe({base:"ade20k",quantizationBytes:2});S(M),C("✅ Model loaded (ADE20K)!")}catch(M){console.error("Failed to load model:",M),C("❌ Failed to load model")}}function O(M){try{const B=document.createElement("canvas"),Y=B.getContext("2d");B.width=M.naturalWidth||M.width,B.height=M.naturalHeight||M.height,Y.drawImage(M,0,0);const{data:Z}=Y.getImageData(0,0,B.width,B.height);let ne=0;const Q=B.width*B.height;for(let D=0;D<Z.length;D+=4){const X=Z[D],re=Z[D+1],W=Z[D+2];2*re-X-W>20&&ne++}const z=(ne/Q*100).toFixed(1);return{percentage:parseFloat(z),greenPixels:ne,totalPixels:Q}}catch(B){return console.error("ExG calculation failed:",B),{percentage:0,greenPixels:0,totalPixels:0}}}async function K(M,B,Y,Z){if(!B){N(Z,`❌ ${M}: Image not found`);return}if(!b)return P(M,B,Z);C(`Analyzing ${M}...`);try{const ne=await b.segment(B),Q=ne.data||ne.segmentationMap,z=[21,22,47,66,120];let D=0;for(let pe=0;pe<Q.length;pe++)z.includes(Q[pe])&&D++;const X=D/Q.length*100,re=Y.current,W=re.getContext("2d");re.width=ne.width,re.height=ne.height;const ae=W.createImageData(re.width,re.height);for(let pe=0;pe<Q.length;pe++){const de=pe*4;z.includes(Q[pe])?(ae.data[de]=0,ae.data[de+1]=255,ae.data[de+2]=0,ae.data[de+3]=120):ae.data[de+3]=0}if(W.putImageData(ae,0,0),X>1)N(Z,`✅ ${M}: Vegetation detected (${X.toFixed(1)}% via ADE20K)`);else return P(M,B,Z);C("✅ Done")}catch(ne){return console.error("AI analysis failed, falling back to ExG:",ne),P(M,B,Z)}}async function P(M,B,Y){try{B.complete||await new Promise((D,X)=>{B.onload=D,B.onerror=X,setTimeout(X,5e3)});const Z=O(B),ne=Z.percentage>15?"High vegetation coverage":Z.percentage>5?"Moderate vegetation coverage":"Low vegetation coverage",z=`${Z.percentage>15?"🌿":Z.percentage>5?"🌱":"🟫"} ${M}: ${Z.percentage}% green coverage (${Z.greenPixels.toLocaleString()}/${Z.totalPixels.toLocaleString()} pixels) - ${ne}`;N(Y,z),C("✅ ExG analysis complete")}catch(Z){console.error(`ExG analysis failed for ${M}:`,Z),N(Y,`❌ ${M}: ExG analysis failed`),C("❌ ExG analysis failed")}}function N(M,B){$(Y=>{const Z=[...Y];return Z[M]=B,Z})}return _.jsxs("div",{className:"page-container",children:[_.jsxs("div",{className:"page-header",children:[_.jsx("h1",{className:"page-title",children:"🌱 Project Verification Dashboard"}),_.jsx("p",{className:"page-subtitle",children:"Review submitted blue carbon projects and update verification status"})]}),_.jsxs("div",{className:"verification-layout",children:[_.jsxs("div",{className:"projects-sidebar",children:[_.jsxs("h3",{children:["Projects (",n.length,")"]}),_.jsx("div",{className:"projects-list",children:n.map(M=>_.jsxs("div",{className:`project-tile ${t?.id===M.id?"selected":""}`,onClick:()=>{r(M),i(1),o(""),$([]),p.current=[],v.current=[]},children:[_.jsxs("div",{className:"tile-header",children:[_.jsx("h4",{children:M.projectName||M.name}),_.jsx("span",{className:F(M.status),children:G(M.status)})]}),_.jsxs("div",{className:"tile-info",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Type:"})," ",M.projectType||M.type]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Location:"})," ",M.location]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Area:"})," ",M.area||"-"," ha"]})]})]},M.id))})]}),t?_.jsxs("div",{className:"project-details-panel",children:[_.jsxs("div",{className:"project-overview",children:[_.jsx("h2",{children:t.projectName||"-"}),_.jsx("span",{className:F(t.status),children:G(t.status)}),_.jsxs("div",{className:"overview-grid",children:[_.jsxs("div",{className:"overview-item",children:[_.jsx("label",{children:"Type"}),t.projectType||"-"]}),_.jsxs("div",{className:"overview-item",children:[_.jsx("label",{children:"Location"}),t.location||"-"]}),_.jsxs("div",{className:"overview-item",children:[_.jsx("label",{children:"Area"}),t.area||"-"," ha"]}),_.jsxs("div",{className:"overview-item",children:[_.jsx("label",{children:"Expected Credits"}),t.expectedCredits||"-"," tons CO₂"]}),_.jsxs("div",{className:"overview-item",children:[_.jsx("label",{children:"Timeline"}),t.timeline||"-"]}),_.jsxs("div",{className:"overview-item",children:[_.jsx("label",{children:"Methodology"}),t.methodology||"-"]}),_.jsxs("div",{className:"overview-item",children:[_.jsx("label",{children:"Coordinates"}),t.coordinates||"-"]}),_.jsxs("div",{className:"overview-item",children:[_.jsx("label",{children:"Generated Credits"}),t.creditsGenerated||"-"," tons CO₂"]}),_.jsxs("div",{className:"overview-item",children:[_.jsx("label",{children:"Blockchain Tx ID"}),_.jsx("span",{className:"tx-id",children:t.blockchainTx||"-"})]})]}),_.jsxs("div",{className:"project-description",children:[_.jsx("label",{children:"Description"}),_.jsx("p",{children:t.description||"-"})]}),t.capturedPhoto&&_.jsxs("div",{className:"verifier-image-block",children:[_.jsx("label",{children:"Captured Photo"}),_.jsx("img",{ref:u,src:t.capturedPhoto,alt:"Captured",className:"project-image",crossOrigin:"anonymous"}),_.jsx("canvas",{ref:x,className:"overlay-canvas"}),_.jsxs("div",{className:"analysis-buttons",children:[_.jsx("button",{onClick:()=>K("Captured Photo",u.current,x,0),children:"🤖 AI Analysis"}),_.jsx("button",{onClick:()=>P("Captured Photo",u.current,0),children:"🌿 ExG Only"})]})]}),t.satImage&&_.jsxs("div",{className:"verifier-image-block",children:[_.jsx("label",{children:"Satellite Image"}),_.jsx("img",{ref:d,src:t.satImage,alt:"Satellite",className:"project-image",crossOrigin:"anonymous"}),_.jsx("canvas",{ref:y,className:"overlay-canvas"}),_.jsxs("div",{className:"analysis-buttons",children:[_.jsx("button",{onClick:()=>K("Satellite Image",d.current,y,1),children:"🤖 AI Analysis"}),_.jsx("button",{onClick:()=>P("Satellite Image",d.current,1),children:"🛰️ ExG Only"})]})]}),t.documents?.length>0&&t.documents.map((M,B)=>_.jsxs("div",{className:"verifier-image-block",children:[_.jsxs("label",{children:["Uploaded Image ",B+1]}),_.jsx("img",{ref:Y=>p.current[B]=Y,src:M,alt:`Doc ${B}`,className:"project-image",crossOrigin:"anonymous"}),_.jsx("canvas",{ref:Y=>v.current[B]=Y,className:"overlay-canvas"}),_.jsxs("div",{className:"analysis-buttons",children:[_.jsx("button",{onClick:()=>K(`Uploaded Image ${B+1}`,p.current[B],v.current[B],B+2),children:"🤖 AI Analysis"}),_.jsx("button",{onClick:()=>P(`Uploaded Image ${B+1}`,p.current[B],B+2),children:"📸 ExG Only"})]})]},B)),_.jsxs("div",{className:"ai-panel",children:[_.jsx("div",{className:"ai-controls",children:_.jsx("button",{onClick:V,disabled:!!b,children:b?"✅ Model Ready":"Load AI Model"})}),_.jsx("div",{className:"ai-status",children:T}),_.jsx("div",{className:"ai-results",children:I.map((M,B)=>_.jsx("div",{className:"result-item",children:M},B))})]})]}),_.jsxs("div",{className:"verification-actions",children:[_.jsx("textarea",{value:a,onChange:M=>o(M.target.value),placeholder:"Add verification notes...",rows:"4"}),_.jsx("button",{onClick:()=>q("approved"),children:"✅ Approve"}),_.jsx("button",{onClick:()=>q("under_review"),children:"📝 Request Revision"}),_.jsx("button",{onClick:()=>q("rejected"),children:"❌ Reject"}),_.jsx("hr",{style:{margin:"1rem 0"}}),_.jsxs("div",{className:"credit-generation-controls",children:[_.jsx("input",{type:"number",placeholder:"Enter credits to generate...",value:l,onChange:M=>c(M.target.value),min:"0"}),_.jsx("button",{onClick:U,disabled:!t||t.status!=="verified",children:"🪙 Generate Credits"})]})]}),t.verificationHistory?.length>0&&_.jsxs("div",{className:"verification-history",children:[_.jsx("h4",{children:"📜 Verification History"}),t.verificationHistory.map((M,B)=>_.jsxs("div",{className:"history-item",children:[_.jsxs("strong",{children:[M.step,":"]})," ",M.status," by ",M.reviewer," on ",M.date," ",M.notes&&`- Notes: ${M.notes}`]},B))]})]}):_.jsx("div",{className:"no-selection",children:_.jsx("h3",{children:"👈 Select a project to view details"})})]})]})}function qXe(){const[n,e]=Se.useState([]),[t,r]=Se.useState(""),[s,i]=Se.useState("all"),[a,o]=Se.useState(!1),[l,c]=Se.useState({name:"",email:"",role:"farmer",organization:"",phone:"",location:""});Se.useEffect(()=>{(async()=>{try{const b=(await lh(uf(Xi,"users"))).docs.map(S=>({id:S.id,...S.data()}));e(b)}catch(v){console.error("Error fetching users:",v)}})()},[]);const u=async()=>{try{const y={name:l.name||"Unnamed User",email:l.email||"no-email@example.com",role:l.role||"farmer",organization:l.organization||"N/A",phone:l.phone||"N/A",location:l.location||"N/A",joinDate:new Date().toISOString().split("T")[0],lastActive:new Date().toISOString().split("T")[0],status:"pending",projects:0,credits:0,avatar:l.role==="farmer"?"👩‍🌾":l.role==="buyer"?"👨‍💼":"👨‍💻"},v=await Zj(uf(Xi,"users"),y);e([...n,{id:v.id,...y}]),c({name:"",email:"",role:"farmer",organization:"",phone:"",location:""}),o(!1)}catch(y){console.error("Error adding user:",y)}},d=async(y,v)=>{try{const b=yu(Xi,"users",y);await G0(b,{role:v}),e(n.map(S=>S.id===y?{...S,role:v}:S))}catch(b){console.error("Error updating role:",b)}},p=async(y,v)=>{try{const b=yu(Xi,"users",y);await G0(b,{status:v}),e(n.map(S=>S.id===y?{...S,status:v}:S))}catch(b){console.error("Error updating status:",b)}},x=n.filter(y=>{const v=(y.name||"").toLowerCase(),b=(y.email||"").toLowerCase(),S=(y.organization||"").toLowerCase(),T=v.includes(t.toLowerCase())||b.includes(t.toLowerCase())||S.includes(t.toLowerCase()),C=s==="all"||y.role===s;return T&&C});return _.jsxs("div",{className:"user-management",children:[_.jsx("h2",{children:"👥 User Management"}),_.jsxs("div",{className:"controls",children:[_.jsx("input",{type:"text",placeholder:"🔍 Search by name, email, org...",value:t,onChange:y=>r(y.target.value)}),_.jsxs("select",{value:s,onChange:y=>i(y.target.value),children:[_.jsx("option",{value:"all",children:"All Roles"}),_.jsx("option",{value:"farmer",children:"Farmers"}),_.jsx("option",{value:"buyer",children:"Buyers"}),_.jsx("option",{value:"verifier",children:"Verifiers"})]}),_.jsx("button",{onClick:()=>o(!0),children:"+ Add User"})]}),a&&_.jsxs("div",{className:"add-user-form",children:[_.jsx("input",{type:"text",placeholder:"Name",value:l.name,onChange:y=>c({...l,name:y.target.value})}),_.jsx("input",{type:"email",placeholder:"Email",value:l.email,onChange:y=>c({...l,email:y.target.value})}),_.jsxs("select",{value:l.role,onChange:y=>c({...l,role:y.target.value}),children:[_.jsx("option",{value:"farmer",children:"Farmer"}),_.jsx("option",{value:"buyer",children:"Buyer"}),_.jsx("option",{value:"verifier",children:"Verifier"})]}),_.jsx("input",{type:"text",placeholder:"Organization",value:l.organization,onChange:y=>c({...l,organization:y.target.value})}),_.jsx("input",{type:"text",placeholder:"Phone",value:l.phone,onChange:y=>c({...l,phone:y.target.value})}),_.jsx("input",{type:"text",placeholder:"Location",value:l.location,onChange:y=>c({...l,location:y.target.value})}),_.jsx("button",{onClick:u,children:"Save User"})]}),_.jsx("div",{className:"user-list",children:x.length===0?_.jsx("p",{children:"No users found"}):x.map(y=>_.jsxs("div",{className:"user-card",children:[_.jsxs("div",{className:"user-header",children:[_.jsx("span",{className:"avatar",children:y.avatar||"👤"}),_.jsxs("div",{children:[_.jsx("h4",{children:y.name||"Unnamed User"}),_.jsx("p",{className:"user-email",children:y.email||"No email"})]})]}),_.jsxs("div",{className:"user-details",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"📌 Organization:"})," ",y.organization||"N/A"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"📍 Location:"})," ",y.location||"N/A"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"📞 Phone:"})," ",y.phone||"N/A"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"📅 Joined:"})," ",y.joinDate||"-"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"⏳ Last Active:"})," ",y.lastActive||"-"]})]}),_.jsxs("div",{className:"user-actions",children:[_.jsxs("label",{children:["Status:",_.jsxs("select",{value:y.status||"pending",onChange:v=>p(y.id,v.target.value),children:[_.jsx("option",{value:"active",children:"Active"}),_.jsx("option",{value:"pending",children:"Pending"}),_.jsx("option",{value:"blocked",children:"Blocked"})]})]}),_.jsxs("label",{children:["Role:",_.jsxs("select",{value:y.role||"farmer",onChange:v=>d(y.id,v.target.value),children:[_.jsx("option",{value:"farmer",children:"Farmer"}),_.jsx("option",{value:"buyer",children:"Buyer"}),_.jsx("option",{value:"verifier",children:"Verifier"})]})]})]}),_.jsxs("div",{className:"user-stats",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"📂 Projects:"})," ",y.projects||0]}),_.jsxs("p",{children:[_.jsx("strong",{children:"🌱 Credits:"})," ",y.credits||0]})]})]},y.id))})]})}function KXe(){const[n,e]=Se.useState([]),[t,r]=Se.useState([]),[s,i]=Se.useState(""),[a,o]=Se.useState("all"),[l,c]=Se.useState("all"),[u,d]=Se.useState("all"),[p,x]=Se.useState(null);Se.useEffect(()=>{const $=[{id:"TXN-001",type:"credit_purchase",buyer:"James Chen",seller:"Dr. Marina Santos",project:"Mangrove Restoration - Sundarbans",amount:500,pricePerTon:25.5,totalAmount:12750,currency:"USD",status:"completed",date:"2024-01-20",timestamp:"2024-01-20T14:30:00Z",paymentMethod:"Bank Transfer",transactionHash:"0x742d35cc6cd8f9a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4",blockchainNetwork:"Ethereum",verificationStatus:"verified",notes:"Carbon credit purchase for corporate sustainability goals"},{id:"TXN-002",type:"credit_sale",buyer:"Lisa Thompson",seller:"Sarah Williams",project:"Coral Reef Protection Initiative",amount:300,pricePerTon:28.75,totalAmount:8625,currency:"USD",status:"pending",date:"2024-01-19",timestamp:"2024-01-19T16:45:00Z",paymentMethod:"Credit Card",transactionHash:"0x923c45dd7de8f0a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5",blockchainNetwork:"Ethereum",verificationStatus:"pending",notes:"Partial payment received, awaiting full confirmation"},{id:"TXN-003",type:"credit_purchase",buyer:"Green Investment Corp",seller:"Miguel Rodriguez",project:"Blue Carbon Assessment",amount:800,pricePerTon:22,totalAmount:17600,currency:"USD",status:"completed",date:"2024-01-18",timestamp:"2024-01-18T11:20:00Z",paymentMethod:"Wire Transfer",transactionHash:"0x456e78ff9ef0a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7",blockchainNetwork:"Ethereum",verificationStatus:"verified",notes:"Bulk purchase for portfolio diversification"},{id:"TXN-004",type:"credit_sale",buyer:"Eco Investment Partners",seller:"Dr. Marina Santos",project:"Mangrove Restoration - Sundarbans",amount:200,pricePerTon:26.25,totalAmount:5250,currency:"USD",status:"failed",date:"2024-01-17",timestamp:"2024-01-17T09:15:00Z",paymentMethod:"Bank Transfer",transactionHash:null,blockchainNetwork:"Ethereum",verificationStatus:"failed",notes:"Transaction failed due to insufficient funds"},{id:"TXN-005",type:"credit_purchase",buyer:"James Chen",seller:"Sarah Williams",project:"Coral Reef Protection Initiative",amount:150,pricePerTon:30,totalAmount:4500,currency:"USD",status:"processing",date:"2024-01-16",timestamp:"2024-01-16T13:45:00Z",paymentMethod:"Cryptocurrency",transactionHash:"0x789f01aa0bf1a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8",blockchainNetwork:"Ethereum",verificationStatus:"processing",notes:"Cryptocurrency payment in progress"},{id:"TXN-006",type:"platform_fee",buyer:"Platform",seller:"Dr. Marina Santos",project:"Mangrove Restoration - Sundarbans",amount:0,pricePerTon:0,totalAmount:127.5,currency:"USD",status:"completed",date:"2024-01-20",timestamp:"2024-01-20T14:30:00Z",paymentMethod:"Automatic",transactionHash:"0x123a45bb1cf2a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9",blockchainNetwork:"Ethereum",verificationStatus:"verified",notes:"Platform fee (1% of transaction value)"}];e($),r($)},[]),Se.useEffect(()=>{let $=n;if(s&&($=$.filter(q=>q.id.toLowerCase().includes(s.toLowerCase())||q.buyer.toLowerCase().includes(s.toLowerCase())||q.seller.toLowerCase().includes(s.toLowerCase())||q.project.toLowerCase().includes(s.toLowerCase()))),a!=="all"&&($=$.filter(q=>q.type===a)),l!=="all"&&($=$.filter(q=>q.status===l)),u!=="all"){const q=new Date,U=new Date;switch(u){case"today":U.setHours(0,0,0,0);break;case"week":U.setDate(q.getDate()-7);break;case"month":U.setMonth(q.getMonth()-1);break;case"year":U.setFullYear(q.getFullYear()-1);break}$=$.filter(F=>new Date(F.date)>=U)}r($)},[n,s,a,l,u]);const y=$=>{switch($){case"credit_purchase":return"type-badge purchase";case"credit_sale":return"type-badge sale";case"platform_fee":return"type-badge fee";default:return"type-badge default"}},v=$=>{switch($){case"completed":return"status-badge verified";case"pending":return"status-badge pending";case"processing":return"status-badge active";case"failed":return"status-badge rejected";default:return"status-badge no-reports"}},b=$=>{switch($){case"credit_purchase":return"🛒";case"credit_sale":return"💰";case"platform_fee":return"🏛️";default:return"📄"}},S=($,q)=>new Intl.NumberFormat("en-US",{style:"currency",currency:q}).format($),T=$=>new Date($).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),C=$=>new Date($).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),I={total:t.length,completed:t.filter($=>$.status==="completed").length,pending:t.filter($=>$.status==="pending").length,processing:t.filter($=>$.status==="processing").length,failed:t.filter($=>$.status==="failed").length,totalVolume:t.reduce(($,q)=>$+q.totalAmount,0),totalCredits:t.reduce(($,q)=>$+q.amount,0)};return _.jsxs("div",{className:"page-container",children:[_.jsxs("div",{className:"page-header",children:[_.jsx("h1",{className:"page-title",children:"💳 Transactions"}),_.jsx("p",{className:"page-subtitle",children:"Track all carbon credit transactions, payments, and financial records"})]}),_.jsxs("div",{className:"transaction-stats-grid",children:[_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"📊"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:I.total}),_.jsx("div",{className:"stat-label",children:"Total Transactions"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"✅"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:I.completed}),_.jsx("div",{className:"stat-label",children:"Completed"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"⏳"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:I.pending}),_.jsx("div",{className:"stat-label",children:"Pending"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"💰"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:S(I.totalVolume,"USD")}),_.jsx("div",{className:"stat-label",children:"Total Volume"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"🌱"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:I.totalCredits.toLocaleString()}),_.jsx("div",{className:"stat-label",children:"Credits Traded (tons)"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"📈"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:I.total>0?S(I.totalVolume/I.totalCredits,"USD"):"$0.00"}),_.jsx("div",{className:"stat-label",children:"Avg Price/Ton"})]})]})]}),_.jsxs("div",{className:"transaction-controls",children:[_.jsxs("div",{className:"search-filter",children:[_.jsx("input",{type:"text",placeholder:"Search transactions...",value:s,onChange:$=>i($.target.value),className:"search-input"}),_.jsxs("select",{value:a,onChange:$=>o($.target.value),className:"filter-select",children:[_.jsx("option",{value:"all",children:"All Types"}),_.jsx("option",{value:"credit_purchase",children:"Credit Purchase"}),_.jsx("option",{value:"credit_sale",children:"Credit Sale"}),_.jsx("option",{value:"platform_fee",children:"Platform Fee"})]}),_.jsxs("select",{value:l,onChange:$=>c($.target.value),className:"filter-select",children:[_.jsx("option",{value:"all",children:"All Status"}),_.jsx("option",{value:"completed",children:"Completed"}),_.jsx("option",{value:"pending",children:"Pending"}),_.jsx("option",{value:"processing",children:"Processing"}),_.jsx("option",{value:"failed",children:"Failed"})]}),_.jsxs("select",{value:u,onChange:$=>d($.target.value),className:"filter-select",children:[_.jsx("option",{value:"all",children:"All Time"}),_.jsx("option",{value:"today",children:"Today"}),_.jsx("option",{value:"week",children:"This Week"}),_.jsx("option",{value:"month",children:"This Month"}),_.jsx("option",{value:"year",children:"This Year"})]})]}),_.jsx("button",{className:"btn-primary",children:"📊 Export Report"})]}),_.jsxs("div",{className:"transactions-content",children:[_.jsxs("div",{className:"transactions-list",children:[_.jsx("div",{className:"list-header",children:_.jsxs("h3",{children:["💳 Transaction History (",t.length,")"]})}),_.jsxs("div",{className:"transactions-table",children:[_.jsxs("div",{className:"table-header",children:[_.jsx("div",{className:"col-id",children:"ID"}),_.jsx("div",{className:"col-type",children:"Type"}),_.jsx("div",{className:"col-parties",children:"Parties"}),_.jsx("div",{className:"col-project",children:"Project"}),_.jsx("div",{className:"col-amount",children:"Amount"}),_.jsx("div",{className:"col-price",children:"Price/Ton"}),_.jsx("div",{className:"col-total",children:"Total"}),_.jsx("div",{className:"col-status",children:"Status"}),_.jsx("div",{className:"col-date",children:"Date"}),_.jsx("div",{className:"col-actions",children:"Actions"})]}),_.jsx("div",{className:"table-body",children:t.map($=>_.jsxs("div",{className:`table-row ${p?.id===$.id?"selected":""}`,onClick:()=>x($),children:[_.jsx("div",{className:"col-id",children:_.jsx("span",{className:"transaction-id",children:$.id})}),_.jsx("div",{className:"col-type",children:_.jsxs("span",{className:`type-badge ${y($.type)}`,children:[b($.type)," ",$.type.replace("_"," ")]})}),_.jsx("div",{className:"col-parties",children:_.jsxs("div",{className:"parties-info",children:[_.jsxs("span",{className:"buyer",children:["👤 ",$.buyer]}),_.jsxs("span",{className:"seller",children:["👤 ",$.seller]})]})}),_.jsx("div",{className:"col-project",children:_.jsx("span",{className:"project-name",children:$.project})}),_.jsx("div",{className:"col-amount",children:_.jsxs("span",{className:"amount",children:[$.amount.toLocaleString()," tons"]})}),_.jsx("div",{className:"col-price",children:_.jsx("span",{className:"price",children:S($.pricePerTon,$.currency)})}),_.jsx("div",{className:"col-total",children:_.jsx("span",{className:"total",children:S($.totalAmount,$.currency)})}),_.jsx("div",{className:"col-status",children:_.jsx("span",{className:v($.status),children:$.status.charAt(0).toUpperCase()+$.status.slice(1)})}),_.jsx("div",{className:"col-date",children:_.jsx("span",{className:"date",children:T($.date)})}),_.jsx("div",{className:"col-actions",children:_.jsx("button",{className:"btn-small",onClick:q=>{q.stopPropagation(),x($)},children:"👁️ View"})})]},$.id))})]})]}),p&&_.jsxs("div",{className:"transaction-details-panel",children:[_.jsxs("div",{className:"panel-header",children:[_.jsx("h3",{children:"💳 Transaction Details"}),_.jsx("span",{className:"transaction-id",children:p.id})]}),_.jsxs("div",{className:"transaction-details",children:[_.jsxs("div",{className:"detail-section",children:[_.jsx("h4",{children:"📋 Basic Information"}),_.jsxs("div",{className:"detail-grid",children:[_.jsxs("div",{className:"detail-item",children:[_.jsx("label",{children:"Transaction ID:"}),_.jsx("span",{children:p.id})]}),_.jsxs("div",{className:"detail-item",children:[_.jsx("label",{children:"Type:"}),_.jsxs("span",{className:y(p.type),children:[b(p.type)," ",p.type.replace("_"," ")]})]}),_.jsxs("div",{className:"detail-item",children:[_.jsx("label",{children:"Status:"}),_.jsx("span",{className:v(p.status),children:p.status.charAt(0).toUpperCase()+p.status.slice(1)})]}),_.jsxs("div",{className:"detail-item",children:[_.jsx("label",{children:"Date:"}),_.jsx("span",{children:C(p.timestamp)})]}),_.jsxs("div",{className:"detail-item",children:[_.jsx("label",{children:"Buyer:"}),_.jsx("span",{children:p.buyer})]}),_.jsxs("div",{className:"detail-item",children:[_.jsx("label",{children:"Seller:"}),_.jsx("span",{children:p.seller})]}),_.jsxs("div",{className:"detail-item",children:[_.jsx("label",{children:"Project:"}),_.jsx("span",{children:p.project})]}),_.jsxs("div",{className:"detail-item",children:[_.jsx("label",{children:"Payment Method:"}),_.jsx("span",{children:p.paymentMethod})]})]})]}),_.jsxs("div",{className:"detail-section",children:[_.jsx("h4",{children:"💰 Financial Details"}),_.jsxs("div",{className:"financial-grid",children:[_.jsxs("div",{className:"financial-item",children:[_.jsx("label",{children:"Credits Amount:"}),_.jsxs("span",{className:"amount",children:[p.amount.toLocaleString()," tons CO₂"]})]}),_.jsxs("div",{className:"financial-item",children:[_.jsx("label",{children:"Price per Ton:"}),_.jsx("span",{className:"price",children:S(p.pricePerTon,p.currency)})]}),_.jsxs("div",{className:"financial-item",children:[_.jsx("label",{children:"Total Amount:"}),_.jsx("span",{className:"total",children:S(p.totalAmount,p.currency)})]}),_.jsxs("div",{className:"financial-item",children:[_.jsx("label",{children:"Currency:"}),_.jsx("span",{children:p.currency})]})]})]}),_.jsxs("div",{className:"detail-section",children:[_.jsx("h4",{children:"🔗 Blockchain Information"}),_.jsxs("div",{className:"blockchain-info",children:[_.jsxs("div",{className:"blockchain-item",children:[_.jsx("label",{children:"Network:"}),_.jsx("span",{children:p.blockchainNetwork})]}),_.jsxs("div",{className:"blockchain-item",children:[_.jsx("label",{children:"Transaction Hash:"}),_.jsx("span",{className:"hash",children:p.transactionHash?`${p.transactionHash.substring(0,20)}...`:"Not available"})]}),_.jsxs("div",{className:"blockchain-item",children:[_.jsx("label",{children:"Verification Status:"}),_.jsx("span",{className:v(p.verificationStatus),children:p.verificationStatus.charAt(0).toUpperCase()+p.verificationStatus.slice(1)})]})]})]}),_.jsxs("div",{className:"detail-section",children:[_.jsx("h4",{children:"📝 Notes"}),_.jsx("div",{className:"notes-content",children:_.jsx("p",{children:p.notes})})]}),_.jsxs("div",{className:"transaction-actions",children:[_.jsx("button",{className:"btn-primary",children:"📧 Contact Parties"}),_.jsx("button",{className:"btn-secondary",children:"🔗 View on Blockchain"}),_.jsx("button",{className:"btn-secondary",children:"📄 Download Receipt"}),p.status==="pending"&&_.jsx("button",{className:"btn-danger",children:"❌ Cancel Transaction"})]})]})]})]})]})}function XXe(){const[n,e]=Se.useState("overview"),[t,r]=Se.useState("month"),[s,i]=Se.useState("all"),[a,o]=Se.useState({});Se.useEffect(()=>{o({overview:{totalProjects:45,totalUsers:156,totalCredits:12500,totalVolume:312500,averagePrice:25,growthRate:15.2,topProjects:[{name:"Mangrove Restoration - Sundarbans",credits:1500,revenue:38250},{name:"Coral Reef Protection Initiative",credits:2e3,revenue:57500},{name:"Seagrass Carbon Sequestration",credits:800,revenue:23e3},{name:"Blue Carbon Assessment",credits:600,revenue:13200}],monthlyTrends:[{month:"Jan",credits:1200,revenue:3e4},{month:"Feb",credits:1500,revenue:37500},{month:"Mar",credits:1800,revenue:45e3},{month:"Apr",credits:2100,revenue:52500},{month:"May",credits:1900,revenue:47500},{month:"Jun",credits:2200,revenue:55e3}]},financial:{totalRevenue:312500,totalExpenses:45e3,netProfit:267500,platformFees:3125,transactionFees:1875,operationalCosts:4e4,revenueByMonth:[{month:"Jan",revenue:3e4,expenses:3500},{month:"Feb",revenue:37500,expenses:4e3},{month:"Mar",revenue:45e3,expenses:4500},{month:"Apr",revenue:52500,expenses:5e3},{month:"May",revenue:47500,expenses:4500},{month:"Jun",revenue:55e3,expenses:5500}],topEarners:[{name:"Dr. Marina Santos",earnings:38250,projects:5},{name:"Sarah Williams",earnings:57500,projects:8},{name:"Miguel Rodriguez",earnings:13200,projects:2}]},environmental:{totalCarbonSequestration:12500,mangroveCredits:4500,seagrassCredits:3200,coralCredits:4800,averageSequestrationRate:2.5,environmentalImpact:{co2Reduction:12500,equivalentTrees:520833,equivalentCars:2708,equivalentFlights:156},projectTypes:[{type:"Mangrove Restoration",credits:4500,percentage:36},{type:"Coral Reef Conservation",credits:4800,percentage:38.4},{type:"Seagrass Restoration",credits:3200,percentage:25.6}]},user:{totalUsers:156,activeUsers:142,newUsers:23,userRetention:91,usersByRole:[{role:"Farmers",count:89,percentage:57.1},{role:"Buyers",count:45,percentage:28.8},{role:"Admins",count:22,percentage:14.1}],userActivity:[{period:"Week 1",active:120,new:5},{period:"Week 2",active:135,new:8},{period:"Week 3",active:142,new:6},{period:"Week 4",active:138,new:4}],topActiveUsers:[{name:"Dr. Marina Santos",activity:95,projects:5},{name:"Sarah Williams",activity:92,projects:8},{name:"James Chen",activity:88,purchases:12}]}})},[]);const l=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),c=v=>new Intl.NumberFormat("en-US").format(v),u=()=>{const v=a.overview;return v?_.jsxs("div",{className:"report-content",children:[_.jsxs("div",{className:"report-stats-grid",children:[_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"📊"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:v.totalProjects}),_.jsx("div",{className:"stat-label",children:"Total Projects"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"👥"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:v.totalUsers}),_.jsx("div",{className:"stat-label",children:"Total Users"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"🌱"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:c(v.totalCredits)}),_.jsx("div",{className:"stat-label",children:"Carbon Credits (tons)"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"💰"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:l(v.totalVolume)}),_.jsx("div",{className:"stat-label",children:"Total Volume"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"📈"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:l(v.averagePrice)}),_.jsx("div",{className:"stat-label",children:"Avg Price/Ton"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"🚀"}),_.jsxs("div",{className:"stat-content",children:[_.jsxs("div",{className:"stat-number",children:[v.growthRate,"%"]}),_.jsx("div",{className:"stat-label",children:"Growth Rate"})]})]})]}),_.jsxs("div",{className:"report-charts",children:[_.jsxs("div",{className:"chart-section",children:[_.jsx("h3",{children:"📈 Monthly Trends"}),_.jsxs("div",{className:"chart-container",children:[_.jsx("div",{className:"chart-bars",children:v.monthlyTrends.map((b,S)=>_.jsxs("div",{className:"chart-bar-group",children:[_.jsx("div",{className:"chart-bar",children:_.jsx("div",{className:"bar credits-bar",style:{height:`${b.credits/2500*100}%`}})}),_.jsx("div",{className:"chart-bar",children:_.jsx("div",{className:"bar revenue-bar",style:{height:`${b.revenue/6e4*100}%`}})}),_.jsx("div",{className:"chart-label",children:b.month})]},S))}),_.jsxs("div",{className:"chart-legend",children:[_.jsxs("div",{className:"legend-item",children:[_.jsx("div",{className:"legend-color credits-color"}),_.jsx("span",{children:"Credits (tons)"})]}),_.jsxs("div",{className:"legend-item",children:[_.jsx("div",{className:"legend-color revenue-color"}),_.jsx("span",{children:"Revenue ($)"})]})]})]})]}),_.jsxs("div",{className:"chart-section",children:[_.jsx("h3",{children:"🏆 Top Performing Projects"}),_.jsx("div",{className:"top-projects-list",children:v.topProjects.map((b,S)=>_.jsxs("div",{className:"project-item",children:[_.jsxs("div",{className:"project-rank",children:["#",S+1]}),_.jsxs("div",{className:"project-info",children:[_.jsx("h4",{children:b.name}),_.jsxs("div",{className:"project-stats",children:[_.jsxs("span",{className:"credits",children:[c(b.credits)," tons"]}),_.jsx("span",{className:"revenue",children:l(b.revenue)})]})]}),_.jsx("div",{className:"project-chart",children:_.jsx("div",{className:"project-bar",style:{width:`${b.credits/2e3*100}%`}})})]},S))})]})]})]}):null},d=()=>{const v=a.financial;return v?_.jsxs("div",{className:"report-content",children:[_.jsxs("div",{className:"financial-summary",children:[_.jsxs("div",{className:"summary-card revenue",children:[_.jsx("h3",{children:"💰 Total Revenue"}),_.jsx("div",{className:"summary-amount",children:l(v.totalRevenue)})]}),_.jsxs("div",{className:"summary-card expenses",children:[_.jsx("h3",{children:"💸 Total Expenses"}),_.jsx("div",{className:"summary-amount",children:l(v.totalExpenses)})]}),_.jsxs("div",{className:"summary-card profit",children:[_.jsx("h3",{children:"📈 Net Profit"}),_.jsx("div",{className:"summary-amount",children:l(v.netProfit)})]})]}),_.jsxs("div",{className:"financial-breakdown",children:[_.jsxs("div",{className:"breakdown-section",children:[_.jsx("h3",{children:"💳 Revenue Breakdown"}),_.jsxs("div",{className:"breakdown-items",children:[_.jsxs("div",{className:"breakdown-item",children:[_.jsx("span",{className:"label",children:"Platform Fees (1%):"}),_.jsx("span",{className:"amount",children:l(v.platformFees)})]}),_.jsxs("div",{className:"breakdown-item",children:[_.jsx("span",{className:"label",children:"Transaction Fees:"}),_.jsx("span",{className:"amount",children:l(v.transactionFees)})]}),_.jsxs("div",{className:"breakdown-item",children:[_.jsx("span",{className:"label",children:"Operational Costs:"}),_.jsx("span",{className:"amount",children:l(v.operationalCosts)})]})]})]}),_.jsxs("div",{className:"breakdown-section",children:[_.jsx("h3",{children:"📊 Monthly Revenue vs Expenses"}),_.jsx("div",{className:"revenue-chart",children:v.revenueByMonth.map((b,S)=>_.jsxs("div",{className:"month-item",children:[_.jsx("div",{className:"month-label",children:b.month}),_.jsxs("div",{className:"month-bars",children:[_.jsxs("div",{className:"revenue-bar",children:[_.jsx("div",{className:"bar",style:{height:`${b.revenue/6e4*100}%`}}),_.jsx("span",{className:"bar-label",children:l(b.revenue)})]}),_.jsxs("div",{className:"expense-bar",children:[_.jsx("div",{className:"bar",style:{height:`${b.expenses/6e3*100}%`}}),_.jsx("span",{className:"bar-label",children:l(b.expenses)})]})]})]},S))})]}),_.jsxs("div",{className:"breakdown-section",children:[_.jsx("h3",{children:"🏆 Top Earners"}),_.jsx("div",{className:"earners-list",children:v.topEarners.map((b,S)=>_.jsxs("div",{className:"earner-item",children:[_.jsxs("div",{className:"earner-rank",children:["#",S+1]}),_.jsxs("div",{className:"earner-info",children:[_.jsx("h4",{children:b.name}),_.jsxs("p",{children:[b.projects," projects"]})]}),_.jsx("div",{className:"earner-amount",children:l(b.earnings)})]},S))})]})]})]}):null},p=()=>{const v=a.environmental;return v?_.jsxs("div",{className:"report-content",children:[_.jsxs("div",{className:"environmental-impact",children:[_.jsx("h3",{children:"🌍 Environmental Impact Summary"}),_.jsxs("div",{className:"impact-grid",children:[_.jsxs("div",{className:"impact-card",children:[_.jsx("div",{className:"impact-icon",children:"🌱"}),_.jsxs("div",{className:"impact-content",children:[_.jsx("div",{className:"impact-number",children:c(v.environmentalImpact.co2Reduction)}),_.jsx("div",{className:"impact-label",children:"Tons CO₂ Sequestered"})]})]}),_.jsxs("div",{className:"impact-card",children:[_.jsx("div",{className:"impact-icon",children:"🌳"}),_.jsxs("div",{className:"impact-content",children:[_.jsx("div",{className:"impact-number",children:c(v.environmentalImpact.equivalentTrees)}),_.jsx("div",{className:"impact-label",children:"Equivalent Trees"})]})]}),_.jsxs("div",{className:"impact-card",children:[_.jsx("div",{className:"impact-icon",children:"🚗"}),_.jsxs("div",{className:"impact-content",children:[_.jsx("div",{className:"impact-number",children:c(v.environmentalImpact.equivalentCars)}),_.jsx("div",{className:"impact-label",children:"Cars Off Road (yearly)"})]})]}),_.jsxs("div",{className:"impact-card",children:[_.jsx("div",{className:"impact-icon",children:"✈️"}),_.jsxs("div",{className:"impact-content",children:[_.jsx("div",{className:"impact-number",children:c(v.environmentalImpact.equivalentFlights)}),_.jsx("div",{className:"impact-label",children:"Flights Offset"})]})]})]})]}),_.jsxs("div",{className:"credits-breakdown",children:[_.jsxs("div",{className:"breakdown-section",children:[_.jsx("h3",{children:"🌊 Credits by Ecosystem Type"}),_.jsx("div",{className:"ecosystem-chart",children:v.projectTypes.map((b,S)=>_.jsxs("div",{className:"ecosystem-item",children:[_.jsxs("div",{className:"ecosystem-info",children:[_.jsx("h4",{children:b.type}),_.jsxs("div",{className:"ecosystem-stats",children:[_.jsxs("span",{className:"credits",children:[c(b.credits)," tons"]}),_.jsxs("span",{className:"percentage",children:[b.percentage,"%"]})]})]}),_.jsx("div",{className:"ecosystem-bar",children:_.jsx("div",{className:"bar",style:{width:`${b.percentage}%`}})})]},S))})]}),_.jsxs("div",{className:"breakdown-section",children:[_.jsx("h3",{children:"📊 Carbon Sequestration Breakdown"}),_.jsxs("div",{className:"sequestration-grid",children:[_.jsxs("div",{className:"seq-item",children:[_.jsx("div",{className:"seq-icon",children:"🌿"}),_.jsxs("div",{className:"seq-content",children:[_.jsx("div",{className:"seq-number",children:c(v.mangroveCredits)}),_.jsx("div",{className:"seq-label",children:"Mangrove Credits"})]})]}),_.jsxs("div",{className:"seq-item",children:[_.jsx("div",{className:"seq-icon",children:"🌊"}),_.jsxs("div",{className:"seq-content",children:[_.jsx("div",{className:"seq-number",children:c(v.seagrassCredits)}),_.jsx("div",{className:"seq-label",children:"Seagrass Credits"})]})]}),_.jsxs("div",{className:"seq-item",children:[_.jsx("div",{className:"seq-icon",children:"🪸"}),_.jsxs("div",{className:"seq-content",children:[_.jsx("div",{className:"seq-number",children:c(v.coralCredits)}),_.jsx("div",{className:"seq-label",children:"Coral Credits"})]})]})]})]})]})]}):null},x=()=>{const v=a.user;return v?_.jsxs("div",{className:"report-content",children:[_.jsxs("div",{className:"user-stats-grid",children:[_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"👥"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:v.totalUsers}),_.jsx("div",{className:"stat-label",children:"Total Users"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"✅"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:v.activeUsers}),_.jsx("div",{className:"stat-label",children:"Active Users"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"🆕"}),_.jsxs("div",{className:"stat-content",children:[_.jsx("div",{className:"stat-number",children:v.newUsers}),_.jsx("div",{className:"stat-label",children:"New Users"})]})]}),_.jsxs("div",{className:"stat-card",children:[_.jsx("div",{className:"stat-icon",children:"📈"}),_.jsxs("div",{className:"stat-content",children:[_.jsxs("div",{className:"stat-number",children:[v.userRetention,"%"]}),_.jsx("div",{className:"stat-label",children:"Retention Rate"})]})]})]}),_.jsxs("div",{className:"user-breakdown",children:[_.jsxs("div",{className:"breakdown-section",children:[_.jsx("h3",{children:"👥 Users by Role"}),_.jsx("div",{className:"role-chart",children:v.usersByRole.map((b,S)=>_.jsxs("div",{className:"role-item",children:[_.jsxs("div",{className:"role-info",children:[_.jsx("h4",{children:b.role}),_.jsxs("div",{className:"role-stats",children:[_.jsxs("span",{className:"count",children:[b.count," users"]}),_.jsxs("span",{className:"percentage",children:[b.percentage,"%"]})]})]}),_.jsx("div",{className:"role-bar",children:_.jsx("div",{className:"bar",style:{width:`${b.percentage}%`}})})]},S))})]}),_.jsxs("div",{className:"breakdown-section",children:[_.jsx("h3",{children:"📊 Weekly User Activity"}),_.jsx("div",{className:"activity-chart",children:v.userActivity.map((b,S)=>_.jsxs("div",{className:"week-item",children:[_.jsx("div",{className:"week-label",children:b.period}),_.jsxs("div",{className:"week-bars",children:[_.jsxs("div",{className:"active-bar",children:[_.jsx("div",{className:"bar",style:{height:`${b.active/150*100}%`}}),_.jsxs("span",{className:"bar-label",children:[b.active," active"]})]}),_.jsxs("div",{className:"new-bar",children:[_.jsx("div",{className:"bar",style:{height:`${b.new/10*100}%`}}),_.jsxs("span",{className:"bar-label",children:[b.new," new"]})]})]})]},S))})]}),_.jsxs("div",{className:"breakdown-section",children:[_.jsx("h3",{children:"🏆 Most Active Users"}),_.jsx("div",{className:"active-users-list",children:v.topActiveUsers.map((b,S)=>_.jsxs("div",{className:"user-item",children:[_.jsxs("div",{className:"user-rank",children:["#",S+1]}),_.jsxs("div",{className:"user-info",children:[_.jsx("h4",{children:b.name}),_.jsx("p",{children:b.projects?`${b.projects} projects`:`${b.purchases} purchases`})]}),_.jsxs("div",{className:"user-activity",children:[b.activity,"% active"]})]},S))})]})]})]}):null},y=()=>{switch(n){case"overview":return u();case"financial":return d();case"environmental":return p();case"user":return x();default:return u()}};return _.jsxs("div",{className:"page-container",children:[_.jsxs("div",{className:"page-header",children:[_.jsx("h1",{className:"page-title",children:"📊 Reports & Analytics"}),_.jsx("p",{className:"page-subtitle",children:"Comprehensive analytics and reporting for platform performance and environmental impact"})]}),_.jsxs("div",{className:"report-controls",children:[_.jsxs("div",{className:"control-group",children:[_.jsx("label",{children:"Report Type:"}),_.jsxs("select",{value:n,onChange:v=>e(v.target.value),className:"control-select",children:[_.jsx("option",{value:"overview",children:"📊 Overview"}),_.jsx("option",{value:"financial",children:"💰 Financial"}),_.jsx("option",{value:"environmental",children:"🌍 Environmental"}),_.jsx("option",{value:"user",children:"👥 User Analytics"})]})]}),_.jsxs("div",{className:"control-group",children:[_.jsx("label",{children:"Date Range:"}),_.jsxs("select",{value:t,onChange:v=>r(v.target.value),className:"control-select",children:[_.jsx("option",{value:"week",children:"This Week"}),_.jsx("option",{value:"month",children:"This Month"}),_.jsx("option",{value:"quarter",children:"This Quarter"}),_.jsx("option",{value:"year",children:"This Year"}),_.jsx("option",{value:"all",children:"All Time"})]})]}),_.jsxs("div",{className:"control-group",children:[_.jsx("label",{children:"Project:"}),_.jsxs("select",{value:s,onChange:v=>i(v.target.value),className:"control-select",children:[_.jsx("option",{value:"all",children:"All Projects"}),_.jsx("option",{value:"mangrove",children:"Mangrove Projects"}),_.jsx("option",{value:"seagrass",children:"Seagrass Projects"}),_.jsx("option",{value:"coral",children:"Coral Projects"})]})]}),_.jsxs("div",{className:"control-actions",children:[_.jsx("button",{className:"btn-primary",children:"📄 Export PDF"}),_.jsx("button",{className:"btn-secondary",children:"📊 Export Excel"}),_.jsx("button",{className:"btn-secondary",children:"🔄 Refresh Data"})]})]}),_.jsx("div",{className:"reports-content",children:y()})]})}function YXe(){const n=_c(),e=n.pathname==="/login"||n.pathname==="/signup"||n.pathname==="/"||n.pathname==="/dashboard"||n.pathname==="/about"||n.pathname==="/contact";return _.jsxs(_.Fragment,{children:[!e&&_.jsx(vie,{}),_.jsxs(Fse,{children:[_.jsx($s,{path:"/",element:_.jsx(_ie,{})}),_.jsx($s,{path:"/dashboard",element:_.jsx(wie,{})}),_.jsx($s,{path:"/login",element:_.jsx(Vfe,{})}),_.jsx($s,{path:"/signup",element:_.jsx(Ufe,{})}),_.jsx($s,{path:"/farmer",element:_.jsx(Hfe,{})}),_.jsx($s,{path:"/buyer",element:_.jsx(xie,{})}),_.jsx($s,{path:"/admin",element:_.jsx(qfe,{})}),_.jsx($s,{path:"/profile",element:_.jsx(U8,{})}),_.jsx($s,{path:"/profile-form",element:_.jsx(Kfe,{})}),_.jsx($s,{path:"/profile-display",element:_.jsx(U8,{})}),_.jsx($s,{path:"/add-project",element:_.jsx(gpe,{})}),_.jsx($s,{path:"/mrv-dashboard-farmer",element:_.jsx(nxe,{})}),_.jsx($s,{path:"/marketplace",element:_.jsx(sxe,{})}),_.jsx($s,{path:"/mrv-dashboard-buyer",element:_.jsx(rxe,{})}),_.jsx($s,{path:"/contact",element:_.jsx(ixe,{})}),_.jsx($s,{path:"/about",element:_.jsx(axe,{})}),_.jsx($s,{path:"/project-verification",element:_.jsx(WXe,{})}),_.jsx($s,{path:"/user-management",element:_.jsx(qXe,{})}),_.jsx($s,{path:"/transactions",element:_.jsx(KXe,{})}),_.jsx($s,{path:"/reports",element:_.jsx(XXe,{})})]})]})}function ZXe(){return _.jsx(YXe,{})}(async()=>{try{const n=await WO(()=>import("./index-FYbs7X0s.js").then(t=>t.i),[]),e=await WO(()=>import("./browser-CTQAB2X6.js").then(t=>t.b),[]);window.Buffer=n.Buffer||n.default,window.process=e,Kre.createRoot(document.getElementById("root")).render(_.jsx(Se.StrictMode,{children:_.jsx(oie,{basename:"/",children:_.jsx(ZXe,{})})}))}catch(n){console.error("Failed to load polyfills and render application:",n)}})();export{ku as g};
